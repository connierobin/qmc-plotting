Rank =    0  Free Memory = 82849 MB
Rank =    1  Free Memory = 82849 MB
Rank =    2  Free Memory = 82849 MB
Rank =    3  Free Memory = 82849 MB
Rank =    4  Free Memory = 82849 MB
Rank =    5  Free Memory = 82848 MB
Rank =    6  Free Memory = 82848 MB
Rank =    7  Free Memory = 82848 MB
Rank =    8  Free Memory = 82848 MB
Rank =    9  Free Memory = 82848 MB
Rank =   10  Free Memory = 82848 MB
Rank =   11  Free Memory = 82848 MB
Rank =   12  Free Memory = 82848 MB
Rank =   13  Free Memory = 82848 MB
Rank =   14  Free Memory = 82847 MB
Rank =   15  Free Memory = 82832 MB
Rank =   16  Free Memory = 82832 MB
Rank =   17  Free Memory = 82832 MB
Rank =   18  Free Memory = 82832 MB
Rank =   19  Free Memory = 82832 MB
Rank =   20  Free Memory = 82832 MB
Rank =   21  Free Memory = 82832 MB
Rank =   22  Free Memory = 82832 MB
Rank =   23  Free Memory = 82832 MB
Rank =   24  Free Memory = 82832 MB
Rank =   25  Free Memory = 82832 MB
Rank =   26  Free Memory = 82832 MB
Rank =   27  Free Memory = 82832 MB
Rank =   28  Free Memory = 82832 MB
Rank =   29  Free Memory = 82832 MB
Rank =   30  Free Memory = 82831 MB
Rank =   31  Free Memory = 82831 MB
Rank =   32  Free Memory = 83099 MB
Rank =   33  Free Memory = 83099 MB
Rank =   34  Free Memory = 83099 MB
Rank =   35  Free Memory = 83099 MB
Rank =   36  Free Memory = 83099 MB
Rank =   37  Free Memory = 83099 MB
Rank =   38  Free Memory = 83099 MB
Rank =   39  Free Memory = 83099 MB
Rank =   40  Free Memory = 83099 MB
Rank =   41  Free Memory = 83098 MB
Rank =   42  Free Memory = 83098 MB
Rank =   43  Free Memory = 83098 MB
Rank =   44  Free Memory = 83098 MB
Rank =   45  Free Memory = 83098 MB
Rank =   46  Free Memory = 83098 MB
Rank =   47  Free Memory = 83098 MB
Rank =   48  Free Memory = 83098 MB
Rank =   49  Free Memory = 83098 MB
Rank =   50  Free Memory = 83098 MB
Rank =   51  Free Memory = 83098 MB
Rank =   52  Free Memory = 83098 MB
Rank =   53  Free Memory = 83098 MB
Rank =   54  Free Memory = 83098 MB
Rank =   55  Free Memory = 83098 MB
Rank =   56  Free Memory = 83098 MB
Rank =   57  Free Memory = 83098 MB
Rank =   58  Free Memory = 83098 MB
Rank =   59  Free Memory = 83098 MB
Rank =   60  Free Memory = 83098 MB
Rank =   61  Free Memory = 83098 MB
Rank =   62  Free Memory = 83098 MB
Rank =   63  Free Memory = 83098 MB
Rank =   64  Free Memory = 86606 MB
Rank =   65  Free Memory = 86606 MB
Rank =   66  Free Memory = 86606 MB
Rank =   67  Free Memory = 86606 MB
Rank =   68  Free Memory = 86606 MB
Rank =   69  Free Memory = 86606 MB
Rank =   70  Free Memory = 86606 MB
Rank =   71  Free Memory = 86606 MB
Rank =   72  Free Memory = 86606 MB
Rank =   73  Free Memory = 86606 MB
Rank =   74  Free Memory = 86606 MB
Rank =   75  Free Memory = 86606 MB
Rank =   76  Free Memory = 86606 MB
Rank =   77  Free Memory = 86606 MB
Rank =   78  Free Memory = 86606 MB
Rank =   79  Free Memory = 86606 MB
Rank =   80  Free Memory = 86606 MB
Rank =   81  Free Memory = 86606 MB
Rank =   82  Free Memory = 86606 MB
Rank =   83  Free Memory = 86606 MB
Rank =   84  Free Memory = 86606 MB
Rank =   85  Free Memory = 86606 MB
Rank =   86  Free Memory = 86606 MB
Rank =   87  Free Memory = 86606 MB
Rank =   88  Free Memory = 86606 MB
Rank =   89  Free Memory = 86606 MB
Rank =   90  Free Memory = 86606 MB
Rank =   91  Free Memory = 86606 MB
Rank =   92  Free Memory = 86606 MB
Rank =   93  Free Memory = 86606 MB
Rank =   94  Free Memory = 86606 MB
Rank =   95  Free Memory = 86606 MB
Rank =   96  Free Memory = 59311 MB
Rank =   97  Free Memory = 59311 MB
Rank =   98  Free Memory = 59311 MB
Rank =   99  Free Memory = 59311 MB
Rank =  100  Free Memory = 59310 MB
Rank =  101  Free Memory = 59310 MB
Rank =  102  Free Memory = 59310 MB
Rank =  103  Free Memory = 59310 MB
Rank =  104  Free Memory = 59310 MB
Rank =  105  Free Memory = 59310 MB
Rank =  106  Free Memory = 59310 MB
Rank =  107  Free Memory = 59310 MB
Rank =  108  Free Memory = 59310 MB
Rank =  109  Free Memory = 59310 MB
Rank =  110  Free Memory = 59310 MB
Rank =  111  Free Memory = 59310 MB
Rank =  112  Free Memory = 59310 MB
Rank =  113  Free Memory = 59310 MB
Rank =  114  Free Memory = 59310 MB
Rank =  115  Free Memory = 59310 MB
Rank =  116  Free Memory = 59310 MB
Rank =  117  Free Memory = 59310 MB
Rank =  118  Free Memory = 59310 MB
Rank =  119  Free Memory = 59310 MB
Rank =  120  Free Memory = 59310 MB
Rank =  121  Free Memory = 59310 MB
Rank =  122  Free Memory = 59310 MB
Rank =  123  Free Memory = 59310 MB
Rank =  124  Free Memory = 59310 MB
Rank =  125  Free Memory = 59310 MB
Rank =  126  Free Memory = 59310 MB
Rank =  127  Free Memory = 59310 MB
  Input file(s): opt_h2o_gs_gvptt_run002l.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002l.xml

  Project = H2O
  date    = 2023-04-09 18:34:33 PDT
  host    = n0107.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 937

  Range of prime numbers to use as seeds over processors and threads = 7393-8563


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.926787e-01    1         1  ON     0
     uu_1                 2.957114e-02    1         1  ON     1
     uu_2                -6.705151e-02    1         1  ON     2
     uu_3                -1.244601e-01    1         1  ON     3
     uu_4                -1.613597e-01    1         1  ON     4
     uu_5                -1.736352e-01    1         1  ON     5
     uu_6                -1.609574e-01    1         1  ON     6
     uu_7                -1.144692e-01    1         1  ON     7
     uu_8                -3.693560e-02    1         1  ON     8
     uu_9                 1.610771e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.514147e-01    1         1  ON     0
     ud_1                 9.219724e-02    1         1  ON     1
     ud_2                -1.921050e-02    1         1  ON     2
     ud_3                -8.213070e-02    1         1  ON     3
     ud_4                -1.322117e-01    1         1  ON     4
     ud_5                -1.686002e-01    1         1  ON     5
     ud_6                -1.801049e-01    1         1  ON     6
     ud_7                -1.597582e-01    1         1  ON     7
     ud_8                -1.006737e-01    1         1  ON     8
     ud_9                -8.541877e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.325869e-01    1         1  ON     0
     eO_1                -6.070034e-01    1         1  ON     1
     eO_2                -1.880982e-01    1         1  ON     2
     eO_3                 8.574020e-02    1         1  ON     3
     eO_4                 2.107354e-01    1         1  ON     4
     eO_5                 2.944037e-01    1         1  ON     5
     eO_6                 3.332553e-01    1         1  ON     6
     eO_7                 5.013736e-01    1         1  ON     7
     eO_8                 1.948403e-01    1         1  ON     8
     eO_9                 6.147062e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.116332e-01    1         1  ON     0
     eH1_1                -1.330353e-01    1         1  ON     1
     eH1_2                -9.090391e-02    1         1  ON     2
     eH1_3                -5.306217e-02    1         1  ON     3
     eH1_4                -7.644718e-03    1         1  ON     4
     eH1_5                 4.135458e-03    1         1  ON     5
     eH1_6                 4.139668e-02    1         1  ON     6
     eH1_7                 6.344449e-02    1         1  ON     7
     eH1_8                 1.797007e-01    1         1  ON     8
     eH1_9                 1.211156e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.075214e-01    1         1  ON     0
     eH2_1                -1.284359e-01    1         1  ON     1
     eH2_2                -8.640157e-02    1         1  ON     2
     eH2_3                -4.875582e-02    1         1  ON     3
     eH2_4                -2.702398e-03    1         1  ON     4
     eH2_5                 8.938886e-03    1         1  ON     5
     eH2_6                 4.728776e-02    1         1  ON     6
     eH2_7                 4.689368e-02    1         1  ON     7
     eH2_8                 1.974056e-01    1         1  ON     8
     eH2_9                 1.202816e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697154e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.4894e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.398671
====================================================
  Execution time = 3.5077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331985188806
                                         uncertainty =       0.005480190918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331985188806
                                         uncertainty =       0.005480190918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407383553
  error estimate for blocks of size 2^( 2) =       0.000416637839
  error estimate for blocks of size 2^( 3) =       0.000425070968
  error estimate for blocks of size 2^( 4) =       0.000431132295
  error estimate for blocks of size 2^( 5) =       0.000435298375
  error estimate for blocks of size 2^( 6) =       0.000437732609
  error estimate for blocks of size 2^( 7) =       0.000439805644

      target function =                  N/A
              le_mean =     -17.217089769604
             les_mean =     296.760102687089
             stat err =       0.000435992231
             autocorr =       1.145382431810
              std dev =       0.576127345677
             le_variance =       0.331922718437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721708976960e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089769604       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089734797       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217091674526       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217091420087       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217091940915       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217092231549       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217092479396       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217092252373       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217092238049       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.680708e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089769604       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089757064       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217090542576       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217090599260       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217090509371       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090727177       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090799601       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217090758730       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.551633e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089769604       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089766081       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089995885       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217090032154       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089994767       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090052433       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090071180       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.709103e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4539e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.927211e-01                 1 1 ON  0
uu_1  2.954185e-02                 1 1 ON  1
uu_2  -6.702531e-02                1 1 ON  2
uu_3  -1.244464e-01                1 1 ON  3
uu_4  -1.613112e-01                1 1 ON  4
uu_5  -1.736202e-01                1 1 ON  5
uu_6  -1.610695e-01                1 1 ON  6
uu_7  -1.144963e-01                1 1 ON  7
uu_8  -3.692395e-02                1 1 ON  8
uu_9  1.610651e-01                 1 1 ON  9
ud_0  3.515699e-01                 1 1 ON  10
ud_1  9.222851e-02                 1 1 ON  11
ud_2  -1.920630e-02                1 1 ON  12
ud_3  -8.219914e-02                1 1 ON  13
ud_4  -1.322402e-01                1 1 ON  14
ud_5  -1.685109e-01                1 1 ON  15
ud_6  -1.801727e-01                1 1 ON  16
ud_7  -1.598300e-01                1 1 ON  17
ud_8  -1.007277e-01                1 1 ON  18
ud_9  -8.548752e-03                1 1 ON  19
eO_0  -9.326919e-01                1 1 ON  20
eO_1  -6.071510e-01                1 1 ON  21
eO_2  -1.880089e-01                1 1 ON  22
eO_3  8.581465e-02                 1 1 ON  23
eO_4  2.108620e-01                 1 1 ON  24
eO_5  2.944174e-01                 1 1 ON  25
eO_6  3.332057e-01                 1 1 ON  26
eO_7  5.013493e-01                 1 1 ON  27
eO_8  1.948584e-01                 1 1 ON  28
eO_9  6.147459e-02                 1 1 ON  29
eH1_0 -2.116610e-01                1 1 ON  30
eH1_1 -1.329723e-01                1 1 ON  31
eH1_2 -9.091190e-02                1 1 ON  32
eH1_3 -5.306476e-02                1 1 ON  33
eH1_4 -7.678060e-03                1 1 ON  34
eH1_5 4.181845e-03                 1 1 ON  35
eH1_6 4.139344e-02                 1 1 ON  36
eH1_7 6.341894e-02                 1 1 ON  37
eH1_8 1.796940e-01                 1 1 ON  38
eH1_9 1.211138e-01                 1 1 ON  39
eH2_0 -2.075208e-01                1 1 ON  40
eH2_1 -1.284335e-01                1 1 ON  41
eH2_2 -8.642202e-02                1 1 ON  42
eH2_3 -4.870652e-02                1 1 ON  43
eH2_4 -2.688221e-03                1 1 ON  44
eH2_5 8.916163e-03                 1 1 ON  45
eH2_6 4.727693e-02                 1 1 ON  46
eH2_7 4.688284e-02                 1 1 ON  47
eH2_8 1.973821e-01                 1 1 ON  48
eH2_9 1.202949e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.189882
====================================================
  Execution time = 3.4159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1992e-01
  Total weights = 2.0000e+06
  Execution time = 3.1368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319648085180
                                         uncertainty =       0.004277432646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319648085180
                                         uncertainty =       0.004277432646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399879335
  error estimate for blocks of size 2^( 2) =       0.000409922466
  error estimate for blocks of size 2^( 3) =       0.000418365652
  error estimate for blocks of size 2^( 4) =       0.000424828168
  error estimate for blocks of size 2^( 5) =       0.000428254954
  error estimate for blocks of size 2^( 6) =       0.000431018949
  error estimate for blocks of size 2^( 7) =       0.000431773585

      target function =                  N/A
              le_mean =     -17.217181273346
             les_mean =     296.751137804316
             stat err =       0.000428968914
             autocorr =       1.150783749142
              std dev =       0.565514778743
             le_variance =       0.319806964977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319900473143
                                         uncertainty =       0.004281800687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319900473143
                                         uncertainty =       0.004281800687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400037326
  error estimate for blocks of size 2^( 2) =       0.000410075155
  error estimate for blocks of size 2^( 3) =       0.000418512085
  error estimate for blocks of size 2^( 4) =       0.000424972319
  error estimate for blocks of size 2^( 5) =       0.000428398518
  error estimate for blocks of size 2^( 6) =       0.000431159621
  error estimate for blocks of size 2^( 7) =       0.000431911323

      target function =                  N/A
              le_mean =     -17.217183609070
             les_mean =     296.751470992161
             stat err =       0.000429110445
             autocorr =       1.150633838515
              std dev =       0.565738211347
             le_variance =       0.320059723778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319865994587
                                         uncertainty =       0.004280995830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319865994587
                                         uncertainty =       0.004280995830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400015729
  error estimate for blocks of size 2^( 2) =       0.000410054140
  error estimate for blocks of size 2^( 3) =       0.000418492025
  error estimate for blocks of size 2^( 4) =       0.000424952040
  error estimate for blocks of size 2^( 5) =       0.000428378342
  error estimate for blocks of size 2^( 6) =       0.000431139190
  error estimate for blocks of size 2^( 7) =       0.000431890866

      target function =                  N/A
              le_mean =     -17.217182632795
             les_mean =     296.751402818237
             stat err =       0.000429090109
             autocorr =       1.150649017112
              std dev =       0.565707669403
             le_variance =       0.320025167221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319680892419
                                         uncertainty =       0.004277976168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319680892419
                                         uncertainty =       0.004277976168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399899873
  error estimate for blocks of size 2^( 2) =       0.000409942302
  error estimate for blocks of size 2^( 3) =       0.000418384693
  error estimate for blocks of size 2^( 4) =       0.000424846788
  error estimate for blocks of size 2^( 5) =       0.000428273486
  error estimate for blocks of size 2^( 6) =       0.000431036975
  error estimate for blocks of size 2^( 7) =       0.000431791047

      target function =                  N/A
              le_mean =     -17.217181396053
             les_mean =     296.751174880945
             stat err =       0.000428987074
             autocorr =       1.150762977344
              std dev =       0.565543823473
             le_variance =       0.319839816268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217181273346        initial
     2.5000e-01     2.5000e+00             4.6807e-04       -17.217183609070  <--
     1.0000e+00     1.0000e+01             1.5516e-04       -17.217182632795
     4.0000e+00     4.0000e+01             4.7091e-05       -17.217181396053

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.9926e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.178582
====================================================
  Execution time = 3.6383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1482e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314866334142
                                         uncertainty =       0.002798052225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314866334142
                                         uncertainty =       0.002798052225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396749664
  error estimate for blocks of size 2^( 2) =       0.000406665708
  error estimate for blocks of size 2^( 3) =       0.000415237744
  error estimate for blocks of size 2^( 4) =       0.000420697144
  error estimate for blocks of size 2^( 5) =       0.000424402621
  error estimate for blocks of size 2^( 6) =       0.000424601896
  error estimate for blocks of size 2^( 7) =       0.000428140635

      target function =                  N/A
              le_mean =     -17.217156634800
             les_mean =     296.745303021576
             stat err =       0.000424460574
             autocorr =       1.144567945871
              std dev =       0.561088755669
             le_variance =       0.314820591738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715663480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156634800       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217158619209       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217158459855       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217157941582       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217157982955       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217157972624       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217158227537       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217158150993       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217157416943       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217157340240       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 7.942061e-04

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156634800       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217158010334       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217158082008       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217157894836       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217157978125       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217157878029       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217158009084       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217157978904       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.994057e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156634800       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217157252374       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217157362410       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217157363322       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217157524998       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217157420583       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217157467003       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.352445e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5722e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.927156e-01 1 1  ON 0
 uu_1                 2.954193e-02 1 1  ON 1
 uu_2                -6.688697e-02 1 1  ON 2
 uu_3                -1.242539e-01 1 1  ON 3
 uu_4                -1.613515e-01 1 1  ON 4
 uu_5                -1.735222e-01 1 1  ON 5
 uu_6                -1.613488e-01 1 1  ON 6
 uu_7                -1.146447e-01 1 1  ON 7
 uu_8                -3.691978e-02 1 1  ON 8
 uu_9                 1.609379e-01 1 1  ON 9
 ud_0                 3.519278e-01 1 1  ON 10
 ud_1                 9.247042e-02 1 1  ON 11
 ud_2                -1.928292e-02 1 1  ON 12
 ud_3                -8.219488e-02 1 1  ON 13
 ud_4                -1.323499e-01 1 1  ON 14
 ud_5                -1.683494e-01 1 1  ON 15
 ud_6                -1.804093e-01 1 1  ON 16
 ud_7                -1.599404e-01 1 1  ON 17
 ud_8                -1.009829e-01 1 1  ON 18
 ud_9                -8.628104e-03 1 1  ON 19
 eO_0                -9.330930e-01 1 1  ON 20
 eO_1                -6.074355e-01 1 1  ON 21
 eO_2                -1.881168e-01 1 1  ON 22
 eO_3                 8.613196e-02 1 1  ON 23
 eO_4                 2.113774e-01 1 1  ON 24
 eO_5                 2.945622e-01 1 1  ON 25
 eO_6                 3.330049e-01 1 1  ON 26
 eO_7                 5.012312e-01 1 1  ON 27
 eO_8                 1.949589e-01 1 1  ON 28
 eO_9                 6.149724e-02 1 1  ON 29
eH1_0                -2.115681e-01 1 1  ON 30
eH1_1                -1.330348e-01 1 1  ON 31
eH1_2                -9.088112e-02 1 1  ON 32
eH1_3                -5.322889e-02 1 1  ON 33
eH1_4                -7.366215e-03 1 1  ON 34
eH1_5                 4.146599e-03 1 1  ON 35
eH1_6                 4.135599e-02 1 1  ON 36
eH1_7                 6.327768e-02 1 1  ON 37
eH1_8                 1.796734e-01 1 1  ON 38
eH1_9                 1.211296e-01 1 1  ON 39
eH2_0                -2.075613e-01 1 1  ON 40
eH2_1                -1.284986e-01 1 1  ON 41
eH2_2                -8.664132e-02 1 1  ON 42
eH2_3                -4.872006e-02 1 1  ON 43
eH2_4                -2.807598e-03 1 1  ON 44
eH2_5                 9.046485e-03 1 1  ON 45
eH2_6                 4.747236e-02 1 1  ON 46
eH2_7                 4.701879e-02 1 1  ON 47
eH2_8                 1.972864e-01 1 1  ON 48
eH2_9                 1.203442e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.183
    reference variance = 0.237203
====================================================
  Execution time = 3.3608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2015e-01
  Total weights = 2.0000e+06
  Execution time = 3.1414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320086439222
                                         uncertainty =       0.003745565455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320086439222
                                         uncertainty =       0.003745565455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400031462
  error estimate for blocks of size 2^( 2) =       0.000409831830
  error estimate for blocks of size 2^( 3) =       0.000418544694
  error estimate for blocks of size 2^( 4) =       0.000425932458
  error estimate for blocks of size 2^( 5) =       0.000431163321
  error estimate for blocks of size 2^( 6) =       0.000433960816
  error estimate for blocks of size 2^( 7) =       0.000435397334

      target function =                  N/A
              le_mean =     -17.216967384556
             les_mean =     296.744016102434
             stat err =       0.000431613482
             autocorr =       1.164130599863
              std dev =       0.565729919308
             le_variance =       0.320050341601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320304516532
                                         uncertainty =       0.003748462544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320304516532
                                         uncertainty =       0.003748462544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400167686
  error estimate for blocks of size 2^( 2) =       0.000409960359
  error estimate for blocks of size 2^( 3) =       0.000418665246
  error estimate for blocks of size 2^( 4) =       0.000426049021
  error estimate for blocks of size 2^( 5) =       0.000431267551
  error estimate for blocks of size 2^( 6) =       0.000434058138
  error estimate for blocks of size 2^( 7) =       0.000435500745

      target function =                  N/A
              le_mean =     -17.216966371369
             les_mean =     296.744199226214
             stat err =       0.000431718864
             autocorr =       1.163906300647
              std dev =       0.565922568466
             le_variance =       0.320268353499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320282237310
                                         uncertainty =       0.003748758177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320282237310
                                         uncertainty =       0.003748758177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400153773
  error estimate for blocks of size 2^( 2) =       0.000409945473
  error estimate for blocks of size 2^( 3) =       0.000418650591
  error estimate for blocks of size 2^( 4) =       0.000426035311
  error estimate for blocks of size 2^( 5) =       0.000431255154
  error estimate for blocks of size 2^( 6) =       0.000434040064
  error estimate for blocks of size 2^( 7) =       0.000435486276

      target function =                  N/A
              le_mean =     -17.216966536920
             les_mean =     296.744182657608
             stat err =       0.000431704201
             autocorr =       1.163908173037
              std dev =       0.565902892991
             le_variance =       0.320246084295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320127299999
                                         uncertainty =       0.003746277269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320127299999
                                         uncertainty =       0.003746277269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400056994
  error estimate for blocks of size 2^( 2) =       0.000409855153
  error estimate for blocks of size 2^( 3) =       0.000418566288
  error estimate for blocks of size 2^( 4) =       0.000425953296
  error estimate for blocks of size 2^( 5) =       0.000431182257
  error estimate for blocks of size 2^( 6) =       0.000433976433
  error estimate for blocks of size 2^( 7) =       0.000435415487

      target function =                  N/A
              le_mean =     -17.216967039771
             les_mean =     296.744045085610
             stat err =       0.000431631868
             autocorr =       1.164081184186
              std dev =       0.565766026814
             le_variance =       0.320091197096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216967384556        initial  <--
     6.2500e-02     6.2500e-01             7.9421e-04       -17.216966371369
     2.5000e-01     2.5000e+00             3.9941e-04       -17.216966536920
     1.0000e+00     1.0000e+01             1.3524e-04       -17.216967039771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4257
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1884
    reference variance = 0.155094
====================================================
  Execution time = 3.4224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322289176100
                                         uncertainty =       0.004520478520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322289176100
                                         uncertainty =       0.004520478520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401410149
  error estimate for blocks of size 2^( 2) =       0.000410661019
  error estimate for blocks of size 2^( 3) =       0.000418906561
  error estimate for blocks of size 2^( 4) =       0.000425216062
  error estimate for blocks of size 2^( 5) =       0.000429536737
  error estimate for blocks of size 2^( 6) =       0.000431287085
  error estimate for blocks of size 2^( 7) =       0.000433004140

      target function =                  N/A
              le_mean =     -17.217398479721
             les_mean =     296.761070463691
             stat err =       0.000429761006
             autocorr =       1.146244640568
              std dev =       0.567679676685
             le_variance =       0.322260215321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721739847972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217398479721       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217398765342       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217398570243       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217398157940       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217398092893       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217398249205       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217398375189       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217398452027       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.677876e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217398479721       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217398572424       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217398525145       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217398404105       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217398357365       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217398405344       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217398442449       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.697544e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217398479721       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217398504764       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217398493325       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217398461963       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217398447075       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217398459568       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217398469537       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.717634e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3507e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.927672e-01 1 1  ON 0
 uu_1                 2.951850e-02 1 1  ON 1
 uu_2                -6.698696e-02 1 1  ON 2
 uu_3                -1.243850e-01 1 1  ON 3
 uu_4                -1.612207e-01 1 1  ON 4
 uu_5                -1.735355e-01 1 1  ON 5
 uu_6                -1.613250e-01 1 1  ON 6
 uu_7                -1.145948e-01 1 1  ON 7
 uu_8                -3.690526e-02 1 1  ON 8
 uu_9                 1.610251e-01 1 1  ON 9
 ud_0                 3.518551e-01 1 1  ON 10
 ud_1                 9.235047e-02 1 1  ON 11
 ud_2                -1.915079e-02 1 1  ON 12
 ud_3                -8.227839e-02 1 1  ON 13
 ud_4                -1.323107e-01 1 1  ON 14
 ud_5                -1.684082e-01 1 1  ON 15
 ud_6                -1.803068e-01 1 1  ON 16
 ud_7                -1.600021e-01 1 1  ON 17
 ud_8                -1.008798e-01 1 1  ON 18
 ud_9                -8.564311e-03 1 1  ON 19
 eO_0                -9.330019e-01 1 1  ON 20
 eO_1                -6.074666e-01 1 1  ON 21
 eO_2                -1.879391e-01 1 1  ON 22
 eO_3                 8.606391e-02 1 1  ON 23
 eO_4                 2.112704e-01 1 1  ON 24
 eO_5                 2.944606e-01 1 1  ON 25
 eO_6                 3.330647e-01 1 1  ON 26
 eO_7                 5.012768e-01 1 1  ON 27
 eO_8                 1.949111e-01 1 1  ON 28
 eO_9                 6.148769e-02 1 1  ON 29
eH1_0                -2.117081e-01 1 1  ON 30
eH1_1                -1.328303e-01 1 1  ON 31
eH1_2                -9.092525e-02 1 1  ON 32
eH1_3                -5.311004e-02 1 1  ON 33
eH1_4                -7.738835e-03 1 1  ON 34
eH1_5                 4.293577e-03 1 1  ON 35
eH1_6                 4.140164e-02 1 1  ON 36
eH1_7                 6.334470e-02 1 1  ON 37
eH1_8                 1.796744e-01 1 1  ON 38
eH1_9                 1.211102e-01 1 1  ON 39
eH2_0                -2.075352e-01 1 1  ON 40
eH2_1                -1.283871e-01 1 1  ON 41
eH2_2                -8.642609e-02 1 1  ON 42
eH2_3                -4.862934e-02 1 1  ON 43
eH2_4                -2.680363e-03 1 1  ON 44
eH2_5                 8.856517e-03 1 1  ON 45
eH2_6                 4.725719e-02 1 1  ON 46
eH2_7                 4.685393e-02 1 1  ON 47
eH2_8                 1.973152e-01 1 1  ON 48
eH2_9                 1.203319e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2595
    reference variance = 0.243186
====================================================
  Execution time = 3.3360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1672e-01
  Total weights = 2.0000e+06
  Execution time = 3.1318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316767048326
                                         uncertainty =       0.002944112540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316767048326
                                         uncertainty =       0.002944112540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397938334
  error estimate for blocks of size 2^( 2) =       0.000408118941
  error estimate for blocks of size 2^( 3) =       0.000416961190
  error estimate for blocks of size 2^( 4) =       0.000423624351
  error estimate for blocks of size 2^( 5) =       0.000427263342
  error estimate for blocks of size 2^( 6) =       0.000428636472
  error estimate for blocks of size 2^( 7) =       0.000427170114

      target function =                  N/A
              le_mean =     -17.217305762352
             les_mean =     296.752327390523
             stat err =       0.000426673570
             autocorr =       1.149634872609
              std dev =       0.562769788237
             le_variance =       0.316709834552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807946332
                                         uncertainty =       0.002944430576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807946332
                                         uncertainty =       0.002944430576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397964007
  error estimate for blocks of size 2^( 2) =       0.000408144945
  error estimate for blocks of size 2^( 3) =       0.000416986950
  error estimate for blocks of size 2^( 4) =       0.000423649652
  error estimate for blocks of size 2^( 5) =       0.000427290905
  error estimate for blocks of size 2^( 6) =       0.000428662952
  error estimate for blocks of size 2^( 7) =       0.000427196370

      target function =                  N/A
              le_mean =     -17.217305655551
             les_mean =     296.752364579450
             stat err =       0.000426699970
             autocorr =       1.149628799785
              std dev =       0.562806095511
             le_variance =       0.316750701144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316796829419
                                         uncertainty =       0.002944393298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316796829419
                                         uncertainty =       0.002944393298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397957028
  error estimate for blocks of size 2^( 2) =       0.000408137792
  error estimate for blocks of size 2^( 3) =       0.000416979852
  error estimate for blocks of size 2^( 4) =       0.000423642768
  error estimate for blocks of size 2^( 5) =       0.000427283346
  error estimate for blocks of size 2^( 6) =       0.000428655818
  error estimate for blocks of size 2^( 7) =       0.000427189316

      target function =                  N/A
              le_mean =     -17.217305608248
             les_mean =     296.752351842289
             stat err =       0.000426692812
             autocorr =       1.149630547790
              std dev =       0.562796226764
             le_variance =       0.316739592860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316771119558
                                         uncertainty =       0.002944154579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316771119558
                                         uncertainty =       0.002944154579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397940889
  error estimate for blocks of size 2^( 2) =       0.000408121521
  error estimate for blocks of size 2^( 3) =       0.000416963755
  error estimate for blocks of size 2^( 4) =       0.000423626888
  error estimate for blocks of size 2^( 5) =       0.000427266108
  error estimate for blocks of size 2^( 6) =       0.000428639161
  error estimate for blocks of size 2^( 7) =       0.000427172783

      target function =                  N/A
              le_mean =     -17.217305737013
             les_mean =     296.752330585740
             stat err =       0.000426676235
             autocorr =       1.149634469036
              std dev =       0.562773402292
             le_variance =       0.316713902328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217305762352        initial  <--
     6.2500e-01     6.2500e+00             2.6779e-04       -17.217305655551
     2.5000e+00     2.5000e+01             6.6975e-05       -17.217305608248
     1.0000e+01     1.0000e+02             1.7176e-05       -17.217305737013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1154
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.432319
====================================================
  Execution time = 3.4145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319503438271
                                         uncertainty =       0.003138386733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319503438271
                                         uncertainty =       0.003138386733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399710613
  error estimate for blocks of size 2^( 2) =       0.000409066541
  error estimate for blocks of size 2^( 3) =       0.000418006744
  error estimate for blocks of size 2^( 4) =       0.000424060269
  error estimate for blocks of size 2^( 5) =       0.000429256964
  error estimate for blocks of size 2^( 6) =       0.000429736049
  error estimate for blocks of size 2^( 7) =       0.000430775408

      target function =                  N/A
              le_mean =     -17.216730984642
             les_mean =     296.735362785657
             stat err =       0.000428457173
             autocorr =       1.149009121046
              std dev =       0.565276169580
             le_variance =       0.319537147895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673098464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216730984642       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731054916       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731127078       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731178797       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731150339       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731148731       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216731155352       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.903712e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216730984642       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731002533       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731021546       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216731035483       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216731028225       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216731027630       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216731028774       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 4.800128e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216730984642       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216730989135       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216730993953       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216730997504       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216730995683       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216730995524       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216730995775       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.202668e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119119 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3641e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.927936e-01 1 1  ON 0
 uu_1                 2.954477e-02 1 1  ON 1
 uu_2                -6.698777e-02 1 1  ON 2
 uu_3                -1.243973e-01 1 1  ON 3
 uu_4                -1.612455e-01 1 1  ON 4
 uu_5                -1.735649e-01 1 1  ON 5
 uu_6                -1.613344e-01 1 1  ON 6
 uu_7                -1.145723e-01 1 1  ON 7
 uu_8                -3.689642e-02 1 1  ON 8
 uu_9                 1.610325e-01 1 1  ON 9
 ud_0                 3.518036e-01 1 1  ON 10
 ud_1                 9.234187e-02 1 1  ON 11
 ud_2                -1.917797e-02 1 1  ON 12
 ud_3                -8.226296e-02 1 1  ON 13
 ud_4                -1.323030e-01 1 1  ON 14
 ud_5                -1.683519e-01 1 1  ON 15
 ud_6                -1.802895e-01 1 1  ON 16
 ud_7                -1.600035e-01 1 1  ON 17
 ud_8                -1.008734e-01 1 1  ON 18
 ud_9                -8.567675e-03 1 1  ON 19
 eO_0                -9.329809e-01 1 1  ON 20
 eO_1                -6.074477e-01 1 1  ON 21
 eO_2                -1.879020e-01 1 1  ON 22
 eO_3                 8.603132e-02 1 1  ON 23
 eO_4                 2.112082e-01 1 1  ON 24
 eO_5                 2.944684e-01 1 1  ON 25
 eO_6                 3.330776e-01 1 1  ON 26
 eO_7                 5.012829e-01 1 1  ON 27
 eO_8                 1.949063e-01 1 1  ON 28
 eO_9                 6.148530e-02 1 1  ON 29
eH1_0                -2.117104e-01 1 1  ON 30
eH1_1                -1.328603e-01 1 1  ON 31
eH1_2                -9.092035e-02 1 1  ON 32
eH1_3                -5.306697e-02 1 1  ON 33
eH1_4                -7.762156e-03 1 1  ON 34
eH1_5                 4.304465e-03 1 1  ON 35
eH1_6                 4.139341e-02 1 1  ON 36
eH1_7                 6.335256e-02 1 1  ON 37
eH1_8                 1.796755e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075230e-01 1 1  ON 40
eH2_1                -1.284220e-01 1 1  ON 41
eH2_2                -8.644543e-02 1 1  ON 42
eH2_3                -4.862542e-02 1 1  ON 43
eH2_4                -2.656633e-03 1 1  ON 44
eH2_5                 8.874649e-03 1 1  ON 45
eH2_6                 4.725216e-02 1 1  ON 46
eH2_7                 4.685538e-02 1 1  ON 47
eH2_8                 1.973191e-01 1 1  ON 48
eH2_9                 1.203300e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.0971
    reference variance = 0.196225
====================================================
  Execution time = 3.4328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1650e-01
  Total weights = 2.0000e+06
  Execution time = 3.1344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316556827439
                                         uncertainty =       0.003104956144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316556827439
                                         uncertainty =       0.003104956144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397802737
  error estimate for blocks of size 2^( 2) =       0.000407022566
  error estimate for blocks of size 2^( 3) =       0.000415506938
  error estimate for blocks of size 2^( 4) =       0.000420942293
  error estimate for blocks of size 2^( 5) =       0.000424531320
  error estimate for blocks of size 2^( 6) =       0.000425819558
  error estimate for blocks of size 2^( 7) =       0.000426456668

      target function =                  N/A
              le_mean =     -17.216634346648
             les_mean =     296.728992102892
             stat err =       0.000424437460
             autocorr =       1.138392117370
              std dev =       0.562578025650
             le_variance =       0.316494034944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316570020027
                                         uncertainty =       0.003105153032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316570020027
                                         uncertainty =       0.003105153032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397811027
  error estimate for blocks of size 2^( 2) =       0.000407030674
  error estimate for blocks of size 2^( 3) =       0.000415514862
  error estimate for blocks of size 2^( 4) =       0.000420949963
  error estimate for blocks of size 2^( 5) =       0.000424539023
  error estimate for blocks of size 2^( 6) =       0.000425827212
  error estimate for blocks of size 2^( 7) =       0.000426464424

      target function =                  N/A
              le_mean =     -17.216634216391
             les_mean =     296.729000808420
             stat err =       0.000424445155
             autocorr =       1.138385953889
              std dev =       0.562589748993
             le_variance =       0.316507225672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316563744088
                                         uncertainty =       0.003105059865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316563744088
                                         uncertainty =       0.003105059865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397807083
  error estimate for blocks of size 2^( 2) =       0.000407026815
  error estimate for blocks of size 2^( 3) =       0.000415511093
  error estimate for blocks of size 2^( 4) =       0.000420946313
  error estimate for blocks of size 2^( 5) =       0.000424535355
  error estimate for blocks of size 2^( 6) =       0.000425823569
  error estimate for blocks of size 2^( 7) =       0.000426460729

      target function =                  N/A
              le_mean =     -17.216634278429
             les_mean =     296.728996669556
             stat err =       0.000424441491
             autocorr =       1.138388868945
              std dev =       0.562584172051
             le_variance =       0.316500950643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316557702692
                                         uncertainty =       0.003104969288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316557702692
                                         uncertainty =       0.003104969288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397803287
  error estimate for blocks of size 2^( 2) =       0.000407023103
  error estimate for blocks of size 2^( 3) =       0.000415507464
  error estimate for blocks of size 2^( 4) =       0.000420942802
  error estimate for blocks of size 2^( 5) =       0.000424531831
  error estimate for blocks of size 2^( 6) =       0.000425820065
  error estimate for blocks of size 2^( 7) =       0.000426457182

      target function =                  N/A
              le_mean =     -17.216634337984
             les_mean =     296.728992679689
             stat err =       0.000424437970
             autocorr =       1.138391705395
              std dev =       0.562578803438
             le_variance =       0.316494910078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216634346648        initial  <--
     6.2500e+00     6.2500e+01             1.9037e-05       -17.216634216391
     2.5000e+01     2.5000e+02             4.8001e-06       -17.216634278429
     1.0000e+02     1.0000e+03             1.2027e-06       -17.216634337984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.0748
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.248992
====================================================
  Execution time = 3.6761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325380039103
                                         uncertainty =       0.005599023209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325380039103
                                         uncertainty =       0.005599023209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403307696
  error estimate for blocks of size 2^( 2) =       0.000413196938
  error estimate for blocks of size 2^( 3) =       0.000421344639
  error estimate for blocks of size 2^( 4) =       0.000427244262
  error estimate for blocks of size 2^( 5) =       0.000431336610
  error estimate for blocks of size 2^( 6) =       0.000433891135
  error estimate for blocks of size 2^( 7) =       0.000433126962

      target function =                  N/A
              le_mean =     -17.216260665011
             les_mean =     296.724945317957
             stat err =       0.000431399742
             autocorr =       1.144159957178
              std dev =       0.570363213224
             le_variance =       0.325314194999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626066501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216260665011       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216260667110       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216260670890       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216260672647       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216260673452       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216260675270       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216260674445       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.233042e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216260665011       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216260665538       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216260666488       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216260666927       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216260667129       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216260667586       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216260667380       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.116644e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216260665011       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216260665143       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216260665381       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216260665491       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216260665540       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216260665657       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216260665603       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.031302e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6119e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.927904e-01 1 1  ON 0
 uu_1                 2.954685e-02 1 1  ON 1
 uu_2                -6.698688e-02 1 1  ON 2
 uu_3                -1.243959e-01 1 1  ON 3
 uu_4                -1.612479e-01 1 1  ON 4
 uu_5                -1.735665e-01 1 1  ON 5
 uu_6                -1.613334e-01 1 1  ON 6
 uu_7                -1.145705e-01 1 1  ON 7
 uu_8                -3.689549e-02 1 1  ON 8
 uu_9                 1.610330e-01 1 1  ON 9
 ud_0                 3.518008e-01 1 1  ON 10
 ud_1                 9.234141e-02 1 1  ON 11
 ud_2                -1.917805e-02 1 1  ON 12
 ud_3                -8.226455e-02 1 1  ON 13
 ud_4                -1.322987e-01 1 1  ON 14
 ud_5                -1.683488e-01 1 1  ON 15
 ud_6                -1.802929e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008714e-01 1 1  ON 18
 ud_9                -8.567409e-03 1 1  ON 19
 eO_0                -9.329806e-01 1 1  ON 20
 eO_1                -6.074460e-01 1 1  ON 21
 eO_2                -1.878993e-01 1 1  ON 22
 eO_3                 8.603108e-02 1 1  ON 23
 eO_4                 2.112037e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330778e-01 1 1  ON 26
 eO_7                 5.012838e-01 1 1  ON 27
 eO_8                 1.949061e-01 1 1  ON 28
 eO_9                 6.148510e-02 1 1  ON 29
eH1_0                -2.117100e-01 1 1  ON 30
eH1_1                -1.328594e-01 1 1  ON 31
eH1_2                -9.091965e-02 1 1  ON 32
eH1_3                -5.306699e-02 1 1  ON 33
eH1_4                -7.764978e-03 1 1  ON 34
eH1_5                 4.304256e-03 1 1  ON 35
eH1_6                 4.139237e-02 1 1  ON 36
eH1_7                 6.335414e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211089e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284190e-01 1 1  ON 41
eH2_2                -8.644447e-02 1 1  ON 42
eH2_3                -4.862313e-02 1 1  ON 43
eH2_4                -2.657956e-03 1 1  ON 44
eH2_5                 8.872369e-03 1 1  ON 45
eH2_6                 4.725119e-02 1 1  ON 46
eH2_7                 4.685518e-02 1 1  ON 47
eH2_8                 1.973194e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.40572
====================================================
  Execution time = 3.3556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2053e-01
  Total weights = 2.0000e+06
  Execution time = 3.1310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320614481108
                                         uncertainty =       0.003038163183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320614481108
                                         uncertainty =       0.003038163183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400328223
  error estimate for blocks of size 2^( 2) =       0.000409852308
  error estimate for blocks of size 2^( 3) =       0.000418390540
  error estimate for blocks of size 2^( 4) =       0.000425227602
  error estimate for blocks of size 2^( 5) =       0.000428899588
  error estimate for blocks of size 2^( 6) =       0.000430880700
  error estimate for blocks of size 2^( 7) =       0.000432026668

      target function =                  N/A
              le_mean =     -17.217378698347
             les_mean =     296.758654453950
             stat err =       0.000429258639
             autocorr =       1.149755967188
              std dev =       0.566149602068
             le_variance =       0.320525371922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320617161693
                                         uncertainty =       0.003038184443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320617161693
                                         uncertainty =       0.003038184443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400329896
  error estimate for blocks of size 2^( 2) =       0.000409853911
  error estimate for blocks of size 2^( 3) =       0.000418392052
  error estimate for blocks of size 2^( 4) =       0.000425229101
  error estimate for blocks of size 2^( 5) =       0.000428901048
  error estimate for blocks of size 2^( 6) =       0.000430882093
  error estimate for blocks of size 2^( 7) =       0.000432028004

      target function =                  N/A
              le_mean =     -17.217378682657
             les_mean =     296.758656593217
             stat err =       0.000429260061
             autocorr =       1.149753972476
              std dev =       0.566151968532
             le_variance =       0.320528051472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320615827009
                                         uncertainty =       0.003038173856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320615827009
                                         uncertainty =       0.003038173856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400329063
  error estimate for blocks of size 2^( 2) =       0.000409853113
  error estimate for blocks of size 2^( 3) =       0.000418391299
  error estimate for blocks of size 2^( 4) =       0.000425228355
  error estimate for blocks of size 2^( 5) =       0.000428900321
  error estimate for blocks of size 2^( 6) =       0.000430881399
  error estimate for blocks of size 2^( 7) =       0.000432027339

      target function =                  N/A
              le_mean =     -17.217378690464
             les_mean =     296.758655527896
             stat err =       0.000429259353
             autocorr =       1.149754965504
              std dev =       0.566150790252
             le_variance =       0.320526717303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320614649517
                                         uncertainty =       0.003038164518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320614649517
                                         uncertainty =       0.003038164518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400328328
  error estimate for blocks of size 2^( 2) =       0.000409852408
  error estimate for blocks of size 2^( 3) =       0.000418390635
  error estimate for blocks of size 2^( 4) =       0.000425227696
  error estimate for blocks of size 2^( 5) =       0.000428899679
  error estimate for blocks of size 2^( 6) =       0.000430880787
  error estimate for blocks of size 2^( 7) =       0.000432026752

      target function =                  N/A
              le_mean =     -17.217378697360
             les_mean =     296.758654588303
             stat err =       0.000429258729
             autocorr =       1.149755841841
              std dev =       0.566149750742
             le_variance =       0.320525540265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217378698347        initial  <--
     6.2500e+01     6.2500e+02             3.2330e-06       -17.217378682657
     2.5000e+02     2.5000e+03             8.1166e-07       -17.217378690464
     1.0000e+03     1.0000e+04             2.0313e-07       -17.217378697360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2547
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2647
    reference variance = 0.263413
====================================================
  Execution time = 3.4589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1664e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654801665
                                         uncertainty =       0.003534080797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654801665
                                         uncertainty =       0.003534080797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397892817
  error estimate for blocks of size 2^( 2) =       0.000407333400
  error estimate for blocks of size 2^( 3) =       0.000416298057
  error estimate for blocks of size 2^( 4) =       0.000422887116
  error estimate for blocks of size 2^( 5) =       0.000426403876
  error estimate for blocks of size 2^( 6) =       0.000429541660
  error estimate for blocks of size 2^( 7) =       0.000430602074

      target function =                  N/A
              le_mean =     -17.216630144738
             les_mean =     296.728990770146
             stat err =       0.000427358681
             autocorr =       1.153593666483
              std dev =       0.562705418283
             le_variance =       0.316637387765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663014474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216630144738       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216630145051       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216630143328       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216630142778       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216630142817       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216630142618       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216630142553       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.129836e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216630144738       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216630144816       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216630144385       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216630144248       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216630144258       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216630144207       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216630144192       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 7.827012e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216630144738       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216630144758       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216630144650       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216630144615       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216630144619       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216630144608       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216630144603       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 1.956904e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4019e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954694e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243957e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613332e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689553e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518001e-01 1 1  ON 10
 ud_1                 9.234140e-02 1 1  ON 11
 ud_2                -1.917803e-02 1 1  ON 12
 ud_3                -8.226425e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567378e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878995e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091965e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765582e-03 1 1  ON 34
eH1_5                 4.304367e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335433e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284192e-01 1 1  ON 41
eH2_2                -8.644427e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657952e-03 1 1  ON 44
eH2_5                 8.872544e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685507e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0701
    reference variance = 0.56251
====================================================
  Execution time = 3.3288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2014e-01
  Total weights = 2.0000e+06
  Execution time = 3.1386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009549777
                                         uncertainty =       0.004532167660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009549777
                                         uncertainty =       0.004532167660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400088048
  error estimate for blocks of size 2^( 2) =       0.000409415683
  error estimate for blocks of size 2^( 3) =       0.000417264940
  error estimate for blocks of size 2^( 4) =       0.000423130726
  error estimate for blocks of size 2^( 5) =       0.000426886107
  error estimate for blocks of size 2^( 6) =       0.000429631742
  error estimate for blocks of size 2^( 7) =       0.000431553777

      target function =                  N/A
              le_mean =     -17.216610070416
             les_mean =     296.731803048272
             stat err =       0.000427800588
             autocorr =       1.143330001666
              std dev =       0.565809943009
             le_variance =       0.320140891608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009795193
                                         uncertainty =       0.004532171011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009795193
                                         uncertainty =       0.004532171011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400088201
  error estimate for blocks of size 2^( 2) =       0.000409415831
  error estimate for blocks of size 2^( 3) =       0.000417265082
  error estimate for blocks of size 2^( 4) =       0.000423130863
  error estimate for blocks of size 2^( 5) =       0.000426886241
  error estimate for blocks of size 2^( 6) =       0.000429631873
  error estimate for blocks of size 2^( 7) =       0.000431553909

      target function =                  N/A
              le_mean =     -17.216610070367
             les_mean =     296.731803292195
             stat err =       0.000427800722
             autocorr =       1.143329838455
              std dev =       0.565810160031
             le_variance =       0.320141137195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009672534
                                         uncertainty =       0.004532169336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009672534
                                         uncertainty =       0.004532169336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400088124
  error estimate for blocks of size 2^( 2) =       0.000409415757
  error estimate for blocks of size 2^( 3) =       0.000417265011
  error estimate for blocks of size 2^( 4) =       0.000423130794
  error estimate for blocks of size 2^( 5) =       0.000426886174
  error estimate for blocks of size 2^( 6) =       0.000429631808
  error estimate for blocks of size 2^( 7) =       0.000431553843

      target function =                  N/A
              le_mean =     -17.216610070391
             les_mean =     296.731803170278
             stat err =       0.000427800655
             autocorr =       1.143329920033
              std dev =       0.565810051564
             le_variance =       0.320141014450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009565123
                                         uncertainty =       0.004532167869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320009565123
                                         uncertainty =       0.004532167869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400088057
  error estimate for blocks of size 2^( 2) =       0.000409415693
  error estimate for blocks of size 2^( 3) =       0.000417264949
  error estimate for blocks of size 2^( 4) =       0.000423130734
  error estimate for blocks of size 2^( 5) =       0.000426886115
  error estimate for blocks of size 2^( 6) =       0.000429631750
  error estimate for blocks of size 2^( 7) =       0.000431553785

      target function =                  N/A
              le_mean =     -17.216610070413
             les_mean =     296.731803063524
             stat err =       0.000427800596
             autocorr =       1.143329991463
              std dev =       0.565809956579
             le_variance =       0.320140906964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216610070416        initial  <--
     6.2500e+02     6.2500e+03             3.1298e-07       -17.216610070367
     2.5000e+03     2.5000e+04             7.8270e-08       -17.216610070391
     1.0000e+04     1.0000e+05             1.9569e-08       -17.216610070413

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0660
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.369146
====================================================
  Execution time = 3.4646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2054e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320619286441
                                         uncertainty =       0.004442345938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320619286441
                                         uncertainty =       0.004442345938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400338344
  error estimate for blocks of size 2^( 2) =       0.000409647303
  error estimate for blocks of size 2^( 3) =       0.000418382589
  error estimate for blocks of size 2^( 4) =       0.000424600554
  error estimate for blocks of size 2^( 5) =       0.000428107748
  error estimate for blocks of size 2^( 6) =       0.000427386647
  error estimate for blocks of size 2^( 7) =       0.000428593985

      target function =                  N/A
              le_mean =     -17.217387145586
             les_mean =     296.758961540835
             stat err =       0.000427172234
             autocorr =       1.138548808727
              std dev =       0.566163916291
             le_variance =       0.320541580110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738714559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387145586       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387145655       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387145696       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387145664       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387145622       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387145625       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387145639       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.441336e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387145586       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387145603       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387145614       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387145601       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387145595       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387145601       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387145600       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 6.103474e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387145586       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387145590       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387145593       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387145584       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387145555       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387145536       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387145705       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 1.525876e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3980e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765615e-03 1 1  ON 34
eH1_5                 4.304380e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657970e-03 1 1  ON 44
eH2_5                 8.872562e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.3032
    reference variance = 0.505148
====================================================
  Execution time = 3.3638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2079e-01
  Total weights = 2.0000e+06
  Execution time = 3.1213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789124460
                                         uncertainty =       0.006333054353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789124460
                                         uncertainty =       0.006333054353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400493968
  error estimate for blocks of size 2^( 2) =       0.000410191272
  error estimate for blocks of size 2^( 3) =       0.000418527254
  error estimate for blocks of size 2^( 4) =       0.000424522592
  error estimate for blocks of size 2^( 5) =       0.000429029473
  error estimate for blocks of size 2^( 6) =       0.000431110067
  error estimate for blocks of size 2^( 7) =       0.000434139647

      target function =                  N/A
              le_mean =     -17.216321707446
             les_mean =     296.722523810056
             stat err =       0.000429700445
             autocorr =       1.151170493115
              std dev =       0.566384000647
             le_variance =       0.320790836188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789136555
                                         uncertainty =       0.006333054350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789136555
                                         uncertainty =       0.006333054350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400493975
  error estimate for blocks of size 2^( 2) =       0.000410191279
  error estimate for blocks of size 2^( 3) =       0.000418527260
  error estimate for blocks of size 2^( 4) =       0.000424522599
  error estimate for blocks of size 2^( 5) =       0.000429029479
  error estimate for blocks of size 2^( 6) =       0.000431110073
  error estimate for blocks of size 2^( 7) =       0.000434139653

      target function =                  N/A
              le_mean =     -17.216321707388
             les_mean =     296.722523820170
             stat err =       0.000429700451
             autocorr =       1.151170481254
              std dev =       0.566384011327
             le_variance =       0.320790848287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789130507
                                         uncertainty =       0.006333054352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789130507
                                         uncertainty =       0.006333054352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400493971
  error estimate for blocks of size 2^( 2) =       0.000410191276
  error estimate for blocks of size 2^( 3) =       0.000418527257
  error estimate for blocks of size 2^( 4) =       0.000424522595
  error estimate for blocks of size 2^( 5) =       0.000429029476
  error estimate for blocks of size 2^( 6) =       0.000431110070
  error estimate for blocks of size 2^( 7) =       0.000434139650

      target function =                  N/A
              le_mean =     -17.216321707417
             les_mean =     296.722523815113
             stat err =       0.000429700448
             autocorr =       1.151170487180
              std dev =       0.566384005987
             le_variance =       0.320790842238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789125216
                                         uncertainty =       0.006333054353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320789125216
                                         uncertainty =       0.006333054353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400493968
  error estimate for blocks of size 2^( 2) =       0.000410191272
  error estimate for blocks of size 2^( 3) =       0.000418527254
  error estimate for blocks of size 2^( 4) =       0.000424522593
  error estimate for blocks of size 2^( 5) =       0.000429029474
  error estimate for blocks of size 2^( 6) =       0.000431110068
  error estimate for blocks of size 2^( 7) =       0.000434139648

      target function =                  N/A
              le_mean =     -17.216321707442
             les_mean =     296.722523810688
             stat err =       0.000429700445
             autocorr =       1.151170492370
              std dev =       0.566384001314
             le_variance =       0.320790836945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216321707446        initial  <--
     6.2500e+03     6.2500e+04             2.4413e-08       -17.216321707388
     2.5000e+04     2.5000e+05             6.1035e-09       -17.216321707417
     1.0000e+05     1.0000e+06             1.5259e-09       -17.216321707442

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3297
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765621e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.207008
====================================================
  Execution time = 3.4458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2038e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320414828040
                                         uncertainty =       0.003554573592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320414828040
                                         uncertainty =       0.003554573592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400235887
  error estimate for blocks of size 2^( 2) =       0.000409899075
  error estimate for blocks of size 2^( 3) =       0.000418311043
  error estimate for blocks of size 2^( 4) =       0.000424639877
  error estimate for blocks of size 2^( 5) =       0.000427983313
  error estimate for blocks of size 2^( 6) =       0.000429465515
  error estimate for blocks of size 2^( 7) =       0.000430954755

      target function =                  N/A
              le_mean =     -17.216848015721
             les_mean =     296.740232966736
             stat err =       0.000428260865
             autocorr =       1.144945266770
              std dev =       0.566019019537
             le_variance =       0.320377530478


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684801572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216848015721       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216848015718       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216848015698       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216848015691       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216848015683       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216848015681       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216848015706       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 2.702919e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216848015721       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216848015720       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216848015716       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216848015675       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216848015697       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216848015872       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216848015606       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 6.757338e-10

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216848015721       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216848015721       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216848015720       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216848015719       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216848015719       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216848015962       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216848016333       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+06 is 1.689337e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7216e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765620e-03 1 1  ON 34
eH1_5                 4.304379e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2039
    reference variance = 0.363304
====================================================
  Execution time = 3.5265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1687e-01
  Total weights = 2.0000e+06
  Execution time = 3.1295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559553
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559553
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398039267
  error estimate for blocks of size 2^( 2) =       0.000407806390
  error estimate for blocks of size 2^( 3) =       0.000416189161
  error estimate for blocks of size 2^( 4) =       0.000421932600
  error estimate for blocks of size 2^( 5) =       0.000426291389
  error estimate for blocks of size 2^( 6) =       0.000428671972
  error estimate for blocks of size 2^( 7) =       0.000431679143

      target function =                  N/A
              le_mean =     -17.217118417602
             les_mean =     296.746036964134
             stat err =       0.000427143776
             autocorr =       1.151585873529
              std dev =       0.562912530361
             le_variance =       0.316870516837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849558915
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849558915
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398039267
  error estimate for blocks of size 2^( 2) =       0.000407806390
  error estimate for blocks of size 2^( 3) =       0.000416189160
  error estimate for blocks of size 2^( 4) =       0.000421932600
  error estimate for blocks of size 2^( 5) =       0.000426291389
  error estimate for blocks of size 2^( 6) =       0.000428671971
  error estimate for blocks of size 2^( 7) =       0.000431679142

      target function =                  N/A
              le_mean =     -17.217118417614
             les_mean =     296.746036963922
             stat err =       0.000427143776
             autocorr =       1.151585873456
              std dev =       0.562912529795
             le_variance =       0.316870516200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559234
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559234
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398039267
  error estimate for blocks of size 2^( 2) =       0.000407806390
  error estimate for blocks of size 2^( 3) =       0.000416189160
  error estimate for blocks of size 2^( 4) =       0.000421932600
  error estimate for blocks of size 2^( 5) =       0.000426291389
  error estimate for blocks of size 2^( 6) =       0.000428671972
  error estimate for blocks of size 2^( 7) =       0.000431679142

      target function =                  N/A
              le_mean =     -17.217118417608
             les_mean =     296.746036964028
             stat err =       0.000427143776
             autocorr =       1.151585873494
              std dev =       0.562912530078
             le_variance =       0.316870516519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559513
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316849559513
                                         uncertainty =       0.003080682236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398039267
  error estimate for blocks of size 2^( 2) =       0.000407806390
  error estimate for blocks of size 2^( 3) =       0.000416189161
  error estimate for blocks of size 2^( 4) =       0.000421932600
  error estimate for blocks of size 2^( 5) =       0.000426291389
  error estimate for blocks of size 2^( 6) =       0.000428671972
  error estimate for blocks of size 2^( 7) =       0.000431679143

      target function =                  N/A
              le_mean =     -17.217118417603
             les_mean =     296.746036964120
             stat err =       0.000427143776
             autocorr =       1.151585873519
              std dev =       0.562912530325
             le_variance =       0.316870516797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217118417602        initial
     6.2500e+04     6.2500e+05             2.7029e-09       -17.217118417614  <--
     2.5000e+05     2.5000e+06             6.7573e-10       -17.217118417608
     1.0000e+06     1.0000e+07             1.6893e-10       -17.217118417603

*****************************************************************************
Applying the update for shift_i =   6.2500e+04     and shift_s =   6.2500e+05
*****************************************************************************

  Execution time = 5.0956e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329807e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765619e-03 1 1  ON 34
eH1_5                 4.304380e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657969e-03 1 1  ON 44
eH2_5                 8.872563e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.8215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3738
    reference variance = 0.410817
====================================================
  Execution time = 3.4159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335474843285
                                         uncertainty =       0.009777530932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335474843285
                                         uncertainty =       0.009777530932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409459055
  error estimate for blocks of size 2^( 2) =       0.000418736023
  error estimate for blocks of size 2^( 3) =       0.000426872272
  error estimate for blocks of size 2^( 4) =       0.000432972375
  error estimate for blocks of size 2^( 5) =       0.000436504848
  error estimate for blocks of size 2^( 6) =       0.000438823315
  error estimate for blocks of size 2^( 7) =       0.000440935406

      target function =                  N/A
              le_mean =     -17.217163644492
             les_mean =     296.766037228981
             stat err =       0.000437308986
             autocorr =       1.140659030837
              std dev =       0.579062548788
             le_variance =       0.335313435409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716364449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163644492       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163644583       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163644599       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163644616       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163644593       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163644599       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163644573       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 8.120806e-09

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163644492       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163644515       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163644519       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163644523       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163644486       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163644534       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163644513       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 2.030226e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163644492       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163644498       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163644499       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163644500       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163644474       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163644474       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163644512       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 5.075581e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3467e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112034e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148507e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306669e-02 1 1  ON 33
eH1_4                -7.765619e-03 1 1  ON 34
eH1_5                 4.304381e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657968e-03 1 1  ON 44
eH2_5                 8.872564e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1852
    reference variance = 0.182801
====================================================
  Execution time = 3.3744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2186e-01
  Total weights = 2.0000e+06
  Execution time = 3.1032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340288
                                         uncertainty =       0.003220698483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340288
                                         uncertainty =       0.003220698483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401157816
  error estimate for blocks of size 2^( 2) =       0.000410874145
  error estimate for blocks of size 2^( 3) =       0.000419172259
  error estimate for blocks of size 2^( 4) =       0.000426293784
  error estimate for blocks of size 2^( 5) =       0.000429878177
  error estimate for blocks of size 2^( 6) =       0.000431525204
  error estimate for blocks of size 2^( 7) =       0.000433582926

      target function =                  N/A
              le_mean =     -17.216236163133
             les_mean =     296.720642650547
             stat err =       0.000430320023
             autocorr =       1.150674773515
              std dev =       0.567322824058
             le_variance =       0.321855186697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752341710
                                         uncertainty =       0.003220698498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752341710
                                         uncertainty =       0.003220698498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401157817
  error estimate for blocks of size 2^( 2) =       0.000410874146
  error estimate for blocks of size 2^( 3) =       0.000419172260
  error estimate for blocks of size 2^( 4) =       0.000426293785
  error estimate for blocks of size 2^( 5) =       0.000429878177
  error estimate for blocks of size 2^( 6) =       0.000431525204
  error estimate for blocks of size 2^( 7) =       0.000433582926

      target function =                  N/A
              le_mean =     -17.216236163225
             les_mean =     296.720642655133
             stat err =       0.000430320023
             autocorr =       1.150674769903
              std dev =       0.567322825313
             le_variance =       0.321855188121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340999
                                         uncertainty =       0.003220698491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340999
                                         uncertainty =       0.003220698491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401157816
  error estimate for blocks of size 2^( 2) =       0.000410874146
  error estimate for blocks of size 2^( 3) =       0.000419172260
  error estimate for blocks of size 2^( 4) =       0.000426293785
  error estimate for blocks of size 2^( 5) =       0.000429878177
  error estimate for blocks of size 2^( 6) =       0.000431525204
  error estimate for blocks of size 2^( 7) =       0.000433582926

      target function =                  N/A
              le_mean =     -17.216236163179
             les_mean =     296.720642652840
             stat err =       0.000430320023
             autocorr =       1.150674771708
              std dev =       0.567322824686
             le_variance =       0.321855187409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340377
                                         uncertainty =       0.003220698484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321752340377
                                         uncertainty =       0.003220698484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401157816
  error estimate for blocks of size 2^( 2) =       0.000410874145
  error estimate for blocks of size 2^( 3) =       0.000419172259
  error estimate for blocks of size 2^( 4) =       0.000426293784
  error estimate for blocks of size 2^( 5) =       0.000429878177
  error estimate for blocks of size 2^( 6) =       0.000431525204
  error estimate for blocks of size 2^( 7) =       0.000433582926

      target function =                  N/A
              le_mean =     -17.216236163139
             les_mean =     296.720642650834
             stat err =       0.000430320023
             autocorr =       1.150674773284
              std dev =       0.567322824137
             le_variance =       0.321855186786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216236163133        initial
     1.5625e+04     1.5625e+05             8.1208e-09       -17.216236163225  <--
     6.2500e+04     6.2500e+05             2.0302e-09       -17.216236163179
     2.5000e+05     2.5000e+06             5.0756e-10       -17.216236163139

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 4.9344e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657965e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2125
    reference variance = 0.131814
====================================================
  Execution time = 3.4036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316932320285
                                         uncertainty =       0.003243947774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316932320285
                                         uncertainty =       0.003243947774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398062460
  error estimate for blocks of size 2^( 2) =       0.000407519442
  error estimate for blocks of size 2^( 3) =       0.000415683793
  error estimate for blocks of size 2^( 4) =       0.000421844210
  error estimate for blocks of size 2^( 5) =       0.000425413534
  error estimate for blocks of size 2^( 6) =       0.000427540070
  error estimate for blocks of size 2^( 7) =       0.000428838574

      target function =                  N/A
              le_mean =     -17.216898148269
             les_mean =     296.738489133080
             stat err =       0.000425909097
             autocorr =       1.144804657759
              std dev =       0.562945329200
             le_variance =       0.316907443668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689814827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898148269       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898148343       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216898148435       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216898148409       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216898148280       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216898148319       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216898148334       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 3.979438e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898148269       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898148287       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216898148310       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216898148304       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216898148269       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216898148278       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216898148286       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 9.948738e-09

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898148269       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898148274       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216898148279       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216898148266       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216898148266       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216898148258       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216898148325       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 2.487193e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3338e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698698e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917805e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567376e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765610e-03 1 1  ON 34
eH1_5                 4.304382e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657968e-03 1 1  ON 44
eH2_5                 8.872570e-03 1 1  ON 45
eH2_6                 4.725117e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.237195
====================================================
  Execution time = 3.3527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2165e-01
  Total weights = 2.0000e+06
  Execution time = 3.1250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641824854
                                         uncertainty =       0.003576965207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641824854
                                         uncertainty =       0.003576965207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401031439
  error estimate for blocks of size 2^( 2) =       0.000411021155
  error estimate for blocks of size 2^( 3) =       0.000419063932
  error estimate for blocks of size 2^( 4) =       0.000424967156
  error estimate for blocks of size 2^( 5) =       0.000428006713
  error estimate for blocks of size 2^( 6) =       0.000430095575
  error estimate for blocks of size 2^( 7) =       0.000430688225

      target function =                  N/A
              le_mean =     -17.217276406232
             les_mean =     296.756259117266
             stat err =       0.000428439417
             autocorr =       1.141358295028
              std dev =       0.567144099426
             le_variance =       0.321652429514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641830439
                                         uncertainty =       0.003576965209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641830439
                                         uncertainty =       0.003576965209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401031442
  error estimate for blocks of size 2^( 2) =       0.000411021158
  error estimate for blocks of size 2^( 3) =       0.000419063935
  error estimate for blocks of size 2^( 4) =       0.000424967159
  error estimate for blocks of size 2^( 5) =       0.000428006716
  error estimate for blocks of size 2^( 6) =       0.000430095578
  error estimate for blocks of size 2^( 7) =       0.000430688228

      target function =                  N/A
              le_mean =     -17.217276406199
             les_mean =     296.756259121739
             stat err =       0.000428439420
             autocorr =       1.141358290631
              std dev =       0.567144104346
             le_variance =       0.321652435094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641827647
                                         uncertainty =       0.003576965208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641827647
                                         uncertainty =       0.003576965208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401031440
  error estimate for blocks of size 2^( 2) =       0.000411021157
  error estimate for blocks of size 2^( 3) =       0.000419063934
  error estimate for blocks of size 2^( 4) =       0.000424967158
  error estimate for blocks of size 2^( 5) =       0.000428006714
  error estimate for blocks of size 2^( 6) =       0.000430095577
  error estimate for blocks of size 2^( 7) =       0.000430688226

      target function =                  N/A
              le_mean =     -17.217276406215
             les_mean =     296.756259119502
             stat err =       0.000428439419
             autocorr =       1.141358292834
              std dev =       0.567144101886
             le_variance =       0.321652432304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641825203
                                         uncertainty =       0.003576965207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321641825203
                                         uncertainty =       0.003576965207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401031439
  error estimate for blocks of size 2^( 2) =       0.000411021155
  error estimate for blocks of size 2^( 3) =       0.000419063932
  error estimate for blocks of size 2^( 4) =       0.000424967156
  error estimate for blocks of size 2^( 5) =       0.000428006713
  error estimate for blocks of size 2^( 6) =       0.000430095575
  error estimate for blocks of size 2^( 7) =       0.000430688225

      target function =                  N/A
              le_mean =     -17.217276406230
             les_mean =     296.756259117546
             stat err =       0.000428439417
             autocorr =       1.141358294751
              std dev =       0.567144099734
             le_variance =       0.321652429863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217276406232        initial  <--
     3.9062e+03     3.9062e+04             3.9794e-08       -17.217276406199
     1.5625e+04     1.5625e+05             9.9487e-09       -17.217276406215
     6.2500e+04     6.2500e+05             2.4872e-09       -17.217276406230

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2009
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657965e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1486
    reference variance = 0.858567
====================================================
  Execution time = 3.5012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2937e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329363990283
                                         uncertainty =       0.007158728664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329363990283
                                         uncertainty =       0.007158728664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405814152
  error estimate for blocks of size 2^( 2) =       0.000415576339
  error estimate for blocks of size 2^( 3) =       0.000424042646
  error estimate for blocks of size 2^( 4) =       0.000429529557
  error estimate for blocks of size 2^( 5) =       0.000432620536
  error estimate for blocks of size 2^( 6) =       0.000435969732
  error estimate for blocks of size 2^( 7) =       0.000440036249

      target function =                  N/A
              le_mean =     -17.216651537205
             les_mean =     296.742460241478
             stat err =       0.000434539019
             autocorr =       1.146576881997
              std dev =       0.573907878154
             le_variance =       0.329370252607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665153721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651537205       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651537229       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651537229       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651537226       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651537242       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651537248       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 3.066123e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651537205       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651537211       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651537211       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651537239       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651537322       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651537230       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 7.665350e-10

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216651537205       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651537207       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651537207       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216651537207       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216651537207       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216651537191       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 1.916342e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4483e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954692e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657965e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.166304
====================================================
  Execution time = 3.6168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4961e-01
  Total weights = 2.0000e+06
  Execution time = 3.1055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709252993
                                         uncertainty =       0.020325784020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709252993
                                         uncertainty =       0.020325784020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418095269
  error estimate for blocks of size 2^( 2) =       0.000427380720
  error estimate for blocks of size 2^( 3) =       0.000435608732
  error estimate for blocks of size 2^( 4) =       0.000441457075
  error estimate for blocks of size 2^( 5) =       0.000445209705
  error estimate for blocks of size 2^( 6) =       0.000447644410
  error estimate for blocks of size 2^( 7) =       0.000449040796

      target function =                  N/A
              le_mean =     -17.216763563738
             les_mean =     296.766554742813
             stat err =       0.000445837996
             autocorr =       1.137113066339
              std dev =       0.591275999817
             le_variance =       0.349607307959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709254565
                                         uncertainty =       0.020325784143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709254565
                                         uncertainty =       0.020325784143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418095270
  error estimate for blocks of size 2^( 2) =       0.000427380721
  error estimate for blocks of size 2^( 3) =       0.000435608733
  error estimate for blocks of size 2^( 4) =       0.000441457076
  error estimate for blocks of size 2^( 5) =       0.000445209705
  error estimate for blocks of size 2^( 6) =       0.000447644411
  error estimate for blocks of size 2^( 7) =       0.000449040796

      target function =                  N/A
              le_mean =     -17.216763563725
             les_mean =     296.766554743930
             stat err =       0.000445837997
             autocorr =       1.137113065287
              std dev =       0.591276001146
             le_variance =       0.349607309531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709253779
                                         uncertainty =       0.020325784081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709253779
                                         uncertainty =       0.020325784081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418095269
  error estimate for blocks of size 2^( 2) =       0.000427380720
  error estimate for blocks of size 2^( 3) =       0.000435608732
  error estimate for blocks of size 2^( 4) =       0.000441457075
  error estimate for blocks of size 2^( 5) =       0.000445209705
  error estimate for blocks of size 2^( 6) =       0.000447644411
  error estimate for blocks of size 2^( 7) =       0.000449040796

      target function =                  N/A
              le_mean =     -17.216763563731
             les_mean =     296.766554743372
             stat err =       0.000445837997
             autocorr =       1.137113065818
              std dev =       0.591276000481
             le_variance =       0.349607308745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709253092
                                         uncertainty =       0.020325784028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349709253092
                                         uncertainty =       0.020325784028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418095269
  error estimate for blocks of size 2^( 2) =       0.000427380720
  error estimate for blocks of size 2^( 3) =       0.000435608732
  error estimate for blocks of size 2^( 4) =       0.000441457075
  error estimate for blocks of size 2^( 5) =       0.000445209705
  error estimate for blocks of size 2^( 6) =       0.000447644410
  error estimate for blocks of size 2^( 7) =       0.000449040796

      target function =                  N/A
              le_mean =     -17.216763563737
             les_mean =     296.766554742883
             stat err =       0.000445837996
             autocorr =       1.137113066275
              std dev =       0.591275999900
             le_variance =       0.349607308057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216763563738        initial  <--
     3.9062e+04     3.9062e+05             3.0661e-09       -17.216763563725
     1.5625e+05     1.5625e+06             7.6653e-10       -17.216763563731
     6.2500e+05     6.2500e+06             1.9163e-10       -17.216763563737

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.7853
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657965e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2885
    reference variance = 0.439107
====================================================
  Execution time = 3.4456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319646863192
                                         uncertainty =       0.003727929342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319646863192
                                         uncertainty =       0.003727929342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399758566
  error estimate for blocks of size 2^( 2) =       0.000408877407
  error estimate for blocks of size 2^( 3) =       0.000417402054
  error estimate for blocks of size 2^( 4) =       0.000423679135
  error estimate for blocks of size 2^( 5) =       0.000427665419
  error estimate for blocks of size 2^( 6) =       0.000429927375
  error estimate for blocks of size 2^( 7) =       0.000431353944

      target function =                  N/A
              le_mean =     -17.216495598720
             les_mean =     296.727334362719
             stat err =       0.000428156468
             autocorr =       1.147121612224
              std dev =       0.565343985369
             le_variance =       0.319613821792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649559872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216495598720       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216495598720       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216495598718       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216495598719       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216495598639       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216495598528       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216495598429       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 3.164749e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216495598720       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216495598720       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216495598719       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216495598757       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216495599056       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216495598891       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216495598720       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 7.911891e-11

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216495598720       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216495598720       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216495598720       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216495598720       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216495601123       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216495598082       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216495600136       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 1.977979e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3806e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657965e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.291224
====================================================
  Execution time = 3.3487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1403e-01
  Total weights = 2.0000e+06
  Execution time = 3.0827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631613
                                         uncertainty =       0.003131339294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631613
                                         uncertainty =       0.003131339294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396249391
  error estimate for blocks of size 2^( 2) =       0.000405425203
  error estimate for blocks of size 2^( 3) =       0.000414557039
  error estimate for blocks of size 2^( 4) =       0.000421030509
  error estimate for blocks of size 2^( 5) =       0.000425243219
  error estimate for blocks of size 2^( 6) =       0.000428637802
  error estimate for blocks of size 2^( 7) =       0.000431443335

      target function =                  N/A
              le_mean =     -17.216398984539
             les_mean =     296.718420996869
             stat err =       0.000426588716
             autocorr =       1.158994868566
              std dev =       0.560381262221
             le_variance =       0.314027159048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631790
                                         uncertainty =       0.003131339299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631790
                                         uncertainty =       0.003131339299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396249391
  error estimate for blocks of size 2^( 2) =       0.000405425203
  error estimate for blocks of size 2^( 3) =       0.000414557040
  error estimate for blocks of size 2^( 4) =       0.000421030509
  error estimate for blocks of size 2^( 5) =       0.000425243219
  error estimate for blocks of size 2^( 6) =       0.000428637802
  error estimate for blocks of size 2^( 7) =       0.000431443335

      target function =                  N/A
              le_mean =     -17.216398984539
             les_mean =     296.718420997054
             stat err =       0.000426588717
             autocorr =       1.158994868466
              std dev =       0.560381262380
             le_variance =       0.314027159226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631701
                                         uncertainty =       0.003131339296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631701
                                         uncertainty =       0.003131339296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396249391
  error estimate for blocks of size 2^( 2) =       0.000405425203
  error estimate for blocks of size 2^( 3) =       0.000414557039
  error estimate for blocks of size 2^( 4) =       0.000421030509
  error estimate for blocks of size 2^( 5) =       0.000425243219
  error estimate for blocks of size 2^( 6) =       0.000428637802
  error estimate for blocks of size 2^( 7) =       0.000431443335

      target function =                  N/A
              le_mean =     -17.216398984539
             les_mean =     296.718420996961
             stat err =       0.000426588716
             autocorr =       1.158994868510
              std dev =       0.560381262300
             le_variance =       0.314027159137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631624
                                         uncertainty =       0.003131339294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314102631624
                                         uncertainty =       0.003131339294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396249391
  error estimate for blocks of size 2^( 2) =       0.000405425203
  error estimate for blocks of size 2^( 3) =       0.000414557039
  error estimate for blocks of size 2^( 4) =       0.000421030509
  error estimate for blocks of size 2^( 5) =       0.000425243219
  error estimate for blocks of size 2^( 6) =       0.000428637802
  error estimate for blocks of size 2^( 7) =       0.000431443335

      target function =                  N/A
              le_mean =     -17.216398984539
             les_mean =     296.718420996880
             stat err =       0.000426588716
             autocorr =       1.158994868562
              std dev =       0.560381262231
             le_variance =       0.314027159059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216398984539        initial
     3.9062e+05     3.9062e+06             3.1647e-10       -17.216398984539  <--
     1.5625e+06     1.5625e+07             7.9119e-11       -17.216398984539
     6.2500e+06     6.2500e+07             1.9780e-11       -17.216398984539

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 4.9049e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2868e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2491
    reference variance = 0.129246
====================================================
  Execution time = 3.4416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1232e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312382616797
                                         uncertainty =       0.002360763824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312382616797
                                         uncertainty =       0.002360763824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395168930
  error estimate for blocks of size 2^( 2) =       0.000404530387
  error estimate for blocks of size 2^( 3) =       0.000413198060
  error estimate for blocks of size 2^( 4) =       0.000419698055
  error estimate for blocks of size 2^( 5) =       0.000423023625
  error estimate for blocks of size 2^( 6) =       0.000425588481
  error estimate for blocks of size 2^( 7) =       0.000425962230

      target function =                  N/A
              le_mean =     -17.216080734524
             les_mean =     296.705752668666
             stat err =       0.000423568098
             autocorr =       1.148896489727
              std dev =       0.558853260866
             le_variance =       0.312316967180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608073452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216080734524       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216080734529       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216080734530       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216080734531       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216080734533       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216080734519       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216080734534       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.089178e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216080734524       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216080734525       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216080734525       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216080734508       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216080734526       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216080734497       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216080734602       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 5.222952e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216080734524       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216080734524       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216080734524       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216080734336       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216080734577       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216080734419       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216080734789       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.305738e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3743e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304384e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.221464
====================================================
  Execution time = 3.3392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1624e-01
  Total weights = 2.0000e+06
  Execution time = 3.1066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591465
                                         uncertainty =       0.003666395115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591465
                                         uncertainty =       0.003666395115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397643151
  error estimate for blocks of size 2^( 2) =       0.000406833988
  error estimate for blocks of size 2^( 3) =       0.000415440702
  error estimate for blocks of size 2^( 4) =       0.000421460815
  error estimate for blocks of size 2^( 5) =       0.000425928289
  error estimate for blocks of size 2^( 6) =       0.000427398180
  error estimate for blocks of size 2^( 7) =       0.000430129153

      target function =                  N/A
              le_mean =     -17.216215229947
             les_mean =     296.714306837385
             stat err =       0.000426229109
             autocorr =       1.148944892632
              std dev =       0.562352337645
             le_variance =       0.316240151655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591681
                                         uncertainty =       0.003666395108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591681
                                         uncertainty =       0.003666395108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397643152
  error estimate for blocks of size 2^( 2) =       0.000406833988
  error estimate for blocks of size 2^( 3) =       0.000415440702
  error estimate for blocks of size 2^( 4) =       0.000421460815
  error estimate for blocks of size 2^( 5) =       0.000425928289
  error estimate for blocks of size 2^( 6) =       0.000427398181
  error estimate for blocks of size 2^( 7) =       0.000430129153

      target function =                  N/A
              le_mean =     -17.216215229935
             les_mean =     296.714306837210
             stat err =       0.000426229109
             autocorr =       1.148944892518
              std dev =       0.562352337837
             le_variance =       0.316240151870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591573
                                         uncertainty =       0.003666395112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591573
                                         uncertainty =       0.003666395112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397643151
  error estimate for blocks of size 2^( 2) =       0.000406833988
  error estimate for blocks of size 2^( 3) =       0.000415440702
  error estimate for blocks of size 2^( 4) =       0.000421460815
  error estimate for blocks of size 2^( 5) =       0.000425928289
  error estimate for blocks of size 2^( 6) =       0.000427398181
  error estimate for blocks of size 2^( 7) =       0.000430129153

      target function =                  N/A
              le_mean =     -17.216215229941
             les_mean =     296.714306837297
             stat err =       0.000426229109
             autocorr =       1.148944892572
              std dev =       0.562352337741
             le_variance =       0.316240151763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591478
                                         uncertainty =       0.003666395115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316309591478
                                         uncertainty =       0.003666395115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397643151
  error estimate for blocks of size 2^( 2) =       0.000406833988
  error estimate for blocks of size 2^( 3) =       0.000415440702
  error estimate for blocks of size 2^( 4) =       0.000421460815
  error estimate for blocks of size 2^( 5) =       0.000425928289
  error estimate for blocks of size 2^( 6) =       0.000427398180
  error estimate for blocks of size 2^( 7) =       0.000430129153

      target function =                  N/A
              le_mean =     -17.216215229946
             les_mean =     296.714306837374
             stat err =       0.000426229109
             autocorr =       1.148944892614
              std dev =       0.562352337657
             le_variance =       0.316240151668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216215229947        initial  <--
     9.7656e+04     9.7656e+05             2.0892e-09       -17.216215229935
     3.9062e+05     3.9062e+06             5.2230e-10       -17.216215229941
     1.5625e+06     1.5625e+07             1.3057e-10       -17.216215229946

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0297
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.188835
====================================================
  Execution time = 3.4504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3006e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330182352273
                                         uncertainty =       0.007504019233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330182352273
                                         uncertainty =       0.007504019233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406239090
  error estimate for blocks of size 2^( 2) =       0.000415465876
  error estimate for blocks of size 2^( 3) =       0.000424000441
  error estimate for blocks of size 2^( 4) =       0.000429279304
  error estimate for blocks of size 2^( 5) =       0.000433822092
  error estimate for blocks of size 2^( 6) =       0.000436440385
  error estimate for blocks of size 2^( 7) =       0.000437459878

      target function =                  N/A
              le_mean =     -17.216725020573
             les_mean =     296.745680665784
             stat err =       0.000434250415
             autocorr =       1.142660098410
              std dev =       0.574508830905
             le_variance =       0.330060396788


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672502057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725020573       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725020573       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725020574       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216725020620       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216725020094       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.174867e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725020573       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725020573       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725020573       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216725021025       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216725020601       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 2.937173e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725020573       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725020573       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725020573       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216725019480       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216725012128       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 7.342865e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3875e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.205227
====================================================
  Execution time = 3.4134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2283e-01
  Total weights = 2.0000e+06
  Execution time = 3.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955884
                                         uncertainty =       0.004010347385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955884
                                         uncertainty =       0.004010347385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766197
  error estimate for blocks of size 2^( 2) =       0.000410943564
  error estimate for blocks of size 2^( 3) =       0.000419944842
  error estimate for blocks of size 2^( 4) =       0.000426065742
  error estimate for blocks of size 2^( 5) =       0.000429948506
  error estimate for blocks of size 2^( 6) =       0.000431890852
  error estimate for blocks of size 2^( 7) =       0.000432572261

      target function =                  N/A
              le_mean =     -17.217234179182
             les_mean =     296.755984773560
             stat err =       0.000430119340
             autocorr =       1.146122803344
              std dev =       0.568183204760
             le_variance =       0.322832154172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955977
                                         uncertainty =       0.004010347387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955977
                                         uncertainty =       0.004010347387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766197
  error estimate for blocks of size 2^( 2) =       0.000410943564
  error estimate for blocks of size 2^( 3) =       0.000419944842
  error estimate for blocks of size 2^( 4) =       0.000426065742
  error estimate for blocks of size 2^( 5) =       0.000429948506
  error estimate for blocks of size 2^( 6) =       0.000431890852
  error estimate for blocks of size 2^( 7) =       0.000432572262

      target function =                  N/A
              le_mean =     -17.217234179181
             les_mean =     296.755984773620
             stat err =       0.000430119340
             autocorr =       1.146122803260
              std dev =       0.568183204842
             le_variance =       0.322832154265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955931
                                         uncertainty =       0.004010347386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955931
                                         uncertainty =       0.004010347386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766197
  error estimate for blocks of size 2^( 2) =       0.000410943564
  error estimate for blocks of size 2^( 3) =       0.000419944842
  error estimate for blocks of size 2^( 4) =       0.000426065742
  error estimate for blocks of size 2^( 5) =       0.000429948506
  error estimate for blocks of size 2^( 6) =       0.000431890852
  error estimate for blocks of size 2^( 7) =       0.000432572261

      target function =                  N/A
              le_mean =     -17.217234179182
             les_mean =     296.755984773590
             stat err =       0.000430119340
             autocorr =       1.146122803305
              std dev =       0.568183204801
             le_variance =       0.322832154218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955890
                                         uncertainty =       0.004010347385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322905955890
                                         uncertainty =       0.004010347385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766197
  error estimate for blocks of size 2^( 2) =       0.000410943564
  error estimate for blocks of size 2^( 3) =       0.000419944842
  error estimate for blocks of size 2^( 4) =       0.000426065742
  error estimate for blocks of size 2^( 5) =       0.000429948506
  error estimate for blocks of size 2^( 6) =       0.000431890852
  error estimate for blocks of size 2^( 7) =       0.000432572261

      target function =                  N/A
              le_mean =     -17.217234179182
             les_mean =     296.755984773564
             stat err =       0.000430119340
             autocorr =       1.146122803342
              std dev =       0.568183204765
             le_variance =       0.322832154177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217234179182        initial  <--
     9.7656e+05     9.7656e+06             1.1749e-10       -17.217234179181
     3.9062e+06     3.9062e+07             2.9372e-11       -17.217234179182
     1.5625e+07     1.5625e+08             7.3429e-12       -17.217234179182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.4029
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.227
    reference variance = 0.291319
====================================================
  Execution time = 3.4218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320623321145
                                         uncertainty =       0.003421093659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320623321145
                                         uncertainty =       0.003421093659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400403562
  error estimate for blocks of size 2^( 2) =       0.000409862951
  error estimate for blocks of size 2^( 3) =       0.000418228806
  error estimate for blocks of size 2^( 4) =       0.000424230204
  error estimate for blocks of size 2^( 5) =       0.000427813532
  error estimate for blocks of size 2^( 6) =       0.000429195579
  error estimate for blocks of size 2^( 7) =       0.000431885928

      target function =                  N/A
              le_mean =     -17.217430521261
             les_mean =     296.760559619050
             stat err =       0.000428281310
             autocorr =       1.144095773256
              std dev =       0.566256147807
             le_variance =       0.320646024929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721743052126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217430521261       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217430521261       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217430521261       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217430521261       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217430521398       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217430525106       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217430522812       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.221905e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217430521261       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217430521261       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217430521261       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217430523314       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217430522215       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217430491438       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217430493952       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 5.554444e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217430521261       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217430521261       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217430521261       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217430521261       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217430521002       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217430558477       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217430489378       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 1.388766e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3545e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2243
    reference variance = 0.262946
====================================================
  Execution time = 3.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1998e-01
  Total weights = 2.0000e+06
  Execution time = 3.0927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920586
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920586
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399985897
  error estimate for blocks of size 2^( 2) =       0.000409327586
  error estimate for blocks of size 2^( 3) =       0.000418091066
  error estimate for blocks of size 2^( 4) =       0.000424510423
  error estimate for blocks of size 2^( 5) =       0.000427957624
  error estimate for blocks of size 2^( 6) =       0.000429133862
  error estimate for blocks of size 2^( 7) =       0.000431646626

      target function =                  N/A
              le_mean =     -17.217131064833
             les_mean =     296.749579379401
             stat err =       0.000428312134
             autocorr =       1.146651379953
              std dev =       0.565665480428
             le_variance =       0.319977435748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920597
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920597
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399985897
  error estimate for blocks of size 2^( 2) =       0.000409327586
  error estimate for blocks of size 2^( 3) =       0.000418091066
  error estimate for blocks of size 2^( 4) =       0.000424510423
  error estimate for blocks of size 2^( 5) =       0.000427957624
  error estimate for blocks of size 2^( 6) =       0.000429133862
  error estimate for blocks of size 2^( 7) =       0.000431646626

      target function =                  N/A
              le_mean =     -17.217131064833
             les_mean =     296.749579379414
             stat err =       0.000428312134
             autocorr =       1.146651379948
              std dev =       0.565665480438
             le_variance =       0.319977435759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920591
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920591
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399985897
  error estimate for blocks of size 2^( 2) =       0.000409327586
  error estimate for blocks of size 2^( 3) =       0.000418091066
  error estimate for blocks of size 2^( 4) =       0.000424510423
  error estimate for blocks of size 2^( 5) =       0.000427957624
  error estimate for blocks of size 2^( 6) =       0.000429133862
  error estimate for blocks of size 2^( 7) =       0.000431646626

      target function =                  N/A
              le_mean =     -17.217131064833
             les_mean =     296.749579379407
             stat err =       0.000428312134
             autocorr =       1.146651379951
              std dev =       0.565665480433
             le_variance =       0.319977435754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920586
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320080920586
                                         uncertainty =       0.003546560798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399985897
  error estimate for blocks of size 2^( 2) =       0.000409327586
  error estimate for blocks of size 2^( 3) =       0.000418091066
  error estimate for blocks of size 2^( 4) =       0.000424510423
  error estimate for blocks of size 2^( 5) =       0.000427957624
  error estimate for blocks of size 2^( 6) =       0.000429133862
  error estimate for blocks of size 2^( 7) =       0.000431646626

      target function =                  N/A
              le_mean =     -17.217131064833
             les_mean =     296.749579379402
             stat err =       0.000428312134
             autocorr =       1.146651379956
              std dev =       0.565665480429
             le_variance =       0.319977435749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217131064833        initial
     9.7656e+06     9.7656e+07             2.2219e-11       -17.217131064833  <--
     3.9062e+07     3.9062e+08             5.5544e-12       -17.217131064833
     1.5625e+08     1.5625e+09             1.3888e-12       -17.217131064833

*****************************************************************************
Applying the update for shift_i =   9.7656e+06     and shift_s =   9.7656e+07
*****************************************************************************

  Execution time = 4.9154e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1614
    reference variance = 0.263507
====================================================
  Execution time = 3.4382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316145635161
                                         uncertainty =       0.002685318979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316145635161
                                         uncertainty =       0.002685318979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397539448
  error estimate for blocks of size 2^( 2) =       0.000407035778
  error estimate for blocks of size 2^( 3) =       0.000415724281
  error estimate for blocks of size 2^( 4) =       0.000421428593
  error estimate for blocks of size 2^( 5) =       0.000424029907
  error estimate for blocks of size 2^( 6) =       0.000427727762
  error estimate for blocks of size 2^( 7) =       0.000429288186

      target function =                  N/A
              le_mean =     -17.216961331538
             les_mean =     296.739832559289
             stat err =       0.000425618612
             autocorr =       1.146253728124
              std dev =       0.562205679144
             le_variance =       0.316075225662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696133154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961331538       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961331538       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961331538       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961329896       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216961330685       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216961332132       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216961331972       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 7.463109e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961331538       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961331538       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961331538       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961331538       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216961332570       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216961333893       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216961326100       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.865787e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961331538       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961331538       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961331538       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961335002       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216961346902       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216961312900       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216961360536       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 4.664531e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3683e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3428
    reference variance = 0.674303
====================================================
  Execution time = 3.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2521e-01
  Total weights = 2.0000e+06
  Execution time = 3.1003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393140
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393140
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403245870
  error estimate for blocks of size 2^( 2) =       0.000412756965
  error estimate for blocks of size 2^( 3) =       0.000421062170
  error estimate for blocks of size 2^( 4) =       0.000427570014
  error estimate for blocks of size 2^( 5) =       0.000431407082
  error estimate for blocks of size 2^( 6) =       0.000432708939
  error estimate for blocks of size 2^( 7) =       0.000433864944

      target function =                  N/A
              le_mean =     -17.216699207500
             les_mean =     296.739945902627
             stat err =       0.000431387745
             autocorr =       1.144447168969
              std dev =       0.570275778646
             le_variance =       0.325214463710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393170
                                         uncertainty =       0.003247882069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393170
                                         uncertainty =       0.003247882069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403245870
  error estimate for blocks of size 2^( 2) =       0.000412756965
  error estimate for blocks of size 2^( 3) =       0.000421062170
  error estimate for blocks of size 2^( 4) =       0.000427570014
  error estimate for blocks of size 2^( 5) =       0.000431407082
  error estimate for blocks of size 2^( 6) =       0.000432708939
  error estimate for blocks of size 2^( 7) =       0.000433864944

      target function =                  N/A
              le_mean =     -17.216699207499
             les_mean =     296.739945902646
             stat err =       0.000431387745
             autocorr =       1.144447168960
              std dev =       0.570275778673
             le_variance =       0.325214463741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393155
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393155
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403245870
  error estimate for blocks of size 2^( 2) =       0.000412756965
  error estimate for blocks of size 2^( 3) =       0.000421062170
  error estimate for blocks of size 2^( 4) =       0.000427570014
  error estimate for blocks of size 2^( 5) =       0.000431407082
  error estimate for blocks of size 2^( 6) =       0.000432708939
  error estimate for blocks of size 2^( 7) =       0.000433864944

      target function =                  N/A
              le_mean =     -17.216699207500
             les_mean =     296.739945902637
             stat err =       0.000431387745
             autocorr =       1.144447168968
              std dev =       0.570275778660
             le_variance =       0.325214463726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393141
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256393141
                                         uncertainty =       0.003247882068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403245870
  error estimate for blocks of size 2^( 2) =       0.000412756965
  error estimate for blocks of size 2^( 3) =       0.000421062170
  error estimate for blocks of size 2^( 4) =       0.000427570014
  error estimate for blocks of size 2^( 5) =       0.000431407082
  error estimate for blocks of size 2^( 6) =       0.000432708939
  error estimate for blocks of size 2^( 7) =       0.000433864944

      target function =                  N/A
              le_mean =     -17.216699207500
             les_mean =     296.739945902629
             stat err =       0.000431387745
             autocorr =       1.144447168970
              std dev =       0.570275778648
             le_variance =       0.325214463712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216699207500        initial  <--
     2.4414e+06     2.4414e+07             7.4631e-11       -17.216699207499
     9.7656e+06     9.7656e+07             1.8658e-11       -17.216699207500
     3.9062e+07     3.9062e+08             4.6645e-12       -17.216699207500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2811
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.375831
====================================================
  Execution time = 3.4329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315142489877
                                         uncertainty =       0.002776416292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315142489877
                                         uncertainty =       0.002776416292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396930901
  error estimate for blocks of size 2^( 2) =       0.000406309811
  error estimate for blocks of size 2^( 3) =       0.000414762746
  error estimate for blocks of size 2^( 4) =       0.000421144532
  error estimate for blocks of size 2^( 5) =       0.000425079479
  error estimate for blocks of size 2^( 6) =       0.000428057793
  error estimate for blocks of size 2^( 7) =       0.000427630112

      target function =                  N/A
              le_mean =     -17.216776625054
             les_mean =     296.732505479285
             stat err =       0.000425477979
             autocorr =       1.149011449402
              std dev =       0.561345063080
             le_variance =       0.315108279844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677662505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776625054       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776625054       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776625054       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776625054       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776639839       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776624670       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.035493e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776625054       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776625054       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776625054       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776625054       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776598921       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776602269       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.508654e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776625054       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776625054       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776625054       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776625054       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776625054       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776633657       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 3.772046e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3770e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1531
    reference variance = 0.280539
====================================================
  Execution time = 3.3688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1852e-01
  Total weights = 2.0000e+06
  Execution time = 3.1051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350983
                                         uncertainty =       0.004043661906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350983
                                         uncertainty =       0.004043661906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075350
  error estimate for blocks of size 2^( 2) =       0.000408635967
  error estimate for blocks of size 2^( 3) =       0.000417265874
  error estimate for blocks of size 2^( 4) =       0.000423666514
  error estimate for blocks of size 2^( 5) =       0.000426815060
  error estimate for blocks of size 2^( 6) =       0.000429607290
  error estimate for blocks of size 2^( 7) =       0.000430550008

      target function =                  N/A
              le_mean =     -17.216514739844
             les_mean =     296.726901898690
             stat err =       0.000427659718
             autocorr =       1.148383337797
              std dev =       0.564377773028
             le_variance =       0.318522270688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350986
                                         uncertainty =       0.004043661907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350986
                                         uncertainty =       0.004043661907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075350
  error estimate for blocks of size 2^( 2) =       0.000408635967
  error estimate for blocks of size 2^( 3) =       0.000417265874
  error estimate for blocks of size 2^( 4) =       0.000423666514
  error estimate for blocks of size 2^( 5) =       0.000426815060
  error estimate for blocks of size 2^( 6) =       0.000429607290
  error estimate for blocks of size 2^( 7) =       0.000430550008

      target function =                  N/A
              le_mean =     -17.216514739844
             les_mean =     296.726901898694
             stat err =       0.000427659718
             autocorr =       1.148383337795
              std dev =       0.564377773031
             le_variance =       0.318522270691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350985
                                         uncertainty =       0.004043661907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350985
                                         uncertainty =       0.004043661907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075350
  error estimate for blocks of size 2^( 2) =       0.000408635967
  error estimate for blocks of size 2^( 3) =       0.000417265874
  error estimate for blocks of size 2^( 4) =       0.000423666514
  error estimate for blocks of size 2^( 5) =       0.000426815060
  error estimate for blocks of size 2^( 6) =       0.000429607290
  error estimate for blocks of size 2^( 7) =       0.000430550008

      target function =                  N/A
              le_mean =     -17.216514739844
             les_mean =     296.726901898692
             stat err =       0.000427659718
             autocorr =       1.148383337788
              std dev =       0.564377773029
             le_variance =       0.318522270689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350983
                                         uncertainty =       0.004043661906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318540350983
                                         uncertainty =       0.004043661906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075350
  error estimate for blocks of size 2^( 2) =       0.000408635967
  error estimate for blocks of size 2^( 3) =       0.000417265874
  error estimate for blocks of size 2^( 4) =       0.000423666514
  error estimate for blocks of size 2^( 5) =       0.000426815060
  error estimate for blocks of size 2^( 6) =       0.000429607290
  error estimate for blocks of size 2^( 7) =       0.000430550008

      target function =                  N/A
              le_mean =     -17.216514739844
             les_mean =     296.726901898690
             stat err =       0.000427659718
             autocorr =       1.148383337800
              std dev =       0.564377773028
             le_variance =       0.318522270688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216514739844        initial
     2.4414e+07     2.4414e+08             6.0355e-12       -17.216514739844  <--
     9.7656e+07     9.7656e+08             1.5087e-12       -17.216514739844
     3.9062e+08     3.9062e+09             3.7720e-13       -17.216514739844

*****************************************************************************
Applying the update for shift_i =   2.4414e+07     and shift_s =   2.4414e+08
*****************************************************************************

  Execution time = 4.9375e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.239
    reference variance = 0.240462
====================================================
  Execution time = 3.6825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318520666044
                                         uncertainty =       0.003608029158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318520666044
                                         uncertainty =       0.003608029158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399102083
  error estimate for blocks of size 2^( 2) =       0.000408405403
  error estimate for blocks of size 2^( 3) =       0.000417387727
  error estimate for blocks of size 2^( 4) =       0.000423515739
  error estimate for blocks of size 2^( 5) =       0.000427141900
  error estimate for blocks of size 2^( 6) =       0.000428733441
  error estimate for blocks of size 2^( 7) =       0.000429942110

      target function =                  N/A
              le_mean =     -17.216908005673
             les_mean =     296.740486062182
             stat err =       0.000427333297
             autocorr =       1.146477348123
              std dev =       0.564415578857
             le_variance =       0.318564945656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690800567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908005673       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908005673       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908005673       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908005673       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216908002947       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908006670       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216908005628       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 2.442049e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908005673       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908005673       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908005673       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908005673       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216908004340       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908007968       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216907999698       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.105103e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908005673       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908005673       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908005673       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908033764       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216907994309       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908005418       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216908014017       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.526254e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6117e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.454852
====================================================
  Execution time = 3.3749e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2699e-01
  Total weights = 2.0000e+06
  Execution time = 3.1019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593152
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593152
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404346831
  error estimate for blocks of size 2^( 2) =       0.000413499093
  error estimate for blocks of size 2^( 3) =       0.000421726208
  error estimate for blocks of size 2^( 4) =       0.000427548286
  error estimate for blocks of size 2^( 5) =       0.000431165645
  error estimate for blocks of size 2^( 6) =       0.000432771910
  error estimate for blocks of size 2^( 7) =       0.000436577272

      target function =                  N/A
              le_mean =     -17.217053016778
             les_mean =     296.753907138100
             stat err =       0.000432015778
             autocorr =       1.141539990328
              std dev =       0.571832771935
             le_variance =       0.326992719059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593174
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593174
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404346831
  error estimate for blocks of size 2^( 2) =       0.000413499093
  error estimate for blocks of size 2^( 3) =       0.000421726208
  error estimate for blocks of size 2^( 4) =       0.000427548286
  error estimate for blocks of size 2^( 5) =       0.000431165645
  error estimate for blocks of size 2^( 6) =       0.000432771910
  error estimate for blocks of size 2^( 7) =       0.000436577272

      target function =                  N/A
              le_mean =     -17.217053016778
             les_mean =     296.753907138126
             stat err =       0.000432015778
             autocorr =       1.141539990317
              std dev =       0.571832771955
             le_variance =       0.326992719082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593163
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593163
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404346831
  error estimate for blocks of size 2^( 2) =       0.000413499093
  error estimate for blocks of size 2^( 3) =       0.000421726208
  error estimate for blocks of size 2^( 4) =       0.000427548286
  error estimate for blocks of size 2^( 5) =       0.000431165645
  error estimate for blocks of size 2^( 6) =       0.000432771910
  error estimate for blocks of size 2^( 7) =       0.000436577272

      target function =                  N/A
              le_mean =     -17.217053016778
             les_mean =     296.753907138113
             stat err =       0.000432015778
             autocorr =       1.141539990329
              std dev =       0.571832771945
             le_variance =       0.326992719071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593153
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327033593153
                                         uncertainty =       0.005400302151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404346831
  error estimate for blocks of size 2^( 2) =       0.000413499093
  error estimate for blocks of size 2^( 3) =       0.000421726208
  error estimate for blocks of size 2^( 4) =       0.000427548286
  error estimate for blocks of size 2^( 5) =       0.000431165645
  error estimate for blocks of size 2^( 6) =       0.000432771910
  error estimate for blocks of size 2^( 7) =       0.000436577272

      target function =                  N/A
              le_mean =     -17.217053016778
             les_mean =     296.753907138102
             stat err =       0.000432015778
             autocorr =       1.141539990327
              std dev =       0.571832771937
             le_variance =       0.326992719061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217053016778        initial
     6.1035e+06     6.1035e+07             2.4420e-11       -17.217053016778  <--
     2.4414e+07     2.4414e+08             6.1051e-12       -17.217053016778
     9.7656e+07     9.7656e+08             1.5263e-12       -17.217053016778

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 4.9384e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.168366
====================================================
  Execution time = 3.4255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2314e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323137388872
                                         uncertainty =       0.005084881673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323137388872
                                         uncertainty =       0.005084881673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401957634
  error estimate for blocks of size 2^( 2) =       0.000411497816
  error estimate for blocks of size 2^( 3) =       0.000420314126
  error estimate for blocks of size 2^( 4) =       0.000426570225
  error estimate for blocks of size 2^( 5) =       0.000430588200
  error estimate for blocks of size 2^( 6) =       0.000431635487
  error estimate for blocks of size 2^( 7) =       0.000433913361

      target function =                  N/A
              le_mean =     -17.216432338273
             les_mean =     296.728682176416
             stat err =       0.000430676818
             autocorr =       1.148001429163
              std dev =       0.568453938016
             le_variance =       0.323139879646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643233827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216432338273       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216432338273       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216432338273       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216432338095       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216432338057       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216432338810       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216432337463       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.306363e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216432338273       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216432338273       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216432338273       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216432338685       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216432337135       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216432340037       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216432331211       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.265911e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216432338273       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216432338273       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216432338273       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216432338273       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216432332724       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216432361152       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216432304393       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 8.165042e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3601e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.21561
====================================================
  Execution time = 3.3424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1519e-01
  Total weights = 2.0000e+06
  Execution time = 3.0930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069718
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069718
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396982366
  error estimate for blocks of size 2^( 2) =       0.000406819539
  error estimate for blocks of size 2^( 3) =       0.000415573944
  error estimate for blocks of size 2^( 4) =       0.000422026688
  error estimate for blocks of size 2^( 5) =       0.000426092490
  error estimate for blocks of size 2^( 6) =       0.000429500817
  error estimate for blocks of size 2^( 7) =       0.000428953269

      target function =                  N/A
              le_mean =     -17.216777103723
             les_mean =     296.732603678938
             stat err =       0.000426643316
             autocorr =       1.155014566737
              std dev =       0.561417845506
             le_variance =       0.315189997253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069837
                                         uncertainty =       0.002743578667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069837
                                         uncertainty =       0.002743578667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396982366
  error estimate for blocks of size 2^( 2) =       0.000406819540
  error estimate for blocks of size 2^( 3) =       0.000415573944
  error estimate for blocks of size 2^( 4) =       0.000422026688
  error estimate for blocks of size 2^( 5) =       0.000426092490
  error estimate for blocks of size 2^( 6) =       0.000429500817
  error estimate for blocks of size 2^( 7) =       0.000428953269

      target function =                  N/A
              le_mean =     -17.216777103723
             les_mean =     296.732603679060
             stat err =       0.000426643316
             autocorr =       1.155014566651
              std dev =       0.561417845612
             le_variance =       0.315189997371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069777
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069777
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396982366
  error estimate for blocks of size 2^( 2) =       0.000406819539
  error estimate for blocks of size 2^( 3) =       0.000415573944
  error estimate for blocks of size 2^( 4) =       0.000422026688
  error estimate for blocks of size 2^( 5) =       0.000426092490
  error estimate for blocks of size 2^( 6) =       0.000429500817
  error estimate for blocks of size 2^( 7) =       0.000428953269

      target function =                  N/A
              le_mean =     -17.216777103723
             les_mean =     296.732603678999
             stat err =       0.000426643316
             autocorr =       1.155014566688
              std dev =       0.561417845559
             le_variance =       0.315189997312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069725
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315200069725
                                         uncertainty =       0.002743578666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396982366
  error estimate for blocks of size 2^( 2) =       0.000406819539
  error estimate for blocks of size 2^( 3) =       0.000415573944
  error estimate for blocks of size 2^( 4) =       0.000422026688
  error estimate for blocks of size 2^( 5) =       0.000426092490
  error estimate for blocks of size 2^( 6) =       0.000429500817
  error estimate for blocks of size 2^( 7) =       0.000428953269

      target function =                  N/A
              le_mean =     -17.216777103723
             les_mean =     296.732603678946
             stat err =       0.000426643316
             autocorr =       1.155014566728
              std dev =       0.561417845513
             le_variance =       0.315189997260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216777103723        initial
     1.5259e+06     1.5259e+07             1.3064e-10       -17.216777103723  <--
     6.1035e+06     6.1035e+07             3.2659e-11       -17.216777103723
     2.4414e+07     2.4414e+08             8.1650e-12       -17.216777103723

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 4.9043e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.30901
====================================================
  Execution time = 3.4071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320209116720
                                         uncertainty =       0.004114243523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320209116720
                                         uncertainty =       0.004114243523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400067542
  error estimate for blocks of size 2^( 2) =       0.000409328896
  error estimate for blocks of size 2^( 3) =       0.000417931752
  error estimate for blocks of size 2^( 4) =       0.000424016081
  error estimate for blocks of size 2^( 5) =       0.000428410475
  error estimate for blocks of size 2^( 6) =       0.000431431523
  error estimate for blocks of size 2^( 7) =       0.000431589173

      target function =                  N/A
              le_mean =     -17.217155614599
             les_mean =     296.750555374132
             stat err =       0.000428861813
             autocorr =       1.149127233731
              std dev =       0.565780944249
             le_variance =       0.320108076876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715561460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217155614599       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217155614600       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217155614600       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217155614724       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217155614598       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217155614740       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217155614598       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 4.000295e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217155614599       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217155614599       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217155614599       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217155614599       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217155615414       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217155614840       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217155614309       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.000076e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217155614599       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217155614599       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217155614599       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217155616972       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217155609760       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217155614599       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217155614200       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 2.500159e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3511e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2895
    reference variance = 0.286697
====================================================
  Execution time = 3.3810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1977e-01
  Total weights = 2.0000e+06
  Execution time = 3.1060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256194
                                         uncertainty =       0.003651353972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256194
                                         uncertainty =       0.003651353972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399856585
  error estimate for blocks of size 2^( 2) =       0.000410021249
  error estimate for blocks of size 2^( 3) =       0.000418156847
  error estimate for blocks of size 2^( 4) =       0.000425061073
  error estimate for blocks of size 2^( 5) =       0.000429126815
  error estimate for blocks of size 2^( 6) =       0.000430786712
  error estimate for blocks of size 2^( 7) =       0.000431285073

      target function =                  N/A
              le_mean =     -17.215987591634
             les_mean =     296.709999172402
             stat err =       0.000429064918
             autocorr =       1.151429914044
              std dev =       0.565482605391
             le_variance =       0.319770577000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256600
                                         uncertainty =       0.003651353975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256600
                                         uncertainty =       0.003651353975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399856585
  error estimate for blocks of size 2^( 2) =       0.000410021249
  error estimate for blocks of size 2^( 3) =       0.000418156847
  error estimate for blocks of size 2^( 4) =       0.000425061073
  error estimate for blocks of size 2^( 5) =       0.000429126815
  error estimate for blocks of size 2^( 6) =       0.000430786712
  error estimate for blocks of size 2^( 7) =       0.000431285073

      target function =                  N/A
              le_mean =     -17.215987591632
             les_mean =     296.709999172749
             stat err =       0.000429064918
             autocorr =       1.151429913649
              std dev =       0.565482605749
             le_variance =       0.319770577405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256397
                                         uncertainty =       0.003651353973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256397
                                         uncertainty =       0.003651353973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399856585
  error estimate for blocks of size 2^( 2) =       0.000410021249
  error estimate for blocks of size 2^( 3) =       0.000418156847
  error estimate for blocks of size 2^( 4) =       0.000425061073
  error estimate for blocks of size 2^( 5) =       0.000429126815
  error estimate for blocks of size 2^( 6) =       0.000430786712
  error estimate for blocks of size 2^( 7) =       0.000431285073

      target function =                  N/A
              le_mean =     -17.215987591633
             les_mean =     296.709999172575
             stat err =       0.000429064918
             autocorr =       1.151429913833
              std dev =       0.565482605570
             le_variance =       0.319770577202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256220
                                         uncertainty =       0.003651353972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319784256220
                                         uncertainty =       0.003651353972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399856585
  error estimate for blocks of size 2^( 2) =       0.000410021249
  error estimate for blocks of size 2^( 3) =       0.000418156847
  error estimate for blocks of size 2^( 4) =       0.000425061073
  error estimate for blocks of size 2^( 5) =       0.000429126815
  error estimate for blocks of size 2^( 6) =       0.000430786712
  error estimate for blocks of size 2^( 7) =       0.000431285073

      target function =                  N/A
              le_mean =     -17.215987591634
             les_mean =     296.709999172423
             stat err =       0.000429064918
             autocorr =       1.151429914013
              std dev =       0.565482605413
             le_variance =       0.319770577025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215987591634        initial  <--
     3.8147e+05     3.8147e+06             4.0003e-10       -17.215987591632
     1.5259e+06     1.5259e+07             1.0001e-10       -17.215987591633
     6.1035e+06     6.1035e+07             2.5002e-11       -17.215987591634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4381
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.204415
====================================================
  Execution time = 3.6636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317974120067
                                         uncertainty =       0.003706948793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317974120067
                                         uncertainty =       0.003706948793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398693069
  error estimate for blocks of size 2^( 2) =       0.000407930386
  error estimate for blocks of size 2^( 3) =       0.000416416803
  error estimate for blocks of size 2^( 4) =       0.000422284440
  error estimate for blocks of size 2^( 5) =       0.000426146498
  error estimate for blocks of size 2^( 6) =       0.000429615591
  error estimate for blocks of size 2^( 7) =       0.000431530030

      target function =                  N/A
              le_mean =     -17.216733750507
             les_mean =     296.733833203306
             stat err =       0.000427394140
             autocorr =       1.149158026141
              std dev =       0.563837145306
             le_variance =       0.317912326426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673375051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733750507       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733750507       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733750507       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733748333       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733750507       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733752145       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733750507       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 3.451247e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733750507       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733750507       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733750507       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733747048       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733749010       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733755461       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733754208       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 8.628209e-12

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733750507       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733750507       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733750507       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733746964       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733773819       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733777435       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733765409       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 2.157428e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5969e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.313024
====================================================
  Execution time = 3.3091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3407e-01
  Total weights = 2.0000e+06
  Execution time = 3.1001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697515
  error estimate for blocks of size 2^( 2) =       0.000418004073
  error estimate for blocks of size 2^( 3) =       0.000426282178
  error estimate for blocks of size 2^( 4) =       0.000432350101
  error estimate for blocks of size 2^( 5) =       0.000436384103
  error estimate for blocks of size 2^( 6) =       0.000439242999
  error estimate for blocks of size 2^( 7) =       0.000440677366

      target function =                  N/A
              le_mean =     -17.216992070205
             les_mean =     296.758883096802
             stat err =       0.000437163642
             autocorr =       1.144152927760
              std dev =       0.577985569299
             le_variance =       0.334067318317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031932
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031932
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697515
  error estimate for blocks of size 2^( 2) =       0.000418004073
  error estimate for blocks of size 2^( 3) =       0.000426282178
  error estimate for blocks of size 2^( 4) =       0.000432350101
  error estimate for blocks of size 2^( 5) =       0.000436384103
  error estimate for blocks of size 2^( 6) =       0.000439242999
  error estimate for blocks of size 2^( 7) =       0.000440677366

      target function =                  N/A
              le_mean =     -17.216992070206
             les_mean =     296.758883096805
             stat err =       0.000437163642
             autocorr =       1.144152927762
              std dev =       0.577985569297
             le_variance =       0.334067318316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697515
  error estimate for blocks of size 2^( 2) =       0.000418004073
  error estimate for blocks of size 2^( 3) =       0.000426282178
  error estimate for blocks of size 2^( 4) =       0.000432350101
  error estimate for blocks of size 2^( 5) =       0.000436384103
  error estimate for blocks of size 2^( 6) =       0.000439242999
  error estimate for blocks of size 2^( 7) =       0.000440677366

      target function =                  N/A
              le_mean =     -17.216992070206
             les_mean =     296.758883096803
             stat err =       0.000437163642
             autocorr =       1.144152927767
              std dev =       0.577985569298
             le_variance =       0.334067318317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334036031933
                                         uncertainty =       0.011111303661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408697515
  error estimate for blocks of size 2^( 2) =       0.000418004073
  error estimate for blocks of size 2^( 3) =       0.000426282178
  error estimate for blocks of size 2^( 4) =       0.000432350101
  error estimate for blocks of size 2^( 5) =       0.000436384103
  error estimate for blocks of size 2^( 6) =       0.000439242999
  error estimate for blocks of size 2^( 7) =       0.000440677366

      target function =                  N/A
              le_mean =     -17.216992070205
             les_mean =     296.758883096802
             stat err =       0.000437163642
             autocorr =       1.144152927760
              std dev =       0.577985569298
             le_variance =       0.334067318317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216992070205        initial
     3.8147e+06     3.8147e+07             3.4512e-11       -17.216992070206  <--
     1.5259e+07     1.5259e+08             8.6282e-12       -17.216992070206
     6.1035e+07     6.1035e+08             2.1574e-12       -17.216992070205

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 4.8712e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1793
    reference variance = 0.168067
====================================================
  Execution time = 3.4522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3465e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776365031
                                         uncertainty =       0.013693746425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776365031
                                         uncertainty =       0.013693746425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409053792
  error estimate for blocks of size 2^( 2) =       0.000418435120
  error estimate for blocks of size 2^( 3) =       0.000426645326
  error estimate for blocks of size 2^( 4) =       0.000433296178
  error estimate for blocks of size 2^( 5) =       0.000437555592
  error estimate for blocks of size 2^( 6) =       0.000439737445
  error estimate for blocks of size 2^( 7) =       0.000440724771

      target function =                  N/A
              le_mean =     -17.217133210785
             les_mean =     296.764325839889
             stat err =       0.000437828497
             autocorr =       1.145637454439
              std dev =       0.578489420227
             le_variance =       0.334650009314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713321078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133210785       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217133210785       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217133210785       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217133210767       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217133210866       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133211175       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217133211075       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.434413e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133210785       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217133210785       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217133210785       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217133210199       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217133210740       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133212757       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217133210049       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 3.586029e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217133210785       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217133210785       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217133210785       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217133213311       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217133210564       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133211244       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217133219397       residual = 1.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 8.965134e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3932e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.316917
====================================================
  Execution time = 3.3175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2542e-01
  Total weights = 2.0000e+06
  Execution time = 3.0995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174594
                                         uncertainty =       0.008019137232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174594
                                         uncertainty =       0.008019137232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370764
  error estimate for blocks of size 2^( 2) =       0.000412795124
  error estimate for blocks of size 2^( 3) =       0.000421359911
  error estimate for blocks of size 2^( 4) =       0.000427301970
  error estimate for blocks of size 2^( 5) =       0.000432272814
  error estimate for blocks of size 2^( 6) =       0.000435719366
  error estimate for blocks of size 2^( 7) =       0.000435833276

      target function =                  N/A
              le_mean =     -17.216722622917
             les_mean =     296.740953657477
             stat err =       0.000432781856
             autocorr =       1.151142945684
              std dev =       0.570452404422
             le_variance =       0.325415945711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174634
                                         uncertainty =       0.008019137233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174634
                                         uncertainty =       0.008019137233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370764
  error estimate for blocks of size 2^( 2) =       0.000412795124
  error estimate for blocks of size 2^( 3) =       0.000421359911
  error estimate for blocks of size 2^( 4) =       0.000427301970
  error estimate for blocks of size 2^( 5) =       0.000432272814
  error estimate for blocks of size 2^( 6) =       0.000435719366
  error estimate for blocks of size 2^( 7) =       0.000435833276

      target function =                  N/A
              le_mean =     -17.216722622918
             les_mean =     296.740953657546
             stat err =       0.000432781856
             autocorr =       1.151142945647
              std dev =       0.570452404457
             le_variance =       0.325415945751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174614
                                         uncertainty =       0.008019137233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174614
                                         uncertainty =       0.008019137233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370764
  error estimate for blocks of size 2^( 2) =       0.000412795124
  error estimate for blocks of size 2^( 3) =       0.000421359911
  error estimate for blocks of size 2^( 4) =       0.000427301970
  error estimate for blocks of size 2^( 5) =       0.000432272814
  error estimate for blocks of size 2^( 6) =       0.000435719366
  error estimate for blocks of size 2^( 7) =       0.000435833276

      target function =                  N/A
              le_mean =     -17.216722622918
             les_mean =     296.740953657512
             stat err =       0.000432781856
             autocorr =       1.151142945668
              std dev =       0.570452404440
             le_variance =       0.325415945731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174597
                                         uncertainty =       0.008019137232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487174597
                                         uncertainty =       0.008019137232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370764
  error estimate for blocks of size 2^( 2) =       0.000412795124
  error estimate for blocks of size 2^( 3) =       0.000421359911
  error estimate for blocks of size 2^( 4) =       0.000427301970
  error estimate for blocks of size 2^( 5) =       0.000432272814
  error estimate for blocks of size 2^( 6) =       0.000435719366
  error estimate for blocks of size 2^( 7) =       0.000435833276

      target function =                  N/A
              le_mean =     -17.216722622917
             les_mean =     296.740953657481
             stat err =       0.000432781856
             autocorr =       1.151142945680
              std dev =       0.570452404425
             le_variance =       0.325415945714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216722622917        initial
     9.5367e+05     9.5367e+06             1.4344e-10       -17.216722622918  <--
     3.8147e+06     3.8147e+07             3.5860e-11       -17.216722622918
     1.5259e+07     1.5259e+08             8.9651e-12       -17.216722622917

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 4.8792e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1808
    reference variance = 0.154853
====================================================
  Execution time = 3.4030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318832420846
                                         uncertainty =       0.002853533785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318832420846
                                         uncertainty =       0.002853533785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399209863
  error estimate for blocks of size 2^( 2) =       0.000409167911
  error estimate for blocks of size 2^( 3) =       0.000418176511
  error estimate for blocks of size 2^( 4) =       0.000424720072
  error estimate for blocks of size 2^( 5) =       0.000428522123
  error estimate for blocks of size 2^( 6) =       0.000429351513
  error estimate for blocks of size 2^( 7) =       0.000429274053

      target function =                  N/A
              le_mean =     -17.216736491568
             les_mean =     296.734752289737
             stat err =       0.000427966940
             autocorr =       1.149259015247
              std dev =       0.564568002111
             le_variance =       0.318737029008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673649157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736491568       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736491568       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216736491567       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216736491566       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216736491590       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216736491519       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216736491638       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 6.280744e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736491568       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736491568       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216736491568       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216736491568       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216736492534       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216736491750       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216736491451       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.570193e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736491568       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736491568       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216736491568       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216736491568       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216736489806       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216736491296       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216736498613       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 3.925449e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3313e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2031
    reference variance = 0.17894
====================================================
  Execution time = 3.3821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1778e-01
  Total weights = 2.0000e+06
  Execution time = 3.1166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349642
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349642
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398610514
  error estimate for blocks of size 2^( 2) =       0.000408042829
  error estimate for blocks of size 2^( 3) =       0.000416939012
  error estimate for blocks of size 2^( 4) =       0.000423614248
  error estimate for blocks of size 2^( 5) =       0.000427777405
  error estimate for blocks of size 2^( 6) =       0.000431176147
  error estimate for blocks of size 2^( 7) =       0.000431962061

      target function =                  N/A
              le_mean =     -17.217023803813
             les_mean =     296.743689186174
             stat err =       0.000428632465
             autocorr =       1.156305588367
              std dev =       0.563720395228
             le_variance =       0.317780683996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349558
                                         uncertainty =       0.004460378846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349558
                                         uncertainty =       0.004460378846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398610514
  error estimate for blocks of size 2^( 2) =       0.000408042829
  error estimate for blocks of size 2^( 3) =       0.000416939012
  error estimate for blocks of size 2^( 4) =       0.000423614248
  error estimate for blocks of size 2^( 5) =       0.000427777405
  error estimate for blocks of size 2^( 6) =       0.000431176147
  error estimate for blocks of size 2^( 7) =       0.000431962061

      target function =                  N/A
              le_mean =     -17.217023803809
             les_mean =     296.743689185962
             stat err =       0.000428632465
             autocorr =       1.156305588422
              std dev =       0.563720395154
             le_variance =       0.317780683912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349600
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349600
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398610514
  error estimate for blocks of size 2^( 2) =       0.000408042829
  error estimate for blocks of size 2^( 3) =       0.000416939012
  error estimate for blocks of size 2^( 4) =       0.000423614248
  error estimate for blocks of size 2^( 5) =       0.000427777405
  error estimate for blocks of size 2^( 6) =       0.000431176147
  error estimate for blocks of size 2^( 7) =       0.000431962061

      target function =                  N/A
              le_mean =     -17.217023803811
             les_mean =     296.743689186068
             stat err =       0.000428632465
             autocorr =       1.156305588391
              std dev =       0.563720395191
             le_variance =       0.317780683954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349637
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317889349637
                                         uncertainty =       0.004460378847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398610514
  error estimate for blocks of size 2^( 2) =       0.000408042829
  error estimate for blocks of size 2^( 3) =       0.000416939012
  error estimate for blocks of size 2^( 4) =       0.000423614248
  error estimate for blocks of size 2^( 5) =       0.000427777405
  error estimate for blocks of size 2^( 6) =       0.000431176147
  error estimate for blocks of size 2^( 7) =       0.000431962061

      target function =                  N/A
              le_mean =     -17.217023803813
             les_mean =     296.743689186160
             stat err =       0.000428632465
             autocorr =       1.156305588365
              std dev =       0.563720395223
             le_variance =       0.317780683990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217023803813        initial  <--
     2.3842e+05     2.3842e+06             6.2807e-10       -17.217023803809
     9.5367e+05     9.5367e+06             1.5702e-10       -17.217023803811
     3.8147e+06     3.8147e+07             3.9254e-11       -17.217023803813

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4893
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.529358
====================================================
  Execution time = 3.4548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1504e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077591041
                                         uncertainty =       0.002458034001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077591041
                                         uncertainty =       0.002458034001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396890161
  error estimate for blocks of size 2^( 2) =       0.000406821929
  error estimate for blocks of size 2^( 3) =       0.000415654423
  error estimate for blocks of size 2^( 4) =       0.000420609520
  error estimate for blocks of size 2^( 5) =       0.000424633777
  error estimate for blocks of size 2^( 6) =       0.000426441156
  error estimate for blocks of size 2^( 7) =       0.000427428252

      target function =                  N/A
              le_mean =     -17.216607691374
             les_mean =     296.726623840248
             stat err =       0.000424778176
             autocorr =       1.145470021260
              std dev =       0.561287447832
             le_variance =       0.315043599093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660769137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607691374       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607691374       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607691374       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607691374       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607691439       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607691368       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607691382       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 5.648484e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607691374       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607691374       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607691374       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607685990       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607691676       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607687694       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607692198       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 1.412149e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607691374       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607691374       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607691374       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607691374       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607681729       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607680461       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607644795       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 3.530548e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7296e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.277776
====================================================
  Execution time = 3.4162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1744e-01
  Total weights = 2.0000e+06
  Execution time = 3.0955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649469
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649469
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398399204
  error estimate for blocks of size 2^( 2) =       0.000408299661
  error estimate for blocks of size 2^( 3) =       0.000416900451
  error estimate for blocks of size 2^( 4) =       0.000423028047
  error estimate for blocks of size 2^( 5) =       0.000426446449
  error estimate for blocks of size 2^( 6) =       0.000427748276
  error estimate for blocks of size 2^( 7) =       0.000429943127

      target function =                  N/A
              le_mean =     -17.217132848375
             les_mean =     296.747107211080
             stat err =       0.000426791475
             autocorr =       1.147610590164
              std dev =       0.563421557275
             le_variance =       0.317443851202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649540
                                         uncertainty =       0.002718360253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649540
                                         uncertainty =       0.002718360253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398399204
  error estimate for blocks of size 2^( 2) =       0.000408299661
  error estimate for blocks of size 2^( 3) =       0.000416900451
  error estimate for blocks of size 2^( 4) =       0.000423028047
  error estimate for blocks of size 2^( 5) =       0.000426446449
  error estimate for blocks of size 2^( 6) =       0.000427748276
  error estimate for blocks of size 2^( 7) =       0.000429943127

      target function =                  N/A
              le_mean =     -17.217132848375
             les_mean =     296.747107211151
             stat err =       0.000426791475
             autocorr =       1.147610590110
              std dev =       0.563421557338
             le_variance =       0.317443851273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649504
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649504
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398399204
  error estimate for blocks of size 2^( 2) =       0.000408299661
  error estimate for blocks of size 2^( 3) =       0.000416900451
  error estimate for blocks of size 2^( 4) =       0.000423028047
  error estimate for blocks of size 2^( 5) =       0.000426446449
  error estimate for blocks of size 2^( 6) =       0.000427748276
  error estimate for blocks of size 2^( 7) =       0.000429943127

      target function =                  N/A
              le_mean =     -17.217132848375
             les_mean =     296.747107211116
             stat err =       0.000426791475
             autocorr =       1.147610590142
              std dev =       0.563421557307
             le_variance =       0.317443851238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649473
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317431649473
                                         uncertainty =       0.002718360252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398399204
  error estimate for blocks of size 2^( 2) =       0.000408299661
  error estimate for blocks of size 2^( 3) =       0.000416900451
  error estimate for blocks of size 2^( 4) =       0.000423028047
  error estimate for blocks of size 2^( 5) =       0.000426446449
  error estimate for blocks of size 2^( 6) =       0.000427748276
  error estimate for blocks of size 2^( 7) =       0.000429943127

      target function =                  N/A
              le_mean =     -17.217132848375
             les_mean =     296.747107211085
             stat err =       0.000426791475
             autocorr =       1.147610590158
              std dev =       0.563421557279
             le_variance =       0.317443851207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217132848375        initial  <--
     2.3842e+06     2.3842e+07             5.6485e-11       -17.217132848375
     9.5367e+06     9.5367e+07             1.4121e-11       -17.217132848375
     3.8147e+07     3.8147e+08             3.5305e-12       -17.217132848375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.8098
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7133e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1731
    reference variance = 0.185604
====================================================
  Execution time = 3.4387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2191e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322018055494
                                         uncertainty =       0.003657837221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322018055494
                                         uncertainty =       0.003657837221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401193692
  error estimate for blocks of size 2^( 2) =       0.000410671640
  error estimate for blocks of size 2^( 3) =       0.000419012450
  error estimate for blocks of size 2^( 4) =       0.000424805452
  error estimate for blocks of size 2^( 5) =       0.000428439706
  error estimate for blocks of size 2^( 6) =       0.000430577684
  error estimate for blocks of size 2^( 7) =       0.000434181311

      target function =                  N/A
              le_mean =     -17.216243202540
             les_mean =     296.720942604692
             stat err =       0.000429501038
             autocorr =       1.146094013749
              std dev =       0.567373560040
             le_variance =       0.321912756632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721624320254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243202540       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243202540       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243202540       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243204417       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243202540       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243192420       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243200714       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 5.280262e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243202540       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243202540       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243202540       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243189992       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243201396       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243161940       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243184794       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 1.319972e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243202540       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243202540       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243202540       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243202540       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243144305       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243261020       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243170277       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 3.300138e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3684e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1374
    reference variance = 0.174564
====================================================
  Execution time = 3.4333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1716e-01
  Total weights = 2.0000e+06
  Execution time = 3.1047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229122
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229122
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398221407
  error estimate for blocks of size 2^( 2) =       0.000407992486
  error estimate for blocks of size 2^( 3) =       0.000416848461
  error estimate for blocks of size 2^( 4) =       0.000423303743
  error estimate for blocks of size 2^( 5) =       0.000426524741
  error estimate for blocks of size 2^( 6) =       0.000428675113
  error estimate for blocks of size 2^( 7) =       0.000428655504

      target function =                  N/A
              le_mean =     -17.216913823594
             les_mean =     296.739282027764
             stat err =       0.000426789775
             autocorr =       1.148626438136
              std dev =       0.563170113983
             le_variance =       0.317160577283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229126
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229126
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398221407
  error estimate for blocks of size 2^( 2) =       0.000407992486
  error estimate for blocks of size 2^( 3) =       0.000416848461
  error estimate for blocks of size 2^( 4) =       0.000423303743
  error estimate for blocks of size 2^( 5) =       0.000426524741
  error estimate for blocks of size 2^( 6) =       0.000428675113
  error estimate for blocks of size 2^( 7) =       0.000428655504

      target function =                  N/A
              le_mean =     -17.216913823594
             les_mean =     296.739282027767
             stat err =       0.000426789775
             autocorr =       1.148626438125
              std dev =       0.563170113987
             le_variance =       0.317160577288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229124
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229124
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398221407
  error estimate for blocks of size 2^( 2) =       0.000407992486
  error estimate for blocks of size 2^( 3) =       0.000416848461
  error estimate for blocks of size 2^( 4) =       0.000423303743
  error estimate for blocks of size 2^( 5) =       0.000426524741
  error estimate for blocks of size 2^( 6) =       0.000428675113
  error estimate for blocks of size 2^( 7) =       0.000428655504

      target function =                  N/A
              le_mean =     -17.216913823594
             les_mean =     296.739282027766
             stat err =       0.000426789775
             autocorr =       1.148626438131
              std dev =       0.563170113985
             le_variance =       0.317160577286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229122
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317214229122
                                         uncertainty =       0.002583332165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398221407
  error estimate for blocks of size 2^( 2) =       0.000407992486
  error estimate for blocks of size 2^( 3) =       0.000416848461
  error estimate for blocks of size 2^( 4) =       0.000423303743
  error estimate for blocks of size 2^( 5) =       0.000426524741
  error estimate for blocks of size 2^( 6) =       0.000428675113
  error estimate for blocks of size 2^( 7) =       0.000428655504

      target function =                  N/A
              le_mean =     -17.216913823594
             les_mean =     296.739282027764
             stat err =       0.000426789775
             autocorr =       1.148626438133
              std dev =       0.563170113983
             le_variance =       0.317160577284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216913823594        initial  <--
     2.3842e+07     2.3842e+08             5.2803e-12       -17.216913823594
     9.5367e+07     9.5367e+08             1.3200e-12       -17.216913823594
     3.8147e+08     3.8147e+09             3.3001e-13       -17.216913823594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9546
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1741
    reference variance = 0.731899
====================================================
  Execution time = 3.4931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4156e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341564857369
                                         uncertainty =       0.016979900724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341564857369
                                         uncertainty =       0.016979900724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413256955
  error estimate for blocks of size 2^( 2) =       0.000422895564
  error estimate for blocks of size 2^( 3) =       0.000431967428
  error estimate for blocks of size 2^( 4) =       0.000438841282
  error estimate for blocks of size 2^( 5) =       0.000442265606
  error estimate for blocks of size 2^( 6) =       0.000443680712
  error estimate for blocks of size 2^( 7) =       0.000444892023

      target function =                  N/A
              le_mean =     -17.216268481687
             les_mean =     296.741462884857
             stat err =       0.000442419906
             autocorr =       1.146117053105
              std dev =       0.584433590851
             le_variance =       0.341562622115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626848169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268481687       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268481687       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216268481687       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216268481687       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216268481687       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216268417098       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216268566922       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.033178e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268481687       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268481687       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216268481687       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216268481687       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216268424411       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216268350777       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216268821071       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.582148e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216268481687       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216268481687       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216268481687       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267984457       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216268447906       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216270015068       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265858276       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 6.474961e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4302e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.288694
====================================================
  Execution time = 3.4491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3099e-01
  Total weights = 2.0000e+06
  Execution time = 3.0939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269423
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269423
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406808545
  error estimate for blocks of size 2^( 2) =       0.000416112794
  error estimate for blocks of size 2^( 3) =       0.000424886628
  error estimate for blocks of size 2^( 4) =       0.000431541690
  error estimate for blocks of size 2^( 5) =       0.000434537627
  error estimate for blocks of size 2^( 6) =       0.000436334447
  error estimate for blocks of size 2^( 7) =       0.000437551380

      target function =                  N/A
              le_mean =     -17.217255575010
             les_mean =     296.764875754949
             stat err =       0.000434991286
             autocorr =       1.143354697295
              std dev =       0.575314162202
             le_variance =       0.330986385230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269424
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269424
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406808545
  error estimate for blocks of size 2^( 2) =       0.000416112794
  error estimate for blocks of size 2^( 3) =       0.000424886628
  error estimate for blocks of size 2^( 4) =       0.000431541690
  error estimate for blocks of size 2^( 5) =       0.000434537627
  error estimate for blocks of size 2^( 6) =       0.000436334447
  error estimate for blocks of size 2^( 7) =       0.000437551380

      target function =                  N/A
              le_mean =     -17.217255575010
             les_mean =     296.764875754950
             stat err =       0.000434991286
             autocorr =       1.143354697306
              std dev =       0.575314162202
             le_variance =       0.330986385231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269424
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269424
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406808545
  error estimate for blocks of size 2^( 2) =       0.000416112794
  error estimate for blocks of size 2^( 3) =       0.000424886628
  error estimate for blocks of size 2^( 4) =       0.000431541690
  error estimate for blocks of size 2^( 5) =       0.000434537627
  error estimate for blocks of size 2^( 6) =       0.000436334447
  error estimate for blocks of size 2^( 7) =       0.000437551380

      target function =                  N/A
              le_mean =     -17.217255575010
             les_mean =     296.764875754950
             stat err =       0.000434991286
             autocorr =       1.143354697295
              std dev =       0.575314162202
             le_variance =       0.330986385230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269423
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330972269423
                                         uncertainty =       0.012729227089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406808545
  error estimate for blocks of size 2^( 2) =       0.000416112794
  error estimate for blocks of size 2^( 3) =       0.000424886628
  error estimate for blocks of size 2^( 4) =       0.000431541690
  error estimate for blocks of size 2^( 5) =       0.000434537627
  error estimate for blocks of size 2^( 6) =       0.000436334447
  error estimate for blocks of size 2^( 7) =       0.000437551380

      target function =                  N/A
              le_mean =     -17.217255575010
             les_mean =     296.764875754949
             stat err =       0.000434991286
             autocorr =       1.143354697300
              std dev =       0.575314162202
             le_variance =       0.330986385230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217255575010        initial  <--
     2.3842e+08     2.3842e+09             1.0332e-12       -17.217255575010
     9.5367e+08     9.5367e+09             2.5821e-13       -17.217255575010
     3.8147e+09     3.8147e+10             6.4750e-14       -17.217255575010

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.1034
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.132
    reference variance = 0.142298
====================================================
  Execution time = 3.4484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1313e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312954412108
                                         uncertainty =       0.003120423401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312954412108
                                         uncertainty =       0.003120423401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395685489
  error estimate for blocks of size 2^( 2) =       0.000405302509
  error estimate for blocks of size 2^( 3) =       0.000413728290
  error estimate for blocks of size 2^( 4) =       0.000419944500
  error estimate for blocks of size 2^( 5) =       0.000424639794
  error estimate for blocks of size 2^( 6) =       0.000426885866
  error estimate for blocks of size 2^( 7) =       0.000428160219

      target function =                  N/A
              le_mean =     -17.215869106662
             les_mean =     296.699282954260
             stat err =       0.000424907595
             autocorr =       1.153157795039
              std dev =       0.559583785590
             le_variance =       0.313134013096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586910666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869106662       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869106662       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869106662       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869082023       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215868809979       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869106662       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869764990       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 7.500851e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869106662       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869106662       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869106662       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215864187149       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215870473752       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869158232       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215867026874       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 1.870657e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869106662       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869106662       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869106662       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869106662       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215873259858       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215878446494       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215889800233       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215827954388       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215869498977       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215831678664       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215987331219       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216163235914       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215678122244       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215755295998       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215116811583       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215865813640       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214908029300       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215873492860       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216860266217       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216276470906       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218033525644       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216951212846       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218895531113       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215907153197       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218313177967       residual = 9.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.223106941763       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215485399688       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215297913744       residual = 1.15e-04           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.208831518424       residual = 6.80e-03           smallest_sin_value = 9.99e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 4.719580e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3914e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.262963
====================================================
  Execution time = 3.6444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1720e-01
  Total weights = 2.0000e+06
  Execution time = 3.0910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398246107
  error estimate for blocks of size 2^( 2) =       0.000407569411
  error estimate for blocks of size 2^( 3) =       0.000415891187
  error estimate for blocks of size 2^( 4) =       0.000421688279
  error estimate for blocks of size 2^( 5) =       0.000425735633
  error estimate for blocks of size 2^( 6) =       0.000427737053
  error estimate for blocks of size 2^( 7) =       0.000428760820

      target function =                  N/A
              le_mean =     -17.216401780868
             les_mean =     296.721690044750
             stat err =       0.000425980446
             autocorr =       1.144132310706
              std dev =       0.563205045332
             le_variance =       0.317199923088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398246107
  error estimate for blocks of size 2^( 2) =       0.000407569411
  error estimate for blocks of size 2^( 3) =       0.000415891187
  error estimate for blocks of size 2^( 4) =       0.000421688279
  error estimate for blocks of size 2^( 5) =       0.000425735633
  error estimate for blocks of size 2^( 6) =       0.000427737053
  error estimate for blocks of size 2^( 7) =       0.000428760820

      target function =                  N/A
              le_mean =     -17.216401780868
             les_mean =     296.721690044750
             stat err =       0.000425980446
             autocorr =       1.144132310711
              std dev =       0.563205045332
             le_variance =       0.317199923088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398246107
  error estimate for blocks of size 2^( 2) =       0.000407569411
  error estimate for blocks of size 2^( 3) =       0.000415891187
  error estimate for blocks of size 2^( 4) =       0.000421688279
  error estimate for blocks of size 2^( 5) =       0.000425735633
  error estimate for blocks of size 2^( 6) =       0.000427737053
  error estimate for blocks of size 2^( 7) =       0.000428760820

      target function =                  N/A
              le_mean =     -17.216401780868
             les_mean =     296.721690044750
             stat err =       0.000425980446
             autocorr =       1.144132310712
              std dev =       0.563205045332
             le_variance =       0.317199923088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317302176346
                                         uncertainty =       0.004506482443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398246107
  error estimate for blocks of size 2^( 2) =       0.000407569411
  error estimate for blocks of size 2^( 3) =       0.000415891187
  error estimate for blocks of size 2^( 4) =       0.000421688279
  error estimate for blocks of size 2^( 5) =       0.000425735633
  error estimate for blocks of size 2^( 6) =       0.000427737053
  error estimate for blocks of size 2^( 7) =       0.000428760820

      target function =                  N/A
              le_mean =     -17.216401780868
             les_mean =     296.721690044750
             stat err =       0.000425980446
             autocorr =       1.144132310706
              std dev =       0.563205045332
             le_variance =       0.317199923088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216401780868        initial  <--
     2.3842e+09     2.3842e+10             7.5009e-14       -17.216401780868
     9.5367e+09     9.5367e+10             1.8707e-14       -17.216401780868
     3.8147e+10     3.8147e+11             4.7196e-15       -17.216401780868

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.0740
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.158729
====================================================
  Execution time = 3.4024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2423e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324279611995
                                         uncertainty =       0.005117803579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324279611995
                                         uncertainty =       0.005117803579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402636251
  error estimate for blocks of size 2^( 2) =       0.000411996388
  error estimate for blocks of size 2^( 3) =       0.000420476729
  error estimate for blocks of size 2^( 4) =       0.000427214235
  error estimate for blocks of size 2^( 5) =       0.000430738988
  error estimate for blocks of size 2^( 6) =       0.000432033717
  error estimate for blocks of size 2^( 7) =       0.000434762973

      target function =                  N/A
              le_mean =     -17.216307806140
             les_mean =     296.725486214341
             stat err =       0.000431187478
             autocorr =       1.146849776050
              std dev =       0.569413646388
             le_variance =       0.324231900692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630780614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307806140       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307806140       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307806140       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307808840       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216305254060       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216304294688       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216221592638       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216261245519       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216187287691       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216491863544       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216430147812       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216460434255       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215427365049       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215374253466       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215381887673       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216396100980       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214107104634       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222525498665       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216224650966       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.220456799865       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219763338152       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215972147758       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218670947581       residual = 8.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216776047799       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218666115227       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.211922954891       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.222181235091       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.232987959880       residual = 4.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.207598351383       residual = 1.31e-02           smallest_sin_value = 9.99e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 6.235402e-15

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307806140       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307806140       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307806140       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216289063206       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216343561829       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216171599922       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216343771799       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216287715978       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216154978734       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216099977169       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216461038964       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.219163725177       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216179936835       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214973735708       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.222448907068       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213253994815       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.223225758792       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.223226417033       residual = 7.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217296381217       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215424497353       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217979924090       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212650823728       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.203656020659       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.211818651546       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.205653909966       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.230338933799       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.213956606862       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.226925590205       residual = 1.82e-02           smallest_sin_value = 9.97e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.521972e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307806140       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307806140       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307806140       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216333667457       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216368246182       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216213575362       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216149224330       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215506958833       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218029821715       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213923729181       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215362246817       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.203114823026       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212422231099       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.228992355158       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.204786317981       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.189363667862       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.238679689525       residual = 7.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215053928075       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.202784271613       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215391381078       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.248718356289       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.163684886961       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.211547797609       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.189807490617       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.227260216166       residual = 5.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.185659105885       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.195770127795       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.198000945490       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.111446023084       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.133985539868       residual = 1.01e+00           smallest_sin_value = 9.94e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 3.559323e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246944 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3431e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.393422
====================================================
  Execution time = 3.3481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1352e-01
  Total weights = 2.0000e+06
  Execution time = 3.1191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395927812
  error estimate for blocks of size 2^( 2) =       0.000405386870
  error estimate for blocks of size 2^( 3) =       0.000413896676
  error estimate for blocks of size 2^( 4) =       0.000420064815
  error estimate for blocks of size 2^( 5) =       0.000423842080
  error estimate for blocks of size 2^( 6) =       0.000424611009
  error estimate for blocks of size 2^( 7) =       0.000426770410

      target function =                  N/A
              le_mean =     -17.217040723757
             les_mean =     296.740008791230
             stat err =       0.000423822079
             autocorr =       1.145869434023
              std dev =       0.559926481324
             le_variance =       0.313517664488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395927812
  error estimate for blocks of size 2^( 2) =       0.000405386870
  error estimate for blocks of size 2^( 3) =       0.000413896676
  error estimate for blocks of size 2^( 4) =       0.000420064815
  error estimate for blocks of size 2^( 5) =       0.000423842080
  error estimate for blocks of size 2^( 6) =       0.000424611009
  error estimate for blocks of size 2^( 7) =       0.000426770410

      target function =                  N/A
              le_mean =     -17.217040723757
             les_mean =     296.740008791230
             stat err =       0.000423822079
             autocorr =       1.145869434020
              std dev =       0.559926481324
             le_variance =       0.313517664488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395927812
  error estimate for blocks of size 2^( 2) =       0.000405386870
  error estimate for blocks of size 2^( 3) =       0.000413896676
  error estimate for blocks of size 2^( 4) =       0.000420064815
  error estimate for blocks of size 2^( 5) =       0.000423842080
  error estimate for blocks of size 2^( 6) =       0.000424611009
  error estimate for blocks of size 2^( 7) =       0.000426770410

      target function =                  N/A
              le_mean =     -17.217040723757
             les_mean =     296.740008791230
             stat err =       0.000423822079
             autocorr =       1.145869434021
              std dev =       0.559926481324
             le_variance =       0.313517664488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313378377156
                                         uncertainty =       0.002432524612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395927812
  error estimate for blocks of size 2^( 2) =       0.000405386870
  error estimate for blocks of size 2^( 3) =       0.000413896676
  error estimate for blocks of size 2^( 4) =       0.000420064815
  error estimate for blocks of size 2^( 5) =       0.000423842080
  error estimate for blocks of size 2^( 6) =       0.000424611009
  error estimate for blocks of size 2^( 7) =       0.000426770410

      target function =                  N/A
              le_mean =     -17.217040723757
             les_mean =     296.740008791230
             stat err =       0.000423822079
             autocorr =       1.145869434024
              std dev =       0.559926481324
             le_variance =       0.313517664488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217040723757        initial  <--
     2.3842e+10     2.3842e+11             6.2354e-15       -17.217040723757
     9.5367e+10     9.5367e+11             2.5220e-15       -17.217040723757
     3.8147e+11     3.8147e+12             3.5593e-16       -17.217040723757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1382
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.293099
====================================================
  Execution time = 3.4296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2018e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320224766262
                                         uncertainty =       0.005563977326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320224766262
                                         uncertainty =       0.005563977326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400114324
  error estimate for blocks of size 2^( 2) =       0.000409826356
  error estimate for blocks of size 2^( 3) =       0.000418047560
  error estimate for blocks of size 2^( 4) =       0.000422677236
  error estimate for blocks of size 2^( 5) =       0.000426648361
  error estimate for blocks of size 2^( 6) =       0.000430752090
  error estimate for blocks of size 2^( 7) =       0.000435218325

      target function =                  N/A
              le_mean =     -17.217121257212
             les_mean =     296.749447169464
             stat err =       0.000428824003
             autocorr =       1.148655972709
              std dev =       0.565847103026
             le_variance =       0.320182944003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712125721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121257212       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121257212       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217121257212       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217121257212       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217235224554       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217020868424       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217777167363       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217206387571       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.219865765642       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216178850591       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213219337539       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.223634656126       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.221851420869       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212718953550       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.210802628167       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211716031660       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.231260377615       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216152932538       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.221200430890       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.190729294094       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.190759306168       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.219128427232       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.272080505526       residual = 4.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213845563175       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.225876240313       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.205134762933       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.200629678020       residual = 4.11e-02           smallest_sin_value = 9.96e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 4.642373e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121257212       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121257212       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121257212       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121257212       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3710e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.258654
====================================================
  Execution time = 3.3981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1903e-01
  Total weights = 2.0000e+06
  Execution time = 3.1139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399390815
  error estimate for blocks of size 2^( 2) =       0.000408835489
  error estimate for blocks of size 2^( 3) =       0.000417581308
  error estimate for blocks of size 2^( 4) =       0.000424288298
  error estimate for blocks of size 2^( 5) =       0.000427413920
  error estimate for blocks of size 2^( 6) =       0.000429914752
  error estimate for blocks of size 2^( 7) =       0.000430378542

      target function =                  N/A
              le_mean =     -17.216730139088
             les_mean =     296.734822568483
             stat err =       0.000427998878
             autocorr =       1.148389241008
              std dev =       0.564823906907
             le_variance =       0.319026045814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399390815
  error estimate for blocks of size 2^( 2) =       0.000408835489
  error estimate for blocks of size 2^( 3) =       0.000417581308
  error estimate for blocks of size 2^( 4) =       0.000424288298
  error estimate for blocks of size 2^( 5) =       0.000427413920
  error estimate for blocks of size 2^( 6) =       0.000429914752
  error estimate for blocks of size 2^( 7) =       0.000430378542

      target function =                  N/A
              le_mean =     -17.216730139088
             les_mean =     296.734822568483
             stat err =       0.000427998878
             autocorr =       1.148389241008
              std dev =       0.564823906907
             le_variance =       0.319026045814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399390815
  error estimate for blocks of size 2^( 2) =       0.000408835489
  error estimate for blocks of size 2^( 3) =       0.000417581308
  error estimate for blocks of size 2^( 4) =       0.000424288298
  error estimate for blocks of size 2^( 5) =       0.000427413920
  error estimate for blocks of size 2^( 6) =       0.000429914752
  error estimate for blocks of size 2^( 7) =       0.000430378542

      target function =                  N/A
              le_mean =     -17.216730139088
             les_mean =     296.734822568483
             stat err =       0.000427998878
             autocorr =       1.148389241008
              std dev =       0.564823906907
             le_variance =       0.319026045814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020268145
                                         uncertainty =       0.002916938877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399390815
  error estimate for blocks of size 2^( 2) =       0.000408835489
  error estimate for blocks of size 2^( 3) =       0.000417581308
  error estimate for blocks of size 2^( 4) =       0.000424288298
  error estimate for blocks of size 2^( 5) =       0.000427413920
  error estimate for blocks of size 2^( 6) =       0.000429914752
  error estimate for blocks of size 2^( 7) =       0.000430378542

      target function =                  N/A
              le_mean =     -17.216730139088
             les_mean =     296.734822568483
             stat err =       0.000427998878
             autocorr =       1.148389241008
              std dev =       0.564823906907
             le_variance =       0.319026045814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216730139088        initial  <--
     2.3842e+11     2.3842e+12             4.6424e-16       -17.216730139088
     9.5367e+11     9.5367e+12             0.0000e+00       -17.216730139088
     3.8147e+12     3.8147e+13             0.0000e+00       -17.216730139088

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6973
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.264811
====================================================
  Execution time = 3.4693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315253882428
                                         uncertainty =       0.003124109168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315253882428
                                         uncertainty =       0.003124109168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397015443
  error estimate for blocks of size 2^( 2) =       0.000406726150
  error estimate for blocks of size 2^( 3) =       0.000414944731
  error estimate for blocks of size 2^( 4) =       0.000421251930
  error estimate for blocks of size 2^( 5) =       0.000425285239
  error estimate for blocks of size 2^( 6) =       0.000427208410
  error estimate for blocks of size 2^( 7) =       0.000427458135

      target function =                  N/A
              le_mean =     -17.216811305461
             les_mean =     296.733833894297
             stat err =       0.000425300928
             autocorr =       1.147566498085
              std dev =       0.561464624059
             le_variance =       0.315242524070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681130546e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216811305461       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4050e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2889
    reference variance = 0.25061
====================================================
  Execution time = 3.6037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1605e-01
  Total weights = 2.0000e+06
  Execution time = 3.1052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397525664
  error estimate for blocks of size 2^( 2) =       0.000407161500
  error estimate for blocks of size 2^( 3) =       0.000415889748
  error estimate for blocks of size 2^( 4) =       0.000422558676
  error estimate for blocks of size 2^( 5) =       0.000427055234
  error estimate for blocks of size 2^( 6) =       0.000429899406
  error estimate for blocks of size 2^( 7) =       0.000433672902

      target function =                  N/A
              le_mean =     -17.217195076763
             les_mean =     296.747859459587
             stat err =       0.000428296555
             autocorr =       1.160803795113
              std dev =       0.562186184718
             le_variance =       0.316053306288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397525664
  error estimate for blocks of size 2^( 2) =       0.000407161500
  error estimate for blocks of size 2^( 3) =       0.000415889748
  error estimate for blocks of size 2^( 4) =       0.000422558676
  error estimate for blocks of size 2^( 5) =       0.000427055234
  error estimate for blocks of size 2^( 6) =       0.000429899406
  error estimate for blocks of size 2^( 7) =       0.000433672902

      target function =                  N/A
              le_mean =     -17.217195076763
             les_mean =     296.747859459587
             stat err =       0.000428296555
             autocorr =       1.160803795113
              std dev =       0.562186184718
             le_variance =       0.316053306288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397525664
  error estimate for blocks of size 2^( 2) =       0.000407161500
  error estimate for blocks of size 2^( 3) =       0.000415889748
  error estimate for blocks of size 2^( 4) =       0.000422558676
  error estimate for blocks of size 2^( 5) =       0.000427055234
  error estimate for blocks of size 2^( 6) =       0.000429899406
  error estimate for blocks of size 2^( 7) =       0.000433672902

      target function =                  N/A
              le_mean =     -17.217195076763
             les_mean =     296.747859459587
             stat err =       0.000428296555
             autocorr =       1.160803795113
              std dev =       0.562186184718
             le_variance =       0.316053306288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316136899618
                                         uncertainty =       0.002707005745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397525664
  error estimate for blocks of size 2^( 2) =       0.000407161500
  error estimate for blocks of size 2^( 3) =       0.000415889748
  error estimate for blocks of size 2^( 4) =       0.000422558676
  error estimate for blocks of size 2^( 5) =       0.000427055234
  error estimate for blocks of size 2^( 6) =       0.000429899406
  error estimate for blocks of size 2^( 7) =       0.000433672902

      target function =                  N/A
              le_mean =     -17.217195076763
             les_mean =     296.747859459587
             stat err =       0.000428296555
             autocorr =       1.160803795113
              std dev =       0.562186184718
             le_variance =       0.316053306288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217195076763        initial  <--
     2.3842e+12     2.3842e+13             0.0000e+00       -17.217195076763
     9.5367e+12     9.5367e+13             0.0000e+00       -17.217195076763
     3.8147e+13     3.8147e+14             0.0000e+00       -17.217195076763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.6807
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.3334
    reference variance = 0.767037
====================================================
  Execution time = 3.4178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2713e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327143434709
                                         uncertainty =       0.004228775452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327143434709
                                         uncertainty =       0.004228775452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404431734
  error estimate for blocks of size 2^( 2) =       0.000413995746
  error estimate for blocks of size 2^( 3) =       0.000422813987
  error estimate for blocks of size 2^( 4) =       0.000429776333
  error estimate for blocks of size 2^( 5) =       0.000433867415
  error estimate for blocks of size 2^( 6) =       0.000436182894
  error estimate for blocks of size 2^( 7) =       0.000439858744

      target function =                  N/A
              le_mean =     -17.216612637704
             les_mean =     296.738880608324
             stat err =       0.000434921347
             autocorr =       1.156461014235
              std dev =       0.571952843451
             le_variance =       0.327130055132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661263770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216612637704       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216612637704       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216612637704       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216612637704       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216612637704       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.189960904784       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.888128436153       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.614488922944       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.854029233133       residual = 2.66e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.041809410020       residual = 9.91e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.114450925401       residual = 1.79e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.652480543531       residual = 4.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -19.662720221175       residual = 9.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.073305292547       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -19.470569450823       residual = 8.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.887383107935       residual = 6.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -19.340503336175       residual = 6.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -20.664348012399       residual = 1.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -20.086350120263       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -12.858641364757       residual = 2.94e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -18.118191937618       residual = 1.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -13.484272789228       residual = 2.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -14.335802785877       residual = 1.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -14.065720980642       residual = 1.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -10.295200866428       residual = 6.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -23.872967813797       residual = 1.09e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -13.059875825982       residual = 3.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =      -9.880741806248       residual = 7.94e+03           smallest_sin_value = 1.00e+00
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 3.455841e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216612637704       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216612637704       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3565e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.233331
====================================================
  Execution time = 3.3809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2447e-01
  Total weights = 2.0000e+06
  Execution time = 3.1029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402784148
  error estimate for blocks of size 2^( 2) =       0.000412602121
  error estimate for blocks of size 2^( 3) =       0.000420670863
  error estimate for blocks of size 2^( 4) =       0.000427034850
  error estimate for blocks of size 2^( 5) =       0.000430183758
  error estimate for blocks of size 2^( 6) =       0.000433396296
  error estimate for blocks of size 2^( 7) =       0.000435546661

      target function =                  N/A
              le_mean =     -17.216550465977
             les_mean =     296.734079924727
             stat err =       0.000431540391
             autocorr =       1.147884423170
              std dev =       0.569622804534
             le_variance =       0.324470139445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402784148
  error estimate for blocks of size 2^( 2) =       0.000412602121
  error estimate for blocks of size 2^( 3) =       0.000420670863
  error estimate for blocks of size 2^( 4) =       0.000427034850
  error estimate for blocks of size 2^( 5) =       0.000430183758
  error estimate for blocks of size 2^( 6) =       0.000433396296
  error estimate for blocks of size 2^( 7) =       0.000435546661

      target function =                  N/A
              le_mean =     -17.216550465977
             les_mean =     296.734079924727
             stat err =       0.000431540391
             autocorr =       1.147884423170
              std dev =       0.569622804534
             le_variance =       0.324470139445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402784148
  error estimate for blocks of size 2^( 2) =       0.000412602121
  error estimate for blocks of size 2^( 3) =       0.000420670863
  error estimate for blocks of size 2^( 4) =       0.000427034850
  error estimate for blocks of size 2^( 5) =       0.000430183758
  error estimate for blocks of size 2^( 6) =       0.000433396296
  error estimate for blocks of size 2^( 7) =       0.000435546661

      target function =                  N/A
              le_mean =     -17.216550465977
             les_mean =     296.734079924727
             stat err =       0.000431540391
             autocorr =       1.147884423170
              std dev =       0.569622804534
             le_variance =       0.324470139445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389226325
                                         uncertainty =       0.007024399216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402784148
  error estimate for blocks of size 2^( 2) =       0.000412602121
  error estimate for blocks of size 2^( 3) =       0.000420670863
  error estimate for blocks of size 2^( 4) =       0.000427034850
  error estimate for blocks of size 2^( 5) =       0.000430183758
  error estimate for blocks of size 2^( 6) =       0.000433396296
  error estimate for blocks of size 2^( 7) =       0.000435546661

      target function =                  N/A
              le_mean =     -17.216550465977
             les_mean =     296.734079924727
             stat err =       0.000431540391
             autocorr =       1.147884423170
              std dev =       0.569622804534
             le_variance =       0.324470139445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216550465977        initial  <--
     2.3842e+13     2.3842e+14             0.0000e+00       -17.216550465977
     9.5367e+13     9.5367e+14             3.4558e-19       -17.216550465977
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216550465977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4078
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3066e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1331
    reference variance = 0.195578
====================================================
  Execution time = 3.3671e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2314e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144841954
                                         uncertainty =       0.004313120044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144841954
                                         uncertainty =       0.004313120044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401959190
  error estimate for blocks of size 2^( 2) =       0.000411322622
  error estimate for blocks of size 2^( 3) =       0.000420333288
  error estimate for blocks of size 2^( 4) =       0.000426403689
  error estimate for blocks of size 2^( 5) =       0.000430125425
  error estimate for blocks of size 2^( 6) =       0.000431342589
  error estimate for blocks of size 2^( 7) =       0.000431453802

      target function =                  N/A
              le_mean =     -17.217574830977
             les_mean =     296.768025279906
             stat err =       0.000429831377
             autocorr =       1.143489823717
              std dev =       0.568456138301
             le_variance =       0.323142381172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721757483098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217574830977       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2773e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2629
    reference variance = 0.482411
====================================================
  Execution time = 3.3702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2349e-01
  Total weights = 2.0000e+06
  Execution time = 3.0988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402177942
  error estimate for blocks of size 2^( 2) =       0.000411484052
  error estimate for blocks of size 2^( 3) =       0.000419716727
  error estimate for blocks of size 2^( 4) =       0.000425820162
  error estimate for blocks of size 2^( 5) =       0.000430118962
  error estimate for blocks of size 2^( 6) =       0.000430978192
  error estimate for blocks of size 2^( 7) =       0.000430953811

      target function =                  N/A
              le_mean =     -17.217263516899
             les_mean =     296.757657043325
             stat err =       0.000429467782
             autocorr =       1.140314593615
              std dev =       0.568765500638
             le_variance =       0.323494194716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402177942
  error estimate for blocks of size 2^( 2) =       0.000411484052
  error estimate for blocks of size 2^( 3) =       0.000419716727
  error estimate for blocks of size 2^( 4) =       0.000425820162
  error estimate for blocks of size 2^( 5) =       0.000430118962
  error estimate for blocks of size 2^( 6) =       0.000430978192
  error estimate for blocks of size 2^( 7) =       0.000430953811

      target function =                  N/A
              le_mean =     -17.217263516899
             les_mean =     296.757657043325
             stat err =       0.000429467782
             autocorr =       1.140314593615
              std dev =       0.568765500638
             le_variance =       0.323494194716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402177942
  error estimate for blocks of size 2^( 2) =       0.000411484052
  error estimate for blocks of size 2^( 3) =       0.000419716727
  error estimate for blocks of size 2^( 4) =       0.000425820162
  error estimate for blocks of size 2^( 5) =       0.000430118962
  error estimate for blocks of size 2^( 6) =       0.000430978192
  error estimate for blocks of size 2^( 7) =       0.000430953811

      target function =                  N/A
              le_mean =     -17.217263516899
             les_mean =     296.757657043325
             stat err =       0.000429467782
             autocorr =       1.140314593615
              std dev =       0.568765500638
             le_variance =       0.323494194716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596522298
                                         uncertainty =       0.004466937941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402177942
  error estimate for blocks of size 2^( 2) =       0.000411484052
  error estimate for blocks of size 2^( 3) =       0.000419716727
  error estimate for blocks of size 2^( 4) =       0.000425820162
  error estimate for blocks of size 2^( 5) =       0.000430118962
  error estimate for blocks of size 2^( 6) =       0.000430978192
  error estimate for blocks of size 2^( 7) =       0.000430953811

      target function =                  N/A
              le_mean =     -17.217263516899
             les_mean =     296.757657043325
             stat err =       0.000429467782
             autocorr =       1.140314593615
              std dev =       0.568765500638
             le_variance =       0.323494194716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217263516899        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -17.217263516899
     9.5367e+14     9.5367e+15             0.0000e+00       -17.217263516899
     3.8147e+15     3.8147e+16             0.0000e+00       -17.217263516899

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2626
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2618
    reference variance = 0.188643
====================================================
  Execution time = 3.4180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1685e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316855360365
                                         uncertainty =       0.002666080422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316855360365
                                         uncertainty =       0.002666080422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398023883
  error estimate for blocks of size 2^( 2) =       0.000407433731
  error estimate for blocks of size 2^( 3) =       0.000415944104
  error estimate for blocks of size 2^( 4) =       0.000422042153
  error estimate for blocks of size 2^( 5) =       0.000425489960
  error estimate for blocks of size 2^( 6) =       0.000427661715
  error estimate for blocks of size 2^( 7) =       0.000429765035

      target function =                  N/A
              le_mean =     -17.217198697428
             les_mean =     296.748776851799
             stat err =       0.000426239716
             autocorr =       1.146804958059
              std dev =       0.562890774050
             le_variance =       0.316846023511


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721719869743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217198697428       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217198697428       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217198697429       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217198697428       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.165659174663       residual = 6.58e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -26.350214303024       residual = 1.30e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.294416523763       residual = 3.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -12.478714960826       residual = 2.96e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 1.749987e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217198697428       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217198697428       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217198697428       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -12.831191951719       residual = 3.40e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -12.874405418763       residual = 2.64e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -15.690583607409       residual = 4.11e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 4.374967e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217198697428       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217198697428       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217198697428       residual = 3.74e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 1.093742e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3300e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2427
    reference variance = 0.231269
====================================================
  Execution time = 3.3178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2459e-01
  Total weights = 2.0000e+06
  Execution time = 3.4916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402860851
  error estimate for blocks of size 2^( 2) =       0.000412605327
  error estimate for blocks of size 2^( 3) =       0.000420897774
  error estimate for blocks of size 2^( 4) =       0.000427816430
  error estimate for blocks of size 2^( 5) =       0.000431645005
  error estimate for blocks of size 2^( 6) =       0.000432839975
  error estimate for blocks of size 2^( 7) =       0.000434679157

      target function =                  N/A
              le_mean =     -17.216188772575
             les_mean =     296.721749421933
             stat err =       0.000431745142
             autocorr =       1.148536458602
              std dev =       0.569731279911
             le_variance =       0.324593731309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402860851
  error estimate for blocks of size 2^( 2) =       0.000412605327
  error estimate for blocks of size 2^( 3) =       0.000420897774
  error estimate for blocks of size 2^( 4) =       0.000427816430
  error estimate for blocks of size 2^( 5) =       0.000431645005
  error estimate for blocks of size 2^( 6) =       0.000432839975
  error estimate for blocks of size 2^( 7) =       0.000434679157

      target function =                  N/A
              le_mean =     -17.216188772575
             les_mean =     296.721749421933
             stat err =       0.000431745142
             autocorr =       1.148536458602
              std dev =       0.569731279911
             le_variance =       0.324593731309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402860851
  error estimate for blocks of size 2^( 2) =       0.000412605327
  error estimate for blocks of size 2^( 3) =       0.000420897774
  error estimate for blocks of size 2^( 4) =       0.000427816430
  error estimate for blocks of size 2^( 5) =       0.000431645005
  error estimate for blocks of size 2^( 6) =       0.000432839975
  error estimate for blocks of size 2^( 7) =       0.000434679157

      target function =                  N/A
              le_mean =     -17.216188772575
             les_mean =     296.721749421933
             stat err =       0.000431745142
             autocorr =       1.148536458602
              std dev =       0.569731279911
             le_variance =       0.324593731309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650542045
                                         uncertainty =       0.003220516579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402860851
  error estimate for blocks of size 2^( 2) =       0.000412605327
  error estimate for blocks of size 2^( 3) =       0.000420897774
  error estimate for blocks of size 2^( 4) =       0.000427816430
  error estimate for blocks of size 2^( 5) =       0.000431645005
  error estimate for blocks of size 2^( 6) =       0.000432839975
  error estimate for blocks of size 2^( 7) =       0.000434679157

      target function =                  N/A
              le_mean =     -17.216188772575
             les_mean =     296.721749421933
             stat err =       0.000431745142
             autocorr =       1.148536458602
              std dev =       0.569731279911
             le_variance =       0.324593731309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216188772575        initial  <--
     2.3842e+15     2.3842e+16             1.7500e-20       -17.216188772575
     9.5367e+15     9.5367e+16             4.3750e-21       -17.216188772575
     3.8147e+16     3.8147e+17             1.0937e-21       -17.216188772575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.4263
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.197871
====================================================
  Execution time = 3.5084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1951e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319475971103
                                         uncertainty =       0.002857999286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319475971103
                                         uncertainty =       0.002857999286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399695236
  error estimate for blocks of size 2^( 2) =       0.000409095839
  error estimate for blocks of size 2^( 3) =       0.000417752212
  error estimate for blocks of size 2^( 4) =       0.000423931109
  error estimate for blocks of size 2^( 5) =       0.000427956573
  error estimate for blocks of size 2^( 6) =       0.000430027926
  error estimate for blocks of size 2^( 7) =       0.000430280464

      target function =                  N/A
              le_mean =     -17.216300175173
             les_mean =     296.720504125344
             stat err =       0.000428049018
             autocorr =       1.146909277947
              std dev =       0.565254423625
             le_variance =       0.319512563427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630017517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300175173       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4398e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1501
    reference variance = 0.217527
====================================================
  Execution time = 3.3746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2261e-01
  Total weights = 2.0000e+06
  Execution time = 3.1043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401628609
  error estimate for blocks of size 2^( 2) =       0.000411301632
  error estimate for blocks of size 2^( 3) =       0.000419687841
  error estimate for blocks of size 2^( 4) =       0.000426205937
  error estimate for blocks of size 2^( 5) =       0.000429851640
  error estimate for blocks of size 2^( 6) =       0.000431490259
  error estimate for blocks of size 2^( 7) =       0.000433699212

      target function =                  N/A
              le_mean =     -17.216938299971
             les_mean =     296.745575343287
             stat err =       0.000430311762
             autocorr =       1.147934613994
              std dev =       0.567988626278
             le_variance =       0.322611079581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401628609
  error estimate for blocks of size 2^( 2) =       0.000411301632
  error estimate for blocks of size 2^( 3) =       0.000419687841
  error estimate for blocks of size 2^( 4) =       0.000426205937
  error estimate for blocks of size 2^( 5) =       0.000429851640
  error estimate for blocks of size 2^( 6) =       0.000431490259
  error estimate for blocks of size 2^( 7) =       0.000433699212

      target function =                  N/A
              le_mean =     -17.216938299971
             les_mean =     296.745575343287
             stat err =       0.000430311762
             autocorr =       1.147934613994
              std dev =       0.567988626278
             le_variance =       0.322611079581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401628609
  error estimate for blocks of size 2^( 2) =       0.000411301632
  error estimate for blocks of size 2^( 3) =       0.000419687841
  error estimate for blocks of size 2^( 4) =       0.000426205937
  error estimate for blocks of size 2^( 5) =       0.000429851640
  error estimate for blocks of size 2^( 6) =       0.000431490259
  error estimate for blocks of size 2^( 7) =       0.000433699212

      target function =                  N/A
              le_mean =     -17.216938299971
             les_mean =     296.745575343287
             stat err =       0.000430311762
             autocorr =       1.147934613994
              std dev =       0.567988626278
             le_variance =       0.322611079581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322668184658
                                         uncertainty =       0.003249423989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401628609
  error estimate for blocks of size 2^( 2) =       0.000411301632
  error estimate for blocks of size 2^( 3) =       0.000419687841
  error estimate for blocks of size 2^( 4) =       0.000426205937
  error estimate for blocks of size 2^( 5) =       0.000429851640
  error estimate for blocks of size 2^( 6) =       0.000431490259
  error estimate for blocks of size 2^( 7) =       0.000433699212

      target function =                  N/A
              le_mean =     -17.216938299971
             les_mean =     296.745575343287
             stat err =       0.000430311762
             autocorr =       1.147934613994
              std dev =       0.567988626278
             le_variance =       0.322611079581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938299971        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -17.216938299971
     9.5367e+16     9.5367e+17             0.0000e+00       -17.216938299971
     3.8147e+17     3.8147e+18             0.0000e+00       -17.216938299971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3500
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1315
    reference variance = 0.232439
====================================================
  Execution time = 3.4248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328225500769
                                         uncertainty =       0.005712791210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328225500769
                                         uncertainty =       0.005712791210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405061538
  error estimate for blocks of size 2^( 2) =       0.000414472330
  error estimate for blocks of size 2^( 3) =       0.000422419377
  error estimate for blocks of size 2^( 4) =       0.000428603188
  error estimate for blocks of size 2^( 5) =       0.000432717587
  error estimate for blocks of size 2^( 6) =       0.000434946592
  error estimate for blocks of size 2^( 7) =       0.000436596871

      target function =                  N/A
              le_mean =     -17.216857499768
             les_mean =     296.748331702886
             stat err =       0.000433216059
             autocorr =       1.143844740705
              std dev =       0.572843521081
             le_variance =       0.328149699645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685749977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857499768       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3611e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.270484
====================================================
  Execution time = 3.3700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2248e-01
  Total weights = 2.0000e+06
  Execution time = 3.1190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401545515
  error estimate for blocks of size 2^( 2) =       0.000411292850
  error estimate for blocks of size 2^( 3) =       0.000419977093
  error estimate for blocks of size 2^( 4) =       0.000425492567
  error estimate for blocks of size 2^( 5) =       0.000429165068
  error estimate for blocks of size 2^( 6) =       0.000431070005
  error estimate for blocks of size 2^( 7) =       0.000433932760

      target function =                  N/A
              le_mean =     -17.217373143695
             les_mean =     296.760415409409
             stat err =       0.000429915100
             autocorr =       1.146293525783
              std dev =       0.567871113386
             le_variance =       0.322477601418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401545515
  error estimate for blocks of size 2^( 2) =       0.000411292850
  error estimate for blocks of size 2^( 3) =       0.000419977093
  error estimate for blocks of size 2^( 4) =       0.000425492567
  error estimate for blocks of size 2^( 5) =       0.000429165068
  error estimate for blocks of size 2^( 6) =       0.000431070005
  error estimate for blocks of size 2^( 7) =       0.000433932760

      target function =                  N/A
              le_mean =     -17.217373143695
             les_mean =     296.760415409409
             stat err =       0.000429915100
             autocorr =       1.146293525783
              std dev =       0.567871113386
             le_variance =       0.322477601418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401545515
  error estimate for blocks of size 2^( 2) =       0.000411292850
  error estimate for blocks of size 2^( 3) =       0.000419977093
  error estimate for blocks of size 2^( 4) =       0.000425492567
  error estimate for blocks of size 2^( 5) =       0.000429165068
  error estimate for blocks of size 2^( 6) =       0.000431070005
  error estimate for blocks of size 2^( 7) =       0.000433932760

      target function =                  N/A
              le_mean =     -17.217373143695
             les_mean =     296.760415409409
             stat err =       0.000429915100
             autocorr =       1.146293525783
              std dev =       0.567871113386
             le_variance =       0.322477601418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485517889
                                         uncertainty =       0.005364998066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401545515
  error estimate for blocks of size 2^( 2) =       0.000411292850
  error estimate for blocks of size 2^( 3) =       0.000419977093
  error estimate for blocks of size 2^( 4) =       0.000425492567
  error estimate for blocks of size 2^( 5) =       0.000429165068
  error estimate for blocks of size 2^( 6) =       0.000431070005
  error estimate for blocks of size 2^( 7) =       0.000433932760

      target function =                  N/A
              le_mean =     -17.217373143695
             les_mean =     296.760415409409
             stat err =       0.000429915100
             autocorr =       1.146293525783
              std dev =       0.567871113386
             le_variance =       0.322477601418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217373143695        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -17.217373143695
     9.5367e+17     9.5367e+18             0.0000e+00       -17.217373143695
     3.8147e+18     3.8147e+19             0.0000e+00       -17.217373143695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3689
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.246466
====================================================
  Execution time = 3.3709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321221752611
                                         uncertainty =       0.003486985229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321221752611
                                         uncertainty =       0.003486985229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400759716
  error estimate for blocks of size 2^( 2) =       0.000410446222
  error estimate for blocks of size 2^( 3) =       0.000419086942
  error estimate for blocks of size 2^( 4) =       0.000424891823
  error estimate for blocks of size 2^( 5) =       0.000428989109
  error estimate for blocks of size 2^( 6) =       0.000430537105
  error estimate for blocks of size 2^( 7) =       0.000435084194

      target function =                  N/A
              le_mean =     -17.216575076243
             les_mean =     296.731673895231
             stat err =       0.000429875558
             autocorr =       1.150581494916
              std dev =       0.566759825623
             le_variance =       0.321216699940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657507624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575076243       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575076243       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216575076243       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216575076243       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 2.098150e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575076243       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575076243       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216575076243       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216575076243       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216575076243       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 5.245376e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216575076243       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575076243       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216575076243       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216575076243       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216575076240       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 1.311344e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3053e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2421
    reference variance = 0.154929
====================================================
  Execution time = 3.3499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2314e-01
  Total weights = 2.0000e+06
  Execution time = 3.1038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401956658
  error estimate for blocks of size 2^( 2) =       0.000411386336
  error estimate for blocks of size 2^( 3) =       0.000419899194
  error estimate for blocks of size 2^( 4) =       0.000426279844
  error estimate for blocks of size 2^( 5) =       0.000430654766
  error estimate for blocks of size 2^( 6) =       0.000432978303
  error estimate for blocks of size 2^( 7) =       0.000434227965

      target function =                  N/A
              le_mean =     -17.217486196187
             les_mean =     296.764969063985
             stat err =       0.000431035220
             autocorr =       1.149918501754
              std dev =       0.568452557099
             le_variance =       0.323138309673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401956658
  error estimate for blocks of size 2^( 2) =       0.000411386336
  error estimate for blocks of size 2^( 3) =       0.000419899194
  error estimate for blocks of size 2^( 4) =       0.000426279844
  error estimate for blocks of size 2^( 5) =       0.000430654766
  error estimate for blocks of size 2^( 6) =       0.000432978303
  error estimate for blocks of size 2^( 7) =       0.000434227965

      target function =                  N/A
              le_mean =     -17.217486196187
             les_mean =     296.764969063985
             stat err =       0.000431035220
             autocorr =       1.149918501754
              std dev =       0.568452557099
             le_variance =       0.323138309673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401956658
  error estimate for blocks of size 2^( 2) =       0.000411386336
  error estimate for blocks of size 2^( 3) =       0.000419899194
  error estimate for blocks of size 2^( 4) =       0.000426279844
  error estimate for blocks of size 2^( 5) =       0.000430654766
  error estimate for blocks of size 2^( 6) =       0.000432978303
  error estimate for blocks of size 2^( 7) =       0.000434227965

      target function =                  N/A
              le_mean =     -17.217486196187
             les_mean =     296.764969063985
             stat err =       0.000431035220
             autocorr =       1.149918501754
              std dev =       0.568452557099
             le_variance =       0.323138309673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195484045
                                         uncertainty =       0.004843683169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401956658
  error estimate for blocks of size 2^( 2) =       0.000411386336
  error estimate for blocks of size 2^( 3) =       0.000419899194
  error estimate for blocks of size 2^( 4) =       0.000426279844
  error estimate for blocks of size 2^( 5) =       0.000430654766
  error estimate for blocks of size 2^( 6) =       0.000432978303
  error estimate for blocks of size 2^( 7) =       0.000434227965

      target function =                  N/A
              le_mean =     -17.217486196187
             les_mean =     296.764969063985
             stat err =       0.000431035220
             autocorr =       1.149918501754
              std dev =       0.568452557099
             le_variance =       0.323138309673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217486196187        initial  <--
     2.3842e+18     2.3842e+19             2.0982e-23       -17.217486196187
     9.5367e+18     9.5367e+19             5.2454e-24       -17.217486196187
     3.8147e+19     3.8147e+20             1.3113e-24       -17.217486196187

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0919
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.27523
====================================================
  Execution time = 3.7040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316449354862
                                         uncertainty =       0.003245792553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316449354862
                                         uncertainty =       0.003245792553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397781812
  error estimate for blocks of size 2^( 2) =       0.000407650772
  error estimate for blocks of size 2^( 3) =       0.000416006463
  error estimate for blocks of size 2^( 4) =       0.000422477077
  error estimate for blocks of size 2^( 5) =       0.000426095550
  error estimate for blocks of size 2^( 6) =       0.000428020683
  error estimate for blocks of size 2^( 7) =       0.000428085085

      target function =                  N/A
              le_mean =     -17.216838911936
             les_mean =     296.736002700456
             stat err =       0.000426169599
             autocorr =       1.147823438576
              std dev =       0.562548432705
             le_variance =       0.316460739139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683891194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838911936       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6359e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1808
    reference variance = 0.209267
====================================================
  Execution time = 3.3574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1782e-01
  Total weights = 2.0000e+06
  Execution time = 3.1073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398632951
  error estimate for blocks of size 2^( 2) =       0.000408443263
  error estimate for blocks of size 2^( 3) =       0.000417152417
  error estimate for blocks of size 2^( 4) =       0.000423761861
  error estimate for blocks of size 2^( 5) =       0.000429361992
  error estimate for blocks of size 2^( 6) =       0.000432977770
  error estimate for blocks of size 2^( 7) =       0.000433216160

      target function =                  N/A
              le_mean =     -17.217112581731
             les_mean =     296.746781952375
             stat err =       0.000429829446
             autocorr =       1.162641814515
              std dev =       0.563752125742
             le_variance =       0.317816459278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398632951
  error estimate for blocks of size 2^( 2) =       0.000408443263
  error estimate for blocks of size 2^( 3) =       0.000417152417
  error estimate for blocks of size 2^( 4) =       0.000423761861
  error estimate for blocks of size 2^( 5) =       0.000429361992
  error estimate for blocks of size 2^( 6) =       0.000432977770
  error estimate for blocks of size 2^( 7) =       0.000433216160

      target function =                  N/A
              le_mean =     -17.217112581731
             les_mean =     296.746781952375
             stat err =       0.000429829446
             autocorr =       1.162641814515
              std dev =       0.563752125742
             le_variance =       0.317816459278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398632951
  error estimate for blocks of size 2^( 2) =       0.000408443263
  error estimate for blocks of size 2^( 3) =       0.000417152417
  error estimate for blocks of size 2^( 4) =       0.000423761861
  error estimate for blocks of size 2^( 5) =       0.000429361992
  error estimate for blocks of size 2^( 6) =       0.000432977770
  error estimate for blocks of size 2^( 7) =       0.000433216160

      target function =                  N/A
              le_mean =     -17.217112581731
             les_mean =     296.746781952375
             stat err =       0.000429829446
             autocorr =       1.162641814515
              std dev =       0.563752125742
             le_variance =       0.317816459278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317798773647
                                         uncertainty =       0.004914067382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398632951
  error estimate for blocks of size 2^( 2) =       0.000408443263
  error estimate for blocks of size 2^( 3) =       0.000417152417
  error estimate for blocks of size 2^( 4) =       0.000423761861
  error estimate for blocks of size 2^( 5) =       0.000429361992
  error estimate for blocks of size 2^( 6) =       0.000432977770
  error estimate for blocks of size 2^( 7) =       0.000433216160

      target function =                  N/A
              le_mean =     -17.217112581731
             les_mean =     296.746781952375
             stat err =       0.000429829446
             autocorr =       1.162641814515
              std dev =       0.563752125742
             le_variance =       0.317816459278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217112581731        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -17.217112581731
     9.5367e+19     9.5367e+20             0.0000e+00       -17.217112581731
     3.8147e+20     3.8147e+21             0.0000e+00       -17.217112581731

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1825
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5552e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.280867
====================================================
  Execution time = 3.3994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318211367598
                                         uncertainty =       0.003147789208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318211367598
                                         uncertainty =       0.003147789208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398857183
  error estimate for blocks of size 2^( 2) =       0.000408284818
  error estimate for blocks of size 2^( 3) =       0.000416632828
  error estimate for blocks of size 2^( 4) =       0.000423304458
  error estimate for blocks of size 2^( 5) =       0.000427217459
  error estimate for blocks of size 2^( 6) =       0.000430236488
  error estimate for blocks of size 2^( 7) =       0.000428843899

      target function =                  N/A
              le_mean =     -17.216492591005
             les_mean =     296.725791081719
             stat err =       0.000427400576
             autocorr =       1.148247136122
              std dev =       0.564069237486
             le_variance =       0.318174104678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649259100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492591005       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3354e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1128
    reference variance = 0.176046
====================================================
  Execution time = 3.4364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1984e-01
  Total weights = 2.0000e+06
  Execution time = 3.1095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399897818
  error estimate for blocks of size 2^( 2) =       0.000409718251
  error estimate for blocks of size 2^( 3) =       0.000417860548
  error estimate for blocks of size 2^( 4) =       0.000423673402
  error estimate for blocks of size 2^( 5) =       0.000427959630
  error estimate for blocks of size 2^( 6) =       0.000430800574
  error estimate for blocks of size 2^( 7) =       0.000431287745

      target function =                  N/A
              le_mean =     -17.216115192893
             les_mean =     296.714458704290
             stat err =       0.000428430338
             autocorr =       1.147789808727
              std dev =       0.565540917394
             le_variance =       0.319836529247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399897818
  error estimate for blocks of size 2^( 2) =       0.000409718251
  error estimate for blocks of size 2^( 3) =       0.000417860548
  error estimate for blocks of size 2^( 4) =       0.000423673402
  error estimate for blocks of size 2^( 5) =       0.000427959630
  error estimate for blocks of size 2^( 6) =       0.000430800574
  error estimate for blocks of size 2^( 7) =       0.000431287745

      target function =                  N/A
              le_mean =     -17.216115192893
             les_mean =     296.714458704290
             stat err =       0.000428430338
             autocorr =       1.147789808727
              std dev =       0.565540917394
             le_variance =       0.319836529247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399897818
  error estimate for blocks of size 2^( 2) =       0.000409718251
  error estimate for blocks of size 2^( 3) =       0.000417860548
  error estimate for blocks of size 2^( 4) =       0.000423673402
  error estimate for blocks of size 2^( 5) =       0.000427959630
  error estimate for blocks of size 2^( 6) =       0.000430800574
  error estimate for blocks of size 2^( 7) =       0.000431287745

      target function =                  N/A
              le_mean =     -17.216115192893
             les_mean =     296.714458704290
             stat err =       0.000428430338
             autocorr =       1.147789808727
              std dev =       0.565540917394
             le_variance =       0.319836529247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319787135709
                                         uncertainty =       0.003677984341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399897818
  error estimate for blocks of size 2^( 2) =       0.000409718251
  error estimate for blocks of size 2^( 3) =       0.000417860548
  error estimate for blocks of size 2^( 4) =       0.000423673402
  error estimate for blocks of size 2^( 5) =       0.000427959630
  error estimate for blocks of size 2^( 6) =       0.000430800574
  error estimate for blocks of size 2^( 7) =       0.000431287745

      target function =                  N/A
              le_mean =     -17.216115192893
             les_mean =     296.714458704290
             stat err =       0.000428430338
             autocorr =       1.147789808727
              std dev =       0.565540917394
             le_variance =       0.319836529247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216115192893        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -17.216115192893
     9.5367e+20     9.5367e+21             0.0000e+00       -17.216115192893
     3.8147e+21     3.8147e+22             0.0000e+00       -17.216115192893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9885
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2722
    reference variance = 0.41191
====================================================
  Execution time = 3.3710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331678952105
                                         uncertainty =       0.011989076075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331678952105
                                         uncertainty =       0.011989076075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407180305
  error estimate for blocks of size 2^( 2) =       0.000416989470
  error estimate for blocks of size 2^( 3) =       0.000425515077
  error estimate for blocks of size 2^( 4) =       0.000431697588
  error estimate for blocks of size 2^( 5) =       0.000434961141
  error estimate for blocks of size 2^( 6) =       0.000437373007
  error estimate for blocks of size 2^( 7) =       0.000436355457

      target function =                  N/A
              le_mean =     -17.217156255149
             les_mean =     296.762060950449
             stat err =       0.000435096799
             autocorr =       1.141821583665
              std dev =       0.575839910073
             le_variance =       0.331591602033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715625515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217156255149       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+21 is 1.825448e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217156255149       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 4.563621e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217156255149       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217156255149       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 1.140905e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3227e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.166989
====================================================
  Execution time = 3.4257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2352e-01
  Total weights = 2.0000e+06
  Execution time = 3.1475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402194122
  error estimate for blocks of size 2^( 2) =       0.000411829943
  error estimate for blocks of size 2^( 3) =       0.000420362312
  error estimate for blocks of size 2^( 4) =       0.000426568268
  error estimate for blocks of size 2^( 5) =       0.000429679772
  error estimate for blocks of size 2^( 6) =       0.000431512488
  error estimate for blocks of size 2^( 7) =       0.000431145013

      target function =                  N/A
              le_mean =     -17.216729066918
             les_mean =     296.739279825492
             stat err =       0.000429726385
             autocorr =       1.141596429578
              std dev =       0.568788382093
             le_variance =       0.323520223604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402194122
  error estimate for blocks of size 2^( 2) =       0.000411829943
  error estimate for blocks of size 2^( 3) =       0.000420362312
  error estimate for blocks of size 2^( 4) =       0.000426568268
  error estimate for blocks of size 2^( 5) =       0.000429679772
  error estimate for blocks of size 2^( 6) =       0.000431512488
  error estimate for blocks of size 2^( 7) =       0.000431145013

      target function =                  N/A
              le_mean =     -17.216729066918
             les_mean =     296.739279825492
             stat err =       0.000429726385
             autocorr =       1.141596429578
              std dev =       0.568788382093
             le_variance =       0.323520223604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402194122
  error estimate for blocks of size 2^( 2) =       0.000411829943
  error estimate for blocks of size 2^( 3) =       0.000420362312
  error estimate for blocks of size 2^( 4) =       0.000426568268
  error estimate for blocks of size 2^( 5) =       0.000429679772
  error estimate for blocks of size 2^( 6) =       0.000431512488
  error estimate for blocks of size 2^( 7) =       0.000431145013

      target function =                  N/A
              le_mean =     -17.216729066918
             les_mean =     296.739279825492
             stat err =       0.000429726385
             autocorr =       1.141596429578
              std dev =       0.568788382093
             le_variance =       0.323520223604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323571878518
                                         uncertainty =       0.004665900291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402194122
  error estimate for blocks of size 2^( 2) =       0.000411829943
  error estimate for blocks of size 2^( 3) =       0.000420362312
  error estimate for blocks of size 2^( 4) =       0.000426568268
  error estimate for blocks of size 2^( 5) =       0.000429679772
  error estimate for blocks of size 2^( 6) =       0.000431512488
  error estimate for blocks of size 2^( 7) =       0.000431145013

      target function =                  N/A
              le_mean =     -17.216729066918
             les_mean =     296.739279825492
             stat err =       0.000429726385
             autocorr =       1.141596429578
              std dev =       0.568788382093
             le_variance =       0.323520223604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216729066918        initial  <--
     2.3842e+21     2.3842e+22             1.8254e-26       -17.216729066918
     9.5367e+21     9.5367e+22             4.5636e-27       -17.216729066918
     3.8147e+22     3.8147e+23             1.1409e-27       -17.216729066918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.1126
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.237237
====================================================
  Execution time = 3.5774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2426e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0029e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166171527
                                         uncertainty =       0.005198249566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166171527
                                         uncertainty =       0.005198249566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402653316
  error estimate for blocks of size 2^( 2) =       0.000412145403
  error estimate for blocks of size 2^( 3) =       0.000420294321
  error estimate for blocks of size 2^( 4) =       0.000426487170
  error estimate for blocks of size 2^( 5) =       0.000430697211
  error estimate for blocks of size 2^( 6) =       0.000432423200
  error estimate for blocks of size 2^( 7) =       0.000430897470

      target function =                  N/A
              le_mean =     -17.217213386504
             les_mean =     296.756696019965
             stat err =       0.000430126263
             autocorr =       1.141114860992
              std dev =       0.569437780335
             le_variance =       0.324259385673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721338650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213386504       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5819e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.235187
====================================================
  Execution time = 3.3942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2568e-01
  Total weights = 2.0000e+06
  Execution time = 3.1460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403532165
  error estimate for blocks of size 2^( 2) =       0.000413030008
  error estimate for blocks of size 2^( 3) =       0.000421853353
  error estimate for blocks of size 2^( 4) =       0.000428043084
  error estimate for blocks of size 2^( 5) =       0.000431525115
  error estimate for blocks of size 2^( 6) =       0.000432782418
  error estimate for blocks of size 2^( 7) =       0.000432658976

      target function =                  N/A
              le_mean =     -17.217447894433
             les_mean =     296.766188250814
             stat err =       0.000431252398
             autocorr =       1.142106839148
              std dev =       0.570680660395
             le_variance =       0.325676416148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403532165
  error estimate for blocks of size 2^( 2) =       0.000413030008
  error estimate for blocks of size 2^( 3) =       0.000421853353
  error estimate for blocks of size 2^( 4) =       0.000428043084
  error estimate for blocks of size 2^( 5) =       0.000431525115
  error estimate for blocks of size 2^( 6) =       0.000432782418
  error estimate for blocks of size 2^( 7) =       0.000432658976

      target function =                  N/A
              le_mean =     -17.217447894433
             les_mean =     296.766188250814
             stat err =       0.000431252398
             autocorr =       1.142106839148
              std dev =       0.570680660395
             le_variance =       0.325676416148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403532165
  error estimate for blocks of size 2^( 2) =       0.000413030008
  error estimate for blocks of size 2^( 3) =       0.000421853353
  error estimate for blocks of size 2^( 4) =       0.000428043084
  error estimate for blocks of size 2^( 5) =       0.000431525115
  error estimate for blocks of size 2^( 6) =       0.000432782418
  error estimate for blocks of size 2^( 7) =       0.000432658976

      target function =                  N/A
              le_mean =     -17.217447894433
             les_mean =     296.766188250814
             stat err =       0.000431252398
             autocorr =       1.142106839148
              std dev =       0.570680660395
             le_variance =       0.325676416148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325635348073
                                         uncertainty =       0.003660712473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403532165
  error estimate for blocks of size 2^( 2) =       0.000413030008
  error estimate for blocks of size 2^( 3) =       0.000421853353
  error estimate for blocks of size 2^( 4) =       0.000428043084
  error estimate for blocks of size 2^( 5) =       0.000431525115
  error estimate for blocks of size 2^( 6) =       0.000432782418
  error estimate for blocks of size 2^( 7) =       0.000432658976

      target function =                  N/A
              le_mean =     -17.217447894433
             les_mean =     296.766188250814
             stat err =       0.000431252398
             autocorr =       1.142106839148
              std dev =       0.570680660395
             le_variance =       0.325676416148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217447894433        initial  <--
     2.3842e+22     2.3842e+23             0.0000e+00       -17.217447894433
     9.5367e+22     9.5367e+23             0.0000e+00       -17.217447894433
     3.8147e+23     3.8147e+24             0.0000e+00       -17.217447894433

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.8174
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.927901e-01 1 1  ON 0
 uu_1                 2.954693e-02 1 1  ON 1
 uu_2                -6.698699e-02 1 1  ON 2
 uu_3                -1.243958e-01 1 1  ON 3
 uu_4                -1.612482e-01 1 1  ON 4
 uu_5                -1.735663e-01 1 1  ON 5
 uu_6                -1.613331e-01 1 1  ON 6
 uu_7                -1.145704e-01 1 1  ON 7
 uu_8                -3.689552e-02 1 1  ON 8
 uu_9                 1.610331e-01 1 1  ON 9
 ud_0                 3.518000e-01 1 1  ON 10
 ud_1                 9.234139e-02 1 1  ON 11
 ud_2                -1.917804e-02 1 1  ON 12
 ud_3                -8.226424e-02 1 1  ON 13
 ud_4                -1.322984e-01 1 1  ON 14
 ud_5                -1.683489e-01 1 1  ON 15
 ud_6                -1.802928e-01 1 1  ON 16
 ud_7                -1.600044e-01 1 1  ON 17
 ud_8                -1.008712e-01 1 1  ON 18
 ud_9                -8.567377e-03 1 1  ON 19
 eO_0                -9.329808e-01 1 1  ON 20
 eO_1                -6.074453e-01 1 1  ON 21
 eO_2                -1.878994e-01 1 1  ON 22
 eO_3                 8.603082e-02 1 1  ON 23
 eO_4                 2.112035e-01 1 1  ON 24
 eO_5                 2.944679e-01 1 1  ON 25
 eO_6                 3.330779e-01 1 1  ON 26
 eO_7                 5.012839e-01 1 1  ON 27
 eO_8                 1.949060e-01 1 1  ON 28
 eO_9                 6.148508e-02 1 1  ON 29
eH1_0                -2.117101e-01 1 1  ON 30
eH1_1                -1.328595e-01 1 1  ON 31
eH1_2                -9.091963e-02 1 1  ON 32
eH1_3                -5.306670e-02 1 1  ON 33
eH1_4                -7.765617e-03 1 1  ON 34
eH1_5                 4.304383e-03 1 1  ON 35
eH1_6                 4.139257e-02 1 1  ON 36
eH1_7                 6.335434e-02 1 1  ON 37
eH1_8                 1.796762e-01 1 1  ON 38
eH1_9                 1.211088e-01 1 1  ON 39
eH2_0                -2.075247e-01 1 1  ON 40
eH2_1                -1.284193e-01 1 1  ON 41
eH2_2                -8.644424e-02 1 1  ON 42
eH2_3                -4.862326e-02 1 1  ON 43
eH2_4                -2.657964e-03 1 1  ON 44
eH2_5                 8.872568e-03 1 1  ON 45
eH2_6                 4.725116e-02 1 1  ON 46
eH2_7                 4.685506e-02 1 1  ON 47
eH2_8                 1.973195e-01 1 1  ON 48
eH2_9                 1.203301e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5803e+01 secs
  Total Execution time = 3.7649e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
