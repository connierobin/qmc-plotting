Rank =    0  Free Memory = 87951 MB
Rank =    1  Free Memory = 87951 MB
Rank =    2  Free Memory = 87950 MB
Rank =    3  Free Memory = 87950 MB
Rank =    4  Free Memory = 87950 MB
Rank =    5  Free Memory = 87950 MB
Rank =    6  Free Memory = 87949 MB
Rank =    7  Free Memory = 87949 MB
Rank =    8  Free Memory = 87949 MB
Rank =    9  Free Memory = 87949 MB
Rank =   10  Free Memory = 87949 MB
Rank =   11  Free Memory = 87949 MB
Rank =   12  Free Memory = 87949 MB
Rank =   13  Free Memory = 87949 MB
Rank =   14  Free Memory = 87948 MB
Rank =   15  Free Memory = 87934 MB
Rank =   16  Free Memory = 87934 MB
Rank =   17  Free Memory = 87934 MB
Rank =   18  Free Memory = 87934 MB
Rank =   19  Free Memory = 87934 MB
Rank =   20  Free Memory = 87934 MB
Rank =   21  Free Memory = 87934 MB
Rank =   22  Free Memory = 87934 MB
Rank =   23  Free Memory = 87934 MB
Rank =   24  Free Memory = 87934 MB
Rank =   25  Free Memory = 87934 MB
Rank =   26  Free Memory = 87934 MB
Rank =   27  Free Memory = 87934 MB
Rank =   28  Free Memory = 87934 MB
Rank =   29  Free Memory = 87934 MB
Rank =   30  Free Memory = 87934 MB
Rank =   31  Free Memory = 87934 MB
Rank =   32  Free Memory = 88189 MB
Rank =   33  Free Memory = 88189 MB
Rank =   34  Free Memory = 88189 MB
Rank =   35  Free Memory = 88189 MB
Rank =   36  Free Memory = 88189 MB
Rank =   37  Free Memory = 88188 MB
Rank =   38  Free Memory = 88188 MB
Rank =   39  Free Memory = 88188 MB
Rank =   40  Free Memory = 88188 MB
Rank =   41  Free Memory = 88188 MB
Rank =   42  Free Memory = 88188 MB
Rank =   43  Free Memory = 88188 MB
Rank =   44  Free Memory = 88188 MB
Rank =   45  Free Memory = 88188 MB
Rank =   46  Free Memory = 88188 MB
Rank =   47  Free Memory = 88188 MB
Rank =   48  Free Memory = 88188 MB
Rank =   49  Free Memory = 88187 MB
Rank =   50  Free Memory = 88187 MB
Rank =   51  Free Memory = 88187 MB
Rank =   52  Free Memory = 88187 MB
Rank =   53  Free Memory = 88187 MB
Rank =   54  Free Memory = 88187 MB
Rank =   55  Free Memory = 88187 MB
Rank =   56  Free Memory = 88187 MB
Rank =   57  Free Memory = 88187 MB
Rank =   58  Free Memory = 88187 MB
Rank =   59  Free Memory = 88187 MB
Rank =   60  Free Memory = 88187 MB
Rank =   61  Free Memory = 88187 MB
Rank =   62  Free Memory = 88187 MB
Rank =   63  Free Memory = 88187 MB
Rank =   64  Free Memory = 87324 MB
Rank =   65  Free Memory = 87324 MB
Rank =   66  Free Memory = 87324 MB
Rank =   67  Free Memory = 87324 MB
Rank =   68  Free Memory = 87324 MB
Rank =   69  Free Memory = 87324 MB
Rank =   70  Free Memory = 87324 MB
Rank =   71  Free Memory = 87324 MB
Rank =   72  Free Memory = 87324 MB
Rank =   73  Free Memory = 87324 MB
Rank =   74  Free Memory = 87324 MB
Rank =   75  Free Memory = 87324 MB
Rank =   76  Free Memory = 87324 MB
Rank =   77  Free Memory = 87324 MB
Rank =   78  Free Memory = 87324 MB
Rank =   79  Free Memory = 87324 MB
Rank =   80  Free Memory = 87324 MB
Rank =   81  Free Memory = 87324 MB
Rank =   82  Free Memory = 87324 MB
Rank =   83  Free Memory = 87324 MB
Rank =   84  Free Memory = 87324 MB
Rank =   85  Free Memory = 87324 MB
Rank =   86  Free Memory = 87324 MB
Rank =   87  Free Memory = 87324 MB
Rank =   88  Free Memory = 87324 MB
Rank =   89  Free Memory = 87324 MB
Rank =   90  Free Memory = 87324 MB
Rank =   91  Free Memory = 87324 MB
Rank =   92  Free Memory = 87324 MB
Rank =   93  Free Memory = 87324 MB
Rank =   94  Free Memory = 87324 MB
Rank =   95  Free Memory = 87324 MB
Rank =   96  Free Memory = 87986 MB
Rank =   97  Free Memory = 87986 MB
Rank =   98  Free Memory = 87986 MB
Rank =   99  Free Memory = 87986 MB
Rank =  100  Free Memory = 87986 MB
Rank =  101  Free Memory = 87986 MB
Rank =  102  Free Memory = 87986 MB
Rank =  103  Free Memory = 87986 MB
Rank =  104  Free Memory = 87986 MB
Rank =  105  Free Memory = 87986 MB
Rank =  106  Free Memory = 87986 MB
Rank =  107  Free Memory = 87986 MB
Rank =  108  Free Memory = 87986 MB
Rank =  109  Free Memory = 87986 MB
Rank =  110  Free Memory = 87986 MB
Rank =  111  Free Memory = 87986 MB
Rank =  112  Free Memory = 87986 MB
Rank =  113  Free Memory = 87986 MB
Rank =  114  Free Memory = 87986 MB
Rank =  115  Free Memory = 87986 MB
Rank =  116  Free Memory = 87986 MB
Rank =  117  Free Memory = 87986 MB
Rank =  118  Free Memory = 87986 MB
Rank =  119  Free Memory = 87986 MB
Rank =  120  Free Memory = 87986 MB
Rank =  121  Free Memory = 87986 MB
Rank =  122  Free Memory = 87986 MB
Rank =  123  Free Memory = 87986 MB
Rank =  124  Free Memory = 87986 MB
Rank =  125  Free Memory = 87986 MB
Rank =  126  Free Memory = 87986 MB
Rank =  127  Free Memory = 87986 MB
  Input file(s): opt_h2o_gs_gvpabs_run001j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001j.xml

  Project = H2O
  date    = 2023-04-02 10:35:49 PDT
  host    = n0050.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 245

  Range of prime numbers to use as seeds over processors and threads = 1567-2557


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.139838e-01    1         1  ON     0
     uu_1                 5.161576e-02    1         1  ON     1
     uu_2                -4.322282e-02    1         1  ON     2
     uu_3                -9.894209e-02    1         1  ON     3
     uu_4                -1.336901e-01    1         1  ON     4
     uu_5                -1.420466e-01    1         1  ON     5
     uu_6                -1.192323e-01    1         1  ON     6
     uu_7                -4.820395e-02    1         1  ON     7
     uu_8                 9.350219e-02    1         1  ON     8
     uu_9                 1.266982e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.555341e-01    1         1  ON     0
     ud_1                 9.663141e-02    1         1  ON     1
     ud_2                -1.382622e-02    1         1  ON     2
     ud_3                -7.541758e-02    1         1  ON     3
     ud_4                -1.235462e-01    1         1  ON     4
     ud_5                -1.555396e-01    1         1  ON     5
     ud_6                -1.570129e-01    1         1  ON     6
     ud_7                -1.128658e-01    1         1  ON     7
     ud_8                -4.903523e-03    1         1  ON     8
     ud_9                 9.265698e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.839991e-01    1         1  ON     0
     eO_1                -4.623314e-01    1         1  ON     1
     eO_2                -5.035171e-02    1         1  ON     2
     eO_3                 2.109431e-01    1         1  ON     3
     eO_4                 3.116683e-01    1         1  ON     4
     eO_5                 3.267629e-01    1         1  ON     5
     eO_6                 2.625848e-01    1         1  ON     6
     eO_7                 1.244874e-01    1         1  ON     7
     eO_8                 2.991524e-02    1         1  ON     8
     eO_9                 1.907788e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.844666e-01    1         1  ON     0
     eH1_1                -1.050123e-01    1         1  ON     1
     eH1_2                -6.355517e-02    1         1  ON     2
     eH1_3                -2.637151e-02    1         1  ON     3
     eH1_4                 1.894519e-02    1         1  ON     4
     eH1_5                 3.312163e-02    1         1  ON     5
     eH1_6                 7.757990e-02    1         1  ON     6
     eH1_7                 1.097468e-01    1         1  ON     7
     eH1_8                 9.753129e-02    1         1  ON     8
     eH1_9                 2.646936e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.856684e-01    1         1  ON     0
     eH2_1                -1.065185e-01    1         1  ON     1
     eH2_2                -6.500339e-02    1         1  ON     2
     eH2_3                -2.791096e-02    1         1  ON     3
     eH2_4                 1.767064e-02    1         1  ON     4
     eH2_5                 3.164242e-02    1         1  ON     5
     eH2_6                 7.927520e-02    1         1  ON     6
     eH2_7                 1.142069e-01    1         1  ON     7
     eH2_8                 1.007142e-01    1         1  ON     8
     eH2_9                 2.872899e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.698259e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.0565e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.283474
====================================================
  Execution time = 2.2882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1712e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317196566441
                                         uncertainty =       0.003739894031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317196566441
                                         uncertainty =       0.003739894031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398196054
  error estimate for blocks of size 2^( 2) =       0.000407908269
  error estimate for blocks of size 2^( 3) =       0.000417236856
  error estimate for blocks of size 2^( 4) =       0.000423586505
  error estimate for blocks of size 2^( 5) =       0.000428054957
  error estimate for blocks of size 2^( 6) =       0.000429186501
  error estimate for blocks of size 2^( 7) =       0.000430168525

      target function =                  N/A
              le_mean =     -17.217060723231
             les_mean =     296.744299984210
             stat err =       0.000427749122
             autocorr =       1.153942977575
              std dev =       0.563134260510
             le_variance =       0.317120195360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721706072323e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060723231       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061087823       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061566896       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217062347697       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217062389302       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217063170365       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217062635448       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217062791775       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217062884412       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217062693443       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.450592e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060723231       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217060865225       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061007586       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061454549       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061409435       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061604916       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061543990       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061626395       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.375500e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060723231       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217060764482       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217060803870       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217060951651       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217060935904       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217060978505       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217060983144       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061003186       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.178936e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8507e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.139805e-01                 1 1 ON  0
uu_1  5.176208e-02                 1 1 ON  1
uu_2  -4.329956e-02                1 1 ON  2
uu_3  -9.906093e-02                1 1 ON  3
uu_4  -1.336343e-01                1 1 ON  4
uu_5  -1.420082e-01                1 1 ON  5
uu_6  -1.192813e-01                1 1 ON  6
uu_7  -4.830807e-02                1 1 ON  7
uu_8  9.339667e-02                 1 1 ON  8
uu_9  1.267665e-01                 1 1 ON  9
ud_0  3.556024e-01                 1 1 ON  10
ud_1  9.664842e-02                 1 1 ON  11
ud_2  -1.385574e-02                1 1 ON  12
ud_3  -7.541731e-02                1 1 ON  13
ud_4  -1.236280e-01                1 1 ON  14
ud_5  -1.555226e-01                1 1 ON  15
ud_6  -1.570785e-01                1 1 ON  16
ud_7  -1.128700e-01                1 1 ON  17
ud_8  -4.990024e-03                1 1 ON  18
ud_9  9.267451e-02                 1 1 ON  19
eO_0  -7.844367e-01                1 1 ON  20
eO_1  -4.625015e-01                1 1 ON  21
eO_2  -5.035086e-02                1 1 ON  22
eO_3  2.109896e-01                 1 1 ON  23
eO_4  3.117496e-01                 1 1 ON  24
eO_5  3.269169e-01                 1 1 ON  25
eO_6  2.627270e-01                 1 1 ON  26
eO_7  1.246147e-01                 1 1 ON  27
eO_8  2.992866e-02                 1 1 ON  28
eO_9  1.909174e-02                 1 1 ON  29
eH1_0 -1.845505e-01                1 1 ON  30
eH1_1 -1.050207e-01                1 1 ON  31
eH1_2 -6.351672e-02                1 1 ON  32
eH1_3 -2.637542e-02                1 1 ON  33
eH1_4 1.892958e-02                 1 1 ON  34
eH1_5 3.310226e-02                 1 1 ON  35
eH1_6 7.754838e-02                 1 1 ON  36
eH1_7 1.097525e-01                 1 1 ON  37
eH1_8 9.760148e-02                 1 1 ON  38
eH1_9 2.649563e-02                 1 1 ON  39
eH2_0 -1.856663e-01                1 1 ON  40
eH2_1 -1.065195e-01                1 1 ON  41
eH2_2 -6.504144e-02                1 1 ON  42
eH2_3 -2.787843e-02                1 1 ON  43
eH2_4 1.764025e-02                 1 1 ON  44
eH2_5 3.159985e-02                 1 1 ON  45
eH2_6 7.922276e-02                 1 1 ON  46
eH2_7 1.142182e-01                 1 1 ON  47
eH2_8 1.007864e-01                 1 1 ON  48
eH2_9 2.875341e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.234216
====================================================
  Execution time = 1.9668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1879e-01
  Total weights = 2.0000e+06
  Execution time = 1.8438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647956234
                                         uncertainty =       0.007879195203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647956234
                                         uncertainty =       0.007879195203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399154664
  error estimate for blocks of size 2^( 2) =       0.000408927697
  error estimate for blocks of size 2^( 3) =       0.000417651345
  error estimate for blocks of size 2^( 4) =       0.000424729252
  error estimate for blocks of size 2^( 5) =       0.000428406879
  error estimate for blocks of size 2^( 6) =       0.000431861231
  error estimate for blocks of size 2^( 7) =       0.000433593031

      target function =                  N/A
              le_mean =     -17.217074555254
             les_mean =     296.746304973644
             stat err =       0.000429647598
             autocorr =       1.158623570330
              std dev =       0.564489939497
             le_variance =       0.318648891794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020682593
                                         uncertainty =       0.007891539002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319020682593
                                         uncertainty =       0.007891539002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399388038
  error estimate for blocks of size 2^( 2) =       0.000409150073
  error estimate for blocks of size 2^( 3) =       0.000417860198
  error estimate for blocks of size 2^( 4) =       0.000424931373
  error estimate for blocks of size 2^( 5) =       0.000428602492
  error estimate for blocks of size 2^( 6) =       0.000432052008
  error estimate for blocks of size 2^( 7) =       0.000433789534

      target function =                  N/A
              le_mean =     -17.217071469160
             les_mean =     296.746571424894
             stat err =       0.000429843852
             autocorr =       1.158327403419
              std dev =       0.564819980370
             le_variance =       0.319021610225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318940878307
                                         uncertainty =       0.007889004728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318940878307
                                         uncertainty =       0.007889004728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338084
  error estimate for blocks of size 2^( 2) =       0.000409102023
  error estimate for blocks of size 2^( 3) =       0.000417814923
  error estimate for blocks of size 2^( 4) =       0.000424887406
  error estimate for blocks of size 2^( 5) =       0.000428560004
  error estimate for blocks of size 2^( 6) =       0.000432009725
  error estimate for blocks of size 2^( 7) =       0.000433748845

      target function =                  N/A
              le_mean =     -17.217071426873
             les_mean =     296.746490168972
             stat err =       0.000429801495
             autocorr =       1.158388892273
              std dev =       0.564749334142
             le_variance =       0.318941810414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318691632816
                                         uncertainty =       0.007880800402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318691632816
                                         uncertainty =       0.007880800402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399182018
  error estimate for blocks of size 2^( 2) =       0.000408953596
  error estimate for blocks of size 2^( 3) =       0.000417675562
  error estimate for blocks of size 2^( 4) =       0.000424752632
  error estimate for blocks of size 2^( 5) =       0.000428429537
  error estimate for blocks of size 2^( 6) =       0.000431883072
  error estimate for blocks of size 2^( 7) =       0.000433616156

      target function =                  N/A
              le_mean =     -17.217073950270
             les_mean =     296.746327816724
             stat err =       0.000429670349
             autocorr =       1.158587478940
              std dev =       0.564528623711
             le_variance =       0.318692566989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217074555254        initial  <--
     2.5000e-01     2.5000e+00             1.4506e-03       -17.217071469160
     1.0000e+00     1.0000e+01             4.3755e-04       -17.217071426873
     4.0000e+00     4.0000e+01             1.1789e-04       -17.217073950270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9422
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.310338
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313920950694
                                         uncertainty =       0.002858324107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313920950694
                                         uncertainty =       0.002858324107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396174436
  error estimate for blocks of size 2^( 2) =       0.000406076353
  error estimate for blocks of size 2^( 3) =       0.000414764783
  error estimate for blocks of size 2^( 4) =       0.000421793207
  error estimate for blocks of size 2^( 5) =       0.000425575495
  error estimate for blocks of size 2^( 6) =       0.000428277972
  error estimate for blocks of size 2^( 7) =       0.000430214018

      target function =                  N/A
              le_mean =     -17.216584905741
             les_mean =     296.724704027510
             stat err =       0.000426465173
             autocorr =       1.158761999019
              std dev =       0.560275260800
             le_variance =       0.313908367864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658490574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584905741       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584986503       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584955867       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584885810       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216584831930       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216584860300       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216584839121       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216584850757       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.557854e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584905741       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584927887       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584920266       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584902327       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216584889098       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216584894453       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216584887392       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216584889853       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.000159e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584905741       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584911415       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584909516       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584905008       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216584901736       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216584902974       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216584901054       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216584901623       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.007332e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5564e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.140009e-01 1 1  ON 0
 uu_1                 5.163778e-02 1 1  ON 1
 uu_2                -4.323524e-02 1 1  ON 2
 uu_3                -9.894982e-02 1 1  ON 3
 uu_4                -1.336846e-01 1 1  ON 4
 uu_5                -1.420476e-01 1 1  ON 5
 uu_6                -1.192436e-01 1 1  ON 6
 uu_7                -4.821543e-02 1 1  ON 7
 uu_8                 9.349279e-02 1 1  ON 8
 uu_9                 1.267024e-01 1 1  ON 9
 ud_0                 3.555325e-01 1 1  ON 10
 ud_1                 9.664605e-02 1 1  ON 11
 ud_2                -1.382428e-02 1 1  ON 12
 ud_3                -7.541999e-02 1 1  ON 13
 ud_4                -1.235419e-01 1 1  ON 14
 ud_5                -1.555338e-01 1 1  ON 15
 ud_6                -1.570245e-01 1 1  ON 16
 ud_7                -1.128689e-01 1 1  ON 17
 ud_8                -4.914145e-03 1 1  ON 18
 ud_9                 9.265597e-02 1 1  ON 19
 eO_0                -7.840391e-01 1 1  ON 20
 eO_1                -4.623549e-01 1 1  ON 21
 eO_2                -5.034234e-02 1 1  ON 22
 eO_3                 2.109474e-01 1 1  ON 23
 eO_4                 3.116790e-01 1 1  ON 24
 eO_5                 3.267753e-01 1 1  ON 25
 eO_6                 2.625971e-01 1 1  ON 26
 eO_7                 1.244993e-01 1 1  ON 27
 eO_8                 2.991688e-02 1 1  ON 28
 eO_9                 1.907866e-02 1 1  ON 29
eH1_0                -1.844669e-01 1 1  ON 30
eH1_1                -1.050077e-01 1 1  ON 31
eH1_2                -6.355559e-02 1 1  ON 32
eH1_3                -2.636476e-02 1 1  ON 33
eH1_4                 1.894345e-02 1 1  ON 34
eH1_5                 3.311442e-02 1 1  ON 35
eH1_6                 7.757687e-02 1 1  ON 36
eH1_7                 1.097425e-01 1 1  ON 37
eH1_8                 9.753562e-02 1 1  ON 38
eH1_9                 2.647076e-02 1 1  ON 39
eH2_0                -1.856680e-01 1 1  ON 40
eH2_1                -1.065208e-01 1 1  ON 41
eH2_2                -6.500712e-02 1 1  ON 42
eH2_3                -2.790608e-02 1 1  ON 43
eH2_4                 1.767203e-02 1 1  ON 44
eH2_5                 3.163589e-02 1 1  ON 45
eH2_6                 7.927009e-02 1 1  ON 46
eH2_7                 1.142074e-01 1 1  ON 47
eH2_8                 1.007222e-01 1 1  ON 48
eH2_9                 2.873124e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2688
    reference variance = 0.22603
====================================================
  Execution time = 2.0276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2207e-01
  Total weights = 2.0000e+06
  Execution time = 1.8569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114251206
                                         uncertainty =       0.004584447671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114251206
                                         uncertainty =       0.004584447671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401290474
  error estimate for blocks of size 2^( 2) =       0.000411203961
  error estimate for blocks of size 2^( 3) =       0.000420028093
  error estimate for blocks of size 2^( 4) =       0.000426185335
  error estimate for blocks of size 2^( 5) =       0.000429475794
  error estimate for blocks of size 2^( 6) =       0.000430986679
  error estimate for blocks of size 2^( 7) =       0.000431299109

      target function =                  N/A
              le_mean =     -17.216013372547
             les_mean =     296.713184372339
             stat err =       0.000429486729
             autocorr =       1.145464928928
              std dev =       0.567510431317
             le_variance =       0.322068089654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322139938250
                                         uncertainty =       0.004582742112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322139938250
                                         uncertainty =       0.004582742112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401306494
  error estimate for blocks of size 2^( 2) =       0.000411219018
  error estimate for blocks of size 2^( 3) =       0.000420041918
  error estimate for blocks of size 2^( 4) =       0.000426197949
  error estimate for blocks of size 2^( 5) =       0.000429486901
  error estimate for blocks of size 2^( 6) =       0.000430996951
  error estimate for blocks of size 2^( 7) =       0.000431310807

      target function =                  N/A
              le_mean =     -17.216013174927
             les_mean =     296.713203283043
             stat err =       0.000429498152
             autocorr =       1.145434401980
              std dev =       0.567533086982
             le_variance =       0.322093804819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322125620620
                                         uncertainty =       0.004583461172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322125620620
                                         uncertainty =       0.004583461172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401297567
  error estimate for blocks of size 2^( 2) =       0.000411210599
  error estimate for blocks of size 2^( 3) =       0.000420034126
  error estimate for blocks of size 2^( 4) =       0.000426190723
  error estimate for blocks of size 2^( 5) =       0.000429480373
  error estimate for blocks of size 2^( 6) =       0.000430990721
  error estimate for blocks of size 2^( 7) =       0.000431304020

      target function =                  N/A
              le_mean =     -17.216013266624
             les_mean =     296.713192110376
             stat err =       0.000429491459
             autocorr =       1.145449667552
              std dev =       0.567520462050
             le_variance =       0.322079474846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322115603719
                                         uncertainty =       0.004584319293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322115603719
                                         uncertainty =       0.004584319293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401291318
  error estimate for blocks of size 2^( 2) =       0.000411204749
  error estimate for blocks of size 2^( 3) =       0.000420028805
  error estimate for blocks of size 2^( 4) =       0.000426185966
  error estimate for blocks of size 2^( 5) =       0.000429476321
  error estimate for blocks of size 2^( 6) =       0.000430987135
  error estimate for blocks of size 2^( 7) =       0.000431299679

      target function =                  N/A
              le_mean =     -17.216013358128
             les_mean =     296.713185230416
             stat err =       0.000429487275
             autocorr =       1.145463023774
              std dev =       0.567511624727
             le_variance =       0.322069444201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216013372547        initial  <--
     2.5000e+00     2.5000e+01             1.5579e-04       -17.216013174927
     1.0000e+01     1.0000e+02             4.0002e-05       -17.216013266624
     4.0000e+01     4.0000e+02             1.0073e-05       -17.216013358128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5957
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2576
    reference variance = 0.368987
====================================================
  Execution time = 1.9930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323990842750
                                         uncertainty =       0.004826742295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323990842750
                                         uncertainty =       0.004826742295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402449754
  error estimate for blocks of size 2^( 2) =       0.000412120999
  error estimate for blocks of size 2^( 3) =       0.000421207463
  error estimate for blocks of size 2^( 4) =       0.000426842822
  error estimate for blocks of size 2^( 5) =       0.000431394115
  error estimate for blocks of size 2^( 6) =       0.000432911488
  error estimate for blocks of size 2^( 7) =       0.000434989136

      target function =                  N/A
              le_mean =     -17.216572920701
             les_mean =     296.734314580467
             stat err =       0.000431534390
             autocorr =       1.149760782919
              std dev =       0.569149899948
             le_variance =       0.323931608610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657292070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572920701       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572988608       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216573049755       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216573058180       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216573058103       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216573065806       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216573061482       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216573061243       residual = 9.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.541072e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572920701       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572937786       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572953247       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216572955434       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216572955392       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216572957292       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216572956211       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216572956141       residual = 8.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.861692e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216572920701       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572924979       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572928856       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216572929407       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216572929396       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216572929869       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216572929599       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216572929580       residual = 8.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 9.659893e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5485e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.139857e-01 1 1  ON 0
 uu_1                 5.161797e-02 1 1  ON 1
 uu_2                -4.322447e-02 1 1  ON 2
 uu_3                -9.894268e-02 1 1  ON 3
 uu_4                -1.336907e-01 1 1  ON 4
 uu_5                -1.420465e-01 1 1  ON 5
 uu_6                -1.192333e-01 1 1  ON 6
 uu_7                -4.820515e-02 1 1  ON 7
 uu_8                 9.350165e-02 1 1  ON 8
 uu_9                 1.266989e-01 1 1  ON 9
 ud_0                 3.555347e-01 1 1  ON 10
 ud_1                 9.663200e-02 1 1  ON 11
 ud_2                -1.382606e-02 1 1  ON 12
 ud_3                -7.541753e-02 1 1  ON 13
 ud_4                -1.235466e-01 1 1  ON 14
 ud_5                -1.555387e-01 1 1  ON 15
 ud_6                -1.570138e-01 1 1  ON 16
 ud_7                -1.128667e-01 1 1  ON 17
 ud_8                -4.904408e-03 1 1  ON 18
 ud_9                 9.265714e-02 1 1  ON 19
 eO_0                -7.840030e-01 1 1  ON 20
 eO_1                -4.623333e-01 1 1  ON 21
 eO_2                -5.035103e-02 1 1  ON 22
 eO_3                 2.109420e-01 1 1  ON 23
 eO_4                 3.116702e-01 1 1  ON 24
 eO_5                 3.267646e-01 1 1  ON 25
 eO_6                 2.625857e-01 1 1  ON 26
 eO_7                 1.244886e-01 1 1  ON 27
 eO_8                 2.991549e-02 1 1  ON 28
 eO_9                 1.907797e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355454e-02 1 1  ON 32
eH1_3                -2.637144e-02 1 1  ON 33
eH1_4                 1.894430e-02 1 1  ON 34
eH1_5                 3.312164e-02 1 1  ON 35
eH1_6                 7.757970e-02 1 1  ON 36
eH1_7                 1.097463e-01 1 1  ON 37
eH1_8                 9.753193e-02 1 1  ON 38
eH1_9                 2.646963e-02 1 1  ON 39
eH2_0                -1.856687e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500317e-02 1 1  ON 42
eH2_3                -2.791135e-02 1 1  ON 43
eH2_4                 1.767092e-02 1 1  ON 44
eH2_5                 3.164255e-02 1 1  ON 45
eH2_6                 7.927448e-02 1 1  ON 46
eH2_7                 1.142067e-01 1 1  ON 47
eH2_8                 1.007148e-01 1 1  ON 48
eH2_9                 2.872916e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.0624
    reference variance = 0.403239
====================================================
  Execution time = 1.9597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1414e-01
  Total weights = 2.0000e+06
  Execution time = 1.8382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314183190678
                                         uncertainty =       0.002759277268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314183190678
                                         uncertainty =       0.002759277268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396318539
  error estimate for blocks of size 2^( 2) =       0.000405920249
  error estimate for blocks of size 2^( 3) =       0.000414583041
  error estimate for blocks of size 2^( 4) =       0.000420779579
  error estimate for blocks of size 2^( 5) =       0.000425812878
  error estimate for blocks of size 2^( 6) =       0.000427985448
  error estimate for blocks of size 2^( 7) =       0.000427003567

      target function =                  N/A
              le_mean =     -17.216219697349
             les_mean =     296.712357278546
             stat err =       0.000425395368
             autocorr =       1.152117404485
              std dev =       0.560479052444
             le_variance =       0.314136768229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314189296549
                                         uncertainty =       0.002759304027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314189296549
                                         uncertainty =       0.002759304027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396322390
  error estimate for blocks of size 2^( 2) =       0.000405923939
  error estimate for blocks of size 2^( 3) =       0.000414586606
  error estimate for blocks of size 2^( 4) =       0.000420783094
  error estimate for blocks of size 2^( 5) =       0.000425816387
  error estimate for blocks of size 2^( 6) =       0.000427988844
  error estimate for blocks of size 2^( 7) =       0.000427006844

      target function =                  N/A
              le_mean =     -17.216219696572
             les_mean =     296.712363357704
             stat err =       0.000425398792
             autocorr =       1.152113559001
              std dev =       0.560484499479
             le_variance =       0.314142874157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314186266154
                                         uncertainty =       0.002759290656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314186266154
                                         uncertainty =       0.002759290656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396320479
  error estimate for blocks of size 2^( 2) =       0.000405922107
  error estimate for blocks of size 2^( 3) =       0.000414584837
  error estimate for blocks of size 2^( 4) =       0.000420781350
  error estimate for blocks of size 2^( 5) =       0.000425814647
  error estimate for blocks of size 2^( 6) =       0.000427987160
  error estimate for blocks of size 2^( 7) =       0.000427005218

      target function =                  N/A
              le_mean =     -17.216219697019
             les_mean =     296.712360342674
             stat err =       0.000425397094
             autocorr =       1.152115473468
              std dev =       0.560481796059
             le_variance =       0.314139843714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314183575760
                                         uncertainty =       0.002759278941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314183575760
                                         uncertainty =       0.002759278941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396318782
  error estimate for blocks of size 2^( 2) =       0.000405920481
  error estimate for blocks of size 2^( 3) =       0.000414583266
  error estimate for blocks of size 2^( 4) =       0.000420779801
  error estimate for blocks of size 2^( 5) =       0.000425813100
  error estimate for blocks of size 2^( 6) =       0.000427985662
  error estimate for blocks of size 2^( 7) =       0.000427003774

      target function =                  N/A
              le_mean =     -17.216219697300
             les_mean =     296.712357661945
             stat err =       0.000425395584
             autocorr =       1.152117162819
              std dev =       0.560479395973
             le_variance =       0.314137153311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216219697349        initial  <--
     2.5000e+01     2.5000e+02             1.5411e-05       -17.216219696572
     1.0000e+02     1.0000e+03             3.8617e-06       -17.216219697019
     4.0000e+02     4.0000e+03             9.6599e-07       -17.216219697300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8607
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2202
    reference variance = 0.284481
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321004091058
                                         uncertainty =       0.004245452059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321004091058
                                         uncertainty =       0.004245452059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400793027
  error estimate for blocks of size 2^( 2) =       0.000410127533
  error estimate for blocks of size 2^( 3) =       0.000419063059
  error estimate for blocks of size 2^( 4) =       0.000424998343
  error estimate for blocks of size 2^( 5) =       0.000428505730
  error estimate for blocks of size 2^( 6) =       0.000431228323
  error estimate for blocks of size 2^( 7) =       0.000434391789

      target function =                  N/A
              le_mean =     -17.216253077927
             les_mean =     296.720639983559
             stat err =       0.000429781046
             autocorr =       1.149884456228
              std dev =       0.566806934484
             le_variance =       0.321270100979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625307793e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216253077927       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216253079144       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216253082708       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216253085457       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216253085512       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216253085845       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216253085869       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216253085808       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.620119e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216253077927       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216253078231       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216253079123       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216253079812       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216253079825       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216253079909       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216253079915       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216253079899       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 4.051246e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216253077927       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216253078003       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216253078226       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216253078398       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216253078401       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216253078421       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216253078424       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216253078416       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+03 is 1.012871e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5891e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.139839e-01 1 1  ON 0
 uu_1                 5.161596e-02 1 1  ON 1
 uu_2                -4.322301e-02 1 1  ON 2
 uu_3                -9.894218e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420467e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820405e-02 1 1  ON 7
 uu_8                 9.350214e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555343e-01 1 1  ON 10
 ud_1                 9.663153e-02 1 1  ON 11
 ud_2                -1.382626e-02 1 1  ON 12
 ud_3                -7.541761e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570130e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903613e-03 1 1  ON 18
 ud_9                 9.265697e-02 1 1  ON 19
 eO_0                -7.839995e-01 1 1  ON 20
 eO_1                -4.623317e-01 1 1  ON 21
 eO_2                -5.035162e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267630e-01 1 1  ON 25
 eO_6                 2.625849e-01 1 1  ON 26
 eO_7                 1.244875e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355523e-02 1 1  ON 32
eH1_3                -2.637148e-02 1 1  ON 33
eH1_4                 1.894522e-02 1 1  ON 34
eH1_5                 3.312153e-02 1 1  ON 35
eH1_6                 7.757987e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753138e-02 1 1  ON 38
eH1_9                 2.646938e-02 1 1  ON 39
eH2_0                -1.856683e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500338e-02 1 1  ON 42
eH2_3                -2.791100e-02 1 1  ON 43
eH2_4                 1.767065e-02 1 1  ON 44
eH2_5                 3.164241e-02 1 1  ON 45
eH2_6                 7.927511e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872901e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.458166
====================================================
  Execution time = 1.9681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1694e-01
  Total weights = 2.0000e+06
  Execution time = 1.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918099557
                                         uncertainty =       0.004840036966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918099557
                                         uncertainty =       0.004840036966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398085656
  error estimate for blocks of size 2^( 2) =       0.000407836472
  error estimate for blocks of size 2^( 3) =       0.000416746583
  error estimate for blocks of size 2^( 4) =       0.000422986642
  error estimate for blocks of size 2^( 5) =       0.000427982473
  error estimate for blocks of size 2^( 6) =       0.000429683119
  error estimate for blocks of size 2^( 7) =       0.000430707717

      target function =                  N/A
              le_mean =     -17.216686149725
             les_mean =     296.731226199468
             stat err =       0.000427839987
             autocorr =       1.155073675451
              std dev =       0.562978134393
             le_variance =       0.316944379805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316919286444
                                         uncertainty =       0.004840051371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316919286444
                                         uncertainty =       0.004840051371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398086402
  error estimate for blocks of size 2^( 2) =       0.000407837184
  error estimate for blocks of size 2^( 3) =       0.000416747263
  error estimate for blocks of size 2^( 4) =       0.000422987302
  error estimate for blocks of size 2^( 5) =       0.000427983115
  error estimate for blocks of size 2^( 6) =       0.000429683771
  error estimate for blocks of size 2^( 7) =       0.000430708365

      target function =                  N/A
              le_mean =     -17.216686145672
             les_mean =     296.731227246999
             stat err =       0.000427840638
             autocorr =       1.155072864197
              std dev =       0.562979188695
             le_variance =       0.316945566904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918693500
                                         uncertainty =       0.004840044176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918693500
                                         uncertainty =       0.004840044176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398086030
  error estimate for blocks of size 2^( 2) =       0.000407836828
  error estimate for blocks of size 2^( 3) =       0.000416746923
  error estimate for blocks of size 2^( 4) =       0.000422986972
  error estimate for blocks of size 2^( 5) =       0.000427982794
  error estimate for blocks of size 2^( 6) =       0.000429683445
  error estimate for blocks of size 2^( 7) =       0.000430708041

      target function =                  N/A
              le_mean =     -17.216686147695
             les_mean =     296.731226723621
             stat err =       0.000427840313
             autocorr =       1.155073269506
              std dev =       0.562978661988
             le_variance =       0.316944973854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918173814
                                         uncertainty =       0.004840037867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316918173814
                                         uncertainty =       0.004840037867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398085703
  error estimate for blocks of size 2^( 2) =       0.000407836517
  error estimate for blocks of size 2^( 3) =       0.000416746625
  error estimate for blocks of size 2^( 4) =       0.000422986683
  error estimate for blocks of size 2^( 5) =       0.000427982513
  error estimate for blocks of size 2^( 6) =       0.000429683160
  error estimate for blocks of size 2^( 7) =       0.000430707757

      target function =                  N/A
              le_mean =     -17.216686149471
             les_mean =     296.731226264995
             stat err =       0.000427840028
             autocorr =       1.155073624708
              std dev =       0.562978200356
             le_variance =       0.316944454076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216686149725        initial  <--
     2.5000e+02     2.5000e+03             1.6201e-06       -17.216686145672
     1.0000e+03     1.0000e+04             4.0512e-07       -17.216686147695
     4.0000e+03     4.0000e+04             1.0129e-07       -17.216686149471

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8648
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.300482
====================================================
  Execution time = 1.9978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1660e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316651936469
                                         uncertainty =       0.004486467214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316651936469
                                         uncertainty =       0.004486467214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397868894
  error estimate for blocks of size 2^( 2) =       0.000407195625
  error estimate for blocks of size 2^( 3) =       0.000415521255
  error estimate for blocks of size 2^( 4) =       0.000422800249
  error estimate for blocks of size 2^( 5) =       0.000425733445
  error estimate for blocks of size 2^( 6) =       0.000428075755
  error estimate for blocks of size 2^( 7) =       0.000430048020

      target function =                  N/A
              le_mean =     -17.217441566611
             les_mean =     296.756893255634
             stat err =       0.000426664367
             autocorr =       1.149986585570
              std dev =       0.562671586523
             le_variance =       0.316599314281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721744156661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217441566611       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217441567326       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217441567357       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217441567435       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217441567683       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217441567721       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217441567694       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.410011e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217441566611       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217441566789       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217441566797       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217441566817       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217441566879       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217441566889       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217441566884       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 3.525090e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217441566611       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217441566655       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217441566657       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217441566662       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217441566678       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217441566657       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217441566700       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+04 is 8.812764e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5509e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161578e-02 1 1  ON 1
 uu_2                -4.322284e-02 1 1  ON 2
 uu_3                -9.894211e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820396e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541757e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903532e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623315e-01 1 1  ON 21
 eO_2                -5.035170e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355516e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312162e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753130e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791095e-02 1 1  ON 43
eH2_4                 1.767063e-02 1 1  ON 44
eH2_5                 3.164241e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2713
    reference variance = 0.662349
====================================================
  Execution time = 1.9562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2258e-01
  Total weights = 2.0000e+06
  Execution time = 2.1198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695415173
                                         uncertainty =       0.003678563508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695415173
                                         uncertainty =       0.003678563508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401606662
  error estimate for blocks of size 2^( 2) =       0.000411421534
  error estimate for blocks of size 2^( 3) =       0.000419803296
  error estimate for blocks of size 2^( 4) =       0.000426360211
  error estimate for blocks of size 2^( 5) =       0.000430241740
  error estimate for blocks of size 2^( 6) =       0.000432817845
  error estimate for blocks of size 2^( 7) =       0.000433787074

      target function =                  N/A
              le_mean =     -17.216634738739
             les_mean =     296.735087388178
             stat err =       0.000430801717
             autocorr =       1.150675945870
              std dev =       0.567957588482
             le_variance =       0.322575822314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695489594
                                         uncertainty =       0.003678564663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695489594
                                         uncertainty =       0.003678564663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401606709
  error estimate for blocks of size 2^( 2) =       0.000411421578
  error estimate for blocks of size 2^( 3) =       0.000419803338
  error estimate for blocks of size 2^( 4) =       0.000426360252
  error estimate for blocks of size 2^( 5) =       0.000430241780
  error estimate for blocks of size 2^( 6) =       0.000432817884
  error estimate for blocks of size 2^( 7) =       0.000433787114

      target function =                  N/A
              le_mean =     -17.216634738888
             les_mean =     296.735087467713
             stat err =       0.000430801757
             autocorr =       1.150675894104
              std dev =       0.567957653973
             le_variance =       0.322575896707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695452387
                                         uncertainty =       0.003678564085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695452387
                                         uncertainty =       0.003678564085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401606685
  error estimate for blocks of size 2^( 2) =       0.000411421556
  error estimate for blocks of size 2^( 3) =       0.000419803317
  error estimate for blocks of size 2^( 4) =       0.000426360232
  error estimate for blocks of size 2^( 5) =       0.000430241760
  error estimate for blocks of size 2^( 6) =       0.000432817864
  error estimate for blocks of size 2^( 7) =       0.000433787094

      target function =                  N/A
              le_mean =     -17.216634738814
             les_mean =     296.735087427949
             stat err =       0.000430801737
             autocorr =       1.150675919985
              std dev =       0.567957621231
             le_variance =       0.322575859514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695419825
                                         uncertainty =       0.003678563580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322695419825
                                         uncertainty =       0.003678563580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401606665
  error estimate for blocks of size 2^( 2) =       0.000411421537
  error estimate for blocks of size 2^( 3) =       0.000419803298
  error estimate for blocks of size 2^( 4) =       0.000426360214
  error estimate for blocks of size 2^( 5) =       0.000430241743
  error estimate for blocks of size 2^( 6) =       0.000432817847
  error estimate for blocks of size 2^( 7) =       0.000433787076

      target function =                  N/A
              le_mean =     -17.216634738748
             les_mean =     296.735087393150
             stat err =       0.000430801720
             autocorr =       1.150675942627
              std dev =       0.567957592576
             le_variance =       0.322575826965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216634738739        initial
     2.5000e+03     2.5000e+04             1.4100e-07       -17.216634738888  <--
     1.0000e+04     1.0000e+05             3.5251e-08       -17.216634738814
     4.0000e+04     4.0000e+05             8.8128e-09       -17.216634738748

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 3.0416e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161583e-02 1 1  ON 1
 uu_2                -4.322289e-02 1 1  ON 2
 uu_3                -9.894215e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820397e-02 1 1  ON 7
 uu_8                 9.350217e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541756e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903560e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839992e-01 1 1  ON 20
 eO_1                -4.623315e-01 1 1  ON 21
 eO_2                -5.035167e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267630e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991525e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355516e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312160e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753132e-02 1 1  ON 38
eH1_9                 2.646937e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500336e-02 1 1  ON 42
eH2_3                -2.791094e-02 1 1  ON 43
eH2_4                 1.767063e-02 1 1  ON 44
eH2_5                 3.164240e-02 1 1  ON 45
eH2_6                 7.927518e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872900e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1809
    reference variance = 0.190425
====================================================
  Execution time = 2.0171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322061828865
                                         uncertainty =       0.003922327084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322061828865
                                         uncertainty =       0.003922327084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401223605
  error estimate for blocks of size 2^( 2) =       0.000410797841
  error estimate for blocks of size 2^( 3) =       0.000419049305
  error estimate for blocks of size 2^( 4) =       0.000425476170
  error estimate for blocks of size 2^( 5) =       0.000429592872
  error estimate for blocks of size 2^( 6) =       0.000432539661
  error estimate for blocks of size 2^( 7) =       0.000436906103

      target function =                  N/A
              le_mean =     -17.216309013549
             les_mean =     296.723256651835
             stat err =       0.000431128701
             autocorr =       1.154624902436
              std dev =       0.567415864065
             le_variance =       0.321960762793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630901355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309013549       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309014292       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309014025       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309013825       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309015785       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309015304       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309015018       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216309015219       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.133815e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309013549       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309013735       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309013668       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309013620       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309014109       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309013991       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309013918       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216309013967       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.283515e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309013549       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309013596       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309013579       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309013567       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309013701       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309013654       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309013640       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216309013644       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 3.208825e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5788e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139839e-01 1 1  ON 0
 uu_1                 5.161590e-02 1 1  ON 1
 uu_2                -4.322298e-02 1 1  ON 2
 uu_3                -9.894219e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820401e-02 1 1  ON 7
 uu_8                 9.350214e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555342e-01 1 1  ON 10
 ud_1                 9.663145e-02 1 1  ON 11
 ud_2                -1.382624e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570130e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903593e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839994e-01 1 1  ON 20
 eO_1                -4.623316e-01 1 1  ON 21
 eO_2                -5.035164e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116684e-01 1 1  ON 24
 eO_5                 3.267630e-01 1 1  ON 25
 eO_6                 2.625849e-01 1 1  ON 26
 eO_7                 1.244875e-01 1 1  ON 27
 eO_8                 2.991525e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355518e-02 1 1  ON 32
eH1_3                -2.637152e-02 1 1  ON 33
eH1_4                 1.894521e-02 1 1  ON 34
eH1_5                 3.312160e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753134e-02 1 1  ON 38
eH1_9                 2.646938e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791091e-02 1 1  ON 43
eH2_4                 1.767068e-02 1 1  ON 44
eH2_5                 3.164234e-02 1 1  ON 45
eH2_6                 7.927517e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872901e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.136205
====================================================
  Execution time = 2.1654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448263068
                                         uncertainty =       0.004417593562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448263068
                                         uncertainty =       0.004417593562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640484
  error estimate for blocks of size 2^( 2) =       0.000409587649
  error estimate for blocks of size 2^( 3) =       0.000418804567
  error estimate for blocks of size 2^( 4) =       0.000425705222
  error estimate for blocks of size 2^( 5) =       0.000429583515
  error estimate for blocks of size 2^( 6) =       0.000432890351
  error estimate for blocks of size 2^( 7) =       0.000431530385

      target function =                  N/A
              le_mean =     -17.217536262661
             les_mean =     296.762979829593
             stat err =       0.000429927368
             autocorr =       1.157314065397
              std dev =       0.565176992871
             le_variance =       0.319425033271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448891052
                                         uncertainty =       0.004417595962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448891052
                                         uncertainty =       0.004417595962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640877
  error estimate for blocks of size 2^( 2) =       0.000409588023
  error estimate for blocks of size 2^( 3) =       0.000418804925
  error estimate for blocks of size 2^( 4) =       0.000425705567
  error estimate for blocks of size 2^( 5) =       0.000429583865
  error estimate for blocks of size 2^( 6) =       0.000432890694
  error estimate for blocks of size 2^( 7) =       0.000431530716

      target function =                  N/A
              le_mean =     -17.217536266738
             les_mean =     296.762980598142
             stat err =       0.000429927710
             autocorr =       1.157313631573
              std dev =       0.565177548583
             le_variance =       0.319425661422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448577192
                                         uncertainty =       0.004417594761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448577192
                                         uncertainty =       0.004417594761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640681
  error estimate for blocks of size 2^( 2) =       0.000409587836
  error estimate for blocks of size 2^( 3) =       0.000418804746
  error estimate for blocks of size 2^( 4) =       0.000425705394
  error estimate for blocks of size 2^( 5) =       0.000429583690
  error estimate for blocks of size 2^( 6) =       0.000432890522
  error estimate for blocks of size 2^( 7) =       0.000431530551

      target function =                  N/A
              le_mean =     -17.217536264700
             les_mean =     296.762980214035
             stat err =       0.000429927539
             autocorr =       1.157313848387
              std dev =       0.565177270844
             le_variance =       0.319425347479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448302337
                                         uncertainty =       0.004417593712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448302337
                                         uncertainty =       0.004417593712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640509
  error estimate for blocks of size 2^( 2) =       0.000409587672
  error estimate for blocks of size 2^( 3) =       0.000418804590
  error estimate for blocks of size 2^( 4) =       0.000425705243
  error estimate for blocks of size 2^( 5) =       0.000429583537
  error estimate for blocks of size 2^( 6) =       0.000432890372
  error estimate for blocks of size 2^( 7) =       0.000431530406

      target function =                  N/A
              le_mean =     -17.217536262916
             les_mean =     296.762979877653
             stat err =       0.000429927390
             autocorr =       1.157314038273
              std dev =       0.565177027621
             le_variance =       0.319425072551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217536262661        initial
     6.2500e+02     6.2500e+03             5.1338e-07       -17.217536266738  <--
     2.5000e+03     2.5000e+04             1.2835e-07       -17.217536264700
     1.0000e+04     1.0000e+05             3.2088e-08       -17.217536262916

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 3.0845e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139842e-01 1 1  ON 0
 uu_1                 5.161612e-02 1 1  ON 1
 uu_2                -4.322326e-02 1 1  ON 2
 uu_3                -9.894230e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820413e-02 1 1  ON 7
 uu_8                 9.350204e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555345e-01 1 1  ON 10
 ud_1                 9.663154e-02 1 1  ON 11
 ud_2                -1.382628e-02 1 1  ON 12
 ud_3                -7.541763e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570131e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.903695e-03 1 1  ON 18
 ud_9                 9.265697e-02 1 1  ON 19
 eO_0                -7.839998e-01 1 1  ON 20
 eO_1                -4.623319e-01 1 1  ON 21
 eO_2                -5.035154e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116685e-01 1 1  ON 24
 eO_5                 3.267632e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244876e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637155e-02 1 1  ON 33
eH1_4                 1.894528e-02 1 1  ON 34
eH1_5                 3.312159e-02 1 1  ON 35
eH1_6                 7.757992e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753141e-02 1 1  ON 38
eH1_9                 2.646940e-02 1 1  ON 39
eH2_0                -1.856686e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500349e-02 1 1  ON 42
eH2_3                -2.791079e-02 1 1  ON 43
eH2_4                 1.767086e-02 1 1  ON 44
eH2_5                 3.164219e-02 1 1  ON 45
eH2_6                 7.927512e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872903e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.594513
====================================================
  Execution time = 2.0088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1530e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315378709476
                                         uncertainty =       0.005901391966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315378709476
                                         uncertainty =       0.005901391966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397049261
  error estimate for blocks of size 2^( 2) =       0.000406507608
  error estimate for blocks of size 2^( 3) =       0.000414980992
  error estimate for blocks of size 2^( 4) =       0.000421554753
  error estimate for blocks of size 2^( 5) =       0.000426201804
  error estimate for blocks of size 2^( 6) =       0.000426921503
  error estimate for blocks of size 2^( 7) =       0.000427966080

      target function =                  N/A
              le_mean =     -17.216261541206
             les_mean =     296.714957529219
             stat err =       0.000425661035
             autocorr =       1.149314824628
              std dev =       0.561512450146
             le_variance =       0.315296231669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626154121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216261541206       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216261544342       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216261546943       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216261550239       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216261558099       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216261556891       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216261556998       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216261557839       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.453158e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216261541206       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216261541991       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216261542643       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216261543469       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216261545438       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216261545135       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216261545159       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216261545370       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.134282e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216261541206       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216261541402       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216261541565       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216261541772       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216261542265       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216261542188       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216261542195       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216261542251       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.533657e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5680e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.139847e-01 1 1  ON 0
 uu_1                 5.161644e-02 1 1  ON 1
 uu_2                -4.322366e-02 1 1  ON 2
 uu_3                -9.894237e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192325e-01 1 1  ON 6
 uu_7                -4.820431e-02 1 1  ON 7
 uu_8                 9.350185e-02 1 1  ON 8
 uu_9                 1.266983e-01 1 1  ON 9
 ud_0                 3.555351e-01 1 1  ON 10
 ud_1                 9.663158e-02 1 1  ON 11
 ud_2                -1.382629e-02 1 1  ON 12
 ud_3                -7.541769e-02 1 1  ON 13
 ud_4                -1.235463e-01 1 1  ON 14
 ud_5                -1.555397e-01 1 1  ON 15
 ud_6                -1.570133e-01 1 1  ON 16
 ud_7                -1.128660e-01 1 1  ON 17
 ud_8                -4.903914e-03 1 1  ON 18
 ud_9                 9.265695e-02 1 1  ON 19
 eO_0                -7.840004e-01 1 1  ON 20
 eO_1                -4.623323e-01 1 1  ON 21
 eO_2                -5.035142e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116686e-01 1 1  ON 24
 eO_5                 3.267635e-01 1 1  ON 25
 eO_6                 2.625851e-01 1 1  ON 26
 eO_7                 1.244878e-01 1 1  ON 27
 eO_8                 2.991529e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355536e-02 1 1  ON 32
eH1_3                -2.637146e-02 1 1  ON 33
eH1_4                 1.894539e-02 1 1  ON 34
eH1_5                 3.312146e-02 1 1  ON 35
eH1_6                 7.757985e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753148e-02 1 1  ON 38
eH1_9                 2.646940e-02 1 1  ON 39
eH2_0                -1.856686e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500348e-02 1 1  ON 42
eH2_3                -2.791074e-02 1 1  ON 43
eH2_4                 1.767078e-02 1 1  ON 44
eH2_5                 3.164208e-02 1 1  ON 45
eH2_6                 7.927504e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007144e-01 1 1  ON 48
eH2_9                 2.872907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.369975
====================================================
  Execution time = 1.9775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1797e-01
  Total weights = 2.0000e+06
  Execution time = 1.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953671397
                                         uncertainty =       0.004212287148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953671397
                                         uncertainty =       0.004212287148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398731344
  error estimate for blocks of size 2^( 2) =       0.000408232912
  error estimate for blocks of size 2^( 3) =       0.000417133817
  error estimate for blocks of size 2^( 4) =       0.000423944368
  error estimate for blocks of size 2^( 5) =       0.000428870163
  error estimate for blocks of size 2^( 6) =       0.000430568425
  error estimate for blocks of size 2^( 7) =       0.000434902971

      target function =                  N/A
              le_mean =     -17.216117105071
             les_mean =     296.712661385483
             stat err =       0.000429571482
             autocorr =       1.160673666618
              std dev =       0.563891274053
             le_variance =       0.317973368953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317956708017
                                         uncertainty =       0.004212312517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317956708017
                                         uncertainty =       0.004212312517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733250
  error estimate for blocks of size 2^( 2) =       0.000408234735
  error estimate for blocks of size 2^( 3) =       0.000417135549
  error estimate for blocks of size 2^( 4) =       0.000423946030
  error estimate for blocks of size 2^( 5) =       0.000428871785
  error estimate for blocks of size 2^( 6) =       0.000430570059
  error estimate for blocks of size 2^( 7) =       0.000434904616

      target function =                  N/A
              le_mean =     -17.216117100430
             les_mean =     296.712664265279
             stat err =       0.000429573123
             autocorr =       1.160671437473
              std dev =       0.563893969233
             le_variance =       0.317976408537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317955192544
                                         uncertainty =       0.004212299856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317955192544
                                         uncertainty =       0.004212299856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398732298
  error estimate for blocks of size 2^( 2) =       0.000408233825
  error estimate for blocks of size 2^( 3) =       0.000417134684
  error estimate for blocks of size 2^( 4) =       0.000423945201
  error estimate for blocks of size 2^( 5) =       0.000428870975
  error estimate for blocks of size 2^( 6) =       0.000430569244
  error estimate for blocks of size 2^( 7) =       0.000434903795

      target function =                  N/A
              le_mean =     -17.216117102746
             les_mean =     296.712662828065
             stat err =       0.000429572304
             autocorr =       1.160672550038
              std dev =       0.563892624163
             le_variance =       0.317974891586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953861625
                                         uncertainty =       0.004212288737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317953861625
                                         uncertainty =       0.004212288737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398731463
  error estimate for blocks of size 2^( 2) =       0.000408233026
  error estimate for blocks of size 2^( 3) =       0.000417133925
  error estimate for blocks of size 2^( 4) =       0.000423944472
  error estimate for blocks of size 2^( 5) =       0.000428870264
  error estimate for blocks of size 2^( 6) =       0.000430568528
  error estimate for blocks of size 2^( 7) =       0.000434903074

      target function =                  N/A
              le_mean =     -17.216117104780
             les_mean =     296.712661565872
             stat err =       0.000429571585
             autocorr =       1.160673526978
              std dev =       0.563891442892
             le_variance =       0.317973559367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216117105071        initial  <--
     1.5625e+02     1.5625e+03             2.4532e-06       -17.216117100430
     6.2500e+02     6.2500e+03             6.1343e-07       -17.216117102746
     2.5000e+03     2.5000e+04             1.5337e-07       -17.216117104780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9760
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.139842e-01 1 1  ON 0
 uu_1                 5.161612e-02 1 1  ON 1
 uu_2                -4.322326e-02 1 1  ON 2
 uu_3                -9.894230e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820413e-02 1 1  ON 7
 uu_8                 9.350204e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555345e-01 1 1  ON 10
 ud_1                 9.663154e-02 1 1  ON 11
 ud_2                -1.382628e-02 1 1  ON 12
 ud_3                -7.541763e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570131e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.903695e-03 1 1  ON 18
 ud_9                 9.265697e-02 1 1  ON 19
 eO_0                -7.839998e-01 1 1  ON 20
 eO_1                -4.623319e-01 1 1  ON 21
 eO_2                -5.035154e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116685e-01 1 1  ON 24
 eO_5                 3.267632e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244876e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637155e-02 1 1  ON 33
eH1_4                 1.894528e-02 1 1  ON 34
eH1_5                 3.312159e-02 1 1  ON 35
eH1_6                 7.757992e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753141e-02 1 1  ON 38
eH1_9                 2.646940e-02 1 1  ON 39
eH2_0                -1.856686e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500349e-02 1 1  ON 42
eH2_3                -2.791079e-02 1 1  ON 43
eH2_4                 1.767086e-02 1 1  ON 44
eH2_5                 3.164219e-02 1 1  ON 45
eH2_6                 7.927512e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872903e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4662e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1882
    reference variance = 0.366923
====================================================
  Execution time = 1.9902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2904e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329047982543
                                         uncertainty =       0.011853155562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329047982543
                                         uncertainty =       0.011853155562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405608766
  error estimate for blocks of size 2^( 2) =       0.000414719080
  error estimate for blocks of size 2^( 3) =       0.000422978039
  error estimate for blocks of size 2^( 4) =       0.000429335417
  error estimate for blocks of size 2^( 5) =       0.000433472720
  error estimate for blocks of size 2^( 6) =       0.000434755586
  error estimate for blocks of size 2^( 7) =       0.000435591303

      target function =                  N/A
              le_mean =     -17.216989620925
             les_mean =     296.753768385074
             stat err =       0.000433288757
             autocorr =       1.141143271447
              std dev =       0.573617418285
             le_variance =       0.329036942560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698962092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989620925       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989620731       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989619852       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989619945       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989620831       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989620844       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989620726       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989620741       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.808171e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989620925       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989620876       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989620657       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989620676       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989620902       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989620908       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989620866       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989620879       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 7.020900e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989620925       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989620913       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989620858       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989620864       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989620921       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989620921       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989620912       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989620933       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.755255e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5493e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139843e-01 1 1  ON 0
 uu_1                 5.161616e-02 1 1  ON 1
 uu_2                -4.322328e-02 1 1  ON 2
 uu_3                -9.894232e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820415e-02 1 1  ON 7
 uu_8                 9.350202e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555346e-01 1 1  ON 10
 ud_1                 9.663155e-02 1 1  ON 11
 ud_2                -1.382628e-02 1 1  ON 12
 ud_3                -7.541763e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570131e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.903717e-03 1 1  ON 18
 ud_9                 9.265696e-02 1 1  ON 19
 eO_0                -7.839998e-01 1 1  ON 20
 eO_1                -4.623320e-01 1 1  ON 21
 eO_2                -5.035152e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116685e-01 1 1  ON 24
 eO_5                 3.267632e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244876e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637154e-02 1 1  ON 33
eH1_4                 1.894528e-02 1 1  ON 34
eH1_5                 3.312157e-02 1 1  ON 35
eH1_6                 7.757991e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753142e-02 1 1  ON 38
eH1_9                 2.646940e-02 1 1  ON 39
eH2_0                -1.856686e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500350e-02 1 1  ON 42
eH2_3                -2.791078e-02 1 1  ON 43
eH2_4                 1.767086e-02 1 1  ON 44
eH2_5                 3.164218e-02 1 1  ON 45
eH2_6                 7.927512e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872903e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.181612
====================================================
  Execution time = 1.9529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2303e-01
  Total weights = 2.0000e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077627629
                                         uncertainty =       0.003704545958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077627629
                                         uncertainty =       0.003704545958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401889031
  error estimate for blocks of size 2^( 2) =       0.000411733958
  error estimate for blocks of size 2^( 3) =       0.000420037213
  error estimate for blocks of size 2^( 4) =       0.000426658278
  error estimate for blocks of size 2^( 5) =       0.000430878794
  error estimate for blocks of size 2^( 6) =       0.000431040443
  error estimate for blocks of size 2^( 7) =       0.000431481455

      target function =                  N/A
              le_mean =     -17.216590510924
             les_mean =     296.734018245277
             stat err =       0.000430014743
             autocorr =       1.144865281279
              std dev =       0.568356917739
             le_variance =       0.323029585942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077750327
                                         uncertainty =       0.003704547459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077750327
                                         uncertainty =       0.003704547459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401889107
  error estimate for blocks of size 2^( 2) =       0.000411734031
  error estimate for blocks of size 2^( 3) =       0.000420037281
  error estimate for blocks of size 2^( 4) =       0.000426658344
  error estimate for blocks of size 2^( 5) =       0.000430878860
  error estimate for blocks of size 2^( 6) =       0.000431040510
  error estimate for blocks of size 2^( 7) =       0.000431481526

      target function =                  N/A
              le_mean =     -17.216590510960
             les_mean =     296.734018369255
             stat err =       0.000430014810
             autocorr =       1.144865204665
              std dev =       0.568357025725
             le_variance =       0.323029708691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077688983
                                         uncertainty =       0.003704546708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077688983
                                         uncertainty =       0.003704546708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401889069
  error estimate for blocks of size 2^( 2) =       0.000411733995
  error estimate for blocks of size 2^( 3) =       0.000420037247
  error estimate for blocks of size 2^( 4) =       0.000426658311
  error estimate for blocks of size 2^( 5) =       0.000430878827
  error estimate for blocks of size 2^( 6) =       0.000431040476
  error estimate for blocks of size 2^( 7) =       0.000431481491

      target function =                  N/A
              le_mean =     -17.216590510942
             les_mean =     296.734018307269
             stat err =       0.000430014776
             autocorr =       1.144865242970
              std dev =       0.568356971736
             le_variance =       0.323029647321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077635298
                                         uncertainty =       0.003704546052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077635298
                                         uncertainty =       0.003704546052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401889035
  error estimate for blocks of size 2^( 2) =       0.000411733963
  error estimate for blocks of size 2^( 3) =       0.000420037217
  error estimate for blocks of size 2^( 4) =       0.000426658282
  error estimate for blocks of size 2^( 5) =       0.000430878798
  error estimate for blocks of size 2^( 6) =       0.000431040447
  error estimate for blocks of size 2^( 7) =       0.000431481460

      target function =                  N/A
              le_mean =     -17.216590510927
             les_mean =     296.734018253026
             stat err =       0.000430014747
             autocorr =       1.144865276493
              std dev =       0.568356924489
             le_variance =       0.323029593614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216590510924        initial
     1.5625e+03     1.5625e+04             2.8082e-07       -17.216590510960  <--
     6.2500e+03     6.2500e+04             7.0209e-08       -17.216590510942
     2.5000e+04     2.5000e+05             1.7553e-08       -17.216590510927

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.8758e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139843e-01 1 1  ON 0
 uu_1                 5.161626e-02 1 1  ON 1
 uu_2                -4.322334e-02 1 1  ON 2
 uu_3                -9.894239e-02 1 1  ON 3
 uu_4                -1.336899e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192325e-01 1 1  ON 6
 uu_7                -4.820422e-02 1 1  ON 7
 uu_8                 9.350197e-02 1 1  ON 8
 uu_9                 1.266983e-01 1 1  ON 9
 ud_0                 3.555346e-01 1 1  ON 10
 ud_1                 9.663161e-02 1 1  ON 11
 ud_2                -1.382626e-02 1 1  ON 12
 ud_3                -7.541762e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570132e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.903784e-03 1 1  ON 18
 ud_9                 9.265695e-02 1 1  ON 19
 eO_0                -7.840000e-01 1 1  ON 20
 eO_1                -4.623320e-01 1 1  ON 21
 eO_2                -5.035145e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116686e-01 1 1  ON 24
 eO_5                 3.267633e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244877e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894530e-02 1 1  ON 34
eH1_5                 3.312153e-02 1 1  ON 35
eH1_6                 7.757989e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753144e-02 1 1  ON 38
eH1_9                 2.646941e-02 1 1  ON 39
eH2_0                -1.856685e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500354e-02 1 1  ON 42
eH2_3                -2.791076e-02 1 1  ON 43
eH2_4                 1.767085e-02 1 1  ON 44
eH2_5                 3.164217e-02 1 1  ON 45
eH2_6                 7.927512e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872904e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2459
    reference variance = 0.329959
====================================================
  Execution time = 2.0142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326228471288
                                         uncertainty =       0.006145421269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326228471288
                                         uncertainty =       0.006145421269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403828543
  error estimate for blocks of size 2^( 2) =       0.000413688581
  error estimate for blocks of size 2^( 3) =       0.000422047524
  error estimate for blocks of size 2^( 4) =       0.000428109028
  error estimate for blocks of size 2^( 5) =       0.000433093003
  error estimate for blocks of size 2^( 6) =       0.000435023881
  error estimate for blocks of size 2^( 7) =       0.000435723692

      target function =                  N/A
              le_mean =     -17.216979020383
             les_mean =     296.750521409775
             stat err =       0.000432987401
             autocorr =       1.149625781290
              std dev =       0.571099802616
             le_variance =       0.326154984549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697902038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216979020383       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216979019817       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216979019991       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216979019687       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216979018394       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216979019195       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216979019456       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.045926e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216979020383       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216979020241       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216979020285       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216979020209       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216979019886       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216979020085       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216979020152       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.615387e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216979020383       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216979020347       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216979020358       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216979020339       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216979020258       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216979020311       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216979020319       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 6.538826e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5744e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139844e-01 1 1  ON 0
 uu_1                 5.161634e-02 1 1  ON 1
 uu_2                -4.322346e-02 1 1  ON 2
 uu_3                -9.894242e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420465e-01 1 1  ON 5
 uu_6                -1.192325e-01 1 1  ON 6
 uu_7                -4.820423e-02 1 1  ON 7
 uu_8                 9.350195e-02 1 1  ON 8
 uu_9                 1.266983e-01 1 1  ON 9
 ud_0                 3.555346e-01 1 1  ON 10
 ud_1                 9.663163e-02 1 1  ON 11
 ud_2                -1.382630e-02 1 1  ON 12
 ud_3                -7.541764e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555397e-01 1 1  ON 15
 ud_6                -1.570132e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.903813e-03 1 1  ON 18
 ud_9                 9.265696e-02 1 1  ON 19
 eO_0                -7.840003e-01 1 1  ON 20
 eO_1                -4.623321e-01 1 1  ON 21
 eO_2                -5.035140e-02 1 1  ON 22
 eO_3                 2.109430e-01 1 1  ON 23
 eO_4                 3.116686e-01 1 1  ON 24
 eO_5                 3.267634e-01 1 1  ON 25
 eO_6                 2.625851e-01 1 1  ON 26
 eO_7                 1.244878e-01 1 1  ON 27
 eO_8                 2.991529e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050121e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637153e-02 1 1  ON 33
eH1_4                 1.894522e-02 1 1  ON 34
eH1_5                 3.312148e-02 1 1  ON 35
eH1_6                 7.757986e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753149e-02 1 1  ON 38
eH1_9                 2.646942e-02 1 1  ON 39
eH2_0                -1.856686e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500355e-02 1 1  ON 42
eH2_3                -2.791076e-02 1 1  ON 43
eH2_4                 1.767084e-02 1 1  ON 44
eH2_5                 3.164219e-02 1 1  ON 45
eH2_6                 7.927508e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007144e-01 1 1  ON 48
eH2_9                 2.872906e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1593
    reference variance = 0.263953
====================================================
  Execution time = 1.9497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2224e-01
  Total weights = 2.0000e+06
  Execution time = 1.8341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256787633
                                         uncertainty =       0.004680154512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256787633
                                         uncertainty =       0.004680154512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400344
  error estimate for blocks of size 2^( 2) =       0.000410893883
  error estimate for blocks of size 2^( 3) =       0.000419021328
  error estimate for blocks of size 2^( 4) =       0.000426044929
  error estimate for blocks of size 2^( 5) =       0.000428978072
  error estimate for blocks of size 2^( 6) =       0.000432643709
  error estimate for blocks of size 2^( 7) =       0.000433406482

      target function =                  N/A
              le_mean =     -17.217337160717
             les_mean =     296.758943217610
             stat err =       0.000430268298
             autocorr =       1.149008433179
              std dev =       0.567665810957
             le_variance =       0.322244472929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322257206799
                                         uncertainty =       0.004680156692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322257206799
                                         uncertainty =       0.004680156692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400606
  error estimate for blocks of size 2^( 2) =       0.000410894130
  error estimate for blocks of size 2^( 3) =       0.000419021565
  error estimate for blocks of size 2^( 4) =       0.000426045162
  error estimate for blocks of size 2^( 5) =       0.000428978301
  error estimate for blocks of size 2^( 6) =       0.000432643921
  error estimate for blocks of size 2^( 7) =       0.000433406705

      target function =                  N/A
              le_mean =     -17.217337163273
             les_mean =     296.758943724981
             stat err =       0.000430268522
             autocorr =       1.149008134766
              std dev =       0.567666180311
             le_variance =       0.322244892269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256997330
                                         uncertainty =       0.004680155602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256997330
                                         uncertainty =       0.004680155602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400475
  error estimate for blocks of size 2^( 2) =       0.000410894007
  error estimate for blocks of size 2^( 3) =       0.000419021446
  error estimate for blocks of size 2^( 4) =       0.000426045046
  error estimate for blocks of size 2^( 5) =       0.000428978187
  error estimate for blocks of size 2^( 6) =       0.000432643815
  error estimate for blocks of size 2^( 7) =       0.000433406594

      target function =                  N/A
              le_mean =     -17.217337161996
             les_mean =     296.758943471428
             stat err =       0.000430268410
             autocorr =       1.149008283866
              std dev =       0.567665995735
             le_variance =       0.322244682713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256813849
                                         uncertainty =       0.004680154648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256813849
                                         uncertainty =       0.004680154648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400361
  error estimate for blocks of size 2^( 2) =       0.000410893899
  error estimate for blocks of size 2^( 3) =       0.000419021343
  error estimate for blocks of size 2^( 4) =       0.000426044944
  error estimate for blocks of size 2^( 5) =       0.000428978087
  error estimate for blocks of size 2^( 6) =       0.000432643722
  error estimate for blocks of size 2^( 7) =       0.000433406496

      target function =                  N/A
              le_mean =     -17.217337160877
             les_mean =     296.758943249340
             stat err =       0.000430268312
             autocorr =       1.149008414506
              std dev =       0.567665834057
             le_variance =       0.322244499155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217337160717        initial
     3.9062e+02     3.9062e+03             1.0459e-06       -17.217337163273  <--
     1.5625e+03     1.5625e+04             2.6154e-07       -17.217337161996
     6.2500e+03     6.2500e+04             6.5388e-08       -17.217337160877

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.8734e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139845e-01 1 1  ON 0
 uu_1                 5.161661e-02 1 1  ON 1
 uu_2                -4.322381e-02 1 1  ON 2
 uu_3                -9.894251e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192326e-01 1 1  ON 6
 uu_7                -4.820428e-02 1 1  ON 7
 uu_8                 9.350189e-02 1 1  ON 8
 uu_9                 1.266984e-01 1 1  ON 9
 ud_0                 3.555347e-01 1 1  ON 10
 ud_1                 9.663171e-02 1 1  ON 11
 ud_2                -1.382645e-02 1 1  ON 12
 ud_3                -7.541768e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555398e-01 1 1  ON 15
 ud_6                -1.570132e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903903e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.840011e-01 1 1  ON 20
 eO_1                -4.623325e-01 1 1  ON 21
 eO_2                -5.035122e-02 1 1  ON 22
 eO_3                 2.109429e-01 1 1  ON 23
 eO_4                 3.116688e-01 1 1  ON 24
 eO_5                 3.267637e-01 1 1  ON 25
 eO_6                 2.625854e-01 1 1  ON 26
 eO_7                 1.244881e-01 1 1  ON 27
 eO_8                 2.991533e-02 1 1  ON 28
 eO_9                 1.907790e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050119e-01 1 1  ON 31
eH1_2                -6.355526e-02 1 1  ON 32
eH1_3                -2.637160e-02 1 1  ON 33
eH1_4                 1.894500e-02 1 1  ON 34
eH1_5                 3.312135e-02 1 1  ON 35
eH1_6                 7.757978e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753165e-02 1 1  ON 38
eH1_9                 2.646946e-02 1 1  ON 39
eH2_0                -1.856689e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500357e-02 1 1  ON 42
eH2_3                -2.791075e-02 1 1  ON 43
eH2_4                 1.767082e-02 1 1  ON 44
eH2_5                 3.164225e-02 1 1  ON 45
eH2_6                 7.927493e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007145e-01 1 1  ON 48
eH2_9                 2.872912e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1615
    reference variance = 0.214613
====================================================
  Execution time = 2.0136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2030e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320374303375
                                         uncertainty =       0.003619147217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320374303375
                                         uncertainty =       0.003619147217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400185956
  error estimate for blocks of size 2^( 2) =       0.000409901577
  error estimate for blocks of size 2^( 3) =       0.000419241929
  error estimate for blocks of size 2^( 4) =       0.000424793554
  error estimate for blocks of size 2^( 5) =       0.000428131235
  error estimate for blocks of size 2^( 6) =       0.000431969434
  error estimate for blocks of size 2^( 7) =       0.000434286118

      target function =                  N/A
              le_mean =     -17.216419412330
             les_mean =     296.725394819675
             stat err =       0.000429795085
             autocorr =       1.153451141930
              std dev =       0.565948406291
             le_variance =       0.320297598584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641941233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419412330       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419413761       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419411216       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216419420756       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216419418296       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216419418282       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216419417359       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.948812e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419412330       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419412688       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419412050       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216419414440       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216419413818       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216419413818       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216419413586       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 7.371411e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216419412330       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216419412419       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419412260       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216419412857       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216419412702       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216419412702       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216419412644       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.842814e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5669e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139848e-01 1 1  ON 0
 uu_1                 5.161732e-02 1 1  ON 1
 uu_2                -4.322418e-02 1 1  ON 2
 uu_3                -9.894257e-02 1 1  ON 3
 uu_4                -1.336903e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192329e-01 1 1  ON 6
 uu_7                -4.820444e-02 1 1  ON 7
 uu_8                 9.350171e-02 1 1  ON 8
 uu_9                 1.266985e-01 1 1  ON 9
 ud_0                 3.555353e-01 1 1  ON 10
 ud_1                 9.663156e-02 1 1  ON 11
 ud_2                -1.382640e-02 1 1  ON 12
 ud_3                -7.541788e-02 1 1  ON 13
 ud_4                -1.235463e-01 1 1  ON 14
 ud_5                -1.555397e-01 1 1  ON 15
 ud_6                -1.570131e-01 1 1  ON 16
 ud_7                -1.128659e-01 1 1  ON 17
 ud_8                -4.904211e-03 1 1  ON 18
 ud_9                 9.265694e-02 1 1  ON 19
 eO_0                -7.840018e-01 1 1  ON 20
 eO_1                -4.623332e-01 1 1  ON 21
 eO_2                -5.035110e-02 1 1  ON 22
 eO_3                 2.109430e-01 1 1  ON 23
 eO_4                 3.116691e-01 1 1  ON 24
 eO_5                 3.267640e-01 1 1  ON 25
 eO_6                 2.625857e-01 1 1  ON 26
 eO_7                 1.244884e-01 1 1  ON 27
 eO_8                 2.991536e-02 1 1  ON 28
 eO_9                 1.907791e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050120e-01 1 1  ON 31
eH1_2                -6.355534e-02 1 1  ON 32
eH1_3                -2.637161e-02 1 1  ON 33
eH1_4                 1.894518e-02 1 1  ON 34
eH1_5                 3.312120e-02 1 1  ON 35
eH1_6                 7.757970e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753180e-02 1 1  ON 38
eH1_9                 2.646951e-02 1 1  ON 39
eH2_0                -1.856688e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500376e-02 1 1  ON 42
eH2_3                -2.791089e-02 1 1  ON 43
eH2_4                 1.767083e-02 1 1  ON 44
eH2_5                 3.164221e-02 1 1  ON 45
eH2_6                 7.927495e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007147e-01 1 1  ON 48
eH2_9                 2.872917e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.221957
====================================================
  Execution time = 1.9594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2850e-01
  Total weights = 2.0000e+06
  Execution time = 1.8285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328579694511
                                         uncertainty =       0.006989429775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328579694511
                                         uncertainty =       0.006989429775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405278459
  error estimate for blocks of size 2^( 2) =       0.000415359376
  error estimate for blocks of size 2^( 3) =       0.000424288580
  error estimate for blocks of size 2^( 4) =       0.000431185126
  error estimate for blocks of size 2^( 5) =       0.000434644358
  error estimate for blocks of size 2^( 6) =       0.000436711778
  error estimate for blocks of size 2^( 7) =       0.000439565873

      target function =                  N/A
              le_mean =     -17.216960719000
             les_mean =     296.752237493816
             stat err =       0.000435526784
             autocorr =       1.154842330668
              std dev =       0.573150293092
             le_variance =       0.328501258471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328583099141
                                         uncertainty =       0.006989472955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328583099141
                                         uncertainty =       0.006989472955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405280558
  error estimate for blocks of size 2^( 2) =       0.000415361396
  error estimate for blocks of size 2^( 3) =       0.000424290542
  error estimate for blocks of size 2^( 4) =       0.000431187007
  error estimate for blocks of size 2^( 5) =       0.000434646171
  error estimate for blocks of size 2^( 6) =       0.000436713589
  error estimate for blocks of size 2^( 7) =       0.000439567707

      target function =                  N/A
              le_mean =     -17.216960735588
             les_mean =     296.752241468412
             stat err =       0.000435528618
             autocorr =       1.154840095238
              std dev =       0.573153262119
             le_variance =       0.328504661878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328581401850
                                         uncertainty =       0.006989451369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328581401850
                                         uncertainty =       0.006989451369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405279512
  error estimate for blocks of size 2^( 2) =       0.000415360389
  error estimate for blocks of size 2^( 3) =       0.000424289564
  error estimate for blocks of size 2^( 4) =       0.000431186069
  error estimate for blocks of size 2^( 5) =       0.000434645267
  error estimate for blocks of size 2^( 6) =       0.000436712686
  error estimate for blocks of size 2^( 7) =       0.000439566793

      target function =                  N/A
              le_mean =     -17.216960727307
             les_mean =     296.752239486570
             stat err =       0.000435527704
             autocorr =       1.154841210126
              std dev =       0.573151781988
             le_variance =       0.328502965196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328579908079
                                         uncertainty =       0.006989432474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328579908079
                                         uncertainty =       0.006989432474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405278591
  error estimate for blocks of size 2^( 2) =       0.000415359503
  error estimate for blocks of size 2^( 3) =       0.000424288703
  error estimate for blocks of size 2^( 4) =       0.000431185244
  error estimate for blocks of size 2^( 5) =       0.000434644472
  error estimate for blocks of size 2^( 6) =       0.000436711892
  error estimate for blocks of size 2^( 7) =       0.000439565988

      target function =                  N/A
              le_mean =     -17.216960720038
             les_mean =     296.752237743050
             stat err =       0.000435526899
             autocorr =       1.154842190511
              std dev =       0.573150479335
             le_variance =       0.328501471962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216960719000        initial
     9.7656e+01     9.7656e+02             2.9488e-06       -17.216960735588  <--
     3.9062e+02     3.9062e+03             7.3714e-07       -17.216960727307
     1.5625e+03     1.5625e+04             1.8428e-07       -17.216960720038

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.8814e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139858e-01 1 1  ON 0
 uu_1                 5.161943e-02 1 1  ON 1
 uu_2                -4.322529e-02 1 1  ON 2
 uu_3                -9.894277e-02 1 1  ON 3
 uu_4                -1.336908e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192339e-01 1 1  ON 6
 uu_7                -4.820491e-02 1 1  ON 7
 uu_8                 9.350117e-02 1 1  ON 8
 uu_9                 1.266988e-01 1 1  ON 9
 ud_0                 3.555371e-01 1 1  ON 10
 ud_1                 9.663112e-02 1 1  ON 11
 ud_2                -1.382627e-02 1 1  ON 12
 ud_3                -7.541846e-02 1 1  ON 13
 ud_4                -1.235467e-01 1 1  ON 14
 ud_5                -1.555394e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128662e-01 1 1  ON 17
 ud_8                -4.905134e-03 1 1  ON 18
 ud_9                 9.265683e-02 1 1  ON 19
 eO_0                -7.840040e-01 1 1  ON 20
 eO_1                -4.623354e-01 1 1  ON 21
 eO_2                -5.035074e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116698e-01 1 1  ON 24
 eO_5                 3.267651e-01 1 1  ON 25
 eO_6                 2.625866e-01 1 1  ON 26
 eO_7                 1.244893e-01 1 1  ON 27
 eO_8                 2.991547e-02 1 1  ON 28
 eO_9                 1.907792e-02 1 1  ON 29
eH1_0                -1.844661e-01 1 1  ON 30
eH1_1                -1.050125e-01 1 1  ON 31
eH1_2                -6.355558e-02 1 1  ON 32
eH1_3                -2.637163e-02 1 1  ON 33
eH1_4                 1.894574e-02 1 1  ON 34
eH1_5                 3.312076e-02 1 1  ON 35
eH1_6                 7.757947e-02 1 1  ON 36
eH1_7                 1.097465e-01 1 1  ON 37
eH1_8                 9.753225e-02 1 1  ON 38
eH1_9                 2.646967e-02 1 1  ON 39
eH2_0                -1.856683e-01 1 1  ON 40
eH2_1                -1.065181e-01 1 1  ON 41
eH2_2                -6.500432e-02 1 1  ON 42
eH2_3                -2.791131e-02 1 1  ON 43
eH2_4                 1.767083e-02 1 1  ON 44
eH2_5                 3.164209e-02 1 1  ON 45
eH2_6                 7.927499e-02 1 1  ON 46
eH2_7                 1.142068e-01 1 1  ON 47
eH2_8                 1.007151e-01 1 1  ON 48
eH2_9                 2.872932e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.224
    reference variance = 0.160863
====================================================
  Execution time = 2.2169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329123451413
                                         uncertainty =       0.008860240877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329123451413
                                         uncertainty =       0.008860240877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405591193
  error estimate for blocks of size 2^( 2) =       0.000414942658
  error estimate for blocks of size 2^( 3) =       0.000423456764
  error estimate for blocks of size 2^( 4) =       0.000429073255
  error estimate for blocks of size 2^( 5) =       0.000433291049
  error estimate for blocks of size 2^( 6) =       0.000434716484
  error estimate for blocks of size 2^( 7) =       0.000434516962

      target function =                  N/A
              le_mean =     -17.216453356813
             les_mean =     296.735274455006
             stat err =       0.000432899437
             autocorr =       1.139192218720
              std dev =       0.573592566354
             le_variance =       0.329008432176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645335681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216453356813       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216453367635       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216453357098       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216453357345       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216453367357       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216453364291       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216453363716       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216453364920       residual = 8.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.343425e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216453356813       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216453359547       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216453356875       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216453356912       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216453359443       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216453358657       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216453358538       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216453358810       residual = 8.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.362347e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216453356813       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216453357499       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216453356828       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216453356836       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216453357470       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216453357272       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216453357245       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216453357311       residual = 8.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.408257e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7721e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.139872e-01 1 1  ON 0
 uu_1                 5.162129e-02 1 1  ON 1
 uu_2                -4.322653e-02 1 1  ON 2
 uu_3                -9.894401e-02 1 1  ON 3
 uu_4                -1.336898e-01 1 1  ON 4
 uu_5                -1.420476e-01 1 1  ON 5
 uu_6                -1.192345e-01 1 1  ON 6
 uu_7                -4.820583e-02 1 1  ON 7
 uu_8                 9.350044e-02 1 1  ON 8
 uu_9                 1.266994e-01 1 1  ON 9
 ud_0                 3.555396e-01 1 1  ON 10
 ud_1                 9.663109e-02 1 1  ON 11
 ud_2                -1.382681e-02 1 1  ON 12
 ud_3                -7.541924e-02 1 1  ON 13
 ud_4                -1.235468e-01 1 1  ON 14
 ud_5                -1.555401e-01 1 1  ON 15
 ud_6                -1.570130e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.906029e-03 1 1  ON 18
 ud_9                 9.265672e-02 1 1  ON 19
 eO_0                -7.840074e-01 1 1  ON 20
 eO_1                -4.623378e-01 1 1  ON 21
 eO_2                -5.034895e-02 1 1  ON 22
 eO_3                 2.109425e-01 1 1  ON 23
 eO_4                 3.116695e-01 1 1  ON 24
 eO_5                 3.267668e-01 1 1  ON 25
 eO_6                 2.625880e-01 1 1  ON 26
 eO_7                 1.244908e-01 1 1  ON 27
 eO_8                 2.991565e-02 1 1  ON 28
 eO_9                 1.907799e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050133e-01 1 1  ON 31
eH1_2                -6.355525e-02 1 1  ON 32
eH1_3                -2.637172e-02 1 1  ON 33
eH1_4                 1.894642e-02 1 1  ON 34
eH1_5                 3.312107e-02 1 1  ON 35
eH1_6                 7.757918e-02 1 1  ON 36
eH1_7                 1.097462e-01 1 1  ON 37
eH1_8                 9.753298e-02 1 1  ON 38
eH1_9                 2.646987e-02 1 1  ON 39
eH2_0                -1.856689e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500477e-02 1 1  ON 42
eH2_3                -2.791022e-02 1 1  ON 43
eH2_4                 1.767101e-02 1 1  ON 44
eH2_5                 3.164156e-02 1 1  ON 45
eH2_6                 7.927412e-02 1 1  ON 46
eH2_7                 1.142067e-01 1 1  ON 47
eH2_8                 1.007159e-01 1 1  ON 48
eH2_9                 2.872961e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.4232
    reference variance = 2.85793
====================================================
  Execution time = 1.9896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1902e-01
  Total weights = 2.0000e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318853923669
                                         uncertainty =       0.003045202215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318853923669
                                         uncertainty =       0.003045202215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399386809
  error estimate for blocks of size 2^( 2) =       0.000408927421
  error estimate for blocks of size 2^( 3) =       0.000417884723
  error estimate for blocks of size 2^( 4) =       0.000424539089
  error estimate for blocks of size 2^( 5) =       0.000428089854
  error estimate for blocks of size 2^( 6) =       0.000430192167
  error estimate for blocks of size 2^( 7) =       0.000430127292

      target function =                  N/A
              le_mean =     -17.217264378252
             les_mean =     296.753212157989
             stat err =       0.000428237100
             autocorr =       1.149691036109
              std dev =       0.564818242338
             le_variance =       0.319019646877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318867470078
                                         uncertainty =       0.003045348535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318867470078
                                         uncertainty =       0.003045348535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399395289
  error estimate for blocks of size 2^( 2) =       0.000408935486
  error estimate for blocks of size 2^( 3) =       0.000417892463
  error estimate for blocks of size 2^( 4) =       0.000424546646
  error estimate for blocks of size 2^( 5) =       0.000428097038
  error estimate for blocks of size 2^( 6) =       0.000430199187
  error estimate for blocks of size 2^( 7) =       0.000430134331

      target function =                  N/A
              le_mean =     -17.217264454571
             les_mean =     296.753228333489
             stat err =       0.000428244301
             autocorr =       1.149680874642
              std dev =       0.564830235006
             le_variance =       0.319033194377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318860773479
                                         uncertainty =       0.003045276204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318860773479
                                         uncertainty =       0.003045276204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399391097
  error estimate for blocks of size 2^( 2) =       0.000408931499
  error estimate for blocks of size 2^( 3) =       0.000417888637
  error estimate for blocks of size 2^( 4) =       0.000424542910
  error estimate for blocks of size 2^( 5) =       0.000428093486
  error estimate for blocks of size 2^( 6) =       0.000430195716
  error estimate for blocks of size 2^( 7) =       0.000430130851

      target function =                  N/A
              le_mean =     -17.217264416741
             les_mean =     296.753220333689
             stat err =       0.000428240741
             autocorr =       1.149685894813
              std dev =       0.564824306519
             le_variance =       0.319026497234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318854782243
                                         uncertainty =       0.003045211489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318854782243
                                         uncertainty =       0.003045211489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399387347
  error estimate for blocks of size 2^( 2) =       0.000408927932
  error estimate for blocks of size 2^( 3) =       0.000417885214
  error estimate for blocks of size 2^( 4) =       0.000424539568
  error estimate for blocks of size 2^( 5) =       0.000428090310
  error estimate for blocks of size 2^( 6) =       0.000430192612
  error estimate for blocks of size 2^( 7) =       0.000430127738

      target function =                  N/A
              le_mean =     -17.217264383064
             les_mean =     296.753213182324
             stat err =       0.000428237557
             autocorr =       1.149690391507
              std dev =       0.564819002442
             le_variance =       0.319020505520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217264378252        initial
     2.4414e+01     2.4414e+02             1.3434e-05       -17.217264454571  <--
     9.7656e+01     9.7656e+02             3.3623e-06       -17.217264416741
     3.9062e+02     3.9062e+03             8.4083e-07       -17.217264383064

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.2096e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.139914e-01 1 1  ON 0
 uu_1                 5.162677e-02 1 1  ON 1
 uu_2                -4.323020e-02 1 1  ON 2
 uu_3                -9.894771e-02 1 1  ON 3
 uu_4                -1.336868e-01 1 1  ON 4
 uu_5                -1.420504e-01 1 1  ON 5
 uu_6                -1.192362e-01 1 1  ON 6
 uu_7                -4.820858e-02 1 1  ON 7
 uu_8                 9.349824e-02 1 1  ON 8
 uu_9                 1.267012e-01 1 1  ON 9
 ud_0                 3.555471e-01 1 1  ON 10
 ud_1                 9.663101e-02 1 1  ON 11
 ud_2                -1.382839e-02 1 1  ON 12
 ud_3                -7.542154e-02 1 1  ON 13
 ud_4                -1.235472e-01 1 1  ON 14
 ud_5                -1.555424e-01 1 1  ON 15
 ud_6                -1.570137e-01 1 1  ON 16
 ud_7                -1.128646e-01 1 1  ON 17
 ud_8                -4.908715e-03 1 1  ON 18
 ud_9                 9.265640e-02 1 1  ON 19
 eO_0                -7.840175e-01 1 1  ON 20
 eO_1                -4.623448e-01 1 1  ON 21
 eO_2                -5.034368e-02 1 1  ON 22
 eO_3                 2.109403e-01 1 1  ON 23
 eO_4                 3.116687e-01 1 1  ON 24
 eO_5                 3.267717e-01 1 1  ON 25
 eO_6                 2.625923e-01 1 1  ON 26
 eO_7                 1.244954e-01 1 1  ON 27
 eO_8                 2.991617e-02 1 1  ON 28
 eO_9                 1.907820e-02 1 1  ON 29
eH1_0                -1.844689e-01 1 1  ON 30
eH1_1                -1.050158e-01 1 1  ON 31
eH1_2                -6.355430e-02 1 1  ON 32
eH1_3                -2.637201e-02 1 1  ON 33
eH1_4                 1.894844e-02 1 1  ON 34
eH1_5                 3.312199e-02 1 1  ON 35
eH1_6                 7.757831e-02 1 1  ON 36
eH1_7                 1.097452e-01 1 1  ON 37
eH1_8                 9.753517e-02 1 1  ON 38
eH1_9                 2.647048e-02 1 1  ON 39
eH2_0                -1.856704e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500608e-02 1 1  ON 42
eH2_3                -2.790696e-02 1 1  ON 43
eH2_4                 1.767158e-02 1 1  ON 44
eH2_5                 3.163997e-02 1 1  ON 45
eH2_6                 7.927149e-02 1 1  ON 46
eH2_7                 1.142065e-01 1 1  ON 47
eH2_8                 1.007185e-01 1 1  ON 48
eH2_9                 2.873050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1906
    reference variance = 0.277864
====================================================
  Execution time = 2.0475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1208e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311954189916
                                         uncertainty =       0.002884352577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311954189916
                                         uncertainty =       0.002884352577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395017829
  error estimate for blocks of size 2^( 2) =       0.000405142925
  error estimate for blocks of size 2^( 3) =       0.000413815890
  error estimate for blocks of size 2^( 4) =       0.000420482413
  error estimate for blocks of size 2^( 5) =       0.000425145095
  error estimate for blocks of size 2^( 6) =       0.000426775665
  error estimate for blocks of size 2^( 7) =       0.000427475513

      target function =                  N/A
              le_mean =     -17.216567393404
             les_mean =     296.722270825794
             stat err =       0.000424969671
             autocorr =       1.157397337657
              std dev =       0.558639570947
             le_variance =       0.312078170227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656739340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567393404       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567500234       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567575845       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567677488       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567733920       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567693556       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567663606       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.520244e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567393404       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567421190       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567440100       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567479409       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567468565       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567470624       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567462670       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.642143e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567393404       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567400421       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567405146       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567415293       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567414408       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567412807       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567410841       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.112913e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6115e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.139995e-01 1 1  ON 0
 uu_1                 5.163109e-02 1 1  ON 1
 uu_2                -4.323401e-02 1 1  ON 2
 uu_3                -9.895468e-02 1 1  ON 3
 uu_4                -1.336836e-01 1 1  ON 4
 uu_5                -1.420506e-01 1 1  ON 5
 uu_6                -1.192426e-01 1 1  ON 6
 uu_7                -4.821093e-02 1 1  ON 7
 uu_8                 9.349684e-02 1 1  ON 8
 uu_9                 1.267039e-01 1 1  ON 9
 ud_0                 3.555566e-01 1 1  ON 10
 ud_1                 9.663405e-02 1 1  ON 11
 ud_2                -1.382873e-02 1 1  ON 12
 ud_3                -7.542399e-02 1 1  ON 13
 ud_4                -1.235469e-01 1 1  ON 14
 ud_5                -1.555477e-01 1 1  ON 15
 ud_6                -1.570164e-01 1 1  ON 16
 ud_7                -1.128677e-01 1 1  ON 17
 ud_8                -4.911869e-03 1 1  ON 18
 ud_9                 9.265710e-02 1 1  ON 19
 eO_0                -7.840339e-01 1 1  ON 20
 eO_1                -4.623548e-01 1 1  ON 21
 eO_2                -5.033849e-02 1 1  ON 22
 eO_3                 2.109399e-01 1 1  ON 23
 eO_4                 3.116731e-01 1 1  ON 24
 eO_5                 3.267773e-01 1 1  ON 25
 eO_6                 2.625967e-01 1 1  ON 26
 eO_7                 1.245009e-01 1 1  ON 27
 eO_8                 2.991736e-02 1 1  ON 28
 eO_9                 1.907859e-02 1 1  ON 29
eH1_0                -1.844648e-01 1 1  ON 30
eH1_1                -1.050168e-01 1 1  ON 31
eH1_2                -6.355802e-02 1 1  ON 32
eH1_3                -2.637484e-02 1 1  ON 33
eH1_4                 1.895148e-02 1 1  ON 34
eH1_5                 3.311834e-02 1 1  ON 35
eH1_6                 7.757749e-02 1 1  ON 36
eH1_7                 1.097462e-01 1 1  ON 37
eH1_8                 9.753791e-02 1 1  ON 38
eH1_9                 2.647119e-02 1 1  ON 39
eH2_0                -1.856677e-01 1 1  ON 40
eH2_1                -1.065181e-01 1 1  ON 41
eH2_2                -6.501039e-02 1 1  ON 42
eH2_3                -2.790667e-02 1 1  ON 43
eH2_4                 1.767347e-02 1 1  ON 44
eH2_5                 3.163794e-02 1 1  ON 45
eH2_6                 7.926751e-02 1 1  ON 46
eH2_7                 1.142062e-01 1 1  ON 47
eH2_8                 1.007221e-01 1 1  ON 48
eH2_9                 2.873179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.201545
====================================================
  Execution time = 2.0011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1949e-01
  Total weights = 2.0000e+06
  Execution time = 1.8258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319357761683
                                         uncertainty =       0.003742284285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319357761683
                                         uncertainty =       0.003742284285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399672290
  error estimate for blocks of size 2^( 2) =       0.000409468483
  error estimate for blocks of size 2^( 3) =       0.000417666481
  error estimate for blocks of size 2^( 4) =       0.000424492471
  error estimate for blocks of size 2^( 5) =       0.000427544193
  error estimate for blocks of size 2^( 6) =       0.000429389772
  error estimate for blocks of size 2^( 7) =       0.000428025617

      target function =                  N/A
              le_mean =     -17.216402166724
             les_mean =     296.723979285316
             stat err =       0.000427363013
             autocorr =       1.143367353416
              std dev =       0.565221972931
             le_variance =       0.319475878685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408268383
                                         uncertainty =       0.003742902717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408268383
                                         uncertainty =       0.003742902717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399703878
  error estimate for blocks of size 2^( 2) =       0.000409498702
  error estimate for blocks of size 2^( 3) =       0.000417694986
  error estimate for blocks of size 2^( 4) =       0.000424519593
  error estimate for blocks of size 2^( 5) =       0.000427571135
  error estimate for blocks of size 2^( 6) =       0.000429415820
  error estimate for blocks of size 2^( 7) =       0.000428051304

      target function =                  N/A
              le_mean =     -17.216402221358
             les_mean =     296.724031668472
             stat err =       0.000427389463
             autocorr =       1.143328152108
              std dev =       0.565266645612
             le_variance =       0.319526380641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319383654001
                                         uncertainty =       0.003742603742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319383654001
                                         uncertainty =       0.003742603742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399688484
  error estimate for blocks of size 2^( 2) =       0.000409483973
  error estimate for blocks of size 2^( 3) =       0.000417681092
  error estimate for blocks of size 2^( 4) =       0.000424506368
  error estimate for blocks of size 2^( 5) =       0.000427558004
  error estimate for blocks of size 2^( 6) =       0.000429403116
  error estimate for blocks of size 2^( 7) =       0.000428038793

      target function =                  N/A
              le_mean =     -17.216402192879
             les_mean =     296.724006075485
             stat err =       0.000427376570
             autocorr =       1.143347242476
              std dev =       0.565244874613
             le_variance =       0.319501768277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319361018273
                                         uncertainty =       0.003742324558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319361018273
                                         uncertainty =       0.003742324558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399674327
  error estimate for blocks of size 2^( 2) =       0.000409470431
  error estimate for blocks of size 2^( 3) =       0.000417668319
  error estimate for blocks of size 2^( 4) =       0.000424494218
  error estimate for blocks of size 2^( 5) =       0.000427545930
  error estimate for blocks of size 2^( 6) =       0.000429391449
  error estimate for blocks of size 2^( 7) =       0.000428027274

      target function =                  N/A
              le_mean =     -17.216402169814
             les_mean =     296.723982647950
             stat err =       0.000427364718
             autocorr =       1.143364821990
              std dev =       0.565224853419
             le_variance =       0.319479134922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216402166724        initial
     6.1035e+00     6.1035e+01             6.5202e-05       -17.216402221358  <--
     2.4414e+01     2.4414e+02             1.6421e-05       -17.216402192879
     9.7656e+01     9.7656e+02             4.1129e-06       -17.216402169814

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9241e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.140235e-01 1 1  ON 0
 uu_1                 5.164310e-02 1 1  ON 1
 uu_2                -4.324461e-02 1 1  ON 2
 uu_3                -9.897484e-02 1 1  ON 3
 uu_4                -1.336752e-01 1 1  ON 4
 uu_5                -1.420506e-01 1 1  ON 5
 uu_6                -1.192614e-01 1 1  ON 6
 uu_7                -4.821797e-02 1 1  ON 7
 uu_8                 9.349264e-02 1 1  ON 8
 uu_9                 1.267119e-01 1 1  ON 9
 ud_0                 3.555846e-01 1 1  ON 10
 ud_1                 9.664283e-02 1 1  ON 11
 ud_2                -1.382952e-02 1 1  ON 12
 ud_3                -7.543081e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555631e-01 1 1  ON 15
 ud_6                -1.570243e-01 1 1  ON 16
 ud_7                -1.128769e-01 1 1  ON 17
 ud_8                -4.921303e-03 1 1  ON 18
 ud_9                 9.265919e-02 1 1  ON 19
 eO_0                -7.840827e-01 1 1  ON 20
 eO_1                -4.623842e-01 1 1  ON 21
 eO_2                -5.032445e-02 1 1  ON 22
 eO_3                 2.109390e-01 1 1  ON 23
 eO_4                 3.116864e-01 1 1  ON 24
 eO_5                 3.267939e-01 1 1  ON 25
 eO_6                 2.626097e-01 1 1  ON 26
 eO_7                 1.245173e-01 1 1  ON 27
 eO_8                 2.992092e-02 1 1  ON 28
 eO_9                 1.907978e-02 1 1  ON 29
eH1_0                -1.844529e-01 1 1  ON 30
eH1_1                -1.050198e-01 1 1  ON 31
eH1_2                -6.356880e-02 1 1  ON 32
eH1_3                -2.638320e-02 1 1  ON 33
eH1_4                 1.896037e-02 1 1  ON 34
eH1_5                 3.310767e-02 1 1  ON 35
eH1_6                 7.757508e-02 1 1  ON 36
eH1_7                 1.097489e-01 1 1  ON 37
eH1_8                 9.754609e-02 1 1  ON 38
eH1_9                 2.647331e-02 1 1  ON 39
eH2_0                -1.856596e-01 1 1  ON 40
eH2_1                -1.065173e-01 1 1  ON 41
eH2_2                -6.502279e-02 1 1  ON 42
eH2_3                -2.790585e-02 1 1  ON 43
eH2_4                 1.767908e-02 1 1  ON 44
eH2_5                 3.163204e-02 1 1  ON 45
eH2_6                 7.925563e-02 1 1  ON 46
eH2_7                 1.142056e-01 1 1  ON 47
eH2_8                 1.007326e-01 1 1  ON 48
eH2_9                 2.873564e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.431973
====================================================
  Execution time = 2.0521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342802143490
                                         uncertainty =       0.028048759474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342802143490
                                         uncertainty =       0.028048759474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418671130
  error estimate for blocks of size 2^( 2) =       0.000427888822
  error estimate for blocks of size 2^( 3) =       0.000436171558
  error estimate for blocks of size 2^( 4) =       0.000442944930
  error estimate for blocks of size 2^( 5) =       0.000447557233
  error estimate for blocks of size 2^( 6) =       0.000451097515
  error estimate for blocks of size 2^( 7) =       0.000450932210

      target function =                  N/A
              le_mean =     -17.216989281686
             les_mean =     296.775290781118
             stat err =       0.000448132972
             autocorr =       1.145691702818
              std dev =       0.592090390660
             le_variance =       0.350571030712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698928169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989281686       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989452980       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989350787       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989740278       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989934728       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990307457       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216990359233       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216990399232       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.561310e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989281686       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989328963       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989297990       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989402457       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989466515       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989566935       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989588125       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989603732       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 6.636526e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216989281686       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216989293821       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216989285684       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989312258       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989329545       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989355147       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989361318       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989365601       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.674663e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6008e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.140381e-01 1 1  ON 0
 uu_1                 5.166942e-02 1 1  ON 1
 uu_2                -4.326587e-02 1 1  ON 2
 uu_3                -9.898990e-02 1 1  ON 3
 uu_4                -1.336673e-01 1 1  ON 4
 uu_5                -1.420268e-01 1 1  ON 5
 uu_6                -1.192783e-01 1 1  ON 6
 uu_7                -4.824096e-02 1 1  ON 7
 uu_8                 9.347602e-02 1 1  ON 8
 uu_9                 1.267198e-01 1 1  ON 9
 ud_0                 3.556334e-01 1 1  ON 10
 ud_1                 9.665136e-02 1 1  ON 11
 ud_2                -1.382421e-02 1 1  ON 12
 ud_3                -7.545284e-02 1 1  ON 13
 ud_4                -1.235540e-01 1 1  ON 14
 ud_5                -1.555541e-01 1 1  ON 15
 ud_6                -1.570496e-01 1 1  ON 16
 ud_7                -1.128869e-01 1 1  ON 17
 ud_8                -4.936037e-03 1 1  ON 18
 ud_9                 9.265893e-02 1 1  ON 19
 eO_0                -7.841490e-01 1 1  ON 20
 eO_1                -4.624254e-01 1 1  ON 21
 eO_2                -5.028953e-02 1 1  ON 22
 eO_3                 2.109331e-01 1 1  ON 23
 eO_4                 3.116983e-01 1 1  ON 24
 eO_5                 3.268173e-01 1 1  ON 25
 eO_6                 2.626271e-01 1 1  ON 26
 eO_7                 1.245381e-01 1 1  ON 27
 eO_8                 2.992370e-02 1 1  ON 28
 eO_9                 1.908083e-02 1 1  ON 29
eH1_0                -1.844586e-01 1 1  ON 30
eH1_1                -1.050370e-01 1 1  ON 31
eH1_2                -6.356038e-02 1 1  ON 32
eH1_3                -2.637228e-02 1 1  ON 33
eH1_4                 1.894647e-02 1 1  ON 34
eH1_5                 3.311026e-02 1 1  ON 35
eH1_6                 7.757315e-02 1 1  ON 36
eH1_7                 1.097482e-01 1 1  ON 37
eH1_8                 9.755907e-02 1 1  ON 38
eH1_9                 2.647739e-02 1 1  ON 39
eH2_0                -1.856624e-01 1 1  ON 40
eH2_1                -1.065105e-01 1 1  ON 41
eH2_2                -6.503370e-02 1 1  ON 42
eH2_3                -2.789656e-02 1 1  ON 43
eH2_4                 1.765618e-02 1 1  ON 44
eH2_5                 3.163930e-02 1 1  ON 45
eH2_6                 7.925719e-02 1 1  ON 46
eH2_7                 1.142026e-01 1 1  ON 47
eH2_8                 1.007423e-01 1 1  ON 48
eH2_9                 2.873926e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2082
    reference variance = 0.172707
====================================================
  Execution time = 2.0359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320482008501
                                         uncertainty =       0.003338525831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320482008501
                                         uncertainty =       0.003338525831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400247355
  error estimate for blocks of size 2^( 2) =       0.000409684485
  error estimate for blocks of size 2^( 3) =       0.000417931988
  error estimate for blocks of size 2^( 4) =       0.000424553026
  error estimate for blocks of size 2^( 5) =       0.000429521441
  error estimate for blocks of size 2^( 6) =       0.000432080301
  error estimate for blocks of size 2^( 7) =       0.000433656627

      target function =                  N/A
              le_mean =     -17.217162095631
             les_mean =     296.751066357785
             stat err =       0.000429952849
             autocorr =       1.153943964860
              std dev =       0.566035238068
             le_variance =       0.320395890735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320665230507
                                         uncertainty =       0.003341128345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320665230507
                                         uncertainty =       0.003341128345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400361746
  error estimate for blocks of size 2^( 2) =       0.000409793589
  error estimate for blocks of size 2^( 3) =       0.000418036158
  error estimate for blocks of size 2^( 4) =       0.000424654005
  error estimate for blocks of size 2^( 5) =       0.000429622621
  error estimate for blocks of size 2^( 6) =       0.000432184877
  error estimate for blocks of size 2^( 7) =       0.000433757582

      target function =                  N/A
              le_mean =     -17.217162256594
             les_mean =     296.751255064728
             stat err =       0.000430054771
             autocorr =       1.153831501772
              std dev =       0.566197010885
             le_variance =       0.320579055135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587016055
                                         uncertainty =       0.003340016767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320587016055
                                         uncertainty =       0.003340016767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400312918
  error estimate for blocks of size 2^( 2) =       0.000409747033
  error estimate for blocks of size 2^( 3) =       0.000417991741
  error estimate for blocks of size 2^( 4) =       0.000424610989
  error estimate for blocks of size 2^( 5) =       0.000429579519
  error estimate for blocks of size 2^( 6) =       0.000432140419
  error estimate for blocks of size 2^( 7) =       0.000433714489

      target function =                  N/A
              le_mean =     -17.217162160028
             les_mean =     296.751173549260
             stat err =       0.000430011354
             autocorr =       1.153879973629
              std dev =       0.566127957985
             le_variance =       0.320500864813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320495626580
                                         uncertainty =       0.003338719507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320495626580
                                         uncertainty =       0.003338719507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400255858
  error estimate for blocks of size 2^( 2) =       0.000409692596
  error estimate for blocks of size 2^( 3) =       0.000417939737
  error estimate for blocks of size 2^( 4) =       0.000424560544
  error estimate for blocks of size 2^( 5) =       0.000429528974
  error estimate for blocks of size 2^( 6) =       0.000432088103
  error estimate for blocks of size 2^( 7) =       0.000433664127

      target function =                  N/A
              le_mean =     -17.217162099960
             les_mean =     296.751080120550
             stat err =       0.000429960437
             autocorr =       1.153935665455
              std dev =       0.566047263436
             le_variance =       0.320409504444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217162095631        initial
     1.5259e+00     1.5259e+01             2.5613e-04       -17.217162256594  <--
     6.1035e+00     6.1035e+01             6.6365e-05       -17.217162160028
     2.4414e+01     2.4414e+02             1.6747e-05       -17.217162099960

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9607e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.140819e-01 1 1  ON 0
 uu_1                 5.173034e-02 1 1  ON 1
 uu_2                -4.331450e-02 1 1  ON 2
 uu_3                -9.903116e-02 1 1  ON 3
 uu_4                -1.336491e-01 1 1  ON 4
 uu_5                -1.419575e-01 1 1  ON 5
 uu_6                -1.193242e-01 1 1  ON 6
 uu_7                -4.830796e-02 1 1  ON 7
 uu_8                 9.342701e-02 1 1  ON 8
 uu_9                 1.267430e-01 1 1  ON 9
 ud_0                 3.557578e-01 1 1  ON 10
 ud_1                 9.668263e-02 1 1  ON 11
 ud_2                -1.381022e-02 1 1  ON 12
 ud_3                -7.550291e-02 1 1  ON 13
 ud_4                -1.235777e-01 1 1  ON 14
 ud_5                -1.555312e-01 1 1  ON 15
 ud_6                -1.571209e-01 1 1  ON 16
 ud_7                -1.129156e-01 1 1  ON 17
 ud_8                -4.979438e-03 1 1  ON 18
 ud_9                 9.265815e-02 1 1  ON 19
 eO_0                -7.843388e-01 1 1  ON 20
 eO_1                -4.625389e-01 1 1  ON 21
 eO_2                -5.020717e-02 1 1  ON 22
 eO_3                 2.109213e-01 1 1  ON 23
 eO_4                 3.117330e-01 1 1  ON 24
 eO_5                 3.268876e-01 1 1  ON 25
 eO_6                 2.626788e-01 1 1  ON 26
 eO_7                 1.245993e-01 1 1  ON 27
 eO_8                 2.993185e-02 1 1  ON 28
 eO_9                 1.908392e-02 1 1  ON 29
eH1_0                -1.844787e-01 1 1  ON 30
eH1_1                -1.050814e-01 1 1  ON 31
eH1_2                -6.353848e-02 1 1  ON 32
eH1_3                -2.634391e-02 1 1  ON 33
eH1_4                 1.890897e-02 1 1  ON 34
eH1_5                 3.311766e-02 1 1  ON 35
eH1_6                 7.756763e-02 1 1  ON 36
eH1_7                 1.097462e-01 1 1  ON 37
eH1_8                 9.759727e-02 1 1  ON 38
eH1_9                 2.648940e-02 1 1  ON 39
eH2_0                -1.856719e-01 1 1  ON 40
eH2_1                -1.064945e-01 1 1  ON 41
eH2_2                -6.505939e-02 1 1  ON 42
eH2_3                -2.787568e-02 1 1  ON 43
eH2_4                 1.759290e-02 1 1  ON 44
eH2_5                 3.166090e-02 1 1  ON 45
eH2_6                 7.926233e-02 1 1  ON 46
eH2_7                 1.141944e-01 1 1  ON 47
eH2_8                 1.007707e-01 1 1  ON 48
eH2_9                 2.874993e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.254821
====================================================
  Execution time = 2.0350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318092588475
                                         uncertainty =       0.004203445509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318092588475
                                         uncertainty =       0.004203445509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398892900
  error estimate for blocks of size 2^( 2) =       0.000408363597
  error estimate for blocks of size 2^( 3) =       0.000416550251
  error estimate for blocks of size 2^( 4) =       0.000423707202
  error estimate for blocks of size 2^( 5) =       0.000428188970
  error estimate for blocks of size 2^( 6) =       0.000429737284
  error estimate for blocks of size 2^( 7) =       0.000429544075

      target function =                  N/A
              le_mean =     -17.216911713088
             les_mean =     296.740279869175
             stat err =       0.000427794383
             autocorr =       1.150158099438
              std dev =       0.564119749725
             le_variance =       0.318231092030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691171309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216911713088       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216913553091       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216913717225       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216913368401       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216915059319       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216916563620       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216916993354       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216916924455       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216916735852       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 1.055120e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216911713088       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216912380856       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216912286963       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216912514110       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216912972033       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216913340231       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216913349592       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216913343842       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 3.057174e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216911713088       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216911901280       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216911870323       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216911933470       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216912076853       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216912157662       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216912157164       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 8.060753e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6002e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.142376e-01 1 1  ON 0
 uu_1                 5.181449e-02 1 1  ON 1
 uu_2                -4.341940e-02 1 1  ON 2
 uu_3                -9.908977e-02 1 1  ON 3
 uu_4                -1.337161e-01 1 1  ON 4
 uu_5                -1.419934e-01 1 1  ON 5
 uu_6                -1.193412e-01 1 1  ON 6
 uu_7                -4.832404e-02 1 1  ON 7
 uu_8                 9.339310e-02 1 1  ON 8
 uu_9                 1.267794e-01 1 1  ON 9
 ud_0                 3.557583e-01 1 1  ON 10
 ud_1                 9.669873e-02 1 1  ON 11
 ud_2                -1.384820e-02 1 1  ON 12
 ud_3                -7.550102e-02 1 1  ON 13
 ud_4                -1.235894e-01 1 1  ON 14
 ud_5                -1.554870e-01 1 1  ON 15
 ud_6                -1.571234e-01 1 1  ON 16
 ud_7                -1.129221e-01 1 1  ON 17
 ud_8                -5.035472e-03 1 1  ON 18
 ud_9                 9.266562e-02 1 1  ON 19
 eO_0                -7.846445e-01 1 1  ON 20
 eO_1                -4.626229e-01 1 1  ON 21
 eO_2                -5.019883e-02 1 1  ON 22
 eO_3                 2.109149e-01 1 1  ON 23
 eO_4                 3.118034e-01 1 1  ON 24
 eO_5                 3.269977e-01 1 1  ON 25
 eO_6                 2.627760e-01 1 1  ON 26
 eO_7                 1.246843e-01 1 1  ON 27
 eO_8                 2.994640e-02 1 1  ON 28
 eO_9                 1.908844e-02 1 1  ON 29
eH1_0                -1.844833e-01 1 1  ON 30
eH1_1                -1.050602e-01 1 1  ON 31
eH1_2                -6.355154e-02 1 1  ON 32
eH1_3                -2.636226e-02 1 1  ON 33
eH1_4                 1.892220e-02 1 1  ON 34
eH1_5                 3.303891e-02 1 1  ON 35
eH1_6                 7.757473e-02 1 1  ON 36
eH1_7                 1.097595e-01 1 1  ON 37
eH1_8                 9.763735e-02 1 1  ON 38
eH1_9                 2.650306e-02 1 1  ON 39
eH2_0                -1.857174e-01 1 1  ON 40
eH2_1                -1.065079e-01 1 1  ON 41
eH2_2                -6.504877e-02 1 1  ON 42
eH2_3                -2.791833e-02 1 1  ON 43
eH2_4                 1.752454e-02 1 1  ON 44
eH2_5                 3.168667e-02 1 1  ON 45
eH2_6                 7.929974e-02 1 1  ON 46
eH2_7                 1.142046e-01 1 1  ON 47
eH2_8                 1.008274e-01 1 1  ON 48
eH2_9                 2.877224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.148164
====================================================
  Execution time = 1.9896e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1201e-01
  Total weights = 2.0000e+06
  Execution time = 1.8292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311993065592
                                         uncertainty =       0.003622457542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311993065592
                                         uncertainty =       0.003622457542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394902621
  error estimate for blocks of size 2^( 2) =       0.000404780421
  error estimate for blocks of size 2^( 3) =       0.000414073096
  error estimate for blocks of size 2^( 4) =       0.000420569248
  error estimate for blocks of size 2^( 5) =       0.000423951783
  error estimate for blocks of size 2^( 6) =       0.000426322612
  error estimate for blocks of size 2^( 7) =       0.000427890586

      target function =                  N/A
              le_mean =     -17.216940289552
             les_mean =     296.734928938165
             stat err =       0.000424683557
             autocorr =       1.156513909956
              std dev =       0.558476642415
             le_variance =       0.311896160123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312338883547
                                         uncertainty =       0.003626550592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312338883547
                                         uncertainty =       0.003626550592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395121369
  error estimate for blocks of size 2^( 2) =       0.000404989854
  error estimate for blocks of size 2^( 3) =       0.000414274684
  error estimate for blocks of size 2^( 4) =       0.000420765072
  error estimate for blocks of size 2^( 5) =       0.000424143778
  error estimate for blocks of size 2^( 6) =       0.000426503106
  error estimate for blocks of size 2^( 7) =       0.000428070685

      target function =                  N/A
              le_mean =     -17.216940184800
             les_mean =     296.735270962705
             stat err =       0.000424870660
             autocorr =       1.156251870355
              std dev =       0.558785998245
             le_variance =       0.312241791835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312220183684
                                         uncertainty =       0.003625052291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312220183684
                                         uncertainty =       0.003625052291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395046282
  error estimate for blocks of size 2^( 2) =       0.000404917659
  error estimate for blocks of size 2^( 3) =       0.000414205119
  error estimate for blocks of size 2^( 4) =       0.000420697352
  error estimate for blocks of size 2^( 5) =       0.000424077961
  error estimate for blocks of size 2^( 6) =       0.000426440259
  error estimate for blocks of size 2^( 7) =       0.000428008044

      target function =                  N/A
              le_mean =     -17.216940407673
             les_mean =     296.735159975636
             stat err =       0.000424805904
             autocorr =       1.156338882445
              std dev =       0.558679810208
             le_variance =       0.312123130334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312022884523
                                         uncertainty =       0.003622797013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312022884523
                                         uncertainty =       0.003622797013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394921484
  error estimate for blocks of size 2^( 2) =       0.000404798397
  error estimate for blocks of size 2^( 3) =       0.000414090368
  error estimate for blocks of size 2^( 4) =       0.000420585993
  error estimate for blocks of size 2^( 5) =       0.000423968341
  error estimate for blocks of size 2^( 6) =       0.000426337933
  error estimate for blocks of size 2^( 7) =       0.000427905863

      target function =                  N/A
              le_mean =     -17.216940281490
             les_mean =     296.734958457337
             stat err =       0.000424699532
             autocorr =       1.156490435251
              std dev =       0.558503318633
             le_variance =       0.311925956924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216940289552        initial
     3.8147e-01     3.8147e+00             1.0551e-03       -17.216940184800
     1.5259e+00     1.5259e+01             3.0572e-04       -17.216940407673  <--
     6.1035e+00     6.1035e+01             8.0608e-05       -17.216940281490

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9101e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.142376e-01 1 1  ON 0
 uu_1                 5.181449e-02 1 1  ON 1
 uu_2                -4.341940e-02 1 1  ON 2
 uu_3                -9.908977e-02 1 1  ON 3
 uu_4                -1.337161e-01 1 1  ON 4
 uu_5                -1.419934e-01 1 1  ON 5
 uu_6                -1.193412e-01 1 1  ON 6
 uu_7                -4.832404e-02 1 1  ON 7
 uu_8                 9.339310e-02 1 1  ON 8
 uu_9                 1.267794e-01 1 1  ON 9
 ud_0                 3.557583e-01 1 1  ON 10
 ud_1                 9.669873e-02 1 1  ON 11
 ud_2                -1.384820e-02 1 1  ON 12
 ud_3                -7.550102e-02 1 1  ON 13
 ud_4                -1.235894e-01 1 1  ON 14
 ud_5                -1.554870e-01 1 1  ON 15
 ud_6                -1.571234e-01 1 1  ON 16
 ud_7                -1.129221e-01 1 1  ON 17
 ud_8                -5.035472e-03 1 1  ON 18
 ud_9                 9.266562e-02 1 1  ON 19
 eO_0                -7.846445e-01 1 1  ON 20
 eO_1                -4.626229e-01 1 1  ON 21
 eO_2                -5.019883e-02 1 1  ON 22
 eO_3                 2.109149e-01 1 1  ON 23
 eO_4                 3.118034e-01 1 1  ON 24
 eO_5                 3.269977e-01 1 1  ON 25
 eO_6                 2.627760e-01 1 1  ON 26
 eO_7                 1.246843e-01 1 1  ON 27
 eO_8                 2.994640e-02 1 1  ON 28
 eO_9                 1.908844e-02 1 1  ON 29
eH1_0                -1.844833e-01 1 1  ON 30
eH1_1                -1.050602e-01 1 1  ON 31
eH1_2                -6.355154e-02 1 1  ON 32
eH1_3                -2.636226e-02 1 1  ON 33
eH1_4                 1.892220e-02 1 1  ON 34
eH1_5                 3.303891e-02 1 1  ON 35
eH1_6                 7.757473e-02 1 1  ON 36
eH1_7                 1.097595e-01 1 1  ON 37
eH1_8                 9.763735e-02 1 1  ON 38
eH1_9                 2.650306e-02 1 1  ON 39
eH2_0                -1.857174e-01 1 1  ON 40
eH2_1                -1.065079e-01 1 1  ON 41
eH2_2                -6.504877e-02 1 1  ON 42
eH2_3                -2.791833e-02 1 1  ON 43
eH2_4                 1.752454e-02 1 1  ON 44
eH2_5                 3.168667e-02 1 1  ON 45
eH2_6                 7.929974e-02 1 1  ON 46
eH2_7                 1.142046e-01 1 1  ON 47
eH2_8                 1.008274e-01 1 1  ON 48
eH2_9                 2.877224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5109e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.439579
====================================================
  Execution time = 2.0322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317129814418
                                         uncertainty =       0.003521282773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317129814418
                                         uncertainty =       0.003521282773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398160495
  error estimate for blocks of size 2^( 2) =       0.000407755042
  error estimate for blocks of size 2^( 3) =       0.000416888889
  error estimate for blocks of size 2^( 4) =       0.000423233012
  error estimate for blocks of size 2^( 5) =       0.000427755409
  error estimate for blocks of size 2^( 6) =       0.000428640012
  error estimate for blocks of size 2^( 7) =       0.000432748122

      target function =                  N/A
              le_mean =     -17.217690793428
             les_mean =     296.765939659158
             stat err =       0.000428094139
             autocorr =       1.156011696362
              std dev =       0.563083972073
             le_variance =       0.317063559605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721769079343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217690793428       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217691417865       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217691038117       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217690808405       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217691489309       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217691747192       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217691720807       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217692001180       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217691974569       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.471419e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217690793428       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217690993822       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217690821898       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217690785601       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217690988506       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217691063891       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217691063882       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217691099861       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.735541e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217690793428       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217690847351       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217690795796       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217690789279       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217690839559       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217690859871       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217690862796       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217690867282       residual = 9.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.439893e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5886e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.142377e-01 1 1  ON 0
 uu_1                 5.184354e-02 1 1  ON 1
 uu_2                -4.343922e-02 1 1  ON 2
 uu_3                -9.912043e-02 1 1  ON 3
 uu_4                -1.336910e-01 1 1  ON 4
 uu_5                -1.420085e-01 1 1  ON 5
 uu_6                -1.193818e-01 1 1  ON 6
 uu_7                -4.832443e-02 1 1  ON 7
 uu_8                 9.335444e-02 1 1  ON 8
 uu_9                 1.268177e-01 1 1  ON 9
 ud_0                 3.558100e-01 1 1  ON 10
 ud_1                 9.668157e-02 1 1  ON 11
 ud_2                -1.383746e-02 1 1  ON 12
 ud_3                -7.551802e-02 1 1  ON 13
 ud_4                -1.235576e-01 1 1  ON 14
 ud_5                -1.555417e-01 1 1  ON 15
 ud_6                -1.571343e-01 1 1  ON 16
 ud_7                -1.129324e-01 1 1  ON 17
 ud_8                -5.074234e-03 1 1  ON 18
 ud_9                 9.267260e-02 1 1  ON 19
 eO_0                -7.848181e-01 1 1  ON 20
 eO_1                -4.627662e-01 1 1  ON 21
 eO_2                -5.017329e-02 1 1  ON 22
 eO_3                 2.108044e-01 1 1  ON 23
 eO_4                 3.118929e-01 1 1  ON 24
 eO_5                 3.270868e-01 1 1  ON 25
 eO_6                 2.628733e-01 1 1  ON 26
 eO_7                 1.247819e-01 1 1  ON 27
 eO_8                 2.996400e-02 1 1  ON 28
 eO_9                 1.909486e-02 1 1  ON 29
eH1_0                -1.844755e-01 1 1  ON 30
eH1_1                -1.050421e-01 1 1  ON 31
eH1_2                -6.358268e-02 1 1  ON 32
eH1_3                -2.642475e-02 1 1  ON 33
eH1_4                 1.891217e-02 1 1  ON 34
eH1_5                 3.302626e-02 1 1  ON 35
eH1_6                 7.759052e-02 1 1  ON 36
eH1_7                 1.097694e-01 1 1  ON 37
eH1_8                 9.768351e-02 1 1  ON 38
eH1_9                 2.651696e-02 1 1  ON 39
eH2_0                -1.857531e-01 1 1  ON 40
eH2_1                -1.065307e-01 1 1  ON 41
eH2_2                -6.503895e-02 1 1  ON 42
eH2_3                -2.792525e-02 1 1  ON 43
eH2_4                 1.747368e-02 1 1  ON 44
eH2_5                 3.166113e-02 1 1  ON 45
eH2_6                 7.933635e-02 1 1  ON 46
eH2_7                 1.142191e-01 1 1  ON 47
eH2_8                 1.008838e-01 1 1  ON 48
eH2_9                 2.878901e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.252
    reference variance = 0.22819
====================================================
  Execution time = 1.9683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1604e-01
  Total weights = 2.0000e+06
  Execution time = 1.8291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316031377232
                                         uncertainty =       0.003068178321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316031377232
                                         uncertainty =       0.003068178321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397485168
  error estimate for blocks of size 2^( 2) =       0.000407196838
  error estimate for blocks of size 2^( 3) =       0.000415317189
  error estimate for blocks of size 2^( 4) =       0.000421828173
  error estimate for blocks of size 2^( 5) =       0.000425114151
  error estimate for blocks of size 2^( 6) =       0.000426800905
  error estimate for blocks of size 2^( 7) =       0.000427517841

      target function =                  N/A
              le_mean =     -17.217023704977
             les_mean =     296.741894017034
             stat err =       0.000425315267
             autocorr =       1.144933045534
              std dev =       0.562128915193
             le_variance =       0.315988917296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316174047247
                                         uncertainty =       0.003070476995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316174047247
                                         uncertainty =       0.003070476995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397574868
  error estimate for blocks of size 2^( 2) =       0.000407284281
  error estimate for blocks of size 2^( 3) =       0.000415399589
  error estimate for blocks of size 2^( 4) =       0.000421906621
  error estimate for blocks of size 2^( 5) =       0.000425187045
  error estimate for blocks of size 2^( 6) =       0.000426873337
  error estimate for blocks of size 2^( 7) =       0.000427596522

      target function =                  N/A
              le_mean =     -17.217024598515
             les_mean =     296.742067418913
             stat err =       0.000425390881
             autocorr =       1.144823420066
              std dev =       0.562255770200
             le_variance =       0.316131551124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316142033276
                                         uncertainty =       0.003069952402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316142033276
                                         uncertainty =       0.003069952402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397554741
  error estimate for blocks of size 2^( 2) =       0.000407264550
  error estimate for blocks of size 2^( 3) =       0.000415381304
  error estimate for blocks of size 2^( 4) =       0.000421889379
  error estimate for blocks of size 2^( 5) =       0.000425171504
  error estimate for blocks of size 2^( 6) =       0.000426858313
  error estimate for blocks of size 2^( 7) =       0.000427579744

      target function =                  N/A
              le_mean =     -17.217024003227
             les_mean =     296.742014914160
             stat err =       0.000425374735
             autocorr =       1.144852426561
              std dev =       0.562227306812
             le_variance =       0.316099544525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316047582940
                                         uncertainty =       0.003068436841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316047582940
                                         uncertainty =       0.003068436841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397495358
  error estimate for blocks of size 2^( 2) =       0.000407206743
  error estimate for blocks of size 2^( 3) =       0.000415326576
  error estimate for blocks of size 2^( 4) =       0.000421837127
  error estimate for blocks of size 2^( 5) =       0.000425122557
  error estimate for blocks of size 2^( 6) =       0.000426809344
  error estimate for blocks of size 2^( 7) =       0.000427526916

      target function =                  N/A
              le_mean =     -17.217023712285
             les_mean =     296.741910469870
             stat err =       0.000425323986
             autocorr =       1.144921283003
              std dev =       0.562143325574
             le_variance =       0.316005118487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217023704977        initial
     3.8147e-01     3.8147e+00             6.4714e-04       -17.217024598515  <--
     1.5259e+00     1.5259e+01             1.7355e-04       -17.217024003227
     6.1035e+00     6.1035e+01             4.4399e-05       -17.217023712285

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.8883e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.142528e-01 1 1  ON 0
 uu_1                 5.188863e-02 1 1  ON 1
 uu_2                -4.347291e-02 1 1  ON 2
 uu_3                -9.917690e-02 1 1  ON 3
 uu_4                -1.336715e-01 1 1  ON 4
 uu_5                -1.420421e-01 1 1  ON 5
 uu_6                -1.194925e-01 1 1  ON 6
 uu_7                -4.832611e-02 1 1  ON 7
 uu_8                 9.323945e-02 1 1  ON 8
 uu_9                 1.269321e-01 1 1  ON 9
 ud_0                 3.558923e-01 1 1  ON 10
 ud_1                 9.668699e-02 1 1  ON 11
 ud_2                -1.381766e-02 1 1  ON 12
 ud_3                -7.552012e-02 1 1  ON 13
 ud_4                -1.235184e-01 1 1  ON 14
 ud_5                -1.556603e-01 1 1  ON 15
 ud_6                -1.571741e-01 1 1  ON 16
 ud_7                -1.129665e-01 1 1  ON 17
 ud_8                -5.189135e-03 1 1  ON 18
 ud_9                 9.269348e-02 1 1  ON 19
 eO_0                -7.852917e-01 1 1  ON 20
 eO_1                -4.631595e-01 1 1  ON 21
 eO_2                -5.024290e-02 1 1  ON 22
 eO_3                 2.105584e-01 1 1  ON 23
 eO_4                 3.121415e-01 1 1  ON 24
 eO_5                 3.273544e-01 1 1  ON 25
 eO_6                 2.631643e-01 1 1  ON 26
 eO_7                 1.250730e-01 1 1  ON 27
 eO_8                 3.001653e-02 1 1  ON 28
 eO_9                 1.911401e-02 1 1  ON 29
eH1_0                -1.844587e-01 1 1  ON 30
eH1_1                -1.050370e-01 1 1  ON 31
eH1_2                -6.366462e-02 1 1  ON 32
eH1_3                -2.656587e-02 1 1  ON 33
eH1_4                 1.886505e-02 1 1  ON 34
eH1_5                 3.300148e-02 1 1  ON 35
eH1_6                 7.763949e-02 1 1  ON 36
eH1_7                 1.098003e-01 1 1  ON 37
eH1_8                 9.782120e-02 1 1  ON 38
eH1_9                 2.655846e-02 1 1  ON 39
eH2_0                -1.858505e-01 1 1  ON 40
eH2_1                -1.065774e-01 1 1  ON 41
eH2_2                -6.503902e-02 1 1  ON 42
eH2_3                -2.796399e-02 1 1  ON 43
eH2_4                 1.735057e-02 1 1  ON 44
eH2_5                 3.158052e-02 1 1  ON 45
eH2_6                 7.943840e-02 1 1  ON 46
eH2_7                 1.142626e-01 1 1  ON 47
eH2_8                 1.010522e-01 1 1  ON 48
eH2_9                 2.883899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1909
    reference variance = 0.235736
====================================================
  Execution time = 2.0402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318195504528
                                         uncertainty =       0.003431841073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318195504528
                                         uncertainty =       0.003431841073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398852295
  error estimate for blocks of size 2^( 2) =       0.000408370624
  error estimate for blocks of size 2^( 3) =       0.000417182372
  error estimate for blocks of size 2^( 4) =       0.000423649533
  error estimate for blocks of size 2^( 5) =       0.000428333255
  error estimate for blocks of size 2^( 6) =       0.000430998366
  error estimate for blocks of size 2^( 7) =       0.000432501875

      target function =                  N/A
              le_mean =     -17.217266163679
             les_mean =     296.752420298018
             stat err =       0.000428870757
             autocorr =       1.156188589705
              std dev =       0.564062324702
             le_variance =       0.318166306149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726616368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266163679       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217267486624       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217267142212       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217269677116       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217270036853       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217270628788       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217270832213       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217271290325       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217271838321       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217271581050       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217271960814       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217272086005       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.437038e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266163679       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266913149       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266751746       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217267827964       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217268243393       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217268330092       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217268283917       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217268365395       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217268461503       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.377736e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266163679       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266437815       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266388092       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266675092       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217266878437       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217266895105       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217266859664       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217266885062       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.010703e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6005e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.147054e-01 1 1  ON 0
 uu_1                 5.206676e-02 1 1  ON 1
 uu_2                -4.347064e-02 1 1  ON 2
 uu_3                -9.932153e-02 1 1  ON 3
 uu_4                -1.338577e-01 1 1  ON 4
 uu_5                -1.418816e-01 1 1  ON 5
 uu_6                -1.197985e-01 1 1  ON 6
 uu_7                -4.857180e-02 1 1  ON 7
 uu_8                 9.306429e-02 1 1  ON 8
 uu_9                 1.270515e-01 1 1  ON 9
 ud_0                 3.558445e-01 1 1  ON 10
 ud_1                 9.679006e-02 1 1  ON 11
 ud_2                -1.378087e-02 1 1  ON 12
 ud_3                -7.550007e-02 1 1  ON 13
 ud_4                -1.236782e-01 1 1  ON 14
 ud_5                -1.555256e-01 1 1  ON 15
 ud_6                -1.571519e-01 1 1  ON 16
 ud_7                -1.129214e-01 1 1  ON 17
 ud_8                -5.413880e-03 1 1  ON 18
 ud_9                 9.267383e-02 1 1  ON 19
 eO_0                -7.860294e-01 1 1  ON 20
 eO_1                -4.635947e-01 1 1  ON 21
 eO_2                -5.044087e-02 1 1  ON 22
 eO_3                 2.108231e-01 1 1  ON 23
 eO_4                 3.122627e-01 1 1  ON 24
 eO_5                 3.277375e-01 1 1  ON 25
 eO_6                 2.634096e-01 1 1  ON 26
 eO_7                 1.253786e-01 1 1  ON 27
 eO_8                 3.005310e-02 1 1  ON 28
 eO_9                 1.912173e-02 1 1  ON 29
eH1_0                -1.846883e-01 1 1  ON 30
eH1_1                -1.050599e-01 1 1  ON 31
eH1_2                -6.371720e-02 1 1  ON 32
eH1_3                -2.638652e-02 1 1  ON 33
eH1_4                 1.889155e-02 1 1  ON 34
eH1_5                 3.287973e-02 1 1  ON 35
eH1_6                 7.758110e-02 1 1  ON 36
eH1_7                 1.097958e-01 1 1  ON 37
eH1_8                 9.800811e-02 1 1  ON 38
eH1_9                 2.663636e-02 1 1  ON 39
eH2_0                -1.858631e-01 1 1  ON 40
eH2_1                -1.066916e-01 1 1  ON 41
eH2_2                -6.517273e-02 1 1  ON 42
eH2_3                -2.791792e-02 1 1  ON 43
eH2_4                 1.753002e-02 1 1  ON 44
eH2_5                 3.152993e-02 1 1  ON 45
eH2_6                 7.933885e-02 1 1  ON 46
eH2_7                 1.142368e-01 1 1  ON 47
eH2_8                 1.012092e-01 1 1  ON 48
eH2_9                 2.888550e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2171
    reference variance = 0.268802
====================================================
  Execution time = 2.1761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4631e-01
  Total weights = 2.0000e+06
  Execution time = 1.8156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346261544309
                                         uncertainty =       0.017886804559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346261544309
                                         uncertainty =       0.017886804559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416047817
  error estimate for blocks of size 2^( 2) =       0.000424881694
  error estimate for blocks of size 2^( 3) =       0.000432892421
  error estimate for blocks of size 2^( 4) =       0.000439424399
  error estimate for blocks of size 2^( 5) =       0.000443488412
  error estimate for blocks of size 2^( 6) =       0.000446880491
  error estimate for blocks of size 2^( 7) =       0.000446734614

      target function =                  N/A
              le_mean =     -17.217071277064
             les_mean =     296.773734758154
             stat err =       0.000444131979
             autocorr =       1.139561046069
              std dev =       0.588380465124
             le_variance =       0.346191571739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346582951523
                                         uncertainty =       0.017940403722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346582951523
                                         uncertainty =       0.017940403722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416240765
  error estimate for blocks of size 2^( 2) =       0.000425065523
  error estimate for blocks of size 2^( 3) =       0.000433067938
  error estimate for blocks of size 2^( 4) =       0.000439595763
  error estimate for blocks of size 2^( 5) =       0.000443654427
  error estimate for blocks of size 2^( 6) =       0.000447050087
  error estimate for blocks of size 2^( 7) =       0.000446918314

      target function =                  N/A
              le_mean =     -17.217069466159
             les_mean =     296.773993578458
             stat err =       0.000444304648
             autocorr =       1.139390227426
              std dev =       0.588653335319
             le_variance =       0.346512749182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346500435706
                                         uncertainty =       0.017933181541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346500435706
                                         uncertainty =       0.017933181541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416191242
  error estimate for blocks of size 2^( 2) =       0.000425018524
  error estimate for blocks of size 2^( 3) =       0.000433024335
  error estimate for blocks of size 2^( 4) =       0.000439555571
  error estimate for blocks of size 2^( 5) =       0.000443615453
  error estimate for blocks of size 2^( 6) =       0.000447009523
  error estimate for blocks of size 2^( 7) =       0.000446881471

      target function =                  N/A
              le_mean =     -17.217069608860
             les_mean =     296.773916042365
             stat err =       0.000444265504
             autocorr =       1.139460600556
              std dev =       0.588583298476
             le_variance =       0.346430299245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346274724286
                                         uncertainty =       0.017893688030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346274724286
                                         uncertainty =       0.017893688030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416055728
  error estimate for blocks of size 2^( 2) =       0.000424889166
  error estimate for blocks of size 2^( 3) =       0.000432899655
  error estimate for blocks of size 2^( 4) =       0.000439431907
  error estimate for blocks of size 2^( 5) =       0.000443495581
  error estimate for blocks of size 2^( 6) =       0.000446887751
  error estimate for blocks of size 2^( 7) =       0.000446744995

      target function =                  N/A
              le_mean =     -17.217070734025
             les_mean =     296.773729225507
             stat err =       0.000444140058
             autocorr =       1.139559165416
              std dev =       0.588391653727
             le_variance =       0.346204738176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217071277064        initial  <--
     9.5367e-02     9.5367e-01             2.4370e-03       -17.217069466159
     3.8147e-01     3.8147e+00             7.3777e-04       -17.217069608860
     1.5259e+00     1.5259e+01             2.0107e-04       -17.217070734025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9327
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.142528e-01 1 1  ON 0
 uu_1                 5.188863e-02 1 1  ON 1
 uu_2                -4.347291e-02 1 1  ON 2
 uu_3                -9.917690e-02 1 1  ON 3
 uu_4                -1.336715e-01 1 1  ON 4
 uu_5                -1.420421e-01 1 1  ON 5
 uu_6                -1.194925e-01 1 1  ON 6
 uu_7                -4.832611e-02 1 1  ON 7
 uu_8                 9.323945e-02 1 1  ON 8
 uu_9                 1.269321e-01 1 1  ON 9
 ud_0                 3.558923e-01 1 1  ON 10
 ud_1                 9.668699e-02 1 1  ON 11
 ud_2                -1.381766e-02 1 1  ON 12
 ud_3                -7.552012e-02 1 1  ON 13
 ud_4                -1.235184e-01 1 1  ON 14
 ud_5                -1.556603e-01 1 1  ON 15
 ud_6                -1.571741e-01 1 1  ON 16
 ud_7                -1.129665e-01 1 1  ON 17
 ud_8                -5.189135e-03 1 1  ON 18
 ud_9                 9.269348e-02 1 1  ON 19
 eO_0                -7.852917e-01 1 1  ON 20
 eO_1                -4.631595e-01 1 1  ON 21
 eO_2                -5.024290e-02 1 1  ON 22
 eO_3                 2.105584e-01 1 1  ON 23
 eO_4                 3.121415e-01 1 1  ON 24
 eO_5                 3.273544e-01 1 1  ON 25
 eO_6                 2.631643e-01 1 1  ON 26
 eO_7                 1.250730e-01 1 1  ON 27
 eO_8                 3.001653e-02 1 1  ON 28
 eO_9                 1.911401e-02 1 1  ON 29
eH1_0                -1.844587e-01 1 1  ON 30
eH1_1                -1.050370e-01 1 1  ON 31
eH1_2                -6.366462e-02 1 1  ON 32
eH1_3                -2.656587e-02 1 1  ON 33
eH1_4                 1.886505e-02 1 1  ON 34
eH1_5                 3.300148e-02 1 1  ON 35
eH1_6                 7.763949e-02 1 1  ON 36
eH1_7                 1.098003e-01 1 1  ON 37
eH1_8                 9.782120e-02 1 1  ON 38
eH1_9                 2.655846e-02 1 1  ON 39
eH2_0                -1.858505e-01 1 1  ON 40
eH2_1                -1.065774e-01 1 1  ON 41
eH2_2                -6.503902e-02 1 1  ON 42
eH2_3                -2.796399e-02 1 1  ON 43
eH2_4                 1.735057e-02 1 1  ON 44
eH2_5                 3.158052e-02 1 1  ON 45
eH2_6                 7.943840e-02 1 1  ON 46
eH2_7                 1.142626e-01 1 1  ON 47
eH2_8                 1.010522e-01 1 1  ON 48
eH2_9                 2.883899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.269134
====================================================
  Execution time = 2.0572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327534206694
                                         uncertainty =       0.011135538417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327534206694
                                         uncertainty =       0.011135538417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404674808
  error estimate for blocks of size 2^( 2) =       0.000414392311
  error estimate for blocks of size 2^( 3) =       0.000423098212
  error estimate for blocks of size 2^( 4) =       0.000429628178
  error estimate for blocks of size 2^( 5) =       0.000434034471
  error estimate for blocks of size 2^( 6) =       0.000435318733
  error estimate for blocks of size 2^( 7) =       0.000437383001

      target function =                  N/A
              le_mean =     -17.216374872157
             les_mean =     296.731086974620
             stat err =       0.000434091096
             autocorr =       1.150666361616
              std dev =       0.572296601203
             le_variance =       0.327523399748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637487216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374872157       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374678810       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374399280       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374205831       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374758221       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216375003077       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216375062492       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216375073912       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.034152e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374872157       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374816747       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374738337       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374684463       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374838490       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374904728       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216374910227       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.622992e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374872157       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374857778       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374837441       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374823690       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374863465       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374880660       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216374881616       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.916459e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6381e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.142904e-01 1 1  ON 0
 uu_1                 5.192140e-02 1 1  ON 1
 uu_2                -4.348757e-02 1 1  ON 2
 uu_3                -9.919584e-02 1 1  ON 3
 uu_4                -1.336886e-01 1 1  ON 4
 uu_5                -1.420486e-01 1 1  ON 5
 uu_6                -1.194990e-01 1 1  ON 6
 uu_7                -4.834409e-02 1 1  ON 7
 uu_8                 9.322258e-02 1 1  ON 8
 uu_9                 1.269456e-01 1 1  ON 9
 ud_0                 3.559002e-01 1 1  ON 10
 ud_1                 9.669114e-02 1 1  ON 11
 ud_2                -1.382386e-02 1 1  ON 12
 ud_3                -7.551831e-02 1 1  ON 13
 ud_4                -1.235352e-01 1 1  ON 14
 ud_5                -1.556395e-01 1 1  ON 15
 ud_6                -1.571700e-01 1 1  ON 16
 ud_7                -1.129628e-01 1 1  ON 17
 ud_8                -5.211740e-03 1 1  ON 18
 ud_9                 9.268755e-02 1 1  ON 19
 eO_0                -7.853679e-01 1 1  ON 20
 eO_1                -4.632269e-01 1 1  ON 21
 eO_2                -5.024860e-02 1 1  ON 22
 eO_3                 2.105592e-01 1 1  ON 23
 eO_4                 3.121748e-01 1 1  ON 24
 eO_5                 3.273910e-01 1 1  ON 25
 eO_6                 2.632039e-01 1 1  ON 26
 eO_7                 1.251064e-01 1 1  ON 27
 eO_8                 3.002103e-02 1 1  ON 28
 eO_9                 1.911468e-02 1 1  ON 29
eH1_0                -1.844714e-01 1 1  ON 30
eH1_1                -1.050431e-01 1 1  ON 31
eH1_2                -6.366302e-02 1 1  ON 32
eH1_3                -2.654214e-02 1 1  ON 33
eH1_4                 1.888003e-02 1 1  ON 34
eH1_5                 3.298877e-02 1 1  ON 35
eH1_6                 7.762174e-02 1 1  ON 36
eH1_7                 1.097886e-01 1 1  ON 37
eH1_8                 9.783653e-02 1 1  ON 38
eH1_9                 2.656303e-02 1 1  ON 39
eH2_0                -1.858396e-01 1 1  ON 40
eH2_1                -1.065797e-01 1 1  ON 41
eH2_2                -6.505154e-02 1 1  ON 42
eH2_3                -2.796545e-02 1 1  ON 43
eH2_4                 1.734561e-02 1 1  ON 44
eH2_5                 3.156677e-02 1 1  ON 45
eH2_6                 7.943835e-02 1 1  ON 46
eH2_7                 1.142629e-01 1 1  ON 47
eH2_8                 1.010699e-01 1 1  ON 48
eH2_9                 2.884408e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1649
    reference variance = 0.230869
====================================================
  Execution time = 1.9529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1383e-01
  Total weights = 2.0000e+06
  Execution time = 1.8160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313715686752
                                         uncertainty =       0.003001550228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313715686752
                                         uncertainty =       0.003001550228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396107643
  error estimate for blocks of size 2^( 2) =       0.000406077366
  error estimate for blocks of size 2^( 3) =       0.000414707277
  error estimate for blocks of size 2^( 4) =       0.000421529909
  error estimate for blocks of size 2^( 5) =       0.000425066175
  error estimate for blocks of size 2^( 6) =       0.000428010468
  error estimate for blocks of size 2^( 7) =       0.000427962658

      target function =                  N/A
              le_mean =     -17.216423405988
             les_mean =     296.719037267757
             stat err =       0.000425642302
             autocorr =       1.154683930442
              std dev =       0.560180801542
             le_variance =       0.313802530417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313817646174
                                         uncertainty =       0.003002178659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313817646174
                                         uncertainty =       0.003002178659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396172013
  error estimate for blocks of size 2^( 2) =       0.000406139121
  error estimate for blocks of size 2^( 3) =       0.000414765673
  error estimate for blocks of size 2^( 4) =       0.000421585989
  error estimate for blocks of size 2^( 5) =       0.000425121726
  error estimate for blocks of size 2^( 6) =       0.000428066193
  error estimate for blocks of size 2^( 7) =       0.000428015802

      target function =                  N/A
              le_mean =     -17.216423982277
             les_mean =     296.719159108077
             stat err =       0.000425697427
             autocorr =       1.154607747482
              std dev =       0.560271833597
             le_variance =       0.313904527522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313776637527
                                         uncertainty =       0.003001905361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313776637527
                                         uncertainty =       0.003001905361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396146122
  error estimate for blocks of size 2^( 2) =       0.000406114234
  error estimate for blocks of size 2^( 3) =       0.000414742200
  error estimate for blocks of size 2^( 4) =       0.000421563381
  error estimate for blocks of size 2^( 5) =       0.000425099297
  error estimate for blocks of size 2^( 6) =       0.000428043669
  error estimate for blocks of size 2^( 7) =       0.000427994288

      target function =                  N/A
              le_mean =     -17.216423724077
             les_mean =     296.719109190431
             stat err =       0.000425675159
             autocorr =       1.154637862393
              std dev =       0.560235218821
             le_variance =       0.313863500407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313723758895
                                         uncertainty =       0.003001596520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313723758895
                                         uncertainty =       0.003001596520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396112740
  error estimate for blocks of size 2^( 2) =       0.000406082247
  error estimate for blocks of size 2^( 3) =       0.000414711900
  error estimate for blocks of size 2^( 4) =       0.000421534335
  error estimate for blocks of size 2^( 5) =       0.000425070546
  error estimate for blocks of size 2^( 6) =       0.000428014846
  error estimate for blocks of size 2^( 7) =       0.000427966829

      target function =                  N/A
              le_mean =     -17.216423447063
             les_mean =     296.719046756483
             stat err =       0.000425646639
             autocorr =       1.154677748228
              std dev =       0.560188008458
             le_variance =       0.313810604820


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216423405988        initial
     9.5367e-01     9.5367e+00             3.0342e-04       -17.216423982277  <--
     3.8147e+00     3.8147e+01             7.6230e-05       -17.216423724077
     1.5259e+01     1.5259e+02             1.9165e-05       -17.216423447063

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.8706e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.143960e-01 1 1  ON 0
 uu_1                 5.199237e-02 1 1  ON 1
 uu_2                -4.351480e-02 1 1  ON 2
 uu_3                -9.924319e-02 1 1  ON 3
 uu_4                -1.337300e-01 1 1  ON 4
 uu_5                -1.420726e-01 1 1  ON 5
 uu_6                -1.195181e-01 1 1  ON 6
 uu_7                -4.839718e-02 1 1  ON 7
 uu_8                 9.317174e-02 1 1  ON 8
 uu_9                 1.269868e-01 1 1  ON 9
 ud_0                 3.559217e-01 1 1  ON 10
 ud_1                 9.670628e-02 1 1  ON 11
 ud_2                -1.383151e-02 1 1  ON 12
 ud_3                -7.551824e-02 1 1  ON 13
 ud_4                -1.235723e-01 1 1  ON 14
 ud_5                -1.555980e-01 1 1  ON 15
 ud_6                -1.571584e-01 1 1  ON 16
 ud_7                -1.129496e-01 1 1  ON 17
 ud_8                -5.279836e-03 1 1  ON 18
 ud_9                 9.266961e-02 1 1  ON 19
 eO_0                -7.855951e-01 1 1  ON 20
 eO_1                -4.634111e-01 1 1  ON 21
 eO_2                -5.029443e-02 1 1  ON 22
 eO_3                 2.105645e-01 1 1  ON 23
 eO_4                 3.122747e-01 1 1  ON 24
 eO_5                 3.275023e-01 1 1  ON 25
 eO_6                 2.633256e-01 1 1  ON 26
 eO_7                 1.252083e-01 1 1  ON 27
 eO_8                 3.003481e-02 1 1  ON 28
 eO_9                 1.911673e-02 1 1  ON 29
eH1_0                -1.845086e-01 1 1  ON 30
eH1_1                -1.050582e-01 1 1  ON 31
eH1_2                -6.365680e-02 1 1  ON 32
eH1_3                -2.647778e-02 1 1  ON 33
eH1_4                 1.892386e-02 1 1  ON 34
eH1_5                 3.295227e-02 1 1  ON 35
eH1_6                 7.756799e-02 1 1  ON 36
eH1_7                 1.097534e-01 1 1  ON 37
eH1_8                 9.788333e-02 1 1  ON 38
eH1_9                 2.657699e-02 1 1  ON 39
eH2_0                -1.858110e-01 1 1  ON 40
eH2_1                -1.065903e-01 1 1  ON 41
eH2_2                -6.508504e-02 1 1  ON 42
eH2_3                -2.797235e-02 1 1  ON 43
eH2_4                 1.733318e-02 1 1  ON 44
eH2_5                 3.152756e-02 1 1  ON 45
eH2_6                 7.943822e-02 1 1  ON 46
eH2_7                 1.142643e-01 1 1  ON 47
eH2_8                 1.011238e-01 1 1  ON 48
eH2_9                 2.885960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.328815
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1535e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315341780083
                                         uncertainty =       0.003435840102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315341780083
                                         uncertainty =       0.003435840102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397083412
  error estimate for blocks of size 2^( 2) =       0.000406937736
  error estimate for blocks of size 2^( 3) =       0.000415600173
  error estimate for blocks of size 2^( 4) =       0.000421859624
  error estimate for blocks of size 2^( 5) =       0.000425471223
  error estimate for blocks of size 2^( 6) =       0.000428080863
  error estimate for blocks of size 2^( 7) =       0.000427542315

      target function =                  N/A
              le_mean =     -17.217114444638
             les_mean =     296.744380113480
             stat err =       0.000425738507
             autocorr =       1.149535468415
              std dev =       0.561560745946
             le_variance =       0.315350471388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711444464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114444638       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114834125       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114710027       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217113768031       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217113849162       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217115090428       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217114891572       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217115215856       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217114978255       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217115035630       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 9.434539e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114444638       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114586914       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114570702       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217114258600       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217114252159       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217114459549       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217114449684       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217114503375       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.698678e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114444638       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114484842       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114485174       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217114403721       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217114404098       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217114424287       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217114426112       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.059123e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5599e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.144082e-01 1 1  ON 0
 uu_1                 5.209333e-02 1 1  ON 1
 uu_2                -4.352054e-02 1 1  ON 2
 uu_3                -9.927771e-02 1 1  ON 3
 uu_4                -1.337891e-01 1 1  ON 4
 uu_5                -1.420763e-01 1 1  ON 5
 uu_6                -1.195903e-01 1 1  ON 6
 uu_7                -4.848190e-02 1 1  ON 7
 uu_8                 9.311248e-02 1 1  ON 8
 uu_9                 1.270594e-01 1 1  ON 9
 ud_0                 3.558782e-01 1 1  ON 10
 ud_1                 9.675732e-02 1 1  ON 11
 ud_2                -1.382378e-02 1 1  ON 12
 ud_3                -7.551189e-02 1 1  ON 13
 ud_4                -1.235958e-01 1 1  ON 14
 ud_5                -1.555581e-01 1 1  ON 15
 ud_6                -1.572716e-01 1 1  ON 16
 ud_7                -1.129615e-01 1 1  ON 17
 ud_8                -5.340110e-03 1 1  ON 18
 ud_9                 9.269959e-02 1 1  ON 19
 eO_0                -7.858649e-01 1 1  ON 20
 eO_1                -4.635737e-01 1 1  ON 21
 eO_2                -5.033826e-02 1 1  ON 22
 eO_3                 2.105409e-01 1 1  ON 23
 eO_4                 3.122861e-01 1 1  ON 24
 eO_5                 3.276897e-01 1 1  ON 25
 eO_6                 2.634232e-01 1 1  ON 26
 eO_7                 1.253413e-01 1 1  ON 27
 eO_8                 3.006657e-02 1 1  ON 28
 eO_9                 1.913350e-02 1 1  ON 29
eH1_0                -1.845443e-01 1 1  ON 30
eH1_1                -1.050716e-01 1 1  ON 31
eH1_2                -6.369225e-02 1 1  ON 32
eH1_3                -2.648185e-02 1 1  ON 33
eH1_4                 1.894609e-02 1 1  ON 34
eH1_5                 3.286599e-02 1 1  ON 35
eH1_6                 7.757050e-02 1 1  ON 36
eH1_7                 1.097495e-01 1 1  ON 37
eH1_8                 9.797203e-02 1 1  ON 38
eH1_9                 2.661704e-02 1 1  ON 39
eH2_0                -1.859081e-01 1 1  ON 40
eH2_1                -1.066071e-01 1 1  ON 41
eH2_2                -6.509663e-02 1 1  ON 42
eH2_3                -2.798316e-02 1 1  ON 43
eH2_4                 1.740908e-02 1 1  ON 44
eH2_5                 3.159019e-02 1 1  ON 45
eH2_6                 7.939481e-02 1 1  ON 46
eH2_7                 1.142133e-01 1 1  ON 47
eH2_8                 1.011751e-01 1 1  ON 48
eH2_9                 2.888337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.15016
====================================================
  Execution time = 1.9585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1590e-01
  Total weights = 2.0000e+06
  Execution time = 1.8142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315869920167
                                         uncertainty =       0.003177090012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315869920167
                                         uncertainty =       0.003177090012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397437541
  error estimate for blocks of size 2^( 2) =       0.000407501389
  error estimate for blocks of size 2^( 3) =       0.000416303442
  error estimate for blocks of size 2^( 4) =       0.000423324368
  error estimate for blocks of size 2^( 5) =       0.000428021196
  error estimate for blocks of size 2^( 6) =       0.000430865938
  error estimate for blocks of size 2^( 7) =       0.000432512042

      target function =                  N/A
              le_mean =     -17.217037482369
             les_mean =     296.742292710010
             stat err =       0.000428680886
             autocorr =       1.163403763014
              std dev =       0.562061561267
             le_variance =       0.315913198653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315905086423
                                         uncertainty =       0.003179215776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315905086423
                                         uncertainty =       0.003179215776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397459735
  error estimate for blocks of size 2^( 2) =       0.000407522385
  error estimate for blocks of size 2^( 3) =       0.000416321278
  error estimate for blocks of size 2^( 4) =       0.000423340123
  error estimate for blocks of size 2^( 5) =       0.000428036079
  error estimate for blocks of size 2^( 6) =       0.000430876015
  error estimate for blocks of size 2^( 7) =       0.000432522767

      target function =                  N/A
              le_mean =     -17.217038628399
             les_mean =     296.742367456343
             stat err =       0.000428693746
             autocorr =       1.163343632949
              std dev =       0.562092948293
             le_variance =       0.315948482521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315840862234
                                         uncertainty =       0.003178122198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315840862234
                                         uncertainty =       0.003178122198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397419352
  error estimate for blocks of size 2^( 2) =       0.000407483522
  error estimate for blocks of size 2^( 3) =       0.000416284053
  error estimate for blocks of size 2^( 4) =       0.000423304388
  error estimate for blocks of size 2^( 5) =       0.000428000702
  error estimate for blocks of size 2^( 6) =       0.000430842702
  error estimate for blocks of size 2^( 7) =       0.000432487745

      target function =                  N/A
              le_mean =     -17.217038309312
             les_mean =     296.742292269226
             stat err =       0.000428658884
             autocorr =       1.163390829356
              std dev =       0.562035837694
             le_variance =       0.315884282853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315858794621
                                         uncertainty =       0.003177174263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315858794621
                                         uncertainty =       0.003177174263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397430559
  error estimate for blocks of size 2^( 2) =       0.000407494584
  error estimate for blocks of size 2^( 3) =       0.000416296536
  error estimate for blocks of size 2^( 4) =       0.000423317485
  error estimate for blocks of size 2^( 5) =       0.000428014271
  error estimate for blocks of size 2^( 6) =       0.000430858673
  error estimate for blocks of size 2^( 7) =       0.000432504495

      target function =                  N/A
              le_mean =     -17.217037594034
             les_mean =     296.742285455008
             stat err =       0.000428673731
             autocorr =       1.163405804965
              std dev =       0.562051686743
             le_variance =       0.315902098570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217037482369        initial
     2.3842e-01     2.3842e+00             9.4345e-04       -17.217038628399  <--
     9.5367e-01     9.5367e+00             2.6987e-04       -17.217038309312
     3.8147e+00     3.8147e+01             7.0591e-05       -17.217037594034

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.8775e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.145260e-01 1 1  ON 0
 uu_1                 5.224179e-02 1 1  ON 1
 uu_2                -4.350626e-02 1 1  ON 2
 uu_3                -9.934928e-02 1 1  ON 3
 uu_4                -1.339305e-01 1 1  ON 4
 uu_5                -1.421476e-01 1 1  ON 5
 uu_6                -1.197845e-01 1 1  ON 6
 uu_7                -4.872628e-02 1 1  ON 7
 uu_8                 9.293350e-02 1 1  ON 8
 uu_9                 1.272775e-01 1 1  ON 9
 ud_0                 3.558901e-01 1 1  ON 10
 ud_1                 9.683362e-02 1 1  ON 11
 ud_2                -1.379780e-02 1 1  ON 12
 ud_3                -7.551047e-02 1 1  ON 13
 ud_4                -1.236384e-01 1 1  ON 14
 ud_5                -1.555621e-01 1 1  ON 15
 ud_6                -1.575645e-01 1 1  ON 16
 ud_7                -1.129965e-01 1 1  ON 17
 ud_8                -5.524294e-03 1 1  ON 18
 ud_9                 9.278925e-02 1 1  ON 19
 eO_0                -7.865385e-01 1 1  ON 20
 eO_1                -4.640605e-01 1 1  ON 21
 eO_2                -5.057955e-02 1 1  ON 22
 eO_3                 2.104403e-01 1 1  ON 23
 eO_4                 3.123166e-01 1 1  ON 24
 eO_5                 3.282473e-01 1 1  ON 25
 eO_6                 2.637231e-01 1 1  ON 26
 eO_7                 1.257429e-01 1 1  ON 27
 eO_8                 3.016210e-02 1 1  ON 28
 eO_9                 1.918397e-02 1 1  ON 29
eH1_0                -1.846302e-01 1 1  ON 30
eH1_1                -1.051296e-01 1 1  ON 31
eH1_2                -6.377360e-02 1 1  ON 32
eH1_3                -2.652693e-02 1 1  ON 33
eH1_4                 1.897627e-02 1 1  ON 34
eH1_5                 3.264889e-02 1 1  ON 35
eH1_6                 7.757514e-02 1 1  ON 36
eH1_7                 1.097369e-01 1 1  ON 37
eH1_8                 9.823995e-02 1 1  ON 38
eH1_9                 2.673781e-02 1 1  ON 39
eH2_0                -1.861308e-01 1 1  ON 40
eH2_1                -1.066472e-01 1 1  ON 41
eH2_2                -6.513424e-02 1 1  ON 42
eH2_3                -2.800008e-02 1 1  ON 43
eH2_4                 1.753785e-02 1 1  ON 44
eH2_5                 3.177140e-02 1 1  ON 45
eH2_6                 7.927511e-02 1 1  ON 46
eH2_7                 1.140621e-01 1 1  ON 47
eH2_8                 1.013299e-01 1 1  ON 48
eH2_9                 2.895488e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2767
    reference variance = 0.884755
====================================================
  Execution time = 2.0026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323305023860
                                         uncertainty =       0.004831057383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323305023860
                                         uncertainty =       0.004831057383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402088614
  error estimate for blocks of size 2^( 2) =       0.000411635053
  error estimate for blocks of size 2^( 3) =       0.000420713488
  error estimate for blocks of size 2^( 4) =       0.000427537723
  error estimate for blocks of size 2^( 5) =       0.000432248900
  error estimate for blocks of size 2^( 6) =       0.000435864363
  error estimate for blocks of size 2^( 7) =       0.000435296249

      target function =                  N/A
              le_mean =     -17.217046919910
             les_mean =     296.750054987572
             stat err =       0.000432736809
             autocorr =       1.158254846255
              std dev =       0.568639171071
             le_variance =       0.323350506877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704691991e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046919910       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217046138792       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044553003       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217044715696       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217044152309       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217046584763       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217048917696       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217050795978       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217051452484       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217050227189       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217049736422       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217049619430       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.973666e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046919910       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217046436439       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044954862       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217045409089       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217045697085       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217046113577       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217047007784       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217047247458       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217047215856       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217047085102       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.260685e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046919910       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217046728376       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217046180735       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217046182340       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217046442889       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217046599543       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217046690423       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217046670426       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.574522e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5580e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.149044e-01 1 1  ON 0
 uu_1                 5.224616e-02 1 1  ON 1
 uu_2                -4.345965e-02 1 1  ON 2
 uu_3                -9.953340e-02 1 1  ON 3
 uu_4                -1.339695e-01 1 1  ON 4
 uu_5                -1.421348e-01 1 1  ON 5
 uu_6                -1.200695e-01 1 1  ON 6
 uu_7                -4.902675e-02 1 1  ON 7
 uu_8                 9.264222e-02 1 1  ON 8
 uu_9                 1.274953e-01 1 1  ON 9
 ud_0                 3.561979e-01 1 1  ON 10
 ud_1                 9.686984e-02 1 1  ON 11
 ud_2                -1.386494e-02 1 1  ON 12
 ud_3                -7.565394e-02 1 1  ON 13
 ud_4                -1.238339e-01 1 1  ON 14
 ud_5                -1.558750e-01 1 1  ON 15
 ud_6                -1.573541e-01 1 1  ON 16
 ud_7                -1.128707e-01 1 1  ON 17
 ud_8                -5.795073e-03 1 1  ON 18
 ud_9                 9.281969e-02 1 1  ON 19
 eO_0                -7.877992e-01 1 1  ON 20
 eO_1                -4.647857e-01 1 1  ON 21
 eO_2                -5.093165e-02 1 1  ON 22
 eO_3                 2.106829e-01 1 1  ON 23
 eO_4                 3.123661e-01 1 1  ON 24
 eO_5                 3.288950e-01 1 1  ON 25
 eO_6                 2.643569e-01 1 1  ON 26
 eO_7                 1.263251e-01 1 1  ON 27
 eO_8                 3.026660e-02 1 1  ON 28
 eO_9                 1.921912e-02 1 1  ON 29
eH1_0                -1.847026e-01 1 1  ON 30
eH1_1                -1.052019e-01 1 1  ON 31
eH1_2                -6.383140e-02 1 1  ON 32
eH1_3                -2.662325e-02 1 1  ON 33
eH1_4                 1.891753e-02 1 1  ON 34
eH1_5                 3.271352e-02 1 1  ON 35
eH1_6                 7.756443e-02 1 1  ON 36
eH1_7                 1.096303e-01 1 1  ON 37
eH1_8                 9.851414e-02 1 1  ON 38
eH1_9                 2.684558e-02 1 1  ON 39
eH2_0                -1.863321e-01 1 1  ON 40
eH2_1                -1.066886e-01 1 1  ON 41
eH2_2                -6.515576e-02 1 1  ON 42
eH2_3                -2.811444e-02 1 1  ON 43
eH2_4                 1.746561e-02 1 1  ON 44
eH2_5                 3.145869e-02 1 1  ON 45
eH2_6                 7.930539e-02 1 1  ON 46
eH2_7                 1.142469e-01 1 1  ON 47
eH2_8                 1.017225e-01 1 1  ON 48
eH2_9                 2.907309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.458648
====================================================
  Execution time = 1.9752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1918e-01
  Total weights = 2.0000e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318804722091
                                         uncertainty =       0.003034492828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318804722091
                                         uncertainty =       0.003034492828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399237399
  error estimate for blocks of size 2^( 2) =       0.000409100768
  error estimate for blocks of size 2^( 3) =       0.000417989204
  error estimate for blocks of size 2^( 4) =       0.000423826787
  error estimate for blocks of size 2^( 5) =       0.000427743477
  error estimate for blocks of size 2^( 6) =       0.000429196163
  error estimate for blocks of size 2^( 7) =       0.000430630068

      target function =                  N/A
              le_mean =     -17.216372329885
             les_mean =     296.722257042607
             stat err =       0.000427849124
             autocorr =       1.148467895269
              std dev =       0.564606943618
             le_variance =       0.318781000781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577703911
                                         uncertainty =       0.003043038913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577703911
                                         uncertainty =       0.003043038913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399721065
  error estimate for blocks of size 2^( 2) =       0.000409562757
  error estimate for blocks of size 2^( 3) =       0.000418431775
  error estimate for blocks of size 2^( 4) =       0.000424254230
  error estimate for blocks of size 2^( 5) =       0.000428157296
  error estimate for blocks of size 2^( 6) =       0.000429599516
  error estimate for blocks of size 2^( 7) =       0.000431042583

      target function =                  N/A
              le_mean =     -17.216374604908
             les_mean =     296.723108235807
             stat err =       0.000428263406
             autocorr =       1.147910063460
              std dev =       0.565290950819
             le_variance =       0.319553859078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319608115050
                                         uncertainty =       0.003042850978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319608115050
                                         uncertainty =       0.003042850978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399740085
  error estimate for blocks of size 2^( 2) =       0.000409580404
  error estimate for blocks of size 2^( 3) =       0.000418451293
  error estimate for blocks of size 2^( 4) =       0.000424273933
  error estimate for blocks of size 2^( 5) =       0.000428176272
  error estimate for blocks of size 2^( 6) =       0.000429620852
  error estimate for blocks of size 2^( 7) =       0.000431064220

      target function =                  N/A
              le_mean =     -17.216374704258
             les_mean =     296.723142068709
             stat err =       0.000428283819
             autocorr =       1.147910248392
              std dev =       0.565317849598
             le_variance =       0.319584271074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318966508964
                                         uncertainty =       0.003036057213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318966508964
                                         uncertainty =       0.003036057213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399338683
  error estimate for blocks of size 2^( 2) =       0.000409197216
  error estimate for blocks of size 2^( 3) =       0.000418082295
  error estimate for blocks of size 2^( 4) =       0.000423916744
  error estimate for blocks of size 2^( 5) =       0.000427830402
  error estimate for blocks of size 2^( 6) =       0.000429281536
  error estimate for blocks of size 2^( 7) =       0.000430717153

      target function =                  N/A
              le_mean =     -17.216372603743
             les_mean =     296.722428238700
             stat err =       0.000427936459
             autocorr =       1.148354072963
              std dev =       0.564750181285
             le_variance =       0.318942767261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216372329885        initial
     5.9605e-02     5.9605e-01             3.9737e-03       -17.216374604908
     2.3842e-01     2.3842e+00             1.2607e-03       -17.216374704258  <--
     9.5367e-01     9.5367e+00             3.5745e-04       -17.216372603743

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.8919e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.149044e-01 1 1  ON 0
 uu_1                 5.224616e-02 1 1  ON 1
 uu_2                -4.345965e-02 1 1  ON 2
 uu_3                -9.953340e-02 1 1  ON 3
 uu_4                -1.339695e-01 1 1  ON 4
 uu_5                -1.421348e-01 1 1  ON 5
 uu_6                -1.200695e-01 1 1  ON 6
 uu_7                -4.902675e-02 1 1  ON 7
 uu_8                 9.264222e-02 1 1  ON 8
 uu_9                 1.274953e-01 1 1  ON 9
 ud_0                 3.561979e-01 1 1  ON 10
 ud_1                 9.686984e-02 1 1  ON 11
 ud_2                -1.386494e-02 1 1  ON 12
 ud_3                -7.565394e-02 1 1  ON 13
 ud_4                -1.238339e-01 1 1  ON 14
 ud_5                -1.558750e-01 1 1  ON 15
 ud_6                -1.573541e-01 1 1  ON 16
 ud_7                -1.128707e-01 1 1  ON 17
 ud_8                -5.795073e-03 1 1  ON 18
 ud_9                 9.281969e-02 1 1  ON 19
 eO_0                -7.877992e-01 1 1  ON 20
 eO_1                -4.647857e-01 1 1  ON 21
 eO_2                -5.093165e-02 1 1  ON 22
 eO_3                 2.106829e-01 1 1  ON 23
 eO_4                 3.123661e-01 1 1  ON 24
 eO_5                 3.288950e-01 1 1  ON 25
 eO_6                 2.643569e-01 1 1  ON 26
 eO_7                 1.263251e-01 1 1  ON 27
 eO_8                 3.026660e-02 1 1  ON 28
 eO_9                 1.921912e-02 1 1  ON 29
eH1_0                -1.847026e-01 1 1  ON 30
eH1_1                -1.052019e-01 1 1  ON 31
eH1_2                -6.383140e-02 1 1  ON 32
eH1_3                -2.662325e-02 1 1  ON 33
eH1_4                 1.891753e-02 1 1  ON 34
eH1_5                 3.271352e-02 1 1  ON 35
eH1_6                 7.756443e-02 1 1  ON 36
eH1_7                 1.096303e-01 1 1  ON 37
eH1_8                 9.851414e-02 1 1  ON 38
eH1_9                 2.684558e-02 1 1  ON 39
eH2_0                -1.863321e-01 1 1  ON 40
eH2_1                -1.066886e-01 1 1  ON 41
eH2_2                -6.515576e-02 1 1  ON 42
eH2_3                -2.811444e-02 1 1  ON 43
eH2_4                 1.746561e-02 1 1  ON 44
eH2_5                 3.145869e-02 1 1  ON 45
eH2_6                 7.930539e-02 1 1  ON 46
eH2_7                 1.142469e-01 1 1  ON 47
eH2_8                 1.017225e-01 1 1  ON 48
eH2_9                 2.907309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2077
    reference variance = 0.268438
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321356240165
                                         uncertainty =       0.004075703962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321356240165
                                         uncertainty =       0.004075703962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400886379
  error estimate for blocks of size 2^( 2) =       0.000410272683
  error estimate for blocks of size 2^( 3) =       0.000418761300
  error estimate for blocks of size 2^( 4) =       0.000425367382
  error estimate for blocks of size 2^( 5) =       0.000430234214
  error estimate for blocks of size 2^( 6) =       0.000431827068
  error estimate for blocks of size 2^( 7) =       0.000432606512

      target function =                  N/A
              le_mean =     -17.216394259203
             les_mean =     296.725650906035
             stat err =       0.000430008794
             autocorr =       1.150567421931
              std dev =       0.566938954764
             le_variance =       0.321419778428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639425920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216394259203       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395910473       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216395421250       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216394027986       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216394052217       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216395502838       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216398573707       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216398896127       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216398872537       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216398391198       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216398372268       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216398198679       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 2.647222e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216394259203       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395371970       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216395171285       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216394406828       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216394219605       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216395305356       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216395889045       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216395921018       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216395654372       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.802439e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216394259203       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216394742079       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216394707274       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216394495071       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216394324741       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216394728647       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216394790076       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216394803375       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.816064e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5771e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.150915e-01 1 1  ON 0
 uu_1                 5.238690e-02 1 1  ON 1
 uu_2                -4.333563e-02 1 1  ON 2
 uu_3                -9.940392e-02 1 1  ON 3
 uu_4                -1.338781e-01 1 1  ON 4
 uu_5                -1.420984e-01 1 1  ON 5
 uu_6                -1.206544e-01 1 1  ON 6
 uu_7                -4.938084e-02 1 1  ON 7
 uu_8                 9.238835e-02 1 1  ON 8
 uu_9                 1.276963e-01 1 1  ON 9
 ud_0                 3.562730e-01 1 1  ON 10
 ud_1                 9.695837e-02 1 1  ON 11
 ud_2                -1.365019e-02 1 1  ON 12
 ud_3                -7.560249e-02 1 1  ON 13
 ud_4                -1.238397e-01 1 1  ON 14
 ud_5                -1.560724e-01 1 1  ON 15
 ud_6                -1.574969e-01 1 1  ON 16
 ud_7                -1.128495e-01 1 1  ON 17
 ud_8                -6.169340e-03 1 1  ON 18
 ud_9                 9.282834e-02 1 1  ON 19
 eO_0                -7.883072e-01 1 1  ON 20
 eO_1                -4.653876e-01 1 1  ON 21
 eO_2                -5.155350e-02 1 1  ON 22
 eO_3                 2.104214e-01 1 1  ON 23
 eO_4                 3.125434e-01 1 1  ON 24
 eO_5                 3.295753e-01 1 1  ON 25
 eO_6                 2.648174e-01 1 1  ON 26
 eO_7                 1.268318e-01 1 1  ON 27
 eO_8                 3.036912e-02 1 1  ON 28
 eO_9                 1.924089e-02 1 1  ON 29
eH1_0                -1.847848e-01 1 1  ON 30
eH1_1                -1.052581e-01 1 1  ON 31
eH1_2                -6.376014e-02 1 1  ON 32
eH1_3                -2.688752e-02 1 1  ON 33
eH1_4                 1.908521e-02 1 1  ON 34
eH1_5                 3.235556e-02 1 1  ON 35
eH1_6                 7.746165e-02 1 1  ON 36
eH1_7                 1.097692e-01 1 1  ON 37
eH1_8                 9.882436e-02 1 1  ON 38
eH1_9                 2.696195e-02 1 1  ON 39
eH2_0                -1.864128e-01 1 1  ON 40
eH2_1                -1.070260e-01 1 1  ON 41
eH2_2                -6.536174e-02 1 1  ON 42
eH2_3                -2.804980e-02 1 1  ON 43
eH2_4                 1.768685e-02 1 1  ON 44
eH2_5                 3.165077e-02 1 1  ON 45
eH2_6                 7.923731e-02 1 1  ON 46
eH2_7                 1.141040e-01 1 1  ON 47
eH2_8                 1.019516e-01 1 1  ON 48
eH2_9                 2.917868e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1599
    reference variance = 0.255901
====================================================
  Execution time = 1.9660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1924e-01
  Total weights = 2.0000e+06
  Execution time = 1.8347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319447380975
                                         uncertainty =       0.003605759544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319447380975
                                         uncertainty =       0.003605759544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399584457
  error estimate for blocks of size 2^( 2) =       0.000409091930
  error estimate for blocks of size 2^( 3) =       0.000417459004
  error estimate for blocks of size 2^( 4) =       0.000424606965
  error estimate for blocks of size 2^( 5) =       0.000428622608
  error estimate for blocks of size 2^( 6) =       0.000432047918
  error estimate for blocks of size 2^( 7) =       0.000433228665

      target function =                  N/A
              le_mean =     -17.216465962232
             les_mean =     296.726035545573
             stat err =       0.000429626539
             autocorr =       1.156019149142
              std dev =       0.565097758405
             le_variance =       0.319335476554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319402505735
                                         uncertainty =       0.003594213599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319402505735
                                         uncertainty =       0.003594213599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399556453
  error estimate for blocks of size 2^( 2) =       0.000409065449
  error estimate for blocks of size 2^( 3) =       0.000417429376
  error estimate for blocks of size 2^( 4) =       0.000424568655
  error estimate for blocks of size 2^( 5) =       0.000428589153
  error estimate for blocks of size 2^( 6) =       0.000432014767
  error estimate for blocks of size 2^( 7) =       0.000433197017

      target function =                  N/A
              le_mean =     -17.216466324876
             les_mean =     296.726003273515
             stat err =       0.000429592398
             autocorr =       1.155997452414
              std dev =       0.565058154157
             le_variance =       0.319290717580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319257971210
                                         uncertainty =       0.003592603931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319257971210
                                         uncertainty =       0.003592603931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399466051
  error estimate for blocks of size 2^( 2) =       0.000408981403
  error estimate for blocks of size 2^( 3) =       0.000417353033
  error estimate for blocks of size 2^( 4) =       0.000424496399
  error estimate for blocks of size 2^( 5) =       0.000428522317
  error estimate for blocks of size 2^( 6) =       0.000431947568
  error estimate for blocks of size 2^( 7) =       0.000433129092

      target function =                  N/A
              le_mean =     -17.216465561393
             les_mean =     296.725832519393
             stat err =       0.000429523844
             autocorr =       1.156151646503
              std dev =       0.564930307493
             le_variance =       0.319146252324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319403951711
                                         uncertainty =       0.003603139250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319403951711
                                         uncertainty =       0.003603139250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399557307
  error estimate for blocks of size 2^( 2) =       0.000409066754
  error estimate for blocks of size 2^( 3) =       0.000417435221
  error estimate for blocks of size 2^( 4) =       0.000424582440
  error estimate for blocks of size 2^( 5) =       0.000428600268
  error estimate for blocks of size 2^( 6) =       0.000432025145
  error estimate for blocks of size 2^( 7) =       0.000433205809

      target function =                  N/A
              le_mean =     -17.216465535216
             les_mean =     296.725977448174
             stat err =       0.000429603415
             autocorr =       1.156051807055
              std dev =       0.565059361948
             le_variance =       0.319292082525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216465962232        initial
     5.9605e-02     5.9605e-01             2.6472e-03       -17.216466324876  <--
     2.3842e-01     2.3842e+00             6.8024e-04       -17.216465561393
     9.5367e-01     9.5367e+00             1.8161e-04       -17.216465535216

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.8866e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.155562e-01 1 1  ON 0
 uu_1                 5.275454e-02 1 1  ON 1
 uu_2                -4.299167e-02 1 1  ON 2
 uu_3                -9.916424e-02 1 1  ON 3
 uu_4                -1.337763e-01 1 1  ON 4
 uu_5                -1.422575e-01 1 1  ON 5
 uu_6                -1.216910e-01 1 1  ON 6
 uu_7                -5.035754e-02 1 1  ON 7
 uu_8                 9.160735e-02 1 1  ON 8
 uu_9                 1.282892e-01 1 1  ON 9
 ud_0                 3.565396e-01 1 1  ON 10
 ud_1                 9.719541e-02 1 1  ON 11
 ud_2                -1.339394e-02 1 1  ON 12
 ud_3                -7.546474e-02 1 1  ON 13
 ud_4                -1.238553e-01 1 1  ON 14
 ud_5                -1.563262e-01 1 1  ON 15
 ud_6                -1.578431e-01 1 1  ON 16
 ud_7                -1.128305e-01 1 1  ON 17
 ud_8                -7.270188e-03 1 1  ON 18
 ud_9                 9.285190e-02 1 1  ON 19
 eO_0                -7.900389e-01 1 1  ON 20
 eO_1                -4.671271e-01 1 1  ON 21
 eO_2                -5.305936e-02 1 1  ON 22
 eO_3                 2.096711e-01 1 1  ON 23
 eO_4                 3.128773e-01 1 1  ON 24
 eO_5                 3.315423e-01 1 1  ON 25
 eO_6                 2.662280e-01 1 1  ON 26
 eO_7                 1.283468e-01 1 1  ON 27
 eO_8                 3.067399e-02 1 1  ON 28
 eO_9                 1.930532e-02 1 1  ON 29
eH1_0                -1.849282e-01 1 1  ON 30
eH1_1                -1.054664e-01 1 1  ON 31
eH1_2                -6.396122e-02 1 1  ON 32
eH1_3                -2.715327e-02 1 1  ON 33
eH1_4                 1.898431e-02 1 1  ON 34
eH1_5                 3.172565e-02 1 1  ON 35
eH1_6                 7.716441e-02 1 1  ON 36
eH1_7                 1.101663e-01 1 1  ON 37
eH1_8                 9.975065e-02 1 1  ON 38
eH1_9                 2.730948e-02 1 1  ON 39
eH2_0                -1.867435e-01 1 1  ON 40
eH2_1                -1.074162e-01 1 1  ON 41
eH2_2                -6.565617e-02 1 1  ON 42
eH2_3                -2.806041e-02 1 1  ON 43
eH2_4                 1.787938e-02 1 1  ON 44
eH2_5                 3.199819e-02 1 1  ON 45
eH2_6                 7.906601e-02 1 1  ON 46
eH2_7                 1.136957e-01 1 1  ON 47
eH2_8                 1.026362e-01 1 1  ON 48
eH2_9                 2.949308e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2504
    reference variance = 0.165886
====================================================
  Execution time = 1.9725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476307872
                                         uncertainty =       0.004930222143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476307872
                                         uncertainty =       0.004930222143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400880253
  error estimate for blocks of size 2^( 2) =       0.000410984875
  error estimate for blocks of size 2^( 3) =       0.000419830793
  error estimate for blocks of size 2^( 4) =       0.000425889224
  error estimate for blocks of size 2^( 5) =       0.000429319658
  error estimate for blocks of size 2^( 6) =       0.000430042342
  error estimate for blocks of size 2^( 7) =       0.000431190208

      target function =                  N/A
              le_mean =     -17.215406071747
             les_mean =     296.691616009587
             stat err =       0.000429110358
             autocorr =       1.145799603286
              std dev =       0.566930291269
             le_variance =       0.321409955158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721540607175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215406071747       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215407706349       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215408131573       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215408561524       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215410675945       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215409457613       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215407228976       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215407998495       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215409771284       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215411071053       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215415817674       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215415807381       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215416113835       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215416773634       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215416094976       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215416304352       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215416465108       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-02 is 1.074076e-02

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215406071747       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215407449428       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215407875398       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215408156612       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215409669657       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215408667019       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215407302120       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215407986069       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215408567015       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215408771883       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215409897309       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215409755669       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.467089e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215406071747       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215406917621       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215407277795       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215407380858       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215408077988       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215407532166       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215407087351       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215407376627       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215407409521       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215407419375       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.023444e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5241e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.159949e-01 1 1  ON 0
 uu_1                 5.289085e-02 1 1  ON 1
 uu_2                -4.321151e-02 1 1  ON 2
 uu_3                -9.951423e-02 1 1  ON 3
 uu_4                -1.345701e-01 1 1  ON 4
 uu_5                -1.431922e-01 1 1  ON 5
 uu_6                -1.212339e-01 1 1  ON 6
 uu_7                -5.136600e-02 1 1  ON 7
 uu_8                 9.074031e-02 1 1  ON 8
 uu_9                 1.295446e-01 1 1  ON 9
 ud_0                 3.570608e-01 1 1  ON 10
 ud_1                 9.750424e-02 1 1  ON 11
 ud_2                -1.351208e-02 1 1  ON 12
 ud_3                -7.569854e-02 1 1  ON 13
 ud_4                -1.241360e-01 1 1  ON 14
 ud_5                -1.567164e-01 1 1  ON 15
 ud_6                -1.590151e-01 1 1  ON 16
 ud_7                -1.131479e-01 1 1  ON 17
 ud_8                -7.991357e-03 1 1  ON 18
 ud_9                 9.369268e-02 1 1  ON 19
 eO_0                -7.935060e-01 1 1  ON 20
 eO_1                -4.699403e-01 1 1  ON 21
 eO_2                -5.462785e-02 1 1  ON 22
 eO_3                 2.092303e-01 1 1  ON 23
 eO_4                 3.137404e-01 1 1  ON 24
 eO_5                 3.333802e-01 1 1  ON 25
 eO_6                 2.686106e-01 1 1  ON 26
 eO_7                 1.305781e-01 1 1  ON 27
 eO_8                 3.117774e-02 1 1  ON 28
 eO_9                 1.957254e-02 1 1  ON 29
eH1_0                -1.855460e-01 1 1  ON 30
eH1_1                -1.057283e-01 1 1  ON 31
eH1_2                -6.394187e-02 1 1  ON 32
eH1_3                -2.715525e-02 1 1  ON 33
eH1_4                 1.839692e-02 1 1  ON 34
eH1_5                 3.189693e-02 1 1  ON 35
eH1_6                 7.637027e-02 1 1  ON 36
eH1_7                 1.098749e-01 1 1  ON 37
eH1_8                 1.013038e-01 1 1  ON 38
eH1_9                 2.790420e-02 1 1  ON 39
eH2_0                -1.868200e-01 1 1  ON 40
eH2_1                -1.074629e-01 1 1  ON 41
eH2_2                -6.552075e-02 1 1  ON 42
eH2_3                -2.799050e-02 1 1  ON 43
eH2_4                 1.755414e-02 1 1  ON 44
eH2_5                 3.177101e-02 1 1  ON 45
eH2_6                 7.829064e-02 1 1  ON 46
eH2_7                 1.130869e-01 1 1  ON 47
eH2_8                 1.038719e-01 1 1  ON 48
eH2_9                 2.988280e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.3353
    reference variance = 0.287127
====================================================
  Execution time = 1.9741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.5410e-01
  Total weights = 2.0000e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353502294550
                                         uncertainty =       0.021540170605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353502294550
                                         uncertainty =       0.021540170605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420341022
  error estimate for blocks of size 2^( 2) =       0.000429582718
  error estimate for blocks of size 2^( 3) =       0.000437414692
  error estimate for blocks of size 2^( 4) =       0.000443476876
  error estimate for blocks of size 2^( 5) =       0.000446667495
  error estimate for blocks of size 2^( 6) =       0.000447659168
  error estimate for blocks of size 2^( 7) =       0.000450748487

      target function =                  N/A
              le_mean =     -17.217716660140
             les_mean =     296.803139961265
             stat err =       0.000447138007
             autocorr =       1.131565300892
              std dev =       0.594451973759
             le_variance =       0.353373149106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354663825190
                                         uncertainty =       0.021626768854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354663825190
                                         uncertainty =       0.021626768854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421030754
  error estimate for blocks of size 2^( 2) =       0.000430248435
  error estimate for blocks of size 2^( 3) =       0.000438043235
  error estimate for blocks of size 2^( 4) =       0.000444078899
  error estimate for blocks of size 2^( 5) =       0.000447253629
  error estimate for blocks of size 2^( 6) =       0.000448237882
  error estimate for blocks of size 2^( 7) =       0.000451333617

      target function =                  N/A
              le_mean =     -17.217715882624
             les_mean =     296.804273829116
             stat err =       0.000447726007
             autocorr =       1.130829174301
              std dev =       0.595427402467
             le_variance =       0.354533791608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354968256520
                                         uncertainty =       0.021650129645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354968256520
                                         uncertainty =       0.021650129645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421211355
  error estimate for blocks of size 2^( 2) =       0.000430423218
  error estimate for blocks of size 2^( 3) =       0.000438214406
  error estimate for blocks of size 2^( 4) =       0.000444249051
  error estimate for blocks of size 2^( 5) =       0.000447427367
  error estimate for blocks of size 2^( 6) =       0.000448412623
  error estimate for blocks of size 2^( 7) =       0.000451506555

      target function =                  N/A
              le_mean =     -17.217715814506
             les_mean =     296.804575703681
             stat err =       0.000447898899
             autocorr =       1.130732429744
              std dev =       0.595682811571
             le_variance =       0.354838012001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353876788377
                                         uncertainty =       0.021570573480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353876788377
                                         uncertainty =       0.021570573480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420563517
  error estimate for blocks of size 2^( 2) =       0.000429796550
  error estimate for blocks of size 2^( 3) =       0.000437618163
  error estimate for blocks of size 2^( 4) =       0.000443673108
  error estimate for blocks of size 2^( 5) =       0.000446861067
  error estimate for blocks of size 2^( 6) =       0.000447851951
  error estimate for blocks of size 2^( 7) =       0.000450939589

      target function =                  N/A
              le_mean =     -17.217715431210
             les_mean =     296.803471836978
             stat err =       0.000447331429
             autocorr =       1.131346486652
              std dev =       0.594766629647
             le_variance =       0.353747343742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217716660140        initial  <--
     1.4901e-02     1.4901e-01             1.0741e-02       -17.217715882624
     5.9605e-02     5.9605e-01             3.4671e-03       -17.217715814506
     2.3842e-01     2.3842e+00             1.0234e-03       -17.217715431210

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9516
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.155562e-01 1 1  ON 0
 uu_1                 5.275454e-02 1 1  ON 1
 uu_2                -4.299167e-02 1 1  ON 2
 uu_3                -9.916424e-02 1 1  ON 3
 uu_4                -1.337763e-01 1 1  ON 4
 uu_5                -1.422575e-01 1 1  ON 5
 uu_6                -1.216910e-01 1 1  ON 6
 uu_7                -5.035754e-02 1 1  ON 7
 uu_8                 9.160735e-02 1 1  ON 8
 uu_9                 1.282892e-01 1 1  ON 9
 ud_0                 3.565396e-01 1 1  ON 10
 ud_1                 9.719541e-02 1 1  ON 11
 ud_2                -1.339394e-02 1 1  ON 12
 ud_3                -7.546474e-02 1 1  ON 13
 ud_4                -1.238553e-01 1 1  ON 14
 ud_5                -1.563262e-01 1 1  ON 15
 ud_6                -1.578431e-01 1 1  ON 16
 ud_7                -1.128305e-01 1 1  ON 17
 ud_8                -7.270188e-03 1 1  ON 18
 ud_9                 9.285190e-02 1 1  ON 19
 eO_0                -7.900389e-01 1 1  ON 20
 eO_1                -4.671271e-01 1 1  ON 21
 eO_2                -5.305936e-02 1 1  ON 22
 eO_3                 2.096711e-01 1 1  ON 23
 eO_4                 3.128773e-01 1 1  ON 24
 eO_5                 3.315423e-01 1 1  ON 25
 eO_6                 2.662280e-01 1 1  ON 26
 eO_7                 1.283468e-01 1 1  ON 27
 eO_8                 3.067399e-02 1 1  ON 28
 eO_9                 1.930532e-02 1 1  ON 29
eH1_0                -1.849282e-01 1 1  ON 30
eH1_1                -1.054664e-01 1 1  ON 31
eH1_2                -6.396122e-02 1 1  ON 32
eH1_3                -2.715327e-02 1 1  ON 33
eH1_4                 1.898431e-02 1 1  ON 34
eH1_5                 3.172565e-02 1 1  ON 35
eH1_6                 7.716441e-02 1 1  ON 36
eH1_7                 1.101663e-01 1 1  ON 37
eH1_8                 9.975065e-02 1 1  ON 38
eH1_9                 2.730948e-02 1 1  ON 39
eH2_0                -1.867435e-01 1 1  ON 40
eH2_1                -1.074162e-01 1 1  ON 41
eH2_2                -6.565617e-02 1 1  ON 42
eH2_3                -2.806041e-02 1 1  ON 43
eH2_4                 1.787938e-02 1 1  ON 44
eH2_5                 3.199819e-02 1 1  ON 45
eH2_6                 7.906601e-02 1 1  ON 46
eH2_7                 1.136957e-01 1 1  ON 47
eH2_8                 1.026362e-01 1 1  ON 48
eH2_9                 2.949308e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2968
    reference variance = 0.444158
====================================================
  Execution time = 2.2379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320899375369
                                         uncertainty =       0.003527392216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320899375369
                                         uncertainty =       0.003527392216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400564599
  error estimate for blocks of size 2^( 2) =       0.000410304383
  error estimate for blocks of size 2^( 3) =       0.000418912357
  error estimate for blocks of size 2^( 4) =       0.000425990773
  error estimate for blocks of size 2^( 5) =       0.000429590281
  error estimate for blocks of size 2^( 6) =       0.000431404208
  error estimate for blocks of size 2^( 7) =       0.000432106282

      target function =                  N/A
              le_mean =     -17.217161593919
             les_mean =     296.751557187139
             stat err =       0.000429772886
             autocorr =       1.151152592417
              std dev =       0.566483888969
             le_variance =       0.320903996462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716159392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161593919       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217160017526       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217160920597       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217162011992       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161419693       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217160258149       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217160926836       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217161993787       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217161356417       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217162143585       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 1.202976e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161593919       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217160798515       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161128286       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161500014       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161362430       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217160690959       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161421697       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217161334205       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.348894e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161593919       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161327158       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161417648       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161502700       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161467602       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217161267350       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161475666       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217161460713       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.906393e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7953e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.156614e-01 1 1  ON 0
 uu_1                 5.273212e-02 1 1  ON 1
 uu_2                -4.292981e-02 1 1  ON 2
 uu_3                -9.915577e-02 1 1  ON 3
 uu_4                -1.338878e-01 1 1  ON 4
 uu_5                -1.421500e-01 1 1  ON 5
 uu_6                -1.215922e-01 1 1  ON 6
 uu_7                -5.063670e-02 1 1  ON 7
 uu_8                 9.140040e-02 1 1  ON 8
 uu_9                 1.283899e-01 1 1  ON 9
 ud_0                 3.566754e-01 1 1  ON 10
 ud_1                 9.727181e-02 1 1  ON 11
 ud_2                -1.345453e-02 1 1  ON 12
 ud_3                -7.547687e-02 1 1  ON 13
 ud_4                -1.239363e-01 1 1  ON 14
 ud_5                -1.562191e-01 1 1  ON 15
 ud_6                -1.578447e-01 1 1  ON 16
 ud_7                -1.128917e-01 1 1  ON 17
 ud_8                -7.448889e-03 1 1  ON 18
 ud_9                 9.284316e-02 1 1  ON 19
 eO_0                -7.903028e-01 1 1  ON 20
 eO_1                -4.674620e-01 1 1  ON 21
 eO_2                -5.319802e-02 1 1  ON 22
 eO_3                 2.096502e-01 1 1  ON 23
 eO_4                 3.129416e-01 1 1  ON 24
 eO_5                 3.318373e-01 1 1  ON 25
 eO_6                 2.663778e-01 1 1  ON 26
 eO_7                 1.285432e-01 1 1  ON 27
 eO_8                 3.070465e-02 1 1  ON 28
 eO_9                 1.931853e-02 1 1  ON 29
eH1_0                -1.849449e-01 1 1  ON 30
eH1_1                -1.054726e-01 1 1  ON 31
eH1_2                -6.411374e-02 1 1  ON 32
eH1_3                -2.696902e-02 1 1  ON 33
eH1_4                 1.878533e-02 1 1  ON 34
eH1_5                 3.180664e-02 1 1  ON 35
eH1_6                 7.711826e-02 1 1  ON 36
eH1_7                 1.101618e-01 1 1  ON 37
eH1_8                 9.985359e-02 1 1  ON 38
eH1_9                 2.735427e-02 1 1  ON 39
eH2_0                -1.867376e-01 1 1  ON 40
eH2_1                -1.074690e-01 1 1  ON 41
eH2_2                -6.563382e-02 1 1  ON 42
eH2_3                -2.799490e-02 1 1  ON 43
eH2_4                 1.775778e-02 1 1  ON 44
eH2_5                 3.203702e-02 1 1  ON 45
eH2_6                 7.905657e-02 1 1  ON 46
eH2_7                 1.136192e-01 1 1  ON 47
eH2_8                 1.027232e-01 1 1  ON 48
eH2_9                 2.952851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0567
    reference variance = 3.21826
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2330e-01
  Total weights = 2.0000e+06
  Execution time = 2.2705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322870094821
                                         uncertainty =       0.004261597373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322870094821
                                         uncertainty =       0.004261597373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401970420
  error estimate for blocks of size 2^( 2) =       0.000411491113
  error estimate for blocks of size 2^( 3) =       0.000420432566
  error estimate for blocks of size 2^( 4) =       0.000426932043
  error estimate for blocks of size 2^( 5) =       0.000431589605
  error estimate for blocks of size 2^( 6) =       0.000434366820
  error estimate for blocks of size 2^( 7) =       0.000437143780

      target function =                  N/A
              le_mean =     -17.216680438413
             les_mean =     296.737245593230
             stat err =       0.000432508062
             autocorr =       1.157711172683
              std dev =       0.568472018987
             le_variance =       0.323160436371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323207177969
                                         uncertainty =       0.004266418297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323207177969
                                         uncertainty =       0.004266418297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402179961
  error estimate for blocks of size 2^( 2) =       0.000411690573
  error estimate for blocks of size 2^( 3) =       0.000420617699
  error estimate for blocks of size 2^( 4) =       0.000427109562
  error estimate for blocks of size 2^( 5) =       0.000431766529
  error estimate for blocks of size 2^( 6) =       0.000434541193
  error estimate for blocks of size 2^( 7) =       0.000437324032

      target function =                  N/A
              le_mean =     -17.216679832936
             les_mean =     296.737561750378
             stat err =       0.000432685329
             autocorr =       1.157453317530
              std dev =       0.568768355587
             le_variance =       0.323497442317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155325482
                                         uncertainty =       0.004265894574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155325482
                                         uncertainty =       0.004265894574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402147727
  error estimate for blocks of size 2^( 2) =       0.000411659448
  error estimate for blocks of size 2^( 3) =       0.000420588198
  error estimate for blocks of size 2^( 4) =       0.000427081113
  error estimate for blocks of size 2^( 5) =       0.000431737805
  error estimate for blocks of size 2^( 6) =       0.000434512420
  error estimate for blocks of size 2^( 7) =       0.000437296768

      target function =                  N/A
              le_mean =     -17.216678787891
             les_mean =     296.737473912751
             stat err =       0.000432657027
             autocorr =       1.157487435105
              std dev =       0.568722769962
             le_variance =       0.323445589073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322916571503
                                         uncertainty =       0.004262363620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322916571503
                                         uncertainty =       0.004262363620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401999316
  error estimate for blocks of size 2^( 2) =       0.000411518437
  error estimate for blocks of size 2^( 3) =       0.000420457744
  error estimate for blocks of size 2^( 4) =       0.000426956093
  error estimate for blocks of size 2^( 5) =       0.000431613430
  error estimate for blocks of size 2^( 6) =       0.000434390327
  error estimate for blocks of size 2^( 7) =       0.000437168509

      target function =                  N/A
              le_mean =     -17.216680015620
             les_mean =     296.737277499461
             stat err =       0.000432532090
             autocorr =       1.157673356752
              std dev =       0.568512885342
             le_variance =       0.323206900800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216680438413        initial  <--
     1.4901e-01     1.4901e+00             1.2030e-03       -17.216679832936
     5.9605e-01     5.9605e+00             3.3489e-04       -17.216678787891
     2.3842e+00     2.3842e+01             8.9064e-05       -17.216680015620

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2413
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.155562e-01 1 1  ON 0
 uu_1                 5.275454e-02 1 1  ON 1
 uu_2                -4.299167e-02 1 1  ON 2
 uu_3                -9.916424e-02 1 1  ON 3
 uu_4                -1.337763e-01 1 1  ON 4
 uu_5                -1.422575e-01 1 1  ON 5
 uu_6                -1.216910e-01 1 1  ON 6
 uu_7                -5.035754e-02 1 1  ON 7
 uu_8                 9.160735e-02 1 1  ON 8
 uu_9                 1.282892e-01 1 1  ON 9
 ud_0                 3.565396e-01 1 1  ON 10
 ud_1                 9.719541e-02 1 1  ON 11
 ud_2                -1.339394e-02 1 1  ON 12
 ud_3                -7.546474e-02 1 1  ON 13
 ud_4                -1.238553e-01 1 1  ON 14
 ud_5                -1.563262e-01 1 1  ON 15
 ud_6                -1.578431e-01 1 1  ON 16
 ud_7                -1.128305e-01 1 1  ON 17
 ud_8                -7.270188e-03 1 1  ON 18
 ud_9                 9.285190e-02 1 1  ON 19
 eO_0                -7.900389e-01 1 1  ON 20
 eO_1                -4.671271e-01 1 1  ON 21
 eO_2                -5.305936e-02 1 1  ON 22
 eO_3                 2.096711e-01 1 1  ON 23
 eO_4                 3.128773e-01 1 1  ON 24
 eO_5                 3.315423e-01 1 1  ON 25
 eO_6                 2.662280e-01 1 1  ON 26
 eO_7                 1.283468e-01 1 1  ON 27
 eO_8                 3.067399e-02 1 1  ON 28
 eO_9                 1.930532e-02 1 1  ON 29
eH1_0                -1.849282e-01 1 1  ON 30
eH1_1                -1.054664e-01 1 1  ON 31
eH1_2                -6.396122e-02 1 1  ON 32
eH1_3                -2.715327e-02 1 1  ON 33
eH1_4                 1.898431e-02 1 1  ON 34
eH1_5                 3.172565e-02 1 1  ON 35
eH1_6                 7.716441e-02 1 1  ON 36
eH1_7                 1.101663e-01 1 1  ON 37
eH1_8                 9.975065e-02 1 1  ON 38
eH1_9                 2.730948e-02 1 1  ON 39
eH2_0                -1.867435e-01 1 1  ON 40
eH2_1                -1.074162e-01 1 1  ON 41
eH2_2                -6.565617e-02 1 1  ON 42
eH2_3                -2.806041e-02 1 1  ON 43
eH2_4                 1.787938e-02 1 1  ON 44
eH2_5                 3.199819e-02 1 1  ON 45
eH2_6                 7.906601e-02 1 1  ON 46
eH2_7                 1.136957e-01 1 1  ON 47
eH2_8                 1.026362e-01 1 1  ON 48
eH2_9                 2.949308e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2515
    reference variance = 0.200225
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312549198708
                                         uncertainty =       0.002367321877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312549198708
                                         uncertainty =       0.002367321877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395254672
  error estimate for blocks of size 2^( 2) =       0.000404825859
  error estimate for blocks of size 2^( 3) =       0.000413685964
  error estimate for blocks of size 2^( 4) =       0.000420195098
  error estimate for blocks of size 2^( 5) =       0.000424551655
  error estimate for blocks of size 2^( 6) =       0.000428066996
  error estimate for blocks of size 2^( 7) =       0.000430930886

      target function =                  N/A
              le_mean =     -17.217020898224
             les_mean =     296.738260964678
             stat err =       0.000425936159
             autocorr =       1.161274785135
              std dev =       0.558974517343
             le_variance =       0.312452511039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702089822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020898224       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217021120324       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217021304546       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217021330711       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217021246317       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217021081094       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217021167473       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217021201230       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.842141e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020898224       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217020960898       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217021014002       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217021015577       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217020986308       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217020938194       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217020963287       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.684647e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217020898224       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217020914413       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217020928231       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217020928299       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217020920257       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217020907756       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217020913800       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.185780e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5632e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.155517e-01 1 1  ON 0
 uu_1                 5.275531e-02 1 1  ON 1
 uu_2                -4.298513e-02 1 1  ON 2
 uu_3                -9.916557e-02 1 1  ON 3
 uu_4                -1.337860e-01 1 1  ON 4
 uu_5                -1.422507e-01 1 1  ON 5
 uu_6                -1.216739e-01 1 1  ON 6
 uu_7                -5.037533e-02 1 1  ON 7
 uu_8                 9.158976e-02 1 1  ON 8
 uu_9                 1.282965e-01 1 1  ON 9
 ud_0                 3.565278e-01 1 1  ON 10
 ud_1                 9.722165e-02 1 1  ON 11
 ud_2                -1.339421e-02 1 1  ON 12
 ud_3                -7.546553e-02 1 1  ON 13
 ud_4                -1.238538e-01 1 1  ON 14
 ud_5                -1.563106e-01 1 1  ON 15
 ud_6                -1.578439e-01 1 1  ON 16
 ud_7                -1.128425e-01 1 1  ON 17
 ud_8                -7.294671e-03 1 1  ON 18
 ud_9                 9.284786e-02 1 1  ON 19
 eO_0                -7.900858e-01 1 1  ON 20
 eO_1                -4.671627e-01 1 1  ON 21
 eO_2                -5.307003e-02 1 1  ON 22
 eO_3                 2.096977e-01 1 1  ON 23
 eO_4                 3.128855e-01 1 1  ON 24
 eO_5                 3.315608e-01 1 1  ON 25
 eO_6                 2.662459e-01 1 1  ON 26
 eO_7                 1.283639e-01 1 1  ON 27
 eO_8                 3.067554e-02 1 1  ON 28
 eO_9                 1.930694e-02 1 1  ON 29
eH1_0                -1.849189e-01 1 1  ON 30
eH1_1                -1.054558e-01 1 1  ON 31
eH1_2                -6.397300e-02 1 1  ON 32
eH1_3                -2.713441e-02 1 1  ON 33
eH1_4                 1.896430e-02 1 1  ON 34
eH1_5                 3.171854e-02 1 1  ON 35
eH1_6                 7.715057e-02 1 1  ON 36
eH1_7                 1.101634e-01 1 1  ON 37
eH1_8                 9.976215e-02 1 1  ON 38
eH1_9                 2.731389e-02 1 1  ON 39
eH2_0                -1.867321e-01 1 1  ON 40
eH2_1                -1.074154e-01 1 1  ON 41
eH2_2                -6.564813e-02 1 1  ON 42
eH2_3                -2.806455e-02 1 1  ON 43
eH2_4                 1.785121e-02 1 1  ON 44
eH2_5                 3.200194e-02 1 1  ON 45
eH2_6                 7.906230e-02 1 1  ON 46
eH2_7                 1.136931e-01 1 1  ON 47
eH2_8                 1.026464e-01 1 1  ON 48
eH2_9                 2.949527e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.366429
====================================================
  Execution time = 1.9477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2487e-01
  Total weights = 2.0000e+06
  Execution time = 1.8338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324977112440
                                         uncertainty =       0.004293805287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324977112440
                                         uncertainty =       0.004293805287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403041185
  error estimate for blocks of size 2^( 2) =       0.000412793855
  error estimate for blocks of size 2^( 3) =       0.000421190457
  error estimate for blocks of size 2^( 4) =       0.000427309781
  error estimate for blocks of size 2^( 5) =       0.000431330178
  error estimate for blocks of size 2^( 6) =       0.000433614469
  error estimate for blocks of size 2^( 7) =       0.000435892127

      target function =                  N/A
              le_mean =     -17.217010295352
             les_mean =     296.750327741183
             stat err =       0.000432036639
             autocorr =       1.149058932269
              std dev =       0.569986309811
             le_variance =       0.324884393372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324937323791
                                         uncertainty =       0.004293088262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324937323791
                                         uncertainty =       0.004293088262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403016509
  error estimate for blocks of size 2^( 2) =       0.000412769537
  error estimate for blocks of size 2^( 3) =       0.000421165632
  error estimate for blocks of size 2^( 4) =       0.000427285140
  error estimate for blocks of size 2^( 5) =       0.000431304975
  error estimate for blocks of size 2^( 6) =       0.000433590363
  error estimate for blocks of size 2^( 7) =       0.000435867219

      target function =                  N/A
              le_mean =     -17.217010604506
             les_mean =     296.750298606676
             stat err =       0.000432011924
             autocorr =       1.149068168907
              std dev =       0.569951413223
             le_variance =       0.324844613435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324943918684
                                         uncertainty =       0.004293250222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324943918684
                                         uncertainty =       0.004293250222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403020599
  error estimate for blocks of size 2^( 2) =       0.000412773728
  error estimate for blocks of size 2^( 3) =       0.000421170229
  error estimate for blocks of size 2^( 4) =       0.000427289872
  error estimate for blocks of size 2^( 5) =       0.000431310031
  error estimate for blocks of size 2^( 6) =       0.000433595056
  error estimate for blocks of size 2^( 7) =       0.000435872128

      target function =                  N/A
              le_mean =     -17.217010477558
             les_mean =     296.750300828716
             stat err =       0.000432016772
             autocorr =       1.149070634178
              std dev =       0.569957197344
             le_variance =       0.324851206804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324972565805
                                         uncertainty =       0.004293730062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324972565805
                                         uncertainty =       0.004293730062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403038365
  error estimate for blocks of size 2^( 2) =       0.000412791099
  error estimate for blocks of size 2^( 3) =       0.000421187690
  error estimate for blocks of size 2^( 4) =       0.000427307057
  error estimate for blocks of size 2^( 5) =       0.000431327422
  error estimate for blocks of size 2^( 6) =       0.000433611814
  error estimate for blocks of size 2^( 7) =       0.000435889393

      target function =                  N/A
              le_mean =     -17.217010316943
             les_mean =     296.750323939064
             stat err =       0.000432033921
             autocorr =       1.149060556067
              std dev =       0.569982322338
             le_variance =       0.324879847778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217010295352        initial
     1.4901e+00     1.4901e+01             1.8421e-04       -17.217010604506  <--
     5.9605e+00     5.9605e+01             4.6846e-05       -17.217010477558
     2.3842e+01     2.3842e+02             1.1858e-05       -17.217010316943

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.8660e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.155426e-01 1 1  ON 0
 uu_1                 5.276304e-02 1 1  ON 1
 uu_2                -4.296834e-02 1 1  ON 2
 uu_3                -9.916678e-02 1 1  ON 3
 uu_4                -1.338111e-01 1 1  ON 4
 uu_5                -1.422402e-01 1 1  ON 5
 uu_6                -1.216253e-01 1 1  ON 6
 uu_7                -5.043071e-02 1 1  ON 7
 uu_8                 9.153469e-02 1 1  ON 8
 uu_9                 1.283198e-01 1 1  ON 9
 ud_0                 3.565198e-01 1 1  ON 10
 ud_1                 9.728223e-02 1 1  ON 11
 ud_2                -1.339114e-02 1 1  ON 12
 ud_3                -7.546760e-02 1 1  ON 13
 ud_4                -1.238515e-01 1 1  ON 14
 ud_5                -1.562720e-01 1 1  ON 15
 ud_6                -1.578472e-01 1 1  ON 16
 ud_7                -1.128791e-01 1 1  ON 17
 ud_8                -7.371398e-03 1 1  ON 18
 ud_9                 9.283521e-02 1 1  ON 19
 eO_0                -7.902231e-01 1 1  ON 20
 eO_1                -4.672703e-01 1 1  ON 21
 eO_2                -5.310670e-02 1 1  ON 22
 eO_3                 2.097707e-01 1 1  ON 23
 eO_4                 3.129103e-01 1 1  ON 24
 eO_5                 3.316186e-01 1 1  ON 25
 eO_6                 2.663026e-01 1 1  ON 26
 eO_7                 1.284183e-01 1 1  ON 27
 eO_8                 3.068050e-02 1 1  ON 28
 eO_9                 1.931208e-02 1 1  ON 29
eH1_0                -1.848931e-01 1 1  ON 30
eH1_1                -1.054311e-01 1 1  ON 31
eH1_2                -6.400071e-02 1 1  ON 32
eH1_3                -2.708993e-02 1 1  ON 33
eH1_4                 1.891658e-02 1 1  ON 34
eH1_5                 3.169829e-02 1 1  ON 35
eH1_6                 7.710685e-02 1 1  ON 36
eH1_7                 1.101544e-01 1 1  ON 37
eH1_8                 9.979851e-02 1 1  ON 38
eH1_9                 2.732786e-02 1 1  ON 39
eH2_0                -1.867012e-01 1 1  ON 40
eH2_1                -1.074116e-01 1 1  ON 41
eH2_2                -6.562319e-02 1 1  ON 42
eH2_3                -2.807536e-02 1 1  ON 43
eH2_4                 1.777011e-02 1 1  ON 44
eH2_5                 3.200860e-02 1 1  ON 45
eH2_6                 7.904954e-02 1 1  ON 46
eH2_7                 1.136852e-01 1 1  ON 47
eH2_8                 1.026788e-01 1 1  ON 48
eH2_9                 2.950224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.238019
====================================================
  Execution time = 2.0163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317808874624
                                         uncertainty =       0.003458125579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317808874624
                                         uncertainty =       0.003458125579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398634484
  error estimate for blocks of size 2^( 2) =       0.000408273540
  error estimate for blocks of size 2^( 3) =       0.000417057142
  error estimate for blocks of size 2^( 4) =       0.000423480140
  error estimate for blocks of size 2^( 5) =       0.000427386801
  error estimate for blocks of size 2^( 6) =       0.000428631787
  error estimate for blocks of size 2^( 7) =       0.000429788201

      target function =                  N/A
              le_mean =     -17.216974034095
             les_mean =     296.742013636186
             stat err =       0.000427321732
             autocorr =       1.149106363435
              std dev =       0.563754294333
             le_variance =       0.317818904379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697403410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974034095       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974177343       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216973943721       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216974276797       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216974701541       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216974735349       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216974888270       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216974759888       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216974783999       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 5.689321e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974034095       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974088253       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216974014730       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216974132212       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216974334963       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216974318313       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216974357371       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216974316464       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.587187e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974034095       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974049623       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216974029869       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216974063331       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216974128463       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216974123306       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216974133089       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.122039e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5690e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.155510e-01 1 1  ON 0
 uu_1                 5.276050e-02 1 1  ON 1
 uu_2                -4.304195e-02 1 1  ON 2
 uu_3                -9.916448e-02 1 1  ON 3
 uu_4                -1.338447e-01 1 1  ON 4
 uu_5                -1.422635e-01 1 1  ON 5
 uu_6                -1.215613e-01 1 1  ON 6
 uu_7                -5.042754e-02 1 1  ON 7
 uu_8                 9.150809e-02 1 1  ON 8
 uu_9                 1.283556e-01 1 1  ON 9
 ud_0                 3.565182e-01 1 1  ON 10
 ud_1                 9.730731e-02 1 1  ON 11
 ud_2                -1.340472e-02 1 1  ON 12
 ud_3                -7.543953e-02 1 1  ON 13
 ud_4                -1.238464e-01 1 1  ON 14
 ud_5                -1.562969e-01 1 1  ON 15
 ud_6                -1.578527e-01 1 1  ON 16
 ud_7                -1.128998e-01 1 1  ON 17
 ud_8                -7.427336e-03 1 1  ON 18
 ud_9                 9.284285e-02 1 1  ON 19
 eO_0                -7.903818e-01 1 1  ON 20
 eO_1                -4.673452e-01 1 1  ON 21
 eO_2                -5.318414e-02 1 1  ON 22
 eO_3                 2.096995e-01 1 1  ON 23
 eO_4                 3.129748e-01 1 1  ON 24
 eO_5                 3.317080e-01 1 1  ON 25
 eO_6                 2.664063e-01 1 1  ON 26
 eO_7                 1.285148e-01 1 1  ON 27
 eO_8                 3.069670e-02 1 1  ON 28
 eO_9                 1.931728e-02 1 1  ON 29
eH1_0                -1.848425e-01 1 1  ON 30
eH1_1                -1.054508e-01 1 1  ON 31
eH1_2                -6.396008e-02 1 1  ON 32
eH1_3                -2.705998e-02 1 1  ON 33
eH1_4                 1.881872e-02 1 1  ON 34
eH1_5                 3.164627e-02 1 1  ON 35
eH1_6                 7.707969e-02 1 1  ON 36
eH1_7                 1.101546e-01 1 1  ON 37
eH1_8                 9.985180e-02 1 1  ON 38
eH1_9                 2.734350e-02 1 1  ON 39
eH2_0                -1.867107e-01 1 1  ON 40
eH2_1                -1.073939e-01 1 1  ON 41
eH2_2                -6.556645e-02 1 1  ON 42
eH2_3                -2.808211e-02 1 1  ON 43
eH2_4                 1.771606e-02 1 1  ON 44
eH2_5                 3.196538e-02 1 1  ON 45
eH2_6                 7.901935e-02 1 1  ON 46
eH2_7                 1.136893e-01 1 1  ON 47
eH2_8                 1.027243e-01 1 1  ON 48
eH2_9                 2.951809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1979
    reference variance = 0.121844
====================================================
  Execution time = 1.9802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2626e-01
  Total weights = 2.0000e+06
  Execution time = 1.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325958094888
                                         uncertainty =       0.006865143017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325958094888
                                         uncertainty =       0.006865143017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403880966
  error estimate for blocks of size 2^( 2) =       0.000412807473
  error estimate for blocks of size 2^( 3) =       0.000421355707
  error estimate for blocks of size 2^( 4) =       0.000427594581
  error estimate for blocks of size 2^( 5) =       0.000430939938
  error estimate for blocks of size 2^( 6) =       0.000432783471
  error estimate for blocks of size 2^( 7) =       0.000432939228

      target function =                  N/A
              le_mean =     -17.216114471132
             les_mean =     296.720836989441
             stat err =       0.000431064305
             autocorr =       1.139140650446
              std dev =       0.571173939745
             le_variance =       0.326239669444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326012928477
                                         uncertainty =       0.006866024699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326012928477
                                         uncertainty =       0.006866024699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403915140
  error estimate for blocks of size 2^( 2) =       0.000412839121
  error estimate for blocks of size 2^( 3) =       0.000421387484
  error estimate for blocks of size 2^( 4) =       0.000427623955
  error estimate for blocks of size 2^( 5) =       0.000430971559
  error estimate for blocks of size 2^( 6) =       0.000432816141
  error estimate for blocks of size 2^( 7) =       0.000432974431

      target function =                  N/A
              le_mean =     -17.216115797307
             les_mean =     296.720937863582
             stat err =       0.000431096522
             autocorr =       1.139118153627
              std dev =       0.571222268857
             le_variance =       0.326294880438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325993823727
                                         uncertainty =       0.006865439363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325993823727
                                         uncertainty =       0.006865439363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403903294
  error estimate for blocks of size 2^( 2) =       0.000412827883
  error estimate for blocks of size 2^( 3) =       0.000421376448
  error estimate for blocks of size 2^( 4) =       0.000427613505
  error estimate for blocks of size 2^( 5) =       0.000430961203
  error estimate for blocks of size 2^( 6) =       0.000432806004
  error estimate for blocks of size 2^( 7) =       0.000432963118

      target function =                  N/A
              le_mean =     -17.216115556368
             les_mean =     296.720910428770
             stat err =       0.000431085958
             autocorr =       1.139129142050
              std dev =       0.571205516172
             le_variance =       0.326275741706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325963057225
                                         uncertainty =       0.006865167127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325963057225
                                         uncertainty =       0.006865167127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403884077
  error estimate for blocks of size 2^( 2) =       0.000412810281
  error estimate for blocks of size 2^( 3) =       0.000421358578
  error estimate for blocks of size 2^( 4) =       0.000427597171
  error estimate for blocks of size 2^( 5) =       0.000430942932
  error estimate for blocks of size 2^( 6) =       0.000432786722
  error estimate for blocks of size 2^( 7) =       0.000432942578

      target function =                  N/A
              le_mean =     -17.216114625942
             les_mean =     296.720847345041
             stat err =       0.000431067351
             autocorr =       1.139139203885
              std dev =       0.571178338691
             le_variance =       0.326244694590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216114471132        initial
     3.7253e-01     3.7253e+00             5.6893e-04       -17.216115797307  <--
     1.4901e+00     1.4901e+01             1.5872e-04       -17.216115556368
     5.9605e+00     5.9605e+01             4.1220e-05       -17.216114625942

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.9011e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.155489e-01 1 1  ON 0
 uu_1                 5.271657e-02 1 1  ON 1
 uu_2                -4.316139e-02 1 1  ON 2
 uu_3                -9.920114e-02 1 1  ON 3
 uu_4                -1.339088e-01 1 1  ON 4
 uu_5                -1.423400e-01 1 1  ON 5
 uu_6                -1.213956e-01 1 1  ON 6
 uu_7                -5.041645e-02 1 1  ON 7
 uu_8                 9.143102e-02 1 1  ON 8
 uu_9                 1.284623e-01 1 1  ON 9
 ud_0                 3.565486e-01 1 1  ON 10
 ud_1                 9.734265e-02 1 1  ON 11
 ud_2                -1.340284e-02 1 1  ON 12
 ud_3                -7.540011e-02 1 1  ON 13
 ud_4                -1.238340e-01 1 1  ON 14
 ud_5                -1.563551e-01 1 1  ON 15
 ud_6                -1.578782e-01 1 1  ON 16
 ud_7                -1.129612e-01 1 1  ON 17
 ud_8                -7.591865e-03 1 1  ON 18
 ud_9                 9.286574e-02 1 1  ON 19
 eO_0                -7.907921e-01 1 1  ON 20
 eO_1                -4.676240e-01 1 1  ON 21
 eO_2                -5.343764e-02 1 1  ON 22
 eO_3                 2.095256e-01 1 1  ON 23
 eO_4                 3.131458e-01 1 1  ON 24
 eO_5                 3.319728e-01 1 1  ON 25
 eO_6                 2.667157e-01 1 1  ON 26
 eO_7                 1.288018e-01 1 1  ON 27
 eO_8                 3.074498e-02 1 1  ON 28
 eO_9                 1.933276e-02 1 1  ON 29
eH1_0                -1.847191e-01 1 1  ON 30
eH1_1                -1.054707e-01 1 1  ON 31
eH1_2                -6.387085e-02 1 1  ON 32
eH1_3                -2.700802e-02 1 1  ON 33
eH1_4                 1.861158e-02 1 1  ON 34
eH1_5                 3.147164e-02 1 1  ON 35
eH1_6                 7.699159e-02 1 1  ON 36
eH1_7                 1.101555e-01 1 1  ON 37
eH1_8                 1.000103e-01 1 1  ON 38
eH1_9                 2.739006e-02 1 1  ON 39
eH2_0                -1.867294e-01 1 1  ON 40
eH2_1                -1.073517e-01 1 1  ON 41
eH2_2                -6.545021e-02 1 1  ON 42
eH2_3                -2.807188e-02 1 1  ON 43
eH2_4                 1.759325e-02 1 1  ON 44
eH2_5                 3.182493e-02 1 1  ON 45
eH2_6                 7.892604e-02 1 1  ON 46
eH2_7                 1.137020e-01 1 1  ON 47
eH2_8                 1.028598e-01 1 1  ON 48
eH2_9                 2.956523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2525
    reference variance = 0.223355
====================================================
  Execution time = 2.0206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2250e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322584927227
                                         uncertainty =       0.005909627379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322584927227
                                         uncertainty =       0.005909627379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401559066
  error estimate for blocks of size 2^( 2) =       0.000411265461
  error estimate for blocks of size 2^( 3) =       0.000419897916
  error estimate for blocks of size 2^( 4) =       0.000426202093
  error estimate for blocks of size 2^( 5) =       0.000430539188
  error estimate for blocks of size 2^( 6) =       0.000433031503
  error estimate for blocks of size 2^( 7) =       0.000434008754

      target function =                  N/A
              le_mean =     -17.216590960857
             les_mean =     296.733503519386
             stat err =       0.000430945385
             autocorr =       1.151716521172
              std dev =       0.567890277411
             le_variance =       0.322499367178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659096086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590960857       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592822996       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591422925       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216591879969       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592700666       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216593049802       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594028308       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216594084181       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216594813695       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216594414785       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216594396376       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-02 is 2.027957e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590960857       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591998579       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591285173       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216591076725       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216591625618       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216591943309       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216591731791       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216591911223       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216591835097       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 5.666486e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590960857       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591335363       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591099854       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216590968394       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216591093368       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216591227633       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216591149506       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.513345e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5730e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.153924e-01 1 1  ON 0
 uu_1                 5.277701e-02 1 1  ON 1
 uu_2                -4.305836e-02 1 1  ON 2
 uu_3                -9.922408e-02 1 1  ON 3
 uu_4                -1.340170e-01 1 1  ON 4
 uu_5                -1.424691e-01 1 1  ON 5
 uu_6                -1.211881e-01 1 1  ON 6
 uu_7                -5.055472e-02 1 1  ON 7
 uu_8                 9.131833e-02 1 1  ON 8
 uu_9                 1.285998e-01 1 1  ON 9
 ud_0                 3.566381e-01 1 1  ON 10
 ud_1                 9.742356e-02 1 1  ON 11
 ud_2                -1.342559e-02 1 1  ON 12
 ud_3                -7.536549e-02 1 1  ON 13
 ud_4                -1.237837e-01 1 1  ON 14
 ud_5                -1.563622e-01 1 1  ON 15
 ud_6                -1.580423e-01 1 1  ON 16
 ud_7                -1.129408e-01 1 1  ON 17
 ud_8                -7.785653e-03 1 1  ON 18
 ud_9                 9.282604e-02 1 1  ON 19
 eO_0                -7.913587e-01 1 1  ON 20
 eO_1                -4.681062e-01 1 1  ON 21
 eO_2                -5.369371e-02 1 1  ON 22
 eO_3                 2.096399e-01 1 1  ON 23
 eO_4                 3.130767e-01 1 1  ON 24
 eO_5                 3.323910e-01 1 1  ON 25
 eO_6                 2.671279e-01 1 1  ON 26
 eO_7                 1.291303e-01 1 1  ON 27
 eO_8                 3.080263e-02 1 1  ON 28
 eO_9                 1.935567e-02 1 1  ON 29
eH1_0                -1.847143e-01 1 1  ON 30
eH1_1                -1.054646e-01 1 1  ON 31
eH1_2                -6.394544e-02 1 1  ON 32
eH1_3                -2.698880e-02 1 1  ON 33
eH1_4                 1.844969e-02 1 1  ON 34
eH1_5                 3.157853e-02 1 1  ON 35
eH1_6                 7.687815e-02 1 1  ON 36
eH1_7                 1.101304e-01 1 1  ON 37
eH1_8                 1.001828e-01 1 1  ON 38
eH1_9                 2.744553e-02 1 1  ON 39
eH2_0                -1.867745e-01 1 1  ON 40
eH2_1                -1.071741e-01 1 1  ON 41
eH2_2                -6.548867e-02 1 1  ON 42
eH2_3                -2.807797e-02 1 1  ON 43
eH2_4                 1.754805e-02 1 1  ON 44
eH2_5                 3.160554e-02 1 1  ON 45
eH2_6                 7.880656e-02 1 1  ON 46
eH2_7                 1.137183e-01 1 1  ON 47
eH2_8                 1.030430e-01 1 1  ON 48
eH2_9                 2.962998e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2517
    reference variance = 0.223234
====================================================
  Execution time = 1.9570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1665e-01
  Total weights = 2.0000e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316643143600
                                         uncertainty =       0.003740317290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316643143600
                                         uncertainty =       0.003740317290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397876051
  error estimate for blocks of size 2^( 2) =       0.000407642120
  error estimate for blocks of size 2^( 3) =       0.000416268724
  error estimate for blocks of size 2^( 4) =       0.000423161942
  error estimate for blocks of size 2^( 5) =       0.000427111012
  error estimate for blocks of size 2^( 6) =       0.000429235588
  error estimate for blocks of size 2^( 7) =       0.000430460236

      target function =                  N/A
              le_mean =     -17.216078249742
             les_mean =     296.709960847486
             stat err =       0.000427492195
             autocorr =       1.154411861729
              std dev =       0.562681708035
             le_variance =       0.316610704558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316800684377
                                         uncertainty =       0.003742221348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316800684377
                                         uncertainty =       0.003742221348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397975066
  error estimate for blocks of size 2^( 2) =       0.000407737828
  error estimate for blocks of size 2^( 3) =       0.000416353302
  error estimate for blocks of size 2^( 4) =       0.000423237636
  error estimate for blocks of size 2^( 5) =       0.000427179413
  error estimate for blocks of size 2^( 6) =       0.000429300803
  error estimate for blocks of size 2^( 7) =       0.000430526268

      target function =                  N/A
              le_mean =     -17.216077328593
             les_mean =     296.710086732097
             stat err =       0.000427561030
             autocorr =       1.154209122399
              std dev =       0.562821735887
             le_variance =       0.316768306387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316732856795
                                         uncertainty =       0.003741829253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316732856795
                                         uncertainty =       0.003741829253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397932475
  error estimate for blocks of size 2^( 2) =       0.000407696045
  error estimate for blocks of size 2^( 3) =       0.000416312886
  error estimate for blocks of size 2^( 4) =       0.000423199694
  error estimate for blocks of size 2^( 5) =       0.000427142445
  error estimate for blocks of size 2^( 6) =       0.000429267578
  error estimate for blocks of size 2^( 7) =       0.000430493967

      target function =                  N/A
              le_mean =     -17.216077195221
             les_mean =     296.710014343514
             stat err =       0.000427525921
             autocorr =       1.154266616436
              std dev =       0.562761503708
             le_variance =       0.316700510056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316652888535
                                         uncertainty =       0.003740579546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316652888535
                                         uncertainty =       0.003740579546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397882187
  error estimate for blocks of size 2^( 2) =       0.000407647737
  error estimate for blocks of size 2^( 3) =       0.000416272463
  error estimate for blocks of size 2^( 4) =       0.000423164650
  error estimate for blocks of size 2^( 5) =       0.000427112617
  error estimate for blocks of size 2^( 6) =       0.000429237594
  error estimate for blocks of size 2^( 7) =       0.000430462252

      target function =                  N/A
              le_mean =     -17.216077957579
             les_mean =     296.709960552349
             stat err =       0.000427494278
             autocorr =       1.154387512150
              std dev =       0.562690384858
             le_variance =       0.316620469211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216078249742        initial  <--
     9.3132e-02     9.3132e-01             2.0280e-03       -17.216077328593
     3.7253e-01     3.7253e+00             5.6665e-04       -17.216077195221
     1.4901e+00     1.4901e+01             1.5133e-04       -17.216077957579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7787
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.155489e-01 1 1  ON 0
 uu_1                 5.271657e-02 1 1  ON 1
 uu_2                -4.316139e-02 1 1  ON 2
 uu_3                -9.920114e-02 1 1  ON 3
 uu_4                -1.339088e-01 1 1  ON 4
 uu_5                -1.423400e-01 1 1  ON 5
 uu_6                -1.213956e-01 1 1  ON 6
 uu_7                -5.041645e-02 1 1  ON 7
 uu_8                 9.143102e-02 1 1  ON 8
 uu_9                 1.284623e-01 1 1  ON 9
 ud_0                 3.565486e-01 1 1  ON 10
 ud_1                 9.734265e-02 1 1  ON 11
 ud_2                -1.340284e-02 1 1  ON 12
 ud_3                -7.540011e-02 1 1  ON 13
 ud_4                -1.238340e-01 1 1  ON 14
 ud_5                -1.563551e-01 1 1  ON 15
 ud_6                -1.578782e-01 1 1  ON 16
 ud_7                -1.129612e-01 1 1  ON 17
 ud_8                -7.591865e-03 1 1  ON 18
 ud_9                 9.286574e-02 1 1  ON 19
 eO_0                -7.907921e-01 1 1  ON 20
 eO_1                -4.676240e-01 1 1  ON 21
 eO_2                -5.343764e-02 1 1  ON 22
 eO_3                 2.095256e-01 1 1  ON 23
 eO_4                 3.131458e-01 1 1  ON 24
 eO_5                 3.319728e-01 1 1  ON 25
 eO_6                 2.667157e-01 1 1  ON 26
 eO_7                 1.288018e-01 1 1  ON 27
 eO_8                 3.074498e-02 1 1  ON 28
 eO_9                 1.933276e-02 1 1  ON 29
eH1_0                -1.847191e-01 1 1  ON 30
eH1_1                -1.054707e-01 1 1  ON 31
eH1_2                -6.387085e-02 1 1  ON 32
eH1_3                -2.700802e-02 1 1  ON 33
eH1_4                 1.861158e-02 1 1  ON 34
eH1_5                 3.147164e-02 1 1  ON 35
eH1_6                 7.699159e-02 1 1  ON 36
eH1_7                 1.101555e-01 1 1  ON 37
eH1_8                 1.000103e-01 1 1  ON 38
eH1_9                 2.739006e-02 1 1  ON 39
eH2_0                -1.867294e-01 1 1  ON 40
eH2_1                -1.073517e-01 1 1  ON 41
eH2_2                -6.545021e-02 1 1  ON 42
eH2_3                -2.807188e-02 1 1  ON 43
eH2_4                 1.759325e-02 1 1  ON 44
eH2_5                 3.182493e-02 1 1  ON 45
eH2_6                 7.892604e-02 1 1  ON 46
eH2_7                 1.137020e-01 1 1  ON 47
eH2_8                 1.028598e-01 1 1  ON 48
eH2_9                 2.956523e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.159534
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1628e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316249035425
                                         uncertainty =       0.003275449933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316249035425
                                         uncertainty =       0.003275449933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397665263
  error estimate for blocks of size 2^( 2) =       0.000407021190
  error estimate for blocks of size 2^( 3) =       0.000414963842
  error estimate for blocks of size 2^( 4) =       0.000420923812
  error estimate for blocks of size 2^( 5) =       0.000425033279
  error estimate for blocks of size 2^( 6) =       0.000428202541
  error estimate for blocks of size 2^( 7) =       0.000431181913

      target function =                  N/A
              le_mean =     -17.216429272259
             les_mean =     296.721712051056
             stat err =       0.000426335386
             autocorr =       1.149390095299
              std dev =       0.562383607955
             le_variance =       0.316275322496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642927226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429272259       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429092322       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429448139       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429558203       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429669013       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429811193       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429671616       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216429715174       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 2.477633e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429272259       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429220737       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429322729       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429351970       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429381296       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429421807       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429390820       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 6.849202e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429272259       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429258893       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429285353       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429292773       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429299985       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429310541       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429303536       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.757078e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5685e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.155743e-01 1 1  ON 0
 uu_1                 5.271597e-02 1 1  ON 1
 uu_2                -4.314292e-02 1 1  ON 2
 uu_3                -9.920730e-02 1 1  ON 3
 uu_4                -1.339120e-01 1 1  ON 4
 uu_5                -1.423387e-01 1 1  ON 5
 uu_6                -1.214080e-01 1 1  ON 6
 uu_7                -5.045458e-02 1 1  ON 7
 uu_8                 9.141183e-02 1 1  ON 8
 uu_9                 1.284790e-01 1 1  ON 9
 ud_0                 3.565521e-01 1 1  ON 10
 ud_1                 9.735890e-02 1 1  ON 11
 ud_2                -1.339545e-02 1 1  ON 12
 ud_3                -7.539439e-02 1 1  ON 13
 ud_4                -1.238290e-01 1 1  ON 14
 ud_5                -1.563306e-01 1 1  ON 15
 ud_6                -1.579172e-01 1 1  ON 16
 ud_7                -1.129756e-01 1 1  ON 17
 ud_8                -7.612438e-03 1 1  ON 18
 ud_9                 9.286363e-02 1 1  ON 19
 eO_0                -7.908274e-01 1 1  ON 20
 eO_1                -4.676925e-01 1 1  ON 21
 eO_2                -5.345228e-02 1 1  ON 22
 eO_3                 2.095160e-01 1 1  ON 23
 eO_4                 3.131715e-01 1 1  ON 24
 eO_5                 3.320132e-01 1 1  ON 25
 eO_6                 2.667398e-01 1 1  ON 26
 eO_7                 1.288314e-01 1 1  ON 27
 eO_8                 3.075032e-02 1 1  ON 28
 eO_9                 1.933489e-02 1 1  ON 29
eH1_0                -1.847238e-01 1 1  ON 30
eH1_1                -1.054956e-01 1 1  ON 31
eH1_2                -6.389646e-02 1 1  ON 32
eH1_3                -2.698671e-02 1 1  ON 33
eH1_4                 1.859019e-02 1 1  ON 34
eH1_5                 3.149610e-02 1 1  ON 35
eH1_6                 7.699483e-02 1 1  ON 36
eH1_7                 1.101574e-01 1 1  ON 37
eH1_8                 1.000288e-01 1 1  ON 38
eH1_9                 2.739537e-02 1 1  ON 39
eH2_0                -1.867266e-01 1 1  ON 40
eH2_1                -1.073495e-01 1 1  ON 41
eH2_2                -6.543539e-02 1 1  ON 42
eH2_3                -2.806969e-02 1 1  ON 43
eH2_4                 1.759012e-02 1 1  ON 44
eH2_5                 3.180763e-02 1 1  ON 45
eH2_6                 7.890276e-02 1 1  ON 46
eH2_7                 1.136986e-01 1 1  ON 47
eH2_8                 1.028760e-01 1 1  ON 48
eH2_9                 2.957153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2414
    reference variance = 0.226007
====================================================
  Execution time = 1.9455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2315e-01
  Total weights = 2.0000e+06
  Execution time = 1.8175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323241759966
                                         uncertainty =       0.003260801160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323241759966
                                         uncertainty =       0.003260801160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401968786
  error estimate for blocks of size 2^( 2) =       0.000411738268
  error estimate for blocks of size 2^( 3) =       0.000420193510
  error estimate for blocks of size 2^( 4) =       0.000426427704
  error estimate for blocks of size 2^( 5) =       0.000430235994
  error estimate for blocks of size 2^( 6) =       0.000432514382
  error estimate for blocks of size 2^( 7) =       0.000432866268

      target function =                  N/A
              le_mean =     -17.216588524819
             les_mean =     296.734078080823
             stat err =       0.000430511087
             autocorr =       1.147054413705
              std dev =       0.568469708504
             le_variance =       0.323157809487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323231606694
                                         uncertainty =       0.003260823746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323231606694
                                         uncertainty =       0.003260823746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401962487
  error estimate for blocks of size 2^( 2) =       0.000411731991
  error estimate for blocks of size 2^( 3) =       0.000420187001
  error estimate for blocks of size 2^( 4) =       0.000426421065
  error estimate for blocks of size 2^( 5) =       0.000430229088
  error estimate for blocks of size 2^( 6) =       0.000432507741
  error estimate for blocks of size 2^( 7) =       0.000432859298

      target function =                  N/A
              le_mean =     -17.216588955329
             les_mean =     296.734082776617
             stat err =       0.000430504298
             autocorr =       1.147054187658
              std dev =       0.568460800260
             le_variance =       0.323147681432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323228087652
                                         uncertainty =       0.003260776199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323228087652
                                         uncertainty =       0.003260776199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960296
  error estimate for blocks of size 2^( 2) =       0.000411729972
  error estimate for blocks of size 2^( 3) =       0.000420185296
  error estimate for blocks of size 2^( 4) =       0.000426419615
  error estimate for blocks of size 2^( 5) =       0.000430227808
  error estimate for blocks of size 2^( 6) =       0.000432506434
  error estimate for blocks of size 2^( 7) =       0.000432858184

      target function =                  N/A
              le_mean =     -17.216588762311
             les_mean =     296.734072607916
             stat err =       0.000430503010
             autocorr =       1.147059828926
              std dev =       0.568457701984
             le_variance =       0.323144158945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323239785707
                                         uncertainty =       0.003260797659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323239785707
                                         uncertainty =       0.003260797659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401967560
  error estimate for blocks of size 2^( 2) =       0.000411737070
  error estimate for blocks of size 2^( 3) =       0.000420192327
  error estimate for blocks of size 2^( 4) =       0.000426426540
  error estimate for blocks of size 2^( 5) =       0.000430234819
  error estimate for blocks of size 2^( 6) =       0.000432513236
  error estimate for blocks of size 2^( 7) =       0.000432865107

      target function =                  N/A
              le_mean =     -17.216588554829
             les_mean =     296.734077142926
             stat err =       0.000430509925
             autocorr =       1.147055221983
              std dev =       0.568467974692
             le_variance =       0.323155838251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216588524819        initial
     9.3132e-01     9.3132e+00             2.4776e-04       -17.216588955329  <--
     3.7253e+00     3.7253e+01             6.8492e-05       -17.216588762311
     1.4901e+01     1.4901e+02             1.7571e-05       -17.216588554829

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.8637e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.156379e-01 1 1  ON 0
 uu_1                 5.272818e-02 1 1  ON 1
 uu_2                -4.310471e-02 1 1  ON 2
 uu_3                -9.920639e-02 1 1  ON 3
 uu_4                -1.339214e-01 1 1  ON 4
 uu_5                -1.423430e-01 1 1  ON 5
 uu_6                -1.214423e-01 1 1  ON 6
 uu_7                -5.056958e-02 1 1  ON 7
 uu_8                 9.135287e-02 1 1  ON 8
 uu_9                 1.285310e-01 1 1  ON 9
 ud_0                 3.565744e-01 1 1  ON 10
 ud_1                 9.740183e-02 1 1  ON 11
 ud_2                -1.337371e-02 1 1  ON 12
 ud_3                -7.537637e-02 1 1  ON 13
 ud_4                -1.238183e-01 1 1  ON 14
 ud_5                -1.562708e-01 1 1  ON 15
 ud_6                -1.580248e-01 1 1  ON 16
 ud_7                -1.130158e-01 1 1  ON 17
 ud_8                -7.675691e-03 1 1  ON 18
 ud_9                 9.285721e-02 1 1  ON 19
 eO_0                -7.909532e-01 1 1  ON 20
 eO_1                -4.678718e-01 1 1  ON 21
 eO_2                -5.351399e-02 1 1  ON 22
 eO_3                 2.094870e-01 1 1  ON 23
 eO_4                 3.132459e-01 1 1  ON 24
 eO_5                 3.321393e-01 1 1  ON 25
 eO_6                 2.668165e-01 1 1  ON 26
 eO_7                 1.289235e-01 1 1  ON 27
 eO_8                 3.076693e-02 1 1  ON 28
 eO_9                 1.934149e-02 1 1  ON 29
eH1_0                -1.847467e-01 1 1  ON 30
eH1_1                -1.055609e-01 1 1  ON 31
eH1_2                -6.396640e-02 1 1  ON 32
eH1_3                -2.694355e-02 1 1  ON 33
eH1_4                 1.854076e-02 1 1  ON 34
eH1_5                 3.156536e-02 1 1  ON 35
eH1_6                 7.700343e-02 1 1  ON 36
eH1_7                 1.101643e-01 1 1  ON 37
eH1_8                 1.000867e-01 1 1  ON 38
eH1_9                 2.741190e-02 1 1  ON 39
eH2_0                -1.867190e-01 1 1  ON 40
eH2_1                -1.073354e-01 1 1  ON 41
eH2_2                -6.539860e-02 1 1  ON 42
eH2_3                -2.806374e-02 1 1  ON 43
eH2_4                 1.757666e-02 1 1  ON 44
eH2_5                 3.175817e-02 1 1  ON 45
eH2_6                 7.883278e-02 1 1  ON 46
eH2_7                 1.136890e-01 1 1  ON 47
eH2_8                 1.029266e-01 1 1  ON 48
eH2_9                 2.959110e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2186
    reference variance = 0.371554
====================================================
  Execution time = 2.0153e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327348845947
                                         uncertainty =       0.009065183707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327348845947
                                         uncertainty =       0.009065183707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404516715
  error estimate for blocks of size 2^( 2) =       0.000414354751
  error estimate for blocks of size 2^( 3) =       0.000423144763
  error estimate for blocks of size 2^( 4) =       0.000429382650
  error estimate for blocks of size 2^( 5) =       0.000432640394
  error estimate for blocks of size 2^( 6) =       0.000434059365
  error estimate for blocks of size 2^( 7) =       0.000435498698

      target function =                  N/A
              le_mean =     -17.217007439407
             les_mean =     296.752612550538
             stat err =       0.000432895277
             autocorr =       1.145230091777
              std dev =       0.572073024685
             le_variance =       0.327267545572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700743941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007439407       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007171759       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007067728       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007524714       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007056759       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007106638       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217006927449       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217007432318       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217007503338       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217007477739       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e-01 is 8.572370e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007439407       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007327742       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007262220       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007444912       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007355955       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007389150       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217007321809       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217007413117       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 2.378001e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007439407       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007405886       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007383155       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007435601       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007421959       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007434839       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217007415816       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 6.293736e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5697e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156861e-01 1 1  ON 0
 uu_1                 5.282886e-02 1 1  ON 1
 uu_2                -4.309901e-02 1 1  ON 2
 uu_3                -9.922303e-02 1 1  ON 3
 uu_4                -1.339230e-01 1 1  ON 4
 uu_5                -1.423926e-01 1 1  ON 5
 uu_6                -1.214871e-01 1 1  ON 6
 uu_7                -5.066056e-02 1 1  ON 7
 uu_8                 9.129134e-02 1 1  ON 8
 uu_9                 1.285891e-01 1 1  ON 9
 ud_0                 3.565964e-01 1 1  ON 10
 ud_1                 9.745276e-02 1 1  ON 11
 ud_2                -1.336075e-02 1 1  ON 12
 ud_3                -7.534237e-02 1 1  ON 13
 ud_4                -1.237973e-01 1 1  ON 14
 ud_5                -1.561971e-01 1 1  ON 15
 ud_6                -1.581545e-01 1 1  ON 16
 ud_7                -1.130688e-01 1 1  ON 17
 ud_8                -7.736165e-03 1 1  ON 18
 ud_9                 9.285064e-02 1 1  ON 19
 eO_0                -7.911910e-01 1 1  ON 20
 eO_1                -4.679863e-01 1 1  ON 21
 eO_2                -5.365297e-02 1 1  ON 22
 eO_3                 2.095356e-01 1 1  ON 23
 eO_4                 3.132970e-01 1 1  ON 24
 eO_5                 3.322564e-01 1 1  ON 25
 eO_6                 2.669169e-01 1 1  ON 26
 eO_7                 1.290631e-01 1 1  ON 27
 eO_8                 3.079574e-02 1 1  ON 28
 eO_9                 1.934649e-02 1 1  ON 29
eH1_0                -1.848146e-01 1 1  ON 30
eH1_1                -1.055146e-01 1 1  ON 31
eH1_2                -6.395578e-02 1 1  ON 32
eH1_3                -2.692543e-02 1 1  ON 33
eH1_4                 1.859882e-02 1 1  ON 34
eH1_5                 3.153039e-02 1 1  ON 35
eH1_6                 7.693960e-02 1 1  ON 36
eH1_7                 1.101067e-01 1 1  ON 37
eH1_8                 1.001438e-01 1 1  ON 38
eH1_9                 2.743928e-02 1 1  ON 39
eH2_0                -1.867113e-01 1 1  ON 40
eH2_1                -1.072264e-01 1 1  ON 41
eH2_2                -6.543151e-02 1 1  ON 42
eH2_3                -2.807507e-02 1 1  ON 43
eH2_4                 1.757862e-02 1 1  ON 44
eH2_5                 3.167960e-02 1 1  ON 45
eH2_6                 7.876570e-02 1 1  ON 46
eH2_7                 1.136627e-01 1 1  ON 47
eH2_8                 1.030015e-01 1 1  ON 48
eH2_9                 2.961107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1893
    reference variance = 0.371593
====================================================
  Execution time = 2.2275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1600e-01
  Total weights = 2.0000e+06
  Execution time = 1.8069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876037045
                                         uncertainty =       0.002746784404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315876037045
                                         uncertainty =       0.002746784404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397464541
  error estimate for blocks of size 2^( 2) =       0.000407286678
  error estimate for blocks of size 2^( 3) =       0.000416182759
  error estimate for blocks of size 2^( 4) =       0.000421953506
  error estimate for blocks of size 2^( 5) =       0.000426073681
  error estimate for blocks of size 2^( 6) =       0.000427089384
  error estimate for blocks of size 2^( 7) =       0.000428006934

      target function =                  N/A
              le_mean =     -17.216572264614
             les_mean =     296.726316508095
             stat err =       0.000425780876
             autocorr =       1.147560316548
              std dev =       0.562099745053
             le_variance =       0.315956123389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316000049559
                                         uncertainty =       0.002748901634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316000049559
                                         uncertainty =       0.002748901634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397542489
  error estimate for blocks of size 2^( 2) =       0.000407360769
  error estimate for blocks of size 2^( 3) =       0.000416252460
  error estimate for blocks of size 2^( 4) =       0.000422018480
  error estimate for blocks of size 2^( 5) =       0.000426135330
  error estimate for blocks of size 2^( 6) =       0.000427154170
  error estimate for blocks of size 2^( 7) =       0.000428069424

      target function =                  N/A
              le_mean =     -17.216572948605
             les_mean =     296.726463997938
             stat err =       0.000425844351
             autocorr =       1.147452391668
              std dev =       0.562209979752
             le_variance =       0.316080061333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957891587
                                         uncertainty =       0.002748355230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957891587
                                         uncertainty =       0.002748355230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397515979
  error estimate for blocks of size 2^( 2) =       0.000407335196
  error estimate for blocks of size 2^( 3) =       0.000416228282
  error estimate for blocks of size 2^( 4) =       0.000421995969
  error estimate for blocks of size 2^( 5) =       0.000426113728
  error estimate for blocks of size 2^( 6) =       0.000427131763
  error estimate for blocks of size 2^( 7) =       0.000428047231

      target function =                  N/A
              le_mean =     -17.216573094055
             les_mean =     296.726426851869
             stat err =       0.000425822173
             autocorr =       1.147485910148
              std dev =       0.562172488596
             le_variance =       0.316037906934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315887159837
                                         uncertainty =       0.002747018561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315887159837
                                         uncertainty =       0.002747018561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397471533
  error estimate for blocks of size 2^( 2) =       0.000407293191
  error estimate for blocks of size 2^( 3) =       0.000416188778
  error estimate for blocks of size 2^( 4) =       0.000421959091
  error estimate for blocks of size 2^( 5) =       0.000426078876
  error estimate for blocks of size 2^( 6) =       0.000427094938
  error estimate for blocks of size 2^( 7) =       0.000428012160

      target function =                  N/A
              le_mean =     -17.216572395437
             les_mean =     296.726332127681
             stat err =       0.000425786266
             autocorr =       1.147549001778
              std dev =       0.562109631951
             le_variance =       0.315967238332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216572264614        initial
     2.3283e-01     2.3283e+00             8.5724e-04       -17.216572948605
     9.3132e-01     9.3132e+00             2.3780e-04       -17.216573094055  <--
     3.7253e+00     3.7253e+01             6.2937e-05       -17.216572395437

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 3.1472e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.156861e-01 1 1  ON 0
 uu_1                 5.282886e-02 1 1  ON 1
 uu_2                -4.309901e-02 1 1  ON 2
 uu_3                -9.922303e-02 1 1  ON 3
 uu_4                -1.339230e-01 1 1  ON 4
 uu_5                -1.423926e-01 1 1  ON 5
 uu_6                -1.214871e-01 1 1  ON 6
 uu_7                -5.066056e-02 1 1  ON 7
 uu_8                 9.129134e-02 1 1  ON 8
 uu_9                 1.285891e-01 1 1  ON 9
 ud_0                 3.565964e-01 1 1  ON 10
 ud_1                 9.745276e-02 1 1  ON 11
 ud_2                -1.336075e-02 1 1  ON 12
 ud_3                -7.534237e-02 1 1  ON 13
 ud_4                -1.237973e-01 1 1  ON 14
 ud_5                -1.561971e-01 1 1  ON 15
 ud_6                -1.581545e-01 1 1  ON 16
 ud_7                -1.130688e-01 1 1  ON 17
 ud_8                -7.736165e-03 1 1  ON 18
 ud_9                 9.285064e-02 1 1  ON 19
 eO_0                -7.911910e-01 1 1  ON 20
 eO_1                -4.679863e-01 1 1  ON 21
 eO_2                -5.365297e-02 1 1  ON 22
 eO_3                 2.095356e-01 1 1  ON 23
 eO_4                 3.132970e-01 1 1  ON 24
 eO_5                 3.322564e-01 1 1  ON 25
 eO_6                 2.669169e-01 1 1  ON 26
 eO_7                 1.290631e-01 1 1  ON 27
 eO_8                 3.079574e-02 1 1  ON 28
 eO_9                 1.934649e-02 1 1  ON 29
eH1_0                -1.848146e-01 1 1  ON 30
eH1_1                -1.055146e-01 1 1  ON 31
eH1_2                -6.395578e-02 1 1  ON 32
eH1_3                -2.692543e-02 1 1  ON 33
eH1_4                 1.859882e-02 1 1  ON 34
eH1_5                 3.153039e-02 1 1  ON 35
eH1_6                 7.693960e-02 1 1  ON 36
eH1_7                 1.101067e-01 1 1  ON 37
eH1_8                 1.001438e-01 1 1  ON 38
eH1_9                 2.743928e-02 1 1  ON 39
eH2_0                -1.867113e-01 1 1  ON 40
eH2_1                -1.072264e-01 1 1  ON 41
eH2_2                -6.543151e-02 1 1  ON 42
eH2_3                -2.807507e-02 1 1  ON 43
eH2_4                 1.757862e-02 1 1  ON 44
eH2_5                 3.167960e-02 1 1  ON 45
eH2_6                 7.876570e-02 1 1  ON 46
eH2_7                 1.136627e-01 1 1  ON 47
eH2_8                 1.030015e-01 1 1  ON 48
eH2_9                 2.961107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.207334
====================================================
  Execution time = 2.2048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2231e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322317959127
                                         uncertainty =       0.004231748748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322317959127
                                         uncertainty =       0.004231748748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401441326
  error estimate for blocks of size 2^( 2) =       0.000410961819
  error estimate for blocks of size 2^( 3) =       0.000418968750
  error estimate for blocks of size 2^( 4) =       0.000425559420
  error estimate for blocks of size 2^( 5) =       0.000430121934
  error estimate for blocks of size 2^( 6) =       0.000432582709
  error estimate for blocks of size 2^( 7) =       0.000433392598

      target function =                  N/A
              le_mean =     -17.217166100370
             les_mean =     296.753118643451
             stat err =       0.000430414165
             autocorr =       1.149552880651
              std dev =       0.567723768106
             le_variance =       0.322310276873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716610037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166100370       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166008319       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217165774834       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217165531954       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166089167       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217167041385       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166906197       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217166778443       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217166850200       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e-01 is 6.418595e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166100370       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166057954       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217165971390       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217165837750       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166008307       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166238508       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166167086       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217166157435       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 2.005933e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166100370       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166086934       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166061110       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166016449       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166055002       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166105257       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166091409       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 5.715449e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7557e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156275e-01 1 1  ON 0
 uu_1                 5.278992e-02 1 1  ON 1
 uu_2                -4.304820e-02 1 1  ON 2
 uu_3                -9.921001e-02 1 1  ON 3
 uu_4                -1.339410e-01 1 1  ON 4
 uu_5                -1.423969e-01 1 1  ON 5
 uu_6                -1.214532e-01 1 1  ON 6
 uu_7                -5.068941e-02 1 1  ON 7
 uu_8                 9.122389e-02 1 1  ON 8
 uu_9                 1.286452e-01 1 1  ON 9
 ud_0                 3.566117e-01 1 1  ON 10
 ud_1                 9.747797e-02 1 1  ON 11
 ud_2                -1.332228e-02 1 1  ON 12
 ud_3                -7.535157e-02 1 1  ON 13
 ud_4                -1.237674e-01 1 1  ON 14
 ud_5                -1.561973e-01 1 1  ON 15
 ud_6                -1.582710e-01 1 1  ON 16
 ud_7                -1.130755e-01 1 1  ON 17
 ud_8                -7.781600e-03 1 1  ON 18
 ud_9                 9.286262e-02 1 1  ON 19
 eO_0                -7.913731e-01 1 1  ON 20
 eO_1                -4.680739e-01 1 1  ON 21
 eO_2                -5.385357e-02 1 1  ON 22
 eO_3                 2.094977e-01 1 1  ON 23
 eO_4                 3.133467e-01 1 1  ON 24
 eO_5                 3.323896e-01 1 1  ON 25
 eO_6                 2.670531e-01 1 1  ON 26
 eO_7                 1.292087e-01 1 1  ON 27
 eO_8                 3.082432e-02 1 1  ON 28
 eO_9                 1.935603e-02 1 1  ON 29
eH1_0                -1.847994e-01 1 1  ON 30
eH1_1                -1.055438e-01 1 1  ON 31
eH1_2                -6.404607e-02 1 1  ON 32
eH1_3                -2.693303e-02 1 1  ON 33
eH1_4                 1.857977e-02 1 1  ON 34
eH1_5                 3.153103e-02 1 1  ON 35
eH1_6                 7.692835e-02 1 1  ON 36
eH1_7                 1.101157e-01 1 1  ON 37
eH1_8                 1.002368e-01 1 1  ON 38
eH1_9                 2.747007e-02 1 1  ON 39
eH2_0                -1.867447e-01 1 1  ON 40
eH2_1                -1.071746e-01 1 1  ON 41
eH2_2                -6.539663e-02 1 1  ON 42
eH2_3                -2.807355e-02 1 1  ON 43
eH2_4                 1.758669e-02 1 1  ON 44
eH2_5                 3.155116e-02 1 1  ON 45
eH2_6                 7.870203e-02 1 1  ON 46
eH2_7                 1.136754e-01 1 1  ON 47
eH2_8                 1.030828e-01 1 1  ON 48
eH2_9                 2.963758e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.281538
====================================================
  Execution time = 1.9601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1848e-01
  Total weights = 2.0000e+06
  Execution time = 1.8039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318476699874
                                         uncertainty =       0.007418261332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318476699874
                                         uncertainty =       0.007418261332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399073338
  error estimate for blocks of size 2^( 2) =       0.000408567925
  error estimate for blocks of size 2^( 3) =       0.000417261343
  error estimate for blocks of size 2^( 4) =       0.000423790561
  error estimate for blocks of size 2^( 5) =       0.000427745013
  error estimate for blocks of size 2^( 6) =       0.000429407336
  error estimate for blocks of size 2^( 7) =       0.000429528303

      target function =                  N/A
              le_mean =     -17.216438389101
             les_mean =     296.724269704442
             stat err =       0.000427617803
             autocorr =       1.148169826592
              std dev =       0.564374926798
             le_variance =       0.318519057998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318401556656
                                         uncertainty =       0.007407624796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318401556656
                                         uncertainty =       0.007407624796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399026269
  error estimate for blocks of size 2^( 2) =       0.000408522620
  error estimate for blocks of size 2^( 3) =       0.000417217732
  error estimate for blocks of size 2^( 4) =       0.000423745883
  error estimate for blocks of size 2^( 5) =       0.000427697110
  error estimate for blocks of size 2^( 6) =       0.000429355249
  error estimate for blocks of size 2^( 7) =       0.000429469731

      target function =                  N/A
              le_mean =     -17.216437398131
             les_mean =     296.724160451893
             stat err =       0.000427566994
             autocorr =       1.148167813851
              std dev =       0.564308361924
             le_variance =       0.318443927337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318397398229
                                         uncertainty =       0.007408706047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318397398229
                                         uncertainty =       0.007408706047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399023670
  error estimate for blocks of size 2^( 2) =       0.000408520006
  error estimate for blocks of size 2^( 3) =       0.000417215782
  error estimate for blocks of size 2^( 4) =       0.000423745431
  error estimate for blocks of size 2^( 5) =       0.000427696997
  error estimate for blocks of size 2^( 6) =       0.000429355786
  error estimate for blocks of size 2^( 7) =       0.000429471102

      target function =                  N/A
              le_mean =     -17.216437920566
             les_mean =     296.724174291282
             stat err =       0.000427567329
             autocorr =       1.148184577545
              std dev =       0.564304685239
             le_variance =       0.318439777782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318461648778
                                         uncertainty =       0.007416627250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318461648778
                                         uncertainty =       0.007416627250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399063912
  error estimate for blocks of size 2^( 2) =       0.000408558848
  error estimate for blocks of size 2^( 3) =       0.000417252746
  error estimate for blocks of size 2^( 4) =       0.000423782147
  error estimate for blocks of size 2^( 5) =       0.000427736132
  error estimate for blocks of size 2^( 6) =       0.000429397878
  error estimate for blocks of size 2^( 7) =       0.000429517909

      target function =                  N/A
              le_mean =     -17.216438341040
             les_mean =     296.724253002848
             stat err =       0.000427608517
             autocorr =       1.148174195816
              std dev =       0.564361596194
             le_variance =       0.318504011259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216438389101        initial  <--
     2.3283e-01     2.3283e+00             6.4186e-04       -17.216437398131
     9.3132e-01     9.3132e+00             2.0059e-04       -17.216437920566
     3.7253e+00     3.7253e+01             5.7154e-05       -17.216438341040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7543
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.156861e-01 1 1  ON 0
 uu_1                 5.282886e-02 1 1  ON 1
 uu_2                -4.309901e-02 1 1  ON 2
 uu_3                -9.922303e-02 1 1  ON 3
 uu_4                -1.339230e-01 1 1  ON 4
 uu_5                -1.423926e-01 1 1  ON 5
 uu_6                -1.214871e-01 1 1  ON 6
 uu_7                -5.066056e-02 1 1  ON 7
 uu_8                 9.129134e-02 1 1  ON 8
 uu_9                 1.285891e-01 1 1  ON 9
 ud_0                 3.565964e-01 1 1  ON 10
 ud_1                 9.745276e-02 1 1  ON 11
 ud_2                -1.336075e-02 1 1  ON 12
 ud_3                -7.534237e-02 1 1  ON 13
 ud_4                -1.237973e-01 1 1  ON 14
 ud_5                -1.561971e-01 1 1  ON 15
 ud_6                -1.581545e-01 1 1  ON 16
 ud_7                -1.130688e-01 1 1  ON 17
 ud_8                -7.736165e-03 1 1  ON 18
 ud_9                 9.285064e-02 1 1  ON 19
 eO_0                -7.911910e-01 1 1  ON 20
 eO_1                -4.679863e-01 1 1  ON 21
 eO_2                -5.365297e-02 1 1  ON 22
 eO_3                 2.095356e-01 1 1  ON 23
 eO_4                 3.132970e-01 1 1  ON 24
 eO_5                 3.322564e-01 1 1  ON 25
 eO_6                 2.669169e-01 1 1  ON 26
 eO_7                 1.290631e-01 1 1  ON 27
 eO_8                 3.079574e-02 1 1  ON 28
 eO_9                 1.934649e-02 1 1  ON 29
eH1_0                -1.848146e-01 1 1  ON 30
eH1_1                -1.055146e-01 1 1  ON 31
eH1_2                -6.395578e-02 1 1  ON 32
eH1_3                -2.692543e-02 1 1  ON 33
eH1_4                 1.859882e-02 1 1  ON 34
eH1_5                 3.153039e-02 1 1  ON 35
eH1_6                 7.693960e-02 1 1  ON 36
eH1_7                 1.101067e-01 1 1  ON 37
eH1_8                 1.001438e-01 1 1  ON 38
eH1_9                 2.743928e-02 1 1  ON 39
eH2_0                -1.867113e-01 1 1  ON 40
eH2_1                -1.072264e-01 1 1  ON 41
eH2_2                -6.543151e-02 1 1  ON 42
eH2_3                -2.807507e-02 1 1  ON 43
eH2_4                 1.757862e-02 1 1  ON 44
eH2_5                 3.167960e-02 1 1  ON 45
eH2_6                 7.876570e-02 1 1  ON 46
eH2_7                 1.136627e-01 1 1  ON 47
eH2_8                 1.030015e-01 1 1  ON 48
eH2_9                 2.961107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.497149
====================================================
  Execution time = 1.9929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327177003592
                                         uncertainty =       0.004383480507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327177003592
                                         uncertainty =       0.004383480507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404397246
  error estimate for blocks of size 2^( 2) =       0.000413984565
  error estimate for blocks of size 2^( 3) =       0.000422451094
  error estimate for blocks of size 2^( 4) =       0.000429065762
  error estimate for blocks of size 2^( 5) =       0.000432700642
  error estimate for blocks of size 2^( 6) =       0.000436153712
  error estimate for blocks of size 2^( 7) =       0.000437311320

      target function =                  N/A
              le_mean =     -17.216316302237
             les_mean =     296.728621119784
             stat err =       0.000433807859
             autocorr =       1.150743295486
              std dev =       0.571904069450
             le_variance =       0.327074264654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631630224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316302237       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216316420708       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216316785000       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317178405       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216317149471       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216317136577       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216317176389       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216317182020       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 9.370044e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316302237       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216316333568       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216316428122       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216316539315       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216316537145       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216316537034       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216316544794       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.357575e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316302237       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216316310185       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216316334049       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216316362818       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216316362663       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216316362874       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216316364676       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.924840e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5475e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156817e-01 1 1  ON 0
 uu_1                 5.283570e-02 1 1  ON 1
 uu_2                -4.309365e-02 1 1  ON 2
 uu_3                -9.922532e-02 1 1  ON 3
 uu_4                -1.339332e-01 1 1  ON 4
 uu_5                -1.423889e-01 1 1  ON 5
 uu_6                -1.214848e-01 1 1  ON 6
 uu_7                -5.066882e-02 1 1  ON 7
 uu_8                 9.128183e-02 1 1  ON 8
 uu_9                 1.285945e-01 1 1  ON 9
 ud_0                 3.566136e-01 1 1  ON 10
 ud_1                 9.744536e-02 1 1  ON 11
 ud_2                -1.336582e-02 1 1  ON 12
 ud_3                -7.534281e-02 1 1  ON 13
 ud_4                -1.238022e-01 1 1  ON 14
 ud_5                -1.561867e-01 1 1  ON 15
 ud_6                -1.581590e-01 1 1  ON 16
 ud_7                -1.130737e-01 1 1  ON 17
 ud_8                -7.744401e-03 1 1  ON 18
 ud_9                 9.285038e-02 1 1  ON 19
 eO_0                -7.912145e-01 1 1  ON 20
 eO_1                -4.679951e-01 1 1  ON 21
 eO_2                -5.366912e-02 1 1  ON 22
 eO_3                 2.095327e-01 1 1  ON 23
 eO_4                 3.133006e-01 1 1  ON 24
 eO_5                 3.322738e-01 1 1  ON 25
 eO_6                 2.669308e-01 1 1  ON 26
 eO_7                 1.290758e-01 1 1  ON 27
 eO_8                 3.079722e-02 1 1  ON 28
 eO_9                 1.934740e-02 1 1  ON 29
eH1_0                -1.848219e-01 1 1  ON 30
eH1_1                -1.055103e-01 1 1  ON 31
eH1_2                -6.396053e-02 1 1  ON 32
eH1_3                -2.691590e-02 1 1  ON 33
eH1_4                 1.858671e-02 1 1  ON 34
eH1_5                 3.153147e-02 1 1  ON 35
eH1_6                 7.693981e-02 1 1  ON 36
eH1_7                 1.101062e-01 1 1  ON 37
eH1_8                 1.001498e-01 1 1  ON 38
eH1_9                 2.744147e-02 1 1  ON 39
eH2_0                -1.867075e-01 1 1  ON 40
eH2_1                -1.072160e-01 1 1  ON 41
eH2_2                -6.542568e-02 1 1  ON 42
eH2_3                -2.806676e-02 1 1  ON 43
eH2_4                 1.757466e-02 1 1  ON 44
eH2_5                 3.165603e-02 1 1  ON 45
eH2_6                 7.875354e-02 1 1  ON 46
eH2_7                 1.136619e-01 1 1  ON 47
eH2_8                 1.030097e-01 1 1  ON 48
eH2_9                 2.961385e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.23007
====================================================
  Execution time = 1.9522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317825415018
                                         uncertainty =       0.003196412935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317825415018
                                         uncertainty =       0.003196412935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398638774
  error estimate for blocks of size 2^( 2) =       0.000408190065
  error estimate for blocks of size 2^( 3) =       0.000416994416
  error estimate for blocks of size 2^( 4) =       0.000422762498
  error estimate for blocks of size 2^( 5) =       0.000427225635
  error estimate for blocks of size 2^( 6) =       0.000428609081
  error estimate for blocks of size 2^( 7) =       0.000428509270

      target function =                  N/A
              le_mean =     -17.217487525671
             les_mean =     296.759702281901
             stat err =       0.000426776621
             autocorr =       1.146151862941
              std dev =       0.563760360592
             le_variance =       0.317825744174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317891604953
                                         uncertainty =       0.003197119359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317891604953
                                         uncertainty =       0.003197119359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398680282
  error estimate for blocks of size 2^( 2) =       0.000408229083
  error estimate for blocks of size 2^( 3) =       0.000417031676
  error estimate for blocks of size 2^( 4) =       0.000422798408
  error estimate for blocks of size 2^( 5) =       0.000427261020
  error estimate for blocks of size 2^( 6) =       0.000428642723
  error estimate for blocks of size 2^( 7) =       0.000428544358

      target function =                  N/A
              le_mean =     -17.217487311591
             les_mean =     296.759761099874
             stat err =       0.000426811627
             autocorr =       1.146101210169
              std dev =       0.563819061414
             le_variance =       0.317891934013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317865448305
                                         uncertainty =       0.003196835963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317865448305
                                         uncertainty =       0.003196835963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398663880
  error estimate for blocks of size 2^( 2) =       0.000408213679
  error estimate for blocks of size 2^( 3) =       0.000417017015
  error estimate for blocks of size 2^( 4) =       0.000422784278
  error estimate for blocks of size 2^( 5) =       0.000427247121
  error estimate for blocks of size 2^( 6) =       0.000428629533
  error estimate for blocks of size 2^( 7) =       0.000428530614

      target function =                  N/A
              le_mean =     -17.217487385137
             les_mean =     296.759737476448
             stat err =       0.000426797886
             autocorr =       1.146121718611
              std dev =       0.563795865566
             le_variance =       0.317865778029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317830591943
                                         uncertainty =       0.003196467386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317830591943
                                         uncertainty =       0.003196467386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398642021
  error estimate for blocks of size 2^( 2) =       0.000408193118
  error estimate for blocks of size 2^( 3) =       0.000416997338
  error estimate for blocks of size 2^( 4) =       0.000422765314
  error estimate for blocks of size 2^( 5) =       0.000427228413
  error estimate for blocks of size 2^( 6) =       0.000428611725
  error estimate for blocks of size 2^( 7) =       0.000428512030

      target function =                  N/A
              le_mean =     -17.217487506579
             les_mean =     296.759706801466
             stat err =       0.000426779371
             autocorr =       1.146147961016
              std dev =       0.563764952056
             le_variance =       0.317830921167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217487525671        initial  <--
     2.3283e+00     2.3283e+01             9.3700e-05       -17.217487311591
     9.3132e+00     9.3132e+01             2.3576e-05       -17.217487385137
     3.7253e+01     3.7253e+02             5.9248e-06       -17.217487506579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7228
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.156861e-01 1 1  ON 0
 uu_1                 5.282886e-02 1 1  ON 1
 uu_2                -4.309901e-02 1 1  ON 2
 uu_3                -9.922303e-02 1 1  ON 3
 uu_4                -1.339230e-01 1 1  ON 4
 uu_5                -1.423926e-01 1 1  ON 5
 uu_6                -1.214871e-01 1 1  ON 6
 uu_7                -5.066056e-02 1 1  ON 7
 uu_8                 9.129134e-02 1 1  ON 8
 uu_9                 1.285891e-01 1 1  ON 9
 ud_0                 3.565964e-01 1 1  ON 10
 ud_1                 9.745276e-02 1 1  ON 11
 ud_2                -1.336075e-02 1 1  ON 12
 ud_3                -7.534237e-02 1 1  ON 13
 ud_4                -1.237973e-01 1 1  ON 14
 ud_5                -1.561971e-01 1 1  ON 15
 ud_6                -1.581545e-01 1 1  ON 16
 ud_7                -1.130688e-01 1 1  ON 17
 ud_8                -7.736165e-03 1 1  ON 18
 ud_9                 9.285064e-02 1 1  ON 19
 eO_0                -7.911910e-01 1 1  ON 20
 eO_1                -4.679863e-01 1 1  ON 21
 eO_2                -5.365297e-02 1 1  ON 22
 eO_3                 2.095356e-01 1 1  ON 23
 eO_4                 3.132970e-01 1 1  ON 24
 eO_5                 3.322564e-01 1 1  ON 25
 eO_6                 2.669169e-01 1 1  ON 26
 eO_7                 1.290631e-01 1 1  ON 27
 eO_8                 3.079574e-02 1 1  ON 28
 eO_9                 1.934649e-02 1 1  ON 29
eH1_0                -1.848146e-01 1 1  ON 30
eH1_1                -1.055146e-01 1 1  ON 31
eH1_2                -6.395578e-02 1 1  ON 32
eH1_3                -2.692543e-02 1 1  ON 33
eH1_4                 1.859882e-02 1 1  ON 34
eH1_5                 3.153039e-02 1 1  ON 35
eH1_6                 7.693960e-02 1 1  ON 36
eH1_7                 1.101067e-01 1 1  ON 37
eH1_8                 1.001438e-01 1 1  ON 38
eH1_9                 2.743928e-02 1 1  ON 39
eH2_0                -1.867113e-01 1 1  ON 40
eH2_1                -1.072264e-01 1 1  ON 41
eH2_2                -6.543151e-02 1 1  ON 42
eH2_3                -2.807507e-02 1 1  ON 43
eH2_4                 1.757862e-02 1 1  ON 44
eH2_5                 3.167960e-02 1 1  ON 45
eH2_6                 7.876570e-02 1 1  ON 46
eH2_7                 1.136627e-01 1 1  ON 47
eH2_8                 1.030015e-01 1 1  ON 48
eH2_9                 2.961107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.190738
====================================================
  Execution time = 2.0561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324703231515
                                         uncertainty =       0.007402258906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324703231515
                                         uncertainty =       0.007402258906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402921638
  error estimate for blocks of size 2^( 2) =       0.000413108923
  error estimate for blocks of size 2^( 3) =       0.000422362591
  error estimate for blocks of size 2^( 4) =       0.000429001433
  error estimate for blocks of size 2^( 5) =       0.000432834390
  error estimate for blocks of size 2^( 6) =       0.000435627494
  error estimate for blocks of size 2^( 7) =       0.000438042880

      target function =                  N/A
              le_mean =     -17.216930365104
             les_mean =     296.747382727919
             stat err =       0.000433876549
             autocorr =       1.159554518023
              std dev =       0.569817245649
             le_variance =       0.324691693440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693036510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930365104       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930377156       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930405284       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930411019       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930421285       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930413217       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930417415       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.487901e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930365104       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930368133       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930375241       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930376654       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930379251       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930377249       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930378291       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.874103e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930365104       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930365862       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930367644       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930367996       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930368647       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930368148       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930368407       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.686589e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156862e-01 1 1  ON 0
 uu_1                 5.282754e-02 1 1  ON 1
 uu_2                -4.309873e-02 1 1  ON 2
 uu_3                -9.922367e-02 1 1  ON 3
 uu_4                -1.339239e-01 1 1  ON 4
 uu_5                -1.423927e-01 1 1  ON 5
 uu_6                -1.214859e-01 1 1  ON 6
 uu_7                -5.066056e-02 1 1  ON 7
 uu_8                 9.129087e-02 1 1  ON 8
 uu_9                 1.285898e-01 1 1  ON 9
 ud_0                 3.565977e-01 1 1  ON 10
 ud_1                 9.745229e-02 1 1  ON 11
 ud_2                -1.336078e-02 1 1  ON 12
 ud_3                -7.534254e-02 1 1  ON 13
 ud_4                -1.237972e-01 1 1  ON 14
 ud_5                -1.561969e-01 1 1  ON 15
 ud_6                -1.581549e-01 1 1  ON 16
 ud_7                -1.130697e-01 1 1  ON 17
 ud_8                -7.737320e-03 1 1  ON 18
 ud_9                 9.285076e-02 1 1  ON 19
 eO_0                -7.911925e-01 1 1  ON 20
 eO_1                -4.679882e-01 1 1  ON 21
 eO_2                -5.365410e-02 1 1  ON 22
 eO_3                 2.095344e-01 1 1  ON 23
 eO_4                 3.132975e-01 1 1  ON 24
 eO_5                 3.322579e-01 1 1  ON 25
 eO_6                 2.669184e-01 1 1  ON 26
 eO_7                 1.290646e-01 1 1  ON 27
 eO_8                 3.079605e-02 1 1  ON 28
 eO_9                 1.934664e-02 1 1  ON 29
eH1_0                -1.848151e-01 1 1  ON 30
eH1_1                -1.055147e-01 1 1  ON 31
eH1_2                -6.395627e-02 1 1  ON 32
eH1_3                -2.692491e-02 1 1  ON 33
eH1_4                 1.859707e-02 1 1  ON 34
eH1_5                 3.153072e-02 1 1  ON 35
eH1_6                 7.694019e-02 1 1  ON 36
eH1_7                 1.101068e-01 1 1  ON 37
eH1_8                 1.001446e-01 1 1  ON 38
eH1_9                 2.743954e-02 1 1  ON 39
eH2_0                -1.867104e-01 1 1  ON 40
eH2_1                -1.072254e-01 1 1  ON 41
eH2_2                -6.543175e-02 1 1  ON 42
eH2_3                -2.807556e-02 1 1  ON 43
eH2_4                 1.757873e-02 1 1  ON 44
eH2_5                 3.167872e-02 1 1  ON 45
eH2_6                 7.876450e-02 1 1  ON 46
eH2_7                 1.136623e-01 1 1  ON 47
eH2_8                 1.030022e-01 1 1  ON 48
eH2_9                 2.961137e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.345971
====================================================
  Execution time = 1.9761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1509e-01
  Total weights = 2.0000e+06
  Execution time = 1.8251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314973960112
                                         uncertainty =       0.003579518423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314973960112
                                         uncertainty =       0.003579518423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396918457
  error estimate for blocks of size 2^( 2) =       0.000406893802
  error estimate for blocks of size 2^( 3) =       0.000415088614
  error estimate for blocks of size 2^( 4) =       0.000421554706
  error estimate for blocks of size 2^( 5) =       0.000425825407
  error estimate for blocks of size 2^( 6) =       0.000431131508
  error estimate for blocks of size 2^( 7) =       0.000430303838

      target function =                  N/A
              le_mean =     -17.216191567742
             les_mean =     296.712340462932
             stat err =       0.000427203865
             autocorr =       1.158424560442
              std dev =       0.561327465277
             le_variance =       0.315088523274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314978174134
                                         uncertainty =       0.003579535931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314978174134
                                         uncertainty =       0.003579535931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396921110
  error estimate for blocks of size 2^( 2) =       0.000406896336
  error estimate for blocks of size 2^( 3) =       0.000415091047
  error estimate for blocks of size 2^( 4) =       0.000421557085
  error estimate for blocks of size 2^( 5) =       0.000425827793
  error estimate for blocks of size 2^( 6) =       0.000431133976
  error estimate for blocks of size 2^( 7) =       0.000430306186

      target function =                  N/A
              le_mean =     -17.216191581543
             les_mean =     296.712345149969
             stat err =       0.000427206260
             autocorr =       1.158422065712
              std dev =       0.561331216959
             le_variance =       0.315092735133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314976093988
                                         uncertainty =       0.003579527276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314976093988
                                         uncertainty =       0.003579527276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396919800
  error estimate for blocks of size 2^( 2) =       0.000406895085
  error estimate for blocks of size 2^( 3) =       0.000415089846
  error estimate for blocks of size 2^( 4) =       0.000421555910
  error estimate for blocks of size 2^( 5) =       0.000425826615
  error estimate for blocks of size 2^( 6) =       0.000431132758
  error estimate for blocks of size 2^( 7) =       0.000430305028

      target function =                  N/A
              le_mean =     -17.216191574698
             les_mean =     296.712342835215
             stat err =       0.000427205078
             autocorr =       1.158423299028
              std dev =       0.561329365033
             le_variance =       0.315090656048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314974227664
                                         uncertainty =       0.003579519533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314974227664
                                         uncertainty =       0.003579519533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396918626
  error estimate for blocks of size 2^( 2) =       0.000406893963
  error estimate for blocks of size 2^( 3) =       0.000415088769
  error estimate for blocks of size 2^( 4) =       0.000421554857
  error estimate for blocks of size 2^( 5) =       0.000425825558
  error estimate for blocks of size 2^( 6) =       0.000431131665
  error estimate for blocks of size 2^( 7) =       0.000430303987

      target function =                  N/A
              le_mean =     -17.216191568610
             les_mean =     296.712340760221
             stat err =       0.000427204017
             autocorr =       1.158424402311
              std dev =       0.561327703474
             le_variance =       0.315088790687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216191567742        initial
     2.3283e+01     2.3283e+02             7.4879e-06       -17.216191581543  <--
     9.3132e+01     9.3132e+02             1.8741e-06       -17.216191574698
     3.7253e+02     3.7253e+03             4.6866e-07       -17.216191568610

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.8929e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.156864e-01 1 1  ON 0
 uu_1                 5.282362e-02 1 1  ON 1
 uu_2                -4.309794e-02 1 1  ON 2
 uu_3                -9.922559e-02 1 1  ON 3
 uu_4                -1.339269e-01 1 1  ON 4
 uu_5                -1.423929e-01 1 1  ON 5
 uu_6                -1.214821e-01 1 1  ON 6
 uu_7                -5.066054e-02 1 1  ON 7
 uu_8                 9.128948e-02 1 1  ON 8
 uu_9                 1.285918e-01 1 1  ON 9
 ud_0                 3.566015e-01 1 1  ON 10
 ud_1                 9.745094e-02 1 1  ON 11
 ud_2                -1.336086e-02 1 1  ON 12
 ud_3                -7.534303e-02 1 1  ON 13
 ud_4                -1.237968e-01 1 1  ON 14
 ud_5                -1.561962e-01 1 1  ON 15
 ud_6                -1.581561e-01 1 1  ON 16
 ud_7                -1.130723e-01 1 1  ON 17
 ud_8                -7.740777e-03 1 1  ON 18
 ud_9                 9.285114e-02 1 1  ON 19
 eO_0                -7.911969e-01 1 1  ON 20
 eO_1                -4.679938e-01 1 1  ON 21
 eO_2                -5.365746e-02 1 1  ON 22
 eO_3                 2.095307e-01 1 1  ON 23
 eO_4                 3.132991e-01 1 1  ON 24
 eO_5                 3.322624e-01 1 1  ON 25
 eO_6                 2.669231e-01 1 1  ON 26
 eO_7                 1.290689e-01 1 1  ON 27
 eO_8                 3.079696e-02 1 1  ON 28
 eO_9                 1.934709e-02 1 1  ON 29
eH1_0                -1.848165e-01 1 1  ON 30
eH1_1                -1.055149e-01 1 1  ON 31
eH1_2                -6.395775e-02 1 1  ON 32
eH1_3                -2.692335e-02 1 1  ON 33
eH1_4                 1.859184e-02 1 1  ON 34
eH1_5                 3.153169e-02 1 1  ON 35
eH1_6                 7.694196e-02 1 1  ON 36
eH1_7                 1.101071e-01 1 1  ON 37
eH1_8                 1.001470e-01 1 1  ON 38
eH1_9                 2.744033e-02 1 1  ON 39
eH2_0                -1.867079e-01 1 1  ON 40
eH2_1                -1.072224e-01 1 1  ON 41
eH2_2                -6.543245e-02 1 1  ON 42
eH2_3                -2.807703e-02 1 1  ON 43
eH2_4                 1.757904e-02 1 1  ON 44
eH2_5                 3.167608e-02 1 1  ON 45
eH2_6                 7.876093e-02 1 1  ON 46
eH2_7                 1.136612e-01 1 1  ON 47
eH2_8                 1.030045e-01 1 1  ON 48
eH2_9                 2.961227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4980e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1441
    reference variance = 0.198131
====================================================
  Execution time = 2.0160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1733e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317339157665
                                         uncertainty =       0.003505496066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317339157665
                                         uncertainty =       0.003505496066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398326702
  error estimate for blocks of size 2^( 2) =       0.000408297253
  error estimate for blocks of size 2^( 3) =       0.000416691909
  error estimate for blocks of size 2^( 4) =       0.000422910959
  error estimate for blocks of size 2^( 5) =       0.000426462796
  error estimate for blocks of size 2^( 6) =       0.000428493092
  error estimate for blocks of size 2^( 7) =       0.000431168438

      target function =                  N/A
              le_mean =     -17.216533025585
             les_mean =     296.726337586138
             stat err =       0.000427258821
             autocorr =       1.150544005495
              std dev =       0.563319024823
             le_variance =       0.317328323727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653302559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533025585       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533027955       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216532929774       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216532996182       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216532975048       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216532963976       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216532968970       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 4.398351e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533025585       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533026191       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533000863       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216533016987       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216533010849       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216533008544       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216533009909       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.124777e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533025585       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533025738       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533019355       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216533023339       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216533021742       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216533021216       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216533021562       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.828754e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5743e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156872e-01 1 1  ON 0
 uu_1                 5.282611e-02 1 1  ON 1
 uu_2                -4.309881e-02 1 1  ON 2
 uu_3                -9.922458e-02 1 1  ON 3
 uu_4                -1.339286e-01 1 1  ON 4
 uu_5                -1.423918e-01 1 1  ON 5
 uu_6                -1.214828e-01 1 1  ON 6
 uu_7                -5.066435e-02 1 1  ON 7
 uu_8                 9.128642e-02 1 1  ON 8
 uu_9                 1.285938e-01 1 1  ON 9
 ud_0                 3.566018e-01 1 1  ON 10
 ud_1                 9.745200e-02 1 1  ON 11
 ud_2                -1.336062e-02 1 1  ON 12
 ud_3                -7.534040e-02 1 1  ON 13
 ud_4                -1.237940e-01 1 1  ON 14
 ud_5                -1.561960e-01 1 1  ON 15
 ud_6                -1.581567e-01 1 1  ON 16
 ud_7                -1.130747e-01 1 1  ON 17
 ud_8                -7.745972e-03 1 1  ON 18
 ud_9                 9.285034e-02 1 1  ON 19
 eO_0                -7.912081e-01 1 1  ON 20
 eO_1                -4.679944e-01 1 1  ON 21
 eO_2                -5.366380e-02 1 1  ON 22
 eO_3                 2.095293e-01 1 1  ON 23
 eO_4                 3.133001e-01 1 1  ON 24
 eO_5                 3.322690e-01 1 1  ON 25
 eO_6                 2.669288e-01 1 1  ON 26
 eO_7                 1.290742e-01 1 1  ON 27
 eO_8                 3.079765e-02 1 1  ON 28
 eO_9                 1.934718e-02 1 1  ON 29
eH1_0                -1.848133e-01 1 1  ON 30
eH1_1                -1.055191e-01 1 1  ON 31
eH1_2                -6.395932e-02 1 1  ON 32
eH1_3                -2.691954e-02 1 1  ON 33
eH1_4                 1.858883e-02 1 1  ON 34
eH1_5                 3.152974e-02 1 1  ON 35
eH1_6                 7.694036e-02 1 1  ON 36
eH1_7                 1.101081e-01 1 1  ON 37
eH1_8                 1.001503e-01 1 1  ON 38
eH1_9                 2.744121e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.072182e-01 1 1  ON 41
eH2_2                -6.543356e-02 1 1  ON 42
eH2_3                -2.807451e-02 1 1  ON 43
eH2_4                 1.757847e-02 1 1  ON 44
eH2_5                 3.167330e-02 1 1  ON 45
eH2_6                 7.875948e-02 1 1  ON 46
eH2_7                 1.136598e-01 1 1  ON 47
eH2_8                 1.030068e-01 1 1  ON 48
eH2_9                 2.961334e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1562
    reference variance = 0.358584
====================================================
  Execution time = 1.9414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1781e-01
  Total weights = 2.0000e+06
  Execution time = 1.8124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317729737164
                                         uncertainty =       0.003004709664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317729737164
                                         uncertainty =       0.003004709664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398625954
  error estimate for blocks of size 2^( 2) =       0.000408203163
  error estimate for blocks of size 2^( 3) =       0.000416898087
  error estimate for blocks of size 2^( 4) =       0.000423304707
  error estimate for blocks of size 2^( 5) =       0.000426612447
  error estimate for blocks of size 2^( 6) =       0.000429696698
  error estimate for blocks of size 2^( 7) =       0.000427610734

      target function =                  N/A
              le_mean =     -17.217215589827
             les_mean =     296.750317809540
             stat err =       0.000426806147
             autocorr =       1.146384189548
              std dev =       0.563742229965
             le_variance =       0.317805301846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317735874786
                                         uncertainty =       0.003004792235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317735874786
                                         uncertainty =       0.003004792235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398629797
  error estimate for blocks of size 2^( 2) =       0.000408206620
  error estimate for blocks of size 2^( 3) =       0.000416901303
  error estimate for blocks of size 2^( 4) =       0.000423307883
  error estimate for blocks of size 2^( 5) =       0.000426615738
  error estimate for blocks of size 2^( 6) =       0.000429700224
  error estimate for blocks of size 2^( 7) =       0.000427614347

      target function =                  N/A
              le_mean =     -17.217215759351
             les_mean =     296.750329775576
             stat err =       0.000426809548
             autocorr =       1.146380354876
              std dev =       0.563747665559
             le_variance =       0.317811430424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317732956181
                                         uncertainty =       0.003004752546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317732956181
                                         uncertainty =       0.003004752546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398627970
  error estimate for blocks of size 2^( 2) =       0.000408204976
  error estimate for blocks of size 2^( 3) =       0.000416899773
  error estimate for blocks of size 2^( 4) =       0.000423306371
  error estimate for blocks of size 2^( 5) =       0.000426614177
  error estimate for blocks of size 2^( 6) =       0.000429698551
  error estimate for blocks of size 2^( 7) =       0.000427612626

      target function =                  N/A
              le_mean =     -17.217215678807
             les_mean =     296.750324087795
             stat err =       0.000426807931
             autocorr =       1.146382182188
              std dev =       0.563745080822
             le_variance =       0.317808516151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317730144089
                                         uncertainty =       0.003004715077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317730144089
                                         uncertainty =       0.003004715077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398626208
  error estimate for blocks of size 2^( 2) =       0.000408203392
  error estimate for blocks of size 2^( 3) =       0.000416898300
  error estimate for blocks of size 2^( 4) =       0.000423304917
  error estimate for blocks of size 2^( 5) =       0.000426612666
  error estimate for blocks of size 2^( 6) =       0.000429696932
  error estimate for blocks of size 2^( 7) =       0.000427610973

      target function =                  N/A
              le_mean =     -17.217215601040
             les_mean =     296.750318601960
             stat err =       0.000426806372
             autocorr =       1.146383935591
              std dev =       0.563742590351
             le_variance =       0.317805708175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217215589827        initial
     5.8208e+00     5.8208e+01             4.3984e-05       -17.217215759351  <--
     2.3283e+01     2.3283e+02             1.1248e-05       -17.217215678807
     9.3132e+01     9.3132e+02             2.8288e-06       -17.217215601040

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.8637e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.156901e-01 1 1  ON 0
 uu_1                 5.283302e-02 1 1  ON 1
 uu_2                -4.310098e-02 1 1  ON 2
 uu_3                -9.922189e-02 1 1  ON 3
 uu_4                -1.339332e-01 1 1  ON 4
 uu_5                -1.423885e-01 1 1  ON 5
 uu_6                -1.214849e-01 1 1  ON 6
 uu_7                -5.067574e-02 1 1  ON 7
 uu_8                 9.127726e-02 1 1  ON 8
 uu_9                 1.285999e-01 1 1  ON 9
 ud_0                 3.566030e-01 1 1  ON 10
 ud_1                 9.745518e-02 1 1  ON 11
 ud_2                -1.335961e-02 1 1  ON 12
 ud_3                -7.533285e-02 1 1  ON 13
 ud_4                -1.237858e-01 1 1  ON 14
 ud_5                -1.561954e-01 1 1  ON 15
 ud_6                -1.581584e-01 1 1  ON 16
 ud_7                -1.130819e-01 1 1  ON 17
 ud_8                -7.761540e-03 1 1  ON 18
 ud_9                 9.284793e-02 1 1  ON 19
 eO_0                -7.912408e-01 1 1  ON 20
 eO_1                -4.679974e-01 1 1  ON 21
 eO_2                -5.368259e-02 1 1  ON 22
 eO_3                 2.095253e-01 1 1  ON 23
 eO_4                 3.133032e-01 1 1  ON 24
 eO_5                 3.322888e-01 1 1  ON 25
 eO_6                 2.669457e-01 1 1  ON 26
 eO_7                 1.290901e-01 1 1  ON 27
 eO_8                 3.079969e-02 1 1  ON 28
 eO_9                 1.934745e-02 1 1  ON 29
eH1_0                -1.848040e-01 1 1  ON 30
eH1_1                -1.055313e-01 1 1  ON 31
eH1_2                -6.396375e-02 1 1  ON 32
eH1_3                -2.690874e-02 1 1  ON 33
eH1_4                 1.858020e-02 1 1  ON 34
eH1_5                 3.152379e-02 1 1  ON 35
eH1_6                 7.693552e-02 1 1  ON 36
eH1_7                 1.101112e-01 1 1  ON 37
eH1_8                 1.001604e-01 1 1  ON 38
eH1_9                 2.744387e-02 1 1  ON 39
eH2_0                -1.867206e-01 1 1  ON 40
eH2_1                -1.072059e-01 1 1  ON 41
eH2_2                -6.543642e-02 1 1  ON 42
eH2_3                -2.806737e-02 1 1  ON 43
eH2_4                 1.757694e-02 1 1  ON 44
eH2_5                 3.166493e-02 1 1  ON 45
eH2_6                 7.875514e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030138e-01 1 1  ON 48
eH2_9                 2.961656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4387e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2092
    reference variance = 0.280955
====================================================
  Execution time = 1.9923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312724686
                                         uncertainty =       0.004803534321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312724686
                                         uncertainty =       0.004803534321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402639318
  error estimate for blocks of size 2^( 2) =       0.000412306137
  error estimate for blocks of size 2^( 3) =       0.000420471268
  error estimate for blocks of size 2^( 4) =       0.000427183499
  error estimate for blocks of size 2^( 5) =       0.000431168419
  error estimate for blocks of size 2^( 6) =       0.000433639320
  error estimate for blocks of size 2^( 7) =       0.000434774489

      target function =                  N/A
              le_mean =     -17.216587392705
             les_mean =     296.735118129598
             stat err =       0.000431691432
             autocorr =       1.149514607025
              std dev =       0.569417984482
             le_variance =       0.324236841052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658739271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587392705       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587416223       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216586945349       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587307858       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587393213       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587271776       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587362042       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.084001e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587392705       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587399116       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587264731       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587364947       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587386499       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587349344       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587371150       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.853787e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587392705       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587394345       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587359503       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587385240       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587390637       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587380902       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587386215       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.247701e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5476e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156854e-01 1 1  ON 0
 uu_1                 5.284162e-02 1 1  ON 1
 uu_2                -4.309899e-02 1 1  ON 2
 uu_3                -9.921377e-02 1 1  ON 3
 uu_4                -1.339328e-01 1 1  ON 4
 uu_5                -1.423994e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.067766e-02 1 1  ON 7
 uu_8                 9.126612e-02 1 1  ON 8
 uu_9                 1.286083e-01 1 1  ON 9
 ud_0                 3.565897e-01 1 1  ON 10
 ud_1                 9.746225e-02 1 1  ON 11
 ud_2                -1.335590e-02 1 1  ON 12
 ud_3                -7.533328e-02 1 1  ON 13
 ud_4                -1.237836e-01 1 1  ON 14
 ud_5                -1.561970e-01 1 1  ON 15
 ud_6                -1.581519e-01 1 1  ON 16
 ud_7                -1.130838e-01 1 1  ON 17
 ud_8                -7.775979e-03 1 1  ON 18
 ud_9                 9.284890e-02 1 1  ON 19
 eO_0                -7.912694e-01 1 1  ON 20
 eO_1                -4.680157e-01 1 1  ON 21
 eO_2                -5.370452e-02 1 1  ON 22
 eO_3                 2.095134e-01 1 1  ON 23
 eO_4                 3.133141e-01 1 1  ON 24
 eO_5                 3.323089e-01 1 1  ON 25
 eO_6                 2.669647e-01 1 1  ON 26
 eO_7                 1.291132e-01 1 1  ON 27
 eO_8                 3.080465e-02 1 1  ON 28
 eO_9                 1.934889e-02 1 1  ON 29
eH1_0                -1.848050e-01 1 1  ON 30
eH1_1                -1.055520e-01 1 1  ON 31
eH1_2                -6.396617e-02 1 1  ON 32
eH1_3                -2.690088e-02 1 1  ON 33
eH1_4                 1.857691e-02 1 1  ON 34
eH1_5                 3.152969e-02 1 1  ON 35
eH1_6                 7.693229e-02 1 1  ON 36
eH1_7                 1.101099e-01 1 1  ON 37
eH1_8                 1.001719e-01 1 1  ON 38
eH1_9                 2.744862e-02 1 1  ON 39
eH2_0                -1.867157e-01 1 1  ON 40
eH2_1                -1.072136e-01 1 1  ON 41
eH2_2                -6.543678e-02 1 1  ON 42
eH2_3                -2.806284e-02 1 1  ON 43
eH2_4                 1.756325e-02 1 1  ON 44
eH2_5                 3.166320e-02 1 1  ON 45
eH2_6                 7.874701e-02 1 1  ON 46
eH2_7                 1.136567e-01 1 1  ON 47
eH2_8                 1.030289e-01 1 1  ON 48
eH2_9                 2.962110e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2147
    reference variance = 0.179739
====================================================
  Execution time = 1.9487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2168e-01
  Total weights = 2.0000e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321719117602
                                         uncertainty =       0.005267313298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321719117602
                                         uncertainty =       0.005267313298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401057163
  error estimate for blocks of size 2^( 2) =       0.000411125626
  error estimate for blocks of size 2^( 3) =       0.000419573545
  error estimate for blocks of size 2^( 4) =       0.000426111630
  error estimate for blocks of size 2^( 5) =       0.000429552621
  error estimate for blocks of size 2^( 6) =       0.000430836044
  error estimate for blocks of size 2^( 7) =       0.000431970983

      target function =                  N/A
              le_mean =     -17.216651897204
             les_mean =     296.734796083975
             stat err =       0.000429617819
             autocorr =       1.147498216152
              std dev =       0.567180478611
             le_variance =       0.321693695317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321668328983
                                         uncertainty =       0.005266084135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321668328983
                                         uncertainty =       0.005266084135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401025499
  error estimate for blocks of size 2^( 2) =       0.000411094608
  error estimate for blocks of size 2^( 3) =       0.000419543292
  error estimate for blocks of size 2^( 4) =       0.000426081897
  error estimate for blocks of size 2^( 5) =       0.000429523402
  error estimate for blocks of size 2^( 6) =       0.000430807739
  error estimate for blocks of size 2^( 7) =       0.000431943001

      target function =                  N/A
              le_mean =     -17.216651698038
             les_mean =     296.734738432761
             stat err =       0.000429589010
             autocorr =       1.147525507341
              std dev =       0.567135699838
             le_variance =       0.321642902031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321688776787
                                         uncertainty =       0.005266581095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321688776787
                                         uncertainty =       0.005266581095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038248
  error estimate for blocks of size 2^( 2) =       0.000411107111
  error estimate for blocks of size 2^( 3) =       0.000419555503
  error estimate for blocks of size 2^( 4) =       0.000426093922
  error estimate for blocks of size 2^( 5) =       0.000429535241
  error estimate for blocks of size 2^( 6) =       0.000430819205
  error estimate for blocks of size 2^( 7) =       0.000431954344

      target function =                  N/A
              le_mean =     -17.216651771264
             les_mean =     296.734761404192
             stat err =       0.000429600678
             autocorr =       1.147514887900
              std dev =       0.567153728759
             le_variance =       0.321663352045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321715127720
                                         uncertainty =       0.005267217222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321715127720
                                         uncertainty =       0.005267217222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401054675
  error estimate for blocks of size 2^( 2) =       0.000411123192
  error estimate for blocks of size 2^( 3) =       0.000419571173
  error estimate for blocks of size 2^( 4) =       0.000426109303
  error estimate for blocks of size 2^( 5) =       0.000429550338
  error estimate for blocks of size 2^( 6) =       0.000430833832
  error estimate for blocks of size 2^( 7) =       0.000431968797

      target function =                  N/A
              le_mean =     -17.216651879947
             les_mean =     296.734791499570
             stat err =       0.000429615568
             autocorr =       1.147500420588
              std dev =       0.567176961031
             le_variance =       0.321689705124


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216651897204        initial  <--
     1.4552e+00     1.4552e+01             1.0840e-04       -17.216651698038
     5.8208e+00     5.8208e+01             2.8538e-05       -17.216651771264
     2.3283e+01     2.3283e+02             7.2477e-06       -17.216651879947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3267
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.156901e-01 1 1  ON 0
 uu_1                 5.283302e-02 1 1  ON 1
 uu_2                -4.310098e-02 1 1  ON 2
 uu_3                -9.922189e-02 1 1  ON 3
 uu_4                -1.339332e-01 1 1  ON 4
 uu_5                -1.423885e-01 1 1  ON 5
 uu_6                -1.214849e-01 1 1  ON 6
 uu_7                -5.067574e-02 1 1  ON 7
 uu_8                 9.127726e-02 1 1  ON 8
 uu_9                 1.285999e-01 1 1  ON 9
 ud_0                 3.566030e-01 1 1  ON 10
 ud_1                 9.745518e-02 1 1  ON 11
 ud_2                -1.335961e-02 1 1  ON 12
 ud_3                -7.533285e-02 1 1  ON 13
 ud_4                -1.237858e-01 1 1  ON 14
 ud_5                -1.561954e-01 1 1  ON 15
 ud_6                -1.581584e-01 1 1  ON 16
 ud_7                -1.130819e-01 1 1  ON 17
 ud_8                -7.761540e-03 1 1  ON 18
 ud_9                 9.284793e-02 1 1  ON 19
 eO_0                -7.912408e-01 1 1  ON 20
 eO_1                -4.679974e-01 1 1  ON 21
 eO_2                -5.368259e-02 1 1  ON 22
 eO_3                 2.095253e-01 1 1  ON 23
 eO_4                 3.133032e-01 1 1  ON 24
 eO_5                 3.322888e-01 1 1  ON 25
 eO_6                 2.669457e-01 1 1  ON 26
 eO_7                 1.290901e-01 1 1  ON 27
 eO_8                 3.079969e-02 1 1  ON 28
 eO_9                 1.934745e-02 1 1  ON 29
eH1_0                -1.848040e-01 1 1  ON 30
eH1_1                -1.055313e-01 1 1  ON 31
eH1_2                -6.396375e-02 1 1  ON 32
eH1_3                -2.690874e-02 1 1  ON 33
eH1_4                 1.858020e-02 1 1  ON 34
eH1_5                 3.152379e-02 1 1  ON 35
eH1_6                 7.693552e-02 1 1  ON 36
eH1_7                 1.101112e-01 1 1  ON 37
eH1_8                 1.001604e-01 1 1  ON 38
eH1_9                 2.744387e-02 1 1  ON 39
eH2_0                -1.867206e-01 1 1  ON 40
eH2_1                -1.072059e-01 1 1  ON 41
eH2_2                -6.543642e-02 1 1  ON 42
eH2_3                -2.806737e-02 1 1  ON 43
eH2_4                 1.757694e-02 1 1  ON 44
eH2_5                 3.166493e-02 1 1  ON 45
eH2_6                 7.875514e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030138e-01 1 1  ON 48
eH2_9                 2.961656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.248927
====================================================
  Execution time = 2.0134e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1908e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319062706516
                                         uncertainty =       0.003107110223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319062706516
                                         uncertainty =       0.003107110223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399423959
  error estimate for blocks of size 2^( 2) =       0.000409052838
  error estimate for blocks of size 2^( 3) =       0.000417451722
  error estimate for blocks of size 2^( 4) =       0.000423928025
  error estimate for blocks of size 2^( 5) =       0.000427776072
  error estimate for blocks of size 2^( 6) =       0.000429153877
  error estimate for blocks of size 2^( 7) =       0.000430738183

      target function =                  N/A
              le_mean =     -17.216751267397
             les_mean =     296.735603041144
             stat err =       0.000427899039
             autocorr =       1.147663052176
              std dev =       0.564870779254
             le_variance =       0.319078997255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675126740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751267397       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751241667       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216751244708       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216751236125       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216751243747       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216751245074       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216751242560       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.530819e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751267397       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751260867       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216751261625       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216751259432       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216751261353       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216751261606       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216751260955       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.847167e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751267397       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751265758       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216751265948       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216751265396       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216751265878       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216751265936       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216751265772       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.630657e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5658e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156908e-01 1 1  ON 0
 uu_1                 5.283301e-02 1 1  ON 1
 uu_2                -4.310098e-02 1 1  ON 2
 uu_3                -9.922083e-02 1 1  ON 3
 uu_4                -1.339360e-01 1 1  ON 4
 uu_5                -1.423890e-01 1 1  ON 5
 uu_6                -1.214835e-01 1 1  ON 6
 uu_7                -5.067674e-02 1 1  ON 7
 uu_8                 9.127597e-02 1 1  ON 8
 uu_9                 1.286008e-01 1 1  ON 9
 ud_0                 3.566027e-01 1 1  ON 10
 ud_1                 9.745457e-02 1 1  ON 11
 ud_2                -1.335970e-02 1 1  ON 12
 ud_3                -7.533186e-02 1 1  ON 13
 ud_4                -1.237851e-01 1 1  ON 14
 ud_5                -1.561951e-01 1 1  ON 15
 ud_6                -1.581589e-01 1 1  ON 16
 ud_7                -1.130821e-01 1 1  ON 17
 ud_8                -7.763067e-03 1 1  ON 18
 ud_9                 9.284802e-02 1 1  ON 19
 eO_0                -7.912447e-01 1 1  ON 20
 eO_1                -4.679986e-01 1 1  ON 21
 eO_2                -5.368434e-02 1 1  ON 22
 eO_3                 2.095244e-01 1 1  ON 23
 eO_4                 3.133034e-01 1 1  ON 24
 eO_5                 3.322912e-01 1 1  ON 25
 eO_6                 2.669480e-01 1 1  ON 26
 eO_7                 1.290922e-01 1 1  ON 27
 eO_8                 3.079995e-02 1 1  ON 28
 eO_9                 1.934759e-02 1 1  ON 29
eH1_0                -1.848041e-01 1 1  ON 30
eH1_1                -1.055293e-01 1 1  ON 31
eH1_2                -6.396427e-02 1 1  ON 32
eH1_3                -2.690924e-02 1 1  ON 33
eH1_4                 1.857863e-02 1 1  ON 34
eH1_5                 3.152261e-02 1 1  ON 35
eH1_6                 7.693568e-02 1 1  ON 36
eH1_7                 1.101113e-01 1 1  ON 37
eH1_8                 1.001615e-01 1 1  ON 38
eH1_9                 2.744417e-02 1 1  ON 39
eH2_0                -1.867187e-01 1 1  ON 40
eH2_1                -1.072052e-01 1 1  ON 41
eH2_2                -6.543611e-02 1 1  ON 42
eH2_3                -2.806769e-02 1 1  ON 43
eH2_4                 1.757583e-02 1 1  ON 44
eH2_5                 3.166311e-02 1 1  ON 45
eH2_6                 7.875370e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030152e-01 1 1  ON 48
eH2_9                 2.961698e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1658
    reference variance = 0.148385
====================================================
  Execution time = 2.1644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2249e-01
  Total weights = 2.0000e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597498693
                                         uncertainty =       0.006143420707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597498693
                                         uncertainty =       0.006143420707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401552522
  error estimate for blocks of size 2^( 2) =       0.000410979598
  error estimate for blocks of size 2^( 3) =       0.000419763221
  error estimate for blocks of size 2^( 4) =       0.000425983666
  error estimate for blocks of size 2^( 5) =       0.000428622162
  error estimate for blocks of size 2^( 6) =       0.000430953000
  error estimate for blocks of size 2^( 7) =       0.000433648542

      target function =                  N/A
              le_mean =     -17.216534982711
             les_mean =     296.731565505567
             stat err =       0.000429801843
             autocorr =       1.145649659403
              std dev =       0.567881022650
             le_variance =       0.322488855886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322598877875
                                         uncertainty =       0.006143350441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322598877875
                                         uncertainty =       0.006143350441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401553378
  error estimate for blocks of size 2^( 2) =       0.000410980448
  error estimate for blocks of size 2^( 3) =       0.000419764108
  error estimate for blocks of size 2^( 4) =       0.000425984654
  error estimate for blocks of size 2^( 5) =       0.000428623091
  error estimate for blocks of size 2^( 6) =       0.000430953897
  error estimate for blocks of size 2^( 7) =       0.000433649279

      target function =                  N/A
              le_mean =     -17.216534963119
             les_mean =     296.731566206629
             stat err =       0.000429802730
             autocorr =       1.145649504524
              std dev =       0.567882233887
             le_variance =       0.322490231565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322598213930
                                         uncertainty =       0.006143384382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322598213930
                                         uncertainty =       0.006143384382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401552966
  error estimate for blocks of size 2^( 2) =       0.000410980039
  error estimate for blocks of size 2^( 3) =       0.000419763680
  error estimate for blocks of size 2^( 4) =       0.000425984177
  error estimate for blocks of size 2^( 5) =       0.000428622643
  error estimate for blocks of size 2^( 6) =       0.000430953465
  error estimate for blocks of size 2^( 7) =       0.000433648926

      target function =                  N/A
              le_mean =     -17.216534972409
             les_mean =     296.731565864266
             stat err =       0.000429802303
             autocorr =       1.145649577894
              std dev =       0.567881650802
             le_variance =       0.322489569318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597588876
                                         uncertainty =       0.006143416129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597588876
                                         uncertainty =       0.006143416129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401552578
  error estimate for blocks of size 2^( 2) =       0.000410979654
  error estimate for blocks of size 2^( 3) =       0.000419763279
  error estimate for blocks of size 2^( 4) =       0.000425983731
  error estimate for blocks of size 2^( 5) =       0.000428622223
  error estimate for blocks of size 2^( 6) =       0.000430953058
  error estimate for blocks of size 2^( 7) =       0.000433648591

      target function =                  N/A
              le_mean =     -17.216534981398
             les_mean =     296.731565550301
             stat err =       0.000429801901
             autocorr =       1.145649649048
              std dev =       0.567881101853
             le_variance =       0.322488945842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216534982711        initial  <--
     1.4552e+01     1.4552e+02             1.5308e-05       -17.216534963119
     5.8208e+01     5.8208e+02             3.8472e-06       -17.216534972409
     2.3283e+02     2.3283e+03             9.6307e-07       -17.216534981398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8356
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.156901e-01 1 1  ON 0
 uu_1                 5.283302e-02 1 1  ON 1
 uu_2                -4.310098e-02 1 1  ON 2
 uu_3                -9.922189e-02 1 1  ON 3
 uu_4                -1.339332e-01 1 1  ON 4
 uu_5                -1.423885e-01 1 1  ON 5
 uu_6                -1.214849e-01 1 1  ON 6
 uu_7                -5.067574e-02 1 1  ON 7
 uu_8                 9.127726e-02 1 1  ON 8
 uu_9                 1.285999e-01 1 1  ON 9
 ud_0                 3.566030e-01 1 1  ON 10
 ud_1                 9.745518e-02 1 1  ON 11
 ud_2                -1.335961e-02 1 1  ON 12
 ud_3                -7.533285e-02 1 1  ON 13
 ud_4                -1.237858e-01 1 1  ON 14
 ud_5                -1.561954e-01 1 1  ON 15
 ud_6                -1.581584e-01 1 1  ON 16
 ud_7                -1.130819e-01 1 1  ON 17
 ud_8                -7.761540e-03 1 1  ON 18
 ud_9                 9.284793e-02 1 1  ON 19
 eO_0                -7.912408e-01 1 1  ON 20
 eO_1                -4.679974e-01 1 1  ON 21
 eO_2                -5.368259e-02 1 1  ON 22
 eO_3                 2.095253e-01 1 1  ON 23
 eO_4                 3.133032e-01 1 1  ON 24
 eO_5                 3.322888e-01 1 1  ON 25
 eO_6                 2.669457e-01 1 1  ON 26
 eO_7                 1.290901e-01 1 1  ON 27
 eO_8                 3.079969e-02 1 1  ON 28
 eO_9                 1.934745e-02 1 1  ON 29
eH1_0                -1.848040e-01 1 1  ON 30
eH1_1                -1.055313e-01 1 1  ON 31
eH1_2                -6.396375e-02 1 1  ON 32
eH1_3                -2.690874e-02 1 1  ON 33
eH1_4                 1.858020e-02 1 1  ON 34
eH1_5                 3.152379e-02 1 1  ON 35
eH1_6                 7.693552e-02 1 1  ON 36
eH1_7                 1.101112e-01 1 1  ON 37
eH1_8                 1.001604e-01 1 1  ON 38
eH1_9                 2.744387e-02 1 1  ON 39
eH2_0                -1.867206e-01 1 1  ON 40
eH2_1                -1.072059e-01 1 1  ON 41
eH2_2                -6.543642e-02 1 1  ON 42
eH2_3                -2.806737e-02 1 1  ON 43
eH2_4                 1.757694e-02 1 1  ON 44
eH2_5                 3.166493e-02 1 1  ON 45
eH2_6                 7.875514e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030138e-01 1 1  ON 48
eH2_9                 2.961656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.254929
====================================================
  Execution time = 2.0215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1785e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317945914001
                                         uncertainty =       0.003080359750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317945914001
                                         uncertainty =       0.003080359750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398652612
  error estimate for blocks of size 2^( 2) =       0.000408136635
  error estimate for blocks of size 2^( 3) =       0.000416556856
  error estimate for blocks of size 2^( 4) =       0.000423050371
  error estimate for blocks of size 2^( 5) =       0.000428362942
  error estimate for blocks of size 2^( 6) =       0.000431386372
  error estimate for blocks of size 2^( 7) =       0.000430949077

      target function =                  N/A
              le_mean =     -17.217090839375
             les_mean =     296.746064621946
             stat err =       0.000428437190
             autocorr =       1.155008281323
              std dev =       0.563779930098
             le_variance =       0.317847809582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709083937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217090839375       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217090842349       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217090842751       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217090845740       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217090844399       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090845330       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090845273       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.380577e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217090839375       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217090840120       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217090840221       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217090840970       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217090840634       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090840866       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090840853       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.452947e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217090839375       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217090839561       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217090839587       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217090839774       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217090839690       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090839748       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090839745       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 8.633310e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5753e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156904e-01 1 1  ON 0
 uu_1                 5.283295e-02 1 1  ON 1
 uu_2                -4.310102e-02 1 1  ON 2
 uu_3                -9.922186e-02 1 1  ON 3
 uu_4                -1.339334e-01 1 1  ON 4
 uu_5                -1.423883e-01 1 1  ON 5
 uu_6                -1.214848e-01 1 1  ON 6
 uu_7                -5.067594e-02 1 1  ON 7
 uu_8                 9.127709e-02 1 1  ON 8
 uu_9                 1.285999e-01 1 1  ON 9
 ud_0                 3.566031e-01 1 1  ON 10
 ud_1                 9.745530e-02 1 1  ON 11
 ud_2                -1.335939e-02 1 1  ON 12
 ud_3                -7.533279e-02 1 1  ON 13
 ud_4                -1.237858e-01 1 1  ON 14
 ud_5                -1.561954e-01 1 1  ON 15
 ud_6                -1.581587e-01 1 1  ON 16
 ud_7                -1.130822e-01 1 1  ON 17
 ud_8                -7.761716e-03 1 1  ON 18
 ud_9                 9.284794e-02 1 1  ON 19
 eO_0                -7.912412e-01 1 1  ON 20
 eO_1                -4.679977e-01 1 1  ON 21
 eO_2                -5.368277e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133034e-01 1 1  ON 24
 eO_5                 3.322890e-01 1 1  ON 25
 eO_6                 2.669459e-01 1 1  ON 26
 eO_7                 1.290902e-01 1 1  ON 27
 eO_8                 3.079973e-02 1 1  ON 28
 eO_9                 1.934746e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055314e-01 1 1  ON 31
eH1_2                -6.396367e-02 1 1  ON 32
eH1_3                -2.690875e-02 1 1  ON 33
eH1_4                 1.858027e-02 1 1  ON 34
eH1_5                 3.152378e-02 1 1  ON 35
eH1_6                 7.693547e-02 1 1  ON 36
eH1_7                 1.101111e-01 1 1  ON 37
eH1_8                 1.001605e-01 1 1  ON 38
eH1_9                 2.744390e-02 1 1  ON 39
eH2_0                -1.867206e-01 1 1  ON 40
eH2_1                -1.072058e-01 1 1  ON 41
eH2_2                -6.543648e-02 1 1  ON 42
eH2_3                -2.806727e-02 1 1  ON 43
eH2_4                 1.757694e-02 1 1  ON 44
eH2_5                 3.166480e-02 1 1  ON 45
eH2_6                 7.875508e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030139e-01 1 1  ON 48
eH2_9                 2.961660e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2625
    reference variance = 0.150745
====================================================
  Execution time = 1.9715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2298e-01
  Total weights = 2.0000e+06
  Execution time = 1.8183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135207104
                                         uncertainty =       0.005417484256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135207104
                                         uncertainty =       0.005417484256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855840
  error estimate for blocks of size 2^( 2) =       0.000411228299
  error estimate for blocks of size 2^( 3) =       0.000420025172
  error estimate for blocks of size 2^( 4) =       0.000426545389
  error estimate for blocks of size 2^( 5) =       0.000430391757
  error estimate for blocks of size 2^( 6) =       0.000432570970
  error estimate for blocks of size 2^( 7) =       0.000433055307

      target function =                  N/A
              le_mean =     -17.216668325668
             les_mean =     296.736644306972
             stat err =       0.000430640856
             autocorr =       1.148391293669
              std dev =       0.568309979157
             le_variance =       0.322976232410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135015672
                                         uncertainty =       0.005417480507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135015672
                                         uncertainty =       0.005417480507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855721
  error estimate for blocks of size 2^( 2) =       0.000411228195
  error estimate for blocks of size 2^( 3) =       0.000420025077
  error estimate for blocks of size 2^( 4) =       0.000426545287
  error estimate for blocks of size 2^( 5) =       0.000430391658
  error estimate for blocks of size 2^( 6) =       0.000432570868
  error estimate for blocks of size 2^( 7) =       0.000433055205

      target function =                  N/A
              le_mean =     -17.216668327808
             les_mean =     296.736644189045
             stat err =       0.000430640755
             autocorr =       1.148391434984
              std dev =       0.568309810557
             le_variance =       0.322976040776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135111036
                                         uncertainty =       0.005417482374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135111036
                                         uncertainty =       0.005417482374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855780
  error estimate for blocks of size 2^( 2) =       0.000411228247
  error estimate for blocks of size 2^( 3) =       0.000420025124
  error estimate for blocks of size 2^( 4) =       0.000426545338
  error estimate for blocks of size 2^( 5) =       0.000430391708
  error estimate for blocks of size 2^( 6) =       0.000432570919
  error estimate for blocks of size 2^( 7) =       0.000433055256

      target function =                  N/A
              le_mean =     -17.216668326739
             les_mean =     296.736644247683
             stat err =       0.000430640805
             autocorr =       1.148391364712
              std dev =       0.568309894547
             le_variance =       0.322976136240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135195083
                                         uncertainty =       0.005417484020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323135195083
                                         uncertainty =       0.005417484020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855833
  error estimate for blocks of size 2^( 2) =       0.000411228292
  error estimate for blocks of size 2^( 3) =       0.000420025166
  error estimate for blocks of size 2^( 4) =       0.000426545382
  error estimate for blocks of size 2^( 5) =       0.000430391751
  error estimate for blocks of size 2^( 6) =       0.000432570963
  error estimate for blocks of size 2^( 7) =       0.000433055301

      target function =                  N/A
              le_mean =     -17.216668325802
             les_mean =     296.736644299547
             stat err =       0.000430640849
             autocorr =       1.148391302569
              std dev =       0.568309968571
             le_variance =       0.322976220377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216668325668        initial
     1.4552e+02     1.4552e+03             1.3806e-06       -17.216668327808  <--
     5.8208e+02     5.8208e+03             3.4529e-07       -17.216668326739
     2.3283e+03     2.3283e+04             8.6333e-08       -17.216668325802

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.9105e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.156913e-01 1 1  ON 0
 uu_1                 5.283275e-02 1 1  ON 1
 uu_2                -4.310113e-02 1 1  ON 2
 uu_3                -9.922178e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423880e-01 1 1  ON 5
 uu_6                -1.214847e-01 1 1  ON 6
 uu_7                -5.067655e-02 1 1  ON 7
 uu_8                 9.127659e-02 1 1  ON 8
 uu_9                 1.286001e-01 1 1  ON 9
 ud_0                 3.566033e-01 1 1  ON 10
 ud_1                 9.745566e-02 1 1  ON 11
 ud_2                -1.335870e-02 1 1  ON 12
 ud_3                -7.533261e-02 1 1  ON 13
 ud_4                -1.237857e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581593e-01 1 1  ON 16
 ud_7                -1.130830e-01 1 1  ON 17
 ud_8                -7.762245e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912421e-01 1 1  ON 20
 eO_1                -4.679988e-01 1 1  ON 21
 eO_2                -5.368332e-02 1 1  ON 22
 eO_3                 2.095255e-01 1 1  ON 23
 eO_4                 3.133039e-01 1 1  ON 24
 eO_5                 3.322898e-01 1 1  ON 25
 eO_6                 2.669464e-01 1 1  ON 26
 eO_7                 1.290907e-01 1 1  ON 27
 eO_8                 3.079984e-02 1 1  ON 28
 eO_9                 1.934750e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396344e-02 1 1  ON 32
eH1_3                -2.690878e-02 1 1  ON 33
eH1_4                 1.858046e-02 1 1  ON 34
eH1_5                 3.152376e-02 1 1  ON 35
eH1_6                 7.693533e-02 1 1  ON 36
eH1_7                 1.101109e-01 1 1  ON 37
eH1_8                 1.001607e-01 1 1  ON 38
eH1_9                 2.744399e-02 1 1  ON 39
eH2_0                -1.867207e-01 1 1  ON 40
eH2_1                -1.072058e-01 1 1  ON 41
eH2_2                -6.543666e-02 1 1  ON 42
eH2_3                -2.806696e-02 1 1  ON 43
eH2_4                 1.757696e-02 1 1  ON 44
eH2_5                 3.166439e-02 1 1  ON 45
eH2_6                 7.875488e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030142e-01 1 1  ON 48
eH2_9                 2.961673e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.355849
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316412423507
                                         uncertainty =       0.003563338959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316412423507
                                         uncertainty =       0.003563338959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397705895
  error estimate for blocks of size 2^( 2) =       0.000407802213
  error estimate for blocks of size 2^( 3) =       0.000416741055
  error estimate for blocks of size 2^( 4) =       0.000423105019
  error estimate for blocks of size 2^( 5) =       0.000426161697
  error estimate for blocks of size 2^( 6) =       0.000427018091
  error estimate for blocks of size 2^( 7) =       0.000427283642

      target function =                  N/A
              le_mean =     -17.216461912133
             les_mean =     296.722900571081
             stat err =       0.000425892112
             autocorr =       1.146766870514
              std dev =       0.562441070103
             le_variance =       0.316339957338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646191213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461912133       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461912479       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461928541       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461933960       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461950395       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461949263       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461948625       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 4.565408e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461912133       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461912219       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461916250       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461917624       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461921783       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461921497       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461921342       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.149722e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461912133       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461912154       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461913163       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461913507       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461914550       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461914479       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461914440       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 2.879609e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199019 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6034e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156922e-01 1 1  ON 0
 uu_1                 5.283238e-02 1 1  ON 1
 uu_2                -4.310107e-02 1 1  ON 2
 uu_3                -9.922243e-02 1 1  ON 3
 uu_4                -1.339339e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067686e-02 1 1  ON 7
 uu_8                 9.127605e-02 1 1  ON 8
 uu_9                 1.286005e-01 1 1  ON 9
 ud_0                 3.566044e-01 1 1  ON 10
 ud_1                 9.745552e-02 1 1  ON 11
 ud_2                -1.335829e-02 1 1  ON 12
 ud_3                -7.533274e-02 1 1  ON 13
 ud_4                -1.237854e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581598e-01 1 1  ON 16
 ud_7                -1.130837e-01 1 1  ON 17
 ud_8                -7.762960e-03 1 1  ON 18
 ud_9                 9.284796e-02 1 1  ON 19
 eO_0                -7.912430e-01 1 1  ON 20
 eO_1                -4.679993e-01 1 1  ON 21
 eO_2                -5.368376e-02 1 1  ON 22
 eO_3                 2.095244e-01 1 1  ON 23
 eO_4                 3.133039e-01 1 1  ON 24
 eO_5                 3.322909e-01 1 1  ON 25
 eO_6                 2.669471e-01 1 1  ON 26
 eO_7                 1.290916e-01 1 1  ON 27
 eO_8                 3.079998e-02 1 1  ON 28
 eO_9                 1.934752e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055323e-01 1 1  ON 31
eH1_2                -6.396386e-02 1 1  ON 32
eH1_3                -2.690870e-02 1 1  ON 33
eH1_4                 1.858020e-02 1 1  ON 34
eH1_5                 3.152439e-02 1 1  ON 35
eH1_6                 7.693532e-02 1 1  ON 36
eH1_7                 1.101107e-01 1 1  ON 37
eH1_8                 1.001612e-01 1 1  ON 38
eH1_9                 2.744413e-02 1 1  ON 39
eH2_0                -1.867200e-01 1 1  ON 40
eH2_1                -1.072053e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806747e-02 1 1  ON 43
eH2_4                 1.757696e-02 1 1  ON 44
eH2_5                 3.166405e-02 1 1  ON 45
eH2_6                 7.875462e-02 1 1  ON 46
eH2_7                 1.136554e-01 1 1  ON 47
eH2_8                 1.030146e-01 1 1  ON 48
eH2_9                 2.961683e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3793
    reference variance = 2.4041
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2920e-01
  Total weights = 2.0000e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329114672399
                                         uncertainty =       0.011483165784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329114672399
                                         uncertainty =       0.011483165784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405705697
  error estimate for blocks of size 2^( 2) =       0.000415253913
  error estimate for blocks of size 2^( 3) =       0.000423571572
  error estimate for blocks of size 2^( 4) =       0.000429136531
  error estimate for blocks of size 2^( 5) =       0.000432371580
  error estimate for blocks of size 2^( 6) =       0.000433309137
  error estimate for blocks of size 2^( 7) =       0.000435751480

      target function =                  N/A
              le_mean =     -17.216979966040
             les_mean =     296.753593211299
             stat err =       0.000432642182
             autocorr =       1.137196485563
              std dev =       0.573754498779
             le_variance =       0.329194224869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329119052990
                                         uncertainty =       0.011483366467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329119052990
                                         uncertainty =       0.011483366467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405708398
  error estimate for blocks of size 2^( 2) =       0.000415256527
  error estimate for blocks of size 2^( 3) =       0.000423574082
  error estimate for blocks of size 2^( 4) =       0.000429138959
  error estimate for blocks of size 2^( 5) =       0.000432373957
  error estimate for blocks of size 2^( 6) =       0.000433311462
  error estimate for blocks of size 2^( 7) =       0.000435753836

      target function =                  N/A
              le_mean =     -17.216979965973
             les_mean =     296.753597593093
             stat err =       0.000432644553
             autocorr =       1.137193806809
              std dev =       0.573758319299
             le_variance =       0.329198608965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329116877856
                                         uncertainty =       0.011483266793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329116877856
                                         uncertainty =       0.011483266793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405707057
  error estimate for blocks of size 2^( 2) =       0.000415255229
  error estimate for blocks of size 2^( 3) =       0.000423572836
  error estimate for blocks of size 2^( 4) =       0.000429137754
  error estimate for blocks of size 2^( 5) =       0.000432372777
  error estimate for blocks of size 2^( 6) =       0.000433310308
  error estimate for blocks of size 2^( 7) =       0.000435752666

      target function =                  N/A
              le_mean =     -17.216979966014
             les_mean =     296.753595417597
             stat err =       0.000432643376
             autocorr =       1.137195137126
              std dev =       0.573756422259
             le_variance =       0.329196432083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329114948547
                                         uncertainty =       0.011483178431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329114948547
                                         uncertainty =       0.011483178431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405705867
  error estimate for blocks of size 2^( 2) =       0.000415254078
  error estimate for blocks of size 2^( 3) =       0.000423571730
  error estimate for blocks of size 2^( 4) =       0.000429136685
  error estimate for blocks of size 2^( 5) =       0.000432371730
  error estimate for blocks of size 2^( 6) =       0.000433309284
  error estimate for blocks of size 2^( 7) =       0.000435751628

      target function =                  N/A
              le_mean =     -17.216979966036
             les_mean =     296.753593487517
             stat err =       0.000432642332
             autocorr =       1.137196316723
              std dev =       0.573754739620
             le_variance =       0.329194501236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216979966040        initial  <--
     3.6380e+01     3.6380e+02             4.5654e-06       -17.216979965973
     1.4552e+02     1.4552e+03             1.1497e-06       -17.216979966014
     5.8208e+02     5.8208e+03             2.8796e-07       -17.216979966036

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2501
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.156913e-01 1 1  ON 0
 uu_1                 5.283275e-02 1 1  ON 1
 uu_2                -4.310113e-02 1 1  ON 2
 uu_3                -9.922178e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423880e-01 1 1  ON 5
 uu_6                -1.214847e-01 1 1  ON 6
 uu_7                -5.067655e-02 1 1  ON 7
 uu_8                 9.127659e-02 1 1  ON 8
 uu_9                 1.286001e-01 1 1  ON 9
 ud_0                 3.566033e-01 1 1  ON 10
 ud_1                 9.745566e-02 1 1  ON 11
 ud_2                -1.335870e-02 1 1  ON 12
 ud_3                -7.533261e-02 1 1  ON 13
 ud_4                -1.237857e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581593e-01 1 1  ON 16
 ud_7                -1.130830e-01 1 1  ON 17
 ud_8                -7.762245e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912421e-01 1 1  ON 20
 eO_1                -4.679988e-01 1 1  ON 21
 eO_2                -5.368332e-02 1 1  ON 22
 eO_3                 2.095255e-01 1 1  ON 23
 eO_4                 3.133039e-01 1 1  ON 24
 eO_5                 3.322898e-01 1 1  ON 25
 eO_6                 2.669464e-01 1 1  ON 26
 eO_7                 1.290907e-01 1 1  ON 27
 eO_8                 3.079984e-02 1 1  ON 28
 eO_9                 1.934750e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396344e-02 1 1  ON 32
eH1_3                -2.690878e-02 1 1  ON 33
eH1_4                 1.858046e-02 1 1  ON 34
eH1_5                 3.152376e-02 1 1  ON 35
eH1_6                 7.693533e-02 1 1  ON 36
eH1_7                 1.101109e-01 1 1  ON 37
eH1_8                 1.001607e-01 1 1  ON 38
eH1_9                 2.744399e-02 1 1  ON 39
eH2_0                -1.867207e-01 1 1  ON 40
eH2_1                -1.072058e-01 1 1  ON 41
eH2_2                -6.543666e-02 1 1  ON 42
eH2_3                -2.806696e-02 1 1  ON 43
eH2_4                 1.757696e-02 1 1  ON 44
eH2_5                 3.166439e-02 1 1  ON 45
eH2_6                 7.875488e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030142e-01 1 1  ON 48
eH2_9                 2.961673e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2505
    reference variance = 0.237796
====================================================
  Execution time = 2.0433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2173e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321251750900
                                         uncertainty =       0.004536448536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321251750900
                                         uncertainty =       0.004536448536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401079531
  error estimate for blocks of size 2^( 2) =       0.000410783507
  error estimate for blocks of size 2^( 3) =       0.000419319708
  error estimate for blocks of size 2^( 4) =       0.000425104002
  error estimate for blocks of size 2^( 5) =       0.000429234250
  error estimate for blocks of size 2^( 6) =       0.000431473895
  error estimate for blocks of size 2^( 7) =       0.000431722080

      target function =                  N/A
              le_mean =     -17.216861843642
             les_mean =     296.742061162721
             stat err =       0.000429383557
             autocorr =       1.146119287613
              std dev =       0.567212112474
             le_variance =       0.321729580538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686184364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216861843642       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216861843786       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216861846339       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216861847069       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216861846645       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216861846728       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216861846949       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.287623e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216861843642       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216861843678       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216861844316       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216861844499       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216861844393       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216861844413       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216861844470       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.321939e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216861843642       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216861843651       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216861843810       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216861843856       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216861843831       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216861843833       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216861843854       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.304869e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5994e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283276e-02 1 1  ON 1
 uu_2                -4.310108e-02 1 1  ON 2
 uu_3                -9.922180e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423881e-01 1 1  ON 5
 uu_6                -1.214846e-01 1 1  ON 6
 uu_7                -5.067656e-02 1 1  ON 7
 uu_8                 9.127656e-02 1 1  ON 8
 uu_9                 1.286002e-01 1 1  ON 9
 ud_0                 3.566033e-01 1 1  ON 10
 ud_1                 9.745561e-02 1 1  ON 11
 ud_2                -1.335867e-02 1 1  ON 12
 ud_3                -7.533263e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581593e-01 1 1  ON 16
 ud_7                -1.130831e-01 1 1  ON 17
 ud_8                -7.762315e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912422e-01 1 1  ON 20
 eO_1                -4.679989e-01 1 1  ON 21
 eO_2                -5.368338e-02 1 1  ON 22
 eO_3                 2.095255e-01 1 1  ON 23
 eO_4                 3.133040e-01 1 1  ON 24
 eO_5                 3.322898e-01 1 1  ON 25
 eO_6                 2.669465e-01 1 1  ON 26
 eO_7                 1.290908e-01 1 1  ON 27
 eO_8                 3.079986e-02 1 1  ON 28
 eO_9                 1.934750e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396347e-02 1 1  ON 32
eH1_3                -2.690883e-02 1 1  ON 33
eH1_4                 1.858045e-02 1 1  ON 34
eH1_5                 3.152376e-02 1 1  ON 35
eH1_6                 7.693534e-02 1 1  ON 36
eH1_7                 1.101109e-01 1 1  ON 37
eH1_8                 1.001608e-01 1 1  ON 38
eH1_9                 2.744400e-02 1 1  ON 39
eH2_0                -1.867206e-01 1 1  ON 40
eH2_1                -1.072057e-01 1 1  ON 41
eH2_2                -6.543669e-02 1 1  ON 42
eH2_3                -2.806691e-02 1 1  ON 43
eH2_4                 1.757693e-02 1 1  ON 44
eH2_5                 3.166430e-02 1 1  ON 45
eH2_6                 7.875480e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030143e-01 1 1  ON 48
eH2_9                 2.961674e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.233724
====================================================
  Execution time = 2.0024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2111e-01
  Total weights = 2.0000e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213846179
                                         uncertainty =       0.003536657537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213846179
                                         uncertainty =       0.003536657537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400693972
  error estimate for blocks of size 2^( 2) =       0.000410494368
  error estimate for blocks of size 2^( 3) =       0.000419327873
  error estimate for blocks of size 2^( 4) =       0.000425364875
  error estimate for blocks of size 2^( 5) =       0.000429256962
  error estimate for blocks of size 2^( 6) =       0.000429834172
  error estimate for blocks of size 2^( 7) =       0.000430510420

      target function =                  N/A
              le_mean =     -17.216885741748
             les_mean =     296.742265802691
             stat err =       0.000428741608
             autocorr =       1.144894964554
              std dev =       0.566666849962
             le_variance =       0.321111318846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321214008038
                                         uncertainty =       0.003536659739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321214008038
                                         uncertainty =       0.003536659739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400694073
  error estimate for blocks of size 2^( 2) =       0.000410494467
  error estimate for blocks of size 2^( 3) =       0.000419327970
  error estimate for blocks of size 2^( 4) =       0.000425364967
  error estimate for blocks of size 2^( 5) =       0.000429257054
  error estimate for blocks of size 2^( 6) =       0.000429834267
  error estimate for blocks of size 2^( 7) =       0.000430510507

      target function =                  N/A
              le_mean =     -17.216885743778
             les_mean =     296.742266034410
             stat err =       0.000428741699
             autocorr =       1.144894875381
              std dev =       0.566666992743
             le_variance =       0.321111480664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213927189
                                         uncertainty =       0.003536658639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213927189
                                         uncertainty =       0.003536658639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400694023
  error estimate for blocks of size 2^( 2) =       0.000410494418
  error estimate for blocks of size 2^( 3) =       0.000419327921
  error estimate for blocks of size 2^( 4) =       0.000425364921
  error estimate for blocks of size 2^( 5) =       0.000429257008
  error estimate for blocks of size 2^( 6) =       0.000429834220
  error estimate for blocks of size 2^( 7) =       0.000430510464

      target function =                  N/A
              le_mean =     -17.216885742764
             les_mean =     296.742265918667
             stat err =       0.000428741653
             autocorr =       1.144894919944
              std dev =       0.566666921424
             le_variance =       0.321111399836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213856307
                                         uncertainty =       0.003536657675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213856307
                                         uncertainty =       0.003536657675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400693979
  error estimate for blocks of size 2^( 2) =       0.000410494375
  error estimate for blocks of size 2^( 3) =       0.000419327879
  error estimate for blocks of size 2^( 4) =       0.000425364881
  error estimate for blocks of size 2^( 5) =       0.000429256968
  error estimate for blocks of size 2^( 6) =       0.000429834178
  error estimate for blocks of size 2^( 7) =       0.000430510426

      target function =                  N/A
              le_mean =     -17.216885741875
             les_mean =     296.742265817191
             stat err =       0.000428741613
             autocorr =       1.144894958975
              std dev =       0.566666858897
             le_variance =       0.321111328973


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216885741748        initial
     3.6380e+02     3.6380e+03             5.2876e-07       -17.216885743778  <--
     1.4552e+03     1.4552e+04             1.3219e-07       -17.216885742764
     5.8208e+03     5.8208e+04             3.3049e-08       -17.216885741875

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.9206e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.156911e-01 1 1  ON 0
 uu_1                 5.283279e-02 1 1  ON 1
 uu_2                -4.310093e-02 1 1  ON 2
 uu_3                -9.922186e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067660e-02 1 1  ON 7
 uu_8                 9.127647e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566035e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335858e-02 1 1  ON 12
 ud_3                -7.533271e-02 1 1  ON 13
 ud_4                -1.237855e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581593e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762525e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912426e-01 1 1  ON 20
 eO_1                -4.679993e-01 1 1  ON 21
 eO_2                -5.368359e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133041e-01 1 1  ON 24
 eO_5                 3.322900e-01 1 1  ON 25
 eO_6                 2.669468e-01 1 1  ON 26
 eO_7                 1.290911e-01 1 1  ON 27
 eO_8                 3.079990e-02 1 1  ON 28
 eO_9                 1.934751e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055319e-01 1 1  ON 31
eH1_2                -6.396356e-02 1 1  ON 32
eH1_3                -2.690898e-02 1 1  ON 33
eH1_4                 1.858042e-02 1 1  ON 34
eH1_5                 3.152376e-02 1 1  ON 35
eH1_6                 7.693538e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001609e-01 1 1  ON 38
eH1_9                 2.744404e-02 1 1  ON 39
eH2_0                -1.867205e-01 1 1  ON 40
eH2_1                -1.072055e-01 1 1  ON 41
eH2_2                -6.543679e-02 1 1  ON 42
eH2_3                -2.806677e-02 1 1  ON 43
eH2_4                 1.757685e-02 1 1  ON 44
eH2_5                 3.166406e-02 1 1  ON 45
eH2_6                 7.875458e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030144e-01 1 1  ON 48
eH2_9                 2.961678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1295
    reference variance = 0.181813
====================================================
  Execution time = 2.0044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1437e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314490229999
                                         uncertainty =       0.003073440523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314490229999
                                         uncertainty =       0.003073440523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396463524
  error estimate for blocks of size 2^( 2) =       0.000406260028
  error estimate for blocks of size 2^( 3) =       0.000415255795
  error estimate for blocks of size 2^( 4) =       0.000422005175
  error estimate for blocks of size 2^( 5) =       0.000426417756
  error estimate for blocks of size 2^( 6) =       0.000427977731
  error estimate for blocks of size 2^( 7) =       0.000425735068

      target function =                  N/A
              le_mean =     -17.216117659686
             les_mean =     296.709073766340
             stat err =       0.000425533933
             autocorr =       1.152025044257
              std dev =       0.560684092323
             le_variance =       0.314366651384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611765969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117659686       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117665020       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117667345       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117657942       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117658959       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117659281       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117660017       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.471578e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117659686       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117661022       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117661605       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117659247       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117659496       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117659574       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117659764       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 6.184623e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117659686       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117660020       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117660166       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117659576       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117659638       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117659657       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117659705       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.546511e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5611e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283270e-02 1 1  ON 1
 uu_2                -4.310094e-02 1 1  ON 2
 uu_3                -9.922170e-02 1 1  ON 3
 uu_4                -1.339341e-01 1 1  ON 4
 uu_5                -1.423887e-01 1 1  ON 5
 uu_6                -1.214844e-01 1 1  ON 6
 uu_7                -5.067665e-02 1 1  ON 7
 uu_8                 9.127631e-02 1 1  ON 8
 uu_9                 1.286004e-01 1 1  ON 9
 ud_0                 3.566035e-01 1 1  ON 10
 ud_1                 9.745542e-02 1 1  ON 11
 ud_2                -1.335880e-02 1 1  ON 12
 ud_3                -7.533269e-02 1 1  ON 13
 ud_4                -1.237855e-01 1 1  ON 14
 ud_5                -1.561951e-01 1 1  ON 15
 ud_6                -1.581594e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762655e-03 1 1  ON 18
 ud_9                 9.284803e-02 1 1  ON 19
 eO_0                -7.912430e-01 1 1  ON 20
 eO_1                -4.679994e-01 1 1  ON 21
 eO_2                -5.368421e-02 1 1  ON 22
 eO_3                 2.095251e-01 1 1  ON 23
 eO_4                 3.133043e-01 1 1  ON 24
 eO_5                 3.322904e-01 1 1  ON 25
 eO_6                 2.669472e-01 1 1  ON 26
 eO_7                 1.290915e-01 1 1  ON 27
 eO_8                 3.079997e-02 1 1  ON 28
 eO_9                 1.934754e-02 1 1  ON 29
eH1_0                -1.848040e-01 1 1  ON 30
eH1_1                -1.055317e-01 1 1  ON 31
eH1_2                -6.396353e-02 1 1  ON 32
eH1_3                -2.690896e-02 1 1  ON 33
eH1_4                 1.858010e-02 1 1  ON 34
eH1_5                 3.152349e-02 1 1  ON 35
eH1_6                 7.693535e-02 1 1  ON 36
eH1_7                 1.101111e-01 1 1  ON 37
eH1_8                 1.001612e-01 1 1  ON 38
eH1_9                 2.744413e-02 1 1  ON 39
eH2_0                -1.867203e-01 1 1  ON 40
eH2_1                -1.072058e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806668e-02 1 1  ON 43
eH2_4                 1.757654e-02 1 1  ON 44
eH2_5                 3.166398e-02 1 1  ON 45
eH2_6                 7.875462e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030146e-01 1 1  ON 48
eH2_9                 2.961685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2024
    reference variance = 0.160702
====================================================
  Execution time = 1.9933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1800e-01
  Total weights = 2.0000e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892606979
                                         uncertainty =       0.003541869457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892606979
                                         uncertainty =       0.003541869457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398750149
  error estimate for blocks of size 2^( 2) =       0.000408372747
  error estimate for blocks of size 2^( 3) =       0.000417315713
  error estimate for blocks of size 2^( 4) =       0.000423269470
  error estimate for blocks of size 2^( 5) =       0.000426557678
  error estimate for blocks of size 2^( 6) =       0.000429521619
  error estimate for blocks of size 2^( 7) =       0.000431109552

      target function =                  N/A
              le_mean =     -17.217058793088
             les_mean =     296.745116688962
             stat err =       0.000427614580
             autocorr =       1.150014433468
              std dev =       0.563917869308
             le_variance =       0.318003363325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317893030501
                                         uncertainty =       0.003541868617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317893030501
                                         uncertainty =       0.003541868617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398750415
  error estimate for blocks of size 2^( 2) =       0.000408372987
  error estimate for blocks of size 2^( 3) =       0.000417315936
  error estimate for blocks of size 2^( 4) =       0.000423269694
  error estimate for blocks of size 2^( 5) =       0.000426557906
  error estimate for blocks of size 2^( 6) =       0.000429521818
  error estimate for blocks of size 2^( 7) =       0.000431109746

      target function =                  N/A
              le_mean =     -17.217058790889
             les_mean =     296.745117037109
             stat err =       0.000427614791
             autocorr =       1.150014037145
              std dev =       0.563918245137
             le_variance =       0.318003787198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892819891
                                         uncertainty =       0.003541869037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892819891
                                         uncertainty =       0.003541869037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398750283
  error estimate for blocks of size 2^( 2) =       0.000408372867
  error estimate for blocks of size 2^( 3) =       0.000417315825
  error estimate for blocks of size 2^( 4) =       0.000423269582
  error estimate for blocks of size 2^( 5) =       0.000426557793
  error estimate for blocks of size 2^( 6) =       0.000429521719
  error estimate for blocks of size 2^( 7) =       0.000431109650

      target function =                  N/A
              le_mean =     -17.217058791979
             les_mean =     296.745116863859
             stat err =       0.000427614686
             autocorr =       1.150014234191
              std dev =       0.563918058244
             le_variance =       0.318003576414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892633628
                                         uncertainty =       0.003541869405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317892633628
                                         uncertainty =       0.003541869405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398750166
  error estimate for blocks of size 2^( 2) =       0.000408372762
  error estimate for blocks of size 2^( 3) =       0.000417315727
  error estimate for blocks of size 2^( 4) =       0.000423269484
  error estimate for blocks of size 2^( 5) =       0.000426557692
  error estimate for blocks of size 2^( 6) =       0.000429521632
  error estimate for blocks of size 2^( 7) =       0.000431109564

      target function =                  N/A
              le_mean =     -17.217058792949
             les_mean =     296.745116710841
             stat err =       0.000427614593
             autocorr =       1.150014408529
              std dev =       0.563917892956
             le_variance =       0.318003389996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217058793088        initial  <--
     9.0949e+01     9.0949e+02             2.4716e-06       -17.217058790889
     3.6380e+02     3.6380e+03             6.1846e-07       -17.217058791979
     1.4552e+03     1.4552e+04             1.5465e-07       -17.217058792949

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1054
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.156911e-01 1 1  ON 0
 uu_1                 5.283279e-02 1 1  ON 1
 uu_2                -4.310093e-02 1 1  ON 2
 uu_3                -9.922186e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067660e-02 1 1  ON 7
 uu_8                 9.127647e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566035e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335858e-02 1 1  ON 12
 ud_3                -7.533271e-02 1 1  ON 13
 ud_4                -1.237855e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581593e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762525e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912426e-01 1 1  ON 20
 eO_1                -4.679993e-01 1 1  ON 21
 eO_2                -5.368359e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133041e-01 1 1  ON 24
 eO_5                 3.322900e-01 1 1  ON 25
 eO_6                 2.669468e-01 1 1  ON 26
 eO_7                 1.290911e-01 1 1  ON 27
 eO_8                 3.079990e-02 1 1  ON 28
 eO_9                 1.934751e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055319e-01 1 1  ON 31
eH1_2                -6.396356e-02 1 1  ON 32
eH1_3                -2.690898e-02 1 1  ON 33
eH1_4                 1.858042e-02 1 1  ON 34
eH1_5                 3.152376e-02 1 1  ON 35
eH1_6                 7.693538e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001609e-01 1 1  ON 38
eH1_9                 2.744404e-02 1 1  ON 39
eH2_0                -1.867205e-01 1 1  ON 40
eH2_1                -1.072055e-01 1 1  ON 41
eH2_2                -6.543679e-02 1 1  ON 42
eH2_3                -2.806677e-02 1 1  ON 43
eH2_4                 1.757685e-02 1 1  ON 44
eH2_5                 3.166406e-02 1 1  ON 45
eH2_6                 7.875458e-02 1 1  ON 46
eH2_7                 1.136556e-01 1 1  ON 47
eH2_8                 1.030144e-01 1 1  ON 48
eH2_9                 2.961678e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.289
    reference variance = 0.292001
====================================================
  Execution time = 2.1815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330067885235
                                         uncertainty =       0.014611571745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330067885235
                                         uncertainty =       0.014611571745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406147894
  error estimate for blocks of size 2^( 2) =       0.000415183281
  error estimate for blocks of size 2^( 3) =       0.000423925560
  error estimate for blocks of size 2^( 4) =       0.000430446177
  error estimate for blocks of size 2^( 5) =       0.000434253480
  error estimate for blocks of size 2^( 6) =       0.000436935046
  error estimate for blocks of size 2^( 7) =       0.000436725181

      target function =                  N/A
              le_mean =     -17.216297351780
             les_mean =     296.730806562825
             stat err =       0.000434589971
             autocorr =       1.144961779390
              std dev =       0.574379859405
             le_variance =       0.329912222890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629735178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297351780       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297352270       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297353064       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297353201       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297352989       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297352946       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.466669e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297351780       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297351902       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297352101       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297352136       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297352082       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297352072       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.168175e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297351780       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297351810       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297351860       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297351868       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297351855       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297351844       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.542138e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7520e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156911e-01 1 1  ON 0
 uu_1                 5.283277e-02 1 1  ON 1
 uu_2                -4.310091e-02 1 1  ON 2
 uu_3                -9.922187e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067662e-02 1 1  ON 7
 uu_8                 9.127646e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566036e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335855e-02 1 1  ON 12
 ud_3                -7.533271e-02 1 1  ON 13
 ud_4                -1.237855e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581594e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762544e-03 1 1  ON 18
 ud_9                 9.284797e-02 1 1  ON 19
 eO_0                -7.912426e-01 1 1  ON 20
 eO_1                -4.679994e-01 1 1  ON 21
 eO_2                -5.368362e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133041e-01 1 1  ON 24
 eO_5                 3.322901e-01 1 1  ON 25
 eO_6                 2.669468e-01 1 1  ON 26
 eO_7                 1.290911e-01 1 1  ON 27
 eO_8                 3.079991e-02 1 1  ON 28
 eO_9                 1.934751e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055319e-01 1 1  ON 31
eH1_2                -6.396360e-02 1 1  ON 32
eH1_3                -2.690897e-02 1 1  ON 33
eH1_4                 1.858040e-02 1 1  ON 34
eH1_5                 3.152377e-02 1 1  ON 35
eH1_6                 7.693537e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001610e-01 1 1  ON 38
eH1_9                 2.744405e-02 1 1  ON 39
eH2_0                -1.867204e-01 1 1  ON 40
eH2_1                -1.072055e-01 1 1  ON 41
eH2_2                -6.543681e-02 1 1  ON 42
eH2_3                -2.806677e-02 1 1  ON 43
eH2_4                 1.757686e-02 1 1  ON 44
eH2_5                 3.166403e-02 1 1  ON 45
eH2_6                 7.875456e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030144e-01 1 1  ON 48
eH2_9                 2.961679e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1768
    reference variance = 0.302087
====================================================
  Execution time = 1.9721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3792e-01
  Total weights = 2.0000e+06
  Execution time = 1.8194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895150681
                                         uncertainty =       0.011543621885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895150681
                                         uncertainty =       0.011543621885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411047421
  error estimate for blocks of size 2^( 2) =       0.000420043643
  error estimate for blocks of size 2^( 3) =       0.000428666091
  error estimate for blocks of size 2^( 4) =       0.000434762166
  error estimate for blocks of size 2^( 5) =       0.000438141374
  error estimate for blocks of size 2^( 6) =       0.000439133864
  error estimate for blocks of size 2^( 7) =       0.000439242720

      target function =                  N/A
              le_mean =     -17.216783295908
             les_mean =     296.755546854694
             stat err =       0.000437820031
             autocorr =       1.134507571661
              std dev =       0.581308838214
             le_variance =       0.337919965386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895329895
                                         uncertainty =       0.011543622723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895329895
                                         uncertainty =       0.011543622723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411047530
  error estimate for blocks of size 2^( 2) =       0.000420043750
  error estimate for blocks of size 2^( 3) =       0.000428666194
  error estimate for blocks of size 2^( 4) =       0.000434762265
  error estimate for blocks of size 2^( 5) =       0.000438141470
  error estimate for blocks of size 2^( 6) =       0.000439133958
  error estimate for blocks of size 2^( 7) =       0.000439242812

      target function =                  N/A
              le_mean =     -17.216783296451
             les_mean =     296.755547052609
             stat err =       0.000437820126
             autocorr =       1.134507462887
              std dev =       0.581308992361
             le_variance =       0.337920144599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895240310
                                         uncertainty =       0.011543622303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895240310
                                         uncertainty =       0.011543622303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411047476
  error estimate for blocks of size 2^( 2) =       0.000420043696
  error estimate for blocks of size 2^( 3) =       0.000428666142
  error estimate for blocks of size 2^( 4) =       0.000434762216
  error estimate for blocks of size 2^( 5) =       0.000438141422
  error estimate for blocks of size 2^( 6) =       0.000439133911
  error estimate for blocks of size 2^( 7) =       0.000439242766

      target function =                  N/A
              le_mean =     -17.216783296180
             les_mean =     296.755546953677
             stat err =       0.000437820079
             autocorr =       1.134507517263
              std dev =       0.581308915305
             le_variance =       0.337920055014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895161886
                                         uncertainty =       0.011543621937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337895161886
                                         uncertainty =       0.011543621937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411047428
  error estimate for blocks of size 2^( 2) =       0.000420043649
  error estimate for blocks of size 2^( 3) =       0.000428666097
  error estimate for blocks of size 2^( 4) =       0.000434762172
  error estimate for blocks of size 2^( 5) =       0.000438141380
  error estimate for blocks of size 2^( 6) =       0.000439133870
  error estimate for blocks of size 2^( 7) =       0.000439242726

      target function =                  N/A
              le_mean =     -17.216783295942
             les_mean =     296.755546867067
             stat err =       0.000437820037
             autocorr =       1.134507564857
              std dev =       0.581308847851
             le_variance =       0.337919976590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216783295908        initial
     9.0949e+02     9.0949e+03             2.4667e-07       -17.216783296451  <--
     3.6380e+03     3.6380e+04             6.1682e-08       -17.216783296180
     1.4552e+04     1.4552e+05             1.5421e-08       -17.216783295942

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.8917e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283270e-02 1 1  ON 1
 uu_2                -4.310087e-02 1 1  ON 2
 uu_3                -9.922192e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067667e-02 1 1  ON 7
 uu_8                 9.127640e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566038e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335848e-02 1 1  ON 12
 ud_3                -7.533273e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581595e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762603e-03 1 1  ON 18
 ud_9                 9.284798e-02 1 1  ON 19
 eO_0                -7.912427e-01 1 1  ON 20
 eO_1                -4.679995e-01 1 1  ON 21
 eO_2                -5.368370e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133042e-01 1 1  ON 24
 eO_5                 3.322902e-01 1 1  ON 25
 eO_6                 2.669469e-01 1 1  ON 26
 eO_7                 1.290912e-01 1 1  ON 27
 eO_8                 3.079993e-02 1 1  ON 28
 eO_9                 1.934752e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396371e-02 1 1  ON 32
eH1_3                -2.690895e-02 1 1  ON 33
eH1_4                 1.858033e-02 1 1  ON 34
eH1_5                 3.152380e-02 1 1  ON 35
eH1_6                 7.693536e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001610e-01 1 1  ON 38
eH1_9                 2.744406e-02 1 1  ON 39
eH2_0                -1.867203e-01 1 1  ON 40
eH2_1                -1.072054e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806678e-02 1 1  ON 43
eH2_4                 1.757690e-02 1 1  ON 44
eH2_5                 3.166395e-02 1 1  ON 45
eH2_6                 7.875449e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030145e-01 1 1  ON 48
eH2_9                 2.961680e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.239487
====================================================
  Execution time = 2.2435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321484592728
                                         uncertainty =       0.004712321102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321484592728
                                         uncertainty =       0.004712321102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400946080
  error estimate for blocks of size 2^( 2) =       0.000410805698
  error estimate for blocks of size 2^( 3) =       0.000419359173
  error estimate for blocks of size 2^( 4) =       0.000426553596
  error estimate for blocks of size 2^( 5) =       0.000430983840
  error estimate for blocks of size 2^( 6) =       0.000433459914
  error estimate for blocks of size 2^( 7) =       0.000432514842

      target function =                  N/A
              le_mean =     -17.217445918778
             les_mean =     296.761959323260
             stat err =       0.000430878048
             autocorr =       1.154879822469
              std dev =       0.567023383968
             le_variance =       0.321515517967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721744591878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217445918778       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217445918270       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217445914060       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217445912734       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217445914948       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217445915133       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217445914298       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 9.549756e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217445918778       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217445918651       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217445917598       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217445917265       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217445917817       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217445917864       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217445917655       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.389141e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217445918778       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217445918746       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217445918483       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217445918399       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217445918537       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217445918550       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217445918500       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.973917e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207644 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7953e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156911e-01 1 1  ON 0
 uu_1                 5.283261e-02 1 1  ON 1
 uu_2                -4.310081e-02 1 1  ON 2
 uu_3                -9.922195e-02 1 1  ON 3
 uu_4                -1.339341e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214844e-01 1 1  ON 6
 uu_7                -5.067669e-02 1 1  ON 7
 uu_8                 9.127634e-02 1 1  ON 8
 uu_9                 1.286004e-01 1 1  ON 9
 ud_0                 3.566039e-01 1 1  ON 10
 ud_1                 9.745533e-02 1 1  ON 11
 ud_2                -1.335845e-02 1 1  ON 12
 ud_3                -7.533267e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561953e-01 1 1  ON 15
 ud_6                -1.581594e-01 1 1  ON 16
 ud_7                -1.130833e-01 1 1  ON 17
 ud_8                -7.762684e-03 1 1  ON 18
 ud_9                 9.284798e-02 1 1  ON 19
 eO_0                -7.912428e-01 1 1  ON 20
 eO_1                -4.679997e-01 1 1  ON 21
 eO_2                -5.368394e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133042e-01 1 1  ON 24
 eO_5                 3.322903e-01 1 1  ON 25
 eO_6                 2.669470e-01 1 1  ON 26
 eO_7                 1.290913e-01 1 1  ON 27
 eO_8                 3.079995e-02 1 1  ON 28
 eO_9                 1.934753e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055317e-01 1 1  ON 31
eH1_2                -6.396377e-02 1 1  ON 32
eH1_3                -2.690888e-02 1 1  ON 33
eH1_4                 1.858022e-02 1 1  ON 34
eH1_5                 3.152372e-02 1 1  ON 35
eH1_6                 7.693538e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001611e-01 1 1  ON 38
eH1_9                 2.744407e-02 1 1  ON 39
eH2_0                -1.867204e-01 1 1  ON 40
eH2_1                -1.072055e-01 1 1  ON 41
eH2_2                -6.543679e-02 1 1  ON 42
eH2_3                -2.806686e-02 1 1  ON 43
eH2_4                 1.757686e-02 1 1  ON 44
eH2_5                 3.166398e-02 1 1  ON 45
eH2_6                 7.875450e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030146e-01 1 1  ON 48
eH2_9                 2.961682e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.231366
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1395e-01
  Total weights = 2.0000e+06
  Execution time = 1.8561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997067317
                                         uncertainty =       0.002477134420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997067317
                                         uncertainty =       0.002477134420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396200363
  error estimate for blocks of size 2^( 2) =       0.000405909072
  error estimate for blocks of size 2^( 3) =       0.000414097058
  error estimate for blocks of size 2^( 4) =       0.000420068473
  error estimate for blocks of size 2^( 5) =       0.000423960568
  error estimate for blocks of size 2^( 6) =       0.000426540204
  error estimate for blocks of size 2^( 7) =       0.000425895840

      target function =                  N/A
              le_mean =     -17.216438271136
             les_mean =     296.719696042725
             stat err =       0.000424116271
             autocorr =       1.145882614232
              std dev =       0.560311927291
             le_variance =       0.313949455865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997236171
                                         uncertainty =       0.002477138769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997236171
                                         uncertainty =       0.002477138769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396200470
  error estimate for blocks of size 2^( 2) =       0.000405909178
  error estimate for blocks of size 2^( 3) =       0.000414097161
  error estimate for blocks of size 2^( 4) =       0.000420068569
  error estimate for blocks of size 2^( 5) =       0.000423960677
  error estimate for blocks of size 2^( 6) =       0.000426540301
  error estimate for blocks of size 2^( 7) =       0.000425895931

      target function =                  N/A
              le_mean =     -17.216438264176
             les_mean =     296.719695971668
             stat err =       0.000424116369
             autocorr =       1.145882529311
              std dev =       0.560312077730
             le_variance =       0.313949624450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997152100
                                         uncertainty =       0.002477136601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997152100
                                         uncertainty =       0.002477136601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396200417
  error estimate for blocks of size 2^( 2) =       0.000405909125
  error estimate for blocks of size 2^( 3) =       0.000414097110
  error estimate for blocks of size 2^( 4) =       0.000420068521
  error estimate for blocks of size 2^( 5) =       0.000423960623
  error estimate for blocks of size 2^( 6) =       0.000426540252
  error estimate for blocks of size 2^( 7) =       0.000425895886

      target function =                  N/A
              le_mean =     -17.216438267652
             les_mean =     296.719696007421
             stat err =       0.000424116321
             autocorr =       1.145882571560
              std dev =       0.560312002828
             le_variance =       0.313949540513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997077925
                                         uncertainty =       0.002477134693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313997077925
                                         uncertainty =       0.002477134693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396200370
  error estimate for blocks of size 2^( 2) =       0.000405909079
  error estimate for blocks of size 2^( 3) =       0.000414097065
  error estimate for blocks of size 2^( 4) =       0.000420068479
  error estimate for blocks of size 2^( 5) =       0.000423960575
  error estimate for blocks of size 2^( 6) =       0.000426540210
  error estimate for blocks of size 2^( 7) =       0.000425895846

      target function =                  N/A
              le_mean =     -17.216438270700
             les_mean =     296.719696038317
             stat err =       0.000424116278
             autocorr =       1.145882608884
              std dev =       0.560311936743
             le_variance =       0.313949466457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216438271136        initial  <--
     2.2737e+02     2.2737e+03             9.5498e-07       -17.216438264176
     9.0949e+02     9.0949e+03             2.3891e-07       -17.216438267652
     3.6380e+03     3.6380e+04             5.9739e-08       -17.216438270700

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0995
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283270e-02 1 1  ON 1
 uu_2                -4.310087e-02 1 1  ON 2
 uu_3                -9.922192e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067667e-02 1 1  ON 7
 uu_8                 9.127640e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566038e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335848e-02 1 1  ON 12
 ud_3                -7.533273e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581595e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762603e-03 1 1  ON 18
 ud_9                 9.284798e-02 1 1  ON 19
 eO_0                -7.912427e-01 1 1  ON 20
 eO_1                -4.679995e-01 1 1  ON 21
 eO_2                -5.368370e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133042e-01 1 1  ON 24
 eO_5                 3.322902e-01 1 1  ON 25
 eO_6                 2.669469e-01 1 1  ON 26
 eO_7                 1.290912e-01 1 1  ON 27
 eO_8                 3.079993e-02 1 1  ON 28
 eO_9                 1.934752e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396371e-02 1 1  ON 32
eH1_3                -2.690895e-02 1 1  ON 33
eH1_4                 1.858033e-02 1 1  ON 34
eH1_5                 3.152380e-02 1 1  ON 35
eH1_6                 7.693536e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001610e-01 1 1  ON 38
eH1_9                 2.744406e-02 1 1  ON 39
eH2_0                -1.867203e-01 1 1  ON 40
eH2_1                -1.072054e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806678e-02 1 1  ON 43
eH2_4                 1.757690e-02 1 1  ON 44
eH2_5                 3.166395e-02 1 1  ON 45
eH2_6                 7.875449e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030145e-01 1 1  ON 48
eH2_9                 2.961680e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.257128
====================================================
  Execution time = 2.0098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321089328300
                                         uncertainty =       0.004266556254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321089328300
                                         uncertainty =       0.004266556254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400668115
  error estimate for blocks of size 2^( 2) =       0.000410162783
  error estimate for blocks of size 2^( 3) =       0.000418932275
  error estimate for blocks of size 2^( 4) =       0.000425285375
  error estimate for blocks of size 2^( 5) =       0.000429438650
  error estimate for blocks of size 2^( 6) =       0.000431719048
  error estimate for blocks of size 2^( 7) =       0.000432833846

      target function =                  N/A
              le_mean =     -17.217054665318
             les_mean =     296.748041065005
             stat err =       0.000429819230
             autocorr =       1.150805999227
              std dev =       0.566630282458
             le_variance =       0.321069876999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721705466532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217054665318       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217054665193       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217054665534       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217054665577       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217054665574       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217054665546       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217054665563       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 9.764602e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217054665318       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217054665286       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217054665372       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217054665383       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217054665382       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217054665380       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217054665377       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.441171e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217054665318       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217054665310       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217054665331       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217054665335       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217054665332       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217054665325       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217054665335       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 6.102941e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5697e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283270e-02 1 1  ON 1
 uu_2                -4.310087e-02 1 1  ON 2
 uu_3                -9.922192e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067668e-02 1 1  ON 7
 uu_8                 9.127639e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566038e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335848e-02 1 1  ON 12
 ud_3                -7.533274e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581595e-01 1 1  ON 16
 ud_7                -1.130832e-01 1 1  ON 17
 ud_8                -7.762608e-03 1 1  ON 18
 ud_9                 9.284798e-02 1 1  ON 19
 eO_0                -7.912428e-01 1 1  ON 20
 eO_1                -4.679996e-01 1 1  ON 21
 eO_2                -5.368370e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133042e-01 1 1  ON 24
 eO_5                 3.322902e-01 1 1  ON 25
 eO_6                 2.669469e-01 1 1  ON 26
 eO_7                 1.290912e-01 1 1  ON 27
 eO_8                 3.079993e-02 1 1  ON 28
 eO_9                 1.934752e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396371e-02 1 1  ON 32
eH1_3                -2.690894e-02 1 1  ON 33
eH1_4                 1.858034e-02 1 1  ON 34
eH1_5                 3.152380e-02 1 1  ON 35
eH1_6                 7.693536e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001610e-01 1 1  ON 38
eH1_9                 2.744407e-02 1 1  ON 39
eH2_0                -1.867203e-01 1 1  ON 40
eH2_1                -1.072054e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806679e-02 1 1  ON 43
eH2_4                 1.757691e-02 1 1  ON 44
eH2_5                 3.166395e-02 1 1  ON 45
eH2_6                 7.875448e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030145e-01 1 1  ON 48
eH2_9                 2.961680e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1826
    reference variance = 0.211312
====================================================
  Execution time = 1.9843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209535462
                                         uncertainty =       0.011848781525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209535462
                                         uncertainty =       0.011848781525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404426251
  error estimate for blocks of size 2^( 2) =       0.000413961365
  error estimate for blocks of size 2^( 3) =       0.000422778564
  error estimate for blocks of size 2^( 4) =       0.000429289847
  error estimate for blocks of size 2^( 5) =       0.000432995690
  error estimate for blocks of size 2^( 6) =       0.000434581491
  error estimate for blocks of size 2^( 7) =       0.000436157359

      target function =                  N/A
              le_mean =     -17.217013331905
             les_mean =     296.752669091893
             stat err =       0.000433256097
             autocorr =       1.147653251568
              std dev =       0.571945088678
             le_variance =       0.327121184463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209553458
                                         uncertainty =       0.011848783422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209553458
                                         uncertainty =       0.011848783422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404426262
  error estimate for blocks of size 2^( 2) =       0.000413961375
  error estimate for blocks of size 2^( 3) =       0.000422778574
  error estimate for blocks of size 2^( 4) =       0.000429289856
  error estimate for blocks of size 2^( 5) =       0.000432995699
  error estimate for blocks of size 2^( 6) =       0.000434581499
  error estimate for blocks of size 2^( 7) =       0.000436157367

      target function =                  N/A
              le_mean =     -17.217013332122
             les_mean =     296.752669117367
             stat err =       0.000433256105
             autocorr =       1.147653233331
              std dev =       0.571945104401
             le_variance =       0.327121202448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209544460
                                         uncertainty =       0.011848782474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209544460
                                         uncertainty =       0.011848782474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404426256
  error estimate for blocks of size 2^( 2) =       0.000413961370
  error estimate for blocks of size 2^( 3) =       0.000422778569
  error estimate for blocks of size 2^( 4) =       0.000429289851
  error estimate for blocks of size 2^( 5) =       0.000432995695
  error estimate for blocks of size 2^( 6) =       0.000434581495
  error estimate for blocks of size 2^( 7) =       0.000436157363

      target function =                  N/A
              le_mean =     -17.217013332014
             les_mean =     296.752669104631
             stat err =       0.000433256101
             autocorr =       1.147653242452
              std dev =       0.571945096540
             le_variance =       0.327121193456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209536587
                                         uncertainty =       0.011848781644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327209536587
                                         uncertainty =       0.011848781644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404426251
  error estimate for blocks of size 2^( 2) =       0.000413961365
  error estimate for blocks of size 2^( 3) =       0.000422778565
  error estimate for blocks of size 2^( 4) =       0.000429289848
  error estimate for blocks of size 2^( 5) =       0.000432995691
  error estimate for blocks of size 2^( 6) =       0.000434581492
  error estimate for blocks of size 2^( 7) =       0.000436157360

      target function =                  N/A
              le_mean =     -17.217013331918
             les_mean =     296.752669093485
             stat err =       0.000433256097
             autocorr =       1.147653250432
              std dev =       0.571945089661
             le_variance =       0.327121185587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217013331905        initial
     2.2737e+03     2.2737e+04             9.7646e-08       -17.217013332122  <--
     9.0949e+03     9.0949e+04             2.4412e-08       -17.217013332014
     3.6380e+04     3.6380e+05             6.1029e-09       -17.217013331918

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.9025e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.156912e-01 1 1  ON 0
 uu_1                 5.283271e-02 1 1  ON 1
 uu_2                -4.310085e-02 1 1  ON 2
 uu_3                -9.922194e-02 1 1  ON 3
 uu_4                -1.339340e-01 1 1  ON 4
 uu_5                -1.423882e-01 1 1  ON 5
 uu_6                -1.214845e-01 1 1  ON 6
 uu_7                -5.067670e-02 1 1  ON 7
 uu_8                 9.127637e-02 1 1  ON 8
 uu_9                 1.286003e-01 1 1  ON 9
 ud_0                 3.566038e-01 1 1  ON 10
 ud_1                 9.745547e-02 1 1  ON 11
 ud_2                -1.335848e-02 1 1  ON 12
 ud_3                -7.533275e-02 1 1  ON 13
 ud_4                -1.237856e-01 1 1  ON 14
 ud_5                -1.561952e-01 1 1  ON 15
 ud_6                -1.581595e-01 1 1  ON 16
 ud_7                -1.130833e-01 1 1  ON 17
 ud_8                -7.762622e-03 1 1  ON 18
 ud_9                 9.284799e-02 1 1  ON 19
 eO_0                -7.912428e-01 1 1  ON 20
 eO_1                -4.679996e-01 1 1  ON 21
 eO_2                -5.368371e-02 1 1  ON 22
 eO_3                 2.095254e-01 1 1  ON 23
 eO_4                 3.133042e-01 1 1  ON 24
 eO_5                 3.322902e-01 1 1  ON 25
 eO_6                 2.669470e-01 1 1  ON 26
 eO_7                 1.290913e-01 1 1  ON 27
 eO_8                 3.079994e-02 1 1  ON 28
 eO_9                 1.934752e-02 1 1  ON 29
eH1_0                -1.848039e-01 1 1  ON 30
eH1_1                -1.055318e-01 1 1  ON 31
eH1_2                -6.396372e-02 1 1  ON 32
eH1_3                -2.690894e-02 1 1  ON 33
eH1_4                 1.858034e-02 1 1  ON 34
eH1_5                 3.152379e-02 1 1  ON 35
eH1_6                 7.693536e-02 1 1  ON 36
eH1_7                 1.101110e-01 1 1  ON 37
eH1_8                 1.001610e-01 1 1  ON 38
eH1_9                 2.744408e-02 1 1  ON 39
eH2_0                -1.867203e-01 1 1  ON 40
eH2_1                -1.072055e-01 1 1  ON 41
eH2_2                -6.543685e-02 1 1  ON 42
eH2_3                -2.806682e-02 1 1  ON 43
eH2_4                 1.757694e-02 1 1  ON 44
eH2_5                 3.166396e-02 1 1  ON 45
eH2_6                 7.875444e-02 1 1  ON 46
eH2_7                 1.136555e-01 1 1  ON 47
eH2_8                 1.030145e-01 1 1  ON 48
eH2_9                 2.961682e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4730e+01 secs
  Total Execution time = 2.2180e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
