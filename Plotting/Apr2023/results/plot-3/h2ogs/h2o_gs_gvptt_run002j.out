Rank =    0  Free Memory = 91201 MB
Rank =    1  Free Memory = 91200 MB
Rank =    2  Free Memory = 91200 MB
Rank =    3  Free Memory = 91199 MB
Rank =    4  Free Memory = 91199 MB
Rank =    5  Free Memory = 91199 MB
Rank =    6  Free Memory = 91199 MB
Rank =    7  Free Memory = 91199 MB
Rank =    8  Free Memory = 91199 MB
Rank =    9  Free Memory = 91199 MB
Rank =   10  Free Memory = 91199 MB
Rank =   11  Free Memory = 91198 MB
Rank =   12  Free Memory = 91198 MB
Rank =   13  Free Memory = 91198 MB
Rank =   14  Free Memory = 91198 MB
Rank =   15  Free Memory = 91184 MB
Rank =   16  Free Memory = 91184 MB
Rank =   17  Free Memory = 91184 MB
Rank =   18  Free Memory = 91184 MB
Rank =   19  Free Memory = 91183 MB
Rank =   20  Free Memory = 91183 MB
Rank =   21  Free Memory = 91183 MB
Rank =   22  Free Memory = 91183 MB
Rank =   23  Free Memory = 91183 MB
Rank =   24  Free Memory = 91183 MB
Rank =   25  Free Memory = 91183 MB
Rank =   26  Free Memory = 91183 MB
Rank =   27  Free Memory = 91183 MB
Rank =   28  Free Memory = 91183 MB
Rank =   29  Free Memory = 91183 MB
Rank =   30  Free Memory = 91183 MB
Rank =   31  Free Memory = 91183 MB
Rank =   32  Free Memory = 89003 MB
Rank =   33  Free Memory = 89003 MB
Rank =   34  Free Memory = 89003 MB
Rank =   35  Free Memory = 89003 MB
Rank =   36  Free Memory = 89003 MB
Rank =   37  Free Memory = 89003 MB
Rank =   38  Free Memory = 89003 MB
Rank =   39  Free Memory = 89003 MB
Rank =   40  Free Memory = 89003 MB
Rank =   41  Free Memory = 89003 MB
Rank =   42  Free Memory = 89003 MB
Rank =   43  Free Memory = 89003 MB
Rank =   44  Free Memory = 89003 MB
Rank =   45  Free Memory = 89003 MB
Rank =   46  Free Memory = 89003 MB
Rank =   47  Free Memory = 89003 MB
Rank =   48  Free Memory = 89003 MB
Rank =   49  Free Memory = 89003 MB
Rank =   50  Free Memory = 89003 MB
Rank =   51  Free Memory = 89003 MB
Rank =   52  Free Memory = 89003 MB
Rank =   53  Free Memory = 89003 MB
Rank =   54  Free Memory = 89003 MB
Rank =   55  Free Memory = 89003 MB
Rank =   56  Free Memory = 89003 MB
Rank =   57  Free Memory = 89003 MB
Rank =   58  Free Memory = 89003 MB
Rank =   59  Free Memory = 89003 MB
Rank =   60  Free Memory = 89003 MB
Rank =   61  Free Memory = 89003 MB
Rank =   62  Free Memory = 89003 MB
Rank =   63  Free Memory = 89003 MB
Rank =   64  Free Memory = 89690 MB
Rank =   65  Free Memory = 89690 MB
Rank =   66  Free Memory = 89690 MB
Rank =   67  Free Memory = 89689 MB
Rank =   68  Free Memory = 89689 MB
Rank =   69  Free Memory = 89689 MB
Rank =   70  Free Memory = 89689 MB
Rank =   71  Free Memory = 89689 MB
Rank =   72  Free Memory = 89689 MB
Rank =   73  Free Memory = 89689 MB
Rank =   74  Free Memory = 89689 MB
Rank =   75  Free Memory = 89689 MB
Rank =   76  Free Memory = 89689 MB
Rank =   77  Free Memory = 89689 MB
Rank =   78  Free Memory = 89689 MB
Rank =   79  Free Memory = 89689 MB
Rank =   80  Free Memory = 89689 MB
Rank =   81  Free Memory = 89689 MB
Rank =   82  Free Memory = 89689 MB
Rank =   83  Free Memory = 89689 MB
Rank =   84  Free Memory = 89689 MB
Rank =   85  Free Memory = 89689 MB
Rank =   86  Free Memory = 89689 MB
Rank =   87  Free Memory = 89689 MB
Rank =   88  Free Memory = 89689 MB
Rank =   89  Free Memory = 89689 MB
Rank =   90  Free Memory = 89689 MB
Rank =   91  Free Memory = 89689 MB
Rank =   92  Free Memory = 89689 MB
Rank =   93  Free Memory = 89689 MB
Rank =   94  Free Memory = 89689 MB
Rank =   95  Free Memory = 89689 MB
Rank =   96  Free Memory = 85072 MB
Rank =   97  Free Memory = 85072 MB
Rank =   98  Free Memory = 85072 MB
Rank =   99  Free Memory = 85072 MB
Rank =  100  Free Memory = 85072 MB
Rank =  101  Free Memory = 85072 MB
Rank =  102  Free Memory = 85072 MB
Rank =  103  Free Memory = 85072 MB
Rank =  104  Free Memory = 85072 MB
Rank =  105  Free Memory = 85072 MB
Rank =  106  Free Memory = 85072 MB
Rank =  107  Free Memory = 85072 MB
Rank =  108  Free Memory = 85072 MB
Rank =  109  Free Memory = 85072 MB
Rank =  110  Free Memory = 85072 MB
Rank =  111  Free Memory = 85072 MB
Rank =  112  Free Memory = 85072 MB
Rank =  113  Free Memory = 85072 MB
Rank =  114  Free Memory = 85072 MB
Rank =  115  Free Memory = 85072 MB
Rank =  116  Free Memory = 85072 MB
Rank =  117  Free Memory = 85072 MB
Rank =  118  Free Memory = 85072 MB
Rank =  119  Free Memory = 85072 MB
Rank =  120  Free Memory = 85072 MB
Rank =  121  Free Memory = 85072 MB
Rank =  122  Free Memory = 85072 MB
Rank =  123  Free Memory = 85072 MB
Rank =  124  Free Memory = 85072 MB
Rank =  125  Free Memory = 85072 MB
Rank =  126  Free Memory = 85072 MB
Rank =  127  Free Memory = 85072 MB
  Input file(s): opt_h2o_gs_gvptt_run002j.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002j.xml

  Project = H2O
  date    = 2023-04-02 10:33:14 PDT
  host    = n0046.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 90

  Range of prime numbers to use as seeds over processors and threads = 479-1373


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.908804e-01    1         1  ON     0
     uu_1                 2.817136e-02    1         1  ON     1
     uu_2                -6.766332e-02    1         1  ON     2
     uu_3                -1.243933e-01    1         1  ON     3
     uu_4                -1.604003e-01    1         1  ON     4
     uu_5                -1.723971e-01    1         1  ON     5
     uu_6                -1.595693e-01    1         1  ON     6
     uu_7                -1.136087e-01    1         1  ON     7
     uu_8                -3.690974e-02    1         1  ON     8
     uu_9                 1.618559e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495282e-01    1         1  ON     0
     ud_1                 9.091760e-02    1         1  ON     1
     ud_2                -1.919547e-02    1         1  ON     2
     ud_3                -8.106365e-02    1         1  ON     3
     ud_4                -1.309665e-01    1         1  ON     4
     ud_5                -1.677708e-01    1         1  ON     5
     ud_6                -1.807826e-01    1         1  ON     6
     ud_7                -1.595558e-01    1         1  ON     7
     ud_8                -9.934399e-02    1         1  ON     8
     ud_9                -8.482942e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.257032e-01    1         1  ON     0
     eO_1                -6.031466e-01    1         1  ON     1
     eO_2                -1.884090e-01    1         1  ON     2
     eO_3                 8.085754e-02    1         1  ON     3
     eO_4                 2.054376e-01    1         1  ON     4
     eO_5                 2.935191e-01    1         1  ON     5
     eO_6                 3.341305e-01    1         1  ON     6
     eO_7                 5.022927e-01    1         1  ON     7
     eO_8                 1.940629e-01    1         1  ON     8
     eO_9                 6.117318e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.117350e-01    1         1  ON     0
     eH1_1                -1.328575e-01    1         1  ON     1
     eH1_2                -9.151311e-02    1         1  ON     2
     eH1_3                -5.387293e-02    1         1  ON     3
     eH1_4                -7.403026e-03    1         1  ON     4
     eH1_5                 4.737137e-03    1         1  ON     5
     eH1_6                 4.141881e-02    1         1  ON     6
     eH1_7                 6.403844e-02    1         1  ON     7
     eH1_8                 1.798806e-01    1         1  ON     8
     eH1_9                 1.210057e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.069383e-01    1         1  ON     0
     eH2_1                -1.280562e-01    1         1  ON     1
     eH2_2                -8.657096e-02    1         1  ON     2
     eH2_3                -4.901886e-02    1         1  ON     3
     eH2_4                -2.795007e-03    1         1  ON     4
     eH2_5                 9.095833e-03    1         1  ON     5
     eH2_6                 4.676920e-02    1         1  ON     6
     eH2_7                 4.635957e-02    1         1  ON     7
     eH2_8                 1.982470e-01    1         1  ON     8
     eH2_9                 1.201569e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.698713e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.2484e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2438
    reference variance = 0.194677
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1980e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914743541
                                         uncertainty =       0.005223121081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914743541
                                         uncertainty =       0.005223121081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399875397
  error estimate for blocks of size 2^( 2) =       0.000409231693
  error estimate for blocks of size 2^( 3) =       0.000417754093
  error estimate for blocks of size 2^( 4) =       0.000423613606
  error estimate for blocks of size 2^( 5) =       0.000427054672
  error estimate for blocks of size 2^( 6) =       0.000430177226
  error estimate for blocks of size 2^( 7) =       0.000431251776

      target function =                  N/A
              le_mean =     -17.217266760403
             les_mean =     296.754075205911
             stat err =       0.000428024320
             autocorr =       1.145743818512
              std dev =       0.565509210298
             le_variance =       0.319800666932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721726676040e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266760403       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217265702343       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217265341483       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217269708890       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217271774507       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217273522025       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217273285175       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217273099018       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217272964686       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217272960371       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.525031e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266760403       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266351432       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266097854       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217267360283       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217268624571       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217268931558       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217268808628       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217268782527       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.855406e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217266760403       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217266641994       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266551903       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266856304       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217267285217       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217267332092       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217267311903       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.312417e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6239e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.908032e-01                 1 1 ON  0
uu_1  2.826044e-02                 1 1 ON  1
uu_2  -6.765469e-02                1 1 ON  2
uu_3  -1.244104e-01                1 1 ON  3
uu_4  -1.604626e-01                1 1 ON  4
uu_5  -1.723907e-01                1 1 ON  5
uu_6  -1.596071e-01                1 1 ON  6
uu_7  -1.135713e-01                1 1 ON  7
uu_8  -3.687957e-02                1 1 ON  8
uu_9  1.618456e-01                 1 1 ON  9
ud_0  3.497535e-01                 1 1 ON  10
ud_1  9.102322e-02                 1 1 ON  11
ud_2  -1.929580e-02                1 1 ON  12
ud_3  -8.121360e-02                1 1 ON  13
ud_4  -1.311130e-01                1 1 ON  14
ud_5  -1.677697e-01                1 1 ON  15
ud_6  -1.807127e-01                1 1 ON  16
ud_7  -1.595547e-01                1 1 ON  17
ud_8  -9.935770e-02                1 1 ON  18
ud_9  -8.493013e-03                1 1 ON  19
eO_0  -9.261887e-01                1 1 ON  20
eO_1  -6.032953e-01                1 1 ON  21
eO_2  -1.882204e-01                1 1 ON  22
eO_3  8.119679e-02                 1 1 ON  23
eO_4  2.055935e-01                 1 1 ON  24
eO_5  2.935005e-01                 1 1 ON  25
eO_6  3.340771e-01                 1 1 ON  26
eO_7  5.022805e-01                 1 1 ON  27
eO_8  1.940885e-01                 1 1 ON  28
eO_9  6.118039e-02                 1 1 ON  29
eH1_0 -2.118128e-01                1 1 ON  30
eH1_1 -1.329128e-01                1 1 ON  31
eH1_2 -9.146745e-02                1 1 ON  32
eH1_3 -5.386734e-02                1 1 ON  33
eH1_4 -7.358014e-03                1 1 ON  34
eH1_5 4.807774e-03                 1 1 ON  35
eH1_6 4.141821e-02                 1 1 ON  36
eH1_7 6.400086e-02                 1 1 ON  37
eH1_8 1.798790e-01                 1 1 ON  38
eH1_9 1.210093e-01                 1 1 ON  39
eH2_0 -2.070113e-01                1 1 ON  40
eH2_1 -1.281473e-01                1 1 ON  41
eH2_2 -8.656417e-02                1 1 ON  42
eH2_3 -4.896242e-02                1 1 ON  43
eH2_4 -2.734269e-03                1 1 ON  44
eH2_5 9.133082e-03                 1 1 ON  45
eH2_6 4.677471e-02                 1 1 ON  46
eH2_7 4.636249e-02                 1 1 ON  47
eH2_8 1.982282e-01                 1 1 ON  48
eH2_9 1.201618e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.21
    reference variance = 0.343101
====================================================
  Execution time = 2.0007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1228e-01
  Total weights = 2.0000e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312051100243
                                         uncertainty =       0.002446624684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312051100243
                                         uncertainty =       0.002446624684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395007415
  error estimate for blocks of size 2^( 2) =       0.000404660448
  error estimate for blocks of size 2^( 3) =       0.000412895646
  error estimate for blocks of size 2^( 4) =       0.000419006167
  error estimate for blocks of size 2^( 5) =       0.000422947929
  error estimate for blocks of size 2^( 6) =       0.000424545929
  error estimate for blocks of size 2^( 7) =       0.000424643590

      target function =                  N/A
              le_mean =     -17.216610724276
             les_mean =     296.723746390697
             stat err =       0.000422785904
             autocorr =       1.145593397975
              std dev =       0.558624843223
             le_variance =       0.312061715466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312651099175
                                         uncertainty =       0.002450587721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312651099175
                                         uncertainty =       0.002450587721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395386841
  error estimate for blocks of size 2^( 2) =       0.000405015887
  error estimate for blocks of size 2^( 3) =       0.000413227471
  error estimate for blocks of size 2^( 4) =       0.000419320736
  error estimate for blocks of size 2^( 5) =       0.000423255589
  error estimate for blocks of size 2^( 6) =       0.000424844867
  error estimate for blocks of size 2^( 7) =       0.000424940266

      target function =                  N/A
              le_mean =     -17.216616154340
             les_mean =     296.724533157166
             stat err =       0.000423090365
             autocorr =       1.145043136007
              std dev =       0.559161432516
             le_variance =       0.312661507613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312483610045
                                         uncertainty =       0.002449150467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312483610045
                                         uncertainty =       0.002449150467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395280931
  error estimate for blocks of size 2^( 2) =       0.000404915111
  error estimate for blocks of size 2^( 3) =       0.000413132972
  error estimate for blocks of size 2^( 4) =       0.000419230416
  error estimate for blocks of size 2^( 5) =       0.000423167277
  error estimate for blocks of size 2^( 6) =       0.000424758237
  error estimate for blocks of size 2^( 7) =       0.000424854162

      target function =                  N/A
              le_mean =     -17.216614596191
             les_mean =     296.724312027069
             stat err =       0.000423002523
             autocorr =       1.145181139547
              std dev =       0.559011654217
             le_variance =       0.312494029551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312112155893
                                         uncertainty =       0.002446960997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312112155893
                                         uncertainty =       0.002446960997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395046035
  error estimate for blocks of size 2^( 2) =       0.000404696257
  error estimate for blocks of size 2^( 3) =       0.000412928964
  error estimate for blocks of size 2^( 4) =       0.000419037578
  error estimate for blocks of size 2^( 5) =       0.000422978630
  error estimate for blocks of size 2^( 6) =       0.000424575580
  error estimate for blocks of size 2^( 7) =       0.000424673013

      target function =                  N/A
              le_mean =     -17.216611205005
             les_mean =     296.723823968526
             stat err =       0.000422816200
             autocorr =       1.145533573796
              std dev =       0.558679461126
             le_variance =       0.312122740284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216610724276        initial
     2.5000e-01     2.5000e+00             1.5250e-03       -17.216616154340  <--
     1.0000e+00     1.0000e+01             4.8554e-04       -17.216614596191
     4.0000e+00     4.0000e+01             1.3124e-04       -17.216611205005

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9378e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.908317e-01 1 1  ON 0
 uu_1                 2.839019e-02 1 1  ON 1
 uu_2                -6.765162e-02 1 1  ON 2
 uu_3                -1.244921e-01 1 1  ON 3
 uu_4                -1.606472e-01 1 1  ON 4
 uu_5                -1.724473e-01 1 1  ON 5
 uu_6                -1.597135e-01 1 1  ON 6
 uu_7                -1.134601e-01 1 1  ON 7
 uu_8                -3.679055e-02 1 1  ON 8
 uu_9                 1.618158e-01 1 1  ON 9
 ud_0                 3.501543e-01 1 1  ON 10
 ud_1                 9.121728e-02 1 1  ON 11
 ud_2                -1.939860e-02 1 1  ON 12
 ud_3                -8.149929e-02 1 1  ON 13
 ud_4                -1.314530e-01 1 1  ON 14
 ud_5                -1.678435e-01 1 1  ON 15
 ud_6                -1.805196e-01 1 1  ON 16
 ud_7                -1.595301e-01 1 1  ON 17
 ud_8                -9.939110e-02 1 1  ON 18
 ud_9                -8.521537e-03 1 1  ON 19
 eO_0                -9.272282e-01 1 1  ON 20
 eO_1                -6.037288e-01 1 1  ON 21
 eO_2                -1.879455e-01 1 1  ON 22
 eO_3                 8.199366e-02 1 1  ON 23
 eO_4                 2.060946e-01 1 1  ON 24
 eO_5                 2.934825e-01 1 1  ON 25
 eO_6                 3.339275e-01 1 1  ON 26
 eO_7                 5.022461e-01 1 1  ON 27
 eO_8                 1.941636e-01 1 1  ON 28
 eO_9                 6.120154e-02 1 1  ON 29
eH1_0                -2.119934e-01 1 1  ON 30
eH1_1                -1.330349e-01 1 1  ON 31
eH1_2                -9.139566e-02 1 1  ON 32
eH1_3                -5.382119e-02 1 1  ON 33
eH1_4                -7.289110e-03 1 1  ON 34
eH1_5                 4.994075e-03 1 1  ON 35
eH1_6                 4.143853e-02 1 1  ON 36
eH1_7                 6.389679e-02 1 1  ON 37
eH1_8                 1.798751e-01 1 1  ON 38
eH1_9                 1.210199e-01 1 1  ON 39
eH2_0                -2.071901e-01 1 1  ON 40
eH2_1                -1.283165e-01 1 1  ON 41
eH2_2                -8.655105e-02 1 1  ON 42
eH2_3                -4.887992e-02 1 1  ON 43
eH2_4                -2.624189e-03 1 1  ON 44
eH2_5                 9.242756e-03 1 1  ON 45
eH2_6                 4.681051e-02 1 1  ON 46
eH2_7                 4.637503e-02 1 1  ON 47
eH2_8                 1.981738e-01 1 1  ON 48
eH2_9                 1.201763e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.155688
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316371381811
                                         uncertainty =       0.004295717203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316371381811
                                         uncertainty =       0.004295717203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397694884
  error estimate for blocks of size 2^( 2) =       0.000407163068
  error estimate for blocks of size 2^( 3) =       0.000415450779
  error estimate for blocks of size 2^( 4) =       0.000421531509
  error estimate for blocks of size 2^( 5) =       0.000424865503
  error estimate for blocks of size 2^( 6) =       0.000427570833
  error estimate for blocks of size 2^( 7) =       0.000430077758

      target function =                  N/A
              le_mean =     -17.216865840512
             les_mean =     296.736791652753
             stat err =       0.000426011400
             autocorr =       1.147472894631
              std dev =       0.562425497941
             le_variance =       0.316322440735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686584051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865840512       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216869394755       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216870530482       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216865668457       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216868484360       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216870604775       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216870867481       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216871824132       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216871753523       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216872344386       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216872325622       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.961000e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865840512       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216867818788       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868764864       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216866102360       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216866009561       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216867403642       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216867847325       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216868224918       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216868191024       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216868219167       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.189181e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865840512       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216866553759       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216867052846       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216866378670       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216865932825       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216866259161       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216866437808       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216866508915       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.631190e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5857e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.913083e-01 1 1  ON 0
 uu_1                 2.856362e-02 1 1  ON 1
 uu_2                -6.758714e-02 1 1  ON 2
 uu_3                -1.245450e-01 1 1  ON 3
 uu_4                -1.608806e-01 1 1  ON 4
 uu_5                -1.726063e-01 1 1  ON 5
 uu_6                -1.598816e-01 1 1  ON 6
 uu_7                -1.135947e-01 1 1  ON 7
 uu_8                -3.686681e-02 1 1  ON 8
 uu_9                 1.617718e-01 1 1  ON 9
 ud_0                 3.506210e-01 1 1  ON 10
 ud_1                 9.139842e-02 1 1  ON 11
 ud_2                -1.943363e-02 1 1  ON 12
 ud_3                -8.173141e-02 1 1  ON 13
 ud_4                -1.317139e-01 1 1  ON 14
 ud_5                -1.679825e-01 1 1  ON 15
 ud_6                -1.804217e-01 1 1  ON 16
 ud_7                -1.595592e-01 1 1  ON 17
 ud_8                -9.955190e-02 1 1  ON 18
 ud_9                -8.501529e-03 1 1  ON 19
 eO_0                -9.283229e-01 1 1  ON 20
 eO_1                -6.044276e-01 1 1  ON 21
 eO_2                -1.877437e-01 1 1  ON 22
 eO_3                 8.318284e-02 1 1  ON 23
 eO_4                 2.067933e-01 1 1  ON 24
 eO_5                 2.933134e-01 1 1  ON 25
 eO_6                 3.337623e-01 1 1  ON 26
 eO_7                 5.021823e-01 1 1  ON 27
 eO_8                 1.942247e-01 1 1  ON 28
 eO_9                 6.122830e-02 1 1  ON 29
eH1_0                -2.120892e-01 1 1  ON 30
eH1_1                -1.331345e-01 1 1  ON 31
eH1_2                -9.132966e-02 1 1  ON 32
eH1_3                -5.370385e-02 1 1  ON 33
eH1_4                -7.277914e-03 1 1  ON 34
eH1_5                 5.042084e-03 1 1  ON 35
eH1_6                 4.148504e-02 1 1  ON 36
eH1_7                 6.379530e-02 1 1  ON 37
eH1_8                 1.798533e-01 1 1  ON 38
eH1_9                 1.210234e-01 1 1  ON 39
eH2_0                -2.073141e-01 1 1  ON 40
eH2_1                -1.282085e-01 1 1  ON 41
eH2_2                -8.643365e-02 1 1  ON 42
eH2_3                -4.879847e-02 1 1  ON 43
eH2_4                -2.631917e-03 1 1  ON 44
eH2_5                 9.071341e-03 1 1  ON 45
eH2_6                 4.684527e-02 1 1  ON 46
eH2_7                 4.636807e-02 1 1  ON 47
eH2_8                 1.981212e-01 1 1  ON 48
eH2_9                 1.201845e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2604
    reference variance = 0.348813
====================================================
  Execution time = 1.9473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1599e-01
  Total weights = 2.0000e+06
  Execution time = 1.8681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315436533441
                                         uncertainty =       0.003494272927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315436533441
                                         uncertainty =       0.003494272927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397185315
  error estimate for blocks of size 2^( 2) =       0.000406505891
  error estimate for blocks of size 2^( 3) =       0.000415097968
  error estimate for blocks of size 2^( 4) =       0.000421516802
  error estimate for blocks of size 2^( 5) =       0.000424746696
  error estimate for blocks of size 2^( 6) =       0.000427495645
  error estimate for blocks of size 2^( 7) =       0.000427049068

      target function =                  N/A
              le_mean =     -17.216916251928
             les_mean =     296.737717417646
             stat err =       0.000425202052
             autocorr =       1.146052036760
              std dev =       0.561704859790
             le_variance =       0.315512349511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316404673780
                                         uncertainty =       0.003503111483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316404673780
                                         uncertainty =       0.003503111483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397794964
  error estimate for blocks of size 2^( 2) =       0.000407092298
  error estimate for blocks of size 2^( 3) =       0.000415654507
  error estimate for blocks of size 2^( 4) =       0.000422044710
  error estimate for blocks of size 2^( 5) =       0.000425251594
  error estimate for blocks of size 2^( 6) =       0.000428006106
  error estimate for blocks of size 2^( 7) =       0.000427548292

      target function =                  N/A
              le_mean =     -17.216916895348
             les_mean =     296.738708889174
             stat err =       0.000425712675
             autocorr =       1.145287714191
              std dev =       0.562567032547
             le_variance =       0.316481666108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316393000381
                                         uncertainty =       0.003502557821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316393000381
                                         uncertainty =       0.003502557821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397787502
  error estimate for blocks of size 2^( 2) =       0.000407084644
  error estimate for blocks of size 2^( 3) =       0.000415649222
  error estimate for blocks of size 2^( 4) =       0.000422040311
  error estimate for blocks of size 2^( 5) =       0.000425247244
  error estimate for blocks of size 2^( 6) =       0.000428001760
  error estimate for blocks of size 2^( 7) =       0.000427547830

      target function =                  N/A
              le_mean =     -17.216917496913
             les_mean =     296.738717730095
             stat err =       0.000425709286
             autocorr =       1.145312446722
              std dev =       0.562556479680
             le_variance =       0.316469792830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315617835760
                                         uncertainty =       0.003495696615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315617835760
                                         uncertainty =       0.003495696615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397299517
  error estimate for blocks of size 2^( 2) =       0.000406615247
  error estimate for blocks of size 2^( 3) =       0.000415202217
  error estimate for blocks of size 2^( 4) =       0.000421615928
  error estimate for blocks of size 2^( 5) =       0.000424841408
  error estimate for blocks of size 2^( 6) =       0.000427591326
  error estimate for blocks of size 2^( 7) =       0.000427143894

      target function =                  N/A
              le_mean =     -17.216916238076
             les_mean =     296.737898403343
             stat err =       0.000425298139
             autocorr =       1.145911006154
              std dev =       0.561866365141
             le_variance =       0.315693812277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216916251928        initial
     6.2500e-02     6.2500e-01             2.9610e-03       -17.216916895348
     2.5000e-01     2.5000e+00             1.1892e-03       -17.216917496913  <--
     1.0000e+00     1.0000e+01             3.6312e-04       -17.216916238076

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.8883e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.913083e-01 1 1  ON 0
 uu_1                 2.856362e-02 1 1  ON 1
 uu_2                -6.758714e-02 1 1  ON 2
 uu_3                -1.245450e-01 1 1  ON 3
 uu_4                -1.608806e-01 1 1  ON 4
 uu_5                -1.726063e-01 1 1  ON 5
 uu_6                -1.598816e-01 1 1  ON 6
 uu_7                -1.135947e-01 1 1  ON 7
 uu_8                -3.686681e-02 1 1  ON 8
 uu_9                 1.617718e-01 1 1  ON 9
 ud_0                 3.506210e-01 1 1  ON 10
 ud_1                 9.139842e-02 1 1  ON 11
 ud_2                -1.943363e-02 1 1  ON 12
 ud_3                -8.173141e-02 1 1  ON 13
 ud_4                -1.317139e-01 1 1  ON 14
 ud_5                -1.679825e-01 1 1  ON 15
 ud_6                -1.804217e-01 1 1  ON 16
 ud_7                -1.595592e-01 1 1  ON 17
 ud_8                -9.955190e-02 1 1  ON 18
 ud_9                -8.501529e-03 1 1  ON 19
 eO_0                -9.283229e-01 1 1  ON 20
 eO_1                -6.044276e-01 1 1  ON 21
 eO_2                -1.877437e-01 1 1  ON 22
 eO_3                 8.318284e-02 1 1  ON 23
 eO_4                 2.067933e-01 1 1  ON 24
 eO_5                 2.933134e-01 1 1  ON 25
 eO_6                 3.337623e-01 1 1  ON 26
 eO_7                 5.021823e-01 1 1  ON 27
 eO_8                 1.942247e-01 1 1  ON 28
 eO_9                 6.122830e-02 1 1  ON 29
eH1_0                -2.120892e-01 1 1  ON 30
eH1_1                -1.331345e-01 1 1  ON 31
eH1_2                -9.132966e-02 1 1  ON 32
eH1_3                -5.370385e-02 1 1  ON 33
eH1_4                -7.277914e-03 1 1  ON 34
eH1_5                 5.042084e-03 1 1  ON 35
eH1_6                 4.148504e-02 1 1  ON 36
eH1_7                 6.379530e-02 1 1  ON 37
eH1_8                 1.798533e-01 1 1  ON 38
eH1_9                 1.210234e-01 1 1  ON 39
eH2_0                -2.073141e-01 1 1  ON 40
eH2_1                -1.282085e-01 1 1  ON 41
eH2_2                -8.643365e-02 1 1  ON 42
eH2_3                -4.879847e-02 1 1  ON 43
eH2_4                -2.631917e-03 1 1  ON 44
eH2_5                 9.071341e-03 1 1  ON 45
eH2_6                 4.684527e-02 1 1  ON 46
eH2_7                 4.636807e-02 1 1  ON 47
eH2_8                 1.981212e-01 1 1  ON 48
eH2_9                 1.201845e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7236e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2031
    reference variance = 0.31202
====================================================
  Execution time = 2.2230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1415e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314124014566
                                         uncertainty =       0.003213917180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314124014566
                                         uncertainty =       0.003213917180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396328942
  error estimate for blocks of size 2^( 2) =       0.000405491274
  error estimate for blocks of size 2^( 3) =       0.000413669105
  error estimate for blocks of size 2^( 4) =       0.000419326328
  error estimate for blocks of size 2^( 5) =       0.000422935685
  error estimate for blocks of size 2^( 6) =       0.000426176059
  error estimate for blocks of size 2^( 7) =       0.000428996875

      target function =                  N/A
              le_mean =     -17.216891068465
             les_mean =     296.735491166058
             stat err =       0.000424358737
             autocorr =       1.146448951323
              std dev =       0.560493764247
             le_variance =       0.314153259760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689106846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891068465       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216892714268       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216892139856       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216893165875       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216895200201       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216896177304       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216897685770       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216895364540       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216895276199       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216895112892       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216895602548       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216895529056       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.477945e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891068465       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216892072761       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216891428249       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216892233194       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216892790978       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216893594772       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216893494224       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216893395219       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216892948895       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.016156e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216891068465       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216891460900       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216891187471       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216891094685       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216891503307       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216891803571       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216891780835       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216891776888       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.237250e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7779e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.915770e-01 1 1  ON 0
 uu_1                 2.861022e-02 1 1  ON 1
 uu_2                -6.758349e-02 1 1  ON 2
 uu_3                -1.244873e-01 1 1  ON 3
 uu_4                -1.609029e-01 1 1  ON 4
 uu_5                -1.727895e-01 1 1  ON 5
 uu_6                -1.599753e-01 1 1  ON 6
 uu_7                -1.137156e-01 1 1  ON 7
 uu_8                -3.687579e-02 1 1  ON 8
 uu_9                 1.616999e-01 1 1  ON 9
 ud_0                 3.510054e-01 1 1  ON 10
 ud_1                 9.163752e-02 1 1  ON 11
 ud_2                -1.931497e-02 1 1  ON 12
 ud_3                -8.187622e-02 1 1  ON 13
 ud_4                -1.317248e-01 1 1  ON 14
 ud_5                -1.682288e-01 1 1  ON 15
 ud_6                -1.805056e-01 1 1  ON 16
 ud_7                -1.597786e-01 1 1  ON 17
 ud_8                -9.970668e-02 1 1  ON 18
 ud_9                -8.497837e-03 1 1  ON 19
 eO_0                -9.291246e-01 1 1  ON 20
 eO_1                -6.049380e-01 1 1  ON 21
 eO_2                -1.876437e-01 1 1  ON 22
 eO_3                 8.373927e-02 1 1  ON 23
 eO_4                 2.074713e-01 1 1  ON 24
 eO_5                 2.933783e-01 1 1  ON 25
 eO_6                 3.336516e-01 1 1  ON 26
 eO_7                 5.020913e-01 1 1  ON 27
 eO_8                 1.942974e-01 1 1  ON 28
 eO_9                 6.125520e-02 1 1  ON 29
eH1_0                -2.120631e-01 1 1  ON 30
eH1_1                -1.330281e-01 1 1  ON 31
eH1_2                -9.120757e-02 1 1  ON 32
eH1_3                -5.345557e-02 1 1  ON 33
eH1_4                -7.393129e-03 1 1  ON 34
eH1_5                 4.802475e-03 1 1  ON 35
eH1_6                 4.135550e-02 1 1  ON 36
eH1_7                 6.375430e-02 1 1  ON 37
eH1_8                 1.798298e-01 1 1  ON 38
eH1_9                 1.210412e-01 1 1  ON 39
eH2_0                -2.072367e-01 1 1  ON 40
eH2_1                -1.283717e-01 1 1  ON 41
eH2_2                -8.645313e-02 1 1  ON 42
eH2_3                -4.890733e-02 1 1  ON 43
eH2_4                -2.621598e-03 1 1  ON 44
eH2_5                 9.193377e-03 1 1  ON 45
eH2_6                 4.699572e-02 1 1  ON 46
eH2_7                 4.636287e-02 1 1  ON 47
eH2_8                 1.980289e-01 1 1  ON 48
eH2_9                 1.202035e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1444
    reference variance = 0.202179
====================================================
  Execution time = 1.9745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1394e-01
  Total weights = 2.0000e+06
  Execution time = 1.8628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313733900484
                                         uncertainty =       0.003085991767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313733900484
                                         uncertainty =       0.003085991767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396033177
  error estimate for blocks of size 2^( 2) =       0.000405610389
  error estimate for blocks of size 2^( 3) =       0.000413962266
  error estimate for blocks of size 2^( 4) =       0.000420405554
  error estimate for blocks of size 2^( 5) =       0.000425269747
  error estimate for blocks of size 2^( 6) =       0.000426137059
  error estimate for blocks of size 2^( 7) =       0.000426658265

      target function =                  N/A
              le_mean =     -17.216824995827
             les_mean =     296.732747335056
             stat err =       0.000424617656
             autocorr =       1.149563478745
              std dev =       0.560075490405
             le_variance =       0.313684554952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314302050076
                                         uncertainty =       0.003088816300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314302050076
                                         uncertainty =       0.003088816300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396391600
  error estimate for blocks of size 2^( 2) =       0.000405953278
  error estimate for blocks of size 2^( 3) =       0.000414286824
  error estimate for blocks of size 2^( 4) =       0.000420718581
  error estimate for blocks of size 2^( 5) =       0.000425579598
  error estimate for blocks of size 2^( 6) =       0.000426439710
  error estimate for blocks of size 2^( 7) =       0.000426952815

      target function =                  N/A
              le_mean =     -17.216825752823
             les_mean =     296.733341446538
             stat err =       0.000424922676
             autocorr =       1.149134679169
              std dev =       0.560582376276
             le_variance =       0.314252600591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314245397399
                                         uncertainty =       0.003087698240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314245397399
                                         uncertainty =       0.003087698240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396355848
  error estimate for blocks of size 2^( 2) =       0.000405918840
  error estimate for blocks of size 2^( 3) =       0.000414255748
  error estimate for blocks of size 2^( 4) =       0.000420690724
  error estimate for blocks of size 2^( 5) =       0.000425554263
  error estimate for blocks of size 2^( 6) =       0.000426414505
  error estimate for blocks of size 2^( 7) =       0.000426927018

      target function =                  N/A
              le_mean =     -17.216825139835
             les_mean =     296.733263654453
             stat err =       0.000424896628
             autocorr =       1.149201087542
              std dev =       0.560531815252
             le_variance =       0.314195915910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313828030074
                                         uncertainty =       0.003086293698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313828030074
                                         uncertainty =       0.003086293698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396092576
  error estimate for blocks of size 2^( 2) =       0.000405667031
  error estimate for blocks of size 2^( 3) =       0.000414016294
  error estimate for blocks of size 2^( 4) =       0.000420458139
  error estimate for blocks of size 2^( 5) =       0.000425322442
  error estimate for blocks of size 2^( 6) =       0.000426188219
  error estimate for blocks of size 2^( 7) =       0.000426707906

      target function =                  N/A
              le_mean =     -17.216824765240
             les_mean =     296.732833498118
             stat err =       0.000424669177
             autocorr =       1.149497615157
              std dev =       0.560159493384
             le_variance =       0.313778658029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216824995827        initial
     6.2500e-02     6.2500e-01             2.4779e-03       -17.216825752823  <--
     2.5000e-01     2.5000e+00             8.0162e-04       -17.216825139835
     1.0000e+00     1.0000e+01             2.2372e-04       -17.216824765240

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 3.1674e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.919809e-01 1 1  ON 0
 uu_1                 2.886054e-02 1 1  ON 1
 uu_2                -6.742400e-02 1 1  ON 2
 uu_3                -1.244382e-01 1 1  ON 3
 uu_4                -1.609996e-01 1 1  ON 4
 uu_5                -1.731693e-01 1 1  ON 5
 uu_6                -1.601656e-01 1 1  ON 6
 uu_7                -1.140310e-01 1 1  ON 7
 uu_8                -3.690346e-02 1 1  ON 8
 uu_9                 1.614922e-01 1 1  ON 9
 ud_0                 3.515403e-01 1 1  ON 10
 ud_1                 9.204008e-02 1 1  ON 11
 ud_2                -1.907566e-02 1 1  ON 12
 ud_3                -8.186334e-02 1 1  ON 13
 ud_4                -1.318465e-01 1 1  ON 14
 ud_5                -1.685494e-01 1 1  ON 15
 ud_6                -1.806240e-01 1 1  ON 16
 ud_7                -1.603111e-01 1 1  ON 17
 ud_8                -1.001367e-01 1 1  ON 18
 ud_9                -8.490580e-03 1 1  ON 19
 eO_0                -9.306095e-01 1 1  ON 20
 eO_1                -6.060297e-01 1 1  ON 21
 eO_2                -1.878516e-01 1 1  ON 22
 eO_3                 8.455290e-02 1 1  ON 23
 eO_4                 2.092712e-01 1 1  ON 24
 eO_5                 2.937639e-01 1 1  ON 25
 eO_6                 3.333726e-01 1 1  ON 26
 eO_7                 5.018304e-01 1 1  ON 27
 eO_8                 1.945040e-01 1 1  ON 28
 eO_9                 6.133177e-02 1 1  ON 29
eH1_0                -2.118703e-01 1 1  ON 30
eH1_1                -1.328757e-01 1 1  ON 31
eH1_2                -9.098792e-02 1 1  ON 32
eH1_3                -5.319652e-02 1 1  ON 33
eH1_4                -7.395137e-03 1 1  ON 34
eH1_5                 4.333346e-03 1 1  ON 35
eH1_6                 4.104325e-02 1 1  ON 36
eH1_7                 6.365067e-02 1 1  ON 37
eH1_8                 1.797621e-01 1 1  ON 38
eH1_9                 1.210916e-01 1 1  ON 39
eH2_0                -2.073109e-01 1 1  ON 40
eH2_1                -1.285836e-01 1 1  ON 41
eH2_2                -8.652622e-02 1 1  ON 42
eH2_3                -4.897010e-02 1 1  ON 43
eH2_4                -2.587227e-03 1 1  ON 44
eH2_5                 9.280674e-03 1 1  ON 45
eH2_6                 4.745269e-02 1 1  ON 46
eH2_7                 4.638464e-02 1 1  ON 47
eH2_8                 1.977685e-01 1 1  ON 48
eH2_9                 1.202578e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1405
    reference variance = 0.286278
====================================================
  Execution time = 2.0140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318979184413
                                         uncertainty =       0.002969826000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318979184413
                                         uncertainty =       0.002969826000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399380823
  error estimate for blocks of size 2^( 2) =       0.000409199672
  error estimate for blocks of size 2^( 3) =       0.000418116258
  error estimate for blocks of size 2^( 4) =       0.000423738770
  error estimate for blocks of size 2^( 5) =       0.000427955174
  error estimate for blocks of size 2^( 6) =       0.000429440090
  error estimate for blocks of size 2^( 7) =       0.000429496401

      target function =                  N/A
              le_mean =     -17.216198807617
             les_mean =     296.716511306824
             stat err =       0.000427657609
             autocorr =       1.146615985196
              std dev =       0.564809775899
             le_variance =       0.319010082951


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619880762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198807617       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216197619172       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198672566       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216198803145       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199457850       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216200790127       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216201986659       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216202957170       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216201393678       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216203903718       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216204189321       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216203348004       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216203748172       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216203594155       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216203640802       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.136158e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198807617       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216197886542       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198769172       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216199070145       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199596541       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216200610389       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216201355516       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216201767250       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216200887564       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216201693400       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216201929802       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.502946e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198807617       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216198322814       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198847960       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216199205256       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199551113       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216200028636       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216200270747       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216200308957       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.742169e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5808e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.925112e-01 1 1  ON 0
 uu_1                 2.913186e-02 1 1  ON 1
 uu_2                -6.733442e-02 1 1  ON 2
 uu_3                -1.245554e-01 1 1  ON 3
 uu_4                -1.615063e-01 1 1  ON 4
 uu_5                -1.733007e-01 1 1  ON 5
 uu_6                -1.604794e-01 1 1  ON 6
 uu_7                -1.142068e-01 1 1  ON 7
 uu_8                -3.680577e-02 1 1  ON 8
 uu_9                 1.613073e-01 1 1  ON 9
 ud_0                 3.514814e-01 1 1  ON 10
 ud_1                 9.197524e-02 1 1  ON 11
 ud_2                -1.934262e-02 1 1  ON 12
 ud_3                -8.217118e-02 1 1  ON 13
 ud_4                -1.323498e-01 1 1  ON 14
 ud_5                -1.688074e-01 1 1  ON 15
 ud_6                -1.801464e-01 1 1  ON 16
 ud_7                -1.595408e-01 1 1  ON 17
 ud_8                -1.002433e-01 1 1  ON 18
 ud_9                -8.412491e-03 1 1  ON 19
 eO_0                -9.321124e-01 1 1  ON 20
 eO_1                -6.067503e-01 1 1  ON 21
 eO_2                -1.882231e-01 1 1  ON 22
 eO_3                 8.575274e-02 1 1  ON 23
 eO_4                 2.102792e-01 1 1  ON 24
 eO_5                 2.942557e-01 1 1  ON 25
 eO_6                 3.332117e-01 1 1  ON 26
 eO_7                 5.015461e-01 1 1  ON 27
 eO_8                 1.947374e-01 1 1  ON 28
 eO_9                 6.143083e-02 1 1  ON 29
eH1_0                -2.120114e-01 1 1  ON 30
eH1_1                -1.336184e-01 1 1  ON 31
eH1_2                -9.136157e-02 1 1  ON 32
eH1_3                -5.326020e-02 1 1  ON 33
eH1_4                -7.519485e-03 1 1  ON 34
eH1_5                 5.299775e-03 1 1  ON 35
eH1_6                 4.150821e-02 1 1  ON 36
eH1_7                 6.359721e-02 1 1  ON 37
eH1_8                 1.797554e-01 1 1  ON 38
eH1_9                 1.211187e-01 1 1  ON 39
eH2_0                -2.074786e-01 1 1  ON 40
eH2_1                -1.286564e-01 1 1  ON 41
eH2_2                -8.666941e-02 1 1  ON 42
eH2_3                -4.887532e-02 1 1  ON 43
eH2_4                -2.804383e-03 1 1  ON 44
eH2_5                 9.331485e-03 1 1  ON 45
eH2_6                 4.744696e-02 1 1  ON 46
eH2_7                 4.681378e-02 1 1  ON 47
eH2_8                 1.976550e-01 1 1  ON 48
eH2_9                 1.202824e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.185016
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1908e-01
  Total weights = 2.0000e+06
  Execution time = 1.8603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318793041818
                                         uncertainty =       0.002969097798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318793041818
                                         uncertainty =       0.002969097798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399200596
  error estimate for blocks of size 2^( 2) =       0.000408982133
  error estimate for blocks of size 2^( 3) =       0.000417370831
  error estimate for blocks of size 2^( 4) =       0.000423925740
  error estimate for blocks of size 2^( 5) =       0.000427829146
  error estimate for blocks of size 2^( 6) =       0.000430482304
  error estimate for blocks of size 2^( 7) =       0.000431988526

      target function =                  N/A
              le_mean =     -17.216583719219
             les_mean =     296.729477033376
             stat err =       0.000428556429
             autocorr =       1.152480713291
              std dev =       0.564554897115
             le_variance =       0.318722231857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319395515691
                                         uncertainty =       0.002973043545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319395515691
                                         uncertainty =       0.002973043545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399577537
  error estimate for blocks of size 2^( 2) =       0.000409339705
  error estimate for blocks of size 2^( 3) =       0.000417706685
  error estimate for blocks of size 2^( 4) =       0.000424243834
  error estimate for blocks of size 2^( 5) =       0.000428140941
  error estimate for blocks of size 2^( 6) =       0.000430783515
  error estimate for blocks of size 2^( 7) =       0.000432297181

      target function =                  N/A
              le_mean =     -17.216585051749
             les_mean =     296.730125100517
             stat err =       0.000428866368
             autocorr =       1.151971800999
              std dev =       0.565087971988
             le_variance =       0.319324416086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319525888656
                                         uncertainty =       0.002973550881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319525888656
                                         uncertainty =       0.002973550881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399659096
  error estimate for blocks of size 2^( 2) =       0.000409416092
  error estimate for blocks of size 2^( 3) =       0.000417780360
  error estimate for blocks of size 2^( 4) =       0.000424316466
  error estimate for blocks of size 2^( 5) =       0.000428212855
  error estimate for blocks of size 2^( 6) =       0.000430849113
  error estimate for blocks of size 2^( 7) =       0.000432365515

      target function =                  N/A
              le_mean =     -17.216587027798
             les_mean =     296.730323511566
             stat err =       0.000428935987
             autocorr =       1.151875567232
              std dev =       0.565203313462
             le_variance =       0.319454785548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953255131
                                         uncertainty =       0.002969854941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953255131
                                         uncertainty =       0.002969854941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399300888
  error estimate for blocks of size 2^( 2) =       0.000409075761
  error estimate for blocks of size 2^( 3) =       0.000417458483
  error estimate for blocks of size 2^( 4) =       0.000424008671
  error estimate for blocks of size 2^( 5) =       0.000427910633
  error estimate for blocks of size 2^( 6) =       0.000430559618
  error estimate for blocks of size 2^( 7) =       0.000432067667

      target function =                  N/A
              le_mean =     -17.216583792240
             les_mean =     296.729639713922
             stat err =       0.000428636647
             autocorr =       1.152333125372
              std dev =       0.564696731134
             le_variance =       0.318882398154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216583719219        initial
     1.5625e-02     1.5625e-01             3.1362e-03       -17.216585051749
     6.2500e-02     6.2500e-01             1.5029e-03       -17.216587027798  <--
     2.5000e-01     2.5000e+00             5.7422e-04       -17.216583792240

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9176e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.925112e-01 1 1  ON 0
 uu_1                 2.913186e-02 1 1  ON 1
 uu_2                -6.733442e-02 1 1  ON 2
 uu_3                -1.245554e-01 1 1  ON 3
 uu_4                -1.615063e-01 1 1  ON 4
 uu_5                -1.733007e-01 1 1  ON 5
 uu_6                -1.604794e-01 1 1  ON 6
 uu_7                -1.142068e-01 1 1  ON 7
 uu_8                -3.680577e-02 1 1  ON 8
 uu_9                 1.613073e-01 1 1  ON 9
 ud_0                 3.514814e-01 1 1  ON 10
 ud_1                 9.197524e-02 1 1  ON 11
 ud_2                -1.934262e-02 1 1  ON 12
 ud_3                -8.217118e-02 1 1  ON 13
 ud_4                -1.323498e-01 1 1  ON 14
 ud_5                -1.688074e-01 1 1  ON 15
 ud_6                -1.801464e-01 1 1  ON 16
 ud_7                -1.595408e-01 1 1  ON 17
 ud_8                -1.002433e-01 1 1  ON 18
 ud_9                -8.412491e-03 1 1  ON 19
 eO_0                -9.321124e-01 1 1  ON 20
 eO_1                -6.067503e-01 1 1  ON 21
 eO_2                -1.882231e-01 1 1  ON 22
 eO_3                 8.575274e-02 1 1  ON 23
 eO_4                 2.102792e-01 1 1  ON 24
 eO_5                 2.942557e-01 1 1  ON 25
 eO_6                 3.332117e-01 1 1  ON 26
 eO_7                 5.015461e-01 1 1  ON 27
 eO_8                 1.947374e-01 1 1  ON 28
 eO_9                 6.143083e-02 1 1  ON 29
eH1_0                -2.120114e-01 1 1  ON 30
eH1_1                -1.336184e-01 1 1  ON 31
eH1_2                -9.136157e-02 1 1  ON 32
eH1_3                -5.326020e-02 1 1  ON 33
eH1_4                -7.519485e-03 1 1  ON 34
eH1_5                 5.299775e-03 1 1  ON 35
eH1_6                 4.150821e-02 1 1  ON 36
eH1_7                 6.359721e-02 1 1  ON 37
eH1_8                 1.797554e-01 1 1  ON 38
eH1_9                 1.211187e-01 1 1  ON 39
eH2_0                -2.074786e-01 1 1  ON 40
eH2_1                -1.286564e-01 1 1  ON 41
eH2_2                -8.666941e-02 1 1  ON 42
eH2_3                -4.887532e-02 1 1  ON 43
eH2_4                -2.804383e-03 1 1  ON 44
eH2_5                 9.331485e-03 1 1  ON 45
eH2_6                 4.744696e-02 1 1  ON 46
eH2_7                 4.681378e-02 1 1  ON 47
eH2_8                 1.976550e-01 1 1  ON 48
eH2_9                 1.202824e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2097
    reference variance = 0.144045
====================================================
  Execution time = 2.0128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2211e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322165845167
                                         uncertainty =       0.006910838339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322165845167
                                         uncertainty =       0.006910838339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401316766
  error estimate for blocks of size 2^( 2) =       0.000410555549
  error estimate for blocks of size 2^( 3) =       0.000419250134
  error estimate for blocks of size 2^( 4) =       0.000426253054
  error estimate for blocks of size 2^( 5) =       0.000430228554
  error estimate for blocks of size 2^( 6) =       0.000431788898
  error estimate for blocks of size 2^( 7) =       0.000434095460

      target function =                  N/A
              le_mean =     -17.217386004033
             les_mean =     296.760490944191
             stat err =       0.000430591492
             autocorr =       1.151214577341
              std dev =       0.567547613297
             le_variance =       0.322110293359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738600403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386004033       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217390680373       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217391127893       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217391807639       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217391693888       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217393060203       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217392056537       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217392802095       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217393356799       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217393894306       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217393159541       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217393596380       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217393316596       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.240561e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386004033       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217389702996       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217389930018       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217390420287       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217390471830       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217391119103       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217390402974       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217390976063       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217391361268       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217391501118       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.164317e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217386004033       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217388018696       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217388068197       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217388362132       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217388712674       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217388417873       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217388596348       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217388509379       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.869719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5625e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2539
    reference variance = 0.299678
====================================================
  Execution time = 1.9763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1715e-01
  Total weights = 2.0000e+06
  Execution time = 1.8507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317286626334
                                         uncertainty =       0.003469208518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317286626334
                                         uncertainty =       0.003469208518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398312557
  error estimate for blocks of size 2^( 2) =       0.000407977406
  error estimate for blocks of size 2^( 3) =       0.000416300185
  error estimate for blocks of size 2^( 4) =       0.000423055800
  error estimate for blocks of size 2^( 5) =       0.000427735165
  error estimate for blocks of size 2^( 6) =       0.000429540240
  error estimate for blocks of size 2^( 7) =       0.000431884424

      target function =                  N/A
              le_mean =     -17.217797293731
             les_mean =     296.769849275082
             stat err =       0.000428053907
             autocorr =       1.154912111231
              std dev =       0.563299019812
             le_variance =       0.317305785721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317211575674
                                         uncertainty =       0.003468888718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317211575674
                                         uncertainty =       0.003468888718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398265182
  error estimate for blocks of size 2^( 2) =       0.000407931579
  error estimate for blocks of size 2^( 3) =       0.000416254722
  error estimate for blocks of size 2^( 4) =       0.000423005902
  error estimate for blocks of size 2^( 5) =       0.000427678740
  error estimate for blocks of size 2^( 6) =       0.000429469975
  error estimate for blocks of size 2^( 7) =       0.000431806790

      target function =                  N/A
              le_mean =     -17.217797859364
             les_mean =     296.769793278127
             stat err =       0.000427990352
             autocorr =       1.154843876956
              std dev =       0.563232022202
             le_variance =       0.317230310834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316993266868
                                         uncertainty =       0.003466205809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316993266868
                                         uncertainty =       0.003466205809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398127946
  error estimate for blocks of size 2^( 2) =       0.000407802563
  error estimate for blocks of size 2^( 3) =       0.000416132341
  error estimate for blocks of size 2^( 4) =       0.000422885072
  error estimate for blocks of size 2^( 5) =       0.000427558073
  error estimate for blocks of size 2^( 6) =       0.000429344598
  error estimate for blocks of size 2^( 7) =       0.000431672231

      target function =                  N/A
              le_mean =     -17.217799945271
             les_mean =     296.769646520248
             stat err =       0.000427864994
             autocorr =       1.154963298296
              std dev =       0.563037941317
             le_variance =       0.317011723363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317158234595
                                         uncertainty =       0.003467941110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317158234595
                                         uncertainty =       0.003467941110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398231789
  error estimate for blocks of size 2^( 2) =       0.000407900090
  error estimate for blocks of size 2^( 3) =       0.000416225840
  error estimate for blocks of size 2^( 4) =       0.000422980764
  error estimate for blocks of size 2^( 5) =       0.000427658550
  error estimate for blocks of size 2^( 6) =       0.000429459277
  error estimate for blocks of size 2^( 7) =       0.000431799245

      target function =                  N/A
              le_mean =     -17.217796818887
             les_mean =     296.769704253058
             stat err =       0.000427974459
             autocorr =       1.154951783903
              std dev =       0.563184796631
             le_variance =       0.317177115157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217797293731        initial
     1.5625e-02     1.5625e-01             2.2406e-03       -17.217797859364
     6.2500e-02     6.2500e-01             1.1643e-03       -17.217799945271  <--
     2.5000e-01     2.5000e+00             3.8697e-04       -17.217796818887

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9075e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.23601
====================================================
  Execution time = 2.0100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1899e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319024197005
                                         uncertainty =       0.008044145012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319024197005
                                         uncertainty =       0.008044145012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399368710
  error estimate for blocks of size 2^( 2) =       0.000409630371
  error estimate for blocks of size 2^( 3) =       0.000418302878
  error estimate for blocks of size 2^( 4) =       0.000425038380
  error estimate for blocks of size 2^( 5) =       0.000429004199
  error estimate for blocks of size 2^( 6) =       0.000431477219
  error estimate for blocks of size 2^( 7) =       0.000431165403

      target function =                  N/A
              le_mean =     -17.216117170094
             les_mean =     296.713680988316
             stat err =       0.000429171300
             autocorr =       1.154817275305
              std dev =       0.564792646394
             le_variance =       0.318990733421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611717009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117170094       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216118253638       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216116466270       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216115211858       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216114701633       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216115365990       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216116444347       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216116049784       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216114435609       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216114353611       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216114970724       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216115342917       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216115328781       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216115947184       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216116491410       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.291906e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117170094       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216118067387       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216116579690       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216115639151       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216115102067       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216115526911       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216116275719       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216115916446       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216115136348       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216115350274       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216115589669       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216115683189       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.613947e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117170094       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117701804       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216116907207       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216116255650       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216115917553       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216116109285       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216116431540       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216116244909       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216116085443       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.454533e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5686e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.930432e-01 1 1  ON 0
 uu_1                 2.936541e-02 1 1  ON 1
 uu_2                -6.705945e-02 1 1  ON 2
 uu_3                -1.246894e-01 1 1  ON 3
 uu_4                -1.614000e-01 1 1  ON 4
 uu_5                -1.740010e-01 1 1  ON 5
 uu_6                -1.611068e-01 1 1  ON 6
 uu_7                -1.141725e-01 1 1  ON 7
 uu_8                -3.687351e-02 1 1  ON 8
 uu_9                 1.607716e-01 1 1  ON 9
 ud_0                 3.520928e-01 1 1  ON 10
 ud_1                 9.251474e-02 1 1  ON 11
 ud_2                -1.885352e-02 1 1  ON 12
 ud_3                -8.198775e-02 1 1  ON 13
 ud_4                -1.323597e-01 1 1  ON 14
 ud_5                -1.692171e-01 1 1  ON 15
 ud_6                -1.802808e-01 1 1  ON 16
 ud_7                -1.596522e-01 1 1  ON 17
 ud_8                -1.014694e-01 1 1  ON 18
 ud_9                -8.733372e-03 1 1  ON 19
 eO_0                -9.331359e-01 1 1  ON 20
 eO_1                -6.077291e-01 1 1  ON 21
 eO_2                -1.885672e-01 1 1  ON 22
 eO_3                 8.550934e-02 1 1  ON 23
 eO_4                 2.123493e-01 1 1  ON 24
 eO_5                 2.946142e-01 1 1  ON 25
 eO_6                 3.332486e-01 1 1  ON 26
 eO_7                 5.011090e-01 1 1  ON 27
 eO_8                 1.951215e-01 1 1  ON 28
 eO_9                 6.156032e-02 1 1  ON 29
eH1_0                -2.121892e-01 1 1  ON 30
eH1_1                -1.330637e-01 1 1  ON 31
eH1_2                -9.090027e-02 1 1  ON 32
eH1_3                -5.319764e-02 1 1  ON 33
eH1_4                -6.877326e-03 1 1  ON 34
eH1_5                 4.910663e-03 1 1  ON 35
eH1_6                 4.141797e-02 1 1  ON 36
eH1_7                 6.297471e-02 1 1  ON 37
eH1_8                 1.793183e-01 1 1  ON 38
eH1_9                 1.210868e-01 1 1  ON 39
eH2_0                -2.074290e-01 1 1  ON 40
eH2_1                -1.287603e-01 1 1  ON 41
eH2_2                -8.696314e-02 1 1  ON 42
eH2_3                -4.936544e-02 1 1  ON 43
eH2_4                -3.238575e-03 1 1  ON 44
eH2_5                 8.581012e-03 1 1  ON 45
eH2_6                 4.835121e-02 1 1  ON 46
eH2_7                 4.786375e-02 1 1  ON 47
eH2_8                 1.974896e-01 1 1  ON 48
eH2_9                 1.203659e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1184
    reference variance = 0.210028
====================================================
  Execution time = 1.9576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1931e-01
  Total weights = 2.0000e+06
  Execution time = 1.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934504745
                                         uncertainty =       0.004138970995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934504745
                                         uncertainty =       0.004138970995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399334344
  error estimate for blocks of size 2^( 2) =       0.000408697743
  error estimate for blocks of size 2^( 3) =       0.000416922745
  error estimate for blocks of size 2^( 4) =       0.000422850447
  error estimate for blocks of size 2^( 5) =       0.000427247287
  error estimate for blocks of size 2^( 6) =       0.000428734713
  error estimate for blocks of size 2^( 7) =       0.000429969714

      target function =                  N/A
              le_mean =     -17.217081275265
             les_mean =     296.746823315509
             stat err =       0.000427200540
             autocorr =       1.144432710316
              std dev =       0.564744044573
             le_variance =       0.318935835880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319563170814
                                         uncertainty =       0.004147618652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319563170814
                                         uncertainty =       0.004147618652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399727637
  error estimate for blocks of size 2^( 2) =       0.000409077807
  error estimate for blocks of size 2^( 3) =       0.000417283963
  error estimate for blocks of size 2^( 4) =       0.000423191127
  error estimate for blocks of size 2^( 5) =       0.000427565147
  error estimate for blocks of size 2^( 6) =       0.000429045980
  error estimate for blocks of size 2^( 7) =       0.000430281480

      target function =                  N/A
              le_mean =     -17.217080412031
             les_mean =     296.747422122794
             stat err =       0.000427520934
             autocorr =       1.143895671026
              std dev =       0.565300246082
             le_variance =       0.319564368221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319704074360
                                         uncertainty =       0.004150321987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319704074360
                                         uncertainty =       0.004150321987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399815854
  error estimate for blocks of size 2^( 2) =       0.000409166197
  error estimate for blocks of size 2^( 3) =       0.000417369533
  error estimate for blocks of size 2^( 4) =       0.000423274791
  error estimate for blocks of size 2^( 5) =       0.000427643123
  error estimate for blocks of size 2^( 6) =       0.000429129910
  error estimate for blocks of size 2^( 7) =       0.000430359958

      target function =                  N/A
              le_mean =     -17.217081049070
             les_mean =     296.747585124715
             stat err =       0.000427601945
             autocorr =       1.143824309053
              std dev =       0.565425003262
             le_variance =       0.319705434313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319145198408
                                         uncertainty =       0.004142337530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319145198408
                                         uncertainty =       0.004142337530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399466252
  error estimate for blocks of size 2^( 2) =       0.000408826154
  error estimate for blocks of size 2^( 3) =       0.000417045487
  error estimate for blocks of size 2^( 4) =       0.000422968501
  error estimate for blocks of size 2^( 5) =       0.000427358961
  error estimate for blocks of size 2^( 6) =       0.000428847536
  error estimate for blocks of size 2^( 7) =       0.000430079296

      target function =                  N/A
              le_mean =     -17.217079944607
             les_mean =     296.746988232215
             stat err =       0.000427313574
             autocorr =       1.144282318423
              std dev =       0.564930591130
             le_variance =       0.319146572795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217081275265        initial  <--
     1.5625e-02     1.5625e-01             3.2919e-03       -17.217080412031
     6.2500e-02     6.2500e-01             1.6139e-03       -17.217081049070
     2.5000e-01     2.5000e+00             5.4545e-04       -17.217079944607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9130
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1712
    reference variance = 0.223191
====================================================
  Execution time = 1.9984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317454391392
                                         uncertainty =       0.003255378595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317454391392
                                         uncertainty =       0.003255378595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398505473
  error estimate for blocks of size 2^( 2) =       0.000408156699
  error estimate for blocks of size 2^( 3) =       0.000416398187
  error estimate for blocks of size 2^( 4) =       0.000422645708
  error estimate for blocks of size 2^( 5) =       0.000426458373
  error estimate for blocks of size 2^( 6) =       0.000426942932
  error estimate for blocks of size 2^( 7) =       0.000427751425

      target function =                  N/A
              le_mean =     -17.216326120549
             les_mean =     296.719498154872
             stat err =       0.000425949610
             autocorr =       1.142478057644
              std dev =       0.563571845080
             le_variance =       0.317613224567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632612055e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326120549       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216327159340       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216327973260       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216327516284       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216327195241       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216327194612       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216327294965       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216327339053       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 4.446936e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326120549       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326600104       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326997018       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216326959374       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216326676224       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216326715772       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216326717413       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.242218e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326120549       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326272624       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326405239       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216326423972       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216326302298       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216326327916       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216326321195       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.077894e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5554e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.928856e-01 1 1  ON 0
 uu_1                 2.952982e-02 1 1  ON 1
 uu_2                -6.715906e-02 1 1  ON 2
 uu_3                -1.245491e-01 1 1  ON 3
 uu_4                -1.613484e-01 1 1  ON 4
 uu_5                -1.736190e-01 1 1  ON 5
 uu_6                -1.609223e-01 1 1  ON 6
 uu_7                -1.145124e-01 1 1  ON 7
 uu_8                -3.697033e-02 1 1  ON 8
 uu_9                 1.610552e-01 1 1  ON 9
 ud_0                 3.516390e-01 1 1  ON 10
 ud_1                 9.216013e-02 1 1  ON 11
 ud_2                -1.921528e-02 1 1  ON 12
 ud_3                -8.220827e-02 1 1  ON 13
 ud_4                -1.322374e-01 1 1  ON 14
 ud_5                -1.686332e-01 1 1  ON 15
 ud_6                -1.801260e-01 1 1  ON 16
 ud_7                -1.597626e-01 1 1  ON 17
 ud_8                -1.007201e-01 1 1  ON 18
 ud_9                -8.550208e-03 1 1  ON 19
 eO_0                -9.326152e-01 1 1  ON 20
 eO_1                -6.070868e-01 1 1  ON 21
 eO_2                -1.880235e-01 1 1  ON 22
 eO_3                 8.576778e-02 1 1  ON 23
 eO_4                 2.107179e-01 1 1  ON 24
 eO_5                 2.944177e-01 1 1  ON 25
 eO_6                 3.332721e-01 1 1  ON 26
 eO_7                 5.013385e-01 1 1  ON 27
 eO_8                 1.948573e-01 1 1  ON 28
 eO_9                 6.147789e-02 1 1  ON 29
eH1_0                -2.116683e-01 1 1  ON 30
eH1_1                -1.330004e-01 1 1  ON 31
eH1_2                -9.095696e-02 1 1  ON 32
eH1_3                -5.311032e-02 1 1  ON 33
eH1_4                -7.480090e-03 1 1  ON 34
eH1_5                 4.089224e-03 1 1  ON 35
eH1_6                 4.141650e-02 1 1  ON 36
eH1_7                 6.342148e-02 1 1  ON 37
eH1_8                 1.796785e-01 1 1  ON 38
eH1_9                 1.211140e-01 1 1  ON 39
eH2_0                -2.075409e-01 1 1  ON 40
eH2_1                -1.283980e-01 1 1  ON 41
eH2_2                -8.636094e-02 1 1  ON 42
eH2_3                -4.883023e-02 1 1  ON 43
eH2_4                -2.714497e-03 1 1  ON 44
eH2_5                 8.845619e-03 1 1  ON 45
eH2_6                 4.732827e-02 1 1  ON 46
eH2_7                 4.693537e-02 1 1  ON 47
eH2_8                 1.974171e-01 1 1  ON 48
eH2_9                 1.202962e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.229952
====================================================
  Execution time = 1.9846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1676e-01
  Total weights = 2.0000e+06
  Execution time = 1.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316462854846
                                         uncertainty =       0.004005792005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316462854846
                                         uncertainty =       0.004005792005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397804789
  error estimate for blocks of size 2^( 2) =       0.000407743900
  error estimate for blocks of size 2^( 3) =       0.000416187498
  error estimate for blocks of size 2^( 4) =       0.000422604002
  error estimate for blocks of size 2^( 5) =       0.000426046123
  error estimate for blocks of size 2^( 6) =       0.000427039712
  error estimate for blocks of size 2^( 7) =       0.000430332226

      target function =                  N/A
              le_mean =     -17.216343264867
             les_mean =     296.718972556574
             stat err =       0.000426505516
             autocorr =       1.149500827739
              std dev =       0.562580928482
             le_variance =       0.316497301092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316942943409
                                         uncertainty =       0.004011968412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316942943409
                                         uncertainty =       0.004011968412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398106310
  error estimate for blocks of size 2^( 2) =       0.000408036382
  error estimate for blocks of size 2^( 3) =       0.000416469772
  error estimate for blocks of size 2^( 4) =       0.000422878951
  error estimate for blocks of size 2^( 5) =       0.000426311686
  error estimate for blocks of size 2^( 6) =       0.000427299414
  error estimate for blocks of size 2^( 7) =       0.000430591628

      target function =                  N/A
              le_mean =     -17.216342688360
             les_mean =     296.719432672626
             stat err =       0.000426770420
             autocorr =       1.149186452181
              std dev =       0.563007342805
             le_variance =       0.316977268052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316984846940
                                         uncertainty =       0.004012291479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316984846940
                                         uncertainty =       0.004012291479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398132660
  error estimate for blocks of size 2^( 2) =       0.000408061343
  error estimate for blocks of size 2^( 3) =       0.000416492950
  error estimate for blocks of size 2^( 4) =       0.000422901330
  error estimate for blocks of size 2^( 5) =       0.000426333208
  error estimate for blocks of size 2^( 6) =       0.000427320330
  error estimate for blocks of size 2^( 7) =       0.000430612736

      target function =                  N/A
              le_mean =     -17.216342285340
             les_mean =     296.719460757392
             stat err =       0.000426791901
             autocorr =       1.149150017778
              std dev =       0.563044607401
             le_variance =       0.317019229923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316553754376
                                         uncertainty =       0.004006910608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316553754376
                                         uncertainty =       0.004006910608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397861909
  error estimate for blocks of size 2^( 2) =       0.000407799126
  error estimate for blocks of size 2^( 3) =       0.000416240540
  error estimate for blocks of size 2^( 4) =       0.000422655645
  error estimate for blocks of size 2^( 5) =       0.000426095991
  error estimate for blocks of size 2^( 6) =       0.000427088429
  error estimate for blocks of size 2^( 7) =       0.000430380801

      target function =                  N/A
              le_mean =     -17.216342953827
             les_mean =     296.719052742457
             stat err =       0.000426555216
             autocorr =       1.149438635637
              std dev =       0.562661707393
             le_variance =       0.316588196967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216343264867        initial  <--
     1.5625e-01     1.5625e+00             4.4469e-04       -17.216342688360
     6.2500e-01     6.2500e+00             2.2422e-04       -17.216342285340
     2.5000e+00     2.5000e+01             8.0779e-05       -17.216342953827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1414
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.187009
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2631e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321688579525
                                         uncertainty =       0.004377613110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321688579525
                                         uncertainty =       0.004377613110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403927584
  error estimate for blocks of size 2^( 2) =       0.000413362217
  error estimate for blocks of size 2^( 3) =       0.000421618563
  error estimate for blocks of size 2^( 4) =       0.000427108898
  error estimate for blocks of size 2^( 5) =       0.000430029654
  error estimate for blocks of size 2^( 6) =       0.000431282267
  error estimate for blocks of size 2^( 7) =       0.000434095118

      target function =                  N/A
              le_mean =     -17.216987737258
             les_mean =     296.750981568599
             stat err =       0.000430628984
             autocorr =       1.136578639506
              std dev =       0.571239868061
             le_variance =       0.326314986863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698773726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216987737258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216987907126       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988154130       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988267992       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988403272       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988369467       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988414844       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 7.686818e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216987737258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216987783196       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216987850118       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216987882825       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216987934695       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216987925663       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216987934090       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.145153e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216987737258       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216987748982       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216987766085       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216987774604       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216987789026       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216987786804       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216987788768       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.523900e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5953e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.926820e-01 1 1  ON 0
 uu_1                 2.955724e-02 1 1  ON 1
 uu_2                -6.705465e-02 1 1  ON 2
 uu_3                -1.244698e-01 1 1  ON 3
 uu_4                -1.613496e-01 1 1  ON 4
 uu_5                -1.736355e-01 1 1  ON 5
 uu_6                -1.609544e-01 1 1  ON 6
 uu_7                -1.144677e-01 1 1  ON 7
 uu_8                -3.693181e-02 1 1  ON 8
 uu_9                 1.610760e-01 1 1  ON 9
 ud_0                 3.514177e-01 1 1  ON 10
 ud_1                 9.219850e-02 1 1  ON 11
 ud_2                -1.920285e-02 1 1  ON 12
 ud_3                -8.213414e-02 1 1  ON 13
 ud_4                -1.322108e-01 1 1  ON 14
 ud_5                -1.686011e-01 1 1  ON 15
 ud_6                -1.801019e-01 1 1  ON 16
 ud_7                -1.597636e-01 1 1  ON 17
 ud_8                -1.006831e-01 1 1  ON 18
 ud_9                -8.542867e-03 1 1  ON 19
 eO_0                -9.325951e-01 1 1  ON 20
 eO_1                -6.070179e-01 1 1  ON 21
 eO_2                -1.880825e-01 1 1  ON 22
 eO_3                 8.572417e-02 1 1  ON 23
 eO_4                 2.107517e-01 1 1  ON 24
 eO_5                 2.944103e-01 1 1  ON 25
 eO_6                 3.332541e-01 1 1  ON 26
 eO_7                 5.013699e-01 1 1  ON 27
 eO_8                 1.948434e-01 1 1  ON 28
 eO_9                 6.147171e-02 1 1  ON 29
eH1_0                -2.116472e-01 1 1  ON 30
eH1_1                -1.330138e-01 1 1  ON 31
eH1_2                -9.090204e-02 1 1  ON 32
eH1_3                -5.307048e-02 1 1  ON 33
eH1_4                -7.638814e-03 1 1  ON 34
eH1_5                 4.135287e-03 1 1  ON 35
eH1_6                 4.139289e-02 1 1  ON 36
eH1_7                 6.343853e-02 1 1  ON 37
eH1_8                 1.797014e-01 1 1  ON 38
eH1_9                 1.211170e-01 1 1  ON 39
eH2_0                -2.075269e-01 1 1  ON 40
eH2_1                -1.284535e-01 1 1  ON 41
eH2_2                -8.638975e-02 1 1  ON 42
eH2_3                -4.875107e-02 1 1  ON 43
eH2_4                -2.694961e-03 1 1  ON 44
eH2_5                 8.931770e-03 1 1  ON 45
eH2_6                 4.728806e-02 1 1  ON 46
eH2_7                 4.689898e-02 1 1  ON 47
eH2_8                 1.974043e-01 1 1  ON 48
eH2_9                 1.202824e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.234292
====================================================
  Execution time = 2.2008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327904246432
                                         uncertainty =       0.006527136176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327904246432
                                         uncertainty =       0.006527136176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404878684
  error estimate for blocks of size 2^( 2) =       0.000414088278
  error estimate for blocks of size 2^( 3) =       0.000422489565
  error estimate for blocks of size 2^( 4) =       0.000428598083
  error estimate for blocks of size 2^( 5) =       0.000432905113
  error estimate for blocks of size 2^( 6) =       0.000434424105
  error estimate for blocks of size 2^( 7) =       0.000433245296

      target function =                  N/A
              le_mean =     -17.216451554063
             les_mean =     296.734057446880
             stat err =       0.000432293149
             autocorr =       1.140005328436
              std dev =       0.572584925929
             le_variance =       0.327853497401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327886202151
                                         uncertainty =       0.006526871801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327886202151
                                         uncertainty =       0.006526871801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404867558
  error estimate for blocks of size 2^( 2) =       0.000414077696
  error estimate for blocks of size 2^( 3) =       0.000422479785
  error estimate for blocks of size 2^( 4) =       0.000428588278
  error estimate for blocks of size 2^( 5) =       0.000432894345
  error estimate for blocks of size 2^( 6) =       0.000434413298
  error estimate for blocks of size 2^( 7) =       0.000433236178

      target function =                  N/A
              le_mean =     -17.216450782423
             les_mean =     296.734012859233
             stat err =       0.000432283025
             autocorr =       1.140014580950
              std dev =       0.572569191928
             le_variance =       0.327835479546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327893264333
                                         uncertainty =       0.006526985736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327893264333
                                         uncertainty =       0.006526985736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404871912
  error estimate for blocks of size 2^( 2) =       0.000414081852
  error estimate for blocks of size 2^( 3) =       0.000422483609
  error estimate for blocks of size 2^( 4) =       0.000428592106
  error estimate for blocks of size 2^( 5) =       0.000432898545
  error estimate for blocks of size 2^( 6) =       0.000434417464
  error estimate for blocks of size 2^( 7) =       0.000433239653

      target function =                  N/A
              le_mean =     -17.216451121789
             les_mean =     296.734031594807
             stat err =       0.000432286942
             autocorr =       1.140010724483
              std dev =       0.572575348552
             le_variance =       0.327842529769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327902787533
                                         uncertainty =       0.006527116636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327902787533
                                         uncertainty =       0.006527116636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404877784
  error estimate for blocks of size 2^( 2) =       0.000414087424
  error estimate for blocks of size 2^( 3) =       0.000422488773
  error estimate for blocks of size 2^( 4) =       0.000428597288
  error estimate for blocks of size 2^( 5) =       0.000432904239
  error estimate for blocks of size 2^( 6) =       0.000434423219
  error estimate for blocks of size 2^( 7) =       0.000433244541

      target function =                  N/A
              le_mean =     -17.216451497605
             les_mean =     296.734054045800
             stat err =       0.000432292321
             autocorr =       1.140006028293
              std dev =       0.572583653582
             le_variance =       0.327852040350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216451554063        initial  <--
     1.5625e+00     1.5625e+01             7.6868e-05       -17.216450782423
     6.2500e+00     6.2500e+01             2.1452e-05       -17.216451121789
     2.5000e+01     2.5000e+02             5.5239e-06       -17.216451497605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3462
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1845
    reference variance = 0.156368
====================================================
  Execution time = 2.2141e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360038401
                                         uncertainty =       0.008834951856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332360038401
                                         uncertainty =       0.008834951856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407708508
  error estimate for blocks of size 2^( 2) =       0.000416770922
  error estimate for blocks of size 2^( 3) =       0.000425052910
  error estimate for blocks of size 2^( 4) =       0.000430194095
  error estimate for blocks of size 2^( 5) =       0.000434509283
  error estimate for blocks of size 2^( 6) =       0.000436456441
  error estimate for blocks of size 2^( 7) =       0.000438100292

      target function =                  N/A
              le_mean =     -17.216406087105
             les_mean =     296.737090844731
             stat err =       0.000434815028
             autocorr =       1.137390359100
              std dev =       0.576586901374
             le_variance =       0.332452454836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640608711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216406087105       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216406089316       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216406035930       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216406022607       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216406015170       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216406023023       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216406031835       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.237374e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216406087105       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216406087663       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216406073941       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216406070601       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216406068634       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216406070529       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216406072753       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.166074e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216406087105       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216406087245       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216406083790       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216406082955       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216406082456       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216406082926       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216406083483       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 7.961981e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7738e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.926798e-01 1 1  ON 0
 uu_1                 2.957010e-02 1 1  ON 1
 uu_2                -6.705242e-02 1 1  ON 2
 uu_3                -1.244605e-01 1 1  ON 3
 uu_4                -1.613587e-01 1 1  ON 4
 uu_5                -1.736358e-01 1 1  ON 5
 uu_6                -1.609579e-01 1 1  ON 6
 uu_7                -1.144686e-01 1 1  ON 7
 uu_8                -3.693497e-02 1 1  ON 8
 uu_9                 1.610770e-01 1 1  ON 9
 ud_0                 3.514179e-01 1 1  ON 10
 ud_1                 9.219625e-02 1 1  ON 11
 ud_2                -1.921106e-02 1 1  ON 12
 ud_3                -8.213046e-02 1 1  ON 13
 ud_4                -1.322139e-01 1 1  ON 14
 ud_5                -1.686006e-01 1 1  ON 15
 ud_6                -1.801047e-01 1 1  ON 16
 ud_7                -1.597581e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541793e-03 1 1  ON 19
 eO_0                -9.325858e-01 1 1  ON 20
 eO_1                -6.070063e-01 1 1  ON 21
 eO_2                -1.880977e-01 1 1  ON 22
 eO_3                 8.573981e-02 1 1  ON 23
 eO_4                 2.107370e-01 1 1  ON 24
 eO_5                 2.944036e-01 1 1  ON 25
 eO_6                 3.332549e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948407e-01 1 1  ON 28
 eO_9                 6.147072e-02 1 1  ON 29
eH1_0                -2.116331e-01 1 1  ON 30
eH1_1                -1.330355e-01 1 1  ON 31
eH1_2                -9.090384e-02 1 1  ON 32
eH1_3                -5.306160e-02 1 1  ON 33
eH1_4                -7.644558e-03 1 1  ON 34
eH1_5                 4.135792e-03 1 1  ON 35
eH1_6                 4.139595e-02 1 1  ON 36
eH1_7                 6.344391e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211158e-01 1 1  ON 39
eH2_0                -2.075235e-01 1 1  ON 40
eH2_1                -1.284350e-01 1 1  ON 41
eH2_2                -8.640127e-02 1 1  ON 42
eH2_3                -4.875514e-02 1 1  ON 43
eH2_4                -2.702067e-03 1 1  ON 44
eH2_5                 8.938411e-03 1 1  ON 45
eH2_6                 4.728757e-02 1 1  ON 46
eH2_7                 4.689406e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202817e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2531
    reference variance = 0.408262
====================================================
  Execution time = 1.9543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1805e-01
  Total weights = 2.0000e+06
  Execution time = 1.8487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318088097450
                                         uncertainty =       0.003453369262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318088097450
                                         uncertainty =       0.003453369262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398778713
  error estimate for blocks of size 2^( 2) =       0.000408193109
  error estimate for blocks of size 2^( 3) =       0.000416898679
  error estimate for blocks of size 2^( 4) =       0.000423888067
  error estimate for blocks of size 2^( 5) =       0.000426813955
  error estimate for blocks of size 2^( 6) =       0.000429818843
  error estimate for blocks of size 2^( 7) =       0.000430467494

      target function =                  N/A
              le_mean =     -17.217548089774
             les_mean =     296.762010989076
             stat err =       0.000427747090
             autocorr =       1.150562438515
              std dev =       0.563958264780
             le_variance =       0.318048924413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318099606497
                                         uncertainty =       0.003453521084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318099606497
                                         uncertainty =       0.003453521084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398785929
  error estimate for blocks of size 2^( 2) =       0.000408200005
  error estimate for blocks of size 2^( 3) =       0.000416905305
  error estimate for blocks of size 2^( 4) =       0.000423894590
  error estimate for blocks of size 2^( 5) =       0.000426820423
  error estimate for blocks of size 2^( 6) =       0.000429825123
  error estimate for blocks of size 2^( 7) =       0.000430473698

      target function =                  N/A
              le_mean =     -17.217548001331
             les_mean =     296.762019452886
             stat err =       0.000427753459
             autocorr =       1.150555064027
              std dev =       0.563968468770
             le_variance =       0.318060433767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318094005201
                                         uncertainty =       0.003453447050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318094005201
                                         uncertainty =       0.003453447050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398782417
  error estimate for blocks of size 2^( 2) =       0.000408196648
  error estimate for blocks of size 2^( 3) =       0.000416902079
  error estimate for blocks of size 2^( 4) =       0.000423891414
  error estimate for blocks of size 2^( 5) =       0.000426817274
  error estimate for blocks of size 2^( 6) =       0.000429822066
  error estimate for blocks of size 2^( 7) =       0.000430470679

      target function =                  N/A
              le_mean =     -17.217548044422
             les_mean =     296.762015335271
             stat err =       0.000427750358
             autocorr =       1.150558649205
              std dev =       0.563963502651
             le_variance =       0.318054832322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318088840741
                                         uncertainty =       0.003453379046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318088840741
                                         uncertainty =       0.003453379046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398779179
  error estimate for blocks of size 2^( 2) =       0.000408193554
  error estimate for blocks of size 2^( 3) =       0.000416899107
  error estimate for blocks of size 2^( 4) =       0.000423888488
  error estimate for blocks of size 2^( 5) =       0.000426814373
  error estimate for blocks of size 2^( 6) =       0.000429819249
  error estimate for blocks of size 2^( 7) =       0.000430467895

      target function =                  N/A
              le_mean =     -17.217548084056
             les_mean =     296.762011535472
             stat err =       0.000427747501
             autocorr =       1.150561961551
              std dev =       0.563958923792
             le_variance =       0.318049667724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217548089774        initial  <--
     1.5625e+01     1.5625e+02             1.2374e-05       -17.217548001331
     6.2500e+01     6.2500e+02             3.1661e-06       -17.217548044422
     2.5000e+02     2.5000e+03             7.9620e-07       -17.217548084056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8615
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.210896
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2285e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322914696174
                                         uncertainty =       0.004992116904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322914696174
                                         uncertainty =       0.004992116904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401777876
  error estimate for blocks of size 2^( 2) =       0.000411262571
  error estimate for blocks of size 2^( 3) =       0.000419914095
  error estimate for blocks of size 2^( 4) =       0.000426374114
  error estimate for blocks of size 2^( 5) =       0.000431373377
  error estimate for blocks of size 2^( 6) =       0.000434194521
  error estimate for blocks of size 2^( 7) =       0.000436350702

      target function =                  N/A
              le_mean =     -17.216425743812
             les_mean =     296.728166154462
             stat err =       0.000432073178
             autocorr =       1.156491853465
              std dev =       0.568199721653
             le_variance =       0.322850923686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642574381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425743812       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425745418       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425745465       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425746390       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425751675       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425751976       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425751732       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.112248e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425743812       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425744214       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425744226       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425744457       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425745781       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425745857       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425745796       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.786599e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216425743812       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216425743913       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216425743916       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216425743974       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425744305       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216425744324       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216425744308       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 6.970243e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5737e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.926788e-01 1 1  ON 0
 uu_1                 2.957123e-02 1 1  ON 1
 uu_2                -6.705153e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613598e-01 1 1  ON 4
 uu_5                -1.736353e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693557e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514150e-01 1 1  ON 10
 ud_1                 9.219715e-02 1 1  ON 11
 ud_2                -1.921072e-02 1 1  ON 12
 ud_3                -8.213081e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801048e-01 1 1  ON 16
 ud_7                -1.597580e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541871e-03 1 1  ON 19
 eO_0                -9.325871e-01 1 1  ON 20
 eO_1                -6.070036e-01 1 1  ON 21
 eO_2                -1.880980e-01 1 1  ON 22
 eO_3                 8.574015e-02 1 1  ON 23
 eO_4                 2.107355e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948404e-01 1 1  ON 28
 eO_9                 6.147064e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330352e-01 1 1  ON 31
eH1_2                -9.090387e-02 1 1  ON 32
eH1_3                -5.306222e-02 1 1  ON 33
eH1_4                -7.644653e-03 1 1  ON 34
eH1_5                 4.135235e-03 1 1  ON 35
eH1_6                 4.139671e-02 1 1  ON 36
eH1_7                 6.344451e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075215e-01 1 1  ON 40
eH2_1                -1.284358e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875586e-02 1 1  ON 43
eH2_4                -2.702250e-03 1 1  ON 44
eH2_5                 8.938773e-03 1 1  ON 45
eH2_6                 4.728775e-02 1 1  ON 46
eH2_7                 4.689374e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1582
    reference variance = 0.173104
====================================================
  Execution time = 1.9717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1544e-01
  Total weights = 2.0000e+06
  Execution time = 1.8509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403037309
                                         uncertainty =       0.003030598100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403037309
                                         uncertainty =       0.003030598100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397138899
  error estimate for blocks of size 2^( 2) =       0.000406489325
  error estimate for blocks of size 2^( 3) =       0.000415530274
  error estimate for blocks of size 2^( 4) =       0.000421525812
  error estimate for blocks of size 2^( 5) =       0.000425582572
  error estimate for blocks of size 2^( 6) =       0.000427039745
  error estimate for blocks of size 2^( 7) =       0.000428500883

      target function =                  N/A
              le_mean =     -17.216896666154
             les_mean =     296.736969265715
             stat err =       0.000425662253
             autocorr =       1.148802635954
              std dev =       0.561639217314
             le_variance =       0.315438610425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315404639016
                                         uncertainty =       0.003030610787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315404639016
                                         uncertainty =       0.003030610787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397139907
  error estimate for blocks of size 2^( 2) =       0.000406490281
  error estimate for blocks of size 2^( 3) =       0.000415531180
  error estimate for blocks of size 2^( 4) =       0.000421526692
  error estimate for blocks of size 2^( 5) =       0.000425583460
  error estimate for blocks of size 2^( 6) =       0.000427040630
  error estimate for blocks of size 2^( 7) =       0.000428501762

      target function =                  N/A
              le_mean =     -17.216896664315
             les_mean =     296.736970803859
             stat err =       0.000425663136
             autocorr =       1.148801568981
              std dev =       0.561640642998
             le_variance =       0.315440211867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403839702
                                         uncertainty =       0.003030604456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403839702
                                         uncertainty =       0.003030604456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397139404
  error estimate for blocks of size 2^( 2) =       0.000406489804
  error estimate for blocks of size 2^( 3) =       0.000415530728
  error estimate for blocks of size 2^( 4) =       0.000421526253
  error estimate for blocks of size 2^( 5) =       0.000425583017
  error estimate for blocks of size 2^( 6) =       0.000427040188
  error estimate for blocks of size 2^( 7) =       0.000428501323

      target function =                  N/A
              le_mean =     -17.216896665231
             les_mean =     296.736970036221
             stat err =       0.000425662695
             autocorr =       1.148802101461
              std dev =       0.561639931527
             le_variance =       0.315439412685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403137656
                                         uncertainty =       0.003030598895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315403137656
                                         uncertainty =       0.003030598895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397138962
  error estimate for blocks of size 2^( 2) =       0.000406489385
  error estimate for blocks of size 2^( 3) =       0.000415530331
  error estimate for blocks of size 2^( 4) =       0.000421525867
  error estimate for blocks of size 2^( 5) =       0.000425582627
  error estimate for blocks of size 2^( 6) =       0.000427039800
  error estimate for blocks of size 2^( 7) =       0.000428500938

      target function =                  N/A
              le_mean =     -17.216896666038
             les_mean =     296.736969362069
             stat err =       0.000425662308
             autocorr =       1.148802569106
              std dev =       0.561639306633
             le_variance =       0.315438710755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216896666154        initial  <--
     1.5625e+02     1.5625e+03             1.1122e-06       -17.216896664315
     6.2500e+02     6.2500e+03             2.7866e-07       -17.216896665231
     2.5000e+03     2.5000e+04             6.9702e-08       -17.216896666038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0336
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.3108
    reference variance = 0.729996
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316421661541
                                         uncertainty =       0.002912633979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316421661541
                                         uncertainty =       0.002912633979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397764626
  error estimate for blocks of size 2^( 2) =       0.000407085803
  error estimate for blocks of size 2^( 3) =       0.000415435556
  error estimate for blocks of size 2^( 4) =       0.000421641630
  error estimate for blocks of size 2^( 5) =       0.000426024431
  error estimate for blocks of size 2^( 6) =       0.000428610472
  error estimate for blocks of size 2^( 7) =       0.000432177046

      target function =                  N/A
              le_mean =     -17.216931366273
             les_mean =     296.739158908137
             stat err =       0.000427113395
             autocorr =       1.153012637602
              std dev =       0.562524128731
             le_variance =       0.316433395405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693136627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216931366273       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216931366634       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216931366356       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216931365965       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216931366099       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216931366081       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216931366086       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.070420e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216931366273       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216931366363       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216931366294       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216931366197       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216931366229       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216931366224       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216931366224       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.676387e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216931366273       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216931366295       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216931366278       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216931366257       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216931366258       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216931366256       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216931366257       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 6.691179e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5609e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957113e-02 1 1  ON 1
 uu_2                -6.705152e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514148e-01 1 1  ON 10
 ud_1                 9.219722e-02 1 1  ON 11
 ud_2                -1.921049e-02 1 1  ON 12
 ud_3                -8.213071e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597581e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330352e-01 1 1  ON 31
eH1_2                -9.090390e-02 1 1  ON 32
eH1_3                -5.306219e-02 1 1  ON 33
eH1_4                -7.644712e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139669e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640158e-02 1 1  ON 42
eH2_3                -4.875580e-02 1 1  ON 43
eH2_4                -2.702403e-03 1 1  ON 44
eH2_5                 8.938877e-03 1 1  ON 45
eH2_6                 4.728777e-02 1 1  ON 46
eH2_7                 4.689369e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.279271
====================================================
  Execution time = 1.9755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549619493
                                         uncertainty =       0.004894960751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549619493
                                         uncertainty =       0.004894960751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399645725
  error estimate for blocks of size 2^( 2) =       0.000409380214
  error estimate for blocks of size 2^( 3) =       0.000417958562
  error estimate for blocks of size 2^( 4) =       0.000423778882
  error estimate for blocks of size 2^( 5) =       0.000427080041
  error estimate for blocks of size 2^( 6) =       0.000429511478
  error estimate for blocks of size 2^( 7) =       0.000429552873

      target function =                  N/A
              le_mean =     -17.216468580846
             les_mean =     296.726223646033
             stat err =       0.000427480819
             autocorr =       1.144149887226
              std dev =       0.565184403957
             le_variance =       0.319433410477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549682258
                                         uncertainty =       0.004894960795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549682258
                                         uncertainty =       0.004894960795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399645764
  error estimate for blocks of size 2^( 2) =       0.000409380255
  error estimate for blocks of size 2^( 3) =       0.000417958604
  error estimate for blocks of size 2^( 4) =       0.000423778926
  error estimate for blocks of size 2^( 5) =       0.000427080084
  error estimate for blocks of size 2^( 6) =       0.000429511521
  error estimate for blocks of size 2^( 7) =       0.000429552913

      target function =                  N/A
              le_mean =     -17.216468580199
             les_mean =     296.726223686511
             stat err =       0.000427480861
             autocorr =       1.144149889878
              std dev =       0.565184459490
             le_variance =       0.319433473249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549650885
                                         uncertainty =       0.004894960773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549650885
                                         uncertainty =       0.004894960773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399645744
  error estimate for blocks of size 2^( 2) =       0.000409380234
  error estimate for blocks of size 2^( 3) =       0.000417958583
  error estimate for blocks of size 2^( 4) =       0.000423778904
  error estimate for blocks of size 2^( 5) =       0.000427080063
  error estimate for blocks of size 2^( 6) =       0.000429511499
  error estimate for blocks of size 2^( 7) =       0.000429552893

      target function =                  N/A
              le_mean =     -17.216468580523
             les_mean =     296.726223666281
             stat err =       0.000427480840
             autocorr =       1.144149888559
              std dev =       0.565184431733
             le_variance =       0.319433441873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549623417
                                         uncertainty =       0.004894960753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319549623417
                                         uncertainty =       0.004894960753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399645727
  error estimate for blocks of size 2^( 2) =       0.000409380217
  error estimate for blocks of size 2^( 3) =       0.000417958564
  error estimate for blocks of size 2^( 4) =       0.000423778885
  error estimate for blocks of size 2^( 5) =       0.000427080044
  error estimate for blocks of size 2^( 6) =       0.000429511480
  error estimate for blocks of size 2^( 7) =       0.000429552876

      target function =                  N/A
              le_mean =     -17.216468580806
             les_mean =     296.726223648565
             stat err =       0.000427480821
             autocorr =       1.144149887398
              std dev =       0.565184407429
             le_variance =       0.319433414401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216468580846        initial  <--
     1.5625e+03     1.5625e+04             1.0704e-07       -17.216468580199
     6.2500e+03     6.2500e+04             2.6764e-08       -17.216468580523
     2.5000e+04     2.5000e+05             6.6912e-09       -17.216468580806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9097
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.171535
====================================================
  Execution time = 2.0103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321028792165
                                         uncertainty =       0.004694619656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321028792165
                                         uncertainty =       0.004694619656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400605226
  error estimate for blocks of size 2^( 2) =       0.000410113580
  error estimate for blocks of size 2^( 3) =       0.000419173887
  error estimate for blocks of size 2^( 4) =       0.000425570883
  error estimate for blocks of size 2^( 5) =       0.000429269688
  error estimate for blocks of size 2^( 6) =       0.000432822692
  error estimate for blocks of size 2^( 7) =       0.000433692738

      target function =                  N/A
              le_mean =     -17.217177238682
             les_mean =     296.752161002616
             stat err =       0.000430339000
             autocorr =       1.153953189150
              std dev =       0.566541344403
             le_variance =       0.320969094918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717723868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217177238682       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217177238693       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217177238726       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217177238738       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217177238752       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217177238758       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217177238716       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 9.417522e-09

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217177238682       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217177238685       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217177238693       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217177238698       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217177238699       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217177238712       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217177238706       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 2.354399e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217177238682       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217177238683       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217177238685       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217177238685       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217177238877       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217177238826       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217177238593       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 5.886014e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5631e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644716e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702399e-03 1 1  ON 44
eH2_5                 8.938885e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.3209
    reference variance = 0.328522
====================================================
  Execution time = 1.9668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1288e-01
  Total weights = 2.0000e+06
  Execution time = 1.8146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911272281
                                         uncertainty =       0.002744882240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911272281
                                         uncertainty =       0.002744882240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395526759
  error estimate for blocks of size 2^( 2) =       0.000405480528
  error estimate for blocks of size 2^( 3) =       0.000414145751
  error estimate for blocks of size 2^( 4) =       0.000420984789
  error estimate for blocks of size 2^( 5) =       0.000424504323
  error estimate for blocks of size 2^( 6) =       0.000426964552
  error estimate for blocks of size 2^( 7) =       0.000428942138

      target function =                  N/A
              le_mean =     -17.216804377711
             les_mean =     296.731235658749
             stat err =       0.000425348950
             autocorr =       1.156482295520
              std dev =       0.559359307437
             le_variance =       0.312882834816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911277950
                                         uncertainty =       0.002744882294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911277950
                                         uncertainty =       0.002744882294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395526763
  error estimate for blocks of size 2^( 2) =       0.000405480531
  error estimate for blocks of size 2^( 3) =       0.000414145755
  error estimate for blocks of size 2^( 4) =       0.000420984792
  error estimate for blocks of size 2^( 5) =       0.000424504326
  error estimate for blocks of size 2^( 6) =       0.000426964555
  error estimate for blocks of size 2^( 7) =       0.000428942141

      target function =                  N/A
              le_mean =     -17.216804377707
             les_mean =     296.731235664264
             stat err =       0.000425348953
             autocorr =       1.156482290733
              std dev =       0.559359312498
             le_variance =       0.312882840478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911275116
                                         uncertainty =       0.002744882267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911275116
                                         uncertainty =       0.002744882267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395526761
  error estimate for blocks of size 2^( 2) =       0.000405480530
  error estimate for blocks of size 2^( 3) =       0.000414145753
  error estimate for blocks of size 2^( 4) =       0.000420984790
  error estimate for blocks of size 2^( 5) =       0.000424504324
  error estimate for blocks of size 2^( 6) =       0.000426964554
  error estimate for blocks of size 2^( 7) =       0.000428942139

      target function =                  N/A
              le_mean =     -17.216804377709
             les_mean =     296.731235661506
             stat err =       0.000425348952
             autocorr =       1.156482293120
              std dev =       0.559359309968
             le_variance =       0.312882837647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911272636
                                         uncertainty =       0.002744882243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312911272636
                                         uncertainty =       0.002744882243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395526760
  error estimate for blocks of size 2^( 2) =       0.000405480528
  error estimate for blocks of size 2^( 3) =       0.000414145752
  error estimate for blocks of size 2^( 4) =       0.000420984789
  error estimate for blocks of size 2^( 5) =       0.000424504323
  error estimate for blocks of size 2^( 6) =       0.000426964552
  error estimate for blocks of size 2^( 7) =       0.000428942138

      target function =                  N/A
              le_mean =     -17.216804377711
             les_mean =     296.731235659093
             stat err =       0.000425348950
             autocorr =       1.156482295215
              std dev =       0.559359307753
             le_variance =       0.312882835170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216804377711        initial  <--
     1.5625e+04     1.5625e+05             9.4175e-09       -17.216804377707
     6.2500e+04     6.2500e+05             2.3544e-09       -17.216804377709
     2.5000e+05     2.5000e+06             5.8860e-10       -17.216804377711

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8404
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.200787
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1448e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314484624153
                                         uncertainty =       0.003457296642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314484624153
                                         uncertainty =       0.003457296642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396532199
  error estimate for blocks of size 2^( 2) =       0.000406056653
  error estimate for blocks of size 2^( 3) =       0.000414830170
  error estimate for blocks of size 2^( 4) =       0.000420493819
  error estimate for blocks of size 2^( 5) =       0.000425096469
  error estimate for blocks of size 2^( 6) =       0.000428440076
  error estimate for blocks of size 2^( 7) =       0.000430214073

      target function =                  N/A
              le_mean =     -17.216929749333
             les_mean =     296.737145406065
             stat err =       0.000426061109
             autocorr =       1.154481214659
              std dev =       0.560781213886
             le_variance =       0.314475569848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692974933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929749333       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929749333       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929749334       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929749336       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929749337       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929749366       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929749375       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.480486e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929749333       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929749333       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929749333       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929749439       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929749555       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929749376       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929749277       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.701220e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929749333       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929749333       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929749333       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929749333       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929749955       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929749805       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929749067       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 9.253039e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5517e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1484
    reference variance = 0.25019
====================================================
  Execution time = 1.9536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2020e-01
  Total weights = 2.0000e+06
  Execution time = 1.7961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295532
                                         uncertainty =       0.004240808089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295532
                                         uncertainty =       0.004240808089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400122508
  error estimate for blocks of size 2^( 2) =       0.000409506801
  error estimate for blocks of size 2^( 3) =       0.000417978127
  error estimate for blocks of size 2^( 4) =       0.000424194686
  error estimate for blocks of size 2^( 5) =       0.000426664352
  error estimate for blocks of size 2^( 6) =       0.000428644001
  error estimate for blocks of size 2^( 7) =       0.000430572976

      target function =                  N/A
              le_mean =     -17.216195595946
             les_mean =     296.717586681242
             stat err =       0.000427519004
             autocorr =       1.141628712193
              std dev =       0.565858678012
             le_variance =       0.320196043482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081296316
                                         uncertainty =       0.004240808095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081296316
                                         uncertainty =       0.004240808095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400122509
  error estimate for blocks of size 2^( 2) =       0.000409506802
  error estimate for blocks of size 2^( 3) =       0.000417978128
  error estimate for blocks of size 2^( 4) =       0.000424194686
  error estimate for blocks of size 2^( 5) =       0.000426664352
  error estimate for blocks of size 2^( 6) =       0.000428644001
  error estimate for blocks of size 2^( 7) =       0.000430572976

      target function =                  N/A
              le_mean =     -17.216195595941
             les_mean =     296.717586681859
             stat err =       0.000427519004
             autocorr =       1.141628711730
              std dev =       0.565858678710
             le_variance =       0.320196044272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295924
                                         uncertainty =       0.004240808092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295924
                                         uncertainty =       0.004240808092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400122509
  error estimate for blocks of size 2^( 2) =       0.000409506802
  error estimate for blocks of size 2^( 3) =       0.000417978128
  error estimate for blocks of size 2^( 4) =       0.000424194686
  error estimate for blocks of size 2^( 5) =       0.000426664352
  error estimate for blocks of size 2^( 6) =       0.000428644001
  error estimate for blocks of size 2^( 7) =       0.000430572976

      target function =                  N/A
              le_mean =     -17.216195595943
             les_mean =     296.717586681550
             stat err =       0.000427519004
             autocorr =       1.141628711966
              std dev =       0.565858678361
             le_variance =       0.320196043877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295581
                                         uncertainty =       0.004240808089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319081295581
                                         uncertainty =       0.004240808089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400122508
  error estimate for blocks of size 2^( 2) =       0.000409506801
  error estimate for blocks of size 2^( 3) =       0.000417978127
  error estimate for blocks of size 2^( 4) =       0.000424194686
  error estimate for blocks of size 2^( 5) =       0.000426664352
  error estimate for blocks of size 2^( 6) =       0.000428644001
  error estimate for blocks of size 2^( 7) =       0.000430572976

      target function =                  N/A
              le_mean =     -17.216195595945
             les_mean =     296.717586681281
             stat err =       0.000427519004
             autocorr =       1.141628712160
              std dev =       0.565858678056
             le_variance =       0.320196043531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216195595946        initial  <--
     1.5625e+05     1.5625e+06             1.4805e-09       -17.216195595941
     6.2500e+05     6.2500e+06             3.7012e-10       -17.216195595943
     2.5000e+06     2.5000e+07             9.2530e-11       -17.216195595945

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6053
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2738
    reference variance = 0.263485
====================================================
  Execution time = 2.2258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327592340547
                                         uncertainty =       0.006035663602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327592340547
                                         uncertainty =       0.006035663602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404645665
  error estimate for blocks of size 2^( 2) =       0.000413849055
  error estimate for blocks of size 2^( 3) =       0.000422421722
  error estimate for blocks of size 2^( 4) =       0.000428355604
  error estimate for blocks of size 2^( 5) =       0.000432993063
  error estimate for blocks of size 2^( 6) =       0.000433840164
  error estimate for blocks of size 2^( 7) =       0.000435132247

      target function =                  N/A
              le_mean =     -17.217193675781
             les_mean =     296.759234134533
             stat err =       0.000432580270
             autocorr =       1.142835254527
              std dev =       0.572255387849
             le_variance =       0.327476228922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721719367578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217193675781       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217193675781       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217193675781       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217193675782       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217193675217       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217193676989       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.257062e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217193675781       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217193675781       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217193675781       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217193675781       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217193675778       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217193625140       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 3.142710e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217193675781       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217193675781       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217193675781       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217193675781       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217193684023       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217193674073       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+07 is 7.856743e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7889e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2105
    reference variance = 0.326962
====================================================
  Execution time = 2.1678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3218e-01
  Total weights = 2.0000e+06
  Execution time = 1.8037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013456
                                         uncertainty =       0.013460471818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013456
                                         uncertainty =       0.013460471818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407540643
  error estimate for blocks of size 2^( 2) =       0.000416442390
  error estimate for blocks of size 2^( 3) =       0.000424562779
  error estimate for blocks of size 2^( 4) =       0.000430137372
  error estimate for blocks of size 2^( 5) =       0.000433132831
  error estimate for blocks of size 2^( 6) =       0.000434956433
  error estimate for blocks of size 2^( 7) =       0.000435479714

      target function =                  N/A
              le_mean =     -17.216774935067
             les_mean =     296.749517750331
             stat err =       0.000433426588
             autocorr =       1.131069377348
              std dev =       0.576349504799
             le_variance =       0.332178751682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013549
                                         uncertainty =       0.013460471822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013549
                                         uncertainty =       0.013460471822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407540643
  error estimate for blocks of size 2^( 2) =       0.000416442390
  error estimate for blocks of size 2^( 3) =       0.000424562779
  error estimate for blocks of size 2^( 4) =       0.000430137372
  error estimate for blocks of size 2^( 5) =       0.000433132831
  error estimate for blocks of size 2^( 6) =       0.000434956433
  error estimate for blocks of size 2^( 7) =       0.000435479715

      target function =                  N/A
              le_mean =     -17.216774935066
             les_mean =     296.749517750418
             stat err =       0.000433426588
             autocorr =       1.131069377312
              std dev =       0.576349504880
             le_variance =       0.332178751775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013502
                                         uncertainty =       0.013460471820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013502
                                         uncertainty =       0.013460471820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407540643
  error estimate for blocks of size 2^( 2) =       0.000416442390
  error estimate for blocks of size 2^( 3) =       0.000424562779
  error estimate for blocks of size 2^( 4) =       0.000430137372
  error estimate for blocks of size 2^( 5) =       0.000433132831
  error estimate for blocks of size 2^( 6) =       0.000434956433
  error estimate for blocks of size 2^( 7) =       0.000435479715

      target function =                  N/A
              le_mean =     -17.216774935067
             les_mean =     296.749517750374
             stat err =       0.000433426588
             autocorr =       1.131069377335
              std dev =       0.576349504839
             le_variance =       0.332178751729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013461
                                         uncertainty =       0.013460471818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332280013461
                                         uncertainty =       0.013460471818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407540643
  error estimate for blocks of size 2^( 2) =       0.000416442390
  error estimate for blocks of size 2^( 3) =       0.000424562779
  error estimate for blocks of size 2^( 4) =       0.000430137372
  error estimate for blocks of size 2^( 5) =       0.000433132831
  error estimate for blocks of size 2^( 6) =       0.000434956433
  error estimate for blocks of size 2^( 7) =       0.000435479714

      target function =                  N/A
              le_mean =     -17.216774935067
             les_mean =     296.749517750336
             stat err =       0.000433426588
             autocorr =       1.131069377345
              std dev =       0.576349504804
             le_variance =       0.332178751688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216774935067        initial  <--
     1.5625e+06     1.5625e+07             1.2571e-10       -17.216774935066
     6.2500e+06     6.2500e+07             3.1427e-11       -17.216774935067
     2.5000e+07     2.5000e+08             7.8567e-12       -17.216774935067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7741
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2786
    reference variance = 0.234777
====================================================
  Execution time = 2.0098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323910491231
                                         uncertainty =       0.005331206218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323910491231
                                         uncertainty =       0.005331206218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402733012
  error estimate for blocks of size 2^( 2) =       0.000412283407
  error estimate for blocks of size 2^( 3) =       0.000420533204
  error estimate for blocks of size 2^( 4) =       0.000426524701
  error estimate for blocks of size 2^( 5) =       0.000430297887
  error estimate for blocks of size 2^( 6) =       0.000432588940
  error estimate for blocks of size 2^( 7) =       0.000434514487

      target function =                  N/A
              le_mean =     -17.216569575098
             les_mean =     296.734655529931
             stat err =       0.000430981504
             autocorr =       1.145203862909
              std dev =       0.569550487606
             le_variance =       0.324387757932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656957510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216569575098       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569575098       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569575098       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216569566821       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216569577094       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216569571728       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 1.034378e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216569575098       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569575098       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569575098       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216569583049       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216569575098       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216569575098       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 2.585972e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216569575098       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569575098       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569575098       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216569559213       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216569612611       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216569574577       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 6.465263e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5610e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.190212
====================================================
  Execution time = 1.9574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1942e-01
  Total weights = 2.0000e+06
  Execution time = 1.8042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485181
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485181
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640535
  error estimate for blocks of size 2^( 2) =       0.000409088871
  error estimate for blocks of size 2^( 3) =       0.000417507453
  error estimate for blocks of size 2^( 4) =       0.000423757350
  error estimate for blocks of size 2^( 5) =       0.000428695979
  error estimate for blocks of size 2^( 6) =       0.000431818668
  error estimate for blocks of size 2^( 7) =       0.000432913153

      target function =                  N/A
              le_mean =     -17.217183101892
             les_mean =     296.750818918459
             stat err =       0.000429296288
             autocorr =       1.153918676650
              std dev =       0.565177064388
             le_variance =       0.319425114110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485188
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485188
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640535
  error estimate for blocks of size 2^( 2) =       0.000409088871
  error estimate for blocks of size 2^( 3) =       0.000417507453
  error estimate for blocks of size 2^( 4) =       0.000423757350
  error estimate for blocks of size 2^( 5) =       0.000428695979
  error estimate for blocks of size 2^( 6) =       0.000431818668
  error estimate for blocks of size 2^( 7) =       0.000432913153

      target function =                  N/A
              le_mean =     -17.217183101892
             les_mean =     296.750818918465
             stat err =       0.000429296288
             autocorr =       1.153918676652
              std dev =       0.565177064394
             le_variance =       0.319425114117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485185
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485185
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640535
  error estimate for blocks of size 2^( 2) =       0.000409088871
  error estimate for blocks of size 2^( 3) =       0.000417507453
  error estimate for blocks of size 2^( 4) =       0.000423757350
  error estimate for blocks of size 2^( 5) =       0.000428695979
  error estimate for blocks of size 2^( 6) =       0.000431818668
  error estimate for blocks of size 2^( 7) =       0.000432913153

      target function =                  N/A
              le_mean =     -17.217183101892
             les_mean =     296.750818918462
             stat err =       0.000429296288
             autocorr =       1.153918676644
              std dev =       0.565177064391
             le_variance =       0.319425114113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485182
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319494485182
                                         uncertainty =       0.005339384898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399640535
  error estimate for blocks of size 2^( 2) =       0.000409088871
  error estimate for blocks of size 2^( 3) =       0.000417507453
  error estimate for blocks of size 2^( 4) =       0.000423757350
  error estimate for blocks of size 2^( 5) =       0.000428695979
  error estimate for blocks of size 2^( 6) =       0.000431818668
  error estimate for blocks of size 2^( 7) =       0.000432913153

      target function =                  N/A
              le_mean =     -17.217183101892
             les_mean =     296.750818918460
             stat err =       0.000429296288
             autocorr =       1.153918676656
              std dev =       0.565177064388
             le_variance =       0.319425114110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217183101892        initial  <--
     1.5625e+07     1.5625e+08             1.0344e-11       -17.217183101892
     6.2500e+07     6.2500e+08             2.5860e-12       -17.217183101892
     2.5000e+08     2.5000e+09             6.4653e-13       -17.217183101892

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7691
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2846
    reference variance = 0.31214
====================================================
  Execution time = 2.0014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317912448401
                                         uncertainty =       0.003619936950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317912448401
                                         uncertainty =       0.003619936950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398633124
  error estimate for blocks of size 2^( 2) =       0.000407900755
  error estimate for blocks of size 2^( 3) =       0.000416286048
  error estimate for blocks of size 2^( 4) =       0.000421921244
  error estimate for blocks of size 2^( 5) =       0.000425109059
  error estimate for blocks of size 2^( 6) =       0.000426321748
  error estimate for blocks of size 2^( 7) =       0.000428145958

      target function =                  N/A
              le_mean =     -17.217590642075
             les_mean =     296.763244094893
             stat err =       0.000425374502
             autocorr =       1.138665442562
              std dev =       0.563752370930
             le_variance =       0.317816735729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721759064208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217590642075       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217590642075       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217590642075       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217590659078       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217590569246       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217590576980       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217590642276       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 1.099294e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217590642075       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217590642075       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217590642075       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217590625066       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217590235510       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217590642075       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217590610083       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 2.747400e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217590642075       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217590642075       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217590642075       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217591455433       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217592012097       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217591442327       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217590925806       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+09 is 6.892198e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5569e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.171209
====================================================
  Execution time = 1.9608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1464e-01
  Total weights = 2.0000e+06
  Execution time = 1.8021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396632837
  error estimate for blocks of size 2^( 2) =       0.000406391017
  error estimate for blocks of size 2^( 3) =       0.000414594177
  error estimate for blocks of size 2^( 4) =       0.000421221889
  error estimate for blocks of size 2^( 5) =       0.000424215124
  error estimate for blocks of size 2^( 6) =       0.000424134490
  error estimate for blocks of size 2^( 7) =       0.000425490994

      target function =                  N/A
              le_mean =     -17.217448099763
             les_mean =     296.755154125566
             stat err =       0.000423765625
             autocorr =       1.141495268557
              std dev =       0.560923537445
             le_variance =       0.314635214860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396632837
  error estimate for blocks of size 2^( 2) =       0.000406391017
  error estimate for blocks of size 2^( 3) =       0.000414594177
  error estimate for blocks of size 2^( 4) =       0.000421221889
  error estimate for blocks of size 2^( 5) =       0.000424215124
  error estimate for blocks of size 2^( 6) =       0.000424134490
  error estimate for blocks of size 2^( 7) =       0.000425490994

      target function =                  N/A
              le_mean =     -17.217448099763
             les_mean =     296.755154125567
             stat err =       0.000423765625
             autocorr =       1.141495268561
              std dev =       0.560923537446
             le_variance =       0.314635214860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396632837
  error estimate for blocks of size 2^( 2) =       0.000406391017
  error estimate for blocks of size 2^( 3) =       0.000414594177
  error estimate for blocks of size 2^( 4) =       0.000421221889
  error estimate for blocks of size 2^( 5) =       0.000424215124
  error estimate for blocks of size 2^( 6) =       0.000424134490
  error estimate for blocks of size 2^( 7) =       0.000425490994

      target function =                  N/A
              le_mean =     -17.217448099763
             les_mean =     296.755154125567
             stat err =       0.000423765625
             autocorr =       1.141495268550
              std dev =       0.560923537445
             le_variance =       0.314635214860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314591861098
                                         uncertainty =       0.002653195957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396632837
  error estimate for blocks of size 2^( 2) =       0.000406391017
  error estimate for blocks of size 2^( 3) =       0.000414594177
  error estimate for blocks of size 2^( 4) =       0.000421221889
  error estimate for blocks of size 2^( 5) =       0.000424215124
  error estimate for blocks of size 2^( 6) =       0.000424134490
  error estimate for blocks of size 2^( 7) =       0.000425490994

      target function =                  N/A
              le_mean =     -17.217448099763
             les_mean =     296.755154125566
             stat err =       0.000423765625
             autocorr =       1.141495268561
              std dev =       0.560923537445
             le_variance =       0.314635214860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217448099763        initial
     1.5625e+08     1.5625e+09             1.0993e-12       -17.217448099763  <--
     6.2500e+08     6.2500e+09             2.7474e-13       -17.217448099763
     2.5000e+09     2.5000e+10             6.8922e-14       -17.217448099763

*****************************************************************************
Applying the update for shift_i =   1.5625e+08     and shift_s =   1.5625e+09
*****************************************************************************

  Execution time = 2.8706e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.369992
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319829473416
                                         uncertainty =       0.003447347617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319829473416
                                         uncertainty =       0.003447347617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399884380
  error estimate for blocks of size 2^( 2) =       0.000409115244
  error estimate for blocks of size 2^( 3) =       0.000417334824
  error estimate for blocks of size 2^( 4) =       0.000423411080
  error estimate for blocks of size 2^( 5) =       0.000427475723
  error estimate for blocks of size 2^( 6) =       0.000429962253
  error estimate for blocks of size 2^( 7) =       0.000429014273

      target function =                  N/A
              le_mean =     -17.217207870125
             les_mean =     296.752061717561
             stat err =       0.000427465832
             autocorr =       1.142704488735
              std dev =       0.565521913258
             le_variance =       0.319815034375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721720787012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217207870125       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217207870125       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217207870125       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217207886833       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217207900274       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217207844729       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 2.752166e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217207870125       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217207870125       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217207870125       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217207870125       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217207870125       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217207827078       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 6.882146e-13

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217207870125       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217207870125       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217207870125       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217207812006       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217207870125       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217207740669       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 1.721108e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5880e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.3004
    reference variance = 0.232596
====================================================
  Execution time = 1.9698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1327e-01
  Total weights = 2.0000e+06
  Execution time = 1.7996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395769090
  error estimate for blocks of size 2^( 2) =       0.000405607213
  error estimate for blocks of size 2^( 3) =       0.000414082169
  error estimate for blocks of size 2^( 4) =       0.000420182875
  error estimate for blocks of size 2^( 5) =       0.000423058831
  error estimate for blocks of size 2^( 6) =       0.000425763940
  error estimate for blocks of size 2^( 7) =       0.000426425248

      target function =                  N/A
              le_mean =     -17.216452844755
             les_mean =     296.719514744383
             stat err =       0.000423857723
             autocorr =       1.146981617105
              std dev =       0.559702014790
             le_variance =       0.313266345360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395769090
  error estimate for blocks of size 2^( 2) =       0.000405607213
  error estimate for blocks of size 2^( 3) =       0.000414082169
  error estimate for blocks of size 2^( 4) =       0.000420182875
  error estimate for blocks of size 2^( 5) =       0.000423058831
  error estimate for blocks of size 2^( 6) =       0.000425763940
  error estimate for blocks of size 2^( 7) =       0.000426425248

      target function =                  N/A
              le_mean =     -17.216452844755
             les_mean =     296.719514744385
             stat err =       0.000423857723
             autocorr =       1.146981617095
              std dev =       0.559702014790
             le_variance =       0.313266345360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395769090
  error estimate for blocks of size 2^( 2) =       0.000405607213
  error estimate for blocks of size 2^( 3) =       0.000414082169
  error estimate for blocks of size 2^( 4) =       0.000420182875
  error estimate for blocks of size 2^( 5) =       0.000423058831
  error estimate for blocks of size 2^( 6) =       0.000425763940
  error estimate for blocks of size 2^( 7) =       0.000426425248

      target function =                  N/A
              le_mean =     -17.216452844755
             les_mean =     296.719514744384
             stat err =       0.000423857723
             autocorr =       1.146981617118
              std dev =       0.559702014790
             le_variance =       0.313266345360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313231102815
                                         uncertainty =       0.003052409670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395769090
  error estimate for blocks of size 2^( 2) =       0.000405607213
  error estimate for blocks of size 2^( 3) =       0.000414082169
  error estimate for blocks of size 2^( 4) =       0.000420182875
  error estimate for blocks of size 2^( 5) =       0.000423058831
  error estimate for blocks of size 2^( 6) =       0.000425763940
  error estimate for blocks of size 2^( 7) =       0.000426425248

      target function =                  N/A
              le_mean =     -17.216452844755
             les_mean =     296.719514744383
             stat err =       0.000423857723
             autocorr =       1.146981617108
              std dev =       0.559702014790
             le_variance =       0.313266345360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216452844755        initial
     3.9062e+07     3.9062e+08             2.7522e-12       -17.216452844755  <--
     1.5625e+08     1.5625e+09             6.8821e-13       -17.216452844755
     6.2500e+08     6.2500e+09             1.7211e-13       -17.216452844755

*****************************************************************************
Applying the update for shift_i =   3.9062e+07     and shift_s =   3.9062e+08
*****************************************************************************

  Execution time = 2.8781e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.324462
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311513015749
                                         uncertainty =       0.002260904228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311513015749
                                         uncertainty =       0.002260904228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394613447
  error estimate for blocks of size 2^( 2) =       0.000404251438
  error estimate for blocks of size 2^( 3) =       0.000412279719
  error estimate for blocks of size 2^( 4) =       0.000418072197
  error estimate for blocks of size 2^( 5) =       0.000420772206
  error estimate for blocks of size 2^( 6) =       0.000422998259
  error estimate for blocks of size 2^( 7) =       0.000421866068

      target function =                  N/A
              le_mean =     -17.217319092910
             les_mean =     296.747516135764
             stat err =       0.000420927182
             autocorr =       1.137811149077
              std dev =       0.558067688022
             le_variance =       0.311439544414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731909291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319092910       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319092910       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319092910       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319097306       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319093969       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319092491       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319084027       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.426962e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319092910       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319092910       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319092910       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319088255       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319066691       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319120465       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319100025       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 3.567315e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319092910       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319092910       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319092910       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319092910       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319037140       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319145909       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319139795       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 8.919093e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5895e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2672
    reference variance = 0.475675
====================================================
  Execution time = 1.9619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073507
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073507
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399288424
  error estimate for blocks of size 2^( 2) =       0.000408962734
  error estimate for blocks of size 2^( 3) =       0.000417471020
  error estimate for blocks of size 2^( 4) =       0.000423288411
  error estimate for blocks of size 2^( 5) =       0.000426583536
  error estimate for blocks of size 2^( 6) =       0.000428095134
  error estimate for blocks of size 2^( 7) =       0.000429923294

      target function =                  N/A
              le_mean =     -17.216888726029
             les_mean =     296.740119736614
             stat err =       0.000426972594
             autocorr =       1.143474698054
              std dev =       0.564679104966
             le_variance =       0.318862491585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073493
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073493
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399288424
  error estimate for blocks of size 2^( 2) =       0.000408962734
  error estimate for blocks of size 2^( 3) =       0.000417471020
  error estimate for blocks of size 2^( 4) =       0.000423288411
  error estimate for blocks of size 2^( 5) =       0.000426583536
  error estimate for blocks of size 2^( 6) =       0.000428095134
  error estimate for blocks of size 2^( 7) =       0.000429923294

      target function =                  N/A
              le_mean =     -17.216888726029
             les_mean =     296.740119736603
             stat err =       0.000426972594
             autocorr =       1.143474698070
              std dev =       0.564679104954
             le_variance =       0.318862491571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073500
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073500
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399288424
  error estimate for blocks of size 2^( 2) =       0.000408962734
  error estimate for blocks of size 2^( 3) =       0.000417471020
  error estimate for blocks of size 2^( 4) =       0.000423288411
  error estimate for blocks of size 2^( 5) =       0.000426583536
  error estimate for blocks of size 2^( 6) =       0.000428095134
  error estimate for blocks of size 2^( 7) =       0.000429923294

      target function =                  N/A
              le_mean =     -17.216888726029
             les_mean =     296.740119736609
             stat err =       0.000426972594
             autocorr =       1.143474698069
              std dev =       0.564679104960
             le_variance =       0.318862491578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073506
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318873073506
                                         uncertainty =       0.003365829397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399288424
  error estimate for blocks of size 2^( 2) =       0.000408962734
  error estimate for blocks of size 2^( 3) =       0.000417471020
  error estimate for blocks of size 2^( 4) =       0.000423288411
  error estimate for blocks of size 2^( 5) =       0.000426583536
  error estimate for blocks of size 2^( 6) =       0.000428095134
  error estimate for blocks of size 2^( 7) =       0.000429923294

      target function =                  N/A
              le_mean =     -17.216888726029
             les_mean =     296.740119736613
             stat err =       0.000426972594
             autocorr =       1.143474698057
              std dev =       0.564679104965
             le_variance =       0.318862491584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216888726029        initial
     9.7656e+06     9.7656e+07             1.4270e-11       -17.216888726029  <--
     3.9062e+07     3.9062e+08             3.5673e-12       -17.216888726029
     1.5625e+08     1.5625e+09             8.9191e-13       -17.216888726029

*****************************************************************************
Applying the update for shift_i =   9.7656e+06     and shift_s =   9.7656e+07
*****************************************************************************

  Execution time = 2.8703e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.609532
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1740e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317292451173
                                         uncertainty =       0.003632543660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317292451173
                                         uncertainty =       0.003632543660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398370060
  error estimate for blocks of size 2^( 2) =       0.000408245072
  error estimate for blocks of size 2^( 3) =       0.000416832687
  error estimate for blocks of size 2^( 4) =       0.000423586364
  error estimate for blocks of size 2^( 5) =       0.000426475868
  error estimate for blocks of size 2^( 6) =       0.000431382513
  error estimate for blocks of size 2^( 7) =       0.000433078119

      target function =                  N/A
              le_mean =     -17.217163820957
             les_mean =     296.748127287835
             stat err =       0.000428630716
             autocorr =       1.157692442109
              std dev =       0.563380341210
             le_variance =       0.317397408862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716382096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163820957       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163820957       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163820957       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163820817       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163820957       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163820645       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163819610       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 6.930070e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163820957       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163820957       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163820957       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163820721       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163822565       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163825323       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163806072       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.732556e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163820957       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163820957       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217163820957       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217163834053       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217163792021       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217163833084       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217163837406       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 4.331229e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5772e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1731
    reference variance = 0.232838
====================================================
  Execution time = 2.1900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2432e-01
  Total weights = 2.0000e+06
  Execution time = 1.8031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177307
                                         uncertainty =       0.004028006716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177307
                                         uncertainty =       0.004028006716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690738
  error estimate for blocks of size 2^( 2) =       0.000412286283
  error estimate for blocks of size 2^( 3) =       0.000420798226
  error estimate for blocks of size 2^( 4) =       0.000426628799
  error estimate for blocks of size 2^( 5) =       0.000430145059
  error estimate for blocks of size 2^( 6) =       0.000431608382
  error estimate for blocks of size 2^( 7) =       0.000433430889

      target function =                  N/A
              le_mean =     -17.216914447321
             les_mean =     296.746462585602
             stat err =       0.000430453282
             autocorr =       1.142638268910
              std dev =       0.569490703511
             le_variance =       0.324319661386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177367
                                         uncertainty =       0.004028006717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177367
                                         uncertainty =       0.004028006717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690738
  error estimate for blocks of size 2^( 2) =       0.000412286283
  error estimate for blocks of size 2^( 3) =       0.000420798226
  error estimate for blocks of size 2^( 4) =       0.000426628799
  error estimate for blocks of size 2^( 5) =       0.000430145059
  error estimate for blocks of size 2^( 6) =       0.000431608382
  error estimate for blocks of size 2^( 7) =       0.000433430889

      target function =                  N/A
              le_mean =     -17.216914447321
             les_mean =     296.746462585654
             stat err =       0.000430453282
             autocorr =       1.142638268878
              std dev =       0.569490703564
             le_variance =       0.324319661446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177337
                                         uncertainty =       0.004028006717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177337
                                         uncertainty =       0.004028006717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690738
  error estimate for blocks of size 2^( 2) =       0.000412286283
  error estimate for blocks of size 2^( 3) =       0.000420798226
  error estimate for blocks of size 2^( 4) =       0.000426628799
  error estimate for blocks of size 2^( 5) =       0.000430145059
  error estimate for blocks of size 2^( 6) =       0.000431608382
  error estimate for blocks of size 2^( 7) =       0.000433430889

      target function =                  N/A
              le_mean =     -17.216914447321
             les_mean =     296.746462585628
             stat err =       0.000430453282
             autocorr =       1.142638268894
              std dev =       0.569490703537
             le_variance =       0.324319661415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177310
                                         uncertainty =       0.004028006716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324337177310
                                         uncertainty =       0.004028006716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690738
  error estimate for blocks of size 2^( 2) =       0.000412286283
  error estimate for blocks of size 2^( 3) =       0.000420798226
  error estimate for blocks of size 2^( 4) =       0.000426628799
  error estimate for blocks of size 2^( 5) =       0.000430145059
  error estimate for blocks of size 2^( 6) =       0.000431608382
  error estimate for blocks of size 2^( 7) =       0.000433430889

      target function =                  N/A
              le_mean =     -17.216914447321
             les_mean =     296.746462585605
             stat err =       0.000430453282
             autocorr =       1.142638268899
              std dev =       0.569490703514
             le_variance =       0.324319661389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216914447321        initial  <--
     2.4414e+06     2.4414e+07             6.9301e-11       -17.216914447321
     9.7656e+06     9.7656e+07             1.7326e-11       -17.216914447321
     3.9062e+07     3.9062e+08             4.3312e-12       -17.216914447321

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0088
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.278
    reference variance = 0.219406
====================================================
  Execution time = 2.2256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2397e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943384849
                                         uncertainty =       0.004368233496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323943384849
                                         uncertainty =       0.004368233496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402473021
  error estimate for blocks of size 2^( 2) =       0.000412080042
  error estimate for blocks of size 2^( 3) =       0.000420760483
  error estimate for blocks of size 2^( 4) =       0.000427318552
  error estimate for blocks of size 2^( 5) =       0.000430994488
  error estimate for blocks of size 2^( 6) =       0.000433816415
  error estimate for blocks of size 2^( 7) =       0.000432460100

      target function =                  N/A
              le_mean =     -17.217218096841
             les_mean =     296.756567897443
             stat err =       0.000431147389
             autocorr =       1.147566793766
              std dev =       0.569182804775
             le_variance =       0.323969065252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721809684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218096841       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218096841       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218096841       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218096841       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218097988       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218101897       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.890030e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218096841       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218096841       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218096841       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218096340       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218088450       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218142189       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.722401e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218096841       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218096841       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218096841       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218096841       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218268733       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218390136       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 4.304620e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7740e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.190489
====================================================
  Execution time = 1.9893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1584e-01
  Total weights = 2.0000e+06
  Execution time = 1.9883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851256
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851256
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397391418
  error estimate for blocks of size 2^( 2) =       0.000407317776
  error estimate for blocks of size 2^( 3) =       0.000415831540
  error estimate for blocks of size 2^( 4) =       0.000421303185
  error estimate for blocks of size 2^( 5) =       0.000425652929
  error estimate for blocks of size 2^( 6) =       0.000428444294
  error estimate for blocks of size 2^( 7) =       0.000431486459

      target function =                  N/A
              le_mean =     -17.217052934048
             les_mean =     296.742751453617
             stat err =       0.000426721717
             autocorr =       1.153061639208
              std dev =       0.561996332491
             le_variance =       0.315839877734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851258
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851258
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397391418
  error estimate for blocks of size 2^( 2) =       0.000407317776
  error estimate for blocks of size 2^( 3) =       0.000415831540
  error estimate for blocks of size 2^( 4) =       0.000421303185
  error estimate for blocks of size 2^( 5) =       0.000425652929
  error estimate for blocks of size 2^( 6) =       0.000428444294
  error estimate for blocks of size 2^( 7) =       0.000431486459

      target function =                  N/A
              le_mean =     -17.217052934048
             les_mean =     296.742751453620
             stat err =       0.000426721717
             autocorr =       1.153061639201
              std dev =       0.561996332493
             le_variance =       0.315839877736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851257
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851257
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397391418
  error estimate for blocks of size 2^( 2) =       0.000407317776
  error estimate for blocks of size 2^( 3) =       0.000415831540
  error estimate for blocks of size 2^( 4) =       0.000421303185
  error estimate for blocks of size 2^( 5) =       0.000425652929
  error estimate for blocks of size 2^( 6) =       0.000428444294
  error estimate for blocks of size 2^( 7) =       0.000431486459

      target function =                  N/A
              le_mean =     -17.217052934048
             les_mean =     296.742751453619
             stat err =       0.000426721717
             autocorr =       1.153061639211
              std dev =       0.561996332492
             le_variance =       0.315839877735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851256
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315908851256
                                         uncertainty =       0.003099588685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397391418
  error estimate for blocks of size 2^( 2) =       0.000407317776
  error estimate for blocks of size 2^( 3) =       0.000415831540
  error estimate for blocks of size 2^( 4) =       0.000421303185
  error estimate for blocks of size 2^( 5) =       0.000425652929
  error estimate for blocks of size 2^( 6) =       0.000428444294
  error estimate for blocks of size 2^( 7) =       0.000431486459

      target function =                  N/A
              le_mean =     -17.217052934048
             les_mean =     296.742751453618
             stat err =       0.000426721717
             autocorr =       1.153061639212
              std dev =       0.561996332491
             le_variance =       0.315839877734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217052934048        initial
     2.4414e+07     2.4414e+08             6.8900e-12       -17.217052934048  <--
     9.7656e+07     9.7656e+08             1.7224e-12       -17.217052934048
     3.9062e+08     3.9062e+09             4.3046e-13       -17.217052934048

*****************************************************************************
Applying the update for shift_i =   2.4414e+07     and shift_s =   2.4414e+08
*****************************************************************************

  Execution time = 2.9218e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.3752
    reference variance = 1.52673
====================================================
  Execution time = 1.9954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353327753321
                                         uncertainty =       0.030674398942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353327753321
                                         uncertainty =       0.030674398942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420330296
  error estimate for blocks of size 2^( 2) =       0.000429347727
  error estimate for blocks of size 2^( 3) =       0.000437646073
  error estimate for blocks of size 2^( 4) =       0.000442961659
  error estimate for blocks of size 2^( 5) =       0.000446723725
  error estimate for blocks of size 2^( 6) =       0.000449897679
  error estimate for blocks of size 2^( 7) =       0.000448969062

      target function =                  N/A
              le_mean =     -17.216589700209
             les_mean =     296.764315844887
             stat err =       0.000447138031
             autocorr =       1.131623174178
              std dev =       0.594436805923
             le_variance =       0.353355116236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658970021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589700209       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216589700209       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216589700209       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216589702614       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216589700643       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216589695860       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216589704493       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 2.619512e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589700209       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216589700209       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216589700209       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216589712122       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216589688450       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216589696968       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216589696399       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.549060e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589700209       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216589700209       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216589700209       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216589701067       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216589703360       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216589727367       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216589712866       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.636979e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5438e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2096
    reference variance = 0.240709
====================================================
  Execution time = 1.9819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1492e-01
  Total weights = 2.0000e+06
  Execution time = 1.7989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896399
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896399
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396809979
  error estimate for blocks of size 2^( 2) =       0.000406535302
  error estimate for blocks of size 2^( 3) =       0.000414727779
  error estimate for blocks of size 2^( 4) =       0.000420484029
  error estimate for blocks of size 2^( 5) =       0.000424375353
  error estimate for blocks of size 2^( 6) =       0.000426708027
  error estimate for blocks of size 2^( 7) =       0.000426468172

      target function =                  N/A
              le_mean =     -17.216529445656
             les_mean =     296.723802314326
             stat err =       0.000424508895
             autocorr =       1.144480557514
              std dev =       0.561174053788
             le_variance =       0.314916318645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896407
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896407
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396809979
  error estimate for blocks of size 2^( 2) =       0.000406535302
  error estimate for blocks of size 2^( 3) =       0.000414727779
  error estimate for blocks of size 2^( 4) =       0.000420484029
  error estimate for blocks of size 2^( 5) =       0.000424375353
  error estimate for blocks of size 2^( 6) =       0.000426708027
  error estimate for blocks of size 2^( 7) =       0.000426468172

      target function =                  N/A
              le_mean =     -17.216529445656
             les_mean =     296.723802314337
             stat err =       0.000424508895
             autocorr =       1.144480557507
              std dev =       0.561174053795
             le_variance =       0.314916318653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896403
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896403
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396809979
  error estimate for blocks of size 2^( 2) =       0.000406535302
  error estimate for blocks of size 2^( 3) =       0.000414727779
  error estimate for blocks of size 2^( 4) =       0.000420484029
  error estimate for blocks of size 2^( 5) =       0.000424375353
  error estimate for blocks of size 2^( 6) =       0.000426708027
  error estimate for blocks of size 2^( 7) =       0.000426468172

      target function =                  N/A
              le_mean =     -17.216529445656
             les_mean =     296.723802314331
             stat err =       0.000424508895
             autocorr =       1.144480557511
              std dev =       0.561174053792
             le_variance =       0.314916318649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896400
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873896400
                                         uncertainty =       0.002877129469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396809979
  error estimate for blocks of size 2^( 2) =       0.000406535302
  error estimate for blocks of size 2^( 3) =       0.000414727779
  error estimate for blocks of size 2^( 4) =       0.000420484029
  error estimate for blocks of size 2^( 5) =       0.000424375353
  error estimate for blocks of size 2^( 6) =       0.000426708027
  error estimate for blocks of size 2^( 7) =       0.000426468172

      target function =                  N/A
              le_mean =     -17.216529445656
             les_mean =     296.723802314326
             stat err =       0.000424508895
             autocorr =       1.144480557510
              std dev =       0.561174053789
             le_variance =       0.314916318646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216529445656        initial
     6.1035e+06     6.1035e+07             2.6195e-11       -17.216529445656  <--
     2.4414e+07     2.4414e+08             6.5491e-12       -17.216529445656
     9.7656e+07     9.7656e+08             1.6370e-12       -17.216529445656

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 2.8896e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.304398
====================================================
  Execution time = 2.0106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319808287163
                                         uncertainty =       0.004029163248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319808287163
                                         uncertainty =       0.004029163248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399824473
  error estimate for blocks of size 2^( 2) =       0.000409869923
  error estimate for blocks of size 2^( 3) =       0.000418534620
  error estimate for blocks of size 2^( 4) =       0.000425136567
  error estimate for blocks of size 2^( 5) =       0.000428981164
  error estimate for blocks of size 2^( 6) =       0.000429575534
  error estimate for blocks of size 2^( 7) =       0.000428691878

      target function =                  N/A
              le_mean =     -17.217706151566
             les_mean =     296.769124180810
             stat err =       0.000428096286
             autocorr =       1.146421103832
              std dev =       0.565437192799
             le_variance =       0.319719219001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721770615157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217706151566       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217706151566       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217706151566       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217706152238       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217706152085       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217706152138       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 9.819809e-11

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217706151566       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217706151566       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217706151566       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217706151437       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217706153315       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217706153928       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 2.454939e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217706151566       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217706151566       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217706151566       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217706152231       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217706142878       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217706122220       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.137556e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5701e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.313269
====================================================
  Execution time = 1.9588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1686e-01
  Total weights = 2.0000e+06
  Execution time = 1.8006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219426
                                         uncertainty =       0.002909337062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219426
                                         uncertainty =       0.002909337062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398030554
  error estimate for blocks of size 2^( 2) =       0.000407614151
  error estimate for blocks of size 2^( 3) =       0.000416819823
  error estimate for blocks of size 2^( 4) =       0.000422810261
  error estimate for blocks of size 2^( 5) =       0.000425815734
  error estimate for blocks of size 2^( 6) =       0.000429491153
  error estimate for blocks of size 2^( 7) =       0.000430044434

      target function =                  N/A
              le_mean =     -17.217146889801
             les_mean =     296.747003509984
             stat err =       0.000427040396
             autocorr =       1.151078907011
              std dev =       0.562900207337
             le_variance =       0.316856643420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219490
                                         uncertainty =       0.002909337063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219490
                                         uncertainty =       0.002909337063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398030554
  error estimate for blocks of size 2^( 2) =       0.000407614151
  error estimate for blocks of size 2^( 3) =       0.000416819823
  error estimate for blocks of size 2^( 4) =       0.000422810261
  error estimate for blocks of size 2^( 5) =       0.000425815734
  error estimate for blocks of size 2^( 6) =       0.000429491153
  error estimate for blocks of size 2^( 7) =       0.000430044434

      target function =                  N/A
              le_mean =     -17.217146889802
             les_mean =     296.747003510069
             stat err =       0.000427040396
             autocorr =       1.151078906980
              std dev =       0.562900207394
             le_variance =       0.316856643485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219458
                                         uncertainty =       0.002909337063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219458
                                         uncertainty =       0.002909337063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398030554
  error estimate for blocks of size 2^( 2) =       0.000407614151
  error estimate for blocks of size 2^( 3) =       0.000416819823
  error estimate for blocks of size 2^( 4) =       0.000422810261
  error estimate for blocks of size 2^( 5) =       0.000425815734
  error estimate for blocks of size 2^( 6) =       0.000429491153
  error estimate for blocks of size 2^( 7) =       0.000430044434

      target function =                  N/A
              le_mean =     -17.217146889802
             les_mean =     296.747003510027
             stat err =       0.000427040396
             autocorr =       1.151078907001
              std dev =       0.562900207366
             le_variance =       0.316856643453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219430
                                         uncertainty =       0.002909337062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316762219430
                                         uncertainty =       0.002909337062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398030554
  error estimate for blocks of size 2^( 2) =       0.000407614151
  error estimate for blocks of size 2^( 3) =       0.000416819823
  error estimate for blocks of size 2^( 4) =       0.000422810261
  error estimate for blocks of size 2^( 5) =       0.000425815734
  error estimate for blocks of size 2^( 6) =       0.000429491153
  error estimate for blocks of size 2^( 7) =       0.000430044434

      target function =                  N/A
              le_mean =     -17.217146889801
             les_mean =     296.747003509990
             stat err =       0.000427040396
             autocorr =       1.151078907014
              std dev =       0.562900207341
             le_variance =       0.316856643425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217146889801        initial
     1.5259e+06     1.5259e+07             9.8198e-11       -17.217146889802  <--
     6.1035e+06     6.1035e+07             2.4549e-11       -17.217146889802
     2.4414e+07     2.4414e+08             6.1376e-12       -17.217146889801

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 2.8682e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.374584
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318995242738
                                         uncertainty =       0.003363584910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318995242738
                                         uncertainty =       0.003363584910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399378183
  error estimate for blocks of size 2^( 2) =       0.000408841162
  error estimate for blocks of size 2^( 3) =       0.000417350492
  error estimate for blocks of size 2^( 4) =       0.000423978568
  error estimate for blocks of size 2^( 5) =       0.000428098829
  error estimate for blocks of size 2^( 6) =       0.000428379037
  error estimate for blocks of size 2^( 7) =       0.000428336004

      target function =                  N/A
              le_mean =     -17.217585178388
             les_mean =     296.764245082178
             stat err =       0.000427198110
             autocorr =       1.144168455832
              std dev =       0.564806043389
             le_variance =       0.319005866649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721758517839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217585178388       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217585178387       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217585178386       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217585178386       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217585178508       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217585178663       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217585178254       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 3.061714e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217585178388       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217585178387       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217585178387       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217585178387       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217585178426       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217585178342       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217585178591       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 7.654267e-11

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217585178388       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217585178388       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217585178387       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217585174925       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217585179394       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217585178483       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217585179820       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 1.913556e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6014e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2327
    reference variance = 0.389926
====================================================
  Execution time = 1.9627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1489e-01
  Total weights = 2.0000e+06
  Execution time = 1.8017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158432
                                         uncertainty =       0.003734239544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158432
                                         uncertainty =       0.003734239544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396796422
  error estimate for blocks of size 2^( 2) =       0.000406576115
  error estimate for blocks of size 2^( 3) =       0.000415248184
  error estimate for blocks of size 2^( 4) =       0.000421105477
  error estimate for blocks of size 2^( 5) =       0.000425136489
  error estimate for blocks of size 2^( 6) =       0.000427390439
  error estimate for blocks of size 2^( 7) =       0.000426787358

      target function =                  N/A
              le_mean =     -17.216600587177
             les_mean =     296.726230422124
             stat err =       0.000425104941
             autocorr =       1.147775128869
              std dev =       0.561154881651
             le_variance =       0.314894801201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158356
                                         uncertainty =       0.003734239542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158356
                                         uncertainty =       0.003734239542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396796422
  error estimate for blocks of size 2^( 2) =       0.000406576115
  error estimate for blocks of size 2^( 3) =       0.000415248184
  error estimate for blocks of size 2^( 4) =       0.000421105477
  error estimate for blocks of size 2^( 5) =       0.000425136489
  error estimate for blocks of size 2^( 6) =       0.000427390439
  error estimate for blocks of size 2^( 7) =       0.000426787358

      target function =                  N/A
              le_mean =     -17.216600587176
             les_mean =     296.726230422025
             stat err =       0.000425104941
             autocorr =       1.147775128923
              std dev =       0.561154881583
             le_variance =       0.314894801125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158394
                                         uncertainty =       0.003734239543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158394
                                         uncertainty =       0.003734239543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396796422
  error estimate for blocks of size 2^( 2) =       0.000406576115
  error estimate for blocks of size 2^( 3) =       0.000415248184
  error estimate for blocks of size 2^( 4) =       0.000421105477
  error estimate for blocks of size 2^( 5) =       0.000425136489
  error estimate for blocks of size 2^( 6) =       0.000427390439
  error estimate for blocks of size 2^( 7) =       0.000426787358

      target function =                  N/A
              le_mean =     -17.216600587176
             les_mean =     296.726230422074
             stat err =       0.000425104941
             autocorr =       1.147775128896
              std dev =       0.561154881617
             le_variance =       0.314894801163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158428
                                         uncertainty =       0.003734239544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314899158428
                                         uncertainty =       0.003734239544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396796422
  error estimate for blocks of size 2^( 2) =       0.000406576115
  error estimate for blocks of size 2^( 3) =       0.000415248184
  error estimate for blocks of size 2^( 4) =       0.000421105477
  error estimate for blocks of size 2^( 5) =       0.000425136489
  error estimate for blocks of size 2^( 6) =       0.000427390439
  error estimate for blocks of size 2^( 7) =       0.000426787358

      target function =                  N/A
              le_mean =     -17.216600587177
             les_mean =     296.726230422118
             stat err =       0.000425104941
             autocorr =       1.147775128881
              std dev =       0.561154881647
             le_variance =       0.314894801196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216600587177        initial  <--
     3.8147e+05     3.8147e+06             3.0617e-10       -17.216600587176
     1.5259e+06     1.5259e+07             7.6543e-11       -17.216600587176
     6.1035e+06     6.1035e+07             1.9136e-11       -17.216600587177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7368
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.394566
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326075894414
                                         uncertainty =       0.008019139584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326075894414
                                         uncertainty =       0.008019139584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403777849
  error estimate for blocks of size 2^( 2) =       0.000413274564
  error estimate for blocks of size 2^( 3) =       0.000421772913
  error estimate for blocks of size 2^( 4) =       0.000427214015
  error estimate for blocks of size 2^( 5) =       0.000430309287
  error estimate for blocks of size 2^( 6) =       0.000432289609
  error estimate for blocks of size 2^( 7) =       0.000432661625

      target function =                  N/A
              le_mean =     -17.217023272432
             les_mean =     296.751963303459
             stat err =       0.000430618634
             autocorr =       1.137367087781
              std dev =       0.571028110533
             le_variance =       0.326073103019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702327243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023272432       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023272432       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217023272432       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217023270358       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217023274688       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217023276929       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 2.923964e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023272432       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023272432       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217023272432       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217023272432       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217023277093       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217023272454       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 7.309830e-12

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023272432       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023272432       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217023272432       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217023272035       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217023251977       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217023277116       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 1.827638e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5574e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 1.06597
====================================================
  Execution time = 1.9564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2066e-01
  Total weights = 2.0000e+06
  Execution time = 1.7997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509783
                                         uncertainty =       0.005577387499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509783
                                         uncertainty =       0.005577387499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400409978
  error estimate for blocks of size 2^( 2) =       0.000410058382
  error estimate for blocks of size 2^( 3) =       0.000418356566
  error estimate for blocks of size 2^( 4) =       0.000423751151
  error estimate for blocks of size 2^( 5) =       0.000428007570
  error estimate for blocks of size 2^( 6) =       0.000430266819
  error estimate for blocks of size 2^( 7) =       0.000433125660

      target function =                  N/A
              le_mean =     -17.216890211956
             les_mean =     296.741964711593
             stat err =       0.000428787800
             autocorr =       1.146766657112
              std dev =       0.566265221769
             le_variance =       0.320656301385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509806
                                         uncertainty =       0.005577387500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509806
                                         uncertainty =       0.005577387500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400409978
  error estimate for blocks of size 2^( 2) =       0.000410058382
  error estimate for blocks of size 2^( 3) =       0.000418356566
  error estimate for blocks of size 2^( 4) =       0.000423751151
  error estimate for blocks of size 2^( 5) =       0.000428007570
  error estimate for blocks of size 2^( 6) =       0.000430266819
  error estimate for blocks of size 2^( 7) =       0.000433125660

      target function =                  N/A
              le_mean =     -17.216890211956
             les_mean =     296.741964711628
             stat err =       0.000428787800
             autocorr =       1.146766657090
              std dev =       0.566265221789
             le_variance =       0.320656301407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509794
                                         uncertainty =       0.005577387500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509794
                                         uncertainty =       0.005577387500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400409978
  error estimate for blocks of size 2^( 2) =       0.000410058382
  error estimate for blocks of size 2^( 3) =       0.000418356566
  error estimate for blocks of size 2^( 4) =       0.000423751151
  error estimate for blocks of size 2^( 5) =       0.000428007570
  error estimate for blocks of size 2^( 6) =       0.000430266819
  error estimate for blocks of size 2^( 7) =       0.000433125660

      target function =                  N/A
              le_mean =     -17.216890211956
             les_mean =     296.741964711610
             stat err =       0.000428787800
             autocorr =       1.146766657097
              std dev =       0.566265221779
             le_variance =       0.320656301396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509785
                                         uncertainty =       0.005577387499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606509785
                                         uncertainty =       0.005577387499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400409978
  error estimate for blocks of size 2^( 2) =       0.000410058382
  error estimate for blocks of size 2^( 3) =       0.000418356566
  error estimate for blocks of size 2^( 4) =       0.000423751151
  error estimate for blocks of size 2^( 5) =       0.000428007570
  error estimate for blocks of size 2^( 6) =       0.000430266819
  error estimate for blocks of size 2^( 7) =       0.000433125660

      target function =                  N/A
              le_mean =     -17.216890211956
             les_mean =     296.741964711595
             stat err =       0.000428787800
             autocorr =       1.146766657106
              std dev =       0.566265221770
             le_variance =       0.320656301386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216890211956        initial
     3.8147e+06     3.8147e+07             2.9240e-11       -17.216890211956  <--
     1.5259e+07     1.5259e+08             7.3098e-12       -17.216890211956
     6.1035e+07     6.1035e+08             1.8276e-12       -17.216890211956

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 3.1953e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1088
    reference variance = 0.205341
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312494404743
                                         uncertainty =       0.002546813678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312494404743
                                         uncertainty =       0.002546813678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395327272
  error estimate for blocks of size 2^( 2) =       0.000405085257
  error estimate for blocks of size 2^( 3) =       0.000414051516
  error estimate for blocks of size 2^( 4) =       0.000420203114
  error estimate for blocks of size 2^( 5) =       0.000423817078
  error estimate for blocks of size 2^( 6) =       0.000427818091
  error estimate for blocks of size 2^( 7) =       0.000429004481

      target function =                  N/A
              le_mean =     -17.216043788368
             les_mean =     296.704730869996
             stat err =       0.000425210691
             autocorr =       1.156897281732
              std dev =       0.559077189016
             le_variance =       0.312567303278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604378837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043788368       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043788368       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043788369       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043788369       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043788855       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043788283       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043788538       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.657260e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043788368       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043788368       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043788368       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043788233       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043790476       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043790565       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043792010       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.643164e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216043788368       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216043788368       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216043788368       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216043788370       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216043800964       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216043788435       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216043784368       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.660812e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5722e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.362063
====================================================
  Execution time = 2.1902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2003e-01
  Total weights = 2.0000e+06
  Execution time = 1.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964308
                                         uncertainty =       0.006485972249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964308
                                         uncertainty =       0.006485972249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021843
  error estimate for blocks of size 2^( 2) =       0.000409942783
  error estimate for blocks of size 2^( 3) =       0.000417954178
  error estimate for blocks of size 2^( 4) =       0.000423503275
  error estimate for blocks of size 2^( 5) =       0.000428082978
  error estimate for blocks of size 2^( 6) =       0.000430180040
  error estimate for blocks of size 2^( 7) =       0.000431607289

      target function =                  N/A
              le_mean =     -17.217486937541
             les_mean =     296.761891233823
             stat err =       0.000428343396
             autocorr =       1.146612673513
              std dev =       0.565716315349
             le_variance =       0.320034949452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964561
                                         uncertainty =       0.006485972257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964561
                                         uncertainty =       0.006485972257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021843
  error estimate for blocks of size 2^( 2) =       0.000409942783
  error estimate for blocks of size 2^( 3) =       0.000417954178
  error estimate for blocks of size 2^( 4) =       0.000423503275
  error estimate for blocks of size 2^( 5) =       0.000428082978
  error estimate for blocks of size 2^( 6) =       0.000430180040
  error estimate for blocks of size 2^( 7) =       0.000431607289

      target function =                  N/A
              le_mean =     -17.217486937542
             les_mean =     296.761891234111
             stat err =       0.000428343396
             autocorr =       1.146612673372
              std dev =       0.565716315573
             le_variance =       0.320034949705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964435
                                         uncertainty =       0.006485972253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964435
                                         uncertainty =       0.006485972253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021843
  error estimate for blocks of size 2^( 2) =       0.000409942783
  error estimate for blocks of size 2^( 3) =       0.000417954178
  error estimate for blocks of size 2^( 4) =       0.000423503275
  error estimate for blocks of size 2^( 5) =       0.000428082978
  error estimate for blocks of size 2^( 6) =       0.000430180040
  error estimate for blocks of size 2^( 7) =       0.000431607289

      target function =                  N/A
              le_mean =     -17.217486937541
             les_mean =     296.761891233967
             stat err =       0.000428343396
             autocorr =       1.146612673437
              std dev =       0.565716315461
             le_variance =       0.320034949579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964324
                                         uncertainty =       0.006485972249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125964324
                                         uncertainty =       0.006485972249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400021843
  error estimate for blocks of size 2^( 2) =       0.000409942783
  error estimate for blocks of size 2^( 3) =       0.000417954178
  error estimate for blocks of size 2^( 4) =       0.000423503275
  error estimate for blocks of size 2^( 5) =       0.000428082978
  error estimate for blocks of size 2^( 6) =       0.000430180040
  error estimate for blocks of size 2^( 7) =       0.000431607289

      target function =                  N/A
              le_mean =     -17.217486937541
             les_mean =     296.761891233841
             stat err =       0.000428343396
             autocorr =       1.146612673511
              std dev =       0.565716315363
             le_variance =       0.320034949468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217486937541        initial
     9.5367e+05     9.5367e+06             2.6573e-10       -17.217486937542  <--
     3.8147e+06     3.8147e+07             6.6432e-11       -17.217486937541
     1.5259e+07     1.5259e+08             1.6608e-11       -17.217486937541

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 3.1059e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.22949
====================================================
  Execution time = 2.0439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761776622
                                         uncertainty =       0.004100323437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761776622
                                         uncertainty =       0.004100323437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399832344
  error estimate for blocks of size 2^( 2) =       0.000409885984
  error estimate for blocks of size 2^( 3) =       0.000418463511
  error estimate for blocks of size 2^( 4) =       0.000425039662
  error estimate for blocks of size 2^( 5) =       0.000428896356
  error estimate for blocks of size 2^( 6) =       0.000430288762
  error estimate for blocks of size 2^( 7) =       0.000430739699

      target function =                  N/A
              le_mean =     -17.217129028260
             les_mean =     296.749263622898
             stat err =       0.000428741120
             autocorr =       1.149832103067
              std dev =       0.565448323906
             le_variance =       0.319731807008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712902826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217129028260       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217129028264       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217129028265       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217129028268       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217129028249       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217129028288       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217129028158       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.743997e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217129028260       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217129028261       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217129028261       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217129028339       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217129028254       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217129028262       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217129028280       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 1.936001e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217129028260       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217129028260       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217129028260       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217129028260       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217129028452       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217129028272       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217129029381       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 4.839998e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5906e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.444847
====================================================
  Execution time = 1.9523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1408e-01
  Total weights = 2.0000e+06
  Execution time = 1.8112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219300
                                         uncertainty =       0.003132158805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219300
                                         uncertainty =       0.003132158805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396284641
  error estimate for blocks of size 2^( 2) =       0.000405525327
  error estimate for blocks of size 2^( 3) =       0.000413787752
  error estimate for blocks of size 2^( 4) =       0.000419987103
  error estimate for blocks of size 2^( 5) =       0.000424086790
  error estimate for blocks of size 2^( 6) =       0.000427584956
  error estimate for blocks of size 2^( 7) =       0.000429461706

      target function =                  N/A
              le_mean =     -17.216150873130
             les_mean =     296.709933762988
             stat err =       0.000425280139
             autocorr =       1.151690331189
              std dev =       0.560431114093
             le_variance =       0.314083033644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219202
                                         uncertainty =       0.003132158810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219202
                                         uncertainty =       0.003132158810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396284641
  error estimate for blocks of size 2^( 2) =       0.000405525327
  error estimate for blocks of size 2^( 3) =       0.000413787752
  error estimate for blocks of size 2^( 4) =       0.000419987103
  error estimate for blocks of size 2^( 5) =       0.000424086790
  error estimate for blocks of size 2^( 6) =       0.000427584956
  error estimate for blocks of size 2^( 7) =       0.000429461706

      target function =                  N/A
              le_mean =     -17.216150873129
             les_mean =     296.709933762832
             stat err =       0.000425280139
             autocorr =       1.151690331293
              std dev =       0.560431114004
             le_variance =       0.314083033544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219251
                                         uncertainty =       0.003132158807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219251
                                         uncertainty =       0.003132158807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396284641
  error estimate for blocks of size 2^( 2) =       0.000405525327
  error estimate for blocks of size 2^( 3) =       0.000413787752
  error estimate for blocks of size 2^( 4) =       0.000419987103
  error estimate for blocks of size 2^( 5) =       0.000424086790
  error estimate for blocks of size 2^( 6) =       0.000427584956
  error estimate for blocks of size 2^( 7) =       0.000429461706

      target function =                  N/A
              le_mean =     -17.216150873130
             les_mean =     296.709933762910
             stat err =       0.000425280139
             autocorr =       1.151690331247
              std dev =       0.560431114049
             le_variance =       0.314083033594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219294
                                         uncertainty =       0.003132158805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314154219294
                                         uncertainty =       0.003132158805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396284641
  error estimate for blocks of size 2^( 2) =       0.000405525327
  error estimate for blocks of size 2^( 3) =       0.000413787752
  error estimate for blocks of size 2^( 4) =       0.000419987103
  error estimate for blocks of size 2^( 5) =       0.000424086790
  error estimate for blocks of size 2^( 6) =       0.000427584956
  error estimate for blocks of size 2^( 7) =       0.000429461706

      target function =                  N/A
              le_mean =     -17.216150873130
             les_mean =     296.709933762978
             stat err =       0.000425280139
             autocorr =       1.151690331195
              std dev =       0.560431114087
             le_variance =       0.314083033637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216150873130        initial  <--
     2.3842e+05     2.3842e+06             7.7440e-10       -17.216150873129
     9.5367e+05     9.5367e+06             1.9360e-10       -17.216150873130
     3.8147e+06     3.8147e+07             4.8400e-11       -17.216150873130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6575
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.229008
====================================================
  Execution time = 1.9962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319867382314
                                         uncertainty =       0.004541968304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319867382314
                                         uncertainty =       0.004541968304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399899789
  error estimate for blocks of size 2^( 2) =       0.000409677602
  error estimate for blocks of size 2^( 3) =       0.000418169718
  error estimate for blocks of size 2^( 4) =       0.000424947835
  error estimate for blocks of size 2^( 5) =       0.000428250927
  error estimate for blocks of size 2^( 6) =       0.000431189796
  error estimate for blocks of size 2^( 7) =       0.000434129403

      target function =                  N/A
              le_mean =     -17.216821798970
             les_mean =     296.738792380658
             stat err =       0.000429629490
             autocorr =       1.154212617277
              std dev =       0.565543705742
             le_variance =       0.319839683104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682179897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821798970       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821798969       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821798969       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216821798942       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216821798967       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216821798146       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216821798610       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 4.613916e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821798970       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821798970       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821798970       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216821798970       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216821788884       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216821796204       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216821799384       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 1.153516e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821798970       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821798970       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821798970       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216821798345       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216821784979       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216821805053       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216821777194       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 2.883764e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5523e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.203311
====================================================
  Execution time = 2.0107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2331e-01
  Total weights = 2.0000e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870814
                                         uncertainty =       0.004053334056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870814
                                         uncertainty =       0.004053334056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402064505
  error estimate for blocks of size 2^( 2) =       0.000411794495
  error estimate for blocks of size 2^( 3) =       0.000420482003
  error estimate for blocks of size 2^( 4) =       0.000426157998
  error estimate for blocks of size 2^( 5) =       0.000430990329
  error estimate for blocks of size 2^( 6) =       0.000433330927
  error estimate for blocks of size 2^( 7) =       0.000435317791

      target function =                  N/A
              le_mean =     -17.217015621263
             les_mean =     296.748938474142
             stat err =       0.000431449261
             autocorr =       1.151510731039
              std dev =       0.568605076466
             le_variance =       0.323311732983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870794
                                         uncertainty =       0.004053334055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870794
                                         uncertainty =       0.004053334055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402064505
  error estimate for blocks of size 2^( 2) =       0.000411794495
  error estimate for blocks of size 2^( 3) =       0.000420482003
  error estimate for blocks of size 2^( 4) =       0.000426157998
  error estimate for blocks of size 2^( 5) =       0.000430990329
  error estimate for blocks of size 2^( 6) =       0.000433330927
  error estimate for blocks of size 2^( 7) =       0.000435317791

      target function =                  N/A
              le_mean =     -17.217015621263
             les_mean =     296.748938474118
             stat err =       0.000431449261
             autocorr =       1.151510731057
              std dev =       0.568605076448
             le_variance =       0.323311732962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870804
                                         uncertainty =       0.004053334055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870804
                                         uncertainty =       0.004053334055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402064505
  error estimate for blocks of size 2^( 2) =       0.000411794495
  error estimate for blocks of size 2^( 3) =       0.000420482003
  error estimate for blocks of size 2^( 4) =       0.000426157998
  error estimate for blocks of size 2^( 5) =       0.000430990329
  error estimate for blocks of size 2^( 6) =       0.000433330927
  error estimate for blocks of size 2^( 7) =       0.000435317791

      target function =                  N/A
              le_mean =     -17.217015621263
             les_mean =     296.748938474130
             stat err =       0.000431449261
             autocorr =       1.151510731047
              std dev =       0.568605076457
             le_variance =       0.323311732972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870813
                                         uncertainty =       0.004053334056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323340870813
                                         uncertainty =       0.004053334056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402064505
  error estimate for blocks of size 2^( 2) =       0.000411794495
  error estimate for blocks of size 2^( 3) =       0.000420482003
  error estimate for blocks of size 2^( 4) =       0.000426157998
  error estimate for blocks of size 2^( 5) =       0.000430990329
  error estimate for blocks of size 2^( 6) =       0.000433330927
  error estimate for blocks of size 2^( 7) =       0.000435317791

      target function =                  N/A
              le_mean =     -17.217015621263
             les_mean =     296.748938474141
             stat err =       0.000431449261
             autocorr =       1.151510731039
              std dev =       0.568605076465
             le_variance =       0.323311732981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217015621263        initial  <--
     2.3842e+06     2.3842e+07             4.6139e-11       -17.217015621263
     9.5367e+06     9.5367e+07             1.1535e-11       -17.217015621263
     3.8147e+07     3.8147e+08             2.8838e-12       -17.217015621263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2878
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.254512
====================================================
  Execution time = 2.0245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324759046497
                                         uncertainty =       0.005189216095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324759046497
                                         uncertainty =       0.005189216095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403010551
  error estimate for blocks of size 2^( 2) =       0.000412200213
  error estimate for blocks of size 2^( 3) =       0.000420537471
  error estimate for blocks of size 2^( 4) =       0.000426226112
  error estimate for blocks of size 2^( 5) =       0.000430276666
  error estimate for blocks of size 2^( 6) =       0.000433100379
  error estimate for blocks of size 2^( 7) =       0.000433036014

      target function =                  N/A
              le_mean =     -17.216547172516
             les_mean =     296.734331389052
             stat err =       0.000430659793
             autocorr =       1.141920375340
              std dev =       0.569942986630
             le_variance =       0.324835008009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654717252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547172516       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547172516       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547172516       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547172516       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216547172516       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216547172516       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216547169291       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 8.603893e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547172516       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547172516       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547172516       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547172516       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216547110578       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216547112064       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216547186650       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.151985e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547172516       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547172516       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547172516       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547172516       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216547170785       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216547337587       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546996825       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.373261e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5831e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.186
    reference variance = 0.55464
====================================================
  Execution time = 1.9804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2094e-01
  Total weights = 2.0000e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439211
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439211
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587574
  error estimate for blocks of size 2^( 2) =       0.000409880072
  error estimate for blocks of size 2^( 3) =       0.000418349365
  error estimate for blocks of size 2^( 4) =       0.000424332648
  error estimate for blocks of size 2^( 5) =       0.000428686484
  error estimate for blocks of size 2^( 6) =       0.000431228046
  error estimate for blocks of size 2^( 7) =       0.000435792045

      target function =                  N/A
              le_mean =     -17.217335274733
             les_mean =     296.757574610955
             stat err =       0.000430009806
             autocorr =       1.152289941080
              std dev =       0.566516380031
             le_variance =       0.320940808843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439218
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439218
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587574
  error estimate for blocks of size 2^( 2) =       0.000409880072
  error estimate for blocks of size 2^( 3) =       0.000418349365
  error estimate for blocks of size 2^( 4) =       0.000424332648
  error estimate for blocks of size 2^( 5) =       0.000428686484
  error estimate for blocks of size 2^( 6) =       0.000431228046
  error estimate for blocks of size 2^( 7) =       0.000435792045

      target function =                  N/A
              le_mean =     -17.217335274733
             les_mean =     296.757574610961
             stat err =       0.000430009806
             autocorr =       1.152289941072
              std dev =       0.566516380036
             le_variance =       0.320940808849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439214
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439214
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587574
  error estimate for blocks of size 2^( 2) =       0.000409880072
  error estimate for blocks of size 2^( 3) =       0.000418349365
  error estimate for blocks of size 2^( 4) =       0.000424332648
  error estimate for blocks of size 2^( 5) =       0.000428686484
  error estimate for blocks of size 2^( 6) =       0.000431228046
  error estimate for blocks of size 2^( 7) =       0.000435792045

      target function =                  N/A
              le_mean =     -17.217335274733
             les_mean =     296.757574610958
             stat err =       0.000430009806
             autocorr =       1.152289941080
              std dev =       0.566516380033
             le_variance =       0.320940808846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439212
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906439212
                                         uncertainty =       0.006394438032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587574
  error estimate for blocks of size 2^( 2) =       0.000409880072
  error estimate for blocks of size 2^( 3) =       0.000418349365
  error estimate for blocks of size 2^( 4) =       0.000424332648
  error estimate for blocks of size 2^( 5) =       0.000428686484
  error estimate for blocks of size 2^( 6) =       0.000431228046
  error estimate for blocks of size 2^( 7) =       0.000435792045

      target function =                  N/A
              le_mean =     -17.217335274733
             les_mean =     296.757574610955
             stat err =       0.000430009806
             autocorr =       1.152289941079
              std dev =       0.566516380031
             le_variance =       0.320940808843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217335274733        initial  <--
     2.3842e+07     2.3842e+08             8.6039e-12       -17.217335274733
     9.5367e+07     9.5367e+08             2.1520e-12       -17.217335274733
     3.8147e+08     3.8147e+09             5.3733e-13       -17.217335274733

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9444
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4782e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1521
    reference variance = 0.238945
====================================================
  Execution time = 2.0037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312942387821
                                         uncertainty =       0.002626406620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312942387821
                                         uncertainty =       0.002626406620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395714397
  error estimate for blocks of size 2^( 2) =       0.000405528795
  error estimate for blocks of size 2^( 3) =       0.000414151200
  error estimate for blocks of size 2^( 4) =       0.000420657671
  error estimate for blocks of size 2^( 5) =       0.000424455050
  error estimate for blocks of size 2^( 6) =       0.000425748544
  error estimate for blocks of size 2^( 7) =       0.000427689039

      target function =                  N/A
              le_mean =     -17.216923633552
             les_mean =     296.735639014262
             stat err =       0.000424637576
             autocorr =       1.151524394575
              std dev =       0.559624666436
             le_variance =       0.313179767283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692363355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923633552       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216923633552       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216923633552       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216923633552       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216923633552       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216923633552       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216923588810       residual = 6.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 5.179918e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923633552       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216923633552       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216923633552       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216923633552       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216923930538       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216923647010       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216925541709       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 1.295650e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216923633552       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216923633552       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216923633552       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216923763049       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216926621550       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216924857539       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216927725354       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 3.264624e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5554e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2077
    reference variance = 0.209697
====================================================
  Execution time = 1.9763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1689e-01
  Total weights = 2.0000e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398048783
  error estimate for blocks of size 2^( 2) =       0.000407257969
  error estimate for blocks of size 2^( 3) =       0.000415523441
  error estimate for blocks of size 2^( 4) =       0.000421804087
  error estimate for blocks of size 2^( 5) =       0.000425569279
  error estimate for blocks of size 2^( 6) =       0.000426851417
  error estimate for blocks of size 2^( 7) =       0.000429692571

      target function =                  N/A
              le_mean =     -17.217136118686
             les_mean =     296.746661638040
             stat err =       0.000425979338
             autocorr =       1.145260992622
              std dev =       0.562925987235
             le_variance =       0.316885667104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398048783
  error estimate for blocks of size 2^( 2) =       0.000407257969
  error estimate for blocks of size 2^( 3) =       0.000415523441
  error estimate for blocks of size 2^( 4) =       0.000421804087
  error estimate for blocks of size 2^( 5) =       0.000425569279
  error estimate for blocks of size 2^( 6) =       0.000426851417
  error estimate for blocks of size 2^( 7) =       0.000429692571

      target function =                  N/A
              le_mean =     -17.217136118686
             les_mean =     296.746661638041
             stat err =       0.000425979338
             autocorr =       1.145260992626
              std dev =       0.562925987235
             le_variance =       0.316885667105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398048783
  error estimate for blocks of size 2^( 2) =       0.000407257969
  error estimate for blocks of size 2^( 3) =       0.000415523441
  error estimate for blocks of size 2^( 4) =       0.000421804087
  error estimate for blocks of size 2^( 5) =       0.000425569279
  error estimate for blocks of size 2^( 6) =       0.000426851417
  error estimate for blocks of size 2^( 7) =       0.000429692571

      target function =                  N/A
              le_mean =     -17.217136118686
             les_mean =     296.746661638040
             stat err =       0.000425979339
             autocorr =       1.145260992629
              std dev =       0.562925987235
             le_variance =       0.316885667105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316951539885
                                         uncertainty =       0.002780994149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398048783
  error estimate for blocks of size 2^( 2) =       0.000407257969
  error estimate for blocks of size 2^( 3) =       0.000415523441
  error estimate for blocks of size 2^( 4) =       0.000421804087
  error estimate for blocks of size 2^( 5) =       0.000425569279
  error estimate for blocks of size 2^( 6) =       0.000426851417
  error estimate for blocks of size 2^( 7) =       0.000429692571

      target function =                  N/A
              le_mean =     -17.217136118686
             les_mean =     296.746661638040
             stat err =       0.000425979338
             autocorr =       1.145260992623
              std dev =       0.562925987235
             le_variance =       0.316885667104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217136118686        initial
     2.3842e+08     2.3842e+09             5.1799e-13       -17.217136118686
     9.5367e+08     9.5367e+09             1.2956e-13       -17.217136118686
     3.8147e+09     3.8147e+10             3.2646e-14       -17.217136118686  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e+09     and shift_s =   3.8147e+10
*****************************************************************************

  Execution time = 2.8893e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4453e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.25829
====================================================
  Execution time = 2.2210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719883922
                                         uncertainty =       0.010056019218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336719883922
                                         uncertainty =       0.010056019218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410347230
  error estimate for blocks of size 2^( 2) =       0.000419742715
  error estimate for blocks of size 2^( 3) =       0.000427808227
  error estimate for blocks of size 2^( 4) =       0.000433597482
  error estimate for blocks of size 2^( 5) =       0.000437621916
  error estimate for blocks of size 2^( 6) =       0.000439887500
  error estimate for blocks of size 2^( 7) =       0.000440128809

      target function =                  N/A
              le_mean =     -17.216831035159
             les_mean =     296.756040422904
             stat err =       0.000437808927
             autocorr =       1.138324840011
              std dev =       0.580318617715
             le_variance =       0.336769698066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683103516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216831035159       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216831035159       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216831035159       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216831035159       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216831686846       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216831843831       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.325674e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216831035159       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216831035159       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216831035159       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829144558       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829337109       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216831394917       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 5.838806e-14

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216831035159       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216831035159       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216831035159       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216831035159       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216831035159       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216834686049       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216823912796       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216848164128       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216838345666       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 1.450121e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8013e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1392
    reference variance = 0.221449
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1711e-01
  Total weights = 2.0000e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398186813
  error estimate for blocks of size 2^( 2) =       0.000407636732
  error estimate for blocks of size 2^( 3) =       0.000416808952
  error estimate for blocks of size 2^( 4) =       0.000422858291
  error estimate for blocks of size 2^( 5) =       0.000427309792
  error estimate for blocks of size 2^( 6) =       0.000428987692
  error estimate for blocks of size 2^( 7) =       0.000429271974

      target function =                  N/A
              le_mean =     -17.217010494348
             les_mean =     296.742555680411
             stat err =       0.000427106937
             autocorr =       1.150534124149
              std dev =       0.563121191628
             le_variance =       0.317105476461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398186813
  error estimate for blocks of size 2^( 2) =       0.000407636732
  error estimate for blocks of size 2^( 3) =       0.000416808952
  error estimate for blocks of size 2^( 4) =       0.000422858291
  error estimate for blocks of size 2^( 5) =       0.000427309792
  error estimate for blocks of size 2^( 6) =       0.000428987692
  error estimate for blocks of size 2^( 7) =       0.000429271974

      target function =                  N/A
              le_mean =     -17.217010494348
             les_mean =     296.742555680411
             stat err =       0.000427106937
             autocorr =       1.150534124148
              std dev =       0.563121191628
             le_variance =       0.317105476461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398186813
  error estimate for blocks of size 2^( 2) =       0.000407636732
  error estimate for blocks of size 2^( 3) =       0.000416808952
  error estimate for blocks of size 2^( 4) =       0.000422858291
  error estimate for blocks of size 2^( 5) =       0.000427309792
  error estimate for blocks of size 2^( 6) =       0.000428987692
  error estimate for blocks of size 2^( 7) =       0.000429271974

      target function =                  N/A
              le_mean =     -17.217010494348
             les_mean =     296.742555680411
             stat err =       0.000427106937
             autocorr =       1.150534124149
              std dev =       0.563121191628
             le_variance =       0.317105476461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317128495285
                                         uncertainty =       0.003343535791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398186813
  error estimate for blocks of size 2^( 2) =       0.000407636732
  error estimate for blocks of size 2^( 3) =       0.000416808952
  error estimate for blocks of size 2^( 4) =       0.000422858291
  error estimate for blocks of size 2^( 5) =       0.000427309792
  error estimate for blocks of size 2^( 6) =       0.000428987692
  error estimate for blocks of size 2^( 7) =       0.000429271974

      target function =                  N/A
              le_mean =     -17.217010494348
             les_mean =     296.742555680411
             stat err =       0.000427106937
             autocorr =       1.150534124150
              std dev =       0.563121191628
             le_variance =       0.317105476461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217010494348        initial  <--
     9.5367e+08     9.5367e+09             2.3257e-13       -17.217010494348
     3.8147e+09     3.8147e+10             5.8388e-14       -17.217010494348
     1.5259e+10     1.5259e+11             1.4501e-14       -17.217010494348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5964
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2702
    reference variance = 0.388926
====================================================
  Execution time = 2.0482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320566985580
                                         uncertainty =       0.003265857016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320566985580
                                         uncertainty =       0.003265857016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400381138
  error estimate for blocks of size 2^( 2) =       0.000409565155
  error estimate for blocks of size 2^( 3) =       0.000417871877
  error estimate for blocks of size 2^( 4) =       0.000423792821
  error estimate for blocks of size 2^( 5) =       0.000427394041
  error estimate for blocks of size 2^( 6) =       0.000429928326
  error estimate for blocks of size 2^( 7) =       0.000430286346

      target function =                  N/A
              le_mean =     -17.217104815820
             les_mean =     296.749308189293
             stat err =       0.000427850384
             autocorr =       1.141922507660
              std dev =       0.566224434888
             le_variance =       0.320610110664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710481582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217104815820       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217104815820       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217104815820       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217108331398       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217106530700       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109562347       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 1.570857e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217104815820       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217104815820       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217104815820       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217113627977       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217101852913       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217122079041       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217105401906       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 3.885453e-15

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217104815820       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217104815820       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217104815820       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217079537372       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217280115537       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216759043142       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217201292146       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216621690381       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218517857290       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216545715020       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218090096049       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214945147086       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216167463707       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.220725135477       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212630131729       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.220568028607       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.209523755909       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217197145825       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214811636490       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.229164142350       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.228429018695       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212240738231       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.232849706440       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.224665294037       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.200649718751       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.188765220123       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.179880437503       residual = 2.12e-01           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.247656463227       residual = 1.49e-01           smallest_sin_value = 9.94e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.12e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 6.767917e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6029e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.247
    reference variance = 0.306047
====================================================
  Execution time = 1.9897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1839e-01
  Total weights = 2.0000e+06
  Execution time = 1.8258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398991556
  error estimate for blocks of size 2^( 2) =       0.000408504814
  error estimate for blocks of size 2^( 3) =       0.000416635345
  error estimate for blocks of size 2^( 4) =       0.000422914207
  error estimate for blocks of size 2^( 5) =       0.000426379080
  error estimate for blocks of size 2^( 6) =       0.000429146706
  error estimate for blocks of size 2^( 7) =       0.000429517466

      target function =                  N/A
              le_mean =     -17.217146179756
             les_mean =     296.748510940080
             stat err =       0.000426989365
             autocorr =       1.145266891497
              std dev =       0.564259270373
             le_variance =       0.318388524201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398991556
  error estimate for blocks of size 2^( 2) =       0.000408504814
  error estimate for blocks of size 2^( 3) =       0.000416635345
  error estimate for blocks of size 2^( 4) =       0.000422914207
  error estimate for blocks of size 2^( 5) =       0.000426379080
  error estimate for blocks of size 2^( 6) =       0.000429146706
  error estimate for blocks of size 2^( 7) =       0.000429517466

      target function =                  N/A
              le_mean =     -17.217146179756
             les_mean =     296.748510940080
             stat err =       0.000426989365
             autocorr =       1.145266891496
              std dev =       0.564259270373
             le_variance =       0.318388524202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398991556
  error estimate for blocks of size 2^( 2) =       0.000408504814
  error estimate for blocks of size 2^( 3) =       0.000416635345
  error estimate for blocks of size 2^( 4) =       0.000422914207
  error estimate for blocks of size 2^( 5) =       0.000426379080
  error estimate for blocks of size 2^( 6) =       0.000429146706
  error estimate for blocks of size 2^( 7) =       0.000429517466

      target function =                  N/A
              le_mean =     -17.217146179756
             les_mean =     296.748510940080
             stat err =       0.000426989365
             autocorr =       1.145266891500
              std dev =       0.564259270373
             le_variance =       0.318388524201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318462475571
                                         uncertainty =       0.005040771994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398991556
  error estimate for blocks of size 2^( 2) =       0.000408504814
  error estimate for blocks of size 2^( 3) =       0.000416635345
  error estimate for blocks of size 2^( 4) =       0.000422914207
  error estimate for blocks of size 2^( 5) =       0.000426379080
  error estimate for blocks of size 2^( 6) =       0.000429146706
  error estimate for blocks of size 2^( 7) =       0.000429517466

      target function =                  N/A
              le_mean =     -17.217146179756
             les_mean =     296.748510940080
             stat err =       0.000426989365
             autocorr =       1.145266891499
              std dev =       0.564259270373
             le_variance =       0.318388524202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217146179756        initial  <--
     9.5367e+09     9.5367e+10             1.5709e-14       -17.217146179756
     3.8147e+10     3.8147e+11             3.8855e-15       -17.217146179756
     1.5259e+11     1.5259e+12             6.7679e-16       -17.217146179756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3248
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.16071
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330790584961
                                         uncertainty =       0.011810106868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330790584961
                                         uncertainty =       0.011810106868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406598804
  error estimate for blocks of size 2^( 2) =       0.000416024961
  error estimate for blocks of size 2^( 3) =       0.000424335909
  error estimate for blocks of size 2^( 4) =       0.000430193571
  error estimate for blocks of size 2^( 5) =       0.000433684287
  error estimate for blocks of size 2^( 6) =       0.000435152079
  error estimate for blocks of size 2^( 7) =       0.000435709820

      target function =                  N/A
              le_mean =     -17.215862416090
             les_mean =     296.716563738963
             stat err =       0.000433684939
             autocorr =       1.137670475840
              std dev =       0.575017542809
             le_variance =       0.330645174538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586241609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862416090       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862416090       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215862416090       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215862416090       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215846327478       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215880239928       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215844108070       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216235567787       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215783983122       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215819765036       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216255162888       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216139401410       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214496118031       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213960709546       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216117433445       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211106576724       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211454304315       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218916860462       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.212951146040       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.207847988914       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.209903544539       residual = 5.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217603673726       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215534144937       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.221694393279       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215208147270       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.202126399756       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.229406285960       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.192219719389       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.199710860182       residual = 5.72e-02           smallest_sin_value = 9.98e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.223856622401       residual = 4.23e-02           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.37e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.194555e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862416090       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862416090       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215862416090       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215862416090       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216031931337       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217208307865       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215960988114       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214722440288       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.220592809751       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216231557849       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217560176288       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212906224619       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213534559016       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.197706985422       residual = 5.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.244380580856       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.237718481612       residual = 7.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.203046746324       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.184563845928       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.260405802065       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.156046123793       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.170473854451       residual = 3.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.192329791755       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.350200508076       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.263086796815       residual = 3.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.207823405845       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.235691428305       residual = 8.88e-02           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -17.381185084897       residual = 4.49e+00           smallest_sin_value = 9.96e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.191032467044       residual = 2.96e-01           smallest_sin_value = 9.91e-01
davidson iteration   28 stopping due to small subspace S singular value of 7.46e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.059999e-16

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862416090       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862416090       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5740e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.208034
====================================================
  Execution time = 1.9733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1423e-01
  Total weights = 2.0000e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396375427
  error estimate for blocks of size 2^( 2) =       0.000405964678
  error estimate for blocks of size 2^( 3) =       0.000414594824
  error estimate for blocks of size 2^( 4) =       0.000420817034
  error estimate for blocks of size 2^( 5) =       0.000425067533
  error estimate for blocks of size 2^( 6) =       0.000426526212
  error estimate for blocks of size 2^( 7) =       0.000427361827

      target function =                  N/A
              le_mean =     -17.217003145640
             les_mean =     296.739424118691
             stat err =       0.000424943151
             autocorr =       1.149339207407
              std dev =       0.560559505155
             le_variance =       0.314226958820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396375427
  error estimate for blocks of size 2^( 2) =       0.000405964678
  error estimate for blocks of size 2^( 3) =       0.000414594824
  error estimate for blocks of size 2^( 4) =       0.000420817034
  error estimate for blocks of size 2^( 5) =       0.000425067533
  error estimate for blocks of size 2^( 6) =       0.000426526212
  error estimate for blocks of size 2^( 7) =       0.000427361827

      target function =                  N/A
              le_mean =     -17.217003145640
             les_mean =     296.739424118691
             stat err =       0.000424943151
             autocorr =       1.149339207406
              std dev =       0.560559505155
             le_variance =       0.314226958820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396375427
  error estimate for blocks of size 2^( 2) =       0.000405964678
  error estimate for blocks of size 2^( 3) =       0.000414594824
  error estimate for blocks of size 2^( 4) =       0.000420817034
  error estimate for blocks of size 2^( 5) =       0.000425067533
  error estimate for blocks of size 2^( 6) =       0.000426526212
  error estimate for blocks of size 2^( 7) =       0.000427361827

      target function =                  N/A
              le_mean =     -17.217003145640
             les_mean =     296.739424118691
             stat err =       0.000424943151
             autocorr =       1.149339207407
              std dev =       0.560559505155
             le_variance =       0.314226958820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313926369577
                                         uncertainty =       0.002991144621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396375427
  error estimate for blocks of size 2^( 2) =       0.000405964678
  error estimate for blocks of size 2^( 3) =       0.000414594824
  error estimate for blocks of size 2^( 4) =       0.000420817034
  error estimate for blocks of size 2^( 5) =       0.000425067533
  error estimate for blocks of size 2^( 6) =       0.000426526212
  error estimate for blocks of size 2^( 7) =       0.000427361827

      target function =                  N/A
              le_mean =     -17.217003145640
             les_mean =     296.739424118691
             stat err =       0.000424943151
             autocorr =       1.149339207407
              std dev =       0.560559505155
             le_variance =       0.314226958820


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217003145640        initial  <--
     9.5367e+10     9.5367e+11             2.1946e-15       -17.217003145640
     3.8147e+11     3.8147e+12             4.0600e-16       -17.217003145640
     1.5259e+12     1.5259e+13             0.0000e+00       -17.217003145640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9106
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2866
    reference variance = 0.143339
====================================================
  Execution time = 2.0001e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1226e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312198088751
                                         uncertainty =       0.002827800060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312198088751
                                         uncertainty =       0.002827800060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395131535
  error estimate for blocks of size 2^( 2) =       0.000404663309
  error estimate for blocks of size 2^( 3) =       0.000413131559
  error estimate for blocks of size 2^( 4) =       0.000419398037
  error estimate for blocks of size 2^( 5) =       0.000424000901
  error estimate for blocks of size 2^( 6) =       0.000425495145
  error estimate for blocks of size 2^( 7) =       0.000427864634

      target function =                  N/A
              le_mean =     -17.217411490250
             les_mean =     296.751516128330
             stat err =       0.000424189679
             autocorr =       1.152489061451
              std dev =       0.558800375693
             le_variance =       0.312257859875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721741149025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217411490250       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217411490250       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217411490250       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218224416344       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217662855460       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216877119004       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212609767452       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.209986571394       residual = 8.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.221131839365       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217862861991       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.243646403555       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.203132959605       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200233736278       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.263813756852       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.238165232316       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.236306907611       residual = 5.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.242589252987       residual = 9.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.196962123279       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217538364911       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.044623873331       residual = 4.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.400668053570       residual = 5.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.137527707920       residual = 9.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.740565972807       residual = 3.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.790298683904       residual = 2.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.226227199902       residual = 6.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.495374357694       residual = 8.04e+01           smallest_sin_value = 9.99e-01
davidson iteration   26 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 2.149253e-17

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217411490250       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217411490250       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217411490250       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.219951806541       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217411490250       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218823714150       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214523461669       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.199721941459       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200324167938       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.194450395067       residual = 7.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.195618757532       residual = 6.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.164907421654       residual = 4.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.171574423091       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.158331631336       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.197278353164       residual = 5.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.248210338547       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.157588762827       residual = 5.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.163216634164       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.052253348094       residual = 3.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.396775931469       residual = 4.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.194659762221       residual = 1.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.439030402863       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.015999617543       residual = 8.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.408549551658       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.408456035240       residual = 2.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.800967925839       residual = 6.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.833258823091       residual = 2.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -14.571610107782       residual = 1.08e+03           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.922194008256       residual = 7.05e+01           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 5.373133e-18

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217411490250       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217411490250       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217411490250       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217411490250       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217585493857       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217423203563       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.220508342142       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.401665886679       residual = 5.39e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.398479845975       residual = 5.24e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.979668872818       residual = 9.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.106168847306       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.329055496839       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.174128154820       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.373566907371       residual = 3.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.946380210115       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.220565453453       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.607283416086       residual = 2.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.532829303311       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.658788931420       residual = 3.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.520976525136       residual = 8.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.604447852005       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -14.943910660853       residual = 7.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -21.222529540134       residual = 2.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.432916897623       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.162168523618       residual = 3.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -18.625105455464       residual = 4.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -14.044299443000       residual = 3.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -14.874361572137       residual = 8.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.772927571541       residual = 7.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -13.375131560674       residual = 3.57e+03           smallest_sin_value = 9.94e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 1.343283e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5506e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1209
    reference variance = 0.441288
====================================================
  Execution time = 1.9581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2164e-01
  Total weights = 2.0000e+06
  Execution time = 1.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401020835
  error estimate for blocks of size 2^( 2) =       0.000410361453
  error estimate for blocks of size 2^( 3) =       0.000418538992
  error estimate for blocks of size 2^( 4) =       0.000424401158
  error estimate for blocks of size 2^( 5) =       0.000428179349
  error estimate for blocks of size 2^( 6) =       0.000431290790
  error estimate for blocks of size 2^( 7) =       0.000433125330

      target function =                  N/A
              le_mean =     -17.216623422196
             les_mean =     296.733757321248
             stat err =       0.000429249157
             autocorr =       1.145737234695
              std dev =       0.567129103774
             le_variance =       0.321635420348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401020835
  error estimate for blocks of size 2^( 2) =       0.000410361453
  error estimate for blocks of size 2^( 3) =       0.000418538992
  error estimate for blocks of size 2^( 4) =       0.000424401158
  error estimate for blocks of size 2^( 5) =       0.000428179349
  error estimate for blocks of size 2^( 6) =       0.000431290790
  error estimate for blocks of size 2^( 7) =       0.000433125330

      target function =                  N/A
              le_mean =     -17.216623422196
             les_mean =     296.733757321248
             stat err =       0.000429249157
             autocorr =       1.145737234698
              std dev =       0.567129103774
             le_variance =       0.321635420348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401020835
  error estimate for blocks of size 2^( 2) =       0.000410361453
  error estimate for blocks of size 2^( 3) =       0.000418538992
  error estimate for blocks of size 2^( 4) =       0.000424401158
  error estimate for blocks of size 2^( 5) =       0.000428179349
  error estimate for blocks of size 2^( 6) =       0.000431290790
  error estimate for blocks of size 2^( 7) =       0.000433125330

      target function =                  N/A
              le_mean =     -17.216623422196
             les_mean =     296.733757321248
             stat err =       0.000429249157
             autocorr =       1.145737234695
              std dev =       0.567129103774
             le_variance =       0.321635420348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321528265971
                                         uncertainty =       0.005235760520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401020835
  error estimate for blocks of size 2^( 2) =       0.000410361453
  error estimate for blocks of size 2^( 3) =       0.000418538992
  error estimate for blocks of size 2^( 4) =       0.000424401158
  error estimate for blocks of size 2^( 5) =       0.000428179349
  error estimate for blocks of size 2^( 6) =       0.000431290790
  error estimate for blocks of size 2^( 7) =       0.000433125330

      target function =                  N/A
              le_mean =     -17.216623422196
             les_mean =     296.733757321248
             stat err =       0.000429249157
             autocorr =       1.145737234695
              std dev =       0.567129103774
             le_variance =       0.321635420348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216623422196        initial  <--
     9.5367e+11     9.5367e+12             2.1493e-17       -17.216623422196
     3.8147e+12     3.8147e+13             5.3731e-18       -17.216623422196
     1.5259e+13     1.5259e+14             1.3433e-18       -17.216623422196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7588
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1385
    reference variance = 0.145245
====================================================
  Execution time = 1.9924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.5548e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355626685702
                                         uncertainty =       0.035827207775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355626685702
                                         uncertainty =       0.035827207775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421595208
  error estimate for blocks of size 2^( 2) =       0.000430441079
  error estimate for blocks of size 2^( 3) =       0.000438291394
  error estimate for blocks of size 2^( 4) =       0.000443685884
  error estimate for blocks of size 2^( 5) =       0.000447406364
  error estimate for blocks of size 2^( 6) =       0.000449856267
  error estimate for blocks of size 2^( 7) =       0.000449403701

      target function =                  N/A
              le_mean =     -17.217531792742
             les_mean =     296.798885894964
             stat err =       0.000447588054
             autocorr =       1.127108285212
              std dev =       0.596225660827
             le_variance =       0.355485038629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721753179274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217531792742       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5505e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.181462
====================================================
  Execution time = 1.9869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1467e-01
  Total weights = 2.0000e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396657189
  error estimate for blocks of size 2^( 2) =       0.000406447647
  error estimate for blocks of size 2^( 3) =       0.000414819790
  error estimate for blocks of size 2^( 4) =       0.000421503820
  error estimate for blocks of size 2^( 5) =       0.000425719838
  error estimate for blocks of size 2^( 6) =       0.000427332516
  error estimate for blocks of size 2^( 7) =       0.000428234827

      target function =                  N/A
              le_mean =     -17.216122390639
             les_mean =     296.709543863611
             stat err =       0.000425697750
             autocorr =       1.151786675357
              std dev =       0.560957976571
             le_variance =       0.314673851478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396657189
  error estimate for blocks of size 2^( 2) =       0.000406447647
  error estimate for blocks of size 2^( 3) =       0.000414819790
  error estimate for blocks of size 2^( 4) =       0.000421503820
  error estimate for blocks of size 2^( 5) =       0.000425719838
  error estimate for blocks of size 2^( 6) =       0.000427332516
  error estimate for blocks of size 2^( 7) =       0.000428234827

      target function =                  N/A
              le_mean =     -17.216122390639
             les_mean =     296.709543863611
             stat err =       0.000425697750
             autocorr =       1.151786675357
              std dev =       0.560957976571
             le_variance =       0.314673851478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396657189
  error estimate for blocks of size 2^( 2) =       0.000406447647
  error estimate for blocks of size 2^( 3) =       0.000414819790
  error estimate for blocks of size 2^( 4) =       0.000421503820
  error estimate for blocks of size 2^( 5) =       0.000425719838
  error estimate for blocks of size 2^( 6) =       0.000427332516
  error estimate for blocks of size 2^( 7) =       0.000428234827

      target function =                  N/A
              le_mean =     -17.216122390639
             les_mean =     296.709543863611
             stat err =       0.000425697750
             autocorr =       1.151786675357
              std dev =       0.560957976571
             le_variance =       0.314673851478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314675577124
                                         uncertainty =       0.003137637861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396657189
  error estimate for blocks of size 2^( 2) =       0.000406447647
  error estimate for blocks of size 2^( 3) =       0.000414819790
  error estimate for blocks of size 2^( 4) =       0.000421503820
  error estimate for blocks of size 2^( 5) =       0.000425719838
  error estimate for blocks of size 2^( 6) =       0.000427332516
  error estimate for blocks of size 2^( 7) =       0.000428234827

      target function =                  N/A
              le_mean =     -17.216122390639
             les_mean =     296.709543863611
             stat err =       0.000425697750
             autocorr =       1.151786675357
              std dev =       0.560957976571
             le_variance =       0.314673851478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216122390639        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216122390639
     3.8147e+13     3.8147e+14             0.0000e+00       -17.216122390639
     1.5259e+14     1.5259e+15             0.0000e+00       -17.216122390639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0580
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.225665
====================================================
  Execution time = 1.9956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321006743408
                                         uncertainty =       0.005372479456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321006743408
                                         uncertainty =       0.005372479456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400607351
  error estimate for blocks of size 2^( 2) =       0.000410511788
  error estimate for blocks of size 2^( 3) =       0.000418850205
  error estimate for blocks of size 2^( 4) =       0.000424981728
  error estimate for blocks of size 2^( 5) =       0.000428710728
  error estimate for blocks of size 2^( 6) =       0.000429353110
  error estimate for blocks of size 2^( 7) =       0.000429053937

      target function =                  N/A
              le_mean =     -17.216336877986
             les_mean =     296.723227835712
             stat err =       0.000428024876
             autocorr =       1.141563806105
              std dev =       0.566544349458
             le_variance =       0.320972499903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633687799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336877986       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336877986       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216336877986       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216336877986       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 3.067942e-19

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336877986       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336877986       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336877986       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336877986       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216336877986       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.597510231025       residual = 4.79e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.957047521230       residual = 5.76e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -14.822612212580       residual = 1.03e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -24.206465735194       residual = 7.53e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 1.917464e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5527e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.262352
====================================================
  Execution time = 2.2293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1647e-01
  Total weights = 2.0000e+06
  Execution time = 1.8177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397789501
  error estimate for blocks of size 2^( 2) =       0.000407416565
  error estimate for blocks of size 2^( 3) =       0.000416383789
  error estimate for blocks of size 2^( 4) =       0.000422401000
  error estimate for blocks of size 2^( 5) =       0.000425681714
  error estimate for blocks of size 2^( 6) =       0.000427689157
  error estimate for blocks of size 2^( 7) =       0.000428421786

      target function =                  N/A
              le_mean =     -17.216180667563
             les_mean =     296.713349593540
             stat err =       0.000426048414
             autocorr =       1.147126400193
              std dev =       0.562559306744
             le_variance =       0.316472973604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397789501
  error estimate for blocks of size 2^( 2) =       0.000407416565
  error estimate for blocks of size 2^( 3) =       0.000416383789
  error estimate for blocks of size 2^( 4) =       0.000422401000
  error estimate for blocks of size 2^( 5) =       0.000425681714
  error estimate for blocks of size 2^( 6) =       0.000427689157
  error estimate for blocks of size 2^( 7) =       0.000428421786

      target function =                  N/A
              le_mean =     -17.216180667563
             les_mean =     296.713349593540
             stat err =       0.000426048414
             autocorr =       1.147126400193
              std dev =       0.562559306744
             le_variance =       0.316472973604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397789501
  error estimate for blocks of size 2^( 2) =       0.000407416565
  error estimate for blocks of size 2^( 3) =       0.000416383789
  error estimate for blocks of size 2^( 4) =       0.000422401000
  error estimate for blocks of size 2^( 5) =       0.000425681714
  error estimate for blocks of size 2^( 6) =       0.000427689157
  error estimate for blocks of size 2^( 7) =       0.000428421786

      target function =                  N/A
              le_mean =     -17.216180667563
             les_mean =     296.713349593540
             stat err =       0.000426048414
             autocorr =       1.147126400193
              std dev =       0.562559306744
             le_variance =       0.316472973604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492548165
                                         uncertainty =       0.002769938438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397789501
  error estimate for blocks of size 2^( 2) =       0.000407416565
  error estimate for blocks of size 2^( 3) =       0.000416383789
  error estimate for blocks of size 2^( 4) =       0.000422401000
  error estimate for blocks of size 2^( 5) =       0.000425681714
  error estimate for blocks of size 2^( 6) =       0.000427689157
  error estimate for blocks of size 2^( 7) =       0.000428421786

      target function =                  N/A
              le_mean =     -17.216180667563
             les_mean =     296.713349593540
             stat err =       0.000426048414
             autocorr =       1.147126400193
              std dev =       0.562559306744
             le_variance =       0.316472973604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216180667563        initial  <--
     9.5367e+13     9.5367e+14             3.0679e-19       -17.216180667563
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216180667563
     1.5259e+15     1.5259e+16             1.9175e-20       -17.216180667563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4605
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.134548
====================================================
  Execution time = 2.0064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320502861585
                                         uncertainty =       0.004474425349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320502861585
                                         uncertainty =       0.004474425349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400268604
  error estimate for blocks of size 2^( 2) =       0.000409764715
  error estimate for blocks of size 2^( 3) =       0.000417998848
  error estimate for blocks of size 2^( 4) =       0.000423814540
  error estimate for blocks of size 2^( 5) =       0.000427266481
  error estimate for blocks of size 2^( 6) =       0.000429351591
  error estimate for blocks of size 2^( 7) =       0.000430289760

      target function =                  N/A
              le_mean =     -17.217116739078
             les_mean =     296.749538556843
             stat err =       0.000427680593
             autocorr =       1.141658029200
              std dev =       0.566065287777
             le_variance =       0.320429910026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711673908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116739078       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6205e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.295768
====================================================
  Execution time = 1.9846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1761e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398501772
  error estimate for blocks of size 2^( 2) =       0.000407992926
  error estimate for blocks of size 2^( 3) =       0.000416769363
  error estimate for blocks of size 2^( 4) =       0.000422934615
  error estimate for blocks of size 2^( 5) =       0.000426474604
  error estimate for blocks of size 2^( 6) =       0.000427644969
  error estimate for blocks of size 2^( 7) =       0.000427670370

      target function =                  N/A
              le_mean =     -17.216491308026
             les_mean =     296.725180125278
             stat err =       0.000426181140
             autocorr =       1.143741656251
              std dev =       0.563566610747
             le_variance =       0.317607324749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398501772
  error estimate for blocks of size 2^( 2) =       0.000407992926
  error estimate for blocks of size 2^( 3) =       0.000416769363
  error estimate for blocks of size 2^( 4) =       0.000422934615
  error estimate for blocks of size 2^( 5) =       0.000426474604
  error estimate for blocks of size 2^( 6) =       0.000427644969
  error estimate for blocks of size 2^( 7) =       0.000427670370

      target function =                  N/A
              le_mean =     -17.216491308026
             les_mean =     296.725180125278
             stat err =       0.000426181140
             autocorr =       1.143741656251
              std dev =       0.563566610747
             le_variance =       0.317607324749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398501772
  error estimate for blocks of size 2^( 2) =       0.000407992926
  error estimate for blocks of size 2^( 3) =       0.000416769363
  error estimate for blocks of size 2^( 4) =       0.000422934615
  error estimate for blocks of size 2^( 5) =       0.000426474604
  error estimate for blocks of size 2^( 6) =       0.000427644969
  error estimate for blocks of size 2^( 7) =       0.000427670370

      target function =                  N/A
              le_mean =     -17.216491308026
             les_mean =     296.725180125278
             stat err =       0.000426181140
             autocorr =       1.143741656251
              std dev =       0.563566610747
             le_variance =       0.317607324749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317573953598
                                         uncertainty =       0.002337783985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398501772
  error estimate for blocks of size 2^( 2) =       0.000407992926
  error estimate for blocks of size 2^( 3) =       0.000416769363
  error estimate for blocks of size 2^( 4) =       0.000422934615
  error estimate for blocks of size 2^( 5) =       0.000426474604
  error estimate for blocks of size 2^( 6) =       0.000427644969
  error estimate for blocks of size 2^( 7) =       0.000427670370

      target function =                  N/A
              le_mean =     -17.216491308026
             les_mean =     296.725180125278
             stat err =       0.000426181140
             autocorr =       1.143741656251
              std dev =       0.563566610747
             le_variance =       0.317607324749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216491308026        initial  <--
     9.5367e+14     9.5367e+15             0.0000e+00       -17.216491308026
     3.8147e+15     3.8147e+16             0.0000e+00       -17.216491308026
     1.5259e+16     1.5259e+17             0.0000e+00       -17.216491308026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9970
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1416
    reference variance = 0.337266
====================================================
  Execution time = 1.9979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1992e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319918767007
                                         uncertainty =       0.003541617630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319918767007
                                         uncertainty =       0.003541617630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399951823
  error estimate for blocks of size 2^( 2) =       0.000409739415
  error estimate for blocks of size 2^( 3) =       0.000417587988
  error estimate for blocks of size 2^( 4) =       0.000424090129
  error estimate for blocks of size 2^( 5) =       0.000426855885
  error estimate for blocks of size 2^( 6) =       0.000429761832
  error estimate for blocks of size 2^( 7) =       0.000431802326

      target function =                  N/A
              le_mean =     -17.217029595251
             les_mean =     296.746030844850
             stat err =       0.000428127543
             autocorr =       1.145858460590
              std dev =       0.565617292058
             le_variance =       0.319922921075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702959525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217029595251       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5443e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1837
    reference variance = 0.218825
====================================================
  Execution time = 1.9618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1581e-01
  Total weights = 2.0000e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397371780
  error estimate for blocks of size 2^( 2) =       0.000406867939
  error estimate for blocks of size 2^( 3) =       0.000415325724
  error estimate for blocks of size 2^( 4) =       0.000421610600
  error estimate for blocks of size 2^( 5) =       0.000424843115
  error estimate for blocks of size 2^( 6) =       0.000426090655
  error estimate for blocks of size 2^( 7) =       0.000427383219

      target function =                  N/A
              le_mean =     -17.216469432682
             les_mean =     296.722628231102
             stat err =       0.000424981897
             autocorr =       1.143791380569
              std dev =       0.561968560084
             le_variance =       0.315808662522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397371780
  error estimate for blocks of size 2^( 2) =       0.000406867939
  error estimate for blocks of size 2^( 3) =       0.000415325724
  error estimate for blocks of size 2^( 4) =       0.000421610600
  error estimate for blocks of size 2^( 5) =       0.000424843115
  error estimate for blocks of size 2^( 6) =       0.000426090655
  error estimate for blocks of size 2^( 7) =       0.000427383219

      target function =                  N/A
              le_mean =     -17.216469432682
             les_mean =     296.722628231102
             stat err =       0.000424981897
             autocorr =       1.143791380569
              std dev =       0.561968560084
             le_variance =       0.315808662522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397371780
  error estimate for blocks of size 2^( 2) =       0.000406867939
  error estimate for blocks of size 2^( 3) =       0.000415325724
  error estimate for blocks of size 2^( 4) =       0.000421610600
  error estimate for blocks of size 2^( 5) =       0.000424843115
  error estimate for blocks of size 2^( 6) =       0.000426090655
  error estimate for blocks of size 2^( 7) =       0.000427383219

      target function =                  N/A
              le_mean =     -17.216469432682
             les_mean =     296.722628231102
             stat err =       0.000424981897
             autocorr =       1.143791380569
              std dev =       0.561968560084
             le_variance =       0.315808662522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315834554399
                                         uncertainty =       0.003133884816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397371780
  error estimate for blocks of size 2^( 2) =       0.000406867939
  error estimate for blocks of size 2^( 3) =       0.000415325724
  error estimate for blocks of size 2^( 4) =       0.000421610600
  error estimate for blocks of size 2^( 5) =       0.000424843115
  error estimate for blocks of size 2^( 6) =       0.000426090655
  error estimate for blocks of size 2^( 7) =       0.000427383219

      target function =                  N/A
              le_mean =     -17.216469432682
             les_mean =     296.722628231102
             stat err =       0.000424981897
             autocorr =       1.143791380569
              std dev =       0.561968560084
             le_variance =       0.315808662522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216469432682        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -17.216469432682
     3.8147e+16     3.8147e+17             0.0000e+00       -17.216469432682
     1.5259e+17     1.5259e+18             0.0000e+00       -17.216469432682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7795
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.20674
====================================================
  Execution time = 1.9838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2219e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322289822754
                                         uncertainty =       0.005169731968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322289822754
                                         uncertainty =       0.005169731968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401368449
  error estimate for blocks of size 2^( 2) =       0.000410864367
  error estimate for blocks of size 2^( 3) =       0.000419425455
  error estimate for blocks of size 2^( 4) =       0.000425757755
  error estimate for blocks of size 2^( 5) =       0.000429494548
  error estimate for blocks of size 2^( 6) =       0.000431334888
  error estimate for blocks of size 2^( 7) =       0.000433534434

      target function =                  N/A
              le_mean =     -17.217477448917
             les_mean =     296.763722806571
             stat err =       0.000430030406
             autocorr =       1.147920650519
              std dev =       0.567620704084
             le_variance =       0.322193263704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721747744892e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217477448917       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217477448917       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217477448917       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217477448917       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5390e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2608
    reference variance = 0.19636
====================================================
  Execution time = 2.0105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1861e-01
  Total weights = 2.0000e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399128683
  error estimate for blocks of size 2^( 2) =       0.000409011142
  error estimate for blocks of size 2^( 3) =       0.000417194854
  error estimate for blocks of size 2^( 4) =       0.000424343302
  error estimate for blocks of size 2^( 5) =       0.000428488112
  error estimate for blocks of size 2^( 6) =       0.000430704091
  error estimate for blocks of size 2^( 7) =       0.000430779297

      target function =                  N/A
              le_mean =     -17.217518051250
             les_mean =     296.761535097308
             stat err =       0.000428578700
             autocorr =       1.153015879699
              std dev =       0.564453196905
             le_variance =       0.318607411497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399128683
  error estimate for blocks of size 2^( 2) =       0.000409011142
  error estimate for blocks of size 2^( 3) =       0.000417194854
  error estimate for blocks of size 2^( 4) =       0.000424343302
  error estimate for blocks of size 2^( 5) =       0.000428488112
  error estimate for blocks of size 2^( 6) =       0.000430704091
  error estimate for blocks of size 2^( 7) =       0.000430779297

      target function =                  N/A
              le_mean =     -17.217518051250
             les_mean =     296.761535097308
             stat err =       0.000428578700
             autocorr =       1.153015879699
              std dev =       0.564453196905
             le_variance =       0.318607411497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399128683
  error estimate for blocks of size 2^( 2) =       0.000409011142
  error estimate for blocks of size 2^( 3) =       0.000417194854
  error estimate for blocks of size 2^( 4) =       0.000424343302
  error estimate for blocks of size 2^( 5) =       0.000428488112
  error estimate for blocks of size 2^( 6) =       0.000430704091
  error estimate for blocks of size 2^( 7) =       0.000430779297

      target function =                  N/A
              le_mean =     -17.217518051250
             les_mean =     296.761535097308
             stat err =       0.000428578700
             autocorr =       1.153015879699
              std dev =       0.564453196905
             le_variance =       0.318607411497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318663406979
                                         uncertainty =       0.004300465234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399128683
  error estimate for blocks of size 2^( 2) =       0.000409011142
  error estimate for blocks of size 2^( 3) =       0.000417194854
  error estimate for blocks of size 2^( 4) =       0.000424343302
  error estimate for blocks of size 2^( 5) =       0.000428488112
  error estimate for blocks of size 2^( 6) =       0.000430704091
  error estimate for blocks of size 2^( 7) =       0.000430779297

      target function =                  N/A
              le_mean =     -17.217518051250
             les_mean =     296.761535097308
             stat err =       0.000428578700
             autocorr =       1.153015879699
              std dev =       0.564453196905
             le_variance =       0.318607411497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217518051250        initial  <--
     9.5367e+16     9.5367e+17             0.0000e+00       -17.217518051250
     3.8147e+17     3.8147e+18             0.0000e+00       -17.217518051250
     1.5259e+18     1.5259e+19             0.0000e+00       -17.217518051250

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3322
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.162
    reference variance = 0.149874
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994003710
                                         uncertainty =       0.005899342986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994003710
                                         uncertainty =       0.005899342986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401875976
  error estimate for blocks of size 2^( 2) =       0.000411757470
  error estimate for blocks of size 2^( 3) =       0.000419586088
  error estimate for blocks of size 2^( 4) =       0.000425544068
  error estimate for blocks of size 2^( 5) =       0.000429516533
  error estimate for blocks of size 2^( 6) =       0.000430248935
  error estimate for blocks of size 2^( 7) =       0.000429758769

      target function =                  N/A
              le_mean =     -17.217416345658
             les_mean =     296.762434058951
             stat err =       0.000428767076
             autocorr =       1.138305328687
              std dev =       0.568338456124
             le_variance =       0.323008600709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721741634566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217416345658       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5583e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.173173
====================================================
  Execution time = 1.9780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1974e-01
  Total weights = 2.0000e+06
  Execution time = 1.8156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399834450
  error estimate for blocks of size 2^( 2) =       0.000409540991
  error estimate for blocks of size 2^( 3) =       0.000418207405
  error estimate for blocks of size 2^( 4) =       0.000425198564
  error estimate for blocks of size 2^( 5) =       0.000429650033
  error estimate for blocks of size 2^( 6) =       0.000431435177
  error estimate for blocks of size 2^( 7) =       0.000431950380

      target function =                  N/A
              le_mean =     -17.216737808712
             les_mean =     296.735795788326
             stat err =       0.000429558539
             autocorr =       1.154208563057
              std dev =       0.565451301406
             le_variance =       0.319735174262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399834450
  error estimate for blocks of size 2^( 2) =       0.000409540991
  error estimate for blocks of size 2^( 3) =       0.000418207405
  error estimate for blocks of size 2^( 4) =       0.000425198564
  error estimate for blocks of size 2^( 5) =       0.000429650033
  error estimate for blocks of size 2^( 6) =       0.000431435177
  error estimate for blocks of size 2^( 7) =       0.000431950380

      target function =                  N/A
              le_mean =     -17.216737808712
             les_mean =     296.735795788326
             stat err =       0.000429558539
             autocorr =       1.154208563057
              std dev =       0.565451301406
             le_variance =       0.319735174262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399834450
  error estimate for blocks of size 2^( 2) =       0.000409540991
  error estimate for blocks of size 2^( 3) =       0.000418207405
  error estimate for blocks of size 2^( 4) =       0.000425198564
  error estimate for blocks of size 2^( 5) =       0.000429650033
  error estimate for blocks of size 2^( 6) =       0.000431435177
  error estimate for blocks of size 2^( 7) =       0.000431950380

      target function =                  N/A
              le_mean =     -17.216737808712
             les_mean =     296.735795788326
             stat err =       0.000429558539
             autocorr =       1.154208563057
              std dev =       0.565451301406
             le_variance =       0.319735174262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319775006819
                                         uncertainty =       0.004461384935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399834450
  error estimate for blocks of size 2^( 2) =       0.000409540991
  error estimate for blocks of size 2^( 3) =       0.000418207405
  error estimate for blocks of size 2^( 4) =       0.000425198564
  error estimate for blocks of size 2^( 5) =       0.000429650033
  error estimate for blocks of size 2^( 6) =       0.000431435177
  error estimate for blocks of size 2^( 7) =       0.000431950380

      target function =                  N/A
              le_mean =     -17.216737808712
             les_mean =     296.735795788326
             stat err =       0.000429558539
             autocorr =       1.154208563057
              std dev =       0.565451301406
             le_variance =       0.319735174262


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216737808712        initial  <--
     9.5367e+17     9.5367e+18             0.0000e+00       -17.216737808712
     3.8147e+18     3.8147e+19             0.0000e+00       -17.216737808712
     1.5259e+19     1.5259e+20             0.0000e+00       -17.216737808712

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9246
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1937
    reference variance = 0.114348
====================================================
  Execution time = 1.9923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321540203028
                                         uncertainty =       0.008099228067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321540203028
                                         uncertainty =       0.008099228067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401012243
  error estimate for blocks of size 2^( 2) =       0.000410675354
  error estimate for blocks of size 2^( 3) =       0.000420048125
  error estimate for blocks of size 2^( 4) =       0.000426061461
  error estimate for blocks of size 2^( 5) =       0.000429552468
  error estimate for blocks of size 2^( 6) =       0.000432116255
  error estimate for blocks of size 2^( 7) =       0.000433503459

      target function =                  N/A
              le_mean =     -17.216899156051
             les_mean =     296.743238026689
             stat err =       0.000430308411
             autocorr =       1.151448202085
              std dev =       0.567116952563
             le_variance =       0.321621637884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689915605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216899156051       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216899156051       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216899156051       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 2.949727e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216899156051       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216899156051       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216899156051       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 7.374318e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216899156051       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216899156051       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216899156051       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 6.233036e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5477e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1775
    reference variance = 0.163642
====================================================
  Execution time = 1.9674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1813e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398828296
  error estimate for blocks of size 2^( 2) =       0.000408200890
  error estimate for blocks of size 2^( 3) =       0.000416885706
  error estimate for blocks of size 2^( 4) =       0.000423305661
  error estimate for blocks of size 2^( 5) =       0.000426908333
  error estimate for blocks of size 2^( 6) =       0.000428583725
  error estimate for blocks of size 2^( 7) =       0.000429868581

      target function =                  N/A
              le_mean =     -17.217212163215
             les_mean =     296.750522532865
             stat err =       0.000427166575
             autocorr =       1.147156315430
              std dev =       0.564028384714
             le_variance =       0.318128018763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398828296
  error estimate for blocks of size 2^( 2) =       0.000408200890
  error estimate for blocks of size 2^( 3) =       0.000416885706
  error estimate for blocks of size 2^( 4) =       0.000423305661
  error estimate for blocks of size 2^( 5) =       0.000426908333
  error estimate for blocks of size 2^( 6) =       0.000428583725
  error estimate for blocks of size 2^( 7) =       0.000429868581

      target function =                  N/A
              le_mean =     -17.217212163215
             les_mean =     296.750522532865
             stat err =       0.000427166575
             autocorr =       1.147156315430
              std dev =       0.564028384714
             le_variance =       0.318128018763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398828296
  error estimate for blocks of size 2^( 2) =       0.000408200890
  error estimate for blocks of size 2^( 3) =       0.000416885706
  error estimate for blocks of size 2^( 4) =       0.000423305661
  error estimate for blocks of size 2^( 5) =       0.000426908333
  error estimate for blocks of size 2^( 6) =       0.000428583725
  error estimate for blocks of size 2^( 7) =       0.000429868581

      target function =                  N/A
              le_mean =     -17.217212163215
             les_mean =     296.750522532865
             stat err =       0.000427166575
             autocorr =       1.147156315430
              std dev =       0.564028384714
             le_variance =       0.318128018763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318164230889
                                         uncertainty =       0.003162120779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398828296
  error estimate for blocks of size 2^( 2) =       0.000408200890
  error estimate for blocks of size 2^( 3) =       0.000416885706
  error estimate for blocks of size 2^( 4) =       0.000423305661
  error estimate for blocks of size 2^( 5) =       0.000426908333
  error estimate for blocks of size 2^( 6) =       0.000428583725
  error estimate for blocks of size 2^( 7) =       0.000429868581

      target function =                  N/A
              le_mean =     -17.217212163215
             les_mean =     296.750522532865
             stat err =       0.000427166575
             autocorr =       1.147156315430
              std dev =       0.564028384714
             le_variance =       0.318128018763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217212163215        initial  <--
     9.5367e+18     9.5367e+19             2.9497e-24       -17.217212163215
     3.8147e+19     3.8147e+20             7.3743e-25       -17.217212163215
     1.5259e+20     1.5259e+21             6.2330e-25       -17.217212163215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8287
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.926787e-01 1 1  ON 0
 uu_1                 2.957114e-02 1 1  ON 1
 uu_2                -6.705151e-02 1 1  ON 2
 uu_3                -1.244601e-01 1 1  ON 3
 uu_4                -1.613597e-01 1 1  ON 4
 uu_5                -1.736352e-01 1 1  ON 5
 uu_6                -1.609574e-01 1 1  ON 6
 uu_7                -1.144692e-01 1 1  ON 7
 uu_8                -3.693560e-02 1 1  ON 8
 uu_9                 1.610771e-01 1 1  ON 9
 ud_0                 3.514147e-01 1 1  ON 10
 ud_1                 9.219724e-02 1 1  ON 11
 ud_2                -1.921050e-02 1 1  ON 12
 ud_3                -8.213070e-02 1 1  ON 13
 ud_4                -1.322117e-01 1 1  ON 14
 ud_5                -1.686002e-01 1 1  ON 15
 ud_6                -1.801049e-01 1 1  ON 16
 ud_7                -1.597582e-01 1 1  ON 17
 ud_8                -1.006737e-01 1 1  ON 18
 ud_9                -8.541877e-03 1 1  ON 19
 eO_0                -9.325869e-01 1 1  ON 20
 eO_1                -6.070034e-01 1 1  ON 21
 eO_2                -1.880982e-01 1 1  ON 22
 eO_3                 8.574020e-02 1 1  ON 23
 eO_4                 2.107354e-01 1 1  ON 24
 eO_5                 2.944037e-01 1 1  ON 25
 eO_6                 3.332553e-01 1 1  ON 26
 eO_7                 5.013736e-01 1 1  ON 27
 eO_8                 1.948403e-01 1 1  ON 28
 eO_9                 6.147062e-02 1 1  ON 29
eH1_0                -2.116332e-01 1 1  ON 30
eH1_1                -1.330353e-01 1 1  ON 31
eH1_2                -9.090391e-02 1 1  ON 32
eH1_3                -5.306217e-02 1 1  ON 33
eH1_4                -7.644718e-03 1 1  ON 34
eH1_5                 4.135458e-03 1 1  ON 35
eH1_6                 4.139668e-02 1 1  ON 36
eH1_7                 6.344449e-02 1 1  ON 37
eH1_8                 1.797007e-01 1 1  ON 38
eH1_9                 1.211156e-01 1 1  ON 39
eH2_0                -2.075214e-01 1 1  ON 40
eH2_1                -1.284359e-01 1 1  ON 41
eH2_2                -8.640157e-02 1 1  ON 42
eH2_3                -4.875582e-02 1 1  ON 43
eH2_4                -2.702398e-03 1 1  ON 44
eH2_5                 8.938886e-03 1 1  ON 45
eH2_6                 4.728776e-02 1 1  ON 46
eH2_7                 4.689368e-02 1 1  ON 47
eH2_8                 1.974056e-01 1 1  ON 48
eH2_9                 1.202816e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4311e+01 secs
  Total Execution time = 2.2178e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
