Rank =    0  Free Memory = 88969 MB
Rank =    1  Free Memory = 88969 MB
Rank =    2  Free Memory = 88969 MB
Rank =    3  Free Memory = 88969 MB
Rank =    4  Free Memory = 88969 MB
Rank =    5  Free Memory = 88969 MB
Rank =    6  Free Memory = 88969 MB
Rank =    7  Free Memory = 88969 MB
Rank =    8  Free Memory = 88969 MB
Rank =    9  Free Memory = 88969 MB
Rank =   10  Free Memory = 88969 MB
Rank =   11  Free Memory = 88969 MB
Rank =   12  Free Memory = 88969 MB
Rank =   13  Free Memory = 88969 MB
Rank =   14  Free Memory = 88968 MB
Rank =   15  Free Memory = 88954 MB
Rank =   16  Free Memory = 88954 MB
Rank =   17  Free Memory = 88954 MB
Rank =   18  Free Memory = 88954 MB
Rank =   19  Free Memory = 88954 MB
Rank =   20  Free Memory = 88954 MB
Rank =   21  Free Memory = 88954 MB
Rank =   22  Free Memory = 88954 MB
Rank =   23  Free Memory = 88954 MB
Rank =   24  Free Memory = 88954 MB
Rank =   25  Free Memory = 88954 MB
Rank =   26  Free Memory = 88954 MB
Rank =   27  Free Memory = 88954 MB
Rank =   28  Free Memory = 88954 MB
Rank =   29  Free Memory = 88954 MB
Rank =   30  Free Memory = 88954 MB
Rank =   31  Free Memory = 88954 MB
Rank =   32  Free Memory = 85764 MB
Rank =   33  Free Memory = 85764 MB
Rank =   34  Free Memory = 85764 MB
Rank =   35  Free Memory = 85764 MB
Rank =   36  Free Memory = 85764 MB
Rank =   37  Free Memory = 85764 MB
Rank =   38  Free Memory = 85764 MB
Rank =   39  Free Memory = 85764 MB
Rank =   40  Free Memory = 85764 MB
Rank =   41  Free Memory = 85764 MB
Rank =   42  Free Memory = 85764 MB
Rank =   43  Free Memory = 85764 MB
Rank =   44  Free Memory = 85764 MB
Rank =   45  Free Memory = 85764 MB
Rank =   46  Free Memory = 85764 MB
Rank =   47  Free Memory = 85764 MB
Rank =   48  Free Memory = 85764 MB
Rank =   49  Free Memory = 85764 MB
Rank =   50  Free Memory = 85764 MB
Rank =   51  Free Memory = 85764 MB
Rank =   52  Free Memory = 85764 MB
Rank =   53  Free Memory = 85764 MB
Rank =   54  Free Memory = 85764 MB
Rank =   55  Free Memory = 85763 MB
Rank =   56  Free Memory = 85763 MB
Rank =   57  Free Memory = 85763 MB
Rank =   58  Free Memory = 85763 MB
Rank =   59  Free Memory = 85763 MB
Rank =   60  Free Memory = 85763 MB
Rank =   61  Free Memory = 85763 MB
Rank =   62  Free Memory = 85762 MB
Rank =   63  Free Memory = 85762 MB
Rank =   64  Free Memory = 89142 MB
Rank =   65  Free Memory = 89142 MB
Rank =   66  Free Memory = 89142 MB
Rank =   67  Free Memory = 89142 MB
Rank =   68  Free Memory = 89142 MB
Rank =   69  Free Memory = 89142 MB
Rank =   70  Free Memory = 89142 MB
Rank =   71  Free Memory = 89142 MB
Rank =   72  Free Memory = 89142 MB
Rank =   73  Free Memory = 89142 MB
Rank =   74  Free Memory = 89142 MB
Rank =   75  Free Memory = 89142 MB
Rank =   76  Free Memory = 89142 MB
Rank =   77  Free Memory = 89142 MB
Rank =   78  Free Memory = 89142 MB
Rank =   79  Free Memory = 89142 MB
Rank =   80  Free Memory = 89142 MB
Rank =   81  Free Memory = 89142 MB
Rank =   82  Free Memory = 89142 MB
Rank =   83  Free Memory = 89142 MB
Rank =   84  Free Memory = 89142 MB
Rank =   85  Free Memory = 89142 MB
Rank =   86  Free Memory = 89142 MB
Rank =   87  Free Memory = 89142 MB
Rank =   88  Free Memory = 89142 MB
Rank =   89  Free Memory = 89142 MB
Rank =   90  Free Memory = 89142 MB
Rank =   91  Free Memory = 89142 MB
Rank =   92  Free Memory = 89142 MB
Rank =   93  Free Memory = 89142 MB
Rank =   94  Free Memory = 89142 MB
Rank =   95  Free Memory = 89142 MB
Rank =   96  Free Memory = 89445 MB
Rank =   97  Free Memory = 89444 MB
Rank =   98  Free Memory = 89444 MB
Rank =   99  Free Memory = 89444 MB
Rank =  100  Free Memory = 89444 MB
Rank =  101  Free Memory = 89444 MB
Rank =  102  Free Memory = 89444 MB
Rank =  103  Free Memory = 89444 MB
Rank =  104  Free Memory = 89444 MB
Rank =  105  Free Memory = 89444 MB
Rank =  106  Free Memory = 89444 MB
Rank =  107  Free Memory = 89444 MB
Rank =  108  Free Memory = 89444 MB
Rank =  109  Free Memory = 89444 MB
Rank =  110  Free Memory = 89444 MB
Rank =  111  Free Memory = 89444 MB
Rank =  112  Free Memory = 89444 MB
Rank =  113  Free Memory = 89444 MB
Rank =  114  Free Memory = 89444 MB
Rank =  115  Free Memory = 89444 MB
Rank =  116  Free Memory = 89444 MB
Rank =  117  Free Memory = 89444 MB
Rank =  118  Free Memory = 89444 MB
Rank =  119  Free Memory = 89444 MB
Rank =  120  Free Memory = 89444 MB
Rank =  121  Free Memory = 89444 MB
Rank =  122  Free Memory = 89444 MB
Rank =  123  Free Memory = 89444 MB
Rank =  124  Free Memory = 89444 MB
Rank =  125  Free Memory = 89444 MB
Rank =  126  Free Memory = 89444 MB
Rank =  127  Free Memory = 89444 MB
  Input file(s): opt_h2o_gs_gvptt_run002h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002h.xml

  Project = H2O
  date    = 2023-04-01 14:31:58 PDT
  host    = n0089.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 718

  Range of prime numbers to use as seeds over processors and threads = 5443-6563


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.909340e-01    1         1  ON     0
     uu_1                 2.819192e-02    1         1  ON     1
     uu_2                -6.769436e-02    1         1  ON     2
     uu_3                -1.244055e-01    1         1  ON     3
     uu_4                -1.604598e-01    1         1  ON     4
     uu_5                -1.723731e-01    1         1  ON     5
     uu_6                -1.595617e-01    1         1  ON     6
     uu_7                -1.136125e-01    1         1  ON     7
     uu_8                -3.691230e-02    1         1  ON     8
     uu_9                 1.618670e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.494032e-01    1         1  ON     0
     ud_1                 9.083486e-02    1         1  ON     1
     ud_2                -1.912559e-02    1         1  ON     2
     ud_3                -8.096853e-02    1         1  ON     3
     ud_4                -1.308919e-01    1         1  ON     4
     ud_5                -1.677899e-01    1         1  ON     5
     ud_6                -1.808195e-01    1         1  ON     6
     ud_7                -1.595587e-01    1         1  ON     7
     ud_8                -9.931838e-02    1         1  ON     8
     ud_9                -8.476133e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.255083e-01    1         1  ON     0
     eO_1                -6.031125e-01    1         1  ON     1
     eO_2                -1.884757e-01    1         1  ON     2
     eO_3                 8.070239e-02    1         1  ON     3
     eO_4                 2.054028e-01    1         1  ON     4
     eO_5                 2.935418e-01    1         1  ON     5
     eO_6                 3.341352e-01    1         1  ON     6
     eO_7                 5.023005e-01    1         1  ON     7
     eO_8                 1.940566e-01    1         1  ON     8
     eO_9                 6.117185e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.116867e-01    1         1  ON     0
     eH1_1                -1.328691e-01    1         1  ON     1
     eH1_2                -9.151189e-02    1         1  ON     2
     eH1_3                -5.389715e-02    1         1  ON     3
     eH1_4                -7.407719e-03    1         1  ON     4
     eH1_5                 4.706751e-03    1         1  ON     5
     eH1_6                 4.143099e-02    1         1  ON     6
     eH1_7                 6.404808e-02    1         1  ON     7
     eH1_8                 1.798815e-01    1         1  ON     8
     eH1_9                 1.210047e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.068781e-01    1         1  ON     0
     eH2_1                -1.280616e-01    1         1  ON     1
     eH2_2                -8.657559e-02    1         1  ON     2
     eH2_3                -4.904279e-02    1         1  ON     3
     eH2_4                -2.860052e-03    1         1  ON     4
     eH2_5                 9.101246e-03    1         1  ON     5
     eH2_6                 4.679036e-02    1         1  ON     6
     eH2_7                 4.636778e-02    1         1  ON     7
     eH2_8                 1.982524e-01    1         1  ON     8
     eH2_9                 1.201573e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697168e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.2238e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.262018
====================================================
  Execution time = 2.0560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 4.1745e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417696295223
                                         uncertainty =       0.090143069929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.417696295223
                                         uncertainty =       0.090143069929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456861773
  error estimate for blocks of size 2^( 2) =       0.000465222905
  error estimate for blocks of size 2^( 3) =       0.000472306524
  error estimate for blocks of size 2^( 4) =       0.000476760120
  error estimate for blocks of size 2^( 5) =       0.000479973922
  error estimate for blocks of size 2^( 6) =       0.000480469806
  error estimate for blocks of size 2^( 7) =       0.000480919620

      target function =                  N/A
              le_mean =     -17.217864025320
             les_mean =     296.872286745525
             stat err =       0.000479530867
             autocorr =       1.101700363365
              std dev =       0.646100115968
             le_variance =       0.417445359854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721786402532e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217864025320       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217867705784       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217868624341       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217871715268       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217874160907       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217874499293       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217875355204       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217875033567       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217874494473       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217874727467       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.506357e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217864025320       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217865476677       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217865953551       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217866925552       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217867788825       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217867907061       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217868215834       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217868231740       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.058296e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217864025320       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217864449366       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217864610233       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217864866648       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217865084696       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217865104919       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217865194901       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217865213061       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.426696e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6289e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.908917e-01                 1 1 ON  0
uu_1  2.801670e-02                 1 1 ON  1
uu_2  -6.771699e-02                1 1 ON  2
uu_3  -1.244255e-01                1 1 ON  3
uu_4  -1.603366e-01                1 1 ON  4
uu_5  -1.722998e-01                1 1 ON  5
uu_6  -1.594750e-01                1 1 ON  6
uu_7  -1.136321e-01                1 1 ON  7
uu_8  -3.692938e-02                1 1 ON  8
uu_9  1.618537e-01                 1 1 ON  9
ud_0  3.498036e-01                 1 1 ON  10
ud_1  9.112653e-02                 1 1 ON  11
ud_2  -1.922550e-02                1 1 ON  12
ud_3  -8.121306e-02                1 1 ON  13
ud_4  -1.310530e-01                1 1 ON  14
ud_5  -1.679543e-01                1 1 ON  15
ud_6  -1.808012e-01                1 1 ON  16
ud_7  -1.595352e-01                1 1 ON  17
ud_8  -9.938781e-02                1 1 ON  18
ud_9  -8.488665e-03                1 1 ON  19
eO_0  -9.260142e-01                1 1 ON  20
eO_1  -6.032076e-01                1 1 ON  21
eO_2  -1.881630e-01                1 1 ON  22
eO_3  8.102962e-02                 1 1 ON  23
eO_4  2.054553e-01                 1 1 ON  24
eO_5  2.934748e-01                 1 1 ON  25
eO_6  3.341124e-01                 1 1 ON  26
eO_7  5.022809e-01                 1 1 ON  27
eO_8  1.940659e-01                 1 1 ON  28
eO_9  6.117757e-02                 1 1 ON  29
eH1_0 -2.116801e-01                1 1 ON  30
eH1_1 -1.329284e-01                1 1 ON  31
eH1_2 -9.157455e-02                1 1 ON  32
eH1_3 -5.378799e-02                1 1 ON  33
eH1_4 -7.363796e-03                1 1 ON  34
eH1_5 4.719841e-03                 1 1 ON  35
eH1_6 4.140424e-02                 1 1 ON  36
eH1_7 6.400974e-02                 1 1 ON  37
eH1_8 1.798820e-01                 1 1 ON  38
eH1_9 1.210116e-01                 1 1 ON  39
eH2_0 -2.068305e-01                1 1 ON  40
eH2_1 -1.280648e-01                1 1 ON  41
eH2_2 -8.661849e-02                1 1 ON  42
eH2_3 -4.895472e-02                1 1 ON  43
eH2_4 -2.874466e-03                1 1 ON  44
eH2_5 9.086691e-03                 1 1 ON  45
eH2_6 4.674804e-02                 1 1 ON  46
eH2_7 4.635877e-02                 1 1 ON  47
eH2_8 1.982337e-01                 1 1 ON  48
eH2_9 1.201622e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.179424
====================================================
  Execution time = 1.9602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1457e-01
  Total weights = 2.0000e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314321567415
                                         uncertainty =       0.003473355198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314321567415
                                         uncertainty =       0.003473355198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396410550
  error estimate for blocks of size 2^( 2) =       0.000406008425
  error estimate for blocks of size 2^( 3) =       0.000414730847
  error estimate for blocks of size 2^( 4) =       0.000421174846
  error estimate for blocks of size 2^( 5) =       0.000424571189
  error estimate for blocks of size 2^( 6) =       0.000425569323
  error estimate for blocks of size 2^( 7) =       0.000426932758

      target function =                  N/A
              le_mean =     -17.216888921429
             les_mean =     296.735546624104
             stat err =       0.000424562029
             autocorr =       1.147075203434
              std dev =       0.560609176186
             le_variance =       0.314282648424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315104338784
                                         uncertainty =       0.003471977112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315104338784
                                         uncertainty =       0.003471977112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396904003
  error estimate for blocks of size 2^( 2) =       0.000406475063
  error estimate for blocks of size 2^( 3) =       0.000415160841
  error estimate for blocks of size 2^( 4) =       0.000421585148
  error estimate for blocks of size 2^( 5) =       0.000424965352
  error estimate for blocks of size 2^( 6) =       0.000425944180
  error estimate for blocks of size 2^( 7) =       0.000427282955

      target function =                  N/A
              le_mean =     -17.216888032919
             les_mean =     296.736298955954
             stat err =       0.000424944409
             autocorr =       1.146286772307
              std dev =       0.561307024212
             le_variance =       0.315065575429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314905986846
                                         uncertainty =       0.003471284236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314905986846
                                         uncertainty =       0.003471284236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396779061
  error estimate for blocks of size 2^( 2) =       0.000406355827
  error estimate for blocks of size 2^( 3) =       0.000415049087
  error estimate for blocks of size 2^( 4) =       0.000421478540
  error estimate for blocks of size 2^( 5) =       0.000424862870
  error estimate for blocks of size 2^( 6) =       0.000425849258
  error estimate for blocks of size 2^( 7) =       0.000427192346

      target function =                  N/A
              le_mean =     -17.216887596503
             les_mean =     296.736085599561
             stat err =       0.000424845754
             autocorr =       1.146476277866
              std dev =       0.561130329233
             le_variance =       0.314867246386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314398644230
                                         uncertainty =       0.003472894400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314398644230
                                         uncertainty =       0.003472894400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396459175
  error estimate for blocks of size 2^( 2) =       0.000406053956
  error estimate for blocks of size 2^( 3) =       0.000414771978
  error estimate for blocks of size 2^( 4) =       0.000421213924
  error estimate for blocks of size 2^( 5) =       0.000424608530
  error estimate for blocks of size 2^( 6) =       0.000425605232
  error estimate for blocks of size 2^( 7) =       0.000426965437

      target function =                  N/A
              le_mean =     -17.216888394246
             les_mean =     296.735605578265
             stat err =       0.000424598281
             autocorr =       1.146989694407
              std dev =       0.560677942771
             le_variance =       0.314359755509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216888921429        initial  <--
     2.5000e-01     2.5000e+00             1.5064e-03       -17.216888032919
     1.0000e+00     1.0000e+01             5.0583e-04       -17.216887596503
     4.0000e+00     4.0000e+01             1.4267e-04       -17.216888394246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7975
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.189582
====================================================
  Execution time = 2.0211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194249902
                                         uncertainty =       0.004862214732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320194249902
                                         uncertainty =       0.004862214732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400067495
  error estimate for blocks of size 2^( 2) =       0.000409657274
  error estimate for blocks of size 2^( 3) =       0.000418375147
  error estimate for blocks of size 2^( 4) =       0.000425337099
  error estimate for blocks of size 2^( 5) =       0.000428731420
  error estimate for blocks of size 2^( 6) =       0.000431322525
  error estimate for blocks of size 2^( 7) =       0.000430816360

      target function =                  N/A
              le_mean =     -17.216865336484
             les_mean =     296.740559856161
             stat err =       0.000429051851
             autocorr =       1.150146137891
              std dev =       0.565780877709
             le_variance =       0.320108001582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686533648e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865336484       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216865586761       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216865576963       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216865814170       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216865900321       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216865907581       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216866035029       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216866013557       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.943171e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865336484       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216865405267       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216865400823       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216865456951       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216865472947       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216865481173       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216865510012       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.016398e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216865336484       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216865354118       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216865352861       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216865366656       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216865370120       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216865372685       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216865379654       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.273026e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5830e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.909190e-01 1 1  ON 0
 uu_1                 2.818499e-02 1 1  ON 1
 uu_2                -6.768510e-02 1 1  ON 2
 uu_3                -1.244025e-01 1 1  ON 3
 uu_4                -1.604418e-01 1 1  ON 4
 uu_5                -1.723801e-01 1 1  ON 5
 uu_6                -1.595638e-01 1 1  ON 6
 uu_7                -1.136115e-01 1 1  ON 7
 uu_8                -3.691168e-02 1 1  ON 8
 uu_9                 1.618643e-01 1 1  ON 9
 ud_0                 3.494354e-01 1 1  ON 10
 ud_1                 9.085753e-02 1 1  ON 11
 ud_2                -1.914512e-02 1 1  ON 12
 ud_3                -8.099339e-02 1 1  ON 13
 ud_4                -1.309116e-01 1 1  ON 14
 ud_5                -1.677839e-01 1 1  ON 15
 ud_6                -1.808103e-01 1 1  ON 16
 ud_7                -1.595581e-01 1 1  ON 17
 ud_8                -9.932456e-02 1 1  ON 18
 ud_9                -8.477775e-03 1 1  ON 19
 eO_0                -9.255585e-01 1 1  ON 20
 eO_1                -6.031202e-01 1 1  ON 21
 eO_2                -1.884578e-01 1 1  ON 22
 eO_3                 8.074188e-02 1 1  ON 23
 eO_4                 2.054103e-01 1 1  ON 24
 eO_5                 2.935359e-01 1 1  ON 25
 eO_6                 3.341341e-01 1 1  ON 26
 eO_7                 5.022986e-01 1 1  ON 27
 eO_8                 1.940581e-01 1 1  ON 28
 eO_9                 6.117216e-02 1 1  ON 29
eH1_0                -2.116993e-01 1 1  ON 30
eH1_1                -1.328660e-01 1 1  ON 31
eH1_2                -9.151205e-02 1 1  ON 32
eH1_3                -5.389123e-02 1 1  ON 33
eH1_4                -7.406273e-03 1 1  ON 34
eH1_5                 4.714362e-03 1 1  ON 35
eH1_6                 4.142790e-02 1 1  ON 36
eH1_7                 6.404575e-02 1 1  ON 37
eH1_8                 1.798813e-01 1 1  ON 38
eH1_9                 1.210049e-01 1 1  ON 39
eH2_0                -2.068939e-01 1 1  ON 40
eH2_1                -1.280600e-01 1 1  ON 41
eH2_2                -8.657318e-02 1 1  ON 42
eH2_3                -4.903768e-02 1 1  ON 43
eH2_4                -2.843360e-03 1 1  ON 44
eH2_5                 9.099635e-03 1 1  ON 45
eH2_6                 4.678493e-02 1 1  ON 46
eH2_7                 4.636578e-02 1 1  ON 47
eH2_8                 1.982511e-01 1 1  ON 48
eH2_9                 1.201572e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.200383
====================================================
  Execution time = 1.9639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2276e-01
  Total weights = 2.0000e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322699598632
                                         uncertainty =       0.004994697155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322699598632
                                         uncertainty =       0.004994697155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401707477
  error estimate for blocks of size 2^( 2) =       0.000411572181
  error estimate for blocks of size 2^( 3) =       0.000419554431
  error estimate for blocks of size 2^( 4) =       0.000426298914
  error estimate for blocks of size 2^( 5) =       0.000430314396
  error estimate for blocks of size 2^( 6) =       0.000431763375
  error estimate for blocks of size 2^( 7) =       0.000434177334

      target function =                  N/A
              le_mean =     -17.216616773000
             les_mean =     296.734630740910
             stat err =       0.000430638505
             autocorr =       1.149227174907
              std dev =       0.568100161893
             le_variance =       0.322737793943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322794419542
                                         uncertainty =       0.004997197534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322794419542
                                         uncertainty =       0.004997197534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766501
  error estimate for blocks of size 2^( 2) =       0.000411626102
  error estimate for blocks of size 2^( 3) =       0.000419603234
  error estimate for blocks of size 2^( 4) =       0.000426344678
  error estimate for blocks of size 2^( 5) =       0.000430358667
  error estimate for blocks of size 2^( 6) =       0.000431803910
  error estimate for blocks of size 2^( 7) =       0.000434219083

      target function =                  N/A
              le_mean =     -17.216617622379
             les_mean =     296.734754836835
             stat err =       0.000430681584
             autocorr =       1.149119403548
              std dev =       0.568183634950
             le_variance =       0.322832643025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322747245071
                                         uncertainty =       0.004996002041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322747245071
                                         uncertainty =       0.004996002041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401737138
  error estimate for blocks of size 2^( 2) =       0.000411599133
  error estimate for blocks of size 2^( 3) =       0.000419578702
  error estimate for blocks of size 2^( 4) =       0.000426321628
  error estimate for blocks of size 2^( 5) =       0.000430336312
  error estimate for blocks of size 2^( 6) =       0.000431783277
  error estimate for blocks of size 2^( 7) =       0.000434197914

      target function =                  N/A
              le_mean =     -17.216617218584
             les_mean =     296.734693745781
             stat err =       0.000430659783
             autocorr =       1.149171036759
              std dev =       0.568142108933
             le_variance =       0.322785455943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322705559413
                                         uncertainty =       0.004994858226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322705559413
                                         uncertainty =       0.004994858226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401711188
  error estimate for blocks of size 2^( 2) =       0.000411575545
  error estimate for blocks of size 2^( 3) =       0.000419557453
  error estimate for blocks of size 2^( 4) =       0.000426301738
  error estimate for blocks of size 2^( 5) =       0.000430317118
  error estimate for blocks of size 2^( 6) =       0.000431765839
  error estimate for blocks of size 2^( 7) =       0.000434179890

      target function =                  N/A
              le_mean =     -17.216616827661
             les_mean =     296.734638585854
             stat err =       0.000430641146
             autocorr =       1.149220041659
              std dev =       0.568105409886
             le_variance =       0.322743756742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216616773000        initial
     2.5000e+00     2.5000e+01             1.9432e-04       -17.216617622379  <--
     1.0000e+01     1.0000e+02             5.0164e-05       -17.216617218584
     4.0000e+01     4.0000e+02             1.2730e-05       -17.216616827661

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.8867e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817149e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495277e-01 1 1  ON 10
 ud_1                 9.091734e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085720e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403093e-03 1 1  ON 34
eH1_5                 4.737169e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095827e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.129341
====================================================
  Execution time = 2.0044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331148052907
                                         uncertainty =       0.007734745977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331148052907
                                         uncertainty =       0.007734745977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406903898
  error estimate for blocks of size 2^( 2) =       0.000416358234
  error estimate for blocks of size 2^( 3) =       0.000424720052
  error estimate for blocks of size 2^( 4) =       0.000431193107
  error estimate for blocks of size 2^( 5) =       0.000435618096
  error estimate for blocks of size 2^( 6) =       0.000437392747
  error estimate for blocks of size 2^( 7) =       0.000435110139

      target function =                  N/A
              le_mean =     -17.217087315724
             les_mean =     296.759237035930
             stat err =       0.000434828522
             autocorr =       1.141963826057
              std dev =       0.575449010990
             le_variance =       0.331141564250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708731572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087315724       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217093191244       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217094443728       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217094192852       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217094740740       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217095262321       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217095880889       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217095812346       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217095653018       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.863466e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087315724       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089289365       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089756195       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089693604       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089879336       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217090029220       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217090124529       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217090122993       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.689193e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087315724       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217087855506       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217087988752       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217087974728       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217088028452       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217088065850       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217088085214       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.406642e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5600e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.908749e-01 1 1  ON 0
 uu_1                 2.812530e-02 1 1  ON 1
 uu_2                -6.766003e-02 1 1  ON 2
 uu_3                -1.243201e-01 1 1  ON 3
 uu_4                -1.603951e-01 1 1  ON 4
 uu_5                -1.723933e-01 1 1  ON 5
 uu_6                -1.596109e-01 1 1  ON 6
 uu_7                -1.136268e-01 1 1  ON 7
 uu_8                -3.690124e-02 1 1  ON 8
 uu_9                 1.618566e-01 1 1  ON 9
 ud_0                 3.496689e-01 1 1  ON 10
 ud_1                 9.100181e-02 1 1  ON 11
 ud_2                -1.925436e-02 1 1  ON 12
 ud_3                -8.114806e-02 1 1  ON 13
 ud_4                -1.309882e-01 1 1  ON 14
 ud_5                -1.677618e-01 1 1  ON 15
 ud_6                -1.808080e-01 1 1  ON 16
 ud_7                -1.595827e-01 1 1  ON 17
 ud_8                -9.936696e-02 1 1  ON 18
 ud_9                -8.485108e-03 1 1  ON 19
 eO_0                -9.258716e-01 1 1  ON 20
 eO_1                -6.031562e-01 1 1  ON 21
 eO_2                -1.883719e-01 1 1  ON 22
 eO_3                 8.099154e-02 1 1  ON 23
 eO_4                 2.054906e-01 1 1  ON 24
 eO_5                 2.934865e-01 1 1  ON 25
 eO_6                 3.341078e-01 1 1  ON 26
 eO_7                 5.022875e-01 1 1  ON 27
 eO_8                 1.940719e-01 1 1  ON 28
 eO_9                 6.117727e-02 1 1  ON 29
eH1_0                -2.117800e-01 1 1  ON 30
eH1_1                -1.328499e-01 1 1  ON 31
eH1_2                -9.151124e-02 1 1  ON 32
eH1_3                -5.385657e-02 1 1  ON 33
eH1_4                -7.370789e-03 1 1  ON 34
eH1_5                 4.738786e-03 1 1  ON 35
eH1_6                 4.140988e-02 1 1  ON 36
eH1_7                 6.401882e-02 1 1  ON 37
eH1_8                 1.798850e-01 1 1  ON 38
eH1_9                 1.210119e-01 1 1  ON 39
eH2_0                -2.069781e-01 1 1  ON 40
eH2_1                -1.280626e-01 1 1  ON 41
eH2_2                -8.652815e-02 1 1  ON 42
eH2_3                -4.901006e-02 1 1  ON 43
eH2_4                -2.777589e-03 1 1  ON 44
eH2_5                 9.071938e-03 1 1  ON 45
eH2_6                 4.676006e-02 1 1  ON 46
eH2_7                 4.636731e-02 1 1  ON 47
eH2_8                 1.982467e-01 1 1  ON 48
eH2_9                 1.201582e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1541
    reference variance = 0.349151
====================================================
  Execution time = 1.9559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316104888343
                                         uncertainty =       0.002978193544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316104888343
                                         uncertainty =       0.002978193544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397574463
  error estimate for blocks of size 2^( 2) =       0.000407468192
  error estimate for blocks of size 2^( 3) =       0.000416342222
  error estimate for blocks of size 2^( 4) =       0.000421879255
  error estimate for blocks of size 2^( 5) =       0.000425959469
  error estimate for blocks of size 2^( 6) =       0.000428262888
  error estimate for blocks of size 2^( 7) =       0.000430050557

      target function =                  N/A
              le_mean =     -17.216371757489
             les_mean =     296.719587241869
             stat err =       0.000426538042
             autocorr =       1.151008630447
              std dev =       0.562255198168
             le_variance =       0.316130907867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316399620994
                                         uncertainty =       0.002978008341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316399620994
                                         uncertainty =       0.002978008341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397759844
  error estimate for blocks of size 2^( 2) =       0.000407641511
  error estimate for blocks of size 2^( 3) =       0.000416500149
  error estimate for blocks of size 2^( 4) =       0.000422028962
  error estimate for blocks of size 2^( 5) =       0.000426099439
  error estimate for blocks of size 2^( 6) =       0.000428397785
  error estimate for blocks of size 2^( 7) =       0.000430192873

      target function =                  N/A
              le_mean =     -17.216369145213
             les_mean =     296.719792172354
             stat err =       0.000426679765
             autocorr =       1.150700287748
              std dev =       0.562517365360
             le_variance =       0.316425786332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316296711013
                                         uncertainty =       0.002977932800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316296711013
                                         uncertainty =       0.002977932800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397695130
  error estimate for blocks of size 2^( 2) =       0.000407580729
  error estimate for blocks of size 2^( 3) =       0.000416444512
  error estimate for blocks of size 2^( 4) =       0.000421976444
  error estimate for blocks of size 2^( 5) =       0.000426049880
  error estimate for blocks of size 2^( 6) =       0.000428349770
  error estimate for blocks of size 2^( 7) =       0.000430142292

      target function =                  N/A
              le_mean =     -17.216369823839
             les_mean =     296.719712585977
             stat err =       0.000426629596
             autocorr =       1.150804137527
              std dev =       0.562425846603
             le_variance =       0.316322832927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316129519444
                                         uncertainty =       0.002978139096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316129519444
                                         uncertainty =       0.002978139096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397589960
  error estimate for blocks of size 2^( 2) =       0.000407482590
  error estimate for blocks of size 2^( 3) =       0.000416355239
  error estimate for blocks of size 2^( 4) =       0.000421891590
  error estimate for blocks of size 2^( 5) =       0.000425970880
  error estimate for blocks of size 2^( 6) =       0.000428273828
  error estimate for blocks of size 2^( 7) =       0.000430062165

      target function =                  N/A
              le_mean =     -17.216371450080
             les_mean =     296.719601302077
             stat err =       0.000426549616
             autocorr =       1.150981364731
              std dev =       0.562277114084
             le_variance =       0.316155553023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216371757489        initial  <--
     6.2500e-01     6.2500e+00             5.8635e-04       -17.216369145213
     2.5000e+00     2.5000e+01             1.6892e-04       -17.216369823839
     1.0000e+01     1.0000e+02             4.4066e-05       -17.216371450080

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7619
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817149e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495277e-01 1 1  ON 10
 ud_1                 9.091734e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085720e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403093e-03 1 1  ON 34
eH1_5                 4.737169e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095827e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.21311
====================================================
  Execution time = 1.9937e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1770e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757700860
                                         uncertainty =       0.003285614567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757700860
                                         uncertainty =       0.003285614567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398557032
  error estimate for blocks of size 2^( 2) =       0.000408209617
  error estimate for blocks of size 2^( 3) =       0.000416371032
  error estimate for blocks of size 2^( 4) =       0.000421853063
  error estimate for blocks of size 2^( 5) =       0.000426110714
  error estimate for blocks of size 2^( 6) =       0.000428846072
  error estimate for blocks of size 2^( 7) =       0.000428004849

      target function =                  N/A
              le_mean =     -17.217289508018
             les_mean =     296.752753259911
             stat err =       0.000426203674
             autocorr =       1.143545439488
              std dev =       0.563644760346
             le_variance =       0.317695415866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721728950802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217289508018       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217289712848       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217289637107       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217289489377       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217289523483       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217289609226       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217289555274       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.235041e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217289508018       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217289560914       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217289542035       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217289507452       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217289517283       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217289535986       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217289523182       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.108793e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217289508018       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217289521352       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217289516637       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217289508156       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217289510710       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217289515190       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217289512060       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 5.304122e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5572e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.908734e-01 1 1  ON 0
 uu_1                 2.816902e-02 1 1  ON 1
 uu_2                -6.766078e-02 1 1  ON 2
 uu_3                -1.243923e-01 1 1  ON 3
 uu_4                -1.603956e-01 1 1  ON 4
 uu_5                -1.723954e-01 1 1  ON 5
 uu_6                -1.595691e-01 1 1  ON 6
 uu_7                -1.136101e-01 1 1  ON 7
 uu_8                -3.690956e-02 1 1  ON 8
 uu_9                 1.618553e-01 1 1  ON 9
 ud_0                 3.495429e-01 1 1  ON 10
 ud_1                 9.092669e-02 1 1  ON 11
 ud_2                -1.920307e-02 1 1  ON 12
 ud_3                -8.107173e-02 1 1  ON 13
 ud_4                -1.309706e-01 1 1  ON 14
 ud_5                -1.677696e-01 1 1  ON 15
 ud_6                -1.807845e-01 1 1  ON 16
 ud_7                -1.595578e-01 1 1  ON 17
 ud_8                -9.934550e-02 1 1  ON 18
 ud_9                -8.483161e-03 1 1  ON 19
 eO_0                -9.257237e-01 1 1  ON 20
 eO_1                -6.031501e-01 1 1  ON 21
 eO_2                -1.883962e-01 1 1  ON 22
 eO_3                 8.086920e-02 1 1  ON 23
 eO_4                 2.054413e-01 1 1  ON 24
 eO_5                 2.935167e-01 1 1  ON 25
 eO_6                 3.341293e-01 1 1  ON 26
 eO_7                 5.022915e-01 1 1  ON 27
 eO_8                 1.940634e-01 1 1  ON 28
 eO_9                 6.117340e-02 1 1  ON 29
eH1_0                -2.117363e-01 1 1  ON 30
eH1_1                -1.328569e-01 1 1  ON 31
eH1_2                -9.151379e-02 1 1  ON 32
eH1_3                -5.387453e-02 1 1  ON 33
eH1_4                -7.402107e-03 1 1  ON 34
eH1_5                 4.737526e-03 1 1  ON 35
eH1_6                 4.142022e-02 1 1  ON 36
eH1_7                 6.403843e-02 1 1  ON 37
eH1_8                 1.798808e-01 1 1  ON 38
eH1_9                 1.210056e-01 1 1  ON 39
eH2_0                -2.069400e-01 1 1  ON 40
eH2_1                -1.280595e-01 1 1  ON 41
eH2_2                -8.657003e-02 1 1  ON 42
eH2_3                -4.901892e-02 1 1  ON 43
eH2_4                -2.794439e-03 1 1  ON 44
eH2_5                 9.098922e-03 1 1  ON 45
eH2_6                 4.676973e-02 1 1  ON 46
eH2_7                 4.635951e-02 1 1  ON 47
eH2_8                 1.982466e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3318
    reference variance = 0.58293
====================================================
  Execution time = 2.1975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1521e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315270062748
                                         uncertainty =       0.003331403118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315270062748
                                         uncertainty =       0.003331403118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396989181
  error estimate for blocks of size 2^( 2) =       0.000406717900
  error estimate for blocks of size 2^( 3) =       0.000416302207
  error estimate for blocks of size 2^( 4) =       0.000422703348
  error estimate for blocks of size 2^( 5) =       0.000425892632
  error estimate for blocks of size 2^( 6) =       0.000428259243
  error estimate for blocks of size 2^( 7) =       0.000430016906

      target function =                  N/A
              le_mean =     -17.216496314457
             les_mean =     296.722946007103
             stat err =       0.000426718032
             autocorr =       1.155379479516
              std dev =       0.561427483291
             le_variance =       0.315200818994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315314589325
                                         uncertainty =       0.003331797361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315314589325
                                         uncertainty =       0.003331797361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397017218
  error estimate for blocks of size 2^( 2) =       0.000406743941
  error estimate for blocks of size 2^( 3) =       0.000416326031
  error estimate for blocks of size 2^( 4) =       0.000422725326
  error estimate for blocks of size 2^( 5) =       0.000425914032
  error estimate for blocks of size 2^( 6) =       0.000428281768
  error estimate for blocks of size 2^( 7) =       0.000430039058

      target function =                  N/A
              le_mean =     -17.216496282941
             les_mean =     296.722989446374
             stat err =       0.000426740046
             autocorr =       1.155335491378
              std dev =       0.561467134822
             le_variance =       0.315245343486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315292730628
                                         uncertainty =       0.003331597118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315292730628
                                         uncertainty =       0.003331597118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397003454
  error estimate for blocks of size 2^( 2) =       0.000406731141
  error estimate for blocks of size 2^( 3) =       0.000416314299
  error estimate for blocks of size 2^( 4) =       0.000422714483
  error estimate for blocks of size 2^( 5) =       0.000425903488
  error estimate for blocks of size 2^( 6) =       0.000428270691
  error estimate for blocks of size 2^( 7) =       0.000430028154

      target function =                  N/A
              le_mean =     -17.216496297973
             les_mean =     296.722968106146
             stat err =       0.000426729204
             autocorr =       1.155356893833
              std dev =       0.561447669537
             le_variance =       0.315223485628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315272906683
                                         uncertainty =       0.003331427238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315272906683
                                         uncertainty =       0.003331427238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396990971
  error estimate for blocks of size 2^( 2) =       0.000406719561
  error estimate for blocks of size 2^( 3) =       0.000416303722
  error estimate for blocks of size 2^( 4) =       0.000422704743
  error estimate for blocks of size 2^( 5) =       0.000425893992
  error estimate for blocks of size 2^( 6) =       0.000428260678
  error estimate for blocks of size 2^( 7) =       0.000430018316

      target function =                  N/A
              le_mean =     -17.216496312060
             les_mean =     296.722948768326
             stat err =       0.000426719432
             autocorr =       1.155376635522
              std dev =       0.561430015912
             le_variance =       0.315203662767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216496314457        initial  <--
     6.2500e+00     6.2500e+01             8.2350e-05       -17.216496282941
     2.5000e+01     2.5000e+02             2.1088e-05       -17.216496297973
     1.0000e+02     1.0000e+03             5.3041e-06       -17.216496312060

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1318
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817149e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495277e-01 1 1  ON 10
 ud_1                 9.091734e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085720e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403093e-03 1 1  ON 34
eH1_5                 4.737169e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095827e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1802
    reference variance = 0.298812
====================================================
  Execution time = 2.1965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1717e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317250668388
                                         uncertainty =       0.004076979296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317250668388
                                         uncertainty =       0.004076979296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398226510
  error estimate for blocks of size 2^( 2) =       0.000407561087
  error estimate for blocks of size 2^( 3) =       0.000416442725
  error estimate for blocks of size 2^( 4) =       0.000422748551
  error estimate for blocks of size 2^( 5) =       0.000425853955
  error estimate for blocks of size 2^( 6) =       0.000429085547
  error estimate for blocks of size 2^( 7) =       0.000429968677

      target function =                  N/A
              le_mean =     -17.217166274221
             les_mean =     296.747983061607
             stat err =       0.000426914183
             autocorr =       1.149266720701
              std dev =       0.563177330894
             le_variance =       0.317168706033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716627422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166274221       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166303013       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166307245       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166295099       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166303828       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166305005       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166305472       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.377484e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166274221       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166281448       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166282514       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166279479       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166281676       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166281958       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166282080       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.098201e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166274221       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166276029       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166276296       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166275538       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166276088       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166276159       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166276190       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 5.247904e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7578e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.908802e-01 1 1  ON 0
 uu_1                 2.817125e-02 1 1  ON 1
 uu_2                -6.766313e-02 1 1  ON 2
 uu_3                -1.243931e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595695e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690969e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495295e-01 1 1  ON 10
 ud_1                 9.091811e-02 1 1  ON 11
 ud_2                -1.919604e-02 1 1  ON 12
 ud_3                -8.106441e-02 1 1  ON 13
 ud_4                -1.309670e-01 1 1  ON 14
 ud_5                -1.677704e-01 1 1  ON 15
 ud_6                -1.807827e-01 1 1  ON 16
 ud_7                -1.595560e-01 1 1  ON 17
 ud_8                -9.934408e-02 1 1  ON 18
 ud_9                -8.482985e-03 1 1  ON 19
 eO_0                -9.257048e-01 1 1  ON 20
 eO_1                -6.031470e-01 1 1  ON 21
 eO_2                -1.884084e-01 1 1  ON 22
 eO_3                 8.085888e-02 1 1  ON 23
 eO_4                 2.054380e-01 1 1  ON 24
 eO_5                 2.935189e-01 1 1  ON 25
 eO_6                 3.341304e-01 1 1  ON 26
 eO_7                 5.022926e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117319e-02 1 1  ON 29
eH1_0                -2.117351e-01 1 1  ON 30
eH1_1                -1.328574e-01 1 1  ON 31
eH1_2                -9.151299e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403397e-03 1 1  ON 34
eH1_5                 4.737308e-03 1 1  ON 35
eH1_6                 4.141892e-02 1 1  ON 36
eH1_7                 6.403845e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069384e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657077e-02 1 1  ON 42
eH2_3                -4.901879e-02 1 1  ON 43
eH2_4                -2.794604e-03 1 1  ON 44
eH2_5                 9.095605e-03 1 1  ON 45
eH2_6                 4.676883e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982469e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.407271
====================================================
  Execution time = 2.0012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1787e-01
  Total weights = 2.0000e+06
  Execution time = 1.8213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317637841951
                                         uncertainty =       0.003252460406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317637841951
                                         uncertainty =       0.003252460406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398663545
  error estimate for blocks of size 2^( 2) =       0.000408388177
  error estimate for blocks of size 2^( 3) =       0.000417364126
  error estimate for blocks of size 2^( 4) =       0.000423185758
  error estimate for blocks of size 2^( 5) =       0.000427259318
  error estimate for blocks of size 2^( 6) =       0.000429050366
  error estimate for blocks of size 2^( 7) =       0.000430870140

      target function =                  N/A
              le_mean =     -17.216626031601
             les_mean =     296.730076997003
             stat err =       0.000427591396
             autocorr =       1.150389387353
              std dev =       0.563795391901
             le_variance =       0.317865243929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317643927966
                                         uncertainty =       0.003252522499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317643927966
                                         uncertainty =       0.003252522499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398667363
  error estimate for blocks of size 2^( 2) =       0.000408391750
  error estimate for blocks of size 2^( 3) =       0.000417367471
  error estimate for blocks of size 2^( 4) =       0.000423188950
  error estimate for blocks of size 2^( 5) =       0.000427262427
  error estimate for blocks of size 2^( 6) =       0.000429053376
  error estimate for blocks of size 2^( 7) =       0.000430873070

      target function =                  N/A
              le_mean =     -17.216626029179
             les_mean =     296.730083002090
             stat err =       0.000427594456
             autocorr =       1.150383817661
              std dev =       0.563800791425
             le_variance =       0.317871332412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317640893150
                                         uncertainty =       0.003252491559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317640893150
                                         uncertainty =       0.003252491559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398665459
  error estimate for blocks of size 2^( 2) =       0.000408389968
  error estimate for blocks of size 2^( 3) =       0.000417365803
  error estimate for blocks of size 2^( 4) =       0.000423187358
  error estimate for blocks of size 2^( 5) =       0.000427260877
  error estimate for blocks of size 2^( 6) =       0.000429051875
  error estimate for blocks of size 2^( 7) =       0.000430871609

      target function =                  N/A
              le_mean =     -17.216626030332
             les_mean =     296.730080005760
             stat err =       0.000427592929
             autocorr =       1.150386593327
              std dev =       0.563798098943
             le_variance =       0.317868296372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317638223588
                                         uncertainty =       0.003252464304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317638223588
                                         uncertainty =       0.003252464304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398663784
  error estimate for blocks of size 2^( 2) =       0.000408388401
  error estimate for blocks of size 2^( 3) =       0.000417364335
  error estimate for blocks of size 2^( 4) =       0.000423185958
  error estimate for blocks of size 2^( 5) =       0.000427259513
  error estimate for blocks of size 2^( 6) =       0.000429050555
  error estimate for blocks of size 2^( 7) =       0.000430870324

      target function =                  N/A
              le_mean =     -17.216626031438
             les_mean =     296.730077373163
             stat err =       0.000427591587
             autocorr =       1.150389037793
              std dev =       0.563795730493
             le_variance =       0.317865625722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216626031601        initial  <--
     6.2500e+01     6.2500e+02             8.3775e-06       -17.216626029179
     2.5000e+02     2.5000e+03             2.0982e-06       -17.216626030332
     1.0000e+03     1.0000e+04             5.2479e-07       -17.216626031438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1866
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817149e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495277e-01 1 1  ON 10
 ud_1                 9.091734e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085720e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403093e-03 1 1  ON 34
eH1_5                 4.737169e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095827e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.227929
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1651e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316445021616
                                         uncertainty =       0.003082213483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316445021616
                                         uncertainty =       0.003082213483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397812289
  error estimate for blocks of size 2^( 2) =       0.000407421326
  error estimate for blocks of size 2^( 3) =       0.000415651879
  error estimate for blocks of size 2^( 4) =       0.000422416494
  error estimate for blocks of size 2^( 5) =       0.000426064899
  error estimate for blocks of size 2^( 6) =       0.000428091121
  error estimate for blocks of size 2^( 7) =       0.000429943582

      target function =                  N/A
              le_mean =     -17.216554166418
             les_mean =     296.726246441295
             stat err =       0.000426629024
             autocorr =       1.150123309727
              std dev =       0.562591534199
             le_variance =       0.316509234352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655416642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554166418       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554176448       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554177104       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554177362       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554178015       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554177523       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554177243       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.709038e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554166418       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554168926       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554169090       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554169156       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554169319       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554169195       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554169122       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.677589e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554166418       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554167045       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554167086       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554167102       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554167140       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554167112       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554167094       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 4.194179e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5460e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817143e-02 1 1  ON 1
 uu_2                -6.766328e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495279e-01 1 1  ON 10
 ud_1                 9.091742e-02 1 1  ON 11
 ud_2                -1.919529e-02 1 1  ON 12
 ud_3                -8.106352e-02 1 1  ON 13
 ud_4                -1.309664e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807825e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482959e-03 1 1  ON 19
 eO_0                -9.257028e-01 1 1  ON 20
 eO_1                -6.031465e-01 1 1  ON 21
 eO_2                -1.884092e-01 1 1  ON 22
 eO_3                 8.085732e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151318e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403056e-03 1 1  ON 34
eH1_5                 4.737172e-03 1 1  ON 35
eH1_6                 4.141885e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657094e-02 1 1  ON 42
eH2_3                -4.901892e-02 1 1  ON 43
eH2_4                -2.795012e-03 1 1  ON 44
eH2_5                 9.095857e-03 1 1  ON 45
eH2_6                 4.676921e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2892
    reference variance = 0.395162
====================================================
  Execution time = 2.0100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2847e-01
  Total weights = 2.0000e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248345274
                                         uncertainty =       0.012725465836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248345274
                                         uncertainty =       0.012725465836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405261007
  error estimate for blocks of size 2^( 2) =       0.000414692339
  error estimate for blocks of size 2^( 3) =       0.000422908381
  error estimate for blocks of size 2^( 4) =       0.000429389618
  error estimate for blocks of size 2^( 5) =       0.000432901624
  error estimate for blocks of size 2^( 6) =       0.000433916079
  error estimate for blocks of size 2^( 7) =       0.000436235304

      target function =                  N/A
              le_mean =     -17.217595202411
             les_mean =     296.774057358168
             stat err =       0.000433110656
             autocorr =       1.142163030291
              std dev =       0.573125613026
             le_variance =       0.328472968306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248890584
                                         uncertainty =       0.012725481816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248890584
                                         uncertainty =       0.012725481816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405261349
  error estimate for blocks of size 2^( 2) =       0.000414692653
  error estimate for blocks of size 2^( 3) =       0.000422908671
  error estimate for blocks of size 2^( 4) =       0.000429389895
  error estimate for blocks of size 2^( 5) =       0.000432901893
  error estimate for blocks of size 2^( 6) =       0.000433916354
  error estimate for blocks of size 2^( 7) =       0.000436235577

      target function =                  N/A
              le_mean =     -17.217595202033
             les_mean =     296.774057898598
             stat err =       0.000433110930
             autocorr =       1.142162548665
              std dev =       0.573126095855
             le_variance =       0.328473521751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248617984
                                         uncertainty =       0.012725473826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248617984
                                         uncertainty =       0.012725473826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405261178
  error estimate for blocks of size 2^( 2) =       0.000414692496
  error estimate for blocks of size 2^( 3) =       0.000422908526
  error estimate for blocks of size 2^( 4) =       0.000429389757
  error estimate for blocks of size 2^( 5) =       0.000432901758
  error estimate for blocks of size 2^( 6) =       0.000433916216
  error estimate for blocks of size 2^( 7) =       0.000436235440

      target function =                  N/A
              le_mean =     -17.217595202222
             les_mean =     296.774057628419
             stat err =       0.000433110793
             autocorr =       1.142162789399
              std dev =       0.573125854489
             le_variance =       0.328473245084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248379364
                                         uncertainty =       0.012725466835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327248379364
                                         uncertainty =       0.012725466835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405261029
  error estimate for blocks of size 2^( 2) =       0.000414692359
  error estimate for blocks of size 2^( 3) =       0.000422908399
  error estimate for blocks of size 2^( 4) =       0.000429389635
  error estimate for blocks of size 2^( 5) =       0.000432901641
  error estimate for blocks of size 2^( 6) =       0.000433916096
  error estimate for blocks of size 2^( 7) =       0.000436235321

      target function =                  N/A
              le_mean =     -17.217595202388
             les_mean =     296.774057391949
             stat err =       0.000433110673
             autocorr =       1.142163000173
              std dev =       0.573125643210
             le_variance =       0.328473002905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217595202411        initial  <--
     6.2500e+02     6.2500e+03             6.7090e-07       -17.217595202033
     2.5000e+03     2.5000e+04             1.6776e-07       -17.217595202222
     1.0000e+04     1.0000e+05             4.1942e-08       -17.217595202388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2543
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817149e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495277e-01 1 1  ON 10
 ud_1                 9.091734e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085720e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403093e-03 1 1  ON 34
eH1_5                 4.737169e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095827e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.369402
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582919777
                                         uncertainty =       0.024182965787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582919777
                                         uncertainty =       0.024182965787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410782726
  error estimate for blocks of size 2^( 2) =       0.000420163692
  error estimate for blocks of size 2^( 3) =       0.000428351200
  error estimate for blocks of size 2^( 4) =       0.000433941997
  error estimate for blocks of size 2^( 5) =       0.000438354231
  error estimate for blocks of size 2^( 6) =       0.000439949893
  error estimate for blocks of size 2^( 7) =       0.000443405109

      target function =                  N/A
              le_mean =     -17.217088848736
             les_mean =     296.765633153100
             stat err =       0.000438912808
             autocorr =       1.141647847269
              std dev =       0.580934502830
             le_variance =       0.337484896579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708884874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088848736       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088848879       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217088849005       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217088848981       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217088848909       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217088848976       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217088849027       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 9.312131e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088848736       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088848772       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217088848803       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217088848797       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217088848784       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217088848783       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217088848790       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.328101e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088848736       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088848745       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217088848753       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217088848754       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217088848749       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217088848784       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217088848699       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+05 is 5.820296e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5559e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817148e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495278e-01 1 1  ON 10
 ud_1                 9.091735e-02 1 1  ON 11
 ud_2                -1.919521e-02 1 1  ON 12
 ud_3                -8.106341e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934397e-02 1 1  ON 18
 ud_9                -8.482955e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085721e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151318e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403095e-03 1 1  ON 34
eH1_5                 4.737171e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901891e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095829e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1999
    reference variance = 0.197215
====================================================
  Execution time = 1.9671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1676e-01
  Total weights = 2.0000e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697042748
                                         uncertainty =       0.002858393374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697042748
                                         uncertainty =       0.002858393374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397971422
  error estimate for blocks of size 2^( 2) =       0.000407518872
  error estimate for blocks of size 2^( 3) =       0.000416200514
  error estimate for blocks of size 2^( 4) =       0.000421532179
  error estimate for blocks of size 2^( 5) =       0.000425510834
  error estimate for blocks of size 2^( 6) =       0.000428872520
  error estimate for blocks of size 2^( 7) =       0.000430401812

      target function =                  N/A
              le_mean =     -17.216936146071
             les_mean =     296.739652604848
             stat err =       0.000426579336
             autocorr =       1.148936046079
              std dev =       0.562816582334
             le_variance =       0.316762505351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697122402
                                         uncertainty =       0.002858394193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697122402
                                         uncertainty =       0.002858394193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397971472
  error estimate for blocks of size 2^( 2) =       0.000407518919
  error estimate for blocks of size 2^( 3) =       0.000416200558
  error estimate for blocks of size 2^( 4) =       0.000421532221
  error estimate for blocks of size 2^( 5) =       0.000425510874
  error estimate for blocks of size 2^( 6) =       0.000428872560
  error estimate for blocks of size 2^( 7) =       0.000430401852

      target function =                  N/A
              le_mean =     -17.216936146110
             les_mean =     296.739652685859
             stat err =       0.000426579377
             autocorr =       1.148935975090
              std dev =       0.562816653094
             le_variance =       0.316762585000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697082577
                                         uncertainty =       0.002858393784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697082577
                                         uncertainty =       0.002858393784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397971447
  error estimate for blocks of size 2^( 2) =       0.000407518895
  error estimate for blocks of size 2^( 3) =       0.000416200536
  error estimate for blocks of size 2^( 4) =       0.000421532200
  error estimate for blocks of size 2^( 5) =       0.000425510854
  error estimate for blocks of size 2^( 6) =       0.000428872540
  error estimate for blocks of size 2^( 7) =       0.000430401832

      target function =                  N/A
              le_mean =     -17.216936146091
             les_mean =     296.739652645354
             stat err =       0.000426579357
             autocorr =       1.148936010581
              std dev =       0.562816617716
             le_variance =       0.316762545177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697047727
                                         uncertainty =       0.002858393425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697047727
                                         uncertainty =       0.002858393425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397971425
  error estimate for blocks of size 2^( 2) =       0.000407518875
  error estimate for blocks of size 2^( 3) =       0.000416200517
  error estimate for blocks of size 2^( 4) =       0.000421532182
  error estimate for blocks of size 2^( 5) =       0.000425510836
  error estimate for blocks of size 2^( 6) =       0.000428872523
  error estimate for blocks of size 2^( 7) =       0.000430401815

      target function =                  N/A
              le_mean =     -17.216936146073
             les_mean =     296.739652609911
             stat err =       0.000426579339
             autocorr =       1.148936041628
              std dev =       0.562816586757
             le_variance =       0.316762510329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216936146071        initial
     6.2500e+03     6.2500e+04             9.3121e-08       -17.216936146110  <--
     2.5000e+04     2.5000e+05             2.3281e-08       -17.216936146091
     1.0000e+05     1.0000e+06             5.8203e-09       -17.216936146073

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 2.8853e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817146e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495278e-01 1 1  ON 10
 ud_1                 9.091737e-02 1 1  ON 11
 ud_2                -1.919524e-02 1 1  ON 12
 ud_3                -8.106344e-02 1 1  ON 13
 ud_4                -1.309663e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934398e-02 1 1  ON 18
 ud_9                -8.482957e-03 1 1  ON 19
 eO_0                -9.257027e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884093e-01 1 1  ON 22
 eO_3                 8.085725e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151318e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403101e-03 1 1  ON 34
eH1_5                 4.737178e-03 1 1  ON 35
eH1_6                 4.141884e-02 1 1  ON 36
eH1_7                 6.403847e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657091e-02 1 1  ON 42
eH2_3                -4.901890e-02 1 1  ON 43
eH2_4                -2.795033e-03 1 1  ON 44
eH2_5                 9.095835e-03 1 1  ON 45
eH2_6                 4.676922e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4418e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2047
    reference variance = 0.17348
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312374990407
                                         uncertainty =       0.002707145393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312374990407
                                         uncertainty =       0.002707145393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395157244
  error estimate for blocks of size 2^( 2) =       0.000404770363
  error estimate for blocks of size 2^( 3) =       0.000413497466
  error estimate for blocks of size 2^( 4) =       0.000420195941
  error estimate for blocks of size 2^( 5) =       0.000423840623
  error estimate for blocks of size 2^( 6) =       0.000425986099
  error estimate for blocks of size 2^( 7) =       0.000427373197

      target function =                  N/A
              le_mean =     -17.216787856435
             les_mean =     296.730082432108
             stat err =       0.000424348965
             autocorr =       1.153204688927
              std dev =       0.558836733555
             le_variance =       0.312298494771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678785643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787856435       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787856547       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787856409       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787856551       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787856745       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787857175       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216787857093       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216787857076       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.340137e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787856435       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787856463       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787856428       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787856464       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787856512       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787856621       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216787856600       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216787856595       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.350984e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787856435       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787856442       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787856433       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787856450       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787856454       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787856458       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216787856470       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216787856457       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.087786e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5825e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817144e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690975e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495279e-01 1 1  ON 10
 ud_1                 9.091741e-02 1 1  ON 11
 ud_2                -1.919529e-02 1 1  ON 12
 ud_3                -8.106348e-02 1 1  ON 13
 ud_4                -1.309664e-01 1 1  ON 14
 ud_5                -1.677707e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934398e-02 1 1  ON 18
 ud_9                -8.482953e-03 1 1  ON 19
 eO_0                -9.257028e-01 1 1  ON 20
 eO_1                -6.031464e-01 1 1  ON 21
 eO_2                -1.884092e-01 1 1  ON 22
 eO_3                 8.085730e-02 1 1  ON 23
 eO_4                 2.054375e-01 1 1  ON 24
 eO_5                 2.935192e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117317e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151317e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403084e-03 1 1  ON 34
eH1_5                 4.737157e-03 1 1  ON 35
eH1_6                 4.141883e-02 1 1  ON 36
eH1_7                 6.403846e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657092e-02 1 1  ON 42
eH2_3                -4.901889e-02 1 1  ON 43
eH2_4                -2.795030e-03 1 1  ON 44
eH2_5                 9.095836e-03 1 1  ON 45
eH2_6                 4.676921e-02 1 1  ON 46
eH2_7                 4.635955e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1623
    reference variance = 0.235984
====================================================
  Execution time = 1.9668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1887e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950546022
                                         uncertainty =       0.004271689333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950546022
                                         uncertainty =       0.004271689333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399295117
  error estimate for blocks of size 2^( 2) =       0.000408972017
  error estimate for blocks of size 2^( 3) =       0.000416895155
  error estimate for blocks of size 2^( 4) =       0.000423881366
  error estimate for blocks of size 2^( 5) =       0.000427292843
  error estimate for blocks of size 2^( 6) =       0.000429158458
  error estimate for blocks of size 2^( 7) =       0.000430199055

      target function =                  N/A
              le_mean =     -17.217266845263
             les_mean =     296.753150642695
             stat err =       0.000427632930
             autocorr =       1.146975876295
              std dev =       0.564688570041
             le_variance =       0.318873181135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950836262
                                         uncertainty =       0.004271694126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950836262
                                         uncertainty =       0.004271694126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399295299
  error estimate for blocks of size 2^( 2) =       0.000408972187
  error estimate for blocks of size 2^( 3) =       0.000416895314
  error estimate for blocks of size 2^( 4) =       0.000423881518
  error estimate for blocks of size 2^( 5) =       0.000427292995
  error estimate for blocks of size 2^( 6) =       0.000429158607
  error estimate for blocks of size 2^( 7) =       0.000430199205

      target function =                  N/A
              le_mean =     -17.217266846431
             les_mean =     296.753150973152
             stat err =       0.000427633081
             autocorr =       1.146975640961
              std dev =       0.564688827034
             le_variance =       0.318873471377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950691157
                                         uncertainty =       0.004271691730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950691157
                                         uncertainty =       0.004271691730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399295208
  error estimate for blocks of size 2^( 2) =       0.000408972102
  error estimate for blocks of size 2^( 3) =       0.000416895234
  error estimate for blocks of size 2^( 4) =       0.000423881442
  error estimate for blocks of size 2^( 5) =       0.000427292919
  error estimate for blocks of size 2^( 6) =       0.000429158533
  error estimate for blocks of size 2^( 7) =       0.000430199130

      target function =                  N/A
              le_mean =     -17.217266845847
             les_mean =     296.753150807936
             stat err =       0.000427633006
             autocorr =       1.146975758608
              std dev =       0.564688698551
             le_variance =       0.318873326271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950564164
                                         uncertainty =       0.004271689633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318950564164
                                         uncertainty =       0.004271689633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399295128
  error estimate for blocks of size 2^( 2) =       0.000408972028
  error estimate for blocks of size 2^( 3) =       0.000416895165
  error estimate for blocks of size 2^( 4) =       0.000423881375
  error estimate for blocks of size 2^( 5) =       0.000427292852
  error estimate for blocks of size 2^( 6) =       0.000429158468
  error estimate for blocks of size 2^( 7) =       0.000430199064

      target function =                  N/A
              le_mean =     -17.217266845336
             les_mean =     296.753150663350
             stat err =       0.000427632940
             autocorr =       1.146975861578
              std dev =       0.564688586105
             le_variance =       0.318873199278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217266845263        initial
     1.5625e+03     1.5625e+04             3.3401e-07       -17.217266846431  <--
     6.2500e+03     6.2500e+04             8.3510e-08       -17.217266845847
     2.5000e+04     2.5000e+05             2.0878e-08       -17.217266845336

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.8839e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817137e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495281e-01 1 1  ON 10
 ud_1                 9.091753e-02 1 1  ON 11
 ud_2                -1.919543e-02 1 1  ON 12
 ud_3                -8.106360e-02 1 1  ON 13
 ud_4                -1.309664e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934398e-02 1 1  ON 18
 ud_9                -8.482944e-03 1 1  ON 19
 eO_0                -9.257031e-01 1 1  ON 20
 eO_1                -6.031465e-01 1 1  ON 21
 eO_2                -1.884091e-01 1 1  ON 22
 eO_3                 8.085743e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151313e-02 1 1  ON 32
eH1_3                -5.387291e-02 1 1  ON 33
eH1_4                -7.403032e-03 1 1  ON 34
eH1_5                 4.737096e-03 1 1  ON 35
eH1_6                 4.141882e-02 1 1  ON 36
eH1_7                 6.403845e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657093e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795022e-03 1 1  ON 44
eH2_5                 9.095839e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.156
    reference variance = 0.272197
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1889e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318880152911
                                         uncertainty =       0.003350524033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318880152911
                                         uncertainty =       0.003350524033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399307905
  error estimate for blocks of size 2^( 2) =       0.000408677018
  error estimate for blocks of size 2^( 3) =       0.000416559004
  error estimate for blocks of size 2^( 4) =       0.000422576528
  error estimate for blocks of size 2^( 5) =       0.000427269876
  error estimate for blocks of size 2^( 6) =       0.000428369397
  error estimate for blocks of size 2^( 7) =       0.000429426968

      target function =                  N/A
              le_mean =     -17.216852216579
             les_mean =     296.738893693690
             stat err =       0.000426910692
             autocorr =       1.143031631461
              std dev =       0.564706654484
             le_variance =       0.318893605618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685221658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852216579       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216852227759       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216852228773       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216852228391       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216852228274       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216852228791       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216852228631       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.211470e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852216579       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216852219376       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216852219630       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216852219534       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216852219505       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216852219635       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216852219593       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.029717e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852216579       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216852217278       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216852217342       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216852217318       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216852217311       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216852217343       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216852217331       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 7.574941e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5901e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.908803e-01 1 1  ON 0
 uu_1                 2.817130e-02 1 1  ON 1
 uu_2                -6.766325e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604002e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690972e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495284e-01 1 1  ON 10
 ud_1                 9.091768e-02 1 1  ON 11
 ud_2                -1.919558e-02 1 1  ON 12
 ud_3                -8.106380e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482939e-03 1 1  ON 19
 eO_0                -9.257034e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884089e-01 1 1  ON 22
 eO_3                 8.085768e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328576e-01 1 1  ON 31
eH1_2                -9.151310e-02 1 1  ON 32
eH1_3                -5.387284e-02 1 1  ON 33
eH1_4                -7.403040e-03 1 1  ON 34
eH1_5                 4.737126e-03 1 1  ON 35
eH1_6                 4.141879e-02 1 1  ON 36
eH1_7                 6.403842e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280563e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901885e-02 1 1  ON 43
eH2_4                -2.794972e-03 1 1  ON 44
eH2_5                 9.095831e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635959e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2659
    reference variance = 0.34803
====================================================
  Execution time = 1.9765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2172e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321731935208
                                         uncertainty =       0.004832059927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321731935208
                                         uncertainty =       0.004832059927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401074791
  error estimate for blocks of size 2^( 2) =       0.000410467152
  error estimate for blocks of size 2^( 3) =       0.000418796353
  error estimate for blocks of size 2^( 4) =       0.000423987911
  error estimate for blocks of size 2^( 5) =       0.000428172719
  error estimate for blocks of size 2^( 6) =       0.000430060377
  error estimate for blocks of size 2^( 7) =       0.000429492060

      target function =                  N/A
              le_mean =     -17.216391362173
             les_mean =     296.725853351383
             stat err =       0.000427928267
             autocorr =       1.138390378363
              std dev =       0.567205409640
             le_variance =       0.321721976725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321732615780
                                         uncertainty =       0.004832079032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321732615780
                                         uncertainty =       0.004832079032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401075216
  error estimate for blocks of size 2^( 2) =       0.000410467539
  error estimate for blocks of size 2^( 3) =       0.000418796710
  error estimate for blocks of size 2^( 4) =       0.000423988249
  error estimate for blocks of size 2^( 5) =       0.000428173034
  error estimate for blocks of size 2^( 6) =       0.000430060691
  error estimate for blocks of size 2^( 7) =       0.000429492357

      target function =                  N/A
              le_mean =     -17.216391358680
             les_mean =     296.725853911911
             stat err =       0.000427928583
             autocorr =       1.138389652273
              std dev =       0.567206009793
             le_variance =       0.321722657546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321732275561
                                         uncertainty =       0.004832069483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321732275561
                                         uncertainty =       0.004832069483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401075004
  error estimate for blocks of size 2^( 2) =       0.000410467346
  error estimate for blocks of size 2^( 3) =       0.000418796532
  error estimate for blocks of size 2^( 4) =       0.000423988080
  error estimate for blocks of size 2^( 5) =       0.000428172876
  error estimate for blocks of size 2^( 6) =       0.000430060534
  error estimate for blocks of size 2^( 7) =       0.000429492209

      target function =                  N/A
              le_mean =     -17.216391360425
             les_mean =     296.725853631672
             stat err =       0.000427928425
             autocorr =       1.138390015146
              std dev =       0.567205709776
             le_variance =       0.321722317203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321731977753
                                         uncertainty =       0.004832061122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321731977753
                                         uncertainty =       0.004832061122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401074818
  error estimate for blocks of size 2^( 2) =       0.000410467176
  error estimate for blocks of size 2^( 3) =       0.000418796376
  error estimate for blocks of size 2^( 4) =       0.000423987932
  error estimate for blocks of size 2^( 5) =       0.000428172738
  error estimate for blocks of size 2^( 6) =       0.000430060396
  error estimate for blocks of size 2^( 7) =       0.000429492079

      target function =                  N/A
              le_mean =     -17.216391361955
             les_mean =     296.725853386415
             stat err =       0.000427928286
             autocorr =       1.138390332949
              std dev =       0.567205447158
             le_variance =       0.321722019286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216391362173        initial  <--
     3.9062e+02     3.9062e+03             1.2115e-06       -17.216391358680
     1.5625e+03     1.5625e+04             3.0297e-07       -17.216391360425
     6.2500e+03     6.2500e+04             7.5749e-08       -17.216391361955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9331
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817137e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495281e-01 1 1  ON 10
 ud_1                 9.091753e-02 1 1  ON 11
 ud_2                -1.919543e-02 1 1  ON 12
 ud_3                -8.106360e-02 1 1  ON 13
 ud_4                -1.309664e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934398e-02 1 1  ON 18
 ud_9                -8.482944e-03 1 1  ON 19
 eO_0                -9.257031e-01 1 1  ON 20
 eO_1                -6.031465e-01 1 1  ON 21
 eO_2                -1.884091e-01 1 1  ON 22
 eO_3                 8.085743e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151313e-02 1 1  ON 32
eH1_3                -5.387291e-02 1 1  ON 33
eH1_4                -7.403032e-03 1 1  ON 34
eH1_5                 4.737096e-03 1 1  ON 35
eH1_6                 4.141882e-02 1 1  ON 36
eH1_7                 6.403845e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657093e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795022e-03 1 1  ON 44
eH2_5                 9.095839e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1822
    reference variance = 0.319309
====================================================
  Execution time = 2.2292e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1835e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318369775905
                                         uncertainty =       0.004096124319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318369775905
                                         uncertainty =       0.004096124319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398967002
  error estimate for blocks of size 2^( 2) =       0.000408626521
  error estimate for blocks of size 2^( 3) =       0.000417502164
  error estimate for blocks of size 2^( 4) =       0.000423701814
  error estimate for blocks of size 2^( 5) =       0.000427071733
  error estimate for blocks of size 2^( 6) =       0.000428359102
  error estimate for blocks of size 2^( 7) =       0.000427202134

      target function =                  N/A
              le_mean =     -17.217124755577
             les_mean =     296.747734027584
             stat err =       0.000426583696
             autocorr =       1.143232467332
              std dev =       0.564224545422
             le_variance =       0.318349337657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712475558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124755577       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124755335       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124755051       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217124755204       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217124755320       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217124755393       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217124755415       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.146010e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124755577       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124755516       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124755446       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217124755483       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217124755512       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217124755528       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217124755527       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.865091e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217124755577       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217124755562       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217124755544       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217124755560       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217124755553       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217124755536       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217124755615       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.162768e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7847e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.908805e-01 1 1  ON 0
 uu_1                 2.817137e-02 1 1  ON 1
 uu_2                -6.766333e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723972e-01 1 1  ON 5
 uu_6                -1.595692e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091755e-02 1 1  ON 11
 ud_2                -1.919544e-02 1 1  ON 12
 ud_3                -8.106361e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482943e-03 1 1  ON 19
 eO_0                -9.257031e-01 1 1  ON 20
 eO_1                -6.031465e-01 1 1  ON 21
 eO_2                -1.884091e-01 1 1  ON 22
 eO_3                 8.085746e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341306e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151312e-02 1 1  ON 32
eH1_3                -5.387291e-02 1 1  ON 33
eH1_4                -7.403031e-03 1 1  ON 34
eH1_5                 4.737106e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403845e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657094e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795018e-03 1 1  ON 44
eH2_5                 9.095837e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.203788
====================================================
  Execution time = 2.1681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1619e-01
  Total weights = 2.0000e+06
  Execution time = 1.8383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238019802
                                         uncertainty =       0.002696056395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238019802
                                         uncertainty =       0.002696056395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397609217
  error estimate for blocks of size 2^( 2) =       0.000407470369
  error estimate for blocks of size 2^( 3) =       0.000416200212
  error estimate for blocks of size 2^( 4) =       0.000422786823
  error estimate for blocks of size 2^( 5) =       0.000427967262
  error estimate for blocks of size 2^( 6) =       0.000430974487
  error estimate for blocks of size 2^( 7) =       0.000431299177

      target function =                  N/A
              le_mean =     -17.217226088811
             les_mean =     296.749060214809
             stat err =       0.000428256937
             autocorr =       1.160101333762
              std dev =       0.562304347901
             le_variance =       0.316186179669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238086972
                                         uncertainty =       0.002696056691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238086972
                                         uncertainty =       0.002696056691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397609260
  error estimate for blocks of size 2^( 2) =       0.000407470409
  error estimate for blocks of size 2^( 3) =       0.000416200247
  error estimate for blocks of size 2^( 4) =       0.000422786857
  error estimate for blocks of size 2^( 5) =       0.000427967294
  error estimate for blocks of size 2^( 6) =       0.000430974520
  error estimate for blocks of size 2^( 7) =       0.000431299210

      target function =                  N/A
              le_mean =     -17.217226088971
             les_mean =     296.749060287450
             stat err =       0.000428256970
             autocorr =       1.160101264976
              std dev =       0.562304407597
             le_variance =       0.316186246803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238053388
                                         uncertainty =       0.002696056543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238053388
                                         uncertainty =       0.002696056543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397609239
  error estimate for blocks of size 2^( 2) =       0.000407470389
  error estimate for blocks of size 2^( 3) =       0.000416200229
  error estimate for blocks of size 2^( 4) =       0.000422786840
  error estimate for blocks of size 2^( 5) =       0.000427967278
  error estimate for blocks of size 2^( 6) =       0.000430974503
  error estimate for blocks of size 2^( 7) =       0.000431299193

      target function =                  N/A
              le_mean =     -17.217226088891
             les_mean =     296.749060251131
             stat err =       0.000428256954
             autocorr =       1.160101299367
              std dev =       0.562304377750
             le_variance =       0.316186213236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238024000
                                         uncertainty =       0.002696056414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316238024000
                                         uncertainty =       0.002696056414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397609220
  error estimate for blocks of size 2^( 2) =       0.000407470372
  error estimate for blocks of size 2^( 3) =       0.000416200214
  error estimate for blocks of size 2^( 4) =       0.000422786825
  error estimate for blocks of size 2^( 5) =       0.000427967264
  error estimate for blocks of size 2^( 6) =       0.000430974489
  error estimate for blocks of size 2^( 7) =       0.000431299179

      target function =                  N/A
              le_mean =     -17.217226088821
             les_mean =     296.749060219350
             stat err =       0.000428256939
             autocorr =       1.160101329451
              std dev =       0.562304351632
             le_variance =       0.316186183865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217226088811        initial
     3.9062e+03     3.9062e+04             1.1460e-07       -17.217226088971  <--
     1.5625e+04     1.5625e+05             2.8651e-08       -17.217226088891
     6.2500e+04     6.2500e+05             7.1628e-09       -17.217226088821

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 3.0898e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.0848
    reference variance = 0.277209
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2085e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320839092529
                                         uncertainty =       0.004710787938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320839092529
                                         uncertainty =       0.004710787938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400530549
  error estimate for blocks of size 2^( 2) =       0.000409818087
  error estimate for blocks of size 2^( 3) =       0.000418824713
  error estimate for blocks of size 2^( 4) =       0.000424948083
  error estimate for blocks of size 2^( 5) =       0.000428898909
  error estimate for blocks of size 2^( 6) =       0.000430457820
  error estimate for blocks of size 2^( 7) =       0.000432735874

      target function =                  N/A
              le_mean =     -17.216479503217
             les_mean =     296.728015766360
             stat err =       0.000429260171
             autocorr =       1.148602868497
              std dev =       0.566435735189
             le_variance =       0.320849442099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647950322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479503217       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479505506       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479505737       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216479506012       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216479505829       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216479505732       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216479505611       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.661719e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479503217       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479503789       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479503847       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216479503916       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216479503870       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216479503849       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216479503814       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.415615e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479503217       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479503360       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479503374       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216479503392       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216479503380       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216479503457       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216479503380       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.539152e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5771e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817134e-02 1 1  ON 1
 uu_2                -6.766331e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495283e-01 1 1  ON 10
 ud_1                 9.091767e-02 1 1  ON 11
 ud_2                -1.919552e-02 1 1  ON 12
 ud_3                -8.106373e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934400e-02 1 1  ON 18
 ud_9                -8.482941e-03 1 1  ON 19
 eO_0                -9.257033e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085766e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151313e-02 1 1  ON 32
eH1_3                -5.387294e-02 1 1  ON 33
eH1_4                -7.403006e-03 1 1  ON 34
eH1_5                 4.737149e-03 1 1  ON 35
eH1_6                 4.141882e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657098e-02 1 1  ON 42
eH2_3                -4.901887e-02 1 1  ON 43
eH2_4                -2.795002e-03 1 1  ON 44
eH2_5                 9.095847e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.352142
====================================================
  Execution time = 1.9848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2088e-01
  Total weights = 2.0000e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848609028
                                         uncertainty =       0.005493051263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848609028
                                         uncertainty =       0.005493051263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400548199
  error estimate for blocks of size 2^( 2) =       0.000410145375
  error estimate for blocks of size 2^( 3) =       0.000418771986
  error estimate for blocks of size 2^( 4) =       0.000424728339
  error estimate for blocks of size 2^( 5) =       0.000428682947
  error estimate for blocks of size 2^( 6) =       0.000429440994
  error estimate for blocks of size 2^( 7) =       0.000430952241

      target function =                  N/A
              le_mean =     -17.217072939906
             les_mean =     296.748478176972
             stat err =       0.000428451130
             autocorr =       1.144176488215
              std dev =       0.566460695330
             le_variance =       0.320877719354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848995705
                                         uncertainty =       0.005493047912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848995705
                                         uncertainty =       0.005493047912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400548440
  error estimate for blocks of size 2^( 2) =       0.000410145601
  error estimate for blocks of size 2^( 3) =       0.000418772194
  error estimate for blocks of size 2^( 4) =       0.000424728532
  error estimate for blocks of size 2^( 5) =       0.000428683136
  error estimate for blocks of size 2^( 6) =       0.000429441175
  error estimate for blocks of size 2^( 7) =       0.000430952425

      target function =                  N/A
              le_mean =     -17.217072939161
             les_mean =     296.748478537695
             stat err =       0.000428451317
             autocorr =       1.144176108004
              std dev =       0.566461036375
             le_variance =       0.320878105731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848802381
                                         uncertainty =       0.005493049586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848802381
                                         uncertainty =       0.005493049586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400548320
  error estimate for blocks of size 2^( 2) =       0.000410145488
  error estimate for blocks of size 2^( 3) =       0.000418772090
  error estimate for blocks of size 2^( 4) =       0.000424728435
  error estimate for blocks of size 2^( 5) =       0.000428683042
  error estimate for blocks of size 2^( 6) =       0.000429441085
  error estimate for blocks of size 2^( 7) =       0.000430952333

      target function =                  N/A
              le_mean =     -17.217072939533
             les_mean =     296.748478357331
             stat err =       0.000428451224
             autocorr =       1.144176298076
              std dev =       0.566460865866
             le_variance =       0.320877912557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848633197
                                         uncertainty =       0.005493051053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320848633197
                                         uncertainty =       0.005493051053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400548214
  error estimate for blocks of size 2^( 2) =       0.000410145389
  error estimate for blocks of size 2^( 3) =       0.000418771999
  error estimate for blocks of size 2^( 4) =       0.000424728351
  error estimate for blocks of size 2^( 5) =       0.000428682959
  error estimate for blocks of size 2^( 6) =       0.000429441005
  error estimate for blocks of size 2^( 7) =       0.000430952252

      target function =                  N/A
              le_mean =     -17.217072939860
             les_mean =     296.748478199516
             stat err =       0.000428451142
             autocorr =       1.144176464448
              std dev =       0.566460716647
             le_variance =       0.320877743504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217072939906        initial  <--
     9.7656e+02     9.7656e+03             5.6617e-07       -17.217072939161
     3.9062e+03     3.9062e+04             1.4156e-07       -17.217072939533
     1.5625e+04     1.5625e+05             3.5392e-08       -17.217072939860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0111
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4788e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.148937
====================================================
  Execution time = 2.0268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1581e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315838128091
                                         uncertainty =       0.003890281893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315838128091
                                         uncertainty =       0.003890281893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397371035
  error estimate for blocks of size 2^( 2) =       0.000406983829
  error estimate for blocks of size 2^( 3) =       0.000415319273
  error estimate for blocks of size 2^( 4) =       0.000420657574
  error estimate for blocks of size 2^( 5) =       0.000423098894
  error estimate for blocks of size 2^( 6) =       0.000425841315
  error estimate for blocks of size 2^( 7) =       0.000424912261

      target function =                  N/A
              le_mean =     -17.216772843210
             les_mean =     296.733074455174
             stat err =       0.000423627511
             autocorr =       1.136516898666
              std dev =       0.561967506535
             le_variance =       0.315807478401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677284321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772843210       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772843385       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772843380       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216772843379       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772843492       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216772843448       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216772843512       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 4.787577e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772843210       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772843253       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772843252       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216772843251       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772843261       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216772843255       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216772843282       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.196906e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216772843210       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216772843220       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216772843220       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216772843188       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772843229       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216772843275       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216772843216       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.992273e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5810e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919548e-02 1 1  ON 12
 ud_3                -8.106366e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085755e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403024e-03 1 1  ON 34
eH1_5                 4.737140e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795008e-03 1 1  ON 44
eH2_5                 9.095834e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1636
    reference variance = 0.227133
====================================================
  Execution time = 2.0018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2350e-01
  Total weights = 2.0000e+06
  Execution time = 1.8185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585564737
                                         uncertainty =       0.006780302285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585564737
                                         uncertainty =       0.006780302285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402180714
  error estimate for blocks of size 2^( 2) =       0.000411864206
  error estimate for blocks of size 2^( 3) =       0.000420583462
  error estimate for blocks of size 2^( 4) =       0.000426652179
  error estimate for blocks of size 2^( 5) =       0.000431006362
  error estimate for blocks of size 2^( 6) =       0.000433103302
  error estimate for blocks of size 2^( 7) =       0.000434332499

      target function =                  N/A
              le_mean =     -17.216243737917
             les_mean =     296.722546934388
             stat err =       0.000431273586
             autocorr =       1.149908378963
              std dev =       0.568769419692
             le_variance =       0.323498652777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585605426
                                         uncertainty =       0.006780304330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585605426
                                         uncertainty =       0.006780304330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402180739
  error estimate for blocks of size 2^( 2) =       0.000411864230
  error estimate for blocks of size 2^( 3) =       0.000420583483
  error estimate for blocks of size 2^( 4) =       0.000426652201
  error estimate for blocks of size 2^( 5) =       0.000431006383
  error estimate for blocks of size 2^( 6) =       0.000433103322
  error estimate for blocks of size 2^( 7) =       0.000434332519

      target function =                  N/A
              le_mean =     -17.216243737584
             les_mean =     296.722546963598
             stat err =       0.000431273606
             autocorr =       1.149908342880
              std dev =       0.568769455456
             le_variance =       0.323498693460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585585082
                                         uncertainty =       0.006780303308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585585082
                                         uncertainty =       0.006780303308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402180726
  error estimate for blocks of size 2^( 2) =       0.000411864218
  error estimate for blocks of size 2^( 3) =       0.000420583472
  error estimate for blocks of size 2^( 4) =       0.000426652190
  error estimate for blocks of size 2^( 5) =       0.000431006372
  error estimate for blocks of size 2^( 6) =       0.000433103312
  error estimate for blocks of size 2^( 7) =       0.000434332509

      target function =                  N/A
              le_mean =     -17.216243737750
             les_mean =     296.722546948993
             stat err =       0.000431273596
             autocorr =       1.149908360928
              std dev =       0.568769437575
             le_variance =       0.323498673119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585567280
                                         uncertainty =       0.006780302413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323585567280
                                         uncertainty =       0.006780302413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402180715
  error estimate for blocks of size 2^( 2) =       0.000411864208
  error estimate for blocks of size 2^( 3) =       0.000420583463
  error estimate for blocks of size 2^( 4) =       0.000426652181
  error estimate for blocks of size 2^( 5) =       0.000431006363
  error estimate for blocks of size 2^( 6) =       0.000433103303
  error estimate for blocks of size 2^( 7) =       0.000434332501

      target function =                  N/A
              le_mean =     -17.216243737896
             les_mean =     296.722546936214
             stat err =       0.000431273587
             autocorr =       1.149908376712
              std dev =       0.568769421928
             le_variance =       0.323498655320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216243737917        initial  <--
     9.7656e+03     9.7656e+04             4.7876e-08       -17.216243737584
     3.9062e+04     3.9062e+05             1.1969e-08       -17.216243737750
     1.5625e+05     1.5625e+06             2.9923e-09       -17.216243737896

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2188
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.318841
====================================================
  Execution time = 1.9977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2484e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324887872581
                                         uncertainty =       0.005363466000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324887872581
                                         uncertainty =       0.005363466000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403013000
  error estimate for blocks of size 2^( 2) =       0.000412606202
  error estimate for blocks of size 2^( 3) =       0.000421108661
  error estimate for blocks of size 2^( 4) =       0.000427427010
  error estimate for blocks of size 2^( 5) =       0.000431602782
  error estimate for blocks of size 2^( 6) =       0.000434260020
  error estimate for blocks of size 2^( 7) =       0.000434991794

      target function =                  N/A
              le_mean =     -17.217310549895
             les_mean =     296.760621365045
             stat err =       0.000432070401
             autocorr =       1.149399284560
              std dev =       0.569946450060
             le_variance =       0.324838955936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731054990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217310549895       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217310549912       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217310549924       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217310549933       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217310549957       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217310549918       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217310549965       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 4.273438e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217310549895       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217310549899       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217310549902       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217310549904       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217310549812       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217310549872       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217310549466       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.068361e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217310549895       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217310549896       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217310549897       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217310550104       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217310549897       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217310549708       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217310550072       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.670904e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5631e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095832e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1478
    reference variance = 0.221293
====================================================
  Execution time = 1.9676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1591e-01
  Total weights = 2.0000e+06
  Execution time = 1.8105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863429063
                                         uncertainty =       0.002983752203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863429063
                                         uncertainty =       0.002983752203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397433894
  error estimate for blocks of size 2^( 2) =       0.000407309738
  error estimate for blocks of size 2^( 3) =       0.000415646426
  error estimate for blocks of size 2^( 4) =       0.000421929274
  error estimate for blocks of size 2^( 5) =       0.000425371588
  error estimate for blocks of size 2^( 6) =       0.000427861878
  error estimate for blocks of size 2^( 7) =       0.000429155279

      target function =                  N/A
              le_mean =     -17.217183952412
             les_mean =     296.747330494031
             stat err =       0.000426079505
             autocorr =       1.149347838843
              std dev =       0.562056403573
             le_variance =       0.315907400798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863432605
                                         uncertainty =       0.002983752223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863432605
                                         uncertainty =       0.002983752223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397433897
  error estimate for blocks of size 2^( 2) =       0.000407309740
  error estimate for blocks of size 2^( 3) =       0.000415646428
  error estimate for blocks of size 2^( 4) =       0.000421929276
  error estimate for blocks of size 2^( 5) =       0.000425371590
  error estimate for blocks of size 2^( 6) =       0.000427861879
  error estimate for blocks of size 2^( 7) =       0.000429155280

      target function =                  N/A
              le_mean =     -17.217183952409
             les_mean =     296.747330497466
             stat err =       0.000426079506
             autocorr =       1.149347835451
              std dev =       0.562056406725
             le_variance =       0.315907404340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863430834
                                         uncertainty =       0.002983752213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863430834
                                         uncertainty =       0.002983752213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397433895
  error estimate for blocks of size 2^( 2) =       0.000407309739
  error estimate for blocks of size 2^( 3) =       0.000415646427
  error estimate for blocks of size 2^( 4) =       0.000421929275
  error estimate for blocks of size 2^( 5) =       0.000425371589
  error estimate for blocks of size 2^( 6) =       0.000427861879
  error estimate for blocks of size 2^( 7) =       0.000429155280

      target function =                  N/A
              le_mean =     -17.217183952410
             les_mean =     296.747330495749
             stat err =       0.000426079505
             autocorr =       1.149347837150
              std dev =       0.562056405149
             le_variance =       0.315907402569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863429285
                                         uncertainty =       0.002983752205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315863429285
                                         uncertainty =       0.002983752205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397433895
  error estimate for blocks of size 2^( 2) =       0.000407309738
  error estimate for blocks of size 2^( 3) =       0.000415646426
  error estimate for blocks of size 2^( 4) =       0.000421929274
  error estimate for blocks of size 2^( 5) =       0.000425371588
  error estimate for blocks of size 2^( 6) =       0.000427861878
  error estimate for blocks of size 2^( 7) =       0.000429155279

      target function =                  N/A
              le_mean =     -17.217183952412
             les_mean =     296.747330494246
             stat err =       0.000426079505
             autocorr =       1.149347838633
              std dev =       0.562056403771
             le_variance =       0.315907401019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217183952412        initial  <--
     9.7656e+04     9.7656e+05             4.2734e-09       -17.217183952409
     3.9062e+05     3.9062e+06             1.0684e-09       -17.217183952410
     1.5625e+06     1.5625e+07             2.6709e-10       -17.217183952412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8014
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4439e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.398815
====================================================
  Execution time = 2.0314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2704e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327046589019
                                         uncertainty =       0.006740613036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327046589019
                                         uncertainty =       0.006740613036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404374995
  error estimate for blocks of size 2^( 2) =       0.000414048258
  error estimate for blocks of size 2^( 3) =       0.000422649026
  error estimate for blocks of size 2^( 4) =       0.000428885291
  error estimate for blocks of size 2^( 5) =       0.000431663229
  error estimate for blocks of size 2^( 6) =       0.000435302048
  error estimate for blocks of size 2^( 7) =       0.000435623984

      target function =                  N/A
              le_mean =     -17.217138692467
             les_mean =     296.756902864499
             stat err =       0.000432868638
             autocorr =       1.145891925018
              std dev =       0.571872601517
             le_variance =       0.327038272366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713869247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217138692467       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217138692470       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217138692470       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217138692452       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217138692479       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217138692730       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217138692495       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 5.892070e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217138692467       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217138692468       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217138692468       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217138692445       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217138689022       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217138690305       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217138692374       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.473024e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217138692467       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217138692467       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217138692467       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217138694620       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217138692467       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217138701652       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217138702068       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 3.682517e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5847e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095832e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2063
    reference variance = 0.439432
====================================================
  Execution time = 1.9422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1442e-01
  Total weights = 2.0000e+06
  Execution time = 1.8082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516437
                                         uncertainty =       0.005251572481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516437
                                         uncertainty =       0.005251572481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396498633
  error estimate for blocks of size 2^( 2) =       0.000406093392
  error estimate for blocks of size 2^( 3) =       0.000414970728
  error estimate for blocks of size 2^( 4) =       0.000421744919
  error estimate for blocks of size 2^( 5) =       0.000426874857
  error estimate for blocks of size 2^( 6) =       0.000428824045
  error estimate for blocks of size 2^( 7) =       0.000431161911

      target function =                  N/A
              le_mean =     -17.217576167919
             les_mean =     296.759351272664
             stat err =       0.000427151433
             autocorr =       1.160594068337
              std dev =       0.560733744108
             le_variance =       0.314422331782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516644
                                         uncertainty =       0.005251572479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516644
                                         uncertainty =       0.005251572479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396498633
  error estimate for blocks of size 2^( 2) =       0.000406093393
  error estimate for blocks of size 2^( 3) =       0.000414970728
  error estimate for blocks of size 2^( 4) =       0.000421744919
  error estimate for blocks of size 2^( 5) =       0.000426874857
  error estimate for blocks of size 2^( 6) =       0.000428824045
  error estimate for blocks of size 2^( 7) =       0.000431161911

      target function =                  N/A
              le_mean =     -17.217576167918
             les_mean =     296.759351272846
             stat err =       0.000427151433
             autocorr =       1.160594068073
              std dev =       0.560733744294
             le_variance =       0.314422331990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516540
                                         uncertainty =       0.005251572480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516540
                                         uncertainty =       0.005251572480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396498633
  error estimate for blocks of size 2^( 2) =       0.000406093393
  error estimate for blocks of size 2^( 3) =       0.000414970728
  error estimate for blocks of size 2^( 4) =       0.000421744919
  error estimate for blocks of size 2^( 5) =       0.000426874857
  error estimate for blocks of size 2^( 6) =       0.000428824045
  error estimate for blocks of size 2^( 7) =       0.000431161911

      target function =                  N/A
              le_mean =     -17.217576167919
             les_mean =     296.759351272755
             stat err =       0.000427151433
             autocorr =       1.160594068200
              std dev =       0.560733744201
             le_variance =       0.314422331886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516450
                                         uncertainty =       0.005251572481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314413516450
                                         uncertainty =       0.005251572481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396498633
  error estimate for blocks of size 2^( 2) =       0.000406093392
  error estimate for blocks of size 2^( 3) =       0.000414970728
  error estimate for blocks of size 2^( 4) =       0.000421744919
  error estimate for blocks of size 2^( 5) =       0.000426874857
  error estimate for blocks of size 2^( 6) =       0.000428824045
  error estimate for blocks of size 2^( 7) =       0.000431161911

      target function =                  N/A
              le_mean =     -17.217576167919
             les_mean =     296.759351272675
             stat err =       0.000427151433
             autocorr =       1.160594068315
              std dev =       0.560733744120
             le_variance =       0.314422331795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217576167919        initial  <--
     9.7656e+05     9.7656e+06             5.8921e-10       -17.217576167918
     3.9062e+06     3.9062e+07             1.4730e-10       -17.217576167919
     1.5625e+07     1.5625e+08             3.6825e-11       -17.217576167919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.5285
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4381e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.333748
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318007699341
                                         uncertainty =       0.004351043518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318007699341
                                         uncertainty =       0.004351043518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398696471
  error estimate for blocks of size 2^( 2) =       0.000408084981
  error estimate for blocks of size 2^( 3) =       0.000416443418
  error estimate for blocks of size 2^( 4) =       0.000422596156
  error estimate for blocks of size 2^( 5) =       0.000426416268
  error estimate for blocks of size 2^( 6) =       0.000428837194
  error estimate for blocks of size 2^( 7) =       0.000429691065

      target function =                  N/A
              le_mean =     -17.216789360032
             les_mean =     296.735753461461
             stat err =       0.000426885171
             autocorr =       1.146403103249
              std dev =       0.563841957206
             le_variance =       0.317917752705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678936003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216789360032       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216789360032       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216789360032       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216789360032       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216789360256       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216789356761       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216789360195       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 4.554097e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216789360032       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216789360032       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216789360032       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216789354287       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216789360032       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216789406151       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216789319238       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 1.138513e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216789360032       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216789360032       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216789360032       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216789364274       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216789367354       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216789441105       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216789239944       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 2.846298e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9274e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1683
    reference variance = 0.172181
====================================================
  Execution time = 1.9641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.0000e+06
  Execution time = 1.8077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181486
                                         uncertainty =       0.004310085710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181486
                                         uncertainty =       0.004310085710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364347
  error estimate for blocks of size 2^( 2) =       0.000409278428
  error estimate for blocks of size 2^( 3) =       0.000417953574
  error estimate for blocks of size 2^( 4) =       0.000424305921
  error estimate for blocks of size 2^( 5) =       0.000427658771
  error estimate for blocks of size 2^( 6) =       0.000430524609
  error estimate for blocks of size 2^( 7) =       0.000433615489

      target function =                  N/A
              le_mean =     -17.217201321871
             les_mean =     296.751004960911
             stat err =       0.000429026198
             autocorr =       1.154061741539
              std dev =       0.564786475197
             le_variance =       0.318983762566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181518
                                         uncertainty =       0.004310085711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181518
                                         uncertainty =       0.004310085711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364347
  error estimate for blocks of size 2^( 2) =       0.000409278428
  error estimate for blocks of size 2^( 3) =       0.000417953574
  error estimate for blocks of size 2^( 4) =       0.000424305921
  error estimate for blocks of size 2^( 5) =       0.000427658771
  error estimate for blocks of size 2^( 6) =       0.000430524609
  error estimate for blocks of size 2^( 7) =       0.000433615489

      target function =                  N/A
              le_mean =     -17.217201321871
             les_mean =     296.751004960939
             stat err =       0.000429026198
             autocorr =       1.154061741514
              std dev =       0.564786475226
             le_variance =       0.318983762598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181502
                                         uncertainty =       0.004310085711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181502
                                         uncertainty =       0.004310085711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364347
  error estimate for blocks of size 2^( 2) =       0.000409278428
  error estimate for blocks of size 2^( 3) =       0.000417953574
  error estimate for blocks of size 2^( 4) =       0.000424305921
  error estimate for blocks of size 2^( 5) =       0.000427658771
  error estimate for blocks of size 2^( 6) =       0.000430524609
  error estimate for blocks of size 2^( 7) =       0.000433615489

      target function =                  N/A
              le_mean =     -17.217201321871
             les_mean =     296.751004960925
             stat err =       0.000429026198
             autocorr =       1.154061741532
              std dev =       0.564786475212
             le_variance =       0.318983762582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181488
                                         uncertainty =       0.004310085710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319038181488
                                         uncertainty =       0.004310085710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364347
  error estimate for blocks of size 2^( 2) =       0.000409278428
  error estimate for blocks of size 2^( 3) =       0.000417953574
  error estimate for blocks of size 2^( 4) =       0.000424305921
  error estimate for blocks of size 2^( 5) =       0.000427658771
  error estimate for blocks of size 2^( 6) =       0.000430524609
  error estimate for blocks of size 2^( 7) =       0.000433615489

      target function =                  N/A
              le_mean =     -17.217201321871
             les_mean =     296.751004960913
             stat err =       0.000429026198
             autocorr =       1.154061741545
              std dev =       0.564786475199
             le_variance =       0.318983762568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217201321871        initial  <--
     9.7656e+06     9.7656e+07             4.5541e-11       -17.217201321871
     3.9062e+07     3.9062e+08             1.1385e-11       -17.217201321871
     1.5625e+08     1.5625e+09             2.8463e-12       -17.217201321871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.5155
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.183192
====================================================
  Execution time = 2.0066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324681367206
                                         uncertainty =       0.004413062221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324681367206
                                         uncertainty =       0.004413062221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402906571
  error estimate for blocks of size 2^( 2) =       0.000412319100
  error estimate for blocks of size 2^( 3) =       0.000420628510
  error estimate for blocks of size 2^( 4) =       0.000427632595
  error estimate for blocks of size 2^( 5) =       0.000430915117
  error estimate for blocks of size 2^( 6) =       0.000433391996
  error estimate for blocks of size 2^( 7) =       0.000434667728

      target function =                  N/A
              le_mean =     -17.216384120159
             les_mean =     296.728549420602
             stat err =       0.000431651859
             autocorr =       1.147779675686
              std dev =       0.569795937235
             le_variance =       0.324667410089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638412016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384120159       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384120159       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384120159       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384121296       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384065773       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216384061397       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384137771       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 4.270917e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384120159       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384120159       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384120159       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384089375       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384070695       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216384048972       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384232109       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.067870e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384120159       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384120159       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384120159       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216384214416       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216384155854       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383806409       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216384079746       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 2.669009e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5670e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2405
    reference variance = 0.309682
====================================================
  Execution time = 1.9591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1906e-01
  Total weights = 2.0000e+06
  Execution time = 1.8029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241324
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241324
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399414056
  error estimate for blocks of size 2^( 2) =       0.000409250584
  error estimate for blocks of size 2^( 3) =       0.000417253414
  error estimate for blocks of size 2^( 4) =       0.000422523966
  error estimate for blocks of size 2^( 5) =       0.000426568626
  error estimate for blocks of size 2^( 6) =       0.000428968245
  error estimate for blocks of size 2^( 7) =       0.000430374185

      target function =                  N/A
              le_mean =     -17.217062242855
             les_mean =     296.746295291328
             stat err =       0.000427108755
             autocorr =       1.143484440827
              std dev =       0.564856775239
             le_variance =       0.319063176533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241327
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241327
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399414056
  error estimate for blocks of size 2^( 2) =       0.000409250584
  error estimate for blocks of size 2^( 3) =       0.000417253414
  error estimate for blocks of size 2^( 4) =       0.000422523966
  error estimate for blocks of size 2^( 5) =       0.000426568626
  error estimate for blocks of size 2^( 6) =       0.000428968245
  error estimate for blocks of size 2^( 7) =       0.000430374185

      target function =                  N/A
              le_mean =     -17.217062242855
             les_mean =     296.746295291332
             stat err =       0.000427108755
             autocorr =       1.143484440813
              std dev =       0.564856775241
             le_variance =       0.319063176536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241325
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241325
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399414056
  error estimate for blocks of size 2^( 2) =       0.000409250584
  error estimate for blocks of size 2^( 3) =       0.000417253414
  error estimate for blocks of size 2^( 4) =       0.000422523966
  error estimate for blocks of size 2^( 5) =       0.000426568626
  error estimate for blocks of size 2^( 6) =       0.000428968245
  error estimate for blocks of size 2^( 7) =       0.000430374185

      target function =                  N/A
              le_mean =     -17.217062242855
             les_mean =     296.746295291330
             stat err =       0.000427108755
             autocorr =       1.143484440809
              std dev =       0.564856775240
             le_variance =       0.319063176534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241324
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319071241324
                                         uncertainty =       0.003427819174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399414056
  error estimate for blocks of size 2^( 2) =       0.000409250584
  error estimate for blocks of size 2^( 3) =       0.000417253414
  error estimate for blocks of size 2^( 4) =       0.000422523966
  error estimate for blocks of size 2^( 5) =       0.000426568626
  error estimate for blocks of size 2^( 6) =       0.000428968245
  error estimate for blocks of size 2^( 7) =       0.000430374185

      target function =                  N/A
              le_mean =     -17.217062242855
             les_mean =     296.746295291328
             stat err =       0.000427108755
             autocorr =       1.143484440828
              std dev =       0.564856775239
             le_variance =       0.319063176533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217062242855        initial
     9.7656e+07     9.7656e+08             4.2709e-12       -17.217062242855  <--
     3.9062e+08     3.9062e+09             1.0679e-12       -17.217062242855
     1.5625e+09     1.5625e+10             2.6690e-13       -17.217062242855

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 2.8683e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.118693
====================================================
  Execution time = 2.0194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1616e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316105385563
                                         uncertainty =       0.003046890151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316105385563
                                         uncertainty =       0.003046890151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397590601
  error estimate for blocks of size 2^( 2) =       0.000406900239
  error estimate for blocks of size 2^( 3) =       0.000415839690
  error estimate for blocks of size 2^( 4) =       0.000421946698
  error estimate for blocks of size 2^( 5) =       0.000426433782
  error estimate for blocks of size 2^( 6) =       0.000427829022
  error estimate for blocks of size 2^( 7) =       0.000430378538

      target function =                  N/A
              le_mean =     -17.216321221701
             les_mean =     296.717872822273
             stat err =       0.000426647010
             autocorr =       1.151503320225
              std dev =       0.562278019796
             le_variance =       0.316156571545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632122170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321221701       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216321221702       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216321221702       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216321213388       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216321234284       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216321222329       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216321212705       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216321182406       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.113669e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321221701       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216321221701       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216321221701       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216321221701       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216321221307       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216321335048       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216321224194       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216321025946       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 5.284527e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321221701       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216321221701       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216321221701       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216321222553       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216321305632       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216321251252       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216321152578       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216321126990       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.320984e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5848e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.270933
====================================================
  Execution time = 1.9657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881978
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881978
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403867219
  error estimate for blocks of size 2^( 2) =       0.000413261038
  error estimate for blocks of size 2^( 3) =       0.000421423227
  error estimate for blocks of size 2^( 4) =       0.000427487677
  error estimate for blocks of size 2^( 5) =       0.000431092791
  error estimate for blocks of size 2^( 6) =       0.000432794648
  error estimate for blocks of size 2^( 7) =       0.000433338156

      target function =                  N/A
              le_mean =     -17.216678154640
             les_mean =     296.740223979106
             stat err =       0.000431178318
             autocorr =       1.139820908989
              std dev =       0.571154499012
             le_variance =       0.326217461742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881995
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881995
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403867219
  error estimate for blocks of size 2^( 2) =       0.000413261038
  error estimate for blocks of size 2^( 3) =       0.000421423227
  error estimate for blocks of size 2^( 4) =       0.000427487677
  error estimate for blocks of size 2^( 5) =       0.000431092791
  error estimate for blocks of size 2^( 6) =       0.000432794648
  error estimate for blocks of size 2^( 7) =       0.000433338156

      target function =                  N/A
              le_mean =     -17.216678154640
             les_mean =     296.740223979122
             stat err =       0.000431178318
             autocorr =       1.139820908977
              std dev =       0.571154499027
             le_variance =       0.326217461759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881986
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881986
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403867219
  error estimate for blocks of size 2^( 2) =       0.000413261038
  error estimate for blocks of size 2^( 3) =       0.000421423227
  error estimate for blocks of size 2^( 4) =       0.000427487677
  error estimate for blocks of size 2^( 5) =       0.000431092791
  error estimate for blocks of size 2^( 6) =       0.000432794648
  error estimate for blocks of size 2^( 7) =       0.000433338156

      target function =                  N/A
              le_mean =     -17.216678154640
             les_mean =     296.740223979114
             stat err =       0.000431178318
             autocorr =       1.139820908981
              std dev =       0.571154499020
             le_variance =       0.326217461751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881979
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325758881979
                                         uncertainty =       0.005556350671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403867219
  error estimate for blocks of size 2^( 2) =       0.000413261038
  error estimate for blocks of size 2^( 3) =       0.000421423227
  error estimate for blocks of size 2^( 4) =       0.000427487677
  error estimate for blocks of size 2^( 5) =       0.000431092791
  error estimate for blocks of size 2^( 6) =       0.000432794648
  error estimate for blocks of size 2^( 7) =       0.000433338156

      target function =                  N/A
              le_mean =     -17.216678154640
             les_mean =     296.740223979107
             stat err =       0.000431178318
             autocorr =       1.139820908987
              std dev =       0.571154499013
             le_variance =       0.326217461743


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216678154640        initial  <--
     2.4414e+07     2.4414e+08             2.1137e-11       -17.216678154640
     9.7656e+07     9.7656e+08             5.2845e-12       -17.216678154640
     3.9062e+08     3.9062e+09             1.3210e-12       -17.216678154640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8053
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2302
    reference variance = 0.202433
====================================================
  Execution time = 2.0007e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317662713367
                                         uncertainty =       0.003658084613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317662713367
                                         uncertainty =       0.003658084613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398532742
  error estimate for blocks of size 2^( 2) =       0.000408054046
  error estimate for blocks of size 2^( 3) =       0.000416756212
  error estimate for blocks of size 2^( 4) =       0.000422593203
  error estimate for blocks of size 2^( 5) =       0.000426087731
  error estimate for blocks of size 2^( 6) =       0.000428468686
  error estimate for blocks of size 2^( 7) =       0.000429288463

      target function =                  N/A
              le_mean =     -17.216430096206
             les_mean =     296.723121790939
             stat err =       0.000426609521
             autocorr =       1.145863994466
              std dev =       0.563610408189
             le_variance =       0.317656692219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643009621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430096206       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430096206       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430096206       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430096206       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216430105945       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216430058042       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216430086702       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.066520e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430096206       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430096206       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430096206       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430096206       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216430093569       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216434549532       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216431835171       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 5.187063e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430096206       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430096206       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430096206       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216428312940       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429782949       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216431308234       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216432974462       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 1.291424e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5648e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2338
    reference variance = 0.20976
====================================================
  Execution time = 1.9523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2018e-01
  Total weights = 2.0000e+06
  Execution time = 1.8059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938125
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938125
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400113259
  error estimate for blocks of size 2^( 2) =       0.000409803459
  error estimate for blocks of size 2^( 3) =       0.000418696176
  error estimate for blocks of size 2^( 4) =       0.000425666985
  error estimate for blocks of size 2^( 5) =       0.000429356071
  error estimate for blocks of size 2^( 6) =       0.000429804079
  error estimate for blocks of size 2^( 7) =       0.000431822979

      target function =                  N/A
              le_mean =     -17.216532014827
             les_mean =     296.729155697811
             stat err =       0.000429162529
             autocorr =       1.150476372326
              std dev =       0.565845597617
             le_variance =       0.320181240342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938127
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938127
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400113259
  error estimate for blocks of size 2^( 2) =       0.000409803459
  error estimate for blocks of size 2^( 3) =       0.000418696176
  error estimate for blocks of size 2^( 4) =       0.000425666985
  error estimate for blocks of size 2^( 5) =       0.000429356071
  error estimate for blocks of size 2^( 6) =       0.000429804079
  error estimate for blocks of size 2^( 7) =       0.000431822979

      target function =                  N/A
              le_mean =     -17.216532014827
             les_mean =     296.729155697813
             stat err =       0.000429162529
             autocorr =       1.150476372320
              std dev =       0.565845597618
             le_variance =       0.320181240344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938126
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938126
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400113259
  error estimate for blocks of size 2^( 2) =       0.000409803459
  error estimate for blocks of size 2^( 3) =       0.000418696176
  error estimate for blocks of size 2^( 4) =       0.000425666985
  error estimate for blocks of size 2^( 5) =       0.000429356071
  error estimate for blocks of size 2^( 6) =       0.000429804079
  error estimate for blocks of size 2^( 7) =       0.000431822979

      target function =                  N/A
              le_mean =     -17.216532014827
             les_mean =     296.729155697812
             stat err =       0.000429162529
             autocorr =       1.150476372327
              std dev =       0.565845597618
             le_variance =       0.320181240343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938125
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320251938125
                                         uncertainty =       0.004248198724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400113259
  error estimate for blocks of size 2^( 2) =       0.000409803459
  error estimate for blocks of size 2^( 3) =       0.000418696176
  error estimate for blocks of size 2^( 4) =       0.000425666985
  error estimate for blocks of size 2^( 5) =       0.000429356071
  error estimate for blocks of size 2^( 6) =       0.000429804079
  error estimate for blocks of size 2^( 7) =       0.000431822979

      target function =                  N/A
              le_mean =     -17.216532014827
             les_mean =     296.729155697811
             stat err =       0.000429162529
             autocorr =       1.150476372321
              std dev =       0.565845597617
             le_variance =       0.320181240342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216532014827        initial
     2.4414e+08     2.4414e+09             2.0665e-12       -17.216532014827
     9.7656e+08     9.7656e+09             5.1871e-13       -17.216532014827
     3.9062e+09     3.9062e+10             1.2914e-13       -17.216532014827  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+09     and shift_s =   3.9062e+10
*****************************************************************************

  Execution time = 2.8628e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.217177
====================================================
  Execution time = 2.0024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316746653432
                                         uncertainty =       0.003025265921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316746653432
                                         uncertainty =       0.003025265921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397991945
  error estimate for blocks of size 2^( 2) =       0.000407774071
  error estimate for blocks of size 2^( 3) =       0.000415983886
  error estimate for blocks of size 2^( 4) =       0.000422596507
  error estimate for blocks of size 2^( 5) =       0.000426508552
  error estimate for blocks of size 2^( 6) =       0.000429010183
  error estimate for blocks of size 2^( 7) =       0.000429999379

      target function =                  N/A
              le_mean =     -17.216596570364
             les_mean =     296.727992484295
             stat err =       0.000427028655
             autocorr =       1.151238946357
              std dev =       0.562845605849
             le_variance =       0.316795176024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659657036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596570364       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596570364       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216596570364       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216596570364       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216596311213       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216596806016       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216596145893       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216596223814       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 6.445591e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596570364       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596570364       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216596570364       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216597244444       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216596380873       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216595995028       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216593024596       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216596296717       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 1.612667e-13

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596570364       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596570364       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216596570364       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216596626885       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216586609216       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216600774152       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594135690       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216599142842       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+10 is 4.042843e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5551e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2399
    reference variance = 0.205567
====================================================
  Execution time = 1.9745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1489e-01
  Total weights = 2.0000e+06
  Execution time = 1.8075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396794748
  error estimate for blocks of size 2^( 2) =       0.000406540089
  error estimate for blocks of size 2^( 3) =       0.000415167461
  error estimate for blocks of size 2^( 4) =       0.000422497663
  error estimate for blocks of size 2^( 5) =       0.000426456539
  error estimate for blocks of size 2^( 6) =       0.000427736763
  error estimate for blocks of size 2^( 7) =       0.000428488267

      target function =                  N/A
              le_mean =     -17.216381261687
             les_mean =     296.718675733978
             stat err =       0.000426294808
             autocorr =       1.154219101651
              std dev =       0.561152513708
             le_variance =       0.314892143640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396794748
  error estimate for blocks of size 2^( 2) =       0.000406540089
  error estimate for blocks of size 2^( 3) =       0.000415167461
  error estimate for blocks of size 2^( 4) =       0.000422497663
  error estimate for blocks of size 2^( 5) =       0.000426456539
  error estimate for blocks of size 2^( 6) =       0.000427736763
  error estimate for blocks of size 2^( 7) =       0.000428488267

      target function =                  N/A
              le_mean =     -17.216381261687
             les_mean =     296.718675733978
             stat err =       0.000426294808
             autocorr =       1.154219101650
              std dev =       0.561152513708
             le_variance =       0.314892143641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396794748
  error estimate for blocks of size 2^( 2) =       0.000406540089
  error estimate for blocks of size 2^( 3) =       0.000415167461
  error estimate for blocks of size 2^( 4) =       0.000422497663
  error estimate for blocks of size 2^( 5) =       0.000426456539
  error estimate for blocks of size 2^( 6) =       0.000427736763
  error estimate for blocks of size 2^( 7) =       0.000428488267

      target function =                  N/A
              le_mean =     -17.216381261687
             les_mean =     296.718675733978
             stat err =       0.000426294808
             autocorr =       1.154219101649
              std dev =       0.561152513708
             le_variance =       0.314892143641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314909370373
                                         uncertainty =       0.003533846288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396794748
  error estimate for blocks of size 2^( 2) =       0.000406540089
  error estimate for blocks of size 2^( 3) =       0.000415167461
  error estimate for blocks of size 2^( 4) =       0.000422497663
  error estimate for blocks of size 2^( 5) =       0.000426456539
  error estimate for blocks of size 2^( 6) =       0.000427736763
  error estimate for blocks of size 2^( 7) =       0.000428488267

      target function =                  N/A
              le_mean =     -17.216381261687
             les_mean =     296.718675733978
             stat err =       0.000426294808
             autocorr =       1.154219101651
              std dev =       0.561152513708
             le_variance =       0.314892143640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216381261687        initial  <--
     9.7656e+08     9.7656e+09             6.4456e-13       -17.216381261687
     3.9062e+09     3.9062e+10             1.6127e-13       -17.216381261687
     1.5625e+10     1.5625e+11             4.0428e-14       -17.216381261687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8722
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.211
    reference variance = 0.254763
====================================================
  Execution time = 1.9911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317968726091
                                         uncertainty =       0.003056696897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317968726091
                                         uncertainty =       0.003056696897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398677645
  error estimate for blocks of size 2^( 2) =       0.000408261202
  error estimate for blocks of size 2^( 3) =       0.000416900542
  error estimate for blocks of size 2^( 4) =       0.000422802183
  error estimate for blocks of size 2^( 5) =       0.000427718959
  error estimate for blocks of size 2^( 6) =       0.000429904760
  error estimate for blocks of size 2^( 7) =       0.000431374968

      target function =                  N/A
              le_mean =     -17.216711714395
             les_mean =     296.733049826185
             stat err =       0.000427950217
             autocorr =       1.152239435256
              std dev =       0.563815331965
             le_variance =       0.317887728558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671171439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711714395       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711714395       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711714395       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711714395       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216710596465       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216710539066       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216712345013       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 4.891648e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711714395       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711714395       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711714395       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711714395       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709062768       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216710431820       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216715859774       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216704880035       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216706197900       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216904681980       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216704978598       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216649413165       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216769156746       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216682903936       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216650139638       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216609965967       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216679200104       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216923664396       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216699652076       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217134460997       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216901859998       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213488579850       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.212498491312       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218720929359       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.220096444425       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.219019629031       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.220649317607       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.229512309162       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.234514919425       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.229733403594       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.238444251910       residual = 7.17e-02           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 1.224779e-14

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711714395       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711714395       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711714395       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711714395       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216727518392       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216677339068       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217280724297       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217108936613       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217625633543       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216174147325       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.220451194681       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216530223184       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214691835022       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213792984639       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.220342227453       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216380270071       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.219151128985       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218541154116       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.219999286301       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.191948070015       residual = 9.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214976858731       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.210158641326       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.210587752636       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217448580872       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.243677698481       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.289898334371       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.208558334848       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.239486011523       residual = 8.61e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.267071123424       residual = 4.17e-01           smallest_sin_value = 9.91e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+11 is 2.868265e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5494e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2518
    reference variance = 0.263841
====================================================
  Execution time = 1.9528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1622e-01
  Total weights = 2.0000e+06
  Execution time = 2.0372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630482
  error estimate for blocks of size 2^( 2) =       0.000407244709
  error estimate for blocks of size 2^( 3) =       0.000415942568
  error estimate for blocks of size 2^( 4) =       0.000422184225
  error estimate for blocks of size 2^( 5) =       0.000424808207
  error estimate for blocks of size 2^( 6) =       0.000428200633
  error estimate for blocks of size 2^( 7) =       0.000428637846

      target function =                  N/A
              le_mean =     -17.216286082094
             les_mean =     296.716726302434
             stat err =       0.000425957728
             autocorr =       1.147555410552
              std dev =       0.562334420100
             le_variance =       0.316220000029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630482
  error estimate for blocks of size 2^( 2) =       0.000407244709
  error estimate for blocks of size 2^( 3) =       0.000415942568
  error estimate for blocks of size 2^( 4) =       0.000422184225
  error estimate for blocks of size 2^( 5) =       0.000424808207
  error estimate for blocks of size 2^( 6) =       0.000428200633
  error estimate for blocks of size 2^( 7) =       0.000428637846

      target function =                  N/A
              le_mean =     -17.216286082094
             les_mean =     296.716726302435
             stat err =       0.000425957728
             autocorr =       1.147555410547
              std dev =       0.562334420100
             le_variance =       0.316220000029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630482
  error estimate for blocks of size 2^( 2) =       0.000407244709
  error estimate for blocks of size 2^( 3) =       0.000415942568
  error estimate for blocks of size 2^( 4) =       0.000422184225
  error estimate for blocks of size 2^( 5) =       0.000424808207
  error estimate for blocks of size 2^( 6) =       0.000428200633
  error estimate for blocks of size 2^( 7) =       0.000428637846

      target function =                  N/A
              le_mean =     -17.216286082094
             les_mean =     296.716726302435
             stat err =       0.000425957728
             autocorr =       1.147555410537
              std dev =       0.562334420100
             le_variance =       0.316220000029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316241702991
                                         uncertainty =       0.003308925000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630482
  error estimate for blocks of size 2^( 2) =       0.000407244709
  error estimate for blocks of size 2^( 3) =       0.000415942568
  error estimate for blocks of size 2^( 4) =       0.000422184225
  error estimate for blocks of size 2^( 5) =       0.000424808207
  error estimate for blocks of size 2^( 6) =       0.000428200633
  error estimate for blocks of size 2^( 7) =       0.000428637846

      target function =                  N/A
              le_mean =     -17.216286082094
             les_mean =     296.716726302434
             stat err =       0.000425957728
             autocorr =       1.147555410552
              std dev =       0.562334420100
             le_variance =       0.316220000029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216286082094        initial  <--
     9.7656e+09     9.7656e+10             4.8916e-14       -17.216286082094
     3.9062e+10     3.9062e+11             1.2248e-14       -17.216286082094
     1.5625e+11     1.5625e+12             2.8683e-15       -17.216286082094

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1927
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1516
    reference variance = 0.241586
====================================================
  Execution time = 1.9994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1879e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826464134
                                         uncertainty =       0.003944342752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318826464134
                                         uncertainty =       0.003944342752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399245302
  error estimate for blocks of size 2^( 2) =       0.000408704478
  error estimate for blocks of size 2^( 3) =       0.000417523641
  error estimate for blocks of size 2^( 4) =       0.000423292847
  error estimate for blocks of size 2^( 5) =       0.000427730752
  error estimate for blocks of size 2^( 6) =       0.000429091141
  error estimate for blocks of size 2^( 7) =       0.000430957637

      target function =                  N/A
              le_mean =     -17.216780464308
             les_mean =     296.736323019557
             stat err =       0.000427768094
             autocorr =       1.147987470755
              std dev =       0.564618121199
             le_variance =       0.318793622786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678046431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780464308       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780464308       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780464308       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216780873163       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216702238495       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216781858622       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216779734363       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216830719819       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216783022605       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216762735417       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217305124389       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217014826217       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215591163539       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217985352070       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216327635151       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215203308253       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217392791875       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222647893945       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.237935348699       residual = 6.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214370771960       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215196097547       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212687681822       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217712651909       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.232028103503       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.206306445645       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.183708744954       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.227750323627       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.167890074355       residual = 3.85e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.257106666551       residual = 2.56e-01           smallest_sin_value = 9.95e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.30e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 4.621507e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780464308       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780464308       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780464308       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216844903548       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216671685077       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216800798837       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743621833       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216071657876       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216096085615       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217012324952       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218022909207       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.232557992297       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.222863150719       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.228450816619       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.207547699525       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.244300494670       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.201634496295       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.233459418807       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.299272570109       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.229296188693       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.185036428649       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.276325332135       residual = 6.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.212736923809       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.345789058869       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.125308522824       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.113967228609       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.189151051216       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.235535850967       residual = 1.53e+02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.960038347264       residual = 1.10e+01           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 1.109228e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780464308       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780464308       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.262
    reference variance = 0.198613
====================================================
  Execution time = 1.9507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1723e-01
  Total weights = 2.0000e+06
  Execution time = 1.8078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398266573
  error estimate for blocks of size 2^( 2) =       0.000407768647
  error estimate for blocks of size 2^( 3) =       0.000415453519
  error estimate for blocks of size 2^( 4) =       0.000422105323
  error estimate for blocks of size 2^( 5) =       0.000426485132
  error estimate for blocks of size 2^( 6) =       0.000428823090
  error estimate for blocks of size 2^( 7) =       0.000428977334

      target function =                  N/A
              le_mean =     -17.216917919227
             les_mean =     296.739495004843
             stat err =       0.000426597720
             autocorr =       1.147332631333
              std dev =       0.563233988730
             le_variance =       0.317232526060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398266573
  error estimate for blocks of size 2^( 2) =       0.000407768647
  error estimate for blocks of size 2^( 3) =       0.000415453519
  error estimate for blocks of size 2^( 4) =       0.000422105323
  error estimate for blocks of size 2^( 5) =       0.000426485132
  error estimate for blocks of size 2^( 6) =       0.000428823090
  error estimate for blocks of size 2^( 7) =       0.000428977334

      target function =                  N/A
              le_mean =     -17.216917919227
             les_mean =     296.739495004843
             stat err =       0.000426597720
             autocorr =       1.147332631337
              std dev =       0.563233988730
             le_variance =       0.317232526060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398266573
  error estimate for blocks of size 2^( 2) =       0.000407768647
  error estimate for blocks of size 2^( 3) =       0.000415453519
  error estimate for blocks of size 2^( 4) =       0.000422105323
  error estimate for blocks of size 2^( 5) =       0.000426485132
  error estimate for blocks of size 2^( 6) =       0.000428823090
  error estimate for blocks of size 2^( 7) =       0.000428977334

      target function =                  N/A
              le_mean =     -17.216917919227
             les_mean =     296.739495004843
             stat err =       0.000426597720
             autocorr =       1.147332631337
              std dev =       0.563233988730
             le_variance =       0.317232526060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317358520862
                                         uncertainty =       0.004893743072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398266573
  error estimate for blocks of size 2^( 2) =       0.000407768647
  error estimate for blocks of size 2^( 3) =       0.000415453519
  error estimate for blocks of size 2^( 4) =       0.000422105323
  error estimate for blocks of size 2^( 5) =       0.000426485132
  error estimate for blocks of size 2^( 6) =       0.000428823090
  error estimate for blocks of size 2^( 7) =       0.000428977334

      target function =                  N/A
              le_mean =     -17.216917919227
             les_mean =     296.739495004843
             stat err =       0.000426597720
             autocorr =       1.147332631333
              std dev =       0.563233988730
             le_variance =       0.317232526060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216917919227        initial  <--
     9.7656e+10     9.7656e+11             4.6215e-15       -17.216917919227
     3.9062e+11     3.9062e+12             1.1092e-15       -17.216917919227
     1.5625e+12     1.5625e+13             0.0000e+00       -17.216917919227

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6189
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2482
    reference variance = 0.315038
====================================================
  Execution time = 2.0020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1675e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742782466
                                         uncertainty =       0.003640298498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316742782466
                                         uncertainty =       0.003640298498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397965878
  error estimate for blocks of size 2^( 2) =       0.000407931094
  error estimate for blocks of size 2^( 3) =       0.000416477174
  error estimate for blocks of size 2^( 4) =       0.000422841651
  error estimate for blocks of size 2^( 5) =       0.000427425860
  error estimate for blocks of size 2^( 6) =       0.000429852288
  error estimate for blocks of size 2^( 7) =       0.000431201334

      target function =                  N/A
              le_mean =     -17.217119583984
             les_mean =     296.745960291689
             stat err =       0.000427830283
             autocorr =       1.155716648373
              std dev =       0.562808742701
             le_variance =       0.316753680861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711958398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217119583984       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217119583984       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217119583984       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217119583984       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212112895901       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217119583984       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215716924474       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215495399741       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214015456520       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.218745854337       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.197496527864       residual = 6.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217425141557       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.202920342579       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.219752956095       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212001557250       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.209902331113       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.202988763012       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.262102378874       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.156005273642       residual = 6.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.199654001591       residual = 4.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.253603706473       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.252340791078       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.353565447356       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905990184120       residual = 1.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.132654719016       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217249854483       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.104462927682       residual = 3.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.253677516286       residual = 2.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.546209797677       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -18.387266741100       residual = 2.18e+02           smallest_sin_value = 9.97e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.11e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 5.835487e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217119583984       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217119583984       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217119583984       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217119583984       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5523e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.503248
====================================================
  Execution time = 1.9866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3141e-01
  Total weights = 2.0000e+06
  Execution time = 1.8101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407069121
  error estimate for blocks of size 2^( 2) =       0.000416934344
  error estimate for blocks of size 2^( 3) =       0.000425726828
  error estimate for blocks of size 2^( 4) =       0.000431602456
  error estimate for blocks of size 2^( 5) =       0.000435276669
  error estimate for blocks of size 2^( 6) =       0.000439220743
  error estimate for blocks of size 2^( 7) =       0.000439627350

      target function =                  N/A
              le_mean =     -17.216935439176
             les_mean =     296.754276290240
             stat err =       0.000436431805
             autocorr =       1.149466884755
              std dev =       0.575682672292
             le_variance =       0.331410539178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407069121
  error estimate for blocks of size 2^( 2) =       0.000416934344
  error estimate for blocks of size 2^( 3) =       0.000425726828
  error estimate for blocks of size 2^( 4) =       0.000431602456
  error estimate for blocks of size 2^( 5) =       0.000435276669
  error estimate for blocks of size 2^( 6) =       0.000439220743
  error estimate for blocks of size 2^( 7) =       0.000439627350

      target function =                  N/A
              le_mean =     -17.216935439176
             les_mean =     296.754276290240
             stat err =       0.000436431805
             autocorr =       1.149466884755
              std dev =       0.575682672292
             le_variance =       0.331410539178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407069121
  error estimate for blocks of size 2^( 2) =       0.000416934344
  error estimate for blocks of size 2^( 3) =       0.000425726828
  error estimate for blocks of size 2^( 4) =       0.000431602456
  error estimate for blocks of size 2^( 5) =       0.000435276669
  error estimate for blocks of size 2^( 6) =       0.000439220743
  error estimate for blocks of size 2^( 7) =       0.000439627350

      target function =                  N/A
              le_mean =     -17.216935439176
             les_mean =     296.754276290240
             stat err =       0.000436431805
             autocorr =       1.149466884755
              std dev =       0.575682672292
             le_variance =       0.331410539178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401071957
                                         uncertainty =       0.007714768962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407069121
  error estimate for blocks of size 2^( 2) =       0.000416934344
  error estimate for blocks of size 2^( 3) =       0.000425726828
  error estimate for blocks of size 2^( 4) =       0.000431602456
  error estimate for blocks of size 2^( 5) =       0.000435276669
  error estimate for blocks of size 2^( 6) =       0.000439220743
  error estimate for blocks of size 2^( 7) =       0.000439627350

      target function =                  N/A
              le_mean =     -17.216935439176
             les_mean =     296.754276290240
             stat err =       0.000436431805
             autocorr =       1.149466884755
              std dev =       0.575682672292
             le_variance =       0.331410539178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216935439176        initial  <--
     9.7656e+11     9.7656e+12             5.8355e-16       -17.216935439176
     3.9062e+12     3.9062e+13             0.0000e+00       -17.216935439176
     1.5625e+13     1.5625e+14             0.0000e+00       -17.216935439176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9890
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4518e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.208
    reference variance = 0.264159
====================================================
  Execution time = 1.9758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320171010639
                                         uncertainty =       0.005513933127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320171010639
                                         uncertainty =       0.005513933127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400076364
  error estimate for blocks of size 2^( 2) =       0.000410047134
  error estimate for blocks of size 2^( 3) =       0.000418160369
  error estimate for blocks of size 2^( 4) =       0.000424772394
  error estimate for blocks of size 2^( 5) =       0.000428689226
  error estimate for blocks of size 2^( 6) =       0.000430454825
  error estimate for blocks of size 2^( 7) =       0.000431036526

      target function =                  N/A
              le_mean =     -17.217179358623
             les_mean =     296.751387100831
             stat err =       0.000428738243
             autocorr =       1.148414476051
              std dev =       0.565793419793
             le_variance =       0.320122193882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717935862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217179358623       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.39e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5285e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1517
    reference variance = 0.555541
====================================================
  Execution time = 1.9522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397369141
  error estimate for blocks of size 2^( 2) =       0.000407189197
  error estimate for blocks of size 2^( 3) =       0.000416496114
  error estimate for blocks of size 2^( 4) =       0.000422009100
  error estimate for blocks of size 2^( 5) =       0.000426848631
  error estimate for blocks of size 2^( 6) =       0.000428620248
  error estimate for blocks of size 2^( 7) =       0.000429544172

      target function =                  N/A
              le_mean =     -17.217311762592
             les_mean =     296.751628641562
             stat err =       0.000426755538
             autocorr =       1.153373728620
              std dev =       0.561964829125
             le_variance =       0.315804469174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397369141
  error estimate for blocks of size 2^( 2) =       0.000407189197
  error estimate for blocks of size 2^( 3) =       0.000416496114
  error estimate for blocks of size 2^( 4) =       0.000422009100
  error estimate for blocks of size 2^( 5) =       0.000426848631
  error estimate for blocks of size 2^( 6) =       0.000428620248
  error estimate for blocks of size 2^( 7) =       0.000429544172

      target function =                  N/A
              le_mean =     -17.217311762592
             les_mean =     296.751628641562
             stat err =       0.000426755538
             autocorr =       1.153373728620
              std dev =       0.561964829125
             le_variance =       0.315804469174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397369141
  error estimate for blocks of size 2^( 2) =       0.000407189197
  error estimate for blocks of size 2^( 3) =       0.000416496114
  error estimate for blocks of size 2^( 4) =       0.000422009100
  error estimate for blocks of size 2^( 5) =       0.000426848631
  error estimate for blocks of size 2^( 6) =       0.000428620248
  error estimate for blocks of size 2^( 7) =       0.000429544172

      target function =                  N/A
              le_mean =     -17.217311762592
             les_mean =     296.751628641562
             stat err =       0.000426755538
             autocorr =       1.153373728620
              std dev =       0.561964829125
             le_variance =       0.315804469174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315638902511
                                         uncertainty =       0.002630207260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397369141
  error estimate for blocks of size 2^( 2) =       0.000407189197
  error estimate for blocks of size 2^( 3) =       0.000416496114
  error estimate for blocks of size 2^( 4) =       0.000422009100
  error estimate for blocks of size 2^( 5) =       0.000426848631
  error estimate for blocks of size 2^( 6) =       0.000428620248
  error estimate for blocks of size 2^( 7) =       0.000429544172

      target function =                  N/A
              le_mean =     -17.217311762592
             les_mean =     296.751628641562
             stat err =       0.000426755538
             autocorr =       1.153373728620
              std dev =       0.561964829125
             le_variance =       0.315804469174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217311762592        initial  <--
     9.7656e+12     9.7656e+13             0.0000e+00       -17.217311762592
     3.9062e+13     3.9062e+14             0.0000e+00       -17.217311762592
     1.5625e+14     1.5625e+15             0.0000e+00       -17.217311762592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6380
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1314
    reference variance = 0.179302
====================================================
  Execution time = 1.9977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316891387009
                                         uncertainty =       0.003753840396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316891387009
                                         uncertainty =       0.003753840396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398016415
  error estimate for blocks of size 2^( 2) =       0.000407410519
  error estimate for blocks of size 2^( 3) =       0.000415378613
  error estimate for blocks of size 2^( 4) =       0.000421534658
  error estimate for blocks of size 2^( 5) =       0.000425505682
  error estimate for blocks of size 2^( 6) =       0.000426652085
  error estimate for blocks of size 2^( 7) =       0.000427137624

      target function =                  N/A
              le_mean =     -17.217033146840
             les_mean =     296.743064354814
             stat err =       0.000425207512
             autocorr =       1.141300189046
              std dev =       0.562880212706
             le_variance =       0.316834133856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703314684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033146840       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033146840       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033146840       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033146840       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033146840       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033146840       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033146840       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033146840       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033146840       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.713334223386       residual = 3.73e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.929320001864       residual = 7.89e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.350149942663       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.840856927310       residual = 5.17e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -12.152345296616       residual = 3.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.041526332493       residual = 3.07e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.303064443353       residual = 4.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+15 is 1.539485e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5686e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.364244
====================================================
  Execution time = 1.9524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1780e-01
  Total weights = 2.0000e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398621645
  error estimate for blocks of size 2^( 2) =       0.000408213747
  error estimate for blocks of size 2^( 3) =       0.000416736261
  error estimate for blocks of size 2^( 4) =       0.000422884087
  error estimate for blocks of size 2^( 5) =       0.000427105235
  error estimate for blocks of size 2^( 6) =       0.000429848702
  error estimate for blocks of size 2^( 7) =       0.000432619932

      target function =                  N/A
              le_mean =     -17.217306358794
             les_mean =     296.753436526115
             stat err =       0.000428114489
             autocorr =       1.153448205692
              std dev =       0.563736137240
             le_variance =       0.317798432430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398621645
  error estimate for blocks of size 2^( 2) =       0.000408213747
  error estimate for blocks of size 2^( 3) =       0.000416736261
  error estimate for blocks of size 2^( 4) =       0.000422884087
  error estimate for blocks of size 2^( 5) =       0.000427105235
  error estimate for blocks of size 2^( 6) =       0.000429848702
  error estimate for blocks of size 2^( 7) =       0.000432619932

      target function =                  N/A
              le_mean =     -17.217306358794
             les_mean =     296.753436526115
             stat err =       0.000428114489
             autocorr =       1.153448205692
              std dev =       0.563736137240
             le_variance =       0.317798432430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398621645
  error estimate for blocks of size 2^( 2) =       0.000408213747
  error estimate for blocks of size 2^( 3) =       0.000416736261
  error estimate for blocks of size 2^( 4) =       0.000422884087
  error estimate for blocks of size 2^( 5) =       0.000427105235
  error estimate for blocks of size 2^( 6) =       0.000429848702
  error estimate for blocks of size 2^( 7) =       0.000432619932

      target function =                  N/A
              le_mean =     -17.217306358794
             les_mean =     296.753436526115
             stat err =       0.000428114489
             autocorr =       1.153448205692
              std dev =       0.563736137240
             le_variance =       0.317798432430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317851209123
                                         uncertainty =       0.003284986883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398621645
  error estimate for blocks of size 2^( 2) =       0.000408213747
  error estimate for blocks of size 2^( 3) =       0.000416736261
  error estimate for blocks of size 2^( 4) =       0.000422884087
  error estimate for blocks of size 2^( 5) =       0.000427105235
  error estimate for blocks of size 2^( 6) =       0.000429848702
  error estimate for blocks of size 2^( 7) =       0.000432619932

      target function =                  N/A
              le_mean =     -17.217306358794
             les_mean =     296.753436526115
             stat err =       0.000428114489
             autocorr =       1.153448205692
              std dev =       0.563736137240
             le_variance =       0.317798432430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217306358794        initial  <--
     9.7656e+13     9.7656e+14             0.0000e+00       -17.217306358794
     3.9062e+14     3.9062e+15             0.0000e+00       -17.217306358794
     1.5625e+15     1.5625e+16             1.5395e-19       -17.217306358794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6446
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.15073
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315150725692
                                         uncertainty =       0.002992676763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315150725692
                                         uncertainty =       0.002992676763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396908347
  error estimate for blocks of size 2^( 2) =       0.000406474985
  error estimate for blocks of size 2^( 3) =       0.000415065477
  error estimate for blocks of size 2^( 4) =       0.000421172904
  error estimate for blocks of size 2^( 5) =       0.000424597060
  error estimate for blocks of size 2^( 6) =       0.000426382370
  error estimate for blocks of size 2^( 7) =       0.000426502369

      target function =                  N/A
              le_mean =     -17.216155455514
             les_mean =     296.711080982889
             stat err =       0.000424663676
             autocorr =       1.144747660075
              std dev =       0.561313167501
             le_variance =       0.315072472010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615545551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216155455514       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216155455514       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216155455514       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216155455514       residual = 4.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -19.827359961495       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.453969381043       residual = 9.20e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.519136820242       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -14.496818664232       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -13.815643827094       residual = 2.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -12.536305454683       residual = 2.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -21.466453678363       residual = 3.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -13.199687051354       residual = 2.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 2.322951e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216155455514       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216155455514       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216155455514       residual = 3.11e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.465034054037       residual = 8.65e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.940740475732       residual = 8.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -10.281598584607       residual = 1.06e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.634871816089       residual = 1.05e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 5.807377e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216155455514       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216155455514       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216155455514       residual = 8.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.227376711271       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.557619785436       residual = 2.46e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+16 is 1.451844e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6139e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2681
    reference variance = 0.311375
====================================================
  Execution time = 1.9528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2257e-01
  Total weights = 2.0000e+06
  Execution time = 1.8035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401602470
  error estimate for blocks of size 2^( 2) =       0.000411170798
  error estimate for blocks of size 2^( 3) =       0.000419554958
  error estimate for blocks of size 2^( 4) =       0.000425707685
  error estimate for blocks of size 2^( 5) =       0.000430420237
  error estimate for blocks of size 2^( 6) =       0.000430718757
  error estimate for blocks of size 2^( 7) =       0.000432005206

      target function =                  N/A
              le_mean =     -17.217888479717
             les_mean =     296.778252626610
             stat err =       0.000429712971
             autocorr =       1.144891092813
              std dev =       0.567951659846
             le_variance =       0.322569087921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401602470
  error estimate for blocks of size 2^( 2) =       0.000411170798
  error estimate for blocks of size 2^( 3) =       0.000419554958
  error estimate for blocks of size 2^( 4) =       0.000425707685
  error estimate for blocks of size 2^( 5) =       0.000430420237
  error estimate for blocks of size 2^( 6) =       0.000430718757
  error estimate for blocks of size 2^( 7) =       0.000432005206

      target function =                  N/A
              le_mean =     -17.217888479717
             les_mean =     296.778252626610
             stat err =       0.000429712971
             autocorr =       1.144891092813
              std dev =       0.567951659846
             le_variance =       0.322569087921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401602470
  error estimate for blocks of size 2^( 2) =       0.000411170798
  error estimate for blocks of size 2^( 3) =       0.000419554958
  error estimate for blocks of size 2^( 4) =       0.000425707685
  error estimate for blocks of size 2^( 5) =       0.000430420237
  error estimate for blocks of size 2^( 6) =       0.000430718757
  error estimate for blocks of size 2^( 7) =       0.000432005206

      target function =                  N/A
              le_mean =     -17.217888479717
             les_mean =     296.778252626610
             stat err =       0.000429712971
             autocorr =       1.144891092813
              std dev =       0.567951659846
             le_variance =       0.322569087921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322604935475
                                         uncertainty =       0.006129468287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401602470
  error estimate for blocks of size 2^( 2) =       0.000411170798
  error estimate for blocks of size 2^( 3) =       0.000419554958
  error estimate for blocks of size 2^( 4) =       0.000425707685
  error estimate for blocks of size 2^( 5) =       0.000430420237
  error estimate for blocks of size 2^( 6) =       0.000430718757
  error estimate for blocks of size 2^( 7) =       0.000432005206

      target function =                  N/A
              le_mean =     -17.217888479717
             les_mean =     296.778252626610
             stat err =       0.000429712971
             autocorr =       1.144891092813
              std dev =       0.567951659846
             le_variance =       0.322569087921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217888479717        initial  <--
     9.7656e+14     9.7656e+15             2.3230e-19       -17.217888479717
     3.9062e+15     3.9062e+16             5.8074e-20       -17.217888479717
     1.5625e+16     1.5625e+17             1.4518e-20       -17.217888479717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6293
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.22
    reference variance = 0.150371
====================================================
  Execution time = 2.2047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2508e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325200124962
                                         uncertainty =       0.007415513153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325200124962
                                         uncertainty =       0.007415513153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403160969
  error estimate for blocks of size 2^( 2) =       0.000413052884
  error estimate for blocks of size 2^( 3) =       0.000421165435
  error estimate for blocks of size 2^( 4) =       0.000426975308
  error estimate for blocks of size 2^( 5) =       0.000430193843
  error estimate for blocks of size 2^( 6) =       0.000432101277
  error estimate for blocks of size 2^( 7) =       0.000431887965

      target function =                  N/A
              le_mean =     -17.216781623506
             les_mean =     296.742646842004
             stat err =       0.000430289598
             autocorr =       1.139107563966
              std dev =       0.570155709481
             le_variance =       0.325077533053


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678162351e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216781623506       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216781623506       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216781623506       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.220922551920       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.788714026264       residual = 3.85e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216781623506       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216781623506       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216781623506       residual = 5.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216781623506       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216781623506       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216781623506       residual = 4.69e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -19.788652967280       residual = 1.03e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7621e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.484794
====================================================
  Execution time = 1.9665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2136e-01
  Total weights = 2.0000e+06
  Execution time = 1.9777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400851406
  error estimate for blocks of size 2^( 2) =       0.000410505246
  error estimate for blocks of size 2^( 3) =       0.000419101357
  error estimate for blocks of size 2^( 4) =       0.000425508170
  error estimate for blocks of size 2^( 5) =       0.000428670100
  error estimate for blocks of size 2^( 6) =       0.000429850567
  error estimate for blocks of size 2^( 7) =       0.000430518321

      target function =                  N/A
              le_mean =     -17.216640530889
             les_mean =     296.734074708262
             stat err =       0.000428636789
             autocorr =       1.143436534886
              std dev =       0.566889494615
             le_variance =       0.321363699105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400851406
  error estimate for blocks of size 2^( 2) =       0.000410505246
  error estimate for blocks of size 2^( 3) =       0.000419101357
  error estimate for blocks of size 2^( 4) =       0.000425508170
  error estimate for blocks of size 2^( 5) =       0.000428670100
  error estimate for blocks of size 2^( 6) =       0.000429850567
  error estimate for blocks of size 2^( 7) =       0.000430518321

      target function =                  N/A
              le_mean =     -17.216640530889
             les_mean =     296.734074708262
             stat err =       0.000428636789
             autocorr =       1.143436534886
              std dev =       0.566889494615
             le_variance =       0.321363699105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400851406
  error estimate for blocks of size 2^( 2) =       0.000410505246
  error estimate for blocks of size 2^( 3) =       0.000419101357
  error estimate for blocks of size 2^( 4) =       0.000425508170
  error estimate for blocks of size 2^( 5) =       0.000428670100
  error estimate for blocks of size 2^( 6) =       0.000429850567
  error estimate for blocks of size 2^( 7) =       0.000430518321

      target function =                  N/A
              le_mean =     -17.216640530889
             les_mean =     296.734074708262
             stat err =       0.000428636789
             autocorr =       1.143436534886
              std dev =       0.566889494615
             le_variance =       0.321363699105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321372809690
                                         uncertainty =       0.003976340021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400851406
  error estimate for blocks of size 2^( 2) =       0.000410505246
  error estimate for blocks of size 2^( 3) =       0.000419101357
  error estimate for blocks of size 2^( 4) =       0.000425508170
  error estimate for blocks of size 2^( 5) =       0.000428670100
  error estimate for blocks of size 2^( 6) =       0.000429850567
  error estimate for blocks of size 2^( 7) =       0.000430518321

      target function =                  N/A
              le_mean =     -17.216640530889
             les_mean =     296.734074708262
             stat err =       0.000428636789
             autocorr =       1.143436534886
              std dev =       0.566889494615
             le_variance =       0.321363699105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216640530889        initial  <--
     9.7656e+15     9.7656e+16             0.0000e+00       -17.216640530889
     3.9062e+16     3.9062e+17             0.0000e+00       -17.216640530889
     1.5625e+17     1.5625e+18             0.0000e+00       -17.216640530889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9569
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2291
    reference variance = 0.183057
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2122e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321173752865
                                         uncertainty =       0.004140597304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321173752865
                                         uncertainty =       0.004140597304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400764363
  error estimate for blocks of size 2^( 2) =       0.000410318845
  error estimate for blocks of size 2^( 3) =       0.000418244445
  error estimate for blocks of size 2^( 4) =       0.000424706702
  error estimate for blocks of size 2^( 5) =       0.000428257960
  error estimate for blocks of size 2^( 6) =       0.000429433979
  error estimate for blocks of size 2^( 7) =       0.000429318287

      target function =                  N/A
              le_mean =     -17.217967044939
             les_mean =     296.779613148974
             stat err =       0.000427929232
             autocorr =       1.140159780928
              std dev =       0.566766397193
             le_variance =       0.321224148987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721796704494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217967044939       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217967044939       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217967044939       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 2.151472e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217967044939       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217967044939       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217967044939       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 5.378680e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217967044939       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217967044939       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217967044939       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+18 is 1.344670e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5767e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.224449
====================================================
  Execution time = 1.9606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1884e-01
  Total weights = 2.0000e+06
  Execution time = 1.8011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399272526
  error estimate for blocks of size 2^( 2) =       0.000408783145
  error estimate for blocks of size 2^( 3) =       0.000417270026
  error estimate for blocks of size 2^( 4) =       0.000423540965
  error estimate for blocks of size 2^( 5) =       0.000427108106
  error estimate for blocks of size 2^( 6) =       0.000430929502
  error estimate for blocks of size 2^( 7) =       0.000432518392

      target function =                  N/A
              le_mean =     -17.216623180724
             les_mean =     296.730950686976
             stat err =       0.000428524241
             autocorr =       1.151892459601
              std dev =       0.564656620734
             le_variance =       0.318837099338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399272526
  error estimate for blocks of size 2^( 2) =       0.000408783145
  error estimate for blocks of size 2^( 3) =       0.000417270026
  error estimate for blocks of size 2^( 4) =       0.000423540965
  error estimate for blocks of size 2^( 5) =       0.000427108106
  error estimate for blocks of size 2^( 6) =       0.000430929502
  error estimate for blocks of size 2^( 7) =       0.000432518392

      target function =                  N/A
              le_mean =     -17.216623180724
             les_mean =     296.730950686976
             stat err =       0.000428524241
             autocorr =       1.151892459601
              std dev =       0.564656620734
             le_variance =       0.318837099338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399272526
  error estimate for blocks of size 2^( 2) =       0.000408783145
  error estimate for blocks of size 2^( 3) =       0.000417270026
  error estimate for blocks of size 2^( 4) =       0.000423540965
  error estimate for blocks of size 2^( 5) =       0.000427108106
  error estimate for blocks of size 2^( 6) =       0.000430929502
  error estimate for blocks of size 2^( 7) =       0.000432518392

      target function =                  N/A
              le_mean =     -17.216623180724
             les_mean =     296.730950686976
             stat err =       0.000428524241
             autocorr =       1.151892459601
              std dev =       0.564656620734
             le_variance =       0.318837099338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318896499965
                                         uncertainty =       0.003904724698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399272526
  error estimate for blocks of size 2^( 2) =       0.000408783145
  error estimate for blocks of size 2^( 3) =       0.000417270026
  error estimate for blocks of size 2^( 4) =       0.000423540965
  error estimate for blocks of size 2^( 5) =       0.000427108106
  error estimate for blocks of size 2^( 6) =       0.000430929502
  error estimate for blocks of size 2^( 7) =       0.000432518392

      target function =                  N/A
              le_mean =     -17.216623180724
             les_mean =     296.730950686976
             stat err =       0.000428524241
             autocorr =       1.151892459601
              std dev =       0.564656620734
             le_variance =       0.318837099338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216623180724        initial  <--
     9.7656e+16     9.7656e+17             2.1515e-21       -17.216623180724
     3.9062e+17     3.9062e+18             5.3787e-22       -17.216623180724
     1.5625e+18     1.5625e+19             1.3447e-22       -17.216623180724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6842
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2193
    reference variance = 0.203698
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641202438
                                         uncertainty =       0.002666557614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641202438
                                         uncertainty =       0.002666557614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395268706
  error estimate for blocks of size 2^( 2) =       0.000404637258
  error estimate for blocks of size 2^( 3) =       0.000413775810
  error estimate for blocks of size 2^( 4) =       0.000419375691
  error estimate for blocks of size 2^( 5) =       0.000423382291
  error estimate for blocks of size 2^( 6) =       0.000425022245
  error estimate for blocks of size 2^( 7) =       0.000426306192

      target function =                  N/A
              le_mean =     -17.216505552990
             les_mean =     296.720538000250
             stat err =       0.000423521605
             autocorr =       1.148064463763
              std dev =       0.558994365225
             le_variance =       0.312474700353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650555299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505552990       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5497e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.3771
    reference variance = 0.723268
====================================================
  Execution time = 1.9632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1902e-01
  Total weights = 2.0000e+06
  Execution time = 1.8003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399387002
  error estimate for blocks of size 2^( 2) =       0.000409137342
  error estimate for blocks of size 2^( 3) =       0.000417823034
  error estimate for blocks of size 2^( 4) =       0.000424777436
  error estimate for blocks of size 2^( 5) =       0.000428441680
  error estimate for blocks of size 2^( 6) =       0.000430100926
  error estimate for blocks of size 2^( 7) =       0.000432890197

      target function =                  N/A
              le_mean =     -17.216775382778
             les_mean =     296.736374375630
             stat err =       0.000429052560
             autocorr =       1.154072631866
              std dev =       0.564818514301
             le_variance =       0.319019954097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399387002
  error estimate for blocks of size 2^( 2) =       0.000409137342
  error estimate for blocks of size 2^( 3) =       0.000417823034
  error estimate for blocks of size 2^( 4) =       0.000424777436
  error estimate for blocks of size 2^( 5) =       0.000428441680
  error estimate for blocks of size 2^( 6) =       0.000430100926
  error estimate for blocks of size 2^( 7) =       0.000432890197

      target function =                  N/A
              le_mean =     -17.216775382778
             les_mean =     296.736374375630
             stat err =       0.000429052560
             autocorr =       1.154072631866
              std dev =       0.564818514301
             le_variance =       0.319019954097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399387002
  error estimate for blocks of size 2^( 2) =       0.000409137342
  error estimate for blocks of size 2^( 3) =       0.000417823034
  error estimate for blocks of size 2^( 4) =       0.000424777436
  error estimate for blocks of size 2^( 5) =       0.000428441680
  error estimate for blocks of size 2^( 6) =       0.000430100926
  error estimate for blocks of size 2^( 7) =       0.000432890197

      target function =                  N/A
              le_mean =     -17.216775382778
             les_mean =     296.736374375630
             stat err =       0.000429052560
             autocorr =       1.154072631866
              std dev =       0.564818514301
             le_variance =       0.319019954097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319056151138
                                         uncertainty =       0.004838129140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399387002
  error estimate for blocks of size 2^( 2) =       0.000409137342
  error estimate for blocks of size 2^( 3) =       0.000417823034
  error estimate for blocks of size 2^( 4) =       0.000424777436
  error estimate for blocks of size 2^( 5) =       0.000428441680
  error estimate for blocks of size 2^( 6) =       0.000430100926
  error estimate for blocks of size 2^( 7) =       0.000432890197

      target function =                  N/A
              le_mean =     -17.216775382778
             les_mean =     296.736374375630
             stat err =       0.000429052560
             autocorr =       1.154072631866
              std dev =       0.564818514301
             le_variance =       0.319019954097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216775382778        initial  <--
     9.7656e+17     9.7656e+18             0.0000e+00       -17.216775382778
     3.9062e+18     3.9062e+19             0.0000e+00       -17.216775382778
     1.5625e+19     1.5625e+20             0.0000e+00       -17.216775382778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7347
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.3411
    reference variance = 0.907981
====================================================
  Execution time = 1.9946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320430893000
                                         uncertainty =       0.003881849153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320430893000
                                         uncertainty =       0.003881849153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400343438
  error estimate for blocks of size 2^( 2) =       0.000409747285
  error estimate for blocks of size 2^( 3) =       0.000417736394
  error estimate for blocks of size 2^( 4) =       0.000423587679
  error estimate for blocks of size 2^( 5) =       0.000428945296
  error estimate for blocks of size 2^( 6) =       0.000431018695
  error estimate for blocks of size 2^( 7) =       0.000431446080

      target function =                  N/A
              le_mean =     -17.217088131187
             les_mean =     296.748673293657
             stat err =       0.000428749437
             autocorr =       1.146942635613
              std dev =       0.566171119784
             le_variance =       0.320549736877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708813119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088131187       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5515e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.253922
====================================================
  Execution time = 1.9620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2017e-01
  Total weights = 2.0000e+06
  Execution time = 1.8012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400103850
  error estimate for blocks of size 2^( 2) =       0.000409429682
  error estimate for blocks of size 2^( 3) =       0.000417868698
  error estimate for blocks of size 2^( 4) =       0.000424430516
  error estimate for blocks of size 2^( 5) =       0.000428175229
  error estimate for blocks of size 2^( 6) =       0.000429185276
  error estimate for blocks of size 2^( 7) =       0.000430618628

      target function =                  N/A
              le_mean =     -17.216344955259
             les_mean =     296.722699639331
             stat err =       0.000428102412
             autocorr =       1.144853432124
              std dev =       0.565832290473
             le_variance =       0.320166180942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400103850
  error estimate for blocks of size 2^( 2) =       0.000409429682
  error estimate for blocks of size 2^( 3) =       0.000417868698
  error estimate for blocks of size 2^( 4) =       0.000424430516
  error estimate for blocks of size 2^( 5) =       0.000428175229
  error estimate for blocks of size 2^( 6) =       0.000429185276
  error estimate for blocks of size 2^( 7) =       0.000430618628

      target function =                  N/A
              le_mean =     -17.216344955259
             les_mean =     296.722699639331
             stat err =       0.000428102412
             autocorr =       1.144853432124
              std dev =       0.565832290473
             le_variance =       0.320166180942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400103850
  error estimate for blocks of size 2^( 2) =       0.000409429682
  error estimate for blocks of size 2^( 3) =       0.000417868698
  error estimate for blocks of size 2^( 4) =       0.000424430516
  error estimate for blocks of size 2^( 5) =       0.000428175229
  error estimate for blocks of size 2^( 6) =       0.000429185276
  error estimate for blocks of size 2^( 7) =       0.000430618628

      target function =                  N/A
              le_mean =     -17.216344955259
             les_mean =     296.722699639331
             stat err =       0.000428102412
             autocorr =       1.144853432124
              std dev =       0.565832290473
             le_variance =       0.320166180942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320195332059
                                         uncertainty =       0.003825254912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400103850
  error estimate for blocks of size 2^( 2) =       0.000409429682
  error estimate for blocks of size 2^( 3) =       0.000417868698
  error estimate for blocks of size 2^( 4) =       0.000424430516
  error estimate for blocks of size 2^( 5) =       0.000428175229
  error estimate for blocks of size 2^( 6) =       0.000429185276
  error estimate for blocks of size 2^( 7) =       0.000430618628

      target function =                  N/A
              le_mean =     -17.216344955259
             les_mean =     296.722699639331
             stat err =       0.000428102412
             autocorr =       1.144853432124
              std dev =       0.565832290473
             le_variance =       0.320166180942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216344955259        initial  <--
     9.7656e+18     9.7656e+19             0.0000e+00       -17.216344955259
     3.9062e+19     3.9062e+20             0.0000e+00       -17.216344955259
     1.5625e+20     1.5625e+21             0.0000e+00       -17.216344955259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7057
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.259885
====================================================
  Execution time = 2.0010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1527e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208058735
                                         uncertainty =       0.002868641771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315208058735
                                         uncertainty =       0.002868641771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397033625
  error estimate for blocks of size 2^( 2) =       0.000406847566
  error estimate for blocks of size 2^( 3) =       0.000415406100
  error estimate for blocks of size 2^( 4) =       0.000421681678
  error estimate for blocks of size 2^( 5) =       0.000427175759
  error estimate for blocks of size 2^( 6) =       0.000429993424
  error estimate for blocks of size 2^( 7) =       0.000431091470

      target function =                  N/A
              le_mean =     -17.217012834647
             les_mean =     296.740802189676
             stat err =       0.000427485583
             autocorr =       1.159280062313
              std dev =       0.561490337336
             le_variance =       0.315271398922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701283465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012834647       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 2.139676e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012834647       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 5.349189e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012834647       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012834647       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+21 is 1.337297e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5595e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2685
    reference variance = 0.218123
====================================================
  Execution time = 1.9717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1268e-01
  Total weights = 2.0000e+06
  Execution time = 1.8074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395398148
  error estimate for blocks of size 2^( 2) =       0.000404963268
  error estimate for blocks of size 2^( 3) =       0.000413761944
  error estimate for blocks of size 2^( 4) =       0.000420742518
  error estimate for blocks of size 2^( 5) =       0.000423676589
  error estimate for blocks of size 2^( 6) =       0.000426164773
  error estimate for blocks of size 2^( 7) =       0.000427808614

      target function =                  N/A
              le_mean =     -17.216317467525
             les_mean =     296.714266377259
             stat err =       0.000424598123
             autocorr =       1.153152856443
              std dev =       0.559177423528
             le_variance =       0.312679390983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395398148
  error estimate for blocks of size 2^( 2) =       0.000404963268
  error estimate for blocks of size 2^( 3) =       0.000413761944
  error estimate for blocks of size 2^( 4) =       0.000420742518
  error estimate for blocks of size 2^( 5) =       0.000423676589
  error estimate for blocks of size 2^( 6) =       0.000426164773
  error estimate for blocks of size 2^( 7) =       0.000427808614

      target function =                  N/A
              le_mean =     -17.216317467525
             les_mean =     296.714266377259
             stat err =       0.000424598123
             autocorr =       1.153152856443
              std dev =       0.559177423528
             le_variance =       0.312679390983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395398148
  error estimate for blocks of size 2^( 2) =       0.000404963268
  error estimate for blocks of size 2^( 3) =       0.000413761944
  error estimate for blocks of size 2^( 4) =       0.000420742518
  error estimate for blocks of size 2^( 5) =       0.000423676589
  error estimate for blocks of size 2^( 6) =       0.000426164773
  error estimate for blocks of size 2^( 7) =       0.000427808614

      target function =                  N/A
              le_mean =     -17.216317467525
             les_mean =     296.714266377259
             stat err =       0.000424598123
             autocorr =       1.153152856443
              std dev =       0.559177423528
             le_variance =       0.312679390983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312731397895
                                         uncertainty =       0.002677612657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395398148
  error estimate for blocks of size 2^( 2) =       0.000404963268
  error estimate for blocks of size 2^( 3) =       0.000413761944
  error estimate for blocks of size 2^( 4) =       0.000420742518
  error estimate for blocks of size 2^( 5) =       0.000423676589
  error estimate for blocks of size 2^( 6) =       0.000426164773
  error estimate for blocks of size 2^( 7) =       0.000427808614

      target function =                  N/A
              le_mean =     -17.216317467525
             les_mean =     296.714266377259
             stat err =       0.000424598123
             autocorr =       1.153152856443
              std dev =       0.559177423528
             le_variance =       0.312679390983


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216317467525        initial  <--
     9.7656e+19     9.7656e+20             2.1397e-24       -17.216317467525
     3.9062e+20     3.9062e+21             5.3492e-25       -17.216317467525
     1.5625e+21     1.5625e+22             1.3373e-25       -17.216317467525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8289
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2607
    reference variance = 0.266487
====================================================
  Execution time = 1.9885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1639e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316413117323
                                         uncertainty =       0.003591210636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316413117323
                                         uncertainty =       0.003591210636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397739318
  error estimate for blocks of size 2^( 2) =       0.000406775870
  error estimate for blocks of size 2^( 3) =       0.000415583569
  error estimate for blocks of size 2^( 4) =       0.000423175016
  error estimate for blocks of size 2^( 5) =       0.000428608882
  error estimate for blocks of size 2^( 6) =       0.000431372759
  error estimate for blocks of size 2^( 7) =       0.000437697118

      target function =                  N/A
              le_mean =     -17.216640077747
             les_mean =     296.729088538481
             stat err =       0.000430213444
             autocorr =       1.169959709262
              std dev =       0.562488337656
             le_variance =       0.316393129999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664007775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640077747       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5439e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.28
    reference variance = 0.744683
====================================================
  Execution time = 2.1680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394658414
  error estimate for blocks of size 2^( 2) =       0.000404266800
  error estimate for blocks of size 2^( 3) =       0.000413015465
  error estimate for blocks of size 2^( 4) =       0.000419288944
  error estimate for blocks of size 2^( 5) =       0.000422240024
  error estimate for blocks of size 2^( 6) =       0.000424224476
  error estimate for blocks of size 2^( 7) =       0.000425237129

      target function =                  N/A
              le_mean =     -17.217396483873
             les_mean =     296.750252055170
             stat err =       0.000422747644
             autocorr =       1.147412713340
              std dev =       0.558131282088
             le_variance =       0.311510528045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394658414
  error estimate for blocks of size 2^( 2) =       0.000404266800
  error estimate for blocks of size 2^( 3) =       0.000413015465
  error estimate for blocks of size 2^( 4) =       0.000419288944
  error estimate for blocks of size 2^( 5) =       0.000422240024
  error estimate for blocks of size 2^( 6) =       0.000424224476
  error estimate for blocks of size 2^( 7) =       0.000425237129

      target function =                  N/A
              le_mean =     -17.217396483873
             les_mean =     296.750252055170
             stat err =       0.000422747644
             autocorr =       1.147412713340
              std dev =       0.558131282088
             le_variance =       0.311510528045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394658414
  error estimate for blocks of size 2^( 2) =       0.000404266800
  error estimate for blocks of size 2^( 3) =       0.000413015465
  error estimate for blocks of size 2^( 4) =       0.000419288944
  error estimate for blocks of size 2^( 5) =       0.000422240024
  error estimate for blocks of size 2^( 6) =       0.000424224476
  error estimate for blocks of size 2^( 7) =       0.000425237129

      target function =                  N/A
              le_mean =     -17.217396483873
             les_mean =     296.750252055170
             stat err =       0.000422747644
             autocorr =       1.147412713340
              std dev =       0.558131282088
             le_variance =       0.311510528045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311403771066
                                         uncertainty =       0.002797320316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394658414
  error estimate for blocks of size 2^( 2) =       0.000404266800
  error estimate for blocks of size 2^( 3) =       0.000413015465
  error estimate for blocks of size 2^( 4) =       0.000419288944
  error estimate for blocks of size 2^( 5) =       0.000422240024
  error estimate for blocks of size 2^( 6) =       0.000424224476
  error estimate for blocks of size 2^( 7) =       0.000425237129

      target function =                  N/A
              le_mean =     -17.217396483873
             les_mean =     296.750252055170
             stat err =       0.000422747644
             autocorr =       1.147412713340
              std dev =       0.558131282088
             le_variance =       0.311510528045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217396483873        initial  <--
     9.7656e+20     9.7656e+21             0.0000e+00       -17.217396483873
     3.9062e+21     3.9062e+22             0.0000e+00       -17.217396483873
     1.5625e+22     1.5625e+23             0.0000e+00       -17.217396483873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7749
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.3003
    reference variance = 0.348166
====================================================
  Execution time = 2.1967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2396e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324033185639
                                         uncertainty =       0.006950931788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324033185639
                                         uncertainty =       0.006950931788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402469650
  error estimate for blocks of size 2^( 2) =       0.000411803166
  error estimate for blocks of size 2^( 3) =       0.000420339913
  error estimate for blocks of size 2^( 4) =       0.000427140174
  error estimate for blocks of size 2^( 5) =       0.000430688915
  error estimate for blocks of size 2^( 6) =       0.000432975355
  error estimate for blocks of size 2^( 7) =       0.000432778575

      target function =                  N/A
              le_mean =     -17.217492146468
             les_mean =     296.765999290674
             stat err =       0.000430895755
             autocorr =       1.146246856619
              std dev =       0.569178038020
             le_variance =       0.323963638964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721749214647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217492146468       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217492146468       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217492146468       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217492146468       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 2.282239e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217492146468       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217492146468       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217492146468       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217492146468       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 5.705598e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217492146468       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217492146468       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217492146468       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217492146468       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+23 is 1.426400e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7435e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2125
    reference variance = 0.170268
====================================================
  Execution time = 1.9837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1768e-01
  Total weights = 2.0000e+06
  Execution time = 1.8225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546617
  error estimate for blocks of size 2^( 2) =       0.000408628876
  error estimate for blocks of size 2^( 3) =       0.000417798780
  error estimate for blocks of size 2^( 4) =       0.000424132277
  error estimate for blocks of size 2^( 5) =       0.000427846272
  error estimate for blocks of size 2^( 6) =       0.000428563782
  error estimate for blocks of size 2^( 7) =       0.000431583086

      target function =                  N/A
              le_mean =     -17.217242552447
             les_mean =     296.751119763323
             stat err =       0.000428031354
             autocorr =       1.153434430736
              std dev =       0.563630031480
             le_variance =       0.317678812386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546617
  error estimate for blocks of size 2^( 2) =       0.000408628876
  error estimate for blocks of size 2^( 3) =       0.000417798780
  error estimate for blocks of size 2^( 4) =       0.000424132277
  error estimate for blocks of size 2^( 5) =       0.000427846272
  error estimate for blocks of size 2^( 6) =       0.000428563782
  error estimate for blocks of size 2^( 7) =       0.000431583086

      target function =                  N/A
              le_mean =     -17.217242552447
             les_mean =     296.751119763323
             stat err =       0.000428031354
             autocorr =       1.153434430736
              std dev =       0.563630031480
             le_variance =       0.317678812386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546617
  error estimate for blocks of size 2^( 2) =       0.000408628876
  error estimate for blocks of size 2^( 3) =       0.000417798780
  error estimate for blocks of size 2^( 4) =       0.000424132277
  error estimate for blocks of size 2^( 5) =       0.000427846272
  error estimate for blocks of size 2^( 6) =       0.000428563782
  error estimate for blocks of size 2^( 7) =       0.000431583086

      target function =                  N/A
              le_mean =     -17.217242552447
             les_mean =     296.751119763323
             stat err =       0.000428031354
             autocorr =       1.153434430736
              std dev =       0.563630031480
             le_variance =       0.317678812386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317734923016
                                         uncertainty =       0.003369636068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398546617
  error estimate for blocks of size 2^( 2) =       0.000408628876
  error estimate for blocks of size 2^( 3) =       0.000417798780
  error estimate for blocks of size 2^( 4) =       0.000424132277
  error estimate for blocks of size 2^( 5) =       0.000427846272
  error estimate for blocks of size 2^( 6) =       0.000428563782
  error estimate for blocks of size 2^( 7) =       0.000431583086

      target function =                  N/A
              le_mean =     -17.217242552447
             les_mean =     296.751119763323
             stat err =       0.000428031354
             autocorr =       1.153434430736
              std dev =       0.563630031480
             le_variance =       0.317678812386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217242552447        initial  <--
     9.7656e+21     9.7656e+22             2.2822e-26       -17.217242552447
     3.9062e+22     3.9062e+23             5.7056e-27       -17.217242552447
     1.5625e+23     1.5625e+24             1.4264e-27       -17.217242552447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9400
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1069
    reference variance = 0.343156
====================================================
  Execution time = 1.9764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2962e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329575039359
                                         uncertainty =       0.011666768597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329575039359
                                         uncertainty =       0.011666768597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405968555
  error estimate for blocks of size 2^( 2) =       0.000415319843
  error estimate for blocks of size 2^( 3) =       0.000423818493
  error estimate for blocks of size 2^( 4) =       0.000430159419
  error estimate for blocks of size 2^( 5) =       0.000433980542
  error estimate for blocks of size 2^( 6) =       0.000435202867
  error estimate for blocks of size 2^( 7) =       0.000434362479

      target function =                  N/A
              le_mean =     -17.216405615307
             les_mean =     296.734243081961
             stat err =       0.000433426327
             autocorr =       1.139844956307
              std dev =       0.574126237002
             le_variance =       0.329620936014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640561531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405615307       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5380e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.245037
====================================================
  Execution time = 1.9512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1631e-01
  Total weights = 2.0000e+06
  Execution time = 1.8075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397685379
  error estimate for blocks of size 2^( 2) =       0.000406964170
  error estimate for blocks of size 2^( 3) =       0.000415788178
  error estimate for blocks of size 2^( 4) =       0.000422696240
  error estimate for blocks of size 2^( 5) =       0.000426694324
  error estimate for blocks of size 2^( 6) =       0.000429125845
  error estimate for blocks of size 2^( 7) =       0.000430630129

      target function =                  N/A
              le_mean =     -17.217240214132
             les_mean =     296.749667754340
             stat err =       0.000427286634
             autocorr =       1.154408106687
              std dev =       0.562412056553
             le_variance =       0.316307321357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397685379
  error estimate for blocks of size 2^( 2) =       0.000406964170
  error estimate for blocks of size 2^( 3) =       0.000415788178
  error estimate for blocks of size 2^( 4) =       0.000422696240
  error estimate for blocks of size 2^( 5) =       0.000426694324
  error estimate for blocks of size 2^( 6) =       0.000429125845
  error estimate for blocks of size 2^( 7) =       0.000430630129

      target function =                  N/A
              le_mean =     -17.217240214132
             les_mean =     296.749667754340
             stat err =       0.000427286634
             autocorr =       1.154408106687
              std dev =       0.562412056553
             le_variance =       0.316307321357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397685379
  error estimate for blocks of size 2^( 2) =       0.000406964170
  error estimate for blocks of size 2^( 3) =       0.000415788178
  error estimate for blocks of size 2^( 4) =       0.000422696240
  error estimate for blocks of size 2^( 5) =       0.000426694324
  error estimate for blocks of size 2^( 6) =       0.000429125845
  error estimate for blocks of size 2^( 7) =       0.000430630129

      target function =                  N/A
              le_mean =     -17.217240214132
             les_mean =     296.749667754340
             stat err =       0.000427286634
             autocorr =       1.154408106687
              std dev =       0.562412056553
             le_variance =       0.316307321357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316347706158
                                         uncertainty =       0.003638104349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397685379
  error estimate for blocks of size 2^( 2) =       0.000406964170
  error estimate for blocks of size 2^( 3) =       0.000415788178
  error estimate for blocks of size 2^( 4) =       0.000422696240
  error estimate for blocks of size 2^( 5) =       0.000426694324
  error estimate for blocks of size 2^( 6) =       0.000429125845
  error estimate for blocks of size 2^( 7) =       0.000430630129

      target function =                  N/A
              le_mean =     -17.217240214132
             les_mean =     296.749667754340
             stat err =       0.000427286634
             autocorr =       1.154408106687
              std dev =       0.562412056553
             le_variance =       0.316307321357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217240214132        initial  <--
     9.7656e+22     9.7656e+23             0.0000e+00       -17.217240214132
     3.9062e+23     3.9062e+24             0.0000e+00       -17.217240214132
     1.5625e+24     1.5625e+25             0.0000e+00       -17.217240214132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6170
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.151526
====================================================
  Execution time = 1.9706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1165e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311349924946
                                         uncertainty =       0.003148867638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311349924946
                                         uncertainty =       0.003148867638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394747393
  error estimate for blocks of size 2^( 2) =       0.000404771541
  error estimate for blocks of size 2^( 3) =       0.000413767001
  error estimate for blocks of size 2^( 4) =       0.000419601986
  error estimate for blocks of size 2^( 5) =       0.000424084790
  error estimate for blocks of size 2^( 6) =       0.000425179847
  error estimate for blocks of size 2^( 7) =       0.000424500942

      target function =                  N/A
              le_mean =     -17.216611934838
             les_mean =     296.723377367742
             stat err =       0.000423341891
             autocorr =       1.150122104422
              std dev =       0.558257117061
             le_variance =       0.311651008750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661193484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611934838       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 2.624776e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611934838       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 6.561940e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611934838       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611934838       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+25 is 1.640485e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5236e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.201975
====================================================
  Execution time = 1.9681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2670e-01
  Total weights = 2.0000e+06
  Execution time = 1.8029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167794
  error estimate for blocks of size 2^( 2) =       0.000413588913
  error estimate for blocks of size 2^( 3) =       0.000422201305
  error estimate for blocks of size 2^( 4) =       0.000429014184
  error estimate for blocks of size 2^( 5) =       0.000432098282
  error estimate for blocks of size 2^( 6) =       0.000433986261
  error estimate for blocks of size 2^( 7) =       0.000436560824

      target function =                  N/A
              le_mean =     -17.216073530967
             les_mean =     296.719890872346
             stat err =       0.000432914887
             autocorr =       1.147312256251
              std dev =       0.571579576308
             le_variance =       0.326703212052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167794
  error estimate for blocks of size 2^( 2) =       0.000413588913
  error estimate for blocks of size 2^( 3) =       0.000422201305
  error estimate for blocks of size 2^( 4) =       0.000429014184
  error estimate for blocks of size 2^( 5) =       0.000432098282
  error estimate for blocks of size 2^( 6) =       0.000433986261
  error estimate for blocks of size 2^( 7) =       0.000436560824

      target function =                  N/A
              le_mean =     -17.216073530967
             les_mean =     296.719890872346
             stat err =       0.000432914887
             autocorr =       1.147312256251
              std dev =       0.571579576308
             le_variance =       0.326703212052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167794
  error estimate for blocks of size 2^( 2) =       0.000413588913
  error estimate for blocks of size 2^( 3) =       0.000422201305
  error estimate for blocks of size 2^( 4) =       0.000429014184
  error estimate for blocks of size 2^( 5) =       0.000432098282
  error estimate for blocks of size 2^( 6) =       0.000433986261
  error estimate for blocks of size 2^( 7) =       0.000436560824

      target function =                  N/A
              le_mean =     -17.216073530967
             les_mean =     296.719890872346
             stat err =       0.000432914887
             autocorr =       1.147312256251
              std dev =       0.571579576308
             le_variance =       0.326703212052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326668214426
                                         uncertainty =       0.005586580644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404167794
  error estimate for blocks of size 2^( 2) =       0.000413588913
  error estimate for blocks of size 2^( 3) =       0.000422201305
  error estimate for blocks of size 2^( 4) =       0.000429014184
  error estimate for blocks of size 2^( 5) =       0.000432098282
  error estimate for blocks of size 2^( 6) =       0.000433986261
  error estimate for blocks of size 2^( 7) =       0.000436560824

      target function =                  N/A
              le_mean =     -17.216073530967
             les_mean =     296.719890872346
             stat err =       0.000432914887
             autocorr =       1.147312256251
              std dev =       0.571579576308
             le_variance =       0.326703212052


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216073530967        initial  <--
     9.7656e+23     9.7656e+24             2.6248e-28       -17.216073530967
     3.9062e+24     3.9062e+25             6.5619e-29       -17.216073530967
     1.5625e+25     1.5625e+26             1.6405e-29       -17.216073530967

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7752
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1626
    reference variance = 0.196112
====================================================
  Execution time = 1.9863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329682051423
                                         uncertainty =       0.017391086848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329682051423
                                         uncertainty =       0.017391086848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405998188
  error estimate for blocks of size 2^( 2) =       0.000415581047
  error estimate for blocks of size 2^( 3) =       0.000423905796
  error estimate for blocks of size 2^( 4) =       0.000430329457
  error estimate for blocks of size 2^( 5) =       0.000434635264
  error estimate for blocks of size 2^( 6) =       0.000436254207
  error estimate for blocks of size 2^( 7) =       0.000437321217

      target function =                  N/A
              le_mean =     -17.216782135966
             les_mean =     296.747256010152
             stat err =       0.000434635036
             autocorr =       1.146043951255
              std dev =       0.574168144070
             le_variance =       0.329669057665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678213597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782135966       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5428e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1441
    reference variance = 0.164158
====================================================
  Execution time = 1.9777e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397636982
  error estimate for blocks of size 2^( 2) =       0.000407325840
  error estimate for blocks of size 2^( 3) =       0.000415905358
  error estimate for blocks of size 2^( 4) =       0.000421985442
  error estimate for blocks of size 2^( 5) =       0.000425989370
  error estimate for blocks of size 2^( 6) =       0.000427516163
  error estimate for blocks of size 2^( 7) =       0.000426445657

      target function =                  N/A
              le_mean =     -17.217586162742
             les_mean =     296.761503452242
             stat err =       0.000425484158
             autocorr =       1.144967743044
              std dev =       0.562343612860
             le_variance =       0.316230338924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397636982
  error estimate for blocks of size 2^( 2) =       0.000407325840
  error estimate for blocks of size 2^( 3) =       0.000415905358
  error estimate for blocks of size 2^( 4) =       0.000421985442
  error estimate for blocks of size 2^( 5) =       0.000425989370
  error estimate for blocks of size 2^( 6) =       0.000427516163
  error estimate for blocks of size 2^( 7) =       0.000426445657

      target function =                  N/A
              le_mean =     -17.217586162742
             les_mean =     296.761503452242
             stat err =       0.000425484158
             autocorr =       1.144967743044
              std dev =       0.562343612860
             le_variance =       0.316230338924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397636982
  error estimate for blocks of size 2^( 2) =       0.000407325840
  error estimate for blocks of size 2^( 3) =       0.000415905358
  error estimate for blocks of size 2^( 4) =       0.000421985442
  error estimate for blocks of size 2^( 5) =       0.000425989370
  error estimate for blocks of size 2^( 6) =       0.000427516163
  error estimate for blocks of size 2^( 7) =       0.000426445657

      target function =                  N/A
              le_mean =     -17.217586162742
             les_mean =     296.761503452242
             stat err =       0.000425484158
             autocorr =       1.144967743044
              std dev =       0.562343612860
             le_variance =       0.316230338924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316280133248
                                         uncertainty =       0.003071534900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397636982
  error estimate for blocks of size 2^( 2) =       0.000407325840
  error estimate for blocks of size 2^( 3) =       0.000415905358
  error estimate for blocks of size 2^( 4) =       0.000421985442
  error estimate for blocks of size 2^( 5) =       0.000425989370
  error estimate for blocks of size 2^( 6) =       0.000427516163
  error estimate for blocks of size 2^( 7) =       0.000426445657

      target function =                  N/A
              le_mean =     -17.217586162742
             les_mean =     296.761503452242
             stat err =       0.000425484158
             autocorr =       1.144967743044
              std dev =       0.562343612860
             le_variance =       0.316230338924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217586162742        initial  <--
     9.7656e+24     9.7656e+25             0.0000e+00       -17.217586162742
     3.9062e+25     3.9062e+26             0.0000e+00       -17.217586162742
     1.5625e+26     1.5625e+27             0.0000e+00       -17.217586162742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8769
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.0923
    reference variance = 0.359627
====================================================
  Execution time = 1.9859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1589e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315952486318
                                         uncertainty =       0.003831428637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315952486318
                                         uncertainty =       0.003831428637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421202
  error estimate for blocks of size 2^( 2) =       0.000407071733
  error estimate for blocks of size 2^( 3) =       0.000415551956
  error estimate for blocks of size 2^( 4) =       0.000421417157
  error estimate for blocks of size 2^( 5) =       0.000426018990
  error estimate for blocks of size 2^( 6) =       0.000427390322
  error estimate for blocks of size 2^( 7) =       0.000426727185

      target function =                  N/A
              le_mean =     -17.217120702307
             les_mean =     296.745132343205
             stat err =       0.000425388413
             autocorr =       1.145695607805
              std dev =       0.562038453613
             le_variance =       0.315887223340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712070231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217120702307       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5339e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2086
    reference variance = 0.146811
====================================================
  Execution time = 1.9446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2150e-01
  Total weights = 2.0000e+06
  Execution time = 1.8104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400935056
  error estimate for blocks of size 2^( 2) =       0.000410776110
  error estimate for blocks of size 2^( 3) =       0.000419826512
  error estimate for blocks of size 2^( 4) =       0.000426352273
  error estimate for blocks of size 2^( 5) =       0.000429271405
  error estimate for blocks of size 2^( 6) =       0.000431207820
  error estimate for blocks of size 2^( 7) =       0.000434834038

      target function =                  N/A
              le_mean =     -17.216568677678
             les_mean =     296.731734710340
             stat err =       0.000430416384
             autocorr =       1.152469732714
              std dev =       0.567007793498
             le_variance =       0.321497837887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400935056
  error estimate for blocks of size 2^( 2) =       0.000410776110
  error estimate for blocks of size 2^( 3) =       0.000419826512
  error estimate for blocks of size 2^( 4) =       0.000426352273
  error estimate for blocks of size 2^( 5) =       0.000429271405
  error estimate for blocks of size 2^( 6) =       0.000431207820
  error estimate for blocks of size 2^( 7) =       0.000434834038

      target function =                  N/A
              le_mean =     -17.216568677678
             les_mean =     296.731734710340
             stat err =       0.000430416384
             autocorr =       1.152469732714
              std dev =       0.567007793498
             le_variance =       0.321497837887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400935056
  error estimate for blocks of size 2^( 2) =       0.000410776110
  error estimate for blocks of size 2^( 3) =       0.000419826512
  error estimate for blocks of size 2^( 4) =       0.000426352273
  error estimate for blocks of size 2^( 5) =       0.000429271405
  error estimate for blocks of size 2^( 6) =       0.000431207820
  error estimate for blocks of size 2^( 7) =       0.000434834038

      target function =                  N/A
              le_mean =     -17.216568677678
             les_mean =     296.731734710340
             stat err =       0.000430416384
             autocorr =       1.152469732714
              std dev =       0.567007793498
             le_variance =       0.321497837887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321604614778
                                         uncertainty =       0.005337891724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400935056
  error estimate for blocks of size 2^( 2) =       0.000410776110
  error estimate for blocks of size 2^( 3) =       0.000419826512
  error estimate for blocks of size 2^( 4) =       0.000426352273
  error estimate for blocks of size 2^( 5) =       0.000429271405
  error estimate for blocks of size 2^( 6) =       0.000431207820
  error estimate for blocks of size 2^( 7) =       0.000434834038

      target function =                  N/A
              le_mean =     -17.216568677678
             les_mean =     296.731734710340
             stat err =       0.000430416384
             autocorr =       1.152469732714
              std dev =       0.567007793498
             le_variance =       0.321497837887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216568677678        initial  <--
     9.7656e+25     9.7656e+26             0.0000e+00       -17.216568677678
     3.9062e+26     3.9062e+27             0.0000e+00       -17.216568677678
     1.5625e+27     1.5625e+28             0.0000e+00       -17.216568677678

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.5928
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2364
    reference variance = 0.173558
====================================================
  Execution time = 2.2025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1655e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316568600627
                                         uncertainty =       0.003780597625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316568600627
                                         uncertainty =       0.003780597625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397838067
  error estimate for blocks of size 2^( 2) =       0.000407203913
  error estimate for blocks of size 2^( 3) =       0.000415876876
  error estimate for blocks of size 2^( 4) =       0.000421473792
  error estimate for blocks of size 2^( 5) =       0.000425787439
  error estimate for blocks of size 2^( 6) =       0.000428025782
  error estimate for blocks of size 2^( 7) =       0.000428656587

      target function =                  N/A
              le_mean =     -17.216717672883
             les_mean =     296.731917525068
             stat err =       0.000425985900
             autocorr =       1.146509812081
              std dev =       0.562627990390
             le_variance =       0.316550255571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671767288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717672883       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7602e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2894
    reference variance = 0.293698
====================================================
  Execution time = 2.1834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2451e-01
  Total weights = 2.0000e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402806280
  error estimate for blocks of size 2^( 2) =       0.000412142119
  error estimate for blocks of size 2^( 3) =       0.000420873625
  error estimate for blocks of size 2^( 4) =       0.000428099322
  error estimate for blocks of size 2^( 5) =       0.000432270202
  error estimate for blocks of size 2^( 6) =       0.000435313635
  error estimate for blocks of size 2^( 7) =       0.000438658378

      target function =                  N/A
              le_mean =     -17.216743117924
             les_mean =     296.740749224823
             stat err =       0.000433585384
             autocorr =       1.158662102886
              std dev =       0.569654104262
             le_variance =       0.324505798502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402806280
  error estimate for blocks of size 2^( 2) =       0.000412142119
  error estimate for blocks of size 2^( 3) =       0.000420873625
  error estimate for blocks of size 2^( 4) =       0.000428099322
  error estimate for blocks of size 2^( 5) =       0.000432270202
  error estimate for blocks of size 2^( 6) =       0.000435313635
  error estimate for blocks of size 2^( 7) =       0.000438658378

      target function =                  N/A
              le_mean =     -17.216743117924
             les_mean =     296.740749224823
             stat err =       0.000433585384
             autocorr =       1.158662102886
              std dev =       0.569654104262
             le_variance =       0.324505798502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402806280
  error estimate for blocks of size 2^( 2) =       0.000412142119
  error estimate for blocks of size 2^( 3) =       0.000420873625
  error estimate for blocks of size 2^( 4) =       0.000428099322
  error estimate for blocks of size 2^( 5) =       0.000432270202
  error estimate for blocks of size 2^( 6) =       0.000435313635
  error estimate for blocks of size 2^( 7) =       0.000438658378

      target function =                  N/A
              le_mean =     -17.216743117924
             les_mean =     296.740749224823
             stat err =       0.000433585384
             autocorr =       1.158662102886
              std dev =       0.569654104262
             le_variance =       0.324505798502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497600704
                                         uncertainty =       0.004345423853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402806280
  error estimate for blocks of size 2^( 2) =       0.000412142119
  error estimate for blocks of size 2^( 3) =       0.000420873625
  error estimate for blocks of size 2^( 4) =       0.000428099322
  error estimate for blocks of size 2^( 5) =       0.000432270202
  error estimate for blocks of size 2^( 6) =       0.000435313635
  error estimate for blocks of size 2^( 7) =       0.000438658378

      target function =                  N/A
              le_mean =     -17.216743117924
             les_mean =     296.740749224823
             stat err =       0.000433585384
             autocorr =       1.158662102886
              std dev =       0.569654104262
             le_variance =       0.324505798502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216743117924        initial  <--
     9.7656e+26     9.7656e+27             0.0000e+00       -17.216743117924
     3.9062e+27     3.9062e+28             0.0000e+00       -17.216743117924
     1.5625e+28     1.5625e+29             0.0000e+00       -17.216743117924

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1180
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3287
    reference variance = 0.427345
====================================================
  Execution time = 1.9940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2810e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328132527078
                                         uncertainty =       0.011970564791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328132527078
                                         uncertainty =       0.011970564791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405030928
  error estimate for blocks of size 2^( 2) =       0.000414045097
  error estimate for blocks of size 2^( 3) =       0.000422247973
  error estimate for blocks of size 2^( 4) =       0.000428193632
  error estimate for blocks of size 2^( 5) =       0.000431246273
  error estimate for blocks of size 2^( 6) =       0.000431703993
  error estimate for blocks of size 2^( 7) =       0.000433227649

      target function =                  N/A
              le_mean =     -17.217368713441
             les_mean =     296.765885356383
             stat err =       0.000431092887
             autocorr =       1.132831558509
              std dev =       0.572800232056
             le_variance =       0.328100105843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736871344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217368713441       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5512e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1524
    reference variance = 0.239494
====================================================
  Execution time = 1.9815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3494e-01
  Total weights = 2.0000e+06
  Execution time = 1.8095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409229726
  error estimate for blocks of size 2^( 2) =       0.000418144988
  error estimate for blocks of size 2^( 3) =       0.000426047247
  error estimate for blocks of size 2^( 4) =       0.000432111556
  error estimate for blocks of size 2^( 5) =       0.000435818372
  error estimate for blocks of size 2^( 6) =       0.000437237744
  error estimate for blocks of size 2^( 7) =       0.000438080008

      target function =                  N/A
              le_mean =     -17.217061309592
             les_mean =     296.762137908538
             stat err =       0.000435811920
             autocorr =       1.134132675876
              std dev =       0.578738229036
             le_variance =       0.334937937748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409229726
  error estimate for blocks of size 2^( 2) =       0.000418144988
  error estimate for blocks of size 2^( 3) =       0.000426047247
  error estimate for blocks of size 2^( 4) =       0.000432111556
  error estimate for blocks of size 2^( 5) =       0.000435818372
  error estimate for blocks of size 2^( 6) =       0.000437237744
  error estimate for blocks of size 2^( 7) =       0.000438080008

      target function =                  N/A
              le_mean =     -17.217061309592
             les_mean =     296.762137908538
             stat err =       0.000435811920
             autocorr =       1.134132675876
              std dev =       0.578738229036
             le_variance =       0.334937937748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409229726
  error estimate for blocks of size 2^( 2) =       0.000418144988
  error estimate for blocks of size 2^( 3) =       0.000426047247
  error estimate for blocks of size 2^( 4) =       0.000432111556
  error estimate for blocks of size 2^( 5) =       0.000435818372
  error estimate for blocks of size 2^( 6) =       0.000437237744
  error estimate for blocks of size 2^( 7) =       0.000438080008

      target function =                  N/A
              le_mean =     -17.217061309592
             les_mean =     296.762137908538
             stat err =       0.000435811920
             autocorr =       1.134132675876
              std dev =       0.578738229036
             le_variance =       0.334937937748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335023138154
                                         uncertainty =       0.020178784435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409229726
  error estimate for blocks of size 2^( 2) =       0.000418144988
  error estimate for blocks of size 2^( 3) =       0.000426047247
  error estimate for blocks of size 2^( 4) =       0.000432111556
  error estimate for blocks of size 2^( 5) =       0.000435818372
  error estimate for blocks of size 2^( 6) =       0.000437237744
  error estimate for blocks of size 2^( 7) =       0.000438080008

      target function =                  N/A
              le_mean =     -17.217061309592
             les_mean =     296.762137908538
             stat err =       0.000435811920
             autocorr =       1.134132675876
              std dev =       0.578738229036
             le_variance =       0.334937937748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217061309592        initial  <--
     9.7656e+27     9.7656e+28             0.0000e+00       -17.217061309592
     3.9062e+28     3.9062e+29             0.0000e+00       -17.217061309592
     1.5625e+29     1.5625e+30             0.0000e+00       -17.217061309592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0799
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.188749
====================================================
  Execution time = 2.0181e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317984578567
                                         uncertainty =       0.004183835169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317984578567
                                         uncertainty =       0.004183835169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398695159
  error estimate for blocks of size 2^( 2) =       0.000408448563
  error estimate for blocks of size 2^( 3) =       0.000416490759
  error estimate for blocks of size 2^( 4) =       0.000422914479
  error estimate for blocks of size 2^( 5) =       0.000426950355
  error estimate for blocks of size 2^( 6) =       0.000428743673
  error estimate for blocks of size 2^( 7) =       0.000428470714

      target function =                  N/A
              le_mean =     -17.217360444142
             les_mean =     296.755416164354
             stat err =       0.000426769805
             autocorr =       1.145791100084
              std dev =       0.563840101278
             le_variance =       0.317915659809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736044414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217360444142       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5672e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.187173
====================================================
  Execution time = 1.9804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1817e-01
  Total weights = 2.0000e+06
  Execution time = 1.8128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398857729
  error estimate for blocks of size 2^( 2) =       0.000408355337
  error estimate for blocks of size 2^( 3) =       0.000416769133
  error estimate for blocks of size 2^( 4) =       0.000422754415
  error estimate for blocks of size 2^( 5) =       0.000426840685
  error estimate for blocks of size 2^( 6) =       0.000430019989
  error estimate for blocks of size 2^( 7) =       0.000429795348

      target function =                  N/A
              le_mean =     -17.216950833201
             les_mean =     296.741570810366
             stat err =       0.000427352609
             autocorr =       1.147986271411
              std dev =       0.564070010351
             le_variance =       0.318174976578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398857729
  error estimate for blocks of size 2^( 2) =       0.000408355337
  error estimate for blocks of size 2^( 3) =       0.000416769133
  error estimate for blocks of size 2^( 4) =       0.000422754415
  error estimate for blocks of size 2^( 5) =       0.000426840685
  error estimate for blocks of size 2^( 6) =       0.000430019989
  error estimate for blocks of size 2^( 7) =       0.000429795348

      target function =                  N/A
              le_mean =     -17.216950833201
             les_mean =     296.741570810366
             stat err =       0.000427352609
             autocorr =       1.147986271411
              std dev =       0.564070010351
             le_variance =       0.318174976578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398857729
  error estimate for blocks of size 2^( 2) =       0.000408355337
  error estimate for blocks of size 2^( 3) =       0.000416769133
  error estimate for blocks of size 2^( 4) =       0.000422754415
  error estimate for blocks of size 2^( 5) =       0.000426840685
  error estimate for blocks of size 2^( 6) =       0.000430019989
  error estimate for blocks of size 2^( 7) =       0.000429795348

      target function =                  N/A
              le_mean =     -17.216950833201
             les_mean =     296.741570810366
             stat err =       0.000427352609
             autocorr =       1.147986271411
              std dev =       0.564070010351
             le_variance =       0.318174976578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318201874148
                                         uncertainty =       0.003743030996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398857729
  error estimate for blocks of size 2^( 2) =       0.000408355337
  error estimate for blocks of size 2^( 3) =       0.000416769133
  error estimate for blocks of size 2^( 4) =       0.000422754415
  error estimate for blocks of size 2^( 5) =       0.000426840685
  error estimate for blocks of size 2^( 6) =       0.000430019989
  error estimate for blocks of size 2^( 7) =       0.000429795348

      target function =                  N/A
              le_mean =     -17.216950833201
             les_mean =     296.741570810366
             stat err =       0.000427352609
             autocorr =       1.147986271411
              std dev =       0.564070010351
             le_variance =       0.318174976578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216950833201        initial  <--
     9.7656e+28     9.7656e+29             0.0000e+00       -17.216950833201
     3.9062e+29     3.9062e+30             0.0000e+00       -17.216950833201
     1.5625e+30     1.5625e+31             0.0000e+00       -17.216950833201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0938
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1957
    reference variance = 0.34198
====================================================
  Execution time = 1.9876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2199e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322029642510
                                         uncertainty =       0.004776222835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322029642510
                                         uncertainty =       0.004776222835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401242275
  error estimate for blocks of size 2^( 2) =       0.000410466046
  error estimate for blocks of size 2^( 3) =       0.000419024965
  error estimate for blocks of size 2^( 4) =       0.000424692016
  error estimate for blocks of size 2^( 5) =       0.000427909092
  error estimate for blocks of size 2^( 6) =       0.000430926118
  error estimate for blocks of size 2^( 7) =       0.000432293459

      target function =                  N/A
              le_mean =     -17.216753362591
             les_mean =     296.738586913442
             stat err =       0.000428955171
             autocorr =       1.142905829308
              std dev =       0.567442266787
             le_variance =       0.321990726137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675336259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753362591       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5431e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2472
    reference variance = 0.299215
====================================================
  Execution time = 1.9675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1838e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398988781
  error estimate for blocks of size 2^( 2) =       0.000408721571
  error estimate for blocks of size 2^( 3) =       0.000417811135
  error estimate for blocks of size 2^( 4) =       0.000423844922
  error estimate for blocks of size 2^( 5) =       0.000427159590
  error estimate for blocks of size 2^( 6) =       0.000431018227
  error estimate for blocks of size 2^( 7) =       0.000432265864

      target function =                  N/A
              le_mean =     -17.216199031669
             les_mean =     296.715893032877
             stat err =       0.000428572151
             autocorr =       1.153789352068
              std dev =       0.564255344691
             le_variance =       0.318384094013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398988781
  error estimate for blocks of size 2^( 2) =       0.000408721571
  error estimate for blocks of size 2^( 3) =       0.000417811135
  error estimate for blocks of size 2^( 4) =       0.000423844922
  error estimate for blocks of size 2^( 5) =       0.000427159590
  error estimate for blocks of size 2^( 6) =       0.000431018227
  error estimate for blocks of size 2^( 7) =       0.000432265864

      target function =                  N/A
              le_mean =     -17.216199031669
             les_mean =     296.715893032877
             stat err =       0.000428572151
             autocorr =       1.153789352068
              std dev =       0.564255344691
             le_variance =       0.318384094013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398988781
  error estimate for blocks of size 2^( 2) =       0.000408721571
  error estimate for blocks of size 2^( 3) =       0.000417811135
  error estimate for blocks of size 2^( 4) =       0.000423844922
  error estimate for blocks of size 2^( 5) =       0.000427159590
  error estimate for blocks of size 2^( 6) =       0.000431018227
  error estimate for blocks of size 2^( 7) =       0.000432265864

      target function =                  N/A
              le_mean =     -17.216199031669
             les_mean =     296.715893032877
             stat err =       0.000428572151
             autocorr =       1.153789352068
              std dev =       0.564255344691
             le_variance =       0.318384094013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318356034315
                                         uncertainty =       0.003748351570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398988781
  error estimate for blocks of size 2^( 2) =       0.000408721571
  error estimate for blocks of size 2^( 3) =       0.000417811135
  error estimate for blocks of size 2^( 4) =       0.000423844922
  error estimate for blocks of size 2^( 5) =       0.000427159590
  error estimate for blocks of size 2^( 6) =       0.000431018227
  error estimate for blocks of size 2^( 7) =       0.000432265864

      target function =                  N/A
              le_mean =     -17.216199031669
             les_mean =     296.715893032877
             stat err =       0.000428572151
             autocorr =       1.153789352068
              std dev =       0.564255344691
             le_variance =       0.318384094013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216199031669        initial  <--
     9.7656e+29     9.7656e+30             0.0000e+00       -17.216199031669
     3.9062e+30     3.9062e+31             0.0000e+00       -17.216199031669
     1.5625e+31     1.5625e+32             0.0000e+00       -17.216199031669

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9436
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.908804e-01 1 1  ON 0
 uu_1                 2.817136e-02 1 1  ON 1
 uu_2                -6.766332e-02 1 1  ON 2
 uu_3                -1.243933e-01 1 1  ON 3
 uu_4                -1.604003e-01 1 1  ON 4
 uu_5                -1.723971e-01 1 1  ON 5
 uu_6                -1.595693e-01 1 1  ON 6
 uu_7                -1.136087e-01 1 1  ON 7
 uu_8                -3.690974e-02 1 1  ON 8
 uu_9                 1.618559e-01 1 1  ON 9
 ud_0                 3.495282e-01 1 1  ON 10
 ud_1                 9.091760e-02 1 1  ON 11
 ud_2                -1.919547e-02 1 1  ON 12
 ud_3                -8.106365e-02 1 1  ON 13
 ud_4                -1.309665e-01 1 1  ON 14
 ud_5                -1.677708e-01 1 1  ON 15
 ud_6                -1.807826e-01 1 1  ON 16
 ud_7                -1.595558e-01 1 1  ON 17
 ud_8                -9.934399e-02 1 1  ON 18
 ud_9                -8.482942e-03 1 1  ON 19
 eO_0                -9.257032e-01 1 1  ON 20
 eO_1                -6.031466e-01 1 1  ON 21
 eO_2                -1.884090e-01 1 1  ON 22
 eO_3                 8.085754e-02 1 1  ON 23
 eO_4                 2.054376e-01 1 1  ON 24
 eO_5                 2.935191e-01 1 1  ON 25
 eO_6                 3.341305e-01 1 1  ON 26
 eO_7                 5.022927e-01 1 1  ON 27
 eO_8                 1.940629e-01 1 1  ON 28
 eO_9                 6.117318e-02 1 1  ON 29
eH1_0                -2.117350e-01 1 1  ON 30
eH1_1                -1.328575e-01 1 1  ON 31
eH1_2                -9.151311e-02 1 1  ON 32
eH1_3                -5.387293e-02 1 1  ON 33
eH1_4                -7.403026e-03 1 1  ON 34
eH1_5                 4.737137e-03 1 1  ON 35
eH1_6                 4.141881e-02 1 1  ON 36
eH1_7                 6.403844e-02 1 1  ON 37
eH1_8                 1.798806e-01 1 1  ON 38
eH1_9                 1.210057e-01 1 1  ON 39
eH2_0                -2.069383e-01 1 1  ON 40
eH2_1                -1.280562e-01 1 1  ON 41
eH2_2                -8.657096e-02 1 1  ON 42
eH2_3                -4.901886e-02 1 1  ON 43
eH2_4                -2.795007e-03 1 1  ON 44
eH2_5                 9.095833e-03 1 1  ON 45
eH2_6                 4.676920e-02 1 1  ON 46
eH2_7                 4.635957e-02 1 1  ON 47
eH2_8                 1.982470e-01 1 1  ON 48
eH2_9                 1.201569e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4380e+01 secs
  Total Execution time = 2.2090e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
