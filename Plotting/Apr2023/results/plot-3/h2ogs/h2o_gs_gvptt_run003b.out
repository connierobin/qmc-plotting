Rank =    0  Free Memory = 83712 MB
Rank =    1  Free Memory = 83707 MB
Rank =    2  Free Memory = 83707 MB
Rank =    3  Free Memory = 83706 MB
Rank =    4  Free Memory = 83706 MB
Rank =    5  Free Memory = 83706 MB
Rank =    6  Free Memory = 83706 MB
Rank =    7  Free Memory = 83706 MB
Rank =    8  Free Memory = 83706 MB
Rank =    9  Free Memory = 83706 MB
Rank =   10  Free Memory = 83706 MB
Rank =   11  Free Memory = 83706 MB
Rank =   12  Free Memory = 83705 MB
Rank =   13  Free Memory = 83705 MB
Rank =   14  Free Memory = 83705 MB
Rank =   15  Free Memory = 83691 MB
Rank =   16  Free Memory = 83687 MB
Rank =   17  Free Memory = 83687 MB
Rank =   18  Free Memory = 83687 MB
Rank =   19  Free Memory = 83687 MB
Rank =   20  Free Memory = 83687 MB
Rank =   21  Free Memory = 83687 MB
Rank =   22  Free Memory = 83687 MB
Rank =   23  Free Memory = 83687 MB
Rank =   24  Free Memory = 83687 MB
Rank =   25  Free Memory = 83687 MB
Rank =   26  Free Memory = 83687 MB
Rank =   27  Free Memory = 83687 MB
Rank =   28  Free Memory = 83687 MB
Rank =   29  Free Memory = 83687 MB
Rank =   30  Free Memory = 83687 MB
Rank =   31  Free Memory = 83687 MB
Rank =   32  Free Memory = 83687 MB
Rank =   33  Free Memory = 83687 MB
Rank =   34  Free Memory = 83687 MB
Rank =   35  Free Memory = 83687 MB
Rank =   36  Free Memory = 83687 MB
Rank =   37  Free Memory = 83687 MB
Rank =   38  Free Memory = 83687 MB
Rank =   39  Free Memory = 83687 MB
Rank =   40  Free Memory = 81616 MB
Rank =   41  Free Memory = 81616 MB
Rank =   42  Free Memory = 81616 MB
Rank =   43  Free Memory = 81616 MB
Rank =   44  Free Memory = 81616 MB
Rank =   45  Free Memory = 81616 MB
Rank =   46  Free Memory = 81616 MB
Rank =   47  Free Memory = 81616 MB
Rank =   48  Free Memory = 81616 MB
Rank =   49  Free Memory = 81616 MB
Rank =   50  Free Memory = 81616 MB
Rank =   51  Free Memory = 81616 MB
Rank =   52  Free Memory = 81616 MB
Rank =   53  Free Memory = 81616 MB
Rank =   54  Free Memory = 81616 MB
Rank =   55  Free Memory = 81616 MB
Rank =   56  Free Memory = 81616 MB
Rank =   57  Free Memory = 81616 MB
Rank =   58  Free Memory = 81616 MB
Rank =   59  Free Memory = 81616 MB
Rank =   60  Free Memory = 81616 MB
Rank =   61  Free Memory = 81616 MB
Rank =   62  Free Memory = 81616 MB
Rank =   63  Free Memory = 81616 MB
Rank =   64  Free Memory = 81616 MB
Rank =   65  Free Memory = 81616 MB
Rank =   66  Free Memory = 81616 MB
Rank =   67  Free Memory = 81616 MB
Rank =   68  Free Memory = 81616 MB
Rank =   69  Free Memory = 81616 MB
Rank =   70  Free Memory = 81616 MB
Rank =   71  Free Memory = 81616 MB
Rank =   72  Free Memory = 81616 MB
Rank =   73  Free Memory = 81616 MB
Rank =   74  Free Memory = 81616 MB
Rank =   75  Free Memory = 81616 MB
Rank =   76  Free Memory = 81616 MB
Rank =   77  Free Memory = 81616 MB
Rank =   78  Free Memory = 81616 MB
Rank =   79  Free Memory = 81616 MB
Rank =   80  Free Memory = 86201 MB
Rank =   81  Free Memory = 86201 MB
Rank =   82  Free Memory = 86201 MB
Rank =   83  Free Memory = 86201 MB
Rank =   84  Free Memory = 86201 MB
Rank =   85  Free Memory = 86201 MB
Rank =   86  Free Memory = 86201 MB
Rank =   87  Free Memory = 86201 MB
Rank =   88  Free Memory = 86201 MB
Rank =   89  Free Memory = 86201 MB
Rank =   90  Free Memory = 86201 MB
Rank =   91  Free Memory = 86201 MB
Rank =   92  Free Memory = 86201 MB
Rank =   93  Free Memory = 86201 MB
Rank =   94  Free Memory = 86201 MB
Rank =   95  Free Memory = 86201 MB
Rank =   96  Free Memory = 86201 MB
Rank =   97  Free Memory = 86201 MB
Rank =   98  Free Memory = 86201 MB
Rank =   99  Free Memory = 86201 MB
Rank =  100  Free Memory = 86201 MB
Rank =  101  Free Memory = 86201 MB
Rank =  102  Free Memory = 86201 MB
Rank =  103  Free Memory = 86201 MB
Rank =  104  Free Memory = 86201 MB
Rank =  105  Free Memory = 86200 MB
Rank =  106  Free Memory = 86200 MB
Rank =  107  Free Memory = 86200 MB
Rank =  108  Free Memory = 86200 MB
Rank =  109  Free Memory = 86200 MB
Rank =  110  Free Memory = 86200 MB
Rank =  111  Free Memory = 86200 MB
Rank =  112  Free Memory = 86200 MB
Rank =  113  Free Memory = 86200 MB
Rank =  114  Free Memory = 86200 MB
Rank =  115  Free Memory = 86200 MB
Rank =  116  Free Memory = 86200 MB
Rank =  117  Free Memory = 86200 MB
Rank =  118  Free Memory = 86200 MB
Rank =  119  Free Memory = 86200 MB
Rank =  120  Free Memory = 79160 MB
Rank =  121  Free Memory = 79160 MB
  Input file(s): opt_h2o_gs_gvptt_run003b.xml 
Rank =  122  Free Memory = 79160 MB
Rank =  123  Free Memory = 79160 MB
Rank =  124  Free Memory = 79160 MB
Rank =  125  Free Memory = 79160 MB
Rank =  127  Free Memory = 79160 MB
Rank =  126  Free Memory = 79160 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003b.xml

  Project = H2O
  date    = 2023-04-01 14:40:32 PDT
  host    = n0126.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 208

  Range of prime numbers to use as seeds over processors and threads = 1291-2273


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.730032e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7273e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.231816
====================================================
  Execution time = 2.3218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332102862785
                                         uncertainty =       0.027030436912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332102862785
                                         uncertainty =       0.027030436912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407556004
  error estimate for blocks of size 2^( 2) =       0.000418664269
  error estimate for blocks of size 2^( 3) =       0.000428420306
  error estimate for blocks of size 2^( 4) =       0.000434940674
  error estimate for blocks of size 2^( 5) =       0.000438856472
  error estimate for blocks of size 2^( 6) =       0.000441379854
  error estimate for blocks of size 2^( 7) =       0.000442209386

      target function =                  N/A
              le_mean =     -17.214034675339
             les_mean =     296.655193429696
             stat err =       0.000439346596
             autocorr =       1.162090478253
              std dev =       0.576371227629
             le_variance =       0.332203792038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721403467534e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214034675339       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214317921622       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214491916184       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214666316182       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214796944300       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214832253166       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214860067098       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214879462715       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214883558924       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214880972422       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214880467903       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214881415004       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214881264562       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.762206e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214034675339       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214157761728       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214230483314       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214308115811       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214363544973       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214373542120       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214379124851       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214381488164       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214381359077       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214381562753       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214381316672       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.672391e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214034675339       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214072410891       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214094873548       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214119911826       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214136405559       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214139083721       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214140412877       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214140384090       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214140447595       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214140433599       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214140422557       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.568376e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8971e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.927581e-01                 1 1 ON  0
uu_1  3.720432e-02                 1 1 ON  1
uu_2  -4.656450e-02                1 1 ON  2
uu_3  -9.446715e-02                1 1 ON  3
uu_4  -1.252776e-01                1 1 ON  4
uu_5  -1.326625e-01                1 1 ON  5
uu_6  -1.094869e-01                1 1 ON  6
uu_7  -3.343904e-02                1 1 ON  7
uu_8  1.029967e-01                 1 1 ON  8
uu_9  1.188645e-01                 1 1 ON  9
ud_0  3.198310e-01                 1 1 ON  10
ud_1  7.796457e-02                 1 1 ON  11
ud_2  -1.012874e-02                1 1 ON  12
ud_3  -5.819023e-02                1 1 ON  13
ud_4  -1.073079e-01                1 1 ON  14
ud_5  -1.488159e-01                1 1 ON  15
ud_6  -1.575783e-01                1 1 ON  16
ud_7  -1.081241e-01                1 1 ON  17
ud_8  9.541103e-03                 1 1 ON  18
ud_9  9.248401e-02                 1 1 ON  19
eO_0  -6.868418e-01                1 1 ON  20
eO_1  -4.052108e-01                1 1 ON  21
eO_2  -5.624535e-02                1 1 ON  22
eO_3  1.651492e-01                 1 1 ON  23
eO_4  2.643321e-01                 1 1 ON  24
eO_5  3.065672e-01                 1 1 ON  25
eO_6  2.482322e-01                 1 1 ON  26
eO_7  1.082315e-01                 1 1 ON  27
eO_8  2.728296e-02                 1 1 ON  28
eO_9  1.813612e-02                 1 1 ON  29
eH1_0 -1.760312e-01                1 1 ON  30
eH1_1 -9.841663e-02                1 1 ON  31
eH1_2 -6.249119e-02                1 1 ON  32
eH1_3 -2.843718e-02                1 1 ON  33
eH1_4 1.793805e-02                 1 1 ON  34
eH1_5 3.105704e-02                 1 1 ON  35
eH1_6 7.770563e-02                 1 1 ON  36
eH1_7 1.114447e-01                 1 1 ON  37
eH1_8 8.859956e-02                 1 1 ON  38
eH1_9 2.360325e-02                 1 1 ON  39
eH2_0 -1.777020e-01                1 1 ON  40
eH2_1 -1.002428e-01                1 1 ON  41
eH2_2 -6.453582e-02                1 1 ON  42
eH2_3 -2.993991e-02                1 1 ON  43
eH2_4 1.662178e-02                 1 1 ON  44
eH2_5 3.138175e-02                 1 1 ON  45
eH2_6 8.006653e-02                 1 1 ON  46
eH2_7 1.151953e-01                 1 1 ON  47
eH2_8 9.164646e-02                 1 1 ON  48
eH2_9 2.562919e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2652
    reference variance = 0.265713
====================================================
  Execution time = 2.0044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0924e-01
  Total weights = 2.0000e+06
  Execution time = 1.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307949388262
                                         uncertainty =       0.005100449015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307949388262
                                         uncertainty =       0.005100449015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392366718
  error estimate for blocks of size 2^( 2) =       0.000403771419
  error estimate for blocks of size 2^( 3) =       0.000413972248
  error estimate for blocks of size 2^( 4) =       0.000420882947
  error estimate for blocks of size 2^( 5) =       0.000426077962
  error estimate for blocks of size 2^( 6) =       0.000429812970
  error estimate for blocks of size 2^( 7) =       0.000429989381

      target function =                  N/A
              le_mean =     -17.214810743959
             les_mean =     296.657612078401
             stat err =       0.000426690815
             autocorr =       1.182611958516
              std dev =       0.554890333318
             le_variance =       0.307903282009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313367709282
                                         uncertainty =       0.005309428676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313367709282
                                         uncertainty =       0.005309428676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395801256
  error estimate for blocks of size 2^( 2) =       0.000406132765
  error estimate for blocks of size 2^( 3) =       0.000415448837
  error estimate for blocks of size 2^( 4) =       0.000421856007
  error estimate for blocks of size 2^( 5) =       0.000426592597
  error estimate for blocks of size 2^( 6) =       0.000430361931
  error estimate for blocks of size 2^( 7) =       0.000430436880

      target function =                  N/A
              le_mean =     -17.214912001507
             les_mean =     296.666512331325
             stat err =       0.000427311854
             autocorr =       1.165562441992
              std dev =       0.559747504103
             le_variance =       0.313317268350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311823704198
                                         uncertainty =       0.005276263924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311823704198
                                         uncertainty =       0.005276263924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394825576
  error estimate for blocks of size 2^( 2) =       0.000405351202
  error estimate for blocks of size 2^( 3) =       0.000414851479
  error estimate for blocks of size 2^( 4) =       0.000421346726
  error estimate for blocks of size 2^( 5) =       0.000426174359
  error estimate for blocks of size 2^( 6) =       0.000429932826
  error estimate for blocks of size 2^( 7) =       0.000430047767

      target function =                  N/A
              le_mean =     -17.214832544001
             les_mean =     296.662233832752
             stat err =       0.000426875420
             autocorr =       1.168938712254
              std dev =       0.558367684093
             le_variance =       0.311774470640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308191275231
                                         uncertainty =       0.005127158001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308191275231
                                         uncertainty =       0.005127158001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392520535
  error estimate for blocks of size 2^( 2) =       0.000403776334
  error estimate for blocks of size 2^( 3) =       0.000413863243
  error estimate for blocks of size 2^( 4) =       0.000420705251
  error estimate for blocks of size 2^( 5) =       0.000425842730
  error estimate for blocks of size 2^( 6) =       0.000429579749
  error estimate for blocks of size 2^( 7) =       0.000429745901

      target function =                  N/A
              le_mean =     -17.214769392440
             les_mean =     296.656429821203
             stat err =       0.000426468408
             autocorr =       1.180453723324
              std dev =       0.555107863727
             le_variance =       0.308144740372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214810743959        initial
     2.5000e-01     2.5000e+00             1.7622e-02       -17.214912001507  <--
     1.0000e+00     1.0000e+01             5.6724e-03       -17.214832544001
     4.0000e+00     4.0000e+01             1.5684e-03       -17.214769392440

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9399e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.950331e-01 1 1  ON 0
 uu_1                 3.901793e-02 1 1  ON 1
 uu_2                -4.767061e-02 1 1  ON 2
 uu_3                -9.610239e-02 1 1  ON 3
 uu_4                -1.258050e-01 1 1  ON 4
 uu_5                -1.326101e-01 1 1  ON 5
 uu_6                -1.100152e-01 1 1  ON 6
 uu_7                -3.395141e-02 1 1  ON 7
 uu_8                 1.027391e-01 1 1  ON 8
 uu_9                 1.190337e-01 1 1  ON 9
 ud_0                 3.273845e-01 1 1  ON 10
 ud_1                 8.085464e-02 1 1  ON 11
 ud_2                -1.322160e-02 1 1  ON 12
 ud_3                -6.307812e-02 1 1  ON 13
 ud_4                -1.097101e-01 1 1  ON 14
 ud_5                -1.483636e-01 1 1  ON 15
 ud_6                -1.571376e-01 1 1  ON 16
 ud_7                -1.086985e-01 1 1  ON 17
 ud_8                 8.950871e-03 1 1  ON 18
 ud_9                 9.247059e-02 1 1  ON 19
 eO_0                -6.987914e-01 1 1  ON 20
 eO_1                -4.095554e-01 1 1  ON 21
 eO_2                -4.847921e-02 1 1  ON 22
 eO_3                 1.727267e-01 1 1  ON 23
 eO_4                 2.656177e-01 1 1  ON 24
 eO_5                 3.056591e-01 1 1  ON 25
 eO_6                 2.483875e-01 1 1  ON 26
 eO_7                 1.085529e-01 1 1  ON 27
 eO_8                 2.731979e-02 1 1  ON 28
 eO_9                 1.815647e-02 1 1  ON 29
eH1_0                -1.767160e-01 1 1  ON 30
eH1_1                -9.879018e-02 1 1  ON 31
eH1_2                -6.270464e-02 1 1  ON 32
eH1_3                -2.784001e-02 1 1  ON 33
eH1_4                 1.836400e-02 1 1  ON 34
eH1_5                 3.149671e-02 1 1  ON 35
eH1_6                 7.735282e-02 1 1  ON 36
eH1_7                 1.112971e-01 1 1  ON 37
eH1_8                 8.882177e-02 1 1  ON 38
eH1_9                 2.366468e-02 1 1  ON 39
eH2_0                -1.783523e-01 1 1  ON 40
eH2_1                -1.007824e-01 1 1  ON 41
eH2_2                -6.463545e-02 1 1  ON 42
eH2_3                -2.935215e-02 1 1  ON 43
eH2_4                 1.732100e-02 1 1  ON 44
eH2_5                 3.163075e-02 1 1  ON 45
eH2_6                 7.966525e-02 1 1  ON 46
eH2_7                 1.150700e-01 1 1  ON 47
eH2_8                 9.184889e-02 1 1  ON 48
eH2_9                 2.567717e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8413e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7237e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.146763
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160990589
                                         uncertainty =       0.019697262226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160990589
                                         uncertainty =       0.019697262226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408701852
  error estimate for blocks of size 2^( 2) =       0.000418780138
  error estimate for blocks of size 2^( 3) =       0.000427786316
  error estimate for blocks of size 2^( 4) =       0.000434183257
  error estimate for blocks of size 2^( 5) =       0.000437271371
  error estimate for blocks of size 2^( 6) =       0.000439840513
  error estimate for blocks of size 2^( 7) =       0.000441037903

      target function =                  N/A
              le_mean =     -17.215731369770
             les_mean =     296.715480836061
             stat err =       0.000438083261
             autocorr =       1.148947298377
              std dev =       0.577991701499
             le_variance =       0.334074407002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573136977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215731369770       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215794743640       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215887580407       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216003363884       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216078221917       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216124019533       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216171222885       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216177704841       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216192300495       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216193245511       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216198255380       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216200032190       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216199426348       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216199351398       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216200037853       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216199216307       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216199408741       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.852899e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215731369770       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215772065768       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215823715191       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215890965516       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215941204472       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215957098478       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215969223629       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215969962004       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215972760099       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215971882652       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215972566221       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215972537705       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.175780e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215731369770       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215748107572       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215767681941       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215792913322       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215813243648       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215817280950       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215819213534       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215819063741       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215819248683       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215819076928       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215819194600       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.695891e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5705e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.977849e-01 1 1  ON 0
 uu_1                 4.057349e-02 1 1  ON 1
 uu_2                -4.826368e-02 1 1  ON 2
 uu_3                -9.748280e-02 1 1  ON 3
 uu_4                -1.268757e-01 1 1  ON 4
 uu_5                -1.325191e-01 1 1  ON 5
 uu_6                -1.104801e-01 1 1  ON 6
 uu_7                -3.480133e-02 1 1  ON 7
 uu_8                 1.022318e-01 1 1  ON 8
 uu_9                 1.191810e-01 1 1  ON 9
 ud_0                 3.338273e-01 1 1  ON 10
 ud_1                 8.325126e-02 1 1  ON 11
 ud_2                -1.513594e-02 1 1  ON 12
 ud_3                -6.701807e-02 1 1  ON 13
 ud_4                -1.123097e-01 1 1  ON 14
 ud_5                -1.480016e-01 1 1  ON 15
 ud_6                -1.565111e-01 1 1  ON 16
 ud_7                -1.094683e-01 1 1  ON 17
 ud_8                 8.099400e-03 1 1  ON 18
 ud_9                 9.245005e-02 1 1  ON 19
 eO_0                -7.105493e-01 1 1  ON 20
 eO_1                -4.141189e-01 1 1  ON 21
 eO_2                -4.255560e-02 1 1  ON 22
 eO_3                 1.809729e-01 1 1  ON 23
 eO_4                 2.679672e-01 1 1  ON 24
 eO_5                 3.048547e-01 1 1  ON 25
 eO_6                 2.485105e-01 1 1  ON 26
 eO_7                 1.089270e-01 1 1  ON 27
 eO_8                 2.735674e-02 1 1  ON 28
 eO_9                 1.819315e-02 1 1  ON 29
eH1_0                -1.775894e-01 1 1  ON 30
eH1_1                -9.944013e-02 1 1  ON 31
eH1_2                -6.258672e-02 1 1  ON 32
eH1_3                -2.740057e-02 1 1  ON 33
eH1_4                 1.878263e-02 1 1  ON 34
eH1_5                 3.226735e-02 1 1  ON 35
eH1_6                 7.708539e-02 1 1  ON 36
eH1_7                 1.110326e-01 1 1  ON 37
eH1_8                 8.900794e-02 1 1  ON 38
eH1_9                 2.373395e-02 1 1  ON 39
eH2_0                -1.791555e-01 1 1  ON 40
eH2_1                -1.012779e-01 1 1  ON 41
eH2_2                -6.425739e-02 1 1  ON 42
eH2_3                -2.883075e-02 1 1  ON 43
eH2_4                 1.765209e-02 1 1  ON 44
eH2_5                 3.199236e-02 1 1  ON 45
eH2_6                 7.915114e-02 1 1  ON 46
eH2_7                 1.149045e-01 1 1  ON 47
eH2_8                 9.213227e-02 1 1  ON 48
eH2_9                 2.575780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1447
    reference variance = 0.196788
====================================================
  Execution time = 1.9792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1925e-01
  Total weights = 2.0000e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314574556027
                                         uncertainty =       0.005706277904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314574556027
                                         uncertainty =       0.005706277904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396569458
  error estimate for blocks of size 2^( 2) =       0.000406863113
  error estimate for blocks of size 2^( 3) =       0.000416134351
  error estimate for blocks of size 2^( 4) =       0.000423307704
  error estimate for blocks of size 2^( 5) =       0.000427269174
  error estimate for blocks of size 2^( 6) =       0.000429722143
  error estimate for blocks of size 2^( 7) =       0.000432288988

      target function =                  N/A
              le_mean =     -17.215630196663
             les_mean =     296.692457581148
             stat err =       0.000428147002
             autocorr =       1.165593957162
              std dev =       0.560833906027
             le_variance =       0.314534670150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323756284438
                                         uncertainty =       0.005922175653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323756284438
                                         uncertainty =       0.005922175653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402318022
  error estimate for blocks of size 2^( 2) =       0.000411912371
  error estimate for blocks of size 2^( 3) =       0.000420567429
  error estimate for blocks of size 2^( 4) =       0.000427332643
  error estimate for blocks of size 2^( 5) =       0.000431004896
  error estimate for blocks of size 2^( 6) =       0.000433263202
  error estimate for blocks of size 2^( 7) =       0.000435808956

      target function =                  N/A
              le_mean =     -17.215698189760
             les_mean =     296.703983580588
             stat err =       0.000431852424
             autocorr =       1.152210289179
              std dev =       0.568963603017
             le_variance =       0.323719581558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325216217325
                                         uncertainty =       0.005944629203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325216217325
                                         uncertainty =       0.005944629203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403224502
  error estimate for blocks of size 2^( 2) =       0.000412799267
  error estimate for blocks of size 2^( 3) =       0.000421451388
  error estimate for blocks of size 2^( 4) =       0.000428219181
  error estimate for blocks of size 2^( 5) =       0.000431907935
  error estimate for blocks of size 2^( 6) =       0.000434130285
  error estimate for blocks of size 2^( 7) =       0.000436683623

      target function =                  N/A
              le_mean =     -17.215733492335
             les_mean =     296.706659513855
             stat err =       0.000432735256
             autocorr =       1.151730139877
              std dev =       0.570245558799
             le_variance =       0.325179997330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316312674894
                                         uncertainty =       0.005752101973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316312674894
                                         uncertainty =       0.005752101973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397664148
  error estimate for blocks of size 2^( 2) =       0.000407793376
  error estimate for blocks of size 2^( 3) =       0.000416929862
  error estimate for blocks of size 2^( 4) =       0.000424017179
  error estimate for blocks of size 2^( 5) =       0.000427923636
  error estimate for blocks of size 2^( 6) =       0.000430325879
  error estimate for blocks of size 2^( 7) =       0.000432892598

      target function =                  N/A
              le_mean =     -17.215589367366
             les_mean =     296.692790656655
             stat err =       0.000428789823
             autocorr =       1.162668916806
              std dev =       0.562382031224
             le_variance =       0.316273549043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215630196663        initial
     6.2500e-02     6.2500e-01             2.8529e-02       -17.215698189760
     2.5000e-01     2.5000e+00             1.1758e-02       -17.215733492335  <--
     1.0000e+00     1.0000e+01             3.6959e-03       -17.215589367366

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9162e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.977849e-01 1 1  ON 0
 uu_1                 4.057349e-02 1 1  ON 1
 uu_2                -4.826368e-02 1 1  ON 2
 uu_3                -9.748280e-02 1 1  ON 3
 uu_4                -1.268757e-01 1 1  ON 4
 uu_5                -1.325191e-01 1 1  ON 5
 uu_6                -1.104801e-01 1 1  ON 6
 uu_7                -3.480133e-02 1 1  ON 7
 uu_8                 1.022318e-01 1 1  ON 8
 uu_9                 1.191810e-01 1 1  ON 9
 ud_0                 3.338273e-01 1 1  ON 10
 ud_1                 8.325126e-02 1 1  ON 11
 ud_2                -1.513594e-02 1 1  ON 12
 ud_3                -6.701807e-02 1 1  ON 13
 ud_4                -1.123097e-01 1 1  ON 14
 ud_5                -1.480016e-01 1 1  ON 15
 ud_6                -1.565111e-01 1 1  ON 16
 ud_7                -1.094683e-01 1 1  ON 17
 ud_8                 8.099400e-03 1 1  ON 18
 ud_9                 9.245005e-02 1 1  ON 19
 eO_0                -7.105493e-01 1 1  ON 20
 eO_1                -4.141189e-01 1 1  ON 21
 eO_2                -4.255560e-02 1 1  ON 22
 eO_3                 1.809729e-01 1 1  ON 23
 eO_4                 2.679672e-01 1 1  ON 24
 eO_5                 3.048547e-01 1 1  ON 25
 eO_6                 2.485105e-01 1 1  ON 26
 eO_7                 1.089270e-01 1 1  ON 27
 eO_8                 2.735674e-02 1 1  ON 28
 eO_9                 1.819315e-02 1 1  ON 29
eH1_0                -1.775894e-01 1 1  ON 30
eH1_1                -9.944013e-02 1 1  ON 31
eH1_2                -6.258672e-02 1 1  ON 32
eH1_3                -2.740057e-02 1 1  ON 33
eH1_4                 1.878263e-02 1 1  ON 34
eH1_5                 3.226735e-02 1 1  ON 35
eH1_6                 7.708539e-02 1 1  ON 36
eH1_7                 1.110326e-01 1 1  ON 37
eH1_8                 8.900794e-02 1 1  ON 38
eH1_9                 2.373395e-02 1 1  ON 39
eH2_0                -1.791555e-01 1 1  ON 40
eH2_1                -1.012779e-01 1 1  ON 41
eH2_2                -6.425739e-02 1 1  ON 42
eH2_3                -2.883075e-02 1 1  ON 43
eH2_4                 1.765209e-02 1 1  ON 44
eH2_5                 3.199236e-02 1 1  ON 45
eH2_6                 7.915114e-02 1 1  ON 46
eH2_7                 1.149045e-01 1 1  ON 47
eH2_8                 9.213227e-02 1 1  ON 48
eH2_9                 2.575780e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2514
    reference variance = 0.454994
====================================================
  Execution time = 1.9981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314671299657
                                         uncertainty =       0.002921722133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314671299657
                                         uncertainty =       0.002921722133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396713252
  error estimate for blocks of size 2^( 2) =       0.000407054877
  error estimate for blocks of size 2^( 3) =       0.000415987833
  error estimate for blocks of size 2^( 4) =       0.000421776313
  error estimate for blocks of size 2^( 5) =       0.000425043744
  error estimate for blocks of size 2^( 6) =       0.000426120010
  error estimate for blocks of size 2^( 7) =       0.000426188322

      target function =                  N/A
              le_mean =     -17.215428725694
             les_mean =     296.685748860459
             stat err =       0.000424782097
             autocorr =       1.146513027154
              std dev =       0.561037261131
             le_variance =       0.314762808378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721542872569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215428725694       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215446527243       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215485154248       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215537653811       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215563900993       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215593458001       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215609210803       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215615389091       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215615186884       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215618855475       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215619771209       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215619590315       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215619542216       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215619690912       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215618787941       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215619632755       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.175665e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215428725694       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215439294307       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215463261477       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215485777617       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215500580388       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215511370802       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215514432562       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215515708641       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215515577354       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215515998982       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215515254117       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215515518913       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.463743e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215428725694       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215432751461       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215442360659       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215448540777       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215455238723       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215457115986       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215457177615       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215457230333       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215457287854       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215457415649       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215457323178       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.581652e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5536e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.002657e-01 1 1  ON 0
 uu_1                 4.170168e-02 1 1  ON 1
 uu_2                -4.828250e-02 1 1  ON 2
 uu_3                -9.850442e-02 1 1  ON 3
 uu_4                -1.280028e-01 1 1  ON 4
 uu_5                -1.328498e-01 1 1  ON 5
 uu_6                -1.108099e-01 1 1  ON 6
 uu_7                -3.568292e-02 1 1  ON 7
 uu_8                 1.018406e-01 1 1  ON 8
 uu_9                 1.194045e-01 1 1  ON 9
 ud_0                 3.373215e-01 1 1  ON 10
 ud_1                 8.471494e-02 1 1  ON 11
 ud_2                -1.565601e-02 1 1  ON 12
 ud_3                -6.919896e-02 1 1  ON 13
 ud_4                -1.141893e-01 1 1  ON 14
 ud_5                -1.481299e-01 1 1  ON 15
 ud_6                -1.560480e-01 1 1  ON 16
 ud_7                -1.098609e-01 1 1  ON 17
 ud_8                 7.524373e-03 1 1  ON 18
 ud_9                 9.246493e-02 1 1  ON 19
 eO_0                -7.190130e-01 1 1  ON 20
 eO_1                -4.179394e-01 1 1  ON 21
 eO_2                -3.983489e-02 1 1  ON 22
 eO_3                 1.871617e-01 1 1  ON 23
 eO_4                 2.708827e-01 1 1  ON 24
 eO_5                 3.045230e-01 1 1  ON 25
 eO_6                 2.487469e-01 1 1  ON 26
 eO_7                 1.093353e-01 1 1  ON 27
 eO_8                 2.743429e-02 1 1  ON 28
 eO_9                 1.823964e-02 1 1  ON 29
eH1_0                -1.779387e-01 1 1  ON 30
eH1_1                -1.001691e-01 1 1  ON 31
eH1_2                -6.247107e-02 1 1  ON 32
eH1_3                -2.711429e-02 1 1  ON 33
eH1_4                 1.902068e-02 1 1  ON 34
eH1_5                 3.286156e-02 1 1  ON 35
eH1_6                 7.686807e-02 1 1  ON 36
eH1_7                 1.107247e-01 1 1  ON 37
eH1_8                 8.925264e-02 1 1  ON 38
eH1_9                 2.381312e-02 1 1  ON 39
eH2_0                -1.799120e-01 1 1  ON 40
eH2_1                -1.019155e-01 1 1  ON 41
eH2_2                -6.384324e-02 1 1  ON 42
eH2_3                -2.835329e-02 1 1  ON 43
eH2_4                 1.806244e-02 1 1  ON 44
eH2_5                 3.254995e-02 1 1  ON 45
eH2_6                 7.876996e-02 1 1  ON 46
eH2_7                 1.145579e-01 1 1  ON 47
eH2_8                 9.232633e-02 1 1  ON 48
eH2_9                 2.580982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1993
    reference variance = 0.249304
====================================================
  Execution time = 1.9975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314569352648
                                         uncertainty =       0.003867155958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314569352648
                                         uncertainty =       0.003867155958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396529552
  error estimate for blocks of size 2^( 2) =       0.000406570975
  error estimate for blocks of size 2^( 3) =       0.000415452551
  error estimate for blocks of size 2^( 4) =       0.000422075942
  error estimate for blocks of size 2^( 5) =       0.000425899969
  error estimate for blocks of size 2^( 6) =       0.000428400531
  error estimate for blocks of size 2^( 7) =       0.000426981166

      target function =                  N/A
              le_mean =     -17.215690613187
             les_mean =     296.694474502385
             stat err =       0.000425839402
             autocorr =       1.153295423878
              std dev =       0.560777469794
             le_variance =       0.314471370629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320375252771
                                         uncertainty =       0.003905747776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320375252771
                                         uncertainty =       0.003905747776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400171987
  error estimate for blocks of size 2^( 2) =       0.000409900391
  error estimate for blocks of size 2^( 3) =       0.000418448062
  error estimate for blocks of size 2^( 4) =       0.000424862472
  error estimate for blocks of size 2^( 5) =       0.000428602489
  error estimate for blocks of size 2^( 6) =       0.000430986326
  error estimate for blocks of size 2^( 7) =       0.000429644326

      target function =                  N/A
              le_mean =     -17.215704854277
             les_mean =     296.700768708224
             stat err =       0.000428523903
             autocorr =       1.146718280432
              std dev =       0.565928651665
             le_variance =       0.320275238776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320644141015
                                         uncertainty =       0.003903787156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320644141015
                                         uncertainty =       0.003903787156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400339945
  error estimate for blocks of size 2^( 2) =       0.000410080499
  error estimate for blocks of size 2^( 3) =       0.000418646363
  error estimate for blocks of size 2^( 4) =       0.000425085142
  error estimate for blocks of size 2^( 5) =       0.000428825766
  error estimate for blocks of size 2^( 6) =       0.000431223418
  error estimate for blocks of size 2^( 7) =       0.000429901500

      target function =                  N/A
              le_mean =     -17.215706333213
             les_mean =     296.701088535011
             stat err =       0.000428758957
             autocorr =       1.147013579448
              std dev =       0.566166180427
             le_variance =       0.320544143859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315606648676
                                         uncertainty =       0.003873218526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315606648676
                                         uncertainty =       0.003873218526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397182773
  error estimate for blocks of size 2^( 2) =       0.000407162660
  error estimate for blocks of size 2^( 3) =       0.000415982939
  error estimate for blocks of size 2^( 4) =       0.000422572024
  error estimate for blocks of size 2^( 5) =       0.000426378492
  error estimate for blocks of size 2^( 6) =       0.000428862747
  error estimate for blocks of size 2^( 7) =       0.000427462020

      target function =                  N/A
              le_mean =     -17.215677653333
             les_mean =     296.695065216546
             stat err =       0.000426318821
             autocorr =       1.152094768183
              std dev =       0.561701264762
             le_variance =       0.315508310836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215690613187        initial
     6.2500e-02     6.2500e-01             2.1757e-02       -17.215704854277
     2.5000e-01     2.5000e+00             8.4637e-03       -17.215706333213  <--
     1.0000e+00     1.0000e+01             2.5817e-03       -17.215677653333

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9318e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.002657e-01 1 1  ON 0
 uu_1                 4.170168e-02 1 1  ON 1
 uu_2                -4.828250e-02 1 1  ON 2
 uu_3                -9.850442e-02 1 1  ON 3
 uu_4                -1.280028e-01 1 1  ON 4
 uu_5                -1.328498e-01 1 1  ON 5
 uu_6                -1.108099e-01 1 1  ON 6
 uu_7                -3.568292e-02 1 1  ON 7
 uu_8                 1.018406e-01 1 1  ON 8
 uu_9                 1.194045e-01 1 1  ON 9
 ud_0                 3.373215e-01 1 1  ON 10
 ud_1                 8.471494e-02 1 1  ON 11
 ud_2                -1.565601e-02 1 1  ON 12
 ud_3                -6.919896e-02 1 1  ON 13
 ud_4                -1.141893e-01 1 1  ON 14
 ud_5                -1.481299e-01 1 1  ON 15
 ud_6                -1.560480e-01 1 1  ON 16
 ud_7                -1.098609e-01 1 1  ON 17
 ud_8                 7.524373e-03 1 1  ON 18
 ud_9                 9.246493e-02 1 1  ON 19
 eO_0                -7.190130e-01 1 1  ON 20
 eO_1                -4.179394e-01 1 1  ON 21
 eO_2                -3.983489e-02 1 1  ON 22
 eO_3                 1.871617e-01 1 1  ON 23
 eO_4                 2.708827e-01 1 1  ON 24
 eO_5                 3.045230e-01 1 1  ON 25
 eO_6                 2.487469e-01 1 1  ON 26
 eO_7                 1.093353e-01 1 1  ON 27
 eO_8                 2.743429e-02 1 1  ON 28
 eO_9                 1.823964e-02 1 1  ON 29
eH1_0                -1.779387e-01 1 1  ON 30
eH1_1                -1.001691e-01 1 1  ON 31
eH1_2                -6.247107e-02 1 1  ON 32
eH1_3                -2.711429e-02 1 1  ON 33
eH1_4                 1.902068e-02 1 1  ON 34
eH1_5                 3.286156e-02 1 1  ON 35
eH1_6                 7.686807e-02 1 1  ON 36
eH1_7                 1.107247e-01 1 1  ON 37
eH1_8                 8.925264e-02 1 1  ON 38
eH1_9                 2.381312e-02 1 1  ON 39
eH2_0                -1.799120e-01 1 1  ON 40
eH2_1                -1.019155e-01 1 1  ON 41
eH2_2                -6.384324e-02 1 1  ON 42
eH2_3                -2.835329e-02 1 1  ON 43
eH2_4                 1.806244e-02 1 1  ON 44
eH2_5                 3.254995e-02 1 1  ON 45
eH2_6                 7.876996e-02 1 1  ON 46
eH2_7                 1.145579e-01 1 1  ON 47
eH2_8                 9.232633e-02 1 1  ON 48
eH2_9                 2.580982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1188
    reference variance = 0.129726
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308519518581
                                         uncertainty =       0.002496950517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308519518581
                                         uncertainty =       0.002496950517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392740795
  error estimate for blocks of size 2^( 2) =       0.000402997340
  error estimate for blocks of size 2^( 3) =       0.000412469656
  error estimate for blocks of size 2^( 4) =       0.000418863518
  error estimate for blocks of size 2^( 5) =       0.000422098887
  error estimate for blocks of size 2^( 6) =       0.000424420001
  error estimate for blocks of size 2^( 7) =       0.000428005194

      target function =                  N/A
              le_mean =     -17.216298838747
             les_mean =     296.709436215639
             stat err =       0.000423346900
             autocorr =       1.161932065131
              std dev =       0.555419359456
             le_variance =       0.308490664858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629883875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298838747       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216306360895       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339669079       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216364325526       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216376920657       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216393192989       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216398404661       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216399753135       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216405045851       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216409352408       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216408955775       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216409780617       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216408770358       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216408880197       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216408969776       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216409070006       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.744576e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298838747       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302980639       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216323235150       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216333894508       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216339030451       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216342430958       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216343662813       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216343519461       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216344907346       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216345274386       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216345029007       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216345113543       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.578967e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298838747       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300319317       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216308282936       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216311239625       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312757565       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216313098502       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216313286918       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216313200009       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216313450530       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216313486574       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.992923e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6139e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.019781e-01 1 1  ON 0
 uu_1                 4.275540e-02 1 1  ON 1
 uu_2                -4.812743e-02 1 1  ON 2
 uu_3                -9.890980e-02 1 1  ON 3
 uu_4                -1.286429e-01 1 1  ON 4
 uu_5                -1.335597e-01 1 1  ON 5
 uu_6                -1.113247e-01 1 1  ON 6
 uu_7                -3.643191e-02 1 1  ON 7
 uu_8                 1.015243e-01 1 1  ON 8
 uu_9                 1.196195e-01 1 1  ON 9
 ud_0                 3.394513e-01 1 1  ON 10
 ud_1                 8.594361e-02 1 1  ON 11
 ud_2                -1.569743e-02 1 1  ON 12
 ud_3                -7.037804e-02 1 1  ON 13
 ud_4                -1.156389e-01 1 1  ON 14
 ud_5                -1.486379e-01 1 1  ON 15
 ud_6                -1.553918e-01 1 1  ON 16
 ud_7                -1.102156e-01 1 1  ON 17
 ud_8                 6.950172e-03 1 1  ON 18
 ud_9                 9.241501e-02 1 1  ON 19
 eO_0                -7.255920e-01 1 1  ON 20
 eO_1                -4.210781e-01 1 1  ON 21
 eO_2                -3.864141e-02 1 1  ON 22
 eO_3                 1.919656e-01 1 1  ON 23
 eO_4                 2.738524e-01 1 1  ON 24
 eO_5                 3.045688e-01 1 1  ON 25
 eO_6                 2.489788e-01 1 1  ON 26
 eO_7                 1.097309e-01 1 1  ON 27
 eO_8                 2.748867e-02 1 1  ON 28
 eO_9                 1.825455e-02 1 1  ON 29
eH1_0                -1.785194e-01 1 1  ON 30
eH1_1                -1.006075e-01 1 1  ON 31
eH1_2                -6.241860e-02 1 1  ON 32
eH1_3                -2.679703e-02 1 1  ON 33
eH1_4                 1.900701e-02 1 1  ON 34
eH1_5                 3.334368e-02 1 1  ON 35
eH1_6                 7.694925e-02 1 1  ON 36
eH1_7                 1.105456e-01 1 1  ON 37
eH1_8                 8.943885e-02 1 1  ON 38
eH1_9                 2.387984e-02 1 1  ON 39
eH2_0                -1.806872e-01 1 1  ON 40
eH2_1                -1.020526e-01 1 1  ON 41
eH2_2                -6.375719e-02 1 1  ON 42
eH2_3                -2.832965e-02 1 1  ON 43
eH2_4                 1.806478e-02 1 1  ON 44
eH2_5                 3.333846e-02 1 1  ON 45
eH2_6                 7.857708e-02 1 1  ON 46
eH2_7                 1.144119e-01 1 1  ON 47
eH2_8                 9.259829e-02 1 1  ON 48
eH2_9                 2.588099e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3128
    reference variance = 0.30814
====================================================
  Execution time = 2.0261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319798886025
                                         uncertainty =       0.004256319685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319798886025
                                         uncertainty =       0.004256319685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399825971
  error estimate for blocks of size 2^( 2) =       0.000409973314
  error estimate for blocks of size 2^( 3) =       0.000418311806
  error estimate for blocks of size 2^( 4) =       0.000424601511
  error estimate for blocks of size 2^( 5) =       0.000428450283
  error estimate for blocks of size 2^( 6) =       0.000430010294
  error estimate for blocks of size 2^( 7) =       0.000431182004

      target function =                  N/A
              le_mean =     -17.215802554152
             les_mean =     296.703579037242
             stat err =       0.000428561023
             autocorr =       1.148902937130
              std dev =       0.565439310223
             le_variance =       0.319721613546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323680623464
                                         uncertainty =       0.004348645052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323680623464
                                         uncertainty =       0.004348645052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402244925
  error estimate for blocks of size 2^( 2) =       0.000412199618
  error estimate for blocks of size 2^( 3) =       0.000420332999
  error estimate for blocks of size 2^( 4) =       0.000426466158
  error estimate for blocks of size 2^( 5) =       0.000430249106
  error estimate for blocks of size 2^( 6) =       0.000431813630
  error estimate for blocks of size 2^( 7) =       0.000433021006

      target function =                  N/A
              le_mean =     -17.215826650005
             les_mean =     296.708289039782
             stat err =       0.000430387475
             autocorr =       1.144822356710
              std dev =       0.568860227626
             le_variance =       0.323601958574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323494892280
                                         uncertainty =       0.004336380303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323494892280
                                         uncertainty =       0.004336380303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402129572
  error estimate for blocks of size 2^( 2) =       0.000412103888
  error estimate for blocks of size 2^( 3) =       0.000420264510
  error estimate for blocks of size 2^( 4) =       0.000426417164
  error estimate for blocks of size 2^( 5) =       0.000430205620
  error estimate for blocks of size 2^( 6) =       0.000431765400
  error estimate for blocks of size 2^( 7) =       0.000432960863

      target function =                  N/A
              le_mean =     -17.215821028275
             les_mean =     296.707909901366
             stat err =       0.000430337262
             autocorr =       1.145211975435
              std dev =       0.568697094674
             le_variance =       0.323416385490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320397554906
                                         uncertainty =       0.004268983660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320397554906
                                         uncertainty =       0.004268983660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400200002
  error estimate for blocks of size 2^( 2) =       0.000410315483
  error estimate for blocks of size 2^( 3) =       0.000418622527
  error estimate for blocks of size 2^( 4) =       0.000424888428
  error estimate for blocks of size 2^( 5) =       0.000428725616
  error estimate for blocks of size 2^( 6) =       0.000430284937
  error estimate for blocks of size 2^( 7) =       0.000431458873

      target function =                  N/A
              le_mean =     -17.215799721476
             les_mean =     296.704079973363
             stat err =       0.000428839463
             autocorr =       1.148246987274
              std dev =       0.565968270784
             le_variance =       0.320320083534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215802554152        initial
     6.2500e-02     6.2500e-01             1.7446e-02       -17.215826650005  <--
     2.5000e-01     2.5000e+00             6.5790e-03       -17.215821028275
     1.0000e+00     1.0000e+01             1.9929e-03       -17.215799721476

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9622e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.050478e-01 1 1  ON 0
 uu_1                 4.477537e-02 1 1  ON 1
 uu_2                -4.715882e-02 1 1  ON 2
 uu_3                -9.913851e-02 1 1  ON 3
 uu_4                -1.298570e-01 1 1  ON 4
 uu_5                -1.351571e-01 1 1  ON 5
 uu_6                -1.126385e-01 1 1  ON 6
 uu_7                -3.846312e-02 1 1  ON 7
 uu_8                 1.005822e-01 1 1  ON 8
 uu_9                 1.202753e-01 1 1  ON 9
 ud_0                 3.422589e-01 1 1  ON 10
 ud_1                 8.788825e-02 1 1  ON 11
 ud_2                -1.504289e-02 1 1  ON 12
 ud_3                -7.120388e-02 1 1  ON 13
 ud_4                -1.174204e-01 1 1  ON 14
 ud_5                -1.500777e-01 1 1  ON 15
 ud_6                -1.548638e-01 1 1  ON 16
 ud_7                -1.108587e-01 1 1  ON 17
 ud_8                 5.406341e-03 1 1  ON 18
 ud_9                 9.227444e-02 1 1  ON 19
 eO_0                -7.364587e-01 1 1  ON 20
 eO_1                -4.278794e-01 1 1  ON 21
 eO_2                -3.931351e-02 1 1  ON 22
 eO_3                 1.983058e-01 1 1  ON 23
 eO_4                 2.815761e-01 1 1  ON 24
 eO_5                 3.063825e-01 1 1  ON 25
 eO_6                 2.499595e-01 1 1  ON 26
 eO_7                 1.109701e-01 1 1  ON 27
 eO_8                 2.766136e-02 1 1  ON 28
 eO_9                 1.830013e-02 1 1  ON 29
eH1_0                -1.795358e-01 1 1  ON 30
eH1_1                -1.013647e-01 1 1  ON 31
eH1_2                -6.237363e-02 1 1  ON 32
eH1_3                -2.648146e-02 1 1  ON 33
eH1_4                 1.890150e-02 1 1  ON 34
eH1_5                 3.365605e-02 1 1  ON 35
eH1_6                 7.760002e-02 1 1  ON 36
eH1_7                 1.102183e-01 1 1  ON 37
eH1_8                 9.003135e-02 1 1  ON 38
eH1_9                 2.408922e-02 1 1  ON 39
eH2_0                -1.818488e-01 1 1  ON 40
eH2_1                -1.026031e-01 1 1  ON 41
eH2_2                -6.371030e-02 1 1  ON 42
eH2_3                -2.819069e-02 1 1  ON 43
eH2_4                 1.789007e-02 1 1  ON 44
eH2_5                 3.415795e-02 1 1  ON 45
eH2_6                 7.856813e-02 1 1  ON 46
eH2_7                 1.142080e-01 1 1  ON 47
eH2_8                 9.344826e-02 1 1  ON 48
eH2_9                 2.610204e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.13465
====================================================
  Execution time = 2.0260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2434e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406250439
                                         uncertainty =       0.004970084578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406250439
                                         uncertainty =       0.004970084578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402703462
  error estimate for blocks of size 2^( 2) =       0.000412014243
  error estimate for blocks of size 2^( 3) =       0.000421086236
  error estimate for blocks of size 2^( 4) =       0.000427859465
  error estimate for blocks of size 2^( 5) =       0.000432678690
  error estimate for blocks of size 2^( 6) =       0.000434554727
  error estimate for blocks of size 2^( 7) =       0.000435043218

      target function =                  N/A
              le_mean =     -17.216687196013
             les_mean =     296.738658000162
             stat err =       0.000432534025
             autocorr =       1.153638726189
              std dev =       0.569508697899
             le_variance =       0.324340156982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668719601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687196013       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216683545435       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691359494       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700748684       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216715556805       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216735840022       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216737316833       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216736492729       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216741950101       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216751130558       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216756168552       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216753720646       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216762385062       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216760909629       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216762659810       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216761869305       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216761076984       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216762256125       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216761796589       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216761956364       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.449330e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687196013       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684198608       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216689894320       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216696776647       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216706960628       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216716913586       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216716395673       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216714052046       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216716156221       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216719223670       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216720397967       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216719252428       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216720729943       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216720408036       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.975742e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687196013       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216685448961       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216688147403       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691254309       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216696244189       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216698611777       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216697701297       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216696678506       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216697346256       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216697817940       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216698016918       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.381920e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5833e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.072418e-01 1 1  ON 0
 uu_1                 4.662784e-02 1 1  ON 1
 uu_2                -4.601037e-02 1 1  ON 2
 uu_3                -9.902684e-02 1 1  ON 3
 uu_4                -1.309216e-01 1 1  ON 4
 uu_5                -1.362787e-01 1 1  ON 5
 uu_6                -1.139852e-01 1 1  ON 6
 uu_7                -4.090524e-02 1 1  ON 7
 uu_8                 9.899381e-02 1 1  ON 8
 uu_9                 1.209306e-01 1 1  ON 9
 ud_0                 3.444656e-01 1 1  ON 10
 ud_1                 8.956749e-02 1 1  ON 11
 ud_2                -1.435101e-02 1 1  ON 12
 ud_3                -7.184312e-02 1 1  ON 13
 ud_4                -1.188223e-01 1 1  ON 14
 ud_5                -1.520388e-01 1 1  ON 15
 ud_6                -1.545913e-01 1 1  ON 16
 ud_7                -1.111222e-01 1 1  ON 17
 ud_8                 3.402142e-03 1 1  ON 18
 ud_9                 9.229734e-02 1 1  ON 19
 eO_0                -7.464345e-01 1 1  ON 20
 eO_1                -4.350637e-01 1 1  ON 21
 eO_2                -4.138911e-02 1 1  ON 22
 eO_3                 2.023334e-01 1 1  ON 23
 eO_4                 2.902133e-01 1 1  ON 24
 eO_5                 3.093732e-01 1 1  ON 25
 eO_6                 2.511657e-01 1 1  ON 26
 eO_7                 1.127273e-01 1 1  ON 27
 eO_8                 2.787253e-02 1 1  ON 28
 eO_9                 1.844782e-02 1 1  ON 29
eH1_0                -1.805924e-01 1 1  ON 30
eH1_1                -1.020059e-01 1 1  ON 31
eH1_2                -6.241993e-02 1 1  ON 32
eH1_3                -2.669750e-02 1 1  ON 33
eH1_4                 1.832536e-02 1 1  ON 34
eH1_5                 3.452830e-02 1 1  ON 35
eH1_6                 7.825342e-02 1 1  ON 36
eH1_7                 1.097069e-01 1 1  ON 37
eH1_8                 9.095332e-02 1 1  ON 38
eH1_9                 2.448202e-02 1 1  ON 39
eH2_0                -1.824019e-01 1 1  ON 40
eH2_1                -1.034496e-01 1 1  ON 41
eH2_2                -6.359342e-02 1 1  ON 42
eH2_3                -2.743084e-02 1 1  ON 43
eH2_4                 1.831058e-02 1 1  ON 44
eH2_5                 3.416452e-02 1 1  ON 45
eH2_6                 7.816177e-02 1 1  ON 46
eH2_7                 1.134245e-01 1 1  ON 47
eH2_8                 9.419451e-02 1 1  ON 48
eH2_9                 2.642567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.368
    reference variance = 0.35726
====================================================
  Execution time = 1.9965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2987e-01
  Total weights = 2.0000e+06
  Execution time = 1.8489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523267535
                                         uncertainty =       0.005733493655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523267535
                                         uncertainty =       0.005733493655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405258959
  error estimate for blocks of size 2^( 2) =       0.000415210144
  error estimate for blocks of size 2^( 3) =       0.000423727194
  error estimate for blocks of size 2^( 4) =       0.000429774326
  error estimate for blocks of size 2^( 5) =       0.000434025410
  error estimate for blocks of size 2^( 6) =       0.000436976143
  error estimate for blocks of size 2^( 7) =       0.000439843577

      target function =                  N/A
              le_mean =     -17.216722438929
             les_mean =     296.744001022671
             stat err =       0.000435154864
             autocorr =       1.152981755345
              std dev =       0.573122716180
             le_variance =       0.328469647801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331263910450
                                         uncertainty =       0.005732186784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331263910450
                                         uncertainty =       0.005732186784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406945330
  error estimate for blocks of size 2^( 2) =       0.000416786172
  error estimate for blocks of size 2^( 3) =       0.000425176112
  error estimate for blocks of size 2^( 4) =       0.000431134297
  error estimate for blocks of size 2^( 5) =       0.000435309919
  error estimate for blocks of size 2^( 6) =       0.000438201393
  error estimate for blocks of size 2^( 7) =       0.000441091374

      target function =                  N/A
              le_mean =     -17.216720179104
             les_mean =     296.746662562370
             stat err =       0.000436434246
             autocorr =       1.150179189118
              std dev =       0.575507604137
             le_variance =       0.331209002420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331428519923
                                         uncertainty =       0.005736896778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331428519923
                                         uncertainty =       0.005736896778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407046240
  error estimate for blocks of size 2^( 2) =       0.000416890132
  error estimate for blocks of size 2^( 3) =       0.000425287403
  error estimate for blocks of size 2^( 4) =       0.000431264446
  error estimate for blocks of size 2^( 5) =       0.000435450792
  error estimate for blocks of size 2^( 6) =       0.000438338801
  error estimate for blocks of size 2^( 7) =       0.000441235306

      target function =                  N/A
              le_mean =     -17.216731709191
             les_mean =     296.747223862955
             stat err =       0.000436572336
             autocorr =       1.150336584753
              std dev =       0.575650312574
             le_variance =       0.331373282367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329030374619
                                         uncertainty =       0.005734503375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329030374619
                                         uncertainty =       0.005734503375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405571434
  error estimate for blocks of size 2^( 2) =       0.000415498935
  error estimate for blocks of size 2^( 3) =       0.000423991715
  error estimate for blocks of size 2^( 4) =       0.000430025823
  error estimate for blocks of size 2^( 5) =       0.000434265351
  error estimate for blocks of size 2^( 6) =       0.000437201595
  error estimate for blocks of size 2^( 7) =       0.000440075746

      target function =                  N/A
              le_mean =     -17.216717851987
             les_mean =     296.744349806859
             stat err =       0.000435392129
             autocorr =       1.152461510145
              std dev =       0.573564622710
             le_variance =       0.328976376425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216722438929        initial
     1.5625e-02     1.5625e-01             2.4493e-02       -17.216720179104
     6.2500e-02     6.2500e-01             9.9757e-03       -17.216731709191  <--
     2.5000e-01     2.5000e+00             3.3819e-03       -17.216717851987

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9275e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.072418e-01 1 1  ON 0
 uu_1                 4.662784e-02 1 1  ON 1
 uu_2                -4.601037e-02 1 1  ON 2
 uu_3                -9.902684e-02 1 1  ON 3
 uu_4                -1.309216e-01 1 1  ON 4
 uu_5                -1.362787e-01 1 1  ON 5
 uu_6                -1.139852e-01 1 1  ON 6
 uu_7                -4.090524e-02 1 1  ON 7
 uu_8                 9.899381e-02 1 1  ON 8
 uu_9                 1.209306e-01 1 1  ON 9
 ud_0                 3.444656e-01 1 1  ON 10
 ud_1                 8.956749e-02 1 1  ON 11
 ud_2                -1.435101e-02 1 1  ON 12
 ud_3                -7.184312e-02 1 1  ON 13
 ud_4                -1.188223e-01 1 1  ON 14
 ud_5                -1.520388e-01 1 1  ON 15
 ud_6                -1.545913e-01 1 1  ON 16
 ud_7                -1.111222e-01 1 1  ON 17
 ud_8                 3.402142e-03 1 1  ON 18
 ud_9                 9.229734e-02 1 1  ON 19
 eO_0                -7.464345e-01 1 1  ON 20
 eO_1                -4.350637e-01 1 1  ON 21
 eO_2                -4.138911e-02 1 1  ON 22
 eO_3                 2.023334e-01 1 1  ON 23
 eO_4                 2.902133e-01 1 1  ON 24
 eO_5                 3.093732e-01 1 1  ON 25
 eO_6                 2.511657e-01 1 1  ON 26
 eO_7                 1.127273e-01 1 1  ON 27
 eO_8                 2.787253e-02 1 1  ON 28
 eO_9                 1.844782e-02 1 1  ON 29
eH1_0                -1.805924e-01 1 1  ON 30
eH1_1                -1.020059e-01 1 1  ON 31
eH1_2                -6.241993e-02 1 1  ON 32
eH1_3                -2.669750e-02 1 1  ON 33
eH1_4                 1.832536e-02 1 1  ON 34
eH1_5                 3.452830e-02 1 1  ON 35
eH1_6                 7.825342e-02 1 1  ON 36
eH1_7                 1.097069e-01 1 1  ON 37
eH1_8                 9.095332e-02 1 1  ON 38
eH1_9                 2.448202e-02 1 1  ON 39
eH2_0                -1.824019e-01 1 1  ON 40
eH2_1                -1.034496e-01 1 1  ON 41
eH2_2                -6.359342e-02 1 1  ON 42
eH2_3                -2.743084e-02 1 1  ON 43
eH2_4                 1.831058e-02 1 1  ON 44
eH2_5                 3.416452e-02 1 1  ON 45
eH2_6                 7.816177e-02 1 1  ON 46
eH2_7                 1.134245e-01 1 1  ON 47
eH2_8                 9.419451e-02 1 1  ON 48
eH2_9                 2.642567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1427
    reference variance = 0.363156
====================================================
  Execution time = 2.2397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2878e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328768670108
                                         uncertainty =       0.007228622255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328768670108
                                         uncertainty =       0.007228622255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405449538
  error estimate for blocks of size 2^( 2) =       0.000415214447
  error estimate for blocks of size 2^( 3) =       0.000423374246
  error estimate for blocks of size 2^( 4) =       0.000429355470
  error estimate for blocks of size 2^( 5) =       0.000433778163
  error estimate for blocks of size 2^( 6) =       0.000435710815
  error estimate for blocks of size 2^( 7) =       0.000435401443

      target function =                  N/A
              le_mean =     -17.216688808452
             les_mean =     296.743152019189
             stat err =       0.000433561473
             autocorr =       1.143477819761
              std dev =       0.573392236172
             le_variance =       0.328778656503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668880845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688808452       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691202799       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692997177       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216697771913       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216705201028       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216715129993       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717731982       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216717424386       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216718815882       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216723854238       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216721414621       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216722957680       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216726768181       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216728357066       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216730098626       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216729806456       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216730105807       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216730757363       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216731102906       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.771176e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688808452       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690716190       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692175694       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216695687727       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700838057       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216704905226       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216705186443       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216704610943       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216704773264       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216706086438       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216705097755       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216705472721       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216705807630       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216706199897       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.463451e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688808452       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216689860747       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690758719       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216692434478       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694640242       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216695253980       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216695173357       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216694804586       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216694984862       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216695025128       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.975023e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8097e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.089539e-01 1 1  ON 0
 uu_1                 4.775746e-02 1 1  ON 1
 uu_2                -4.535091e-02 1 1  ON 2
 uu_3                -9.933110e-02 1 1  ON 3
 uu_4                -1.318733e-01 1 1  ON 4
 uu_5                -1.378268e-01 1 1  ON 5
 uu_6                -1.140215e-01 1 1  ON 6
 uu_7                -4.190685e-02 1 1  ON 7
 uu_8                 9.771805e-02 1 1  ON 8
 uu_9                 1.216017e-01 1 1  ON 9
 ud_0                 3.459712e-01 1 1  ON 10
 ud_1                 9.085524e-02 1 1  ON 11
 ud_2                -1.322118e-02 1 1  ON 12
 ud_3                -7.118175e-02 1 1  ON 13
 ud_4                -1.190181e-01 1 1  ON 14
 ud_5                -1.529826e-01 1 1  ON 15
 ud_6                -1.562164e-01 1 1  ON 16
 ud_7                -1.118617e-01 1 1  ON 17
 ud_8                 1.548191e-03 1 1  ON 18
 ud_9                 9.233744e-02 1 1  ON 19
 eO_0                -7.528979e-01 1 1  ON 20
 eO_1                -4.401457e-01 1 1  ON 21
 eO_2                -4.424596e-02 1 1  ON 22
 eO_3                 2.033043e-01 1 1  ON 23
 eO_4                 2.959286e-01 1 1  ON 24
 eO_5                 3.128591e-01 1 1  ON 25
 eO_6                 2.531252e-01 1 1  ON 26
 eO_7                 1.146122e-01 1 1  ON 27
 eO_8                 2.811526e-02 1 1  ON 28
 eO_9                 1.850489e-02 1 1  ON 29
eH1_0                -1.812445e-01 1 1  ON 30
eH1_1                -1.024282e-01 1 1  ON 31
eH1_2                -6.258680e-02 1 1  ON 32
eH1_3                -2.667867e-02 1 1  ON 33
eH1_4                 1.886421e-02 1 1  ON 34
eH1_5                 3.335570e-02 1 1  ON 35
eH1_6                 7.839324e-02 1 1  ON 36
eH1_7                 1.098934e-01 1 1  ON 37
eH1_8                 9.208824e-02 1 1  ON 38
eH1_9                 2.476645e-02 1 1  ON 39
eH2_0                -1.833779e-01 1 1  ON 40
eH2_1                -1.045672e-01 1 1  ON 41
eH2_2                -6.369808e-02 1 1  ON 42
eH2_3                -2.736351e-02 1 1  ON 43
eH2_4                 1.844392e-02 1 1  ON 44
eH2_5                 3.448960e-02 1 1  ON 45
eH2_6                 7.817033e-02 1 1  ON 46
eH2_7                 1.135381e-01 1 1  ON 47
eH2_8                 9.534850e-02 1 1  ON 48
eH2_9                 2.673982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.232008
====================================================
  Execution time = 2.1886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1673e-01
  Total weights = 2.0000e+06
  Execution time = 1.8600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316141528089
                                         uncertainty =       0.002959171841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316141528089
                                         uncertainty =       0.002959171841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397524453
  error estimate for blocks of size 2^( 2) =       0.000407351408
  error estimate for blocks of size 2^( 3) =       0.000416009818
  error estimate for blocks of size 2^( 4) =       0.000422200768
  error estimate for blocks of size 2^( 5) =       0.000426797480
  error estimate for blocks of size 2^( 6) =       0.000428999311
  error estimate for blocks of size 2^( 7) =       0.000428969162

      target function =                  N/A
              le_mean =     -17.216818805359
             les_mean =     296.734901000548
             stat err =       0.000426741680
             autocorr =       1.152397819188
              std dev =       0.562184473302
             le_variance =       0.316051382021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317638488062
                                         uncertainty =       0.002972072349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317638488062
                                         uncertainty =       0.002972072349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398464321
  error estimate for blocks of size 2^( 2) =       0.000408233920
  error estimate for blocks of size 2^( 3) =       0.000416804288
  error estimate for blocks of size 2^( 4) =       0.000422915868
  error estimate for blocks of size 2^( 5) =       0.000427467634
  error estimate for blocks of size 2^( 6) =       0.000429644671
  error estimate for blocks of size 2^( 7) =       0.000429620403

      target function =                  N/A
              le_mean =     -17.216808204701
             les_mean =     296.736032229090
             stat err =       0.000427412144
             autocorr =       1.150574737323
              std dev =       0.563513647056
             le_variance =       0.317547630419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317549956493
                                         uncertainty =       0.002971863681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317549956493
                                         uncertainty =       0.002971863681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398408806
  error estimate for blocks of size 2^( 2) =       0.000408186489
  error estimate for blocks of size 2^( 3) =       0.000416769132
  error estimate for blocks of size 2^( 4) =       0.000422896526
  error estimate for blocks of size 2^( 5) =       0.000427462075
  error estimate for blocks of size 2^( 6) =       0.000429646921
  error estimate for blocks of size 2^( 7) =       0.000429609380

      target function =                  N/A
              le_mean =     -17.216811762638
             les_mean =     296.736066265325
             stat err =       0.000427403726
             autocorr =       1.150850069258
              std dev =       0.563435137313
             le_variance =       0.317459153959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316395855239
                                         uncertainty =       0.002961836627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316395855239
                                         uncertainty =       0.002961836627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397684289
  error estimate for blocks of size 2^( 2) =       0.000407500974
  error estimate for blocks of size 2^( 3) =       0.000416144242
  error estimate for blocks of size 2^( 4) =       0.000422323607
  error estimate for blocks of size 2^( 5) =       0.000426915298
  error estimate for blocks of size 2^( 6) =       0.000429113690
  error estimate for blocks of size 2^( 7) =       0.000429080357

      target function =                  N/A
              le_mean =     -17.216815031570
             les_mean =     296.735025259987
             stat err =       0.000426858238
             autocorr =       1.152100771471
              std dev =       0.562410514512
             le_variance =       0.316305586834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216818805359        initial  <--
     1.5625e-02     1.5625e-01             1.7712e-02       -17.216808204701
     6.2500e-02     6.2500e-01             6.4635e-03       -17.216811762638
     2.5000e-01     2.5000e+00             1.9750e-03       -17.216815031570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2221
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.072418e-01 1 1  ON 0
 uu_1                 4.662784e-02 1 1  ON 1
 uu_2                -4.601037e-02 1 1  ON 2
 uu_3                -9.902684e-02 1 1  ON 3
 uu_4                -1.309216e-01 1 1  ON 4
 uu_5                -1.362787e-01 1 1  ON 5
 uu_6                -1.139852e-01 1 1  ON 6
 uu_7                -4.090524e-02 1 1  ON 7
 uu_8                 9.899381e-02 1 1  ON 8
 uu_9                 1.209306e-01 1 1  ON 9
 ud_0                 3.444656e-01 1 1  ON 10
 ud_1                 8.956749e-02 1 1  ON 11
 ud_2                -1.435101e-02 1 1  ON 12
 ud_3                -7.184312e-02 1 1  ON 13
 ud_4                -1.188223e-01 1 1  ON 14
 ud_5                -1.520388e-01 1 1  ON 15
 ud_6                -1.545913e-01 1 1  ON 16
 ud_7                -1.111222e-01 1 1  ON 17
 ud_8                 3.402142e-03 1 1  ON 18
 ud_9                 9.229734e-02 1 1  ON 19
 eO_0                -7.464345e-01 1 1  ON 20
 eO_1                -4.350637e-01 1 1  ON 21
 eO_2                -4.138911e-02 1 1  ON 22
 eO_3                 2.023334e-01 1 1  ON 23
 eO_4                 2.902133e-01 1 1  ON 24
 eO_5                 3.093732e-01 1 1  ON 25
 eO_6                 2.511657e-01 1 1  ON 26
 eO_7                 1.127273e-01 1 1  ON 27
 eO_8                 2.787253e-02 1 1  ON 28
 eO_9                 1.844782e-02 1 1  ON 29
eH1_0                -1.805924e-01 1 1  ON 30
eH1_1                -1.020059e-01 1 1  ON 31
eH1_2                -6.241993e-02 1 1  ON 32
eH1_3                -2.669750e-02 1 1  ON 33
eH1_4                 1.832536e-02 1 1  ON 34
eH1_5                 3.452830e-02 1 1  ON 35
eH1_6                 7.825342e-02 1 1  ON 36
eH1_7                 1.097069e-01 1 1  ON 37
eH1_8                 9.095332e-02 1 1  ON 38
eH1_9                 2.448202e-02 1 1  ON 39
eH2_0                -1.824019e-01 1 1  ON 40
eH2_1                -1.034496e-01 1 1  ON 41
eH2_2                -6.359342e-02 1 1  ON 42
eH2_3                -2.743084e-02 1 1  ON 43
eH2_4                 1.831058e-02 1 1  ON 44
eH2_5                 3.416452e-02 1 1  ON 45
eH2_6                 7.816177e-02 1 1  ON 46
eH2_7                 1.134245e-01 1 1  ON 47
eH2_8                 9.419451e-02 1 1  ON 48
eH2_9                 2.642567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0882
    reference variance = 0.656544
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1728e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317288893563
                                         uncertainty =       0.004137596981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317288893563
                                         uncertainty =       0.004137596981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398298381
  error estimate for blocks of size 2^( 2) =       0.000407761270
  error estimate for blocks of size 2^( 3) =       0.000416122323
  error estimate for blocks of size 2^( 4) =       0.000422824371
  error estimate for blocks of size 2^( 5) =       0.000427535459
  error estimate for blocks of size 2^( 6) =       0.000430017155
  error estimate for blocks of size 2^( 7) =       0.000432044415

      target function =                  N/A
              le_mean =     -17.216493312115
             les_mean =     296.724925007714
             stat err =       0.000428105350
             autocorr =       1.155271951425
              std dev =       0.563278971957
             le_variance =       0.317283200249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649331212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216493312115       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216493763833       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216493224804       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216496592981       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216497074834       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216499184267       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216501295145       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216500874472       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216501569259       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216501512077       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216501516026       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.178488e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216493312115       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216493528860       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216493146729       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216494287080       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216494611191       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216495181827       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216495454416       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216495395119       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216495541027       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.904718e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216493312115       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216493382471       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216493243722       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216493543138       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216493646285       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216493792201       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216493817260       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216493816319       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.281308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6111e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.075850e-01 1 1  ON 0
 uu_1                 4.683000e-02 1 1  ON 1
 uu_2                -4.597800e-02 1 1  ON 2
 uu_3                -9.911012e-02 1 1  ON 3
 uu_4                -1.310419e-01 1 1  ON 4
 uu_5                -1.366001e-01 1 1  ON 5
 uu_6                -1.140533e-01 1 1  ON 6
 uu_7                -4.099069e-02 1 1  ON 7
 uu_8                 9.888675e-02 1 1  ON 8
 uu_9                 1.210131e-01 1 1  ON 9
 ud_0                 3.446737e-01 1 1  ON 10
 ud_1                 8.960191e-02 1 1  ON 11
 ud_2                -1.436076e-02 1 1  ON 12
 ud_3                -7.185963e-02 1 1  ON 13
 ud_4                -1.190142e-01 1 1  ON 14
 ud_5                -1.522560e-01 1 1  ON 15
 ud_6                -1.545389e-01 1 1  ON 16
 ud_7                -1.109793e-01 1 1  ON 17
 ud_8                 3.278250e-03 1 1  ON 18
 ud_9                 9.232047e-02 1 1  ON 19
 eO_0                -7.473250e-01 1 1  ON 20
 eO_1                -4.356724e-01 1 1  ON 21
 eO_2                -4.167339e-02 1 1  ON 22
 eO_3                 2.026625e-01 1 1  ON 23
 eO_4                 2.909168e-01 1 1  ON 24
 eO_5                 3.096264e-01 1 1  ON 25
 eO_6                 2.513686e-01 1 1  ON 26
 eO_7                 1.129605e-01 1 1  ON 27
 eO_8                 2.791495e-02 1 1  ON 28
 eO_9                 1.845843e-02 1 1  ON 29
eH1_0                -1.807736e-01 1 1  ON 30
eH1_1                -1.021726e-01 1 1  ON 31
eH1_2                -6.246310e-02 1 1  ON 32
eH1_3                -2.673641e-02 1 1  ON 33
eH1_4                 1.845489e-02 1 1  ON 34
eH1_5                 3.461432e-02 1 1  ON 35
eH1_6                 7.829469e-02 1 1  ON 36
eH1_7                 1.097088e-01 1 1  ON 37
eH1_8                 9.107801e-02 1 1  ON 38
eH1_9                 2.451759e-02 1 1  ON 39
eH2_0                -1.823625e-01 1 1  ON 40
eH2_1                -1.034237e-01 1 1  ON 41
eH2_2                -6.357091e-02 1 1  ON 42
eH2_3                -2.749600e-02 1 1  ON 43
eH2_4                 1.817228e-02 1 1  ON 44
eH2_5                 3.413347e-02 1 1  ON 45
eH2_6                 7.813156e-02 1 1  ON 46
eH2_7                 1.134166e-01 1 1  ON 47
eH2_8                 9.432358e-02 1 1  ON 48
eH2_9                 2.647048e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.3136
    reference variance = 0.524028
====================================================
  Execution time = 1.9852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319102804710
                                         uncertainty =       0.003246159587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319102804710
                                         uncertainty =       0.003246159587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399464063
  error estimate for blocks of size 2^( 2) =       0.000409273025
  error estimate for blocks of size 2^( 3) =       0.000418143889
  error estimate for blocks of size 2^( 4) =       0.000424917932
  error estimate for blocks of size 2^( 5) =       0.000431086665
  error estimate for blocks of size 2^( 6) =       0.000433775771
  error estimate for blocks of size 2^( 7) =       0.000436259026

      target function =                  N/A
              le_mean =     -17.215638990191
             les_mean =     296.697368755769
             stat err =       0.000431509849
             autocorr =       1.166879460561
              std dev =       0.564927495139
             le_variance =       0.319143074764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319821243700
                                         uncertainty =       0.003254543597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319821243700
                                         uncertainty =       0.003254543597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399913590
  error estimate for blocks of size 2^( 2) =       0.000409699698
  error estimate for blocks of size 2^( 3) =       0.000418547495
  error estimate for blocks of size 2^( 4) =       0.000425302247
  error estimate for blocks of size 2^( 5) =       0.000431463080
  error estimate for blocks of size 2^( 6) =       0.000434146698
  error estimate for blocks of size 2^( 7) =       0.000436634535

      target function =                  N/A
              le_mean =     -17.215638017681
             les_mean =     296.698053955073
             stat err =       0.000431886640
             autocorr =       1.166291777762
              std dev =       0.565563222970
             le_variance =       0.319861759177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319670933203
                                         uncertainty =       0.003252950345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319670933203
                                         uncertainty =       0.003252950345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399819571
  error estimate for blocks of size 2^( 2) =       0.000409611134
  error estimate for blocks of size 2^( 3) =       0.000418465760
  error estimate for blocks of size 2^( 4) =       0.000425225354
  error estimate for blocks of size 2^( 5) =       0.000431389190
  error estimate for blocks of size 2^( 6) =       0.000434074200
  error estimate for blocks of size 2^( 7) =       0.000436568546

      target function =                  N/A
              le_mean =     -17.215637429707
             les_mean =     296.697883329282
             stat err =       0.000431814323
             autocorr =       1.166449629348
              std dev =       0.565430259192
             le_variance =       0.319711378010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319195854662
                                         uncertainty =       0.003247274383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319195854662
                                         uncertainty =       0.003247274383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399522308
  error estimate for blocks of size 2^( 2) =       0.000409328412
  error estimate for blocks of size 2^( 3) =       0.000418196734
  error estimate for blocks of size 2^( 4) =       0.000424968494
  error estimate for blocks of size 2^( 5) =       0.000431136429
  error estimate for blocks of size 2^( 6) =       0.000433824686
  error estimate for blocks of size 2^( 7) =       0.000436310559

      target function =                  N/A
              le_mean =     -17.215638521126
             les_mean =     296.697445680156
             stat err =       0.000431560042
             autocorr =       1.166810651155
              std dev =       0.565009866895
             le_variance =       0.319236149689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215638990191        initial  <--
     1.5625e-01     1.5625e+00             3.1785e-03       -17.215638017681
     6.2500e-01     6.2500e+00             8.9047e-04       -17.215637429707
     2.5000e+00     2.5000e+01             2.2813e-04       -17.215638521126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1717
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.072418e-01 1 1  ON 0
 uu_1                 4.662784e-02 1 1  ON 1
 uu_2                -4.601037e-02 1 1  ON 2
 uu_3                -9.902684e-02 1 1  ON 3
 uu_4                -1.309216e-01 1 1  ON 4
 uu_5                -1.362787e-01 1 1  ON 5
 uu_6                -1.139852e-01 1 1  ON 6
 uu_7                -4.090524e-02 1 1  ON 7
 uu_8                 9.899381e-02 1 1  ON 8
 uu_9                 1.209306e-01 1 1  ON 9
 ud_0                 3.444656e-01 1 1  ON 10
 ud_1                 8.956749e-02 1 1  ON 11
 ud_2                -1.435101e-02 1 1  ON 12
 ud_3                -7.184312e-02 1 1  ON 13
 ud_4                -1.188223e-01 1 1  ON 14
 ud_5                -1.520388e-01 1 1  ON 15
 ud_6                -1.545913e-01 1 1  ON 16
 ud_7                -1.111222e-01 1 1  ON 17
 ud_8                 3.402142e-03 1 1  ON 18
 ud_9                 9.229734e-02 1 1  ON 19
 eO_0                -7.464345e-01 1 1  ON 20
 eO_1                -4.350637e-01 1 1  ON 21
 eO_2                -4.138911e-02 1 1  ON 22
 eO_3                 2.023334e-01 1 1  ON 23
 eO_4                 2.902133e-01 1 1  ON 24
 eO_5                 3.093732e-01 1 1  ON 25
 eO_6                 2.511657e-01 1 1  ON 26
 eO_7                 1.127273e-01 1 1  ON 27
 eO_8                 2.787253e-02 1 1  ON 28
 eO_9                 1.844782e-02 1 1  ON 29
eH1_0                -1.805924e-01 1 1  ON 30
eH1_1                -1.020059e-01 1 1  ON 31
eH1_2                -6.241993e-02 1 1  ON 32
eH1_3                -2.669750e-02 1 1  ON 33
eH1_4                 1.832536e-02 1 1  ON 34
eH1_5                 3.452830e-02 1 1  ON 35
eH1_6                 7.825342e-02 1 1  ON 36
eH1_7                 1.097069e-01 1 1  ON 37
eH1_8                 9.095332e-02 1 1  ON 38
eH1_9                 2.448202e-02 1 1  ON 39
eH2_0                -1.824019e-01 1 1  ON 40
eH2_1                -1.034496e-01 1 1  ON 41
eH2_2                -6.359342e-02 1 1  ON 42
eH2_3                -2.743084e-02 1 1  ON 43
eH2_4                 1.831058e-02 1 1  ON 44
eH2_5                 3.416452e-02 1 1  ON 45
eH2_6                 7.816177e-02 1 1  ON 46
eH2_7                 1.134245e-01 1 1  ON 47
eH2_8                 9.419451e-02 1 1  ON 48
eH2_9                 2.642567e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1881
    reference variance = 0.373126
====================================================
  Execution time = 2.1112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2947e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368051177
                                         uncertainty =       0.006763640230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368051177
                                         uncertainty =       0.006763640230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405874133
  error estimate for blocks of size 2^( 2) =       0.000415566540
  error estimate for blocks of size 2^( 3) =       0.000424108580
  error estimate for blocks of size 2^( 4) =       0.000430086568
  error estimate for blocks of size 2^( 5) =       0.000432695887
  error estimate for blocks of size 2^( 6) =       0.000433763251
  error estimate for blocks of size 2^( 7) =       0.000434740526

      target function =                  N/A
              le_mean =     -17.215931215405
             les_mean =     296.717755071868
             stat err =       0.000432821558
             autocorr =       1.137195206566
              std dev =       0.573992702964
             le_variance =       0.329467623056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593121540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215931215405       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215931431994       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215932226872       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215932709786       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215932941768       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215932922865       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215932822268       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.201950e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215931215405       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215931275013       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215931493145       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215931642946       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215931711967       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215931700099       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215931671755       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.947784e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215931215405       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215931230692       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215931286639       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215931326407       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215931344651       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215931341307       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215931333897       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.980822e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6663e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.072944e-01 1 1  ON 0
 uu_1                 4.664476e-02 1 1  ON 1
 uu_2                -4.601938e-02 1 1  ON 2
 uu_3                -9.904139e-02 1 1  ON 3
 uu_4                -1.309423e-01 1 1  ON 4
 uu_5                -1.363092e-01 1 1  ON 5
 uu_6                -1.139880e-01 1 1  ON 6
 uu_7                -4.090904e-02 1 1  ON 7
 uu_8                 9.898600e-02 1 1  ON 8
 uu_9                 1.209403e-01 1 1  ON 9
 ud_0                 3.444898e-01 1 1  ON 10
 ud_1                 8.957399e-02 1 1  ON 11
 ud_2                -1.435053e-02 1 1  ON 12
 ud_3                -7.184783e-02 1 1  ON 13
 ud_4                -1.188603e-01 1 1  ON 14
 ud_5                -1.520370e-01 1 1  ON 15
 ud_6                -1.545848e-01 1 1  ON 16
 ud_7                -1.111139e-01 1 1  ON 17
 ud_8                 3.388230e-03 1 1  ON 18
 ud_9                 9.229849e-02 1 1  ON 19
 eO_0                -7.465140e-01 1 1  ON 20
 eO_1                -4.351361e-01 1 1  ON 21
 eO_2                -4.140533e-02 1 1  ON 22
 eO_3                 2.023527e-01 1 1  ON 23
 eO_4                 2.902880e-01 1 1  ON 24
 eO_5                 3.094007e-01 1 1  ON 25
 eO_6                 2.511848e-01 1 1  ON 26
 eO_7                 1.127498e-01 1 1  ON 27
 eO_8                 2.787599e-02 1 1  ON 28
 eO_9                 1.844867e-02 1 1  ON 29
eH1_0                -1.805929e-01 1 1  ON 30
eH1_1                -1.020228e-01 1 1  ON 31
eH1_2                -6.242036e-02 1 1  ON 32
eH1_3                -2.669573e-02 1 1  ON 33
eH1_4                 1.832766e-02 1 1  ON 34
eH1_5                 3.452082e-02 1 1  ON 35
eH1_6                 7.825831e-02 1 1  ON 36
eH1_7                 1.097074e-01 1 1  ON 37
eH1_8                 9.096507e-02 1 1  ON 38
eH1_9                 2.448535e-02 1 1  ON 39
eH2_0                -1.824055e-01 1 1  ON 40
eH2_1                -1.034688e-01 1 1  ON 41
eH2_2                -6.359555e-02 1 1  ON 42
eH2_3                -2.744349e-02 1 1  ON 43
eH2_4                 1.830965e-02 1 1  ON 44
eH2_5                 3.417789e-02 1 1  ON 45
eH2_6                 7.816786e-02 1 1  ON 46
eH2_7                 1.134241e-01 1 1  ON 47
eH2_8                 9.420929e-02 1 1  ON 48
eH2_9                 2.642955e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.569866
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4236e-01
  Total weights = 2.0000e+06
  Execution time = 1.8599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342293439560
                                         uncertainty =       0.020451361744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342293439560
                                         uncertainty =       0.020451361744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413716125
  error estimate for blocks of size 2^( 2) =       0.000423304600
  error estimate for blocks of size 2^( 3) =       0.000432189151
  error estimate for blocks of size 2^( 4) =       0.000438446948
  error estimate for blocks of size 2^( 5) =       0.000443776679
  error estimate for blocks of size 2^( 6) =       0.000445537073
  error estimate for blocks of size 2^( 7) =       0.000446425564

      target function =                  N/A
              le_mean =     -17.216750557619
             les_mean =     296.758821656516
             stat err =       0.000443546566
             autocorr =       1.149406227688
              std dev =       0.585082955158
             le_variance =       0.342322064417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431459948
                                         uncertainty =       0.020460613509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342431459948
                                         uncertainty =       0.020460613509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413799563
  error estimate for blocks of size 2^( 2) =       0.000423385138
  error estimate for blocks of size 2^( 3) =       0.000432265439
  error estimate for blocks of size 2^( 4) =       0.000438519646
  error estimate for blocks of size 2^( 5) =       0.000443847962
  error estimate for blocks of size 2^( 6) =       0.000445606439
  error estimate for blocks of size 2^( 7) =       0.000446493849

      target function =                  N/A
              le_mean =     -17.216751635352
             les_mean =     296.758996858212
             stat err =       0.000443616974
             autocorr =       1.149307539244
              std dev =       0.585200953548
             le_variance =       0.342460156033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342371007859
                                         uncertainty =       0.020456591730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342371007859
                                         uncertainty =       0.020456591730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413763018
  error estimate for blocks of size 2^( 2) =       0.000423349893
  error estimate for blocks of size 2^( 3) =       0.000432232156
  error estimate for blocks of size 2^( 4) =       0.000438487984
  error estimate for blocks of size 2^( 5) =       0.000443817002
  error estimate for blocks of size 2^( 6) =       0.000445576415
  error estimate for blocks of size 2^( 7) =       0.000446464240

      target function =                  N/A
              le_mean =     -17.216751191667
             les_mean =     296.758921095181
             stat err =       0.000443586410
             autocorr =       1.149352175871
              std dev =       0.585149272069
             le_variance =       0.342399670603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342303475751
                                         uncertainty =       0.020452039110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342303475751
                                         uncertainty =       0.020452039110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413722193
  error estimate for blocks of size 2^( 2) =       0.000423310460
  error estimate for blocks of size 2^( 3) =       0.000432194718
  error estimate for blocks of size 2^( 4) =       0.000438452262
  error estimate for blocks of size 2^( 5) =       0.000443781903
  error estimate for blocks of size 2^( 6) =       0.000445542174
  error estimate for blocks of size 2^( 7) =       0.000446430576

      target function =                  N/A
              le_mean =     -17.216750639133
             les_mean =     296.758834504367
             stat err =       0.000443551729
             autocorr =       1.149399269750
              std dev =       0.585091535941
             le_variance =       0.342332105430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216750557619        initial
     1.5625e+00     1.5625e+01             3.2020e-04       -17.216751635352  <--
     6.2500e+00     6.2500e+01             7.9478e-05       -17.216751191667
     2.5000e+01     2.5000e+02             1.9808e-05       -17.216750639133

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9922e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.074400e-01 1 1  ON 0
 uu_1                 4.668865e-02 1 1  ON 1
 uu_2                -4.603605e-02 1 1  ON 2
 uu_3                -9.908313e-02 1 1  ON 3
 uu_4                -1.310005e-01 1 1  ON 4
 uu_5                -1.364000e-01 1 1  ON 5
 uu_6                -1.139957e-01 1 1  ON 6
 uu_7                -4.091904e-02 1 1  ON 7
 uu_8                 9.896342e-02 1 1  ON 8
 uu_9                 1.209690e-01 1 1  ON 9
 ud_0                 3.445512e-01 1 1  ON 10
 ud_1                 8.959580e-02 1 1  ON 11
 ud_2                -1.434791e-02 1 1  ON 12
 ud_3                -7.186351e-02 1 1  ON 13
 ud_4                -1.189575e-01 1 1  ON 14
 ud_5                -1.520424e-01 1 1  ON 15
 ud_6                -1.545648e-01 1 1  ON 16
 ud_7                -1.110873e-01 1 1  ON 17
 ud_8                 3.347766e-03 1 1  ON 18
 ud_9                 9.230202e-02 1 1  ON 19
 eO_0                -7.467547e-01 1 1  ON 20
 eO_1                -4.353401e-01 1 1  ON 21
 eO_2                -4.145862e-02 1 1  ON 22
 eO_3                 2.024117e-01 1 1  ON 23
 eO_4                 2.905065e-01 1 1  ON 24
 eO_5                 3.094823e-01 1 1  ON 25
 eO_6                 2.512420e-01 1 1  ON 26
 eO_7                 1.128163e-01 1 1  ON 27
 eO_8                 2.788624e-02 1 1  ON 28
 eO_9                 1.845121e-02 1 1  ON 29
eH1_0                -1.805965e-01 1 1  ON 30
eH1_1                -1.020701e-01 1 1  ON 31
eH1_2                -6.242247e-02 1 1  ON 32
eH1_3                -2.668991e-02 1 1  ON 33
eH1_4                 1.833456e-02 1 1  ON 34
eH1_5                 3.449800e-02 1 1  ON 35
eH1_6                 7.827265e-02 1 1  ON 36
eH1_7                 1.097089e-01 1 1  ON 37
eH1_8                 9.099991e-02 1 1  ON 38
eH1_9                 2.449519e-02 1 1  ON 39
eH2_0                -1.824178e-01 1 1  ON 40
eH2_1                -1.035236e-01 1 1  ON 41
eH2_2                -6.360471e-02 1 1  ON 42
eH2_3                -2.747879e-02 1 1  ON 43
eH2_4                 1.830549e-02 1 1  ON 44
eH2_5                 3.421783e-02 1 1  ON 45
eH2_6                 7.818662e-02 1 1  ON 46
eH2_7                 1.134236e-01 1 1  ON 47
eH2_8                 9.425306e-02 1 1  ON 48
eH2_9                 2.644102e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.159
    reference variance = 0.380163
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2134e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321373940607
                                         uncertainty =       0.009177187663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321373940607
                                         uncertainty =       0.009177187663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400833961
  error estimate for blocks of size 2^( 2) =       0.000410303572
  error estimate for blocks of size 2^( 3) =       0.000418241698
  error estimate for blocks of size 2^( 4) =       0.000424325985
  error estimate for blocks of size 2^( 5) =       0.000428231667
  error estimate for blocks of size 2^( 6) =       0.000429947432
  error estimate for blocks of size 2^( 7) =       0.000430935858

      target function =                  N/A
              le_mean =     -17.215595868582
             les_mean =     296.698076678410
             stat err =       0.000428360236
             autocorr =       1.142060936004
              std dev =       0.566864824046
             le_variance =       0.321335728740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721559586858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215595868582       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215597229762       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215597680058       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215597632623       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215599509772       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215599560002       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215599463288       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215599394608       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215599414405       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.229301e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215595868582       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215596331938       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215596547885       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215596449976       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215596916992       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215596906801       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215596895859       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215596898428       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.172029e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215595868582       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215595995935       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215596062461       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215596029225       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215596138389       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215596134336       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215596134583       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215596136554       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 8.028711e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6067e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.076347e-01 1 1  ON 0
 uu_1                 4.676229e-02 1 1  ON 1
 uu_2                -4.602852e-02 1 1  ON 2
 uu_3                -9.915689e-02 1 1  ON 3
 uu_4                -1.310951e-01 1 1  ON 4
 uu_5                -1.365316e-01 1 1  ON 5
 uu_6                -1.140185e-01 1 1  ON 6
 uu_7                -4.093306e-02 1 1  ON 7
 uu_8                 9.894281e-02 1 1  ON 8
 uu_9                 1.210122e-01 1 1  ON 9
 ud_0                 3.446065e-01 1 1  ON 10
 ud_1                 8.960984e-02 1 1  ON 11
 ud_2                -1.434350e-02 1 1  ON 12
 ud_3                -7.183741e-02 1 1  ON 13
 ud_4                -1.190107e-01 1 1  ON 14
 ud_5                -1.521335e-01 1 1  ON 15
 ud_6                -1.545741e-01 1 1  ON 16
 ud_7                -1.110223e-01 1 1  ON 17
 ud_8                 3.298907e-03 1 1  ON 18
 ud_9                 9.230665e-02 1 1  ON 19
 eO_0                -7.470557e-01 1 1  ON 20
 eO_1                -4.356215e-01 1 1  ON 21
 eO_2                -4.159068e-02 1 1  ON 22
 eO_3                 2.024843e-01 1 1  ON 23
 eO_4                 2.908237e-01 1 1  ON 24
 eO_5                 3.096053e-01 1 1  ON 25
 eO_6                 2.513321e-01 1 1  ON 26
 eO_7                 1.129074e-01 1 1  ON 27
 eO_8                 2.789955e-02 1 1  ON 28
 eO_9                 1.845569e-02 1 1  ON 29
eH1_0                -1.806535e-01 1 1  ON 30
eH1_1                -1.021325e-01 1 1  ON 31
eH1_2                -6.245957e-02 1 1  ON 32
eH1_3                -2.668470e-02 1 1  ON 33
eH1_4                 1.837016e-02 1 1  ON 34
eH1_5                 3.451232e-02 1 1  ON 35
eH1_6                 7.831144e-02 1 1  ON 36
eH1_7                 1.097101e-01 1 1  ON 37
eH1_8                 9.104367e-02 1 1  ON 38
eH1_9                 2.450989e-02 1 1  ON 39
eH2_0                -1.823637e-01 1 1  ON 40
eH2_1                -1.035894e-01 1 1  ON 41
eH2_2                -6.358548e-02 1 1  ON 42
eH2_3                -2.747627e-02 1 1  ON 43
eH2_4                 1.824001e-02 1 1  ON 44
eH2_5                 3.416683e-02 1 1  ON 45
eH2_6                 7.820775e-02 1 1  ON 46
eH2_7                 1.134351e-01 1 1  ON 47
eH2_8                 9.430901e-02 1 1  ON 48
eH2_9                 2.645688e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.222494
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315363399076
                                         uncertainty =       0.002848301547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315363399076
                                         uncertainty =       0.002848301547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397064639
  error estimate for blocks of size 2^( 2) =       0.000406658460
  error estimate for blocks of size 2^( 3) =       0.000415298999
  error estimate for blocks of size 2^( 4) =       0.000422075158
  error estimate for blocks of size 2^( 5) =       0.000426013636
  error estimate for blocks of size 2^( 6) =       0.000427605334
  error estimate for blocks of size 2^( 7) =       0.000429375269

      target function =                  N/A
              le_mean =     -17.216220705680
             les_mean =     296.713575883712
             stat err =       0.000426267349
             autocorr =       1.152502065551
              std dev =       0.561534197257
             le_variance =       0.315320654689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315666180506
                                         uncertainty =       0.002851116128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315666180506
                                         uncertainty =       0.002851116128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397255218
  error estimate for blocks of size 2^( 2) =       0.000406839404
  error estimate for blocks of size 2^( 3) =       0.000415467064
  error estimate for blocks of size 2^( 4) =       0.000422234490
  error estimate for blocks of size 2^( 5) =       0.000426170538
  error estimate for blocks of size 2^( 6) =       0.000427762437
  error estimate for blocks of size 2^( 7) =       0.000429531959

      target function =                  N/A
              le_mean =     -17.216219630786
             les_mean =     296.713841634132
             stat err =       0.000426424856
             autocorr =       1.152247573274
              std dev =       0.561803717027
             le_variance =       0.315623416465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563166513
                                         uncertainty =       0.002850141464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563166513
                                         uncertainty =       0.002850141464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397190384
  error estimate for blocks of size 2^( 2) =       0.000406777795
  error estimate for blocks of size 2^( 3) =       0.000415410129
  error estimate for blocks of size 2^( 4) =       0.000422180971
  error estimate for blocks of size 2^( 5) =       0.000426117752
  error estimate for blocks of size 2^( 6) =       0.000427710309
  error estimate for blocks of size 2^( 7) =       0.000429478864

      target function =                  N/A
              le_mean =     -17.216219406604
             les_mean =     296.713730900902
             stat err =       0.000426371974
             autocorr =       1.152337908017
              std dev =       0.561712027946
             le_variance =       0.315520402339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315391589474
                                         uncertainty =       0.002848559049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315391589474
                                         uncertainty =       0.002848559049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397082386
  error estimate for blocks of size 2^( 2) =       0.000406675283
  error estimate for blocks of size 2^( 3) =       0.000415314672
  error estimate for blocks of size 2^( 4) =       0.000422090096
  error estimate for blocks of size 2^( 5) =       0.000426028318
  error estimate for blocks of size 2^( 6) =       0.000427620184
  error estimate for blocks of size 2^( 7) =       0.000429389855

      target function =                  N/A
              le_mean =     -17.216220476389
             les_mean =     296.713596175875
             stat err =       0.000426282114
             autocorr =       1.152478881377
              std dev =       0.561559295110
             le_variance =       0.315348841924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216220705680        initial  <--
     3.9062e-01     3.9062e+00             1.2293e-03       -17.216219630786
     1.5625e+00     1.5625e+01             3.1720e-04       -17.216219406604
     6.2500e+00     6.2500e+01             8.0287e-05       -17.216220476389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1939
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.074400e-01 1 1  ON 0
 uu_1                 4.668865e-02 1 1  ON 1
 uu_2                -4.603605e-02 1 1  ON 2
 uu_3                -9.908313e-02 1 1  ON 3
 uu_4                -1.310005e-01 1 1  ON 4
 uu_5                -1.364000e-01 1 1  ON 5
 uu_6                -1.139957e-01 1 1  ON 6
 uu_7                -4.091904e-02 1 1  ON 7
 uu_8                 9.896342e-02 1 1  ON 8
 uu_9                 1.209690e-01 1 1  ON 9
 ud_0                 3.445512e-01 1 1  ON 10
 ud_1                 8.959580e-02 1 1  ON 11
 ud_2                -1.434791e-02 1 1  ON 12
 ud_3                -7.186351e-02 1 1  ON 13
 ud_4                -1.189575e-01 1 1  ON 14
 ud_5                -1.520424e-01 1 1  ON 15
 ud_6                -1.545648e-01 1 1  ON 16
 ud_7                -1.110873e-01 1 1  ON 17
 ud_8                 3.347766e-03 1 1  ON 18
 ud_9                 9.230202e-02 1 1  ON 19
 eO_0                -7.467547e-01 1 1  ON 20
 eO_1                -4.353401e-01 1 1  ON 21
 eO_2                -4.145862e-02 1 1  ON 22
 eO_3                 2.024117e-01 1 1  ON 23
 eO_4                 2.905065e-01 1 1  ON 24
 eO_5                 3.094823e-01 1 1  ON 25
 eO_6                 2.512420e-01 1 1  ON 26
 eO_7                 1.128163e-01 1 1  ON 27
 eO_8                 2.788624e-02 1 1  ON 28
 eO_9                 1.845121e-02 1 1  ON 29
eH1_0                -1.805965e-01 1 1  ON 30
eH1_1                -1.020701e-01 1 1  ON 31
eH1_2                -6.242247e-02 1 1  ON 32
eH1_3                -2.668991e-02 1 1  ON 33
eH1_4                 1.833456e-02 1 1  ON 34
eH1_5                 3.449800e-02 1 1  ON 35
eH1_6                 7.827265e-02 1 1  ON 36
eH1_7                 1.097089e-01 1 1  ON 37
eH1_8                 9.099991e-02 1 1  ON 38
eH1_9                 2.449519e-02 1 1  ON 39
eH2_0                -1.824178e-01 1 1  ON 40
eH2_1                -1.035236e-01 1 1  ON 41
eH2_2                -6.360471e-02 1 1  ON 42
eH2_3                -2.747879e-02 1 1  ON 43
eH2_4                 1.830549e-02 1 1  ON 44
eH2_5                 3.421783e-02 1 1  ON 45
eH2_6                 7.818662e-02 1 1  ON 46
eH2_7                 1.134236e-01 1 1  ON 47
eH2_8                 9.425306e-02 1 1  ON 48
eH2_9                 2.644102e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.315769
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318622538178
                                         uncertainty =       0.003855641941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318622538178
                                         uncertainty =       0.003855641941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399140264
  error estimate for blocks of size 2^( 2) =       0.000409179844
  error estimate for blocks of size 2^( 3) =       0.000417299028
  error estimate for blocks of size 2^( 4) =       0.000423884504
  error estimate for blocks of size 2^( 5) =       0.000427240749
  error estimate for blocks of size 2^( 6) =       0.000428605417
  error estimate for blocks of size 2^( 7) =       0.000430047197

      target function =                  N/A
              le_mean =     -17.216020389606
             les_mean =     296.709983797199
             stat err =       0.000427444467
             autocorr =       1.146854486378
              std dev =       0.564469575065
             le_variance =       0.318625901174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602038961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020389606       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020610266       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020653635       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020882807       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216021009370       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020883012       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020936597       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216020948612       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.376845e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020389606       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020446745       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020457615       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020515116       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216020548990       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020517919       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020531281       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.415603e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216020389606       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216020404020       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216020406740       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020421130       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216020429742       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020422017       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216020425360       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.549704e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5971e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.074605e-01 1 1  ON 0
 uu_1                 4.669911e-02 1 1  ON 1
 uu_2                -4.603237e-02 1 1  ON 2
 uu_3                -9.908975e-02 1 1  ON 3
 uu_4                -1.310098e-01 1 1  ON 4
 uu_5                -1.364159e-01 1 1  ON 5
 uu_6                -1.139952e-01 1 1  ON 6
 uu_7                -4.092602e-02 1 1  ON 7
 uu_8                 9.895955e-02 1 1  ON 8
 uu_9                 1.209724e-01 1 1  ON 9
 ud_0                 3.445555e-01 1 1  ON 10
 ud_1                 8.959903e-02 1 1  ON 11
 ud_2                -1.434745e-02 1 1  ON 12
 ud_3                -7.185634e-02 1 1  ON 13
 ud_4                -1.189666e-01 1 1  ON 14
 ud_5                -1.520435e-01 1 1  ON 15
 ud_6                -1.545690e-01 1 1  ON 16
 ud_7                -1.110868e-01 1 1  ON 17
 ud_8                 3.342263e-03 1 1  ON 18
 ud_9                 9.230305e-02 1 1  ON 19
 eO_0                -7.467888e-01 1 1  ON 20
 eO_1                -4.353643e-01 1 1  ON 21
 eO_2                -4.147397e-02 1 1  ON 22
 eO_3                 2.024263e-01 1 1  ON 23
 eO_4                 2.905388e-01 1 1  ON 24
 eO_5                 3.094925e-01 1 1  ON 25
 eO_6                 2.512485e-01 1 1  ON 26
 eO_7                 1.128243e-01 1 1  ON 27
 eO_8                 2.788755e-02 1 1  ON 28
 eO_9                 1.845162e-02 1 1  ON 29
eH1_0                -1.806041e-01 1 1  ON 30
eH1_1                -1.020803e-01 1 1  ON 31
eH1_2                -6.242242e-02 1 1  ON 32
eH1_3                -2.668547e-02 1 1  ON 33
eH1_4                 1.833671e-02 1 1  ON 34
eH1_5                 3.450086e-02 1 1  ON 35
eH1_6                 7.827576e-02 1 1  ON 36
eH1_7                 1.097076e-01 1 1  ON 37
eH1_8                 9.100462e-02 1 1  ON 38
eH1_9                 2.449682e-02 1 1  ON 39
eH2_0                -1.824232e-01 1 1  ON 40
eH2_1                -1.035271e-01 1 1  ON 41
eH2_2                -6.360403e-02 1 1  ON 42
eH2_3                -2.747865e-02 1 1  ON 43
eH2_4                 1.829987e-02 1 1  ON 44
eH2_5                 3.422286e-02 1 1  ON 45
eH2_6                 7.818847e-02 1 1  ON 46
eH2_7                 1.134235e-01 1 1  ON 47
eH2_8                 9.425777e-02 1 1  ON 48
eH2_9                 2.644242e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.239102
====================================================
  Execution time = 1.9895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325311730459
                                         uncertainty =       0.004584586149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325311730459
                                         uncertainty =       0.004584586149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403294875
  error estimate for blocks of size 2^( 2) =       0.000413136474
  error estimate for blocks of size 2^( 3) =       0.000421762150
  error estimate for blocks of size 2^( 4) =       0.000427982350
  error estimate for blocks of size 2^( 5) =       0.000432806005
  error estimate for blocks of size 2^( 6) =       0.000434229817
  error estimate for blocks of size 2^( 7) =       0.000436475583

      target function =                  N/A
              le_mean =     -17.216598260123
             les_mean =     296.736549000673
             stat err =       0.000432873439
             autocorr =       1.152063638047
              std dev =       0.570345082260
             le_variance =       0.325293512858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325343379977
                                         uncertainty =       0.004584807312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325343379977
                                         uncertainty =       0.004584807312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403314494
  error estimate for blocks of size 2^( 2) =       0.000413154757
  error estimate for blocks of size 2^( 3) =       0.000421779341
  error estimate for blocks of size 2^( 4) =       0.000427998670
  error estimate for blocks of size 2^( 5) =       0.000432821571
  error estimate for blocks of size 2^( 6) =       0.000434244365
  error estimate for blocks of size 2^( 7) =       0.000436491535

      target function =                  N/A
              le_mean =     -17.216598581809
             les_mean =     296.736591725833
             stat err =       0.000432889035
             autocorr =       1.152034573915
              std dev =       0.570372826611
             le_variance =       0.325325161336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328254403
                                         uncertainty =       0.004584699717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325328254403
                                         uncertainty =       0.004584699717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403305118
  error estimate for blocks of size 2^( 2) =       0.000413146005
  error estimate for blocks of size 2^( 3) =       0.000421771107
  error estimate for blocks of size 2^( 4) =       0.000427990869
  error estimate for blocks of size 2^( 5) =       0.000432814141
  error estimate for blocks of size 2^( 6) =       0.000434237419
  error estimate for blocks of size 2^( 7) =       0.000436483869

      target function =                  N/A
              le_mean =     -17.216598428819
             les_mean =     296.736571332636
             stat err =       0.000432881574
             autocorr =       1.152048424992
              std dev =       0.570359567364
             le_variance =       0.325310036084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325313826161
                                         uncertainty =       0.004584600607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325313826161
                                         uncertainty =       0.004584600607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403296174
  error estimate for blocks of size 2^( 2) =       0.000413137683
  error estimate for blocks of size 2^( 3) =       0.000421763286
  error estimate for blocks of size 2^( 4) =       0.000427983430
  error estimate for blocks of size 2^( 5) =       0.000432807037
  error estimate for blocks of size 2^( 6) =       0.000434230781
  error estimate for blocks of size 2^( 7) =       0.000436476633

      target function =                  N/A
              le_mean =     -17.216598281421
             les_mean =     296.736551829634
             stat err =       0.000432874470
             autocorr =       1.152061707940
              std dev =       0.570346919397
             le_variance =       0.325295608466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216598260123        initial
     3.9062e+00     3.9062e+01             1.3768e-04       -17.216598581809  <--
     1.5625e+01     1.5625e+02             3.4156e-05       -17.216598428819
     6.2500e+01     6.2500e+02             8.5497e-06       -17.216598281421

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.9249e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.075210e-01 1 1  ON 0
 uu_1                 4.672871e-02 1 1  ON 1
 uu_2                -4.602308e-02 1 1  ON 2
 uu_3                -9.910793e-02 1 1  ON 3
 uu_4                -1.310359e-01 1 1  ON 4
 uu_5                -1.364621e-01 1 1  ON 5
 uu_6                -1.139941e-01 1 1  ON 6
 uu_7                -4.094748e-02 1 1  ON 7
 uu_8                 9.894771e-02 1 1  ON 8
 uu_9                 1.209825e-01 1 1  ON 9
 ud_0                 3.445688e-01 1 1  ON 10
 ud_1                 8.960964e-02 1 1  ON 11
 ud_2                -1.434348e-02 1 1  ON 12
 ud_3                -7.183818e-02 1 1  ON 13
 ud_4                -1.189915e-01 1 1  ON 14
 ud_5                -1.520498e-01 1 1  ON 15
 ud_6                -1.545825e-01 1 1  ON 16
 ud_7                -1.110851e-01 1 1  ON 17
 ud_8                 3.325468e-03 1 1  ON 18
 ud_9                 9.230621e-02 1 1  ON 19
 eO_0                -7.468924e-01 1 1  ON 20
 eO_1                -4.354373e-01 1 1  ON 21
 eO_2                -4.151867e-02 1 1  ON 22
 eO_3                 2.024678e-01 1 1  ON 23
 eO_4                 2.906355e-01 1 1  ON 24
 eO_5                 3.095244e-01 1 1  ON 25
 eO_6                 2.512686e-01 1 1  ON 26
 eO_7                 1.128489e-01 1 1  ON 27
 eO_8                 2.789156e-02 1 1  ON 28
 eO_9                 1.845289e-02 1 1  ON 29
eH1_0                -1.806267e-01 1 1  ON 30
eH1_1                -1.021097e-01 1 1  ON 31
eH1_2                -6.242351e-02 1 1  ON 32
eH1_3                -2.667173e-02 1 1  ON 33
eH1_4                 1.834318e-02 1 1  ON 34
eH1_5                 3.450841e-02 1 1  ON 35
eH1_6                 7.828525e-02 1 1  ON 36
eH1_7                 1.097038e-01 1 1  ON 37
eH1_8                 9.101905e-02 1 1  ON 38
eH1_9                 2.450180e-02 1 1  ON 39
eH2_0                -1.824391e-01 1 1  ON 40
eH2_1                -1.035362e-01 1 1  ON 41
eH2_2                -6.360119e-02 1 1  ON 42
eH2_3                -2.748027e-02 1 1  ON 43
eH2_4                 1.828298e-02 1 1  ON 44
eH2_5                 3.423694e-02 1 1  ON 45
eH2_6                 7.819407e-02 1 1  ON 46
eH2_7                 1.134235e-01 1 1  ON 47
eH2_8                 9.427220e-02 1 1  ON 48
eH2_9                 2.644671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.149059
====================================================
  Execution time = 2.0604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321220377771
                                         uncertainty =       0.003491001773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321220377771
                                         uncertainty =       0.003491001773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400751766
  error estimate for blocks of size 2^( 2) =       0.000410486322
  error estimate for blocks of size 2^( 3) =       0.000418790935
  error estimate for blocks of size 2^( 4) =       0.000425051977
  error estimate for blocks of size 2^( 5) =       0.000428634232
  error estimate for blocks of size 2^( 6) =       0.000432170109
  error estimate for blocks of size 2^( 7) =       0.000434467810

      target function =                  N/A
              le_mean =     -17.216421206026
             les_mean =     296.726362938932
             stat err =       0.000430081032
             autocorr =       1.151727370278
              std dev =       0.566748582918
             le_variance =       0.321203956240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642120603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421206026       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421170589       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423018738       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216423215132       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216422809671       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216422832133       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216422706249       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216422717781       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 5.575449e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421206026       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421196065       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421721046       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216421717265       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216421627481       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216421648796       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216421611386       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216421608954       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.433751e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421206026       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421203456       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421338286       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216421331065       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216421311656       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216421319453       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216421309815       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.569305e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8251e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.075790e-01 1 1  ON 0
 uu_1                 4.673043e-02 1 1  ON 1
 uu_2                -4.601805e-02 1 1  ON 2
 uu_3                -9.913453e-02 1 1  ON 3
 uu_4                -1.310559e-01 1 1  ON 4
 uu_5                -1.365019e-01 1 1  ON 5
 uu_6                -1.139786e-01 1 1  ON 6
 uu_7                -4.095914e-02 1 1  ON 7
 uu_8                 9.892706e-02 1 1  ON 8
 uu_9                 1.209972e-01 1 1  ON 9
 ud_0                 3.446057e-01 1 1  ON 10
 ud_1                 8.963531e-02 1 1  ON 11
 ud_2                -1.432596e-02 1 1  ON 12
 ud_3                -7.183389e-02 1 1  ON 13
 ud_4                -1.190009e-01 1 1  ON 14
 ud_5                -1.520911e-01 1 1  ON 15
 ud_6                -1.546221e-01 1 1  ON 16
 ud_7                -1.110780e-01 1 1  ON 17
 ud_8                 3.297622e-03 1 1  ON 18
 ud_9                 9.230761e-02 1 1  ON 19
 eO_0                -7.470357e-01 1 1  ON 20
 eO_1                -4.355308e-01 1 1  ON 21
 eO_2                -4.157511e-02 1 1  ON 22
 eO_3                 2.025222e-01 1 1  ON 23
 eO_4                 2.907649e-01 1 1  ON 24
 eO_5                 3.095650e-01 1 1  ON 25
 eO_6                 2.512956e-01 1 1  ON 26
 eO_7                 1.128797e-01 1 1  ON 27
 eO_8                 2.789643e-02 1 1  ON 28
 eO_9                 1.845551e-02 1 1  ON 29
eH1_0                -1.806475e-01 1 1  ON 30
eH1_1                -1.021385e-01 1 1  ON 31
eH1_2                -6.244222e-02 1 1  ON 32
eH1_3                -2.665982e-02 1 1  ON 33
eH1_4                 1.836222e-02 1 1  ON 34
eH1_5                 3.451086e-02 1 1  ON 35
eH1_6                 7.829479e-02 1 1  ON 36
eH1_7                 1.096999e-01 1 1  ON 37
eH1_8                 9.103994e-02 1 1  ON 38
eH1_9                 2.450805e-02 1 1  ON 39
eH2_0                -1.824295e-01 1 1  ON 40
eH2_1                -1.035401e-01 1 1  ON 41
eH2_2                -6.361004e-02 1 1  ON 42
eH2_3                -2.746820e-02 1 1  ON 43
eH2_4                 1.824744e-02 1 1  ON 44
eH2_5                 3.423503e-02 1 1  ON 45
eH2_6                 7.820110e-02 1 1  ON 46
eH2_7                 1.134154e-01 1 1  ON 47
eH2_8                 9.429092e-02 1 1  ON 48
eH2_9                 2.645379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2913
    reference variance = 0.167443
====================================================
  Execution time = 2.0142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2361e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323605680901
                                         uncertainty =       0.006289212105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323605680901
                                         uncertainty =       0.006289212105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402228350
  error estimate for blocks of size 2^( 2) =       0.000412101289
  error estimate for blocks of size 2^( 3) =       0.000420597100
  error estimate for blocks of size 2^( 4) =       0.000427197870
  error estimate for blocks of size 2^( 5) =       0.000430877394
  error estimate for blocks of size 2^( 6) =       0.000432351523
  error estimate for blocks of size 2^( 7) =       0.000431168507

      target function =                  N/A
              le_mean =     -17.216624676069
             les_mean =     296.735740365593
             stat err =       0.000430398824
             autocorr =       1.144977089707
              std dev =       0.568836787455
             le_variance =       0.323575290762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323721088884
                                         uncertainty =       0.006289563488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323721088884
                                         uncertainty =       0.006289563488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300096
  error estimate for blocks of size 2^( 2) =       0.000412169282
  error estimate for blocks of size 2^( 3) =       0.000420660199
  error estimate for blocks of size 2^( 4) =       0.000427257384
  error estimate for blocks of size 2^( 5) =       0.000430936878
  error estimate for blocks of size 2^( 6) =       0.000432404903
  error estimate for blocks of size 2^( 7) =       0.000431221359

      target function =                  N/A
              le_mean =     -17.216624939678
             les_mean =     296.735864886898
             stat err =       0.000430455131
             autocorr =       1.144868232724
              std dev =       0.568938252538
             le_variance =       0.323690735201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323667821120
                                         uncertainty =       0.006289434713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323667821120
                                         uncertainty =       0.006289434713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402266982
  error estimate for blocks of size 2^( 2) =       0.000412137880
  error estimate for blocks of size 2^( 3) =       0.000420631043
  error estimate for blocks of size 2^( 4) =       0.000427229921
  error estimate for blocks of size 2^( 5) =       0.000430909555
  error estimate for blocks of size 2^( 6) =       0.000432380315
  error estimate for blocks of size 2^( 7) =       0.000431197070

      target function =                  N/A
              le_mean =     -17.216624782220
             les_mean =     296.735806179120
             stat err =       0.000430429215
             autocorr =       1.144918857876
              std dev =       0.568891421277
             le_variance =       0.323637449203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613532214
                                         uncertainty =       0.006289246654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323613532214
                                         uncertainty =       0.006289246654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402233231
  error estimate for blocks of size 2^( 2) =       0.000412105902
  error estimate for blocks of size 2^( 3) =       0.000420601374
  error estimate for blocks of size 2^( 4) =       0.000427201901
  error estimate for blocks of size 2^( 5) =       0.000430881453
  error estimate for blocks of size 2^( 6) =       0.000432355137
  error estimate for blocks of size 2^( 7) =       0.000431172115

      target function =                  N/A
              le_mean =     -17.216624686714
             les_mean =     296.735748585567
             stat err =       0.000430402651
             autocorr =       1.144969666283
              std dev =       0.568843690469
             le_variance =       0.323583144187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216624676069        initial
     9.7656e-01     9.7656e+00             5.5754e-04       -17.216624939678  <--
     3.9062e+00     3.9062e+01             1.4338e-04       -17.216624782220
     1.5625e+01     1.5625e+02             3.5693e-05       -17.216624686714

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.1717e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.077330e-01 1 1  ON 0
 uu_1                 4.674390e-02 1 1  ON 1
 uu_2                -4.600793e-02 1 1  ON 2
 uu_3                -9.919943e-02 1 1  ON 3
 uu_4                -1.311212e-01 1 1  ON 4
 uu_5                -1.366109e-01 1 1  ON 5
 uu_6                -1.139349e-01 1 1  ON 6
 uu_7                -4.099338e-02 1 1  ON 7
 uu_8                 9.886657e-02 1 1  ON 8
 uu_9                 1.210402e-01 1 1  ON 9
 ud_0                 3.447108e-01 1 1  ON 10
 ud_1                 8.971080e-02 1 1  ON 11
 ud_2                -1.427359e-02 1 1  ON 12
 ud_3                -7.182193e-02 1 1  ON 13
 ud_4                -1.190336e-01 1 1  ON 14
 ud_5                -1.522017e-01 1 1  ON 15
 ud_6                -1.547388e-01 1 1  ON 16
 ud_7                -1.110593e-01 1 1  ON 17
 ud_8                 3.215820e-03 1 1  ON 18
 ud_9                 9.231169e-02 1 1  ON 19
 eO_0                -7.474499e-01 1 1  ON 20
 eO_1                -4.358132e-01 1 1  ON 21
 eO_2                -4.173399e-02 1 1  ON 22
 eO_3                 2.026748e-01 1 1  ON 23
 eO_4                 2.911458e-01 1 1  ON 24
 eO_5                 3.096855e-01 1 1  ON 25
 eO_6                 2.513740e-01 1 1  ON 26
 eO_7                 1.129696e-01 1 1  ON 27
 eO_8                 2.791072e-02 1 1  ON 28
 eO_9                 1.846320e-02 1 1  ON 29
eH1_0                -1.807116e-01 1 1  ON 30
eH1_1                -1.022178e-01 1 1  ON 31
eH1_2                -6.248948e-02 1 1  ON 32
eH1_3                -2.663257e-02 1 1  ON 33
eH1_4                 1.841432e-02 1 1  ON 34
eH1_5                 3.451927e-02 1 1  ON 35
eH1_6                 7.832358e-02 1 1  ON 36
eH1_7                 1.096883e-01 1 1  ON 37
eH1_8                 9.110104e-02 1 1  ON 38
eH1_9                 2.452636e-02 1 1  ON 39
eH2_0                -1.824009e-01 1 1  ON 40
eH2_1                -1.035515e-01 1 1  ON 41
eH2_2                -6.363345e-02 1 1  ON 42
eH2_3                -2.744238e-02 1 1  ON 43
eH2_4                 1.815450e-02 1 1  ON 44
eH2_5                 3.422518e-02 1 1  ON 45
eH2_6                 7.822152e-02 1 1  ON 46
eH2_7                 1.133916e-01 1 1  ON 47
eH2_8                 9.434574e-02 1 1  ON 48
eH2_9                 2.647454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.262553
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2459e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324679849859
                                         uncertainty =       0.003965056862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324679849859
                                         uncertainty =       0.003965056862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402856238
  error estimate for blocks of size 2^( 2) =       0.000412354714
  error estimate for blocks of size 2^( 3) =       0.000420728994
  error estimate for blocks of size 2^( 4) =       0.000427341320
  error estimate for blocks of size 2^( 5) =       0.000431178594
  error estimate for blocks of size 2^( 6) =       0.000433016198
  error estimate for blocks of size 2^( 7) =       0.000435479420

      target function =                  N/A
              le_mean =     -17.216672489401
             les_mean =     296.738397741846
             stat err =       0.000431753883
             autocorr =       1.148609274828
              std dev =       0.569724755332
             le_variance =       0.324586296838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667248940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216672489401       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216673325146       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216674101982       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675958212       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216676620546       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216678220191       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216677704505       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216677991078       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216677888097       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216677896169       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.826720e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216672489401       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216672814732       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216673063758       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216673593471       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216673872235       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216674211320       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216674095553       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216674154406       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.818274e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216672489401       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216672583894       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216672651215       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216672787195       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216672867161       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216672940745       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216672921623       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216672937168       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.231211e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6203e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.078713e-01 1 1  ON 0
 uu_1                 4.680696e-02 1 1  ON 1
 uu_2                -4.598081e-02 1 1  ON 2
 uu_3                -9.927044e-02 1 1  ON 3
 uu_4                -1.312013e-01 1 1  ON 4
 uu_5                -1.367186e-01 1 1  ON 5
 uu_6                -1.139680e-01 1 1  ON 6
 uu_7                -4.104270e-02 1 1  ON 7
 uu_8                 9.883237e-02 1 1  ON 8
 uu_9                 1.211136e-01 1 1  ON 9
 ud_0                 3.447680e-01 1 1  ON 10
 ud_1                 8.980374e-02 1 1  ON 11
 ud_2                -1.416465e-02 1 1  ON 12
 ud_3                -7.172622e-02 1 1  ON 13
 ud_4                -1.190615e-01 1 1  ON 14
 ud_5                -1.522726e-01 1 1  ON 15
 ud_6                -1.549103e-01 1 1  ON 16
 ud_7                -1.110977e-01 1 1  ON 17
 ud_8                 3.117751e-03 1 1  ON 18
 ud_9                 9.231612e-02 1 1  ON 19
 eO_0                -7.479317e-01 1 1  ON 20
 eO_1                -4.361587e-01 1 1  ON 21
 eO_2                -4.196791e-02 1 1  ON 22
 eO_3                 2.029042e-01 1 1  ON 23
 eO_4                 2.915552e-01 1 1  ON 24
 eO_5                 3.098470e-01 1 1  ON 25
 eO_6                 2.514591e-01 1 1  ON 26
 eO_7                 1.131052e-01 1 1  ON 27
 eO_8                 2.793739e-02 1 1  ON 28
 eO_9                 1.847246e-02 1 1  ON 29
eH1_0                -1.807291e-01 1 1  ON 30
eH1_1                -1.022463e-01 1 1  ON 31
eH1_2                -6.254639e-02 1 1  ON 32
eH1_3                -2.662924e-02 1 1  ON 33
eH1_4                 1.848455e-02 1 1  ON 34
eH1_5                 3.453153e-02 1 1  ON 35
eH1_6                 7.828450e-02 1 1  ON 36
eH1_7                 1.096433e-01 1 1  ON 37
eH1_8                 9.116997e-02 1 1  ON 38
eH1_9                 2.455284e-02 1 1  ON 39
eH2_0                -1.824635e-01 1 1  ON 40
eH2_1                -1.036068e-01 1 1  ON 41
eH2_2                -6.360139e-02 1 1  ON 42
eH2_3                -2.743221e-02 1 1  ON 43
eH2_4                 1.811194e-02 1 1  ON 44
eH2_5                 3.419253e-02 1 1  ON 45
eH2_6                 7.826688e-02 1 1  ON 46
eH2_7                 1.133866e-01 1 1  ON 47
eH2_8                 9.441844e-02 1 1  ON 48
eH2_9                 2.650232e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.177838
====================================================
  Execution time = 1.9950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1584e-01
  Total weights = 2.0000e+06
  Execution time = 1.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315848689989
                                         uncertainty =       0.002792483756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315848689989
                                         uncertainty =       0.002792483756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397382037
  error estimate for blocks of size 2^( 2) =       0.000407228603
  error estimate for blocks of size 2^( 3) =       0.000415538727
  error estimate for blocks of size 2^( 4) =       0.000422540257
  error estimate for blocks of size 2^( 5) =       0.000427154043
  error estimate for blocks of size 2^( 6) =       0.000430657615
  error estimate for blocks of size 2^( 7) =       0.000431736177

      target function =                  N/A
              le_mean =     -17.216312925645
             les_mean =     296.717255562300
             stat err =       0.000428022023
             autocorr =       1.160154336397
              std dev =       0.561983065999
             le_variance =       0.315824966469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315956437499
                                         uncertainty =       0.002792936038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315956437499
                                         uncertainty =       0.002792936038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397449769
  error estimate for blocks of size 2^( 2) =       0.000407290222
  error estimate for blocks of size 2^( 3) =       0.000415592064
  error estimate for blocks of size 2^( 4) =       0.000422588785
  error estimate for blocks of size 2^( 5) =       0.000427202708
  error estimate for blocks of size 2^( 6) =       0.000430705783
  error estimate for blocks of size 2^( 7) =       0.000431798370

      target function =                  N/A
              le_mean =     -17.216313810321
             les_mean =     296.717393695683
             stat err =       0.000428073911
             autocorr =       1.160040157531
              std dev =       0.562078854063
             le_variance =       0.315932638184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315870323555
                                         uncertainty =       0.002792275975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315870323555
                                         uncertainty =       0.002792275975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397395620
  error estimate for blocks of size 2^( 2) =       0.000407239812
  error estimate for blocks of size 2^( 3) =       0.000415546619
  error estimate for blocks of size 2^( 4) =       0.000422546074
  error estimate for blocks of size 2^( 5) =       0.000427161180
  error estimate for blocks of size 2^( 6) =       0.000430664856
  error estimate for blocks of size 2^( 7) =       0.000431753526

      target function =                  N/A
              le_mean =     -17.216313498095
             les_mean =     296.717296864143
             stat err =       0.000428031409
             autocorr =       1.160125907978
              std dev =       0.562002275237
             le_variance =       0.315846557371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315847924627
                                         uncertainty =       0.002792422827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315847924627
                                         uncertainty =       0.002792422827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381552
  error estimate for blocks of size 2^( 2) =       0.000407227867
  error estimate for blocks of size 2^( 3) =       0.000415537654
  error estimate for blocks of size 2^( 4) =       0.000422538943
  error estimate for blocks of size 2^( 5) =       0.000427152963
  error estimate for blocks of size 2^( 6) =       0.000430656567
  error estimate for blocks of size 2^( 7) =       0.000431736609

      target function =                  N/A
              le_mean =     -17.216312964215
             les_mean =     296.717256119884
             stat err =       0.000428021270
             autocorr =       1.160153086376
              std dev =       0.561982380507
             le_variance =       0.315824196000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216312925645        initial
     2.4414e-01     2.4414e+00             1.8267e-03       -17.216313810321  <--
     9.7656e-01     9.7656e+00             4.8183e-04       -17.216313498095
     3.9062e+00     3.9062e+01             1.2312e-04       -17.216312964215

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9274e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.081789e-01 1 1  ON 0
 uu_1                 4.698345e-02 1 1  ON 1
 uu_2                -4.591139e-02 1 1  ON 2
 uu_3                -9.939554e-02 1 1  ON 3
 uu_4                -1.314016e-01 1 1  ON 4
 uu_5                -1.370170e-01 1 1  ON 5
 uu_6                -1.140822e-01 1 1  ON 6
 uu_7                -4.119157e-02 1 1  ON 7
 uu_8                 9.872870e-02 1 1  ON 8
 uu_9                 1.213313e-01 1 1  ON 9
 ud_0                 3.450223e-01 1 1  ON 10
 ud_1                 9.008086e-02 1 1  ON 11
 ud_2                -1.391182e-02 1 1  ON 12
 ud_3                -7.155269e-02 1 1  ON 13
 ud_4                -1.190873e-01 1 1  ON 14
 ud_5                -1.524832e-01 1 1  ON 15
 ud_6                -1.553615e-01 1 1  ON 16
 ud_7                -1.112229e-01 1 1  ON 17
 ud_8                 2.819777e-03 1 1  ON 18
 ud_9                 9.232792e-02 1 1  ON 19
 eO_0                -7.492766e-01 1 1  ON 20
 eO_1                -4.371642e-01 1 1  ON 21
 eO_2                -4.252314e-02 1 1  ON 22
 eO_3                 2.033461e-01 1 1  ON 23
 eO_4                 2.927251e-01 1 1  ON 24
 eO_5                 3.103613e-01 1 1  ON 25
 eO_6                 2.517168e-01 1 1  ON 26
 eO_7                 1.135080e-01 1 1  ON 27
 eO_8                 2.801640e-02 1 1  ON 28
 eO_9                 1.849998e-02 1 1  ON 29
eH1_0                -1.807852e-01 1 1  ON 30
eH1_1                -1.023428e-01 1 1  ON 31
eH1_2                -6.262881e-02 1 1  ON 32
eH1_3                -2.661477e-02 1 1  ON 33
eH1_4                 1.860331e-02 1 1  ON 34
eH1_5                 3.455918e-02 1 1  ON 35
eH1_6                 7.818864e-02 1 1  ON 36
eH1_7                 1.095129e-01 1 1  ON 37
eH1_8                 9.137473e-02 1 1  ON 38
eH1_9                 2.463155e-02 1 1  ON 39
eH2_0                -1.826077e-01 1 1  ON 40
eH2_1                -1.037241e-01 1 1  ON 41
eH2_2                -6.357469e-02 1 1  ON 42
eH2_3                -2.743114e-02 1 1  ON 43
eH2_4                 1.803222e-02 1 1  ON 44
eH2_5                 3.406105e-02 1 1  ON 45
eH2_6                 7.839663e-02 1 1  ON 46
eH2_7                 1.133732e-01 1 1  ON 47
eH2_8                 9.463475e-02 1 1  ON 48
eH2_9                 2.658493e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1424
    reference variance = 0.505697
====================================================
  Execution time = 2.0648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319926601999
                                         uncertainty =       0.004140116413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319926601999
                                         uncertainty =       0.004140116413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399883450
  error estimate for blocks of size 2^( 2) =       0.000409892339
  error estimate for blocks of size 2^( 3) =       0.000418899595
  error estimate for blocks of size 2^( 4) =       0.000425860629
  error estimate for blocks of size 2^( 5) =       0.000429566696
  error estimate for blocks of size 2^( 6) =       0.000432367493
  error estimate for blocks of size 2^( 7) =       0.000434060145

      target function =                  N/A
              le_mean =     -17.216557330957
             les_mean =     296.729659717711
             stat err =       0.000430463741
             autocorr =       1.158794139508
              std dev =       0.565520598648
             le_variance =       0.319813547496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655733096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557330957       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560099595       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562407605       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216565097517       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567660296       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216568782704       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216568389243       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216570330149       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216569681649       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216569486334       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216569003536       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216569364582       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216569670109       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216569923601       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 6.243689e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557330957       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216558860082       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560488972       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216561830762       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562375792       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562200559       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216561972541       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562420806       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562349990       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216562302557       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.882293e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557330957       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216557878875       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216558611253       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216559038032       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216559068384       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216558918532       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216558967740       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216558981430       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.809235e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6233e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.087559e-01 1 1  ON 0
 uu_1                 4.727908e-02 1 1  ON 1
 uu_2                -4.571792e-02 1 1  ON 2
 uu_3                -9.943780e-02 1 1  ON 3
 uu_4                -1.319476e-01 1 1  ON 4
 uu_5                -1.374212e-01 1 1  ON 5
 uu_6                -1.141923e-01 1 1  ON 6
 uu_7                -4.150046e-02 1 1  ON 7
 uu_8                 9.851671e-02 1 1  ON 8
 uu_9                 1.216084e-01 1 1  ON 9
 ud_0                 3.454433e-01 1 1  ON 10
 ud_1                 9.029692e-02 1 1  ON 11
 ud_2                -1.381470e-02 1 1  ON 12
 ud_3                -7.168513e-02 1 1  ON 13
 ud_4                -1.195127e-01 1 1  ON 14
 ud_5                -1.527556e-01 1 1  ON 15
 ud_6                -1.552911e-01 1 1  ON 16
 ud_7                -1.110423e-01 1 1  ON 17
 ud_8                 2.500233e-03 1 1  ON 18
 ud_9                 9.235054e-02 1 1  ON 19
 eO_0                -7.511589e-01 1 1  ON 20
 eO_1                -4.387719e-01 1 1  ON 21
 eO_2                -4.312387e-02 1 1  ON 22
 eO_3                 2.040296e-01 1 1  ON 23
 eO_4                 2.942534e-01 1 1  ON 24
 eO_5                 3.111048e-01 1 1  ON 25
 eO_6                 2.521791e-01 1 1  ON 26
 eO_7                 1.140315e-01 1 1  ON 27
 eO_8                 2.813156e-02 1 1  ON 28
 eO_9                 1.852604e-02 1 1  ON 29
eH1_0                -1.809258e-01 1 1  ON 30
eH1_1                -1.027471e-01 1 1  ON 31
eH1_2                -6.265994e-02 1 1  ON 32
eH1_3                -2.666169e-02 1 1  ON 33
eH1_4                 1.875652e-02 1 1  ON 34
eH1_5                 3.467655e-02 1 1  ON 35
eH1_6                 7.824916e-02 1 1  ON 36
eH1_7                 1.094483e-01 1 1  ON 37
eH1_8                 9.163964e-02 1 1  ON 38
eH1_9                 2.471040e-02 1 1  ON 39
eH2_0                -1.828471e-01 1 1  ON 40
eH2_1                -1.040168e-01 1 1  ON 41
eH2_2                -6.370036e-02 1 1  ON 42
eH2_3                -2.735152e-02 1 1  ON 43
eH2_4                 1.794201e-02 1 1  ON 44
eH2_5                 3.414072e-02 1 1  ON 45
eH2_6                 7.851496e-02 1 1  ON 46
eH2_7                 1.133512e-01 1 1  ON 47
eH2_8                 9.498193e-02 1 1  ON 48
eH2_9                 2.669506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.225019
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2471e-01
  Total weights = 2.0000e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324398557993
                                         uncertainty =       0.004104769186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324398557993
                                         uncertainty =       0.004104769186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402711484
  error estimate for blocks of size 2^( 2) =       0.000412416479
  error estimate for blocks of size 2^( 3) =       0.000420410355
  error estimate for blocks of size 2^( 4) =       0.000427729278
  error estimate for blocks of size 2^( 5) =       0.000431731688
  error estimate for blocks of size 2^( 6) =       0.000433628079
  error estimate for blocks of size 2^( 7) =       0.000434727656

      target function =                  N/A
              le_mean =     -17.215846427701
             les_mean =     296.709721138990
             stat err =       0.000431954175
             autocorr =       1.150501855265
              std dev =       0.569520042664
             le_variance =       0.324353078996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325235366681
                                         uncertainty =       0.004113820387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325235366681
                                         uncertainty =       0.004113820387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403230406
  error estimate for blocks of size 2^( 2) =       0.000412907166
  error estimate for blocks of size 2^( 3) =       0.000420857273
  error estimate for blocks of size 2^( 4) =       0.000428151353
  error estimate for blocks of size 2^( 5) =       0.000432140075
  error estimate for blocks of size 2^( 6) =       0.000434014153
  error estimate for blocks of size 2^( 7) =       0.000435116608

      target function =                  N/A
              le_mean =     -17.215849158138
             les_mean =     296.710651593017
             stat err =       0.000432355547
             autocorr =       1.149676159956
              std dev =       0.570253908239
             le_variance =       0.325189519862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325118704031
                                         uncertainty =       0.004110112734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325118704031
                                         uncertainty =       0.004110112734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403158148
  error estimate for blocks of size 2^( 2) =       0.000412840654
  error estimate for blocks of size 2^( 3) =       0.000420800498
  error estimate for blocks of size 2^( 4) =       0.000428100322
  error estimate for blocks of size 2^( 5) =       0.000432089847
  error estimate for blocks of size 2^( 6) =       0.000433972248
  error estimate for blocks of size 2^( 7) =       0.000435075944

      target function =                  N/A
              le_mean =     -17.215846936648
             les_mean =     296.710458567376
             stat err =       0.000432309590
             autocorr =       1.149843827436
              std dev =       0.570151719998
             le_variance =       0.325072983817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324505035982
                                         uncertainty =       0.004105243848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324505035982
                                         uncertainty =       0.004105243848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777558
  error estimate for blocks of size 2^( 2) =       0.000412479181
  error estimate for blocks of size 2^( 3) =       0.000420468090
  error estimate for blocks of size 2^( 4) =       0.000427784142
  error estimate for blocks of size 2^( 5) =       0.000431784191
  error estimate for blocks of size 2^( 6) =       0.000433678513
  error estimate for blocks of size 2^( 7) =       0.000434779070

      target function =                  N/A
              le_mean =     -17.215845991880
             les_mean =     296.709812576502
             stat err =       0.000432006479
             autocorr =       1.150402961377
              std dev =       0.569613485283
             le_variance =       0.324459522616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215846427701        initial
     6.1035e-02     6.1035e-01             6.2437e-03       -17.215849158138  <--
     2.4414e-01     2.4414e+00             1.8823e-03       -17.215846936648
     9.7656e-01     9.7656e+00             4.8092e-04       -17.215845991880

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 2.9461e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.096890e-01 1 1  ON 0
 uu_1                 4.795995e-02 1 1  ON 1
 uu_2                -4.527385e-02 1 1  ON 2
 uu_3                -9.942730e-02 1 1  ON 3
 uu_4                -1.325356e-01 1 1  ON 4
 uu_5                -1.383835e-01 1 1  ON 5
 uu_6                -1.148470e-01 1 1  ON 6
 uu_7                -4.244514e-02 1 1  ON 7
 uu_8                 9.786400e-02 1 1  ON 8
 uu_9                 1.224664e-01 1 1  ON 9
 ud_0                 3.461721e-01 1 1  ON 10
 ud_1                 9.088261e-02 1 1  ON 11
 ud_2                -1.347721e-02 1 1  ON 12
 ud_3                -7.173864e-02 1 1  ON 13
 ud_4                -1.200360e-01 1 1  ON 14
 ud_5                -1.534367e-01 1 1  ON 15
 ud_6                -1.556148e-01 1 1  ON 16
 ud_7                -1.106839e-01 1 1  ON 17
 ud_8                 1.552210e-03 1 1  ON 18
 ud_9                 9.242776e-02 1 1  ON 19
 eO_0                -7.555203e-01 1 1  ON 20
 eO_1                -4.423954e-01 1 1  ON 21
 eO_2                -4.512142e-02 1 1  ON 22
 eO_3                 2.044627e-01 1 1  ON 23
 eO_4                 2.974614e-01 1 1  ON 24
 eO_5                 3.137702e-01 1 1  ON 25
 eO_6                 2.537481e-01 1 1  ON 26
 eO_7                 1.156692e-01 1 1  ON 27
 eO_8                 2.849317e-02 1 1  ON 28
 eO_9                 1.860759e-02 1 1  ON 29
eH1_0                -1.813464e-01 1 1  ON 30
eH1_1                -1.033124e-01 1 1  ON 31
eH1_2                -6.285480e-02 1 1  ON 32
eH1_3                -2.677980e-02 1 1  ON 33
eH1_4                 1.896092e-02 1 1  ON 34
eH1_5                 3.459332e-02 1 1  ON 35
eH1_6                 7.843567e-02 1 1  ON 36
eH1_7                 1.093200e-01 1 1  ON 37
eH1_8                 9.247356e-02 1 1  ON 38
eH1_9                 2.495671e-02 1 1  ON 39
eH2_0                -1.833737e-01 1 1  ON 40
eH2_1                -1.045304e-01 1 1  ON 41
eH2_2                -6.400313e-02 1 1  ON 42
eH2_3                -2.746731e-02 1 1  ON 43
eH2_4                 1.785598e-02 1 1  ON 44
eH2_5                 3.385740e-02 1 1  ON 45
eH2_6                 7.880355e-02 1 1  ON 46
eH2_7                 1.133465e-01 1 1  ON 47
eH2_8                 9.607164e-02 1 1  ON 48
eH2_9                 2.703953e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2108
    reference variance = 0.203995
====================================================
  Execution time = 2.0348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318827006804
                                         uncertainty =       0.003055171778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318827006804
                                         uncertainty =       0.003055171778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399229364
  error estimate for blocks of size 2^( 2) =       0.000408870488
  error estimate for blocks of size 2^( 3) =       0.000417740218
  error estimate for blocks of size 2^( 4) =       0.000423354784
  error estimate for blocks of size 2^( 5) =       0.000428231791
  error estimate for blocks of size 2^( 6) =       0.000431207061
  error estimate for blocks of size 2^( 7) =       0.000433769794

      target function =                  N/A
              le_mean =     -17.216588492296
             les_mean =     296.729687323663
             stat err =       0.000429140857
             autocorr =       1.155459627648
              std dev =       0.564595580900
             le_variance =       0.318768169972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658849230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216588492296       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591117470       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594090558       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216597652336       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603797284       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216618812781       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216618708216       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216623915751       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216624970918       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216632534056       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216628681012       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216628638980       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216629593040       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216632005988       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216629201737       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216630294398       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216629582528       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 1.324467e-02

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216588492296       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590720563       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216593138736       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216595670486       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216599309844       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216606989393       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605278473       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216606421943       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216606296040       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216607662973       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216606451834       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216605858700       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216606776518       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216606440637       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.322807e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216588492296       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216589880823       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591388570       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592633906       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216593758610       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216595673698       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594678866       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216594836427       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216594730786       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216594933339       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.179879e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5950e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.105194e-01 1 1  ON 0
 uu_1                 4.870508e-02 1 1  ON 1
 uu_2                -4.473434e-02 1 1  ON 2
 uu_3                -9.905978e-02 1 1  ON 3
 uu_4                -1.323421e-01 1 1  ON 4
 uu_5                -1.390853e-01 1 1  ON 5
 uu_6                -1.158402e-01 1 1  ON 6
 uu_7                -4.430336e-02 1 1  ON 7
 uu_8                 9.629539e-02 1 1  ON 8
 uu_9                 1.232211e-01 1 1  ON 9
 ud_0                 3.471970e-01 1 1  ON 10
 ud_1                 9.179575e-02 1 1  ON 11
 ud_2                -1.275017e-02 1 1  ON 12
 ud_3                -7.092386e-02 1 1  ON 13
 ud_4                -1.197755e-01 1 1  ON 14
 ud_5                -1.535571e-01 1 1  ON 15
 ud_6                -1.563333e-01 1 1  ON 16
 ud_7                -1.117275e-01 1 1  ON 17
 ud_8                -1.178974e-03 1 1  ON 18
 ud_9                 9.206204e-02 1 1  ON 19
 eO_0                -7.598431e-01 1 1  ON 20
 eO_1                -4.462160e-01 1 1  ON 21
 eO_2                -4.772388e-02 1 1  ON 22
 eO_3                 2.038474e-01 1 1  ON 23
 eO_4                 3.008482e-01 1 1  ON 24
 eO_5                 3.170592e-01 1 1  ON 25
 eO_6                 2.560183e-01 1 1  ON 26
 eO_7                 1.176037e-01 1 1  ON 27
 eO_8                 2.868478e-02 1 1  ON 28
 eO_9                 1.874954e-02 1 1  ON 29
eH1_0                -1.813302e-01 1 1  ON 30
eH1_1                -1.031400e-01 1 1  ON 31
eH1_2                -6.271220e-02 1 1  ON 32
eH1_3                -2.673902e-02 1 1  ON 33
eH1_4                 1.871496e-02 1 1  ON 34
eH1_5                 3.305078e-02 1 1  ON 35
eH1_6                 7.825821e-02 1 1  ON 36
eH1_7                 1.091776e-01 1 1  ON 37
eH1_8                 9.359394e-02 1 1  ON 38
eH1_9                 2.534113e-02 1 1  ON 39
eH2_0                -1.829305e-01 1 1  ON 40
eH2_1                -1.042423e-01 1 1  ON 41
eH2_2                -6.375469e-02 1 1  ON 42
eH2_3                -2.767683e-02 1 1  ON 43
eH2_4                 1.727111e-02 1 1  ON 44
eH2_5                 3.288938e-02 1 1  ON 45
eH2_6                 7.803431e-02 1 1  ON 46
eH2_7                 1.133539e-01 1 1  ON 47
eH2_8                 9.716350e-02 1 1  ON 48
eH2_9                 2.737851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.148
    reference variance = 0.179898
====================================================
  Execution time = 1.9637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2860e-01
  Total weights = 2.0000e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328356525372
                                         uncertainty =       0.008127454447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328356525372
                                         uncertainty =       0.008127454447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405145204
  error estimate for blocks of size 2^( 2) =       0.000415052004
  error estimate for blocks of size 2^( 3) =       0.000424273231
  error estimate for blocks of size 2^( 4) =       0.000430390190
  error estimate for blocks of size 2^( 5) =       0.000434520514
  error estimate for blocks of size 2^( 6) =       0.000435730632
  error estimate for blocks of size 2^( 7) =       0.000438025324

      target function =                  N/A
              le_mean =     -17.215944288700
             les_mean =     296.717022860147
             stat err =       0.000434666665
             autocorr =       1.151042252496
              std dev =       0.572961842237
             le_variance =       0.328285272659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329128072795
                                         uncertainty =       0.008131467686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329128072795
                                         uncertainty =       0.008131467686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405620913
  error estimate for blocks of size 2^( 2) =       0.000415498478
  error estimate for blocks of size 2^( 3) =       0.000424668828
  error estimate for blocks of size 2^( 4) =       0.000430758494
  error estimate for blocks of size 2^( 5) =       0.000434861712
  error estimate for blocks of size 2^( 6) =       0.000436050789
  error estimate for blocks of size 2^( 7) =       0.000438277997

      target function =                  N/A
              le_mean =     -17.215941579266
             les_mean =     296.717700946593
             stat err =       0.000434987248
             autocorr =       1.150038486318
              std dev =       0.573634596606
             le_variance =       0.329056650423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329000834839
                                         uncertainty =       0.008132856153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329000834839
                                         uncertainty =       0.008132856153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405542511
  error estimate for blocks of size 2^( 2) =       0.000415426828
  error estimate for blocks of size 2^( 3) =       0.000424609472
  error estimate for blocks of size 2^( 4) =       0.000430706852
  error estimate for blocks of size 2^( 5) =       0.000434818888
  error estimate for blocks of size 2^( 6) =       0.000436016323
  error estimate for blocks of size 2^( 7) =       0.000438251354

      target function =                  N/A
              le_mean =     -17.215940388705
             les_mean =     296.717532758998
             stat err =       0.000434948354
             autocorr =       1.150277466978
              std dev =       0.573523718792
             le_variance =       0.328929456017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328477464301
                                         uncertainty =       0.008129816344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328477464301
                                         uncertainty =       0.008129816344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405219820
  error estimate for blocks of size 2^( 2) =       0.000415121413
  error estimate for blocks of size 2^( 3) =       0.000424334868
  error estimate for blocks of size 2^( 4) =       0.000430448467
  error estimate for blocks of size 2^( 5) =       0.000434574987
  error estimate for blocks of size 2^( 6) =       0.000435784633
  error estimate for blocks of size 2^( 7) =       0.000438066680

      target function =                  N/A
              le_mean =     -17.215941880566
             les_mean =     296.717060875345
             stat err =       0.000434718692
             autocorr =       1.150893853183
              std dev =       0.573067364729
             le_variance =       0.328406204517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215944288700        initial  <--
     1.5259e-02     1.5259e-01             1.3245e-02       -17.215941579266
     6.1035e-02     6.1035e-01             4.3228e-03       -17.215940388705
     2.4414e-01     2.4414e+00             1.1799e-03       -17.215941880566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9417
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.096890e-01 1 1  ON 0
 uu_1                 4.795995e-02 1 1  ON 1
 uu_2                -4.527385e-02 1 1  ON 2
 uu_3                -9.942730e-02 1 1  ON 3
 uu_4                -1.325356e-01 1 1  ON 4
 uu_5                -1.383835e-01 1 1  ON 5
 uu_6                -1.148470e-01 1 1  ON 6
 uu_7                -4.244514e-02 1 1  ON 7
 uu_8                 9.786400e-02 1 1  ON 8
 uu_9                 1.224664e-01 1 1  ON 9
 ud_0                 3.461721e-01 1 1  ON 10
 ud_1                 9.088261e-02 1 1  ON 11
 ud_2                -1.347721e-02 1 1  ON 12
 ud_3                -7.173864e-02 1 1  ON 13
 ud_4                -1.200360e-01 1 1  ON 14
 ud_5                -1.534367e-01 1 1  ON 15
 ud_6                -1.556148e-01 1 1  ON 16
 ud_7                -1.106839e-01 1 1  ON 17
 ud_8                 1.552210e-03 1 1  ON 18
 ud_9                 9.242776e-02 1 1  ON 19
 eO_0                -7.555203e-01 1 1  ON 20
 eO_1                -4.423954e-01 1 1  ON 21
 eO_2                -4.512142e-02 1 1  ON 22
 eO_3                 2.044627e-01 1 1  ON 23
 eO_4                 2.974614e-01 1 1  ON 24
 eO_5                 3.137702e-01 1 1  ON 25
 eO_6                 2.537481e-01 1 1  ON 26
 eO_7                 1.156692e-01 1 1  ON 27
 eO_8                 2.849317e-02 1 1  ON 28
 eO_9                 1.860759e-02 1 1  ON 29
eH1_0                -1.813464e-01 1 1  ON 30
eH1_1                -1.033124e-01 1 1  ON 31
eH1_2                -6.285480e-02 1 1  ON 32
eH1_3                -2.677980e-02 1 1  ON 33
eH1_4                 1.896092e-02 1 1  ON 34
eH1_5                 3.459332e-02 1 1  ON 35
eH1_6                 7.843567e-02 1 1  ON 36
eH1_7                 1.093200e-01 1 1  ON 37
eH1_8                 9.247356e-02 1 1  ON 38
eH1_9                 2.495671e-02 1 1  ON 39
eH2_0                -1.833737e-01 1 1  ON 40
eH2_1                -1.045304e-01 1 1  ON 41
eH2_2                -6.400313e-02 1 1  ON 42
eH2_3                -2.746731e-02 1 1  ON 43
eH2_4                 1.785598e-02 1 1  ON 44
eH2_5                 3.385740e-02 1 1  ON 45
eH2_6                 7.880355e-02 1 1  ON 46
eH2_7                 1.133465e-01 1 1  ON 47
eH2_8                 9.607164e-02 1 1  ON 48
eH2_9                 2.703953e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.269437
====================================================
  Execution time = 2.0939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322710421039
                                         uncertainty =       0.004655992539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322710421039
                                         uncertainty =       0.004655992539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401767888
  error estimate for blocks of size 2^( 2) =       0.000411229294
  error estimate for blocks of size 2^( 3) =       0.000419411569
  error estimate for blocks of size 2^( 4) =       0.000425793802
  error estimate for blocks of size 2^( 5) =       0.000428628702
  error estimate for blocks of size 2^( 6) =       0.000431179578
  error estimate for blocks of size 2^( 7) =       0.000431785259

      target function =                  N/A
              le_mean =     -17.217071579998
             les_mean =     296.750388500726
             stat err =       0.000429346835
             autocorr =       1.141999958932
              std dev =       0.568185595884
             le_variance =       0.322834871370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707158000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071579998       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217072019511       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217072948244       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217074257004       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217074832140       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217074722619       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217075902566       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217075731412       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217075912544       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217075829945       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.139393e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071579998       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071758787       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217072246009       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217072725134       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217073087401       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217073065599       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217073301435       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217073156486       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 6.240658e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071579998       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071633006       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217071799099       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217071931126       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217072071642       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217072085247       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217072111473       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.682378e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6586e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.097967e-01 1 1  ON 0
 uu_1                 4.809534e-02 1 1  ON 1
 uu_2                -4.517518e-02 1 1  ON 2
 uu_3                -9.942825e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385076e-01 1 1  ON 5
 uu_6                -1.150378e-01 1 1  ON 6
 uu_7                -4.256708e-02 1 1  ON 7
 uu_8                 9.777842e-02 1 1  ON 8
 uu_9                 1.225461e-01 1 1  ON 9
 ud_0                 3.463219e-01 1 1  ON 10
 ud_1                 9.088902e-02 1 1  ON 11
 ud_2                -1.344427e-02 1 1  ON 12
 ud_3                -7.172803e-02 1 1  ON 13
 ud_4                -1.199530e-01 1 1  ON 14
 ud_5                -1.535055e-01 1 1  ON 15
 ud_6                -1.556949e-01 1 1  ON 16
 ud_7                -1.107664e-01 1 1  ON 17
 ud_8                 1.415348e-03 1 1  ON 18
 ud_9                 9.244323e-02 1 1  ON 19
 eO_0                -7.561444e-01 1 1  ON 20
 eO_1                -4.427267e-01 1 1  ON 21
 eO_2                -4.536688e-02 1 1  ON 22
 eO_3                 2.044040e-01 1 1  ON 23
 eO_4                 2.978961e-01 1 1  ON 24
 eO_5                 3.141516e-01 1 1  ON 25
 eO_6                 2.539358e-01 1 1  ON 26
 eO_7                 1.158712e-01 1 1  ON 27
 eO_8                 2.853190e-02 1 1  ON 28
 eO_9                 1.861769e-02 1 1  ON 29
eH1_0                -1.815276e-01 1 1  ON 30
eH1_1                -1.033489e-01 1 1  ON 31
eH1_2                -6.278181e-02 1 1  ON 32
eH1_3                -2.665940e-02 1 1  ON 33
eH1_4                 1.895520e-02 1 1  ON 34
eH1_5                 3.447326e-02 1 1  ON 35
eH1_6                 7.839389e-02 1 1  ON 36
eH1_7                 1.093389e-01 1 1  ON 37
eH1_8                 9.260739e-02 1 1  ON 38
eH1_9                 2.499191e-02 1 1  ON 39
eH2_0                -1.833830e-01 1 1  ON 40
eH2_1                -1.046298e-01 1 1  ON 41
eH2_2                -6.407516e-02 1 1  ON 42
eH2_3                -2.757946e-02 1 1  ON 43
eH2_4                 1.792881e-02 1 1  ON 44
eH2_5                 3.387542e-02 1 1  ON 45
eH2_6                 7.883642e-02 1 1  ON 46
eH2_7                 1.133592e-01 1 1  ON 47
eH2_8                 9.618421e-02 1 1  ON 48
eH2_9                 2.707205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0474
    reference variance = 1.84113
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1881e-01
  Total weights = 2.0000e+06
  Execution time = 1.8479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318596359845
                                         uncertainty =       0.003917029030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318596359845
                                         uncertainty =       0.003917029030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399180805
  error estimate for blocks of size 2^( 2) =       0.000408941871
  error estimate for blocks of size 2^( 3) =       0.000417584110
  error estimate for blocks of size 2^( 4) =       0.000423468411
  error estimate for blocks of size 2^( 5) =       0.000426593338
  error estimate for blocks of size 2^( 6) =       0.000430176565
  error estimate for blocks of size 2^( 7) =       0.000432624427

      target function =                  N/A
              le_mean =     -17.216068401682
             les_mean =     296.711701681582
             stat err =       0.000428215686
             autocorr =       1.150762880171
              std dev =       0.564526907714
             le_variance =       0.318690629533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318862594093
                                         uncertainty =       0.003920441591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318862594093
                                         uncertainty =       0.003920441591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399347576
  error estimate for blocks of size 2^( 2) =       0.000409097840
  error estimate for blocks of size 2^( 3) =       0.000417730301
  error estimate for blocks of size 2^( 4) =       0.000423608809
  error estimate for blocks of size 2^( 5) =       0.000426731162
  error estimate for blocks of size 2^( 6) =       0.000430313991
  error estimate for blocks of size 2^( 7) =       0.000432764063

      target function =                  N/A
              le_mean =     -17.216068904775
             les_mean =     296.711985347188
             stat err =       0.000428354506
             autocorr =       1.150547558967
              std dev =       0.564762757909
             le_variance =       0.318956972721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318827760442
                                         uncertainty =       0.003918864458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318827760442
                                         uncertainty =       0.003918864458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399325778
  error estimate for blocks of size 2^( 2) =       0.000409078254
  error estimate for blocks of size 2^( 3) =       0.000417713729
  error estimate for blocks of size 2^( 4) =       0.000423594817
  error estimate for blocks of size 2^( 5) =       0.000426719065
  error estimate for blocks of size 2^( 6) =       0.000430305557
  error estimate for blocks of size 2^( 7) =       0.000432752209

      target function =                  N/A
              le_mean =     -17.216069016498
             les_mean =     296.711954374678
             stat err =       0.000428342912
             autocorr =       1.150610882441
              std dev =       0.564731930498
             le_variance =       0.318922153324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318636112361
                                         uncertainty =       0.003917338659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318636112361
                                         uncertainty =       0.003917338659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399205719
  error estimate for blocks of size 2^( 2) =       0.000408965379
  error estimate for blocks of size 2^( 3) =       0.000417606599
  error estimate for blocks of size 2^( 4) =       0.000423490546
  error estimate for blocks of size 2^( 5) =       0.000426615471
  error estimate for blocks of size 2^( 6) =       0.000430199636
  error estimate for blocks of size 2^( 7) =       0.000432647084

      target function =                  N/A
              le_mean =     -17.216068453909
             les_mean =     296.711743262268
             stat err =       0.000428238184
             autocorr =       1.150740158349
              std dev =       0.564562141806
             le_variance =       0.318730411961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216068401682        initial
     1.5259e-01     1.5259e+00             2.1394e-03       -17.216068904775
     6.1035e-01     6.1035e+00             6.2407e-04       -17.216069016498  <--
     2.4414e+00     2.4414e+01             1.6824e-04       -17.216068453909

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9277e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.097967e-01 1 1  ON 0
 uu_1                 4.809534e-02 1 1  ON 1
 uu_2                -4.517518e-02 1 1  ON 2
 uu_3                -9.942825e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385076e-01 1 1  ON 5
 uu_6                -1.150378e-01 1 1  ON 6
 uu_7                -4.256708e-02 1 1  ON 7
 uu_8                 9.777842e-02 1 1  ON 8
 uu_9                 1.225461e-01 1 1  ON 9
 ud_0                 3.463219e-01 1 1  ON 10
 ud_1                 9.088902e-02 1 1  ON 11
 ud_2                -1.344427e-02 1 1  ON 12
 ud_3                -7.172803e-02 1 1  ON 13
 ud_4                -1.199530e-01 1 1  ON 14
 ud_5                -1.535055e-01 1 1  ON 15
 ud_6                -1.556949e-01 1 1  ON 16
 ud_7                -1.107664e-01 1 1  ON 17
 ud_8                 1.415348e-03 1 1  ON 18
 ud_9                 9.244323e-02 1 1  ON 19
 eO_0                -7.561444e-01 1 1  ON 20
 eO_1                -4.427267e-01 1 1  ON 21
 eO_2                -4.536688e-02 1 1  ON 22
 eO_3                 2.044040e-01 1 1  ON 23
 eO_4                 2.978961e-01 1 1  ON 24
 eO_5                 3.141516e-01 1 1  ON 25
 eO_6                 2.539358e-01 1 1  ON 26
 eO_7                 1.158712e-01 1 1  ON 27
 eO_8                 2.853190e-02 1 1  ON 28
 eO_9                 1.861769e-02 1 1  ON 29
eH1_0                -1.815276e-01 1 1  ON 30
eH1_1                -1.033489e-01 1 1  ON 31
eH1_2                -6.278181e-02 1 1  ON 32
eH1_3                -2.665940e-02 1 1  ON 33
eH1_4                 1.895520e-02 1 1  ON 34
eH1_5                 3.447326e-02 1 1  ON 35
eH1_6                 7.839389e-02 1 1  ON 36
eH1_7                 1.093389e-01 1 1  ON 37
eH1_8                 9.260739e-02 1 1  ON 38
eH1_9                 2.499191e-02 1 1  ON 39
eH2_0                -1.833830e-01 1 1  ON 40
eH2_1                -1.046298e-01 1 1  ON 41
eH2_2                -6.407516e-02 1 1  ON 42
eH2_3                -2.757946e-02 1 1  ON 43
eH2_4                 1.792881e-02 1 1  ON 44
eH2_5                 3.387542e-02 1 1  ON 45
eH2_6                 7.883642e-02 1 1  ON 46
eH2_7                 1.133592e-01 1 1  ON 47
eH2_8                 9.618421e-02 1 1  ON 48
eH2_9                 2.707205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3549
    reference variance = 0.583255
====================================================
  Execution time = 2.0372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335331665715
                                         uncertainty =       0.017610923266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335331665715
                                         uncertainty =       0.017610923266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409477949
  error estimate for blocks of size 2^( 2) =       0.000418847635
  error estimate for blocks of size 2^( 3) =       0.000427149214
  error estimate for blocks of size 2^( 4) =       0.000433495609
  error estimate for blocks of size 2^( 5) =       0.000436303217
  error estimate for blocks of size 2^( 6) =       0.000440053840
  error estimate for blocks of size 2^( 7) =       0.000441655692

      target function =                  N/A
              le_mean =     -17.216592863641
             les_mean =     296.746414046897
             stat err =       0.000437877090
             autocorr =       1.143519055886
              std dev =       0.579089269630
             le_variance =       0.335344382201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659286364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592863641       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592811789       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216593414907       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216593301953       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216593796821       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216593831220       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216595909070       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216596542530       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216596470154       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216596360994       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216596399002       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.959685e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592863641       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592841652       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216593182070       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216593098967       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592929002       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216593086906       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216593571133       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216593529251       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 5.628064e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592863641       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592856985       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216592980147       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592950237       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592853538       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216592924644       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216592982240       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216592999793       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.442636e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6059e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.099653e-01 1 1  ON 0
 uu_1                 4.822416e-02 1 1  ON 1
 uu_2                -4.516148e-02 1 1  ON 2
 uu_3                -9.933934e-02 1 1  ON 3
 uu_4                -1.325087e-01 1 1  ON 4
 uu_5                -1.386868e-01 1 1  ON 5
 uu_6                -1.152017e-01 1 1  ON 6
 uu_7                -4.275177e-02 1 1  ON 7
 uu_8                 9.767856e-02 1 1  ON 8
 uu_9                 1.226490e-01 1 1  ON 9
 ud_0                 3.463687e-01 1 1  ON 10
 ud_1                 9.096672e-02 1 1  ON 11
 ud_2                -1.344258e-02 1 1  ON 12
 ud_3                -7.169155e-02 1 1  ON 13
 ud_4                -1.199619e-01 1 1  ON 14
 ud_5                -1.534917e-01 1 1  ON 15
 ud_6                -1.558845e-01 1 1  ON 16
 ud_7                -1.107266e-01 1 1  ON 17
 ud_8                 1.321823e-03 1 1  ON 18
 ud_9                 9.246607e-02 1 1  ON 19
 eO_0                -7.566356e-01 1 1  ON 20
 eO_1                -4.432248e-01 1 1  ON 21
 eO_2                -4.558953e-02 1 1  ON 22
 eO_3                 2.042322e-01 1 1  ON 23
 eO_4                 2.984589e-01 1 1  ON 24
 eO_5                 3.145073e-01 1 1  ON 25
 eO_6                 2.541277e-01 1 1  ON 26
 eO_7                 1.160893e-01 1 1  ON 27
 eO_8                 2.856914e-02 1 1  ON 28
 eO_9                 1.863098e-02 1 1  ON 29
eH1_0                -1.815206e-01 1 1  ON 30
eH1_1                -1.032434e-01 1 1  ON 31
eH1_2                -6.283066e-02 1 1  ON 32
eH1_3                -2.667059e-02 1 1  ON 33
eH1_4                 1.885704e-02 1 1  ON 34
eH1_5                 3.426853e-02 1 1  ON 35
eH1_6                 7.842273e-02 1 1  ON 36
eH1_7                 1.093668e-01 1 1  ON 37
eH1_8                 9.274818e-02 1 1  ON 38
eH1_9                 2.503738e-02 1 1  ON 39
eH2_0                -1.834236e-01 1 1  ON 40
eH2_1                -1.047528e-01 1 1  ON 41
eH2_2                -6.396839e-02 1 1  ON 42
eH2_3                -2.761595e-02 1 1  ON 43
eH2_4                 1.793300e-02 1 1  ON 44
eH2_5                 3.379834e-02 1 1  ON 45
eH2_6                 7.884271e-02 1 1  ON 46
eH2_7                 1.133428e-01 1 1  ON 47
eH2_8                 9.630551e-02 1 1  ON 48
eH2_9                 2.711012e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.161914
====================================================
  Execution time = 2.1760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2798e-01
  Total weights = 2.0000e+06
  Execution time = 1.8456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327767866395
                                         uncertainty =       0.004848073089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327767866395
                                         uncertainty =       0.004848073089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404929033
  error estimate for blocks of size 2^( 2) =       0.000414540233
  error estimate for blocks of size 2^( 3) =       0.000423545562
  error estimate for blocks of size 2^( 4) =       0.000428768530
  error estimate for blocks of size 2^( 5) =       0.000433197896
  error estimate for blocks of size 2^( 6) =       0.000436042198
  error estimate for blocks of size 2^( 7) =       0.000437392223

      target function =                  N/A
              le_mean =     -17.216212021102
             les_mean =     296.725891234513
             stat err =       0.000433850212
             autocorr =       1.147946888827
              std dev =       0.572656129749
             le_variance =       0.327935042939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327896234635
                                         uncertainty =       0.004848727209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327896234635
                                         uncertainty =       0.004848727209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405008208
  error estimate for blocks of size 2^( 2) =       0.000414612401
  error estimate for blocks of size 2^( 3) =       0.000423611822
  error estimate for blocks of size 2^( 4) =       0.000428826405
  error estimate for blocks of size 2^( 5) =       0.000433252185
  error estimate for blocks of size 2^( 6) =       0.000436098999
  error estimate for blocks of size 2^( 7) =       0.000437450108

      target function =                  N/A
              le_mean =     -17.216209688469
             les_mean =     296.725939170523
             stat err =       0.000433906924
             autocorr =       1.147798125526
              std dev =       0.572768100732
             le_variance =       0.328063297216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327852903185
                                         uncertainty =       0.004848045533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327852903185
                                         uncertainty =       0.004848045533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404981470
  error estimate for blocks of size 2^( 2) =       0.000414587196
  error estimate for blocks of size 2^( 3) =       0.000423589560
  error estimate for blocks of size 2^( 4) =       0.000428806209
  error estimate for blocks of size 2^( 5) =       0.000433232340
  error estimate for blocks of size 2^( 6) =       0.000436078398
  error estimate for blocks of size 2^( 7) =       0.000437430277

      target function =                  N/A
              le_mean =     -17.216210442736
             les_mean =     296.725921826228
             stat err =       0.000433886806
             autocorr =       1.147843246613
              std dev =       0.572730287011
             le_variance =       0.328019981660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327779402119
                                         uncertainty =       0.004848011617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327779402119
                                         uncertainty =       0.004848011617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404936146
  error estimate for blocks of size 2^( 2) =       0.000414546368
  error estimate for blocks of size 2^( 3) =       0.000423551197
  error estimate for blocks of size 2^( 4) =       0.000428773167
  error estimate for blocks of size 2^( 5) =       0.000433202007
  error estimate for blocks of size 2^( 6) =       0.000436046602
  error estimate for blocks of size 2^( 7) =       0.000437396934

      target function =                  N/A
              le_mean =     -17.216211712770
             les_mean =     296.725892140078
             stat err =       0.000433854678
             autocorr =       1.147930189555
              std dev =       0.572666189958
             le_variance =       0.327946565121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216212021102        initial  <--
     1.5259e-01     1.5259e+00             1.9597e-03       -17.216209688469
     6.1035e-01     6.1035e+00             5.6281e-04       -17.216210442736
     2.4414e+00     2.4414e+01             1.4426e-04       -17.216211712770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0580
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.097967e-01 1 1  ON 0
 uu_1                 4.809534e-02 1 1  ON 1
 uu_2                -4.517518e-02 1 1  ON 2
 uu_3                -9.942825e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385076e-01 1 1  ON 5
 uu_6                -1.150378e-01 1 1  ON 6
 uu_7                -4.256708e-02 1 1  ON 7
 uu_8                 9.777842e-02 1 1  ON 8
 uu_9                 1.225461e-01 1 1  ON 9
 ud_0                 3.463219e-01 1 1  ON 10
 ud_1                 9.088902e-02 1 1  ON 11
 ud_2                -1.344427e-02 1 1  ON 12
 ud_3                -7.172803e-02 1 1  ON 13
 ud_4                -1.199530e-01 1 1  ON 14
 ud_5                -1.535055e-01 1 1  ON 15
 ud_6                -1.556949e-01 1 1  ON 16
 ud_7                -1.107664e-01 1 1  ON 17
 ud_8                 1.415348e-03 1 1  ON 18
 ud_9                 9.244323e-02 1 1  ON 19
 eO_0                -7.561444e-01 1 1  ON 20
 eO_1                -4.427267e-01 1 1  ON 21
 eO_2                -4.536688e-02 1 1  ON 22
 eO_3                 2.044040e-01 1 1  ON 23
 eO_4                 2.978961e-01 1 1  ON 24
 eO_5                 3.141516e-01 1 1  ON 25
 eO_6                 2.539358e-01 1 1  ON 26
 eO_7                 1.158712e-01 1 1  ON 27
 eO_8                 2.853190e-02 1 1  ON 28
 eO_9                 1.861769e-02 1 1  ON 29
eH1_0                -1.815276e-01 1 1  ON 30
eH1_1                -1.033489e-01 1 1  ON 31
eH1_2                -6.278181e-02 1 1  ON 32
eH1_3                -2.665940e-02 1 1  ON 33
eH1_4                 1.895520e-02 1 1  ON 34
eH1_5                 3.447326e-02 1 1  ON 35
eH1_6                 7.839389e-02 1 1  ON 36
eH1_7                 1.093389e-01 1 1  ON 37
eH1_8                 9.260739e-02 1 1  ON 38
eH1_9                 2.499191e-02 1 1  ON 39
eH2_0                -1.833830e-01 1 1  ON 40
eH2_1                -1.046298e-01 1 1  ON 41
eH2_2                -6.407516e-02 1 1  ON 42
eH2_3                -2.757946e-02 1 1  ON 43
eH2_4                 1.792881e-02 1 1  ON 44
eH2_5                 3.387542e-02 1 1  ON 45
eH2_6                 7.883642e-02 1 1  ON 46
eH2_7                 1.133592e-01 1 1  ON 47
eH2_8                 9.618421e-02 1 1  ON 48
eH2_9                 2.707205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.400257
====================================================
  Execution time = 2.2781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325122972130
                                         uncertainty =       0.004554236118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325122972130
                                         uncertainty =       0.004554236118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403200430
  error estimate for blocks of size 2^( 2) =       0.000412682628
  error estimate for blocks of size 2^( 3) =       0.000421132426
  error estimate for blocks of size 2^( 4) =       0.000427524591
  error estimate for blocks of size 2^( 5) =       0.000431196813
  error estimate for blocks of size 2^( 6) =       0.000431910518
  error estimate for blocks of size 2^( 7) =       0.000432357454

      target function =                  N/A
              le_mean =     -17.216690996118
             les_mean =     296.739589866308
             stat err =       0.000430747344
             autocorr =       1.141309004774
              std dev =       0.570211516079
             le_variance =       0.325141173069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669099612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690996118       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691235370       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691386744       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691434538       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691453086       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691482871       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691484234       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216691509834       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.062612e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690996118       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691060540       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691099668       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691121144       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691113362       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691119800       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691124194       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.213957e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690996118       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691012540       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691022410       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691028316       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691026142       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691027279       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691028560       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.313038e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8462e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.097936e-01 1 1  ON 0
 uu_1                 4.812515e-02 1 1  ON 1
 uu_2                -4.516767e-02 1 1  ON 2
 uu_3                -9.941668e-02 1 1  ON 3
 uu_4                -1.325367e-01 1 1  ON 4
 uu_5                -1.385339e-01 1 1  ON 5
 uu_6                -1.150459e-01 1 1  ON 6
 uu_7                -4.258828e-02 1 1  ON 7
 uu_8                 9.776581e-02 1 1  ON 8
 uu_9                 1.225574e-01 1 1  ON 9
 ud_0                 3.463264e-01 1 1  ON 10
 ud_1                 9.089698e-02 1 1  ON 11
 ud_2                -1.344603e-02 1 1  ON 12
 ud_3                -7.172282e-02 1 1  ON 13
 ud_4                -1.199616e-01 1 1  ON 14
 ud_5                -1.535024e-01 1 1  ON 15
 ud_6                -1.556999e-01 1 1  ON 16
 ud_7                -1.107702e-01 1 1  ON 17
 ud_8                 1.400806e-03 1 1  ON 18
 ud_9                 9.244500e-02 1 1  ON 19
 eO_0                -7.561965e-01 1 1  ON 20
 eO_1                -4.427674e-01 1 1  ON 21
 eO_2                -4.538827e-02 1 1  ON 22
 eO_3                 2.043910e-01 1 1  ON 23
 eO_4                 2.979476e-01 1 1  ON 24
 eO_5                 3.141852e-01 1 1  ON 25
 eO_6                 2.539545e-01 1 1  ON 26
 eO_7                 1.158890e-01 1 1  ON 27
 eO_8                 2.853465e-02 1 1  ON 28
 eO_9                 1.861957e-02 1 1  ON 29
eH1_0                -1.815366e-01 1 1  ON 30
eH1_1                -1.033651e-01 1 1  ON 31
eH1_2                -6.279237e-02 1 1  ON 32
eH1_3                -2.665848e-02 1 1  ON 33
eH1_4                 1.896179e-02 1 1  ON 34
eH1_5                 3.448753e-02 1 1  ON 35
eH1_6                 7.839863e-02 1 1  ON 36
eH1_7                 1.093362e-01 1 1  ON 37
eH1_8                 9.261633e-02 1 1  ON 38
eH1_9                 2.499396e-02 1 1  ON 39
eH2_0                -1.833716e-01 1 1  ON 40
eH2_1                -1.046370e-01 1 1  ON 41
eH2_2                -6.406145e-02 1 1  ON 42
eH2_3                -2.758314e-02 1 1  ON 43
eH2_4                 1.792261e-02 1 1  ON 44
eH2_5                 3.385808e-02 1 1  ON 45
eH2_6                 7.883184e-02 1 1  ON 46
eH2_7                 1.133575e-01 1 1  ON 47
eH2_8                 9.619341e-02 1 1  ON 48
eH2_9                 2.707601e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1226
    reference variance = 0.187843
====================================================
  Execution time = 1.9917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1856e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318589568397
                                         uncertainty =       0.004426928249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318589568397
                                         uncertainty =       0.004426928249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399098604
  error estimate for blocks of size 2^( 2) =       0.000408843376
  error estimate for blocks of size 2^( 3) =       0.000417428542
  error estimate for blocks of size 2^( 4) =       0.000424204358
  error estimate for blocks of size 2^( 5) =       0.000427370093
  error estimate for blocks of size 2^( 6) =       0.000428063973
  error estimate for blocks of size 2^( 7) =       0.000429030664

      target function =                  N/A
              le_mean =     -17.216463552894
             les_mean =     296.725176500313
             stat err =       0.000427167272
             autocorr =       1.145606647949
              std dev =       0.564410658531
             le_variance =       0.318559391464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318604050385
                                         uncertainty =       0.004427281013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318604050385
                                         uncertainty =       0.004427281013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399107656
  error estimate for blocks of size 2^( 2) =       0.000408851363
  error estimate for blocks of size 2^( 3) =       0.000417434925
  error estimate for blocks of size 2^( 4) =       0.000424209915
  error estimate for blocks of size 2^( 5) =       0.000427375852
  error estimate for blocks of size 2^( 6) =       0.000428070260
  error estimate for blocks of size 2^( 7) =       0.000429036324

      target function =                  N/A
              le_mean =     -17.216463467916
             les_mean =     296.725188025127
             stat err =       0.000427173088
             autocorr =       1.145585874762
              std dev =       0.564423460103
             le_variance =       0.318573842315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318597436516
                                         uncertainty =       0.004427097170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318597436516
                                         uncertainty =       0.004427097170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399103522
  error estimate for blocks of size 2^( 2) =       0.000408847685
  error estimate for blocks of size 2^( 3) =       0.000417431921
  error estimate for blocks of size 2^( 4) =       0.000424207361
  error estimate for blocks of size 2^( 5) =       0.000427373307
  error estimate for blocks of size 2^( 6) =       0.000428067605
  error estimate for blocks of size 2^( 7) =       0.000429033912

      target function =                  N/A
              le_mean =     -17.216463453216
             les_mean =     296.725180918540
             stat err =       0.000427170546
             autocorr =       1.145595977755
              std dev =       0.564417613021
             le_variance =       0.318567241888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318590596696
                                         uncertainty =       0.004426948465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318590596696
                                         uncertainty =       0.004426948465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399099247
  error estimate for blocks of size 2^( 2) =       0.000408843940
  error estimate for blocks of size 2^( 3) =       0.000417428986
  error estimate for blocks of size 2^( 4) =       0.000424204755
  error estimate for blocks of size 2^( 5) =       0.000427370519
  error estimate for blocks of size 2^( 6) =       0.000428064454
  error estimate for blocks of size 2^( 7) =       0.000429031097

      target function =                  N/A
              le_mean =     -17.216463537597
             les_mean =     296.725176999593
             stat err =       0.000427167706
             autocorr =       1.145605286949
              std dev =       0.564411567457
             le_variance =       0.318560417479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216463552894        initial  <--
     1.5259e+00     1.5259e+01             2.0626e-04       -17.216463467916
     6.1035e+00     6.1035e+01             5.2140e-05       -17.216463453216
     2.4414e+01     2.4414e+02             1.3130e-05       -17.216463537597

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2686
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.097967e-01 1 1  ON 0
 uu_1                 4.809534e-02 1 1  ON 1
 uu_2                -4.517518e-02 1 1  ON 2
 uu_3                -9.942825e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385076e-01 1 1  ON 5
 uu_6                -1.150378e-01 1 1  ON 6
 uu_7                -4.256708e-02 1 1  ON 7
 uu_8                 9.777842e-02 1 1  ON 8
 uu_9                 1.225461e-01 1 1  ON 9
 ud_0                 3.463219e-01 1 1  ON 10
 ud_1                 9.088902e-02 1 1  ON 11
 ud_2                -1.344427e-02 1 1  ON 12
 ud_3                -7.172803e-02 1 1  ON 13
 ud_4                -1.199530e-01 1 1  ON 14
 ud_5                -1.535055e-01 1 1  ON 15
 ud_6                -1.556949e-01 1 1  ON 16
 ud_7                -1.107664e-01 1 1  ON 17
 ud_8                 1.415348e-03 1 1  ON 18
 ud_9                 9.244323e-02 1 1  ON 19
 eO_0                -7.561444e-01 1 1  ON 20
 eO_1                -4.427267e-01 1 1  ON 21
 eO_2                -4.536688e-02 1 1  ON 22
 eO_3                 2.044040e-01 1 1  ON 23
 eO_4                 2.978961e-01 1 1  ON 24
 eO_5                 3.141516e-01 1 1  ON 25
 eO_6                 2.539358e-01 1 1  ON 26
 eO_7                 1.158712e-01 1 1  ON 27
 eO_8                 2.853190e-02 1 1  ON 28
 eO_9                 1.861769e-02 1 1  ON 29
eH1_0                -1.815276e-01 1 1  ON 30
eH1_1                -1.033489e-01 1 1  ON 31
eH1_2                -6.278181e-02 1 1  ON 32
eH1_3                -2.665940e-02 1 1  ON 33
eH1_4                 1.895520e-02 1 1  ON 34
eH1_5                 3.447326e-02 1 1  ON 35
eH1_6                 7.839389e-02 1 1  ON 36
eH1_7                 1.093389e-01 1 1  ON 37
eH1_8                 9.260739e-02 1 1  ON 38
eH1_9                 2.499191e-02 1 1  ON 39
eH2_0                -1.833830e-01 1 1  ON 40
eH2_1                -1.046298e-01 1 1  ON 41
eH2_2                -6.407516e-02 1 1  ON 42
eH2_3                -2.757946e-02 1 1  ON 43
eH2_4                 1.792881e-02 1 1  ON 44
eH2_5                 3.387542e-02 1 1  ON 45
eH2_6                 7.883642e-02 1 1  ON 46
eH2_7                 1.133592e-01 1 1  ON 47
eH2_8                 9.618421e-02 1 1  ON 48
eH2_9                 2.707205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7737e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.11776
====================================================
  Execution time = 2.0359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2486e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324756673034
                                         uncertainty =       0.007048090767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324756673034
                                         uncertainty =       0.007048090767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403027731
  error estimate for blocks of size 2^( 2) =       0.000412455977
  error estimate for blocks of size 2^( 3) =       0.000421156863
  error estimate for blocks of size 2^( 4) =       0.000427462386
  error estimate for blocks of size 2^( 5) =       0.000430812252
  error estimate for blocks of size 2^( 6) =       0.000432262631
  error estimate for blocks of size 2^( 7) =       0.000433332275

      target function =                  N/A
              le_mean =     -17.216132141586
             les_mean =     296.720068457751
             stat err =       0.000430967386
             autocorr =       1.143454670516
              std dev =       0.569967282939
             le_variance =       0.324862703621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613214159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216132141586       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216132141875       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216132126105       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216132126928       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216132115954       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216132129768       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216132129571       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.808935e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216132141586       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216132141659       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216132137660       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216132137866       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216132135000       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216132138387       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216132138317       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.066873e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216132141586       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216132141605       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216132140601       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216132140653       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216132139928       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216132140771       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216132140752       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.769566e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5968e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.097975e-01 1 1  ON 0
 uu_1                 4.809742e-02 1 1  ON 1
 uu_2                -4.517491e-02 1 1  ON 2
 uu_3                -9.942840e-02 1 1  ON 3
 uu_4                -1.325367e-01 1 1  ON 4
 uu_5                -1.385094e-01 1 1  ON 5
 uu_6                -1.150395e-01 1 1  ON 6
 uu_7                -4.256814e-02 1 1  ON 7
 uu_8                 9.777729e-02 1 1  ON 8
 uu_9                 1.225472e-01 1 1  ON 9
 ud_0                 3.463214e-01 1 1  ON 10
 ud_1                 9.089104e-02 1 1  ON 11
 ud_2                -1.344463e-02 1 1  ON 12
 ud_3                -7.172788e-02 1 1  ON 13
 ud_4                -1.199524e-01 1 1  ON 14
 ud_5                -1.535061e-01 1 1  ON 15
 ud_6                -1.556960e-01 1 1  ON 16
 ud_7                -1.107665e-01 1 1  ON 17
 ud_8                 1.413538e-03 1 1  ON 18
 ud_9                 9.244330e-02 1 1  ON 19
 eO_0                -7.561492e-01 1 1  ON 20
 eO_1                -4.427337e-01 1 1  ON 21
 eO_2                -4.536753e-02 1 1  ON 22
 eO_3                 2.044037e-01 1 1  ON 23
 eO_4                 2.979009e-01 1 1  ON 24
 eO_5                 3.141551e-01 1 1  ON 25
 eO_6                 2.539376e-01 1 1  ON 26
 eO_7                 1.158731e-01 1 1  ON 27
 eO_8                 2.853214e-02 1 1  ON 28
 eO_9                 1.861785e-02 1 1  ON 29
eH1_0                -1.815285e-01 1 1  ON 30
eH1_1                -1.033496e-01 1 1  ON 31
eH1_2                -6.278301e-02 1 1  ON 32
eH1_3                -2.665870e-02 1 1  ON 33
eH1_4                 1.895306e-02 1 1  ON 34
eH1_5                 3.447294e-02 1 1  ON 35
eH1_6                 7.839601e-02 1 1  ON 36
eH1_7                 1.093396e-01 1 1  ON 37
eH1_8                 9.260852e-02 1 1  ON 38
eH1_9                 2.499233e-02 1 1  ON 39
eH2_0                -1.833825e-01 1 1  ON 40
eH2_1                -1.046285e-01 1 1  ON 41
eH2_2                -6.407529e-02 1 1  ON 42
eH2_3                -2.758091e-02 1 1  ON 43
eH2_4                 1.792837e-02 1 1  ON 44
eH2_5                 3.387367e-02 1 1  ON 45
eH2_6                 7.883671e-02 1 1  ON 46
eH2_7                 1.133595e-01 1 1  ON 47
eH2_8                 9.618521e-02 1 1  ON 48
eH2_9                 2.707231e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.216507
====================================================
  Execution time = 1.9826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2603e-01
  Total weights = 2.0000e+06
  Execution time = 1.8280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325798085069
                                         uncertainty =       0.004393126396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325798085069
                                         uncertainty =       0.004393126396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748802
  error estimate for blocks of size 2^( 2) =       0.000413416951
  error estimate for blocks of size 2^( 3) =       0.000422085917
  error estimate for blocks of size 2^( 4) =       0.000428887066
  error estimate for blocks of size 2^( 5) =       0.000433250904
  error estimate for blocks of size 2^( 6) =       0.000435659291
  error estimate for blocks of size 2^( 7) =       0.000439292554

      target function =                  N/A
              le_mean =     -17.216406224894
             les_mean =     296.730669327212
             stat err =       0.000434272454
             autocorr =       1.156916653298
              std dev =       0.570987031091
             le_variance =       0.326026189674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797030151
                                         uncertainty =       0.004393153584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797030151
                                         uncertainty =       0.004393153584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748162
  error estimate for blocks of size 2^( 2) =       0.000413416326
  error estimate for blocks of size 2^( 3) =       0.000422085199
  error estimate for blocks of size 2^( 4) =       0.000428886324
  error estimate for blocks of size 2^( 5) =       0.000433250143
  error estimate for blocks of size 2^( 6) =       0.000435658560
  error estimate for blocks of size 2^( 7) =       0.000439291980

      target function =                  N/A
              le_mean =     -17.216406226533
             les_mean =     296.730668350735
             stat err =       0.000434271752
             autocorr =       1.156916576839
              std dev =       0.570986126582
             le_variance =       0.326025156749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797498080
                                         uncertainty =       0.004393139894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325797498080
                                         uncertainty =       0.004393139894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748445
  error estimate for blocks of size 2^( 2) =       0.000413416603
  error estimate for blocks of size 2^( 3) =       0.000422085522
  error estimate for blocks of size 2^( 4) =       0.000428886660
  error estimate for blocks of size 2^( 5) =       0.000433250489
  error estimate for blocks of size 2^( 6) =       0.000435658892
  error estimate for blocks of size 2^( 7) =       0.000439292233

      target function =                  N/A
              le_mean =     -17.216406225727
             les_mean =     296.730668780184
             stat err =       0.000434272069
             autocorr =       1.156916644569
              std dev =       0.570986526942
             le_variance =       0.326025613949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325798009678
                                         uncertainty =       0.004393128080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325798009678
                                         uncertainty =       0.004393128080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748756
  error estimate for blocks of size 2^( 2) =       0.000413416906
  error estimate for blocks of size 2^( 3) =       0.000422085866
  error estimate for blocks of size 2^( 4) =       0.000428887014
  error estimate for blocks of size 2^( 5) =       0.000433250851
  error estimate for blocks of size 2^( 6) =       0.000435659240
  error estimate for blocks of size 2^( 7) =       0.000439292512

      target function =                  N/A
              le_mean =     -17.216406224989
             les_mean =     296.730669256512
             stat err =       0.000434272404
             autocorr =       1.156916653138
              std dev =       0.570986966314
             le_variance =       0.326026115700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216406224894        initial
     1.5259e+01     1.5259e+02             2.8089e-05       -17.216406226533  <--
     6.1035e+01     6.1035e+02             7.0669e-06       -17.216406225727
     2.4414e+02     2.4414e+03             1.7696e-06       -17.216406224989

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.9038e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408115e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536961e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5014e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1285
    reference variance = 0.348148
====================================================
  Execution time = 2.0043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319336203832
                                         uncertainty =       0.003116878443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319336203832
                                         uncertainty =       0.003116878443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399622936
  error estimate for blocks of size 2^( 2) =       0.000409366087
  error estimate for blocks of size 2^( 3) =       0.000417142446
  error estimate for blocks of size 2^( 4) =       0.000423246786
  error estimate for blocks of size 2^( 5) =       0.000427128782
  error estimate for blocks of size 2^( 6) =       0.000428588581
  error estimate for blocks of size 2^( 7) =       0.000431380848

      target function =                  N/A
              le_mean =     -17.216499861542
             les_mean =     296.727264304140
             stat err =       0.000427586249
             autocorr =       1.144844887894
              std dev =       0.565152175414
             le_variance =       0.319396981375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649986154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499861542       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499953431       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500283323       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500214596       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500285256       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500284943       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500309614       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216500291855       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.470181e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499861542       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499885217       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499972756       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499954904       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499972767       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216499971766       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216499978704       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.368610e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499861542       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499867506       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499889730       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499885226       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499889714       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216499889404       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216499891184       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.926963e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5667e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.098031e-01 1 1  ON 0
 uu_1                 4.811434e-02 1 1  ON 1
 uu_2                -4.517231e-02 1 1  ON 2
 uu_3                -9.942585e-02 1 1  ON 3
 uu_4                -1.325315e-01 1 1  ON 4
 uu_5                -1.385233e-01 1 1  ON 5
 uu_6                -1.150524e-01 1 1  ON 6
 uu_7                -4.257976e-02 1 1  ON 7
 uu_8                 9.776547e-02 1 1  ON 8
 uu_9                 1.225529e-01 1 1  ON 9
 ud_0                 3.463236e-01 1 1  ON 10
 ud_1                 9.089757e-02 1 1  ON 11
 ud_2                -1.344346e-02 1 1  ON 12
 ud_3                -7.172324e-02 1 1  ON 13
 ud_4                -1.199456e-01 1 1  ON 14
 ud_5                -1.535093e-01 1 1  ON 15
 ud_6                -1.556996e-01 1 1  ON 16
 ud_7                -1.107742e-01 1 1  ON 17
 ud_8                 1.397156e-03 1 1  ON 18
 ud_9                 9.244253e-02 1 1  ON 19
 eO_0                -7.561861e-01 1 1  ON 20
 eO_1                -4.427707e-01 1 1  ON 21
 eO_2                -4.537749e-02 1 1  ON 22
 eO_3                 2.043980e-01 1 1  ON 23
 eO_4                 2.979391e-01 1 1  ON 24
 eO_5                 3.141796e-01 1 1  ON 25
 eO_6                 2.539487e-01 1 1  ON 26
 eO_7                 1.158849e-01 1 1  ON 27
 eO_8                 2.853354e-02 1 1  ON 28
 eO_9                 1.861891e-02 1 1  ON 29
eH1_0                -1.815392e-01 1 1  ON 30
eH1_1                -1.033395e-01 1 1  ON 31
eH1_2                -6.279164e-02 1 1  ON 32
eH1_3                -2.665618e-02 1 1  ON 33
eH1_4                 1.894275e-02 1 1  ON 34
eH1_5                 3.447145e-02 1 1  ON 35
eH1_6                 7.840180e-02 1 1  ON 36
eH1_7                 1.093410e-01 1 1  ON 37
eH1_8                 9.261557e-02 1 1  ON 38
eH1_9                 2.499455e-02 1 1  ON 39
eH2_0                -1.833768e-01 1 1  ON 40
eH2_1                -1.046195e-01 1 1  ON 41
eH2_2                -6.407845e-02 1 1  ON 42
eH2_3                -2.759602e-02 1 1  ON 43
eH2_4                 1.792096e-02 1 1  ON 44
eH2_5                 3.387339e-02 1 1  ON 45
eH2_6                 7.883977e-02 1 1  ON 46
eH2_7                 1.133576e-01 1 1  ON 47
eH2_8                 9.619219e-02 1 1  ON 48
eH2_9                 2.707445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2066
    reference variance = 0.177191
====================================================
  Execution time = 2.0134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2004e-01
  Total weights = 2.0000e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320095821511
                                         uncertainty =       0.004112357375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320095821511
                                         uncertainty =       0.004112357375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400025304
  error estimate for blocks of size 2^( 2) =       0.000409415234
  error estimate for blocks of size 2^( 3) =       0.000418384788
  error estimate for blocks of size 2^( 4) =       0.000424845163
  error estimate for blocks of size 2^( 5) =       0.000427787069
  error estimate for blocks of size 2^( 6) =       0.000431153315
  error estimate for blocks of size 2^( 7) =       0.000431353789

      target function =                  N/A
              le_mean =     -17.217230940121
             les_mean =     296.753081573613
             stat err =       0.000428784834
             autocorr =       1.148957337473
              std dev =       0.565721210632
             le_variance =       0.320040488159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320109945446
                                         uncertainty =       0.004112600528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320109945446
                                         uncertainty =       0.004112600528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400034123
  error estimate for blocks of size 2^( 2) =       0.000409423830
  error estimate for blocks of size 2^( 3) =       0.000418393005
  error estimate for blocks of size 2^( 4) =       0.000424853457
  error estimate for blocks of size 2^( 5) =       0.000427794926
  error estimate for blocks of size 2^( 6) =       0.000431160704
  error estimate for blocks of size 2^( 7) =       0.000431361757

      target function =                  N/A
              le_mean =     -17.217230778840
             les_mean =     296.753090130290
             stat err =       0.000428792711
             autocorr =       1.148948898686
              std dev =       0.565733681574
             le_variance =       0.320054598467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320104518118
                                         uncertainty =       0.004112497835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320104518118
                                         uncertainty =       0.004112497835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400030734
  error estimate for blocks of size 2^( 2) =       0.000409420483
  error estimate for blocks of size 2^( 3) =       0.000418389797
  error estimate for blocks of size 2^( 4) =       0.000424850205
  error estimate for blocks of size 2^( 5) =       0.000427791870
  error estimate for blocks of size 2^( 6) =       0.000431157874
  error estimate for blocks of size 2^( 7) =       0.000431358684

      target function =                  N/A
              le_mean =     -17.217230836472
             les_mean =     296.753086692699
             stat err =       0.000428789658
             autocorr =       1.148952002034
              std dev =       0.565728889466
             le_variance =       0.320049176377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096924029
                                         uncertainty =       0.004112375150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320096924029
                                         uncertainty =       0.004112375150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400025993
  error estimate for blocks of size 2^( 2) =       0.000409415899
  error estimate for blocks of size 2^( 3) =       0.000418385423
  error estimate for blocks of size 2^( 4) =       0.000424845802
  error estimate for blocks of size 2^( 5) =       0.000427787677
  error estimate for blocks of size 2^( 6) =       0.000431153892
  error estimate for blocks of size 2^( 7) =       0.000431354409

      target function =                  N/A
              le_mean =     -17.217230926916
             les_mean =     296.753082220323
             stat err =       0.000428785445
             autocorr =       1.148956660322
              std dev =       0.565722184122
             le_variance =       0.320041589608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217230940121        initial  <--
     3.8147e+00     3.8147e+01             9.4702e-05       -17.217230778840
     1.5259e+01     1.5259e+02             2.3686e-05       -17.217230836472
     6.1035e+01     6.1035e+02             5.9270e-06       -17.217230926916

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3937
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408115e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536961e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1569
    reference variance = 0.300225
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344800673143
                                         uncertainty =       0.013187722852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344800673143
                                         uncertainty =       0.013187722852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415157510
  error estimate for blocks of size 2^( 2) =       0.000424321526
  error estimate for blocks of size 2^( 3) =       0.000432422085
  error estimate for blocks of size 2^( 4) =       0.000438261965
  error estimate for blocks of size 2^( 5) =       0.000442131228
  error estimate for blocks of size 2^( 6) =       0.000444991544
  error estimate for blocks of size 2^( 7) =       0.000444256820

      target function =                  N/A
              le_mean =     -17.216548241391
             les_mean =     296.754244692324
             stat err =       0.000442410389
             autocorr =       1.135598569268
              std dev =       0.587121381436
             le_variance =       0.344711516540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654824139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548241391       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548241410       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548276445       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548281570       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548271259       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548276036       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548273069       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 9.144976e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548241391       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548241396       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548250201       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548251471       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548248909       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548250088       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548249345       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.288502e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548241391       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548241392       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548243596       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548243913       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548243274       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548243567       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548243382       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.722674e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6457e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.097998e-01 1 1  ON 0
 uu_1                 4.810415e-02 1 1  ON 1
 uu_2                -4.517379e-02 1 1  ON 2
 uu_3                -9.942865e-02 1 1  ON 3
 uu_4                -1.325368e-01 1 1  ON 4
 uu_5                -1.385154e-01 1 1  ON 5
 uu_6                -1.150448e-01 1 1  ON 6
 uu_7                -4.257192e-02 1 1  ON 7
 uu_8                 9.777325e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463198e-01 1 1  ON 10
 ud_1                 9.089714e-02 1 1  ON 11
 ud_2                -1.344541e-02 1 1  ON 12
 ud_3                -7.172719e-02 1 1  ON 13
 ud_4                -1.199503e-01 1 1  ON 14
 ud_5                -1.535072e-01 1 1  ON 15
 ud_6                -1.556997e-01 1 1  ON 16
 ud_7                -1.107673e-01 1 1  ON 17
 ud_8                 1.407418e-03 1 1  ON 18
 ud_9                 9.244359e-02 1 1  ON 19
 eO_0                -7.561661e-01 1 1  ON 20
 eO_1                -4.427564e-01 1 1  ON 21
 eO_2                -4.537063e-02 1 1  ON 22
 eO_3                 2.044031e-01 1 1  ON 23
 eO_4                 2.979166e-01 1 1  ON 24
 eO_5                 3.141674e-01 1 1  ON 25
 eO_6                 2.539443e-01 1 1  ON 26
 eO_7                 1.158796e-01 1 1  ON 27
 eO_8                 2.853294e-02 1 1  ON 28
 eO_9                 1.861837e-02 1 1  ON 29
eH1_0                -1.815316e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278648e-02 1 1  ON 32
eH1_3                -2.665697e-02 1 1  ON 33
eH1_4                 1.894629e-02 1 1  ON 34
eH1_5                 3.447206e-02 1 1  ON 35
eH1_6                 7.840243e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261226e-02 1 1  ON 38
eH1_9                 2.499369e-02 1 1  ON 39
eH2_0                -1.833808e-01 1 1  ON 40
eH2_1                -1.046241e-01 1 1  ON 41
eH2_2                -6.407571e-02 1 1  ON 42
eH2_3                -2.758589e-02 1 1  ON 43
eH2_4                 1.792635e-02 1 1  ON 44
eH2_5                 3.386766e-02 1 1  ON 45
eH2_6                 7.883767e-02 1 1  ON 46
eH2_7                 1.133606e-01 1 1  ON 47
eH2_8                 9.618872e-02 1 1  ON 48
eH2_9                 2.707322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.21
    reference variance = 0.250482
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1999e-01
  Total weights = 2.0000e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997210614
                                         uncertainty =       0.004706819086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997210614
                                         uncertainty =       0.004706819086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399992480
  error estimate for blocks of size 2^( 2) =       0.000409542250
  error estimate for blocks of size 2^( 3) =       0.000417827053
  error estimate for blocks of size 2^( 4) =       0.000424407052
  error estimate for blocks of size 2^( 5) =       0.000427032308
  error estimate for blocks of size 2^( 6) =       0.000430876752
  error estimate for blocks of size 2^( 7) =       0.000430948161

      target function =                  N/A
              le_mean =     -17.216077586593
             les_mean =     296.713315276323
             stat err =       0.000428316068
             autocorr =       1.146634700796
              std dev =       0.565674790610
             le_variance =       0.319987968732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319995803182
                                         uncertainty =       0.004706802369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319995803182
                                         uncertainty =       0.004706802369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399991600
  error estimate for blocks of size 2^( 2) =       0.000409541430
  error estimate for blocks of size 2^( 3) =       0.000417826266
  error estimate for blocks of size 2^( 4) =       0.000424406280
  error estimate for blocks of size 2^( 5) =       0.000427031506
  error estimate for blocks of size 2^( 6) =       0.000430876014
  error estimate for blocks of size 2^( 7) =       0.000430947462

      target function =                  N/A
              le_mean =     -17.216077580132
             les_mean =     296.713313645380
             stat err =       0.000428315316
             autocorr =       1.146635718037
              std dev =       0.565673545661
             le_variance =       0.319986560261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319996499915
                                         uncertainty =       0.004706810637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319996499915
                                         uncertainty =       0.004706810637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399992036
  error estimate for blocks of size 2^( 2) =       0.000409541836
  error estimate for blocks of size 2^( 3) =       0.000417826656
  error estimate for blocks of size 2^( 4) =       0.000424406662
  error estimate for blocks of size 2^( 5) =       0.000427031903
  error estimate for blocks of size 2^( 6) =       0.000430876379
  error estimate for blocks of size 2^( 7) =       0.000430947808

      target function =                  N/A
              le_mean =     -17.216077583374
             les_mean =     296.713314454271
             stat err =       0.000428315688
             autocorr =       1.146635214198
              std dev =       0.565674161962
             le_variance =       0.319987257511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997121552
                                         uncertainty =       0.004706818027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997121552
                                         uncertainty =       0.004706818027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399992425
  error estimate for blocks of size 2^( 2) =       0.000409542198
  error estimate for blocks of size 2^( 3) =       0.000417827003
  error estimate for blocks of size 2^( 4) =       0.000424407003
  error estimate for blocks of size 2^( 5) =       0.000427032258
  error estimate for blocks of size 2^( 6) =       0.000430876705
  error estimate for blocks of size 2^( 7) =       0.000430948117

      target function =                  N/A
              le_mean =     -17.216077586190
             les_mean =     296.713315173332
             stat err =       0.000428316021
             autocorr =       1.146634765114
              std dev =       0.565674711831
             le_variance =       0.319987879606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216077586593        initial  <--
     3.8147e+01     3.8147e+02             9.1450e-06       -17.216077580132
     1.5259e+02     1.5259e+03             2.2885e-06       -17.216077583374
     6.1035e+02     6.1035e+03             5.7227e-07       -17.216077586190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4276
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408115e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536961e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.3357
    reference variance = 0.394613
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2236e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322233616979
                                         uncertainty =       0.004939172399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322233616979
                                         uncertainty =       0.004939172399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401471807
  error estimate for blocks of size 2^( 2) =       0.000411220740
  error estimate for blocks of size 2^( 3) =       0.000419102309
  error estimate for blocks of size 2^( 4) =       0.000425701251
  error estimate for blocks of size 2^( 5) =       0.000429532350
  error estimate for blocks of size 2^( 6) =       0.000430756866
  error estimate for blocks of size 2^( 7) =       0.000431394983

      target function =                  N/A
              le_mean =     -17.216548892832
             les_mean =     296.731914840957
             stat err =       0.000429346362
             autocorr =       1.143682487855
              std dev =       0.567766873678
             le_variance =       0.322359222846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654889283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548892832       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548893775       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548895535       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548896041       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548896221       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548895758       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548895685       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.024144e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548892832       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548893068       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548893509       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548893635       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548893681       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548893565       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548893548       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.256444e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548892832       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548892891       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548893002       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548893033       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548893048       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548893020       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548893013       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.641365e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5784e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.097998e-01 1 1  ON 0
 uu_1                 4.810371e-02 1 1  ON 1
 uu_2                -4.517409e-02 1 1  ON 2
 uu_3                -9.942879e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385150e-01 1 1  ON 5
 uu_6                -1.150448e-01 1 1  ON 6
 uu_7                -4.257138e-02 1 1  ON 7
 uu_8                 9.777385e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463202e-01 1 1  ON 10
 ud_1                 9.089695e-02 1 1  ON 11
 ud_2                -1.344567e-02 1 1  ON 12
 ud_3                -7.172738e-02 1 1  ON 13
 ud_4                -1.199505e-01 1 1  ON 14
 ud_5                -1.535077e-01 1 1  ON 15
 ud_6                -1.556994e-01 1 1  ON 16
 ud_7                -1.107670e-01 1 1  ON 17
 ud_8                 1.408049e-03 1 1  ON 18
 ud_9                 9.244354e-02 1 1  ON 19
 eO_0                -7.561640e-01 1 1  ON 20
 eO_1                -4.427549e-01 1 1  ON 21
 eO_2                -4.536965e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979156e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853289e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278661e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894661e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840236e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261195e-02 1 1  ON 38
eH1_9                 2.499360e-02 1 1  ON 39
eH2_0                -1.833812e-01 1 1  ON 40
eH2_1                -1.046245e-01 1 1  ON 41
eH2_2                -6.407570e-02 1 1  ON 42
eH2_3                -2.758517e-02 1 1  ON 43
eH2_4                 1.792701e-02 1 1  ON 44
eH2_5                 3.386834e-02 1 1  ON 45
eH2_6                 7.883756e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618825e-02 1 1  ON 48
eH2_9                 2.707311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2625
    reference variance = 0.239901
====================================================
  Execution time = 1.9635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2498e-01
  Total weights = 2.0000e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875071346
                                         uncertainty =       0.003888522705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875071346
                                         uncertainty =       0.003888522705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403101395
  error estimate for blocks of size 2^( 2) =       0.000412787173
  error estimate for blocks of size 2^( 3) =       0.000421480179
  error estimate for blocks of size 2^( 4) =       0.000427666850
  error estimate for blocks of size 2^( 5) =       0.000431518411
  error estimate for blocks of size 2^( 6) =       0.000432867886
  error estimate for blocks of size 2^( 7) =       0.000432995433

      target function =                  N/A
              le_mean =     -17.215828012272
             les_mean =     296.709715454486
             stat err =       0.000431262145
             autocorr =       1.144600880446
              std dev =       0.570071459414
             le_variance =       0.324981468838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875420784
                                         uncertainty =       0.003888530439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875420784
                                         uncertainty =       0.003888530439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403101611
  error estimate for blocks of size 2^( 2) =       0.000412787377
  error estimate for blocks of size 2^( 3) =       0.000421480371
  error estimate for blocks of size 2^( 4) =       0.000427667032
  error estimate for blocks of size 2^( 5) =       0.000431518586
  error estimate for blocks of size 2^( 6) =       0.000432868059
  error estimate for blocks of size 2^( 7) =       0.000432995601

      target function =                  N/A
              le_mean =     -17.215828011583
             les_mean =     296.709715780075
             stat err =       0.000431262320
             autocorr =       1.144600576709
              std dev =       0.570071765811
             le_variance =       0.324981818175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875246163
                                         uncertainty =       0.003888526575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875246163
                                         uncertainty =       0.003888526575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403101503
  error estimate for blocks of size 2^( 2) =       0.000412787275
  error estimate for blocks of size 2^( 3) =       0.000421480275
  error estimate for blocks of size 2^( 4) =       0.000427666941
  error estimate for blocks of size 2^( 5) =       0.000431518499
  error estimate for blocks of size 2^( 6) =       0.000432867973
  error estimate for blocks of size 2^( 7) =       0.000432995517

      target function =                  N/A
              le_mean =     -17.215828011927
             les_mean =     296.709715617361
             stat err =       0.000431262232
             autocorr =       1.144600728482
              std dev =       0.570071612698
             le_variance =       0.324981643604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875093201
                                         uncertainty =       0.003888523189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324875093201
                                         uncertainty =       0.003888523189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403101408
  error estimate for blocks of size 2^( 2) =       0.000412787186
  error estimate for blocks of size 2^( 3) =       0.000421480191
  error estimate for blocks of size 2^( 4) =       0.000427666861
  error estimate for blocks of size 2^( 5) =       0.000431518422
  error estimate for blocks of size 2^( 6) =       0.000432867897
  error estimate for blocks of size 2^( 7) =       0.000432995443

      target function =                  N/A
              le_mean =     -17.215828012229
             les_mean =     296.709715474847
             stat err =       0.000431262156
             autocorr =       1.144600861452
              std dev =       0.570071478577
             le_variance =       0.324981490687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215828012272        initial  <--
     3.8147e+02     3.8147e+03             9.0241e-07       -17.215828011583
     1.5259e+03     1.5259e+04             2.2564e-07       -17.215828011927
     6.1035e+03     6.1035e+04             5.6414e-08       -17.215828012229

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8265
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408115e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536961e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2692
    reference variance = 0.216909
====================================================
  Execution time = 2.2266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327580985302
                                         uncertainty =       0.008615207896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327580985302
                                         uncertainty =       0.008615207896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404726873
  error estimate for blocks of size 2^( 2) =       0.000414421723
  error estimate for blocks of size 2^( 3) =       0.000423362666
  error estimate for blocks of size 2^( 4) =       0.000429273252
  error estimate for blocks of size 2^( 5) =       0.000432496153
  error estimate for blocks of size 2^( 6) =       0.000434770344
  error estimate for blocks of size 2^( 7) =       0.000438274066

      target function =                  N/A
              le_mean =     -17.216119733742
             les_mean =     296.722386206035
             stat err =       0.000433703454
             autocorr =       1.148316692145
              std dev =       0.572370232703
             le_variance =       0.327607683285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611973374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216119733742       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216119733685       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216119733717       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216119733682       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216119733526       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216119733652       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216119733670       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.505292e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216119733742       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216119733728       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216119733736       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216119733727       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216119733695       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216119733721       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216119733730       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.876351e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216119733742       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216119733739       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216119733741       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216119733725       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216119733697       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216119733740       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216119733742       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.690896e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7978e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408109e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665665e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840234e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792699e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.158172
====================================================
  Execution time = 2.2238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2117e-01
  Total weights = 2.0000e+06
  Execution time = 1.8309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266559962
                                         uncertainty =       0.005425683399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266559962
                                         uncertainty =       0.005425683399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400733280
  error estimate for blocks of size 2^( 2) =       0.000410281651
  error estimate for blocks of size 2^( 3) =       0.000418991450
  error estimate for blocks of size 2^( 4) =       0.000425685570
  error estimate for blocks of size 2^( 5) =       0.000429842039
  error estimate for blocks of size 2^( 6) =       0.000430878629
  error estimate for blocks of size 2^( 7) =       0.000430717498

      target function =                  N/A
              le_mean =     -17.216691896598
             les_mean =     296.735654025463
             stat err =       0.000429280934
             autocorr =       1.147552009343
              std dev =       0.566722439718
             le_variance =       0.321174323680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266555790
                                         uncertainty =       0.005425683279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266555790
                                         uncertainty =       0.005425683279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400733278
  error estimate for blocks of size 2^( 2) =       0.000410281648
  error estimate for blocks of size 2^( 3) =       0.000418991447
  error estimate for blocks of size 2^( 4) =       0.000425685567
  error estimate for blocks of size 2^( 5) =       0.000429842037
  error estimate for blocks of size 2^( 6) =       0.000430878627
  error estimate for blocks of size 2^( 7) =       0.000430717495

      target function =                  N/A
              le_mean =     -17.216691896265
             les_mean =     296.735654009831
             stat err =       0.000429280932
             autocorr =       1.147552012255
              std dev =       0.566722436036
             le_variance =       0.321174319507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266557876
                                         uncertainty =       0.005425683339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266557876
                                         uncertainty =       0.005425683339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400733279
  error estimate for blocks of size 2^( 2) =       0.000410281649
  error estimate for blocks of size 2^( 3) =       0.000418991448
  error estimate for blocks of size 2^( 4) =       0.000425685569
  error estimate for blocks of size 2^( 5) =       0.000429842038
  error estimate for blocks of size 2^( 6) =       0.000430878628
  error estimate for blocks of size 2^( 7) =       0.000430717496

      target function =                  N/A
              le_mean =     -17.216691896431
             les_mean =     296.735654017647
             stat err =       0.000429280933
             autocorr =       1.147552010797
              std dev =       0.566722437877
             le_variance =       0.321174321594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266559701
                                         uncertainty =       0.005425683391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321266559701
                                         uncertainty =       0.005425683391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400733280
  error estimate for blocks of size 2^( 2) =       0.000410281650
  error estimate for blocks of size 2^( 3) =       0.000418991449
  error estimate for blocks of size 2^( 4) =       0.000425685570
  error estimate for blocks of size 2^( 5) =       0.000429842039
  error estimate for blocks of size 2^( 6) =       0.000430878629
  error estimate for blocks of size 2^( 7) =       0.000430717497

      target function =                  N/A
              le_mean =     -17.216691896577
             les_mean =     296.735654024486
             stat err =       0.000429280934
             autocorr =       1.147552009525
              std dev =       0.566722439488
             le_variance =       0.321174323420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216691896598        initial  <--
     3.8147e+03     3.8147e+04             7.5053e-08       -17.216691896265
     1.5259e+04     1.5259e+05             1.8764e-08       -17.216691896431
     6.1035e+04     6.1035e+05             4.6909e-09       -17.216691896577

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4335
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408115e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536961e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.309585
====================================================
  Execution time = 2.0804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3362e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333610390743
                                         uncertainty =       0.007218538138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333610390743
                                         uncertainty =       0.007218538138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408422225
  error estimate for blocks of size 2^( 2) =       0.000417780073
  error estimate for blocks of size 2^( 3) =       0.000425996276
  error estimate for blocks of size 2^( 4) =       0.000431742469
  error estimate for blocks of size 2^( 5) =       0.000436288527
  error estimate for blocks of size 2^( 6) =       0.000438717907
  error estimate for blocks of size 2^( 7) =       0.000440519249

      target function =                  N/A
              le_mean =     -17.216420654884
             les_mean =     296.738757426642
             stat err =       0.000436817038
             autocorr =       1.143879838758
              std dev =       0.577596249598
             le_variance =       0.333617427549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642065488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420654884       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420654897       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216420654899       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216420654908       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216420654930       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216420654932       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216420654946       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 9.768491e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420654884       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420654887       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216420654888       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216420654893       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216420654866       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216420654817       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216420654989       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.442125e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420654884       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420654884       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216420654885       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216420654825       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216420654312       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216420655094       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216420654814       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 6.105315e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6497e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257132e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408114e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536962e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979154e-01 1 1  ON 24
 eO_5                 3.141657e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2789
    reference variance = 0.235494
====================================================
  Execution time = 1.9760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2244e-01
  Total weights = 2.0000e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119777
                                         uncertainty =       0.003726446123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119777
                                         uncertainty =       0.003726446123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523393
  error estimate for blocks of size 2^( 2) =       0.000410992495
  error estimate for blocks of size 2^( 3) =       0.000419417895
  error estimate for blocks of size 2^( 4) =       0.000425993328
  error estimate for blocks of size 2^( 5) =       0.000430265806
  error estimate for blocks of size 2^( 6) =       0.000434149865
  error estimate for blocks of size 2^( 7) =       0.000435099105

      target function =                  N/A
              le_mean =     -17.216147701128
             les_mean =     296.718183576201
             stat err =       0.000431377026
             autocorr =       1.154229894652
              std dev =       0.567839828080
             le_variance =       0.322442070354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119044
                                         uncertainty =       0.003726446108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119044
                                         uncertainty =       0.003726446108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523393
  error estimate for blocks of size 2^( 2) =       0.000410992495
  error estimate for blocks of size 2^( 3) =       0.000419417895
  error estimate for blocks of size 2^( 4) =       0.000425993327
  error estimate for blocks of size 2^( 5) =       0.000430265806
  error estimate for blocks of size 2^( 6) =       0.000434149864
  error estimate for blocks of size 2^( 7) =       0.000435099104

      target function =                  N/A
              le_mean =     -17.216147701150
             les_mean =     296.718183576228
             stat err =       0.000431377025
             autocorr =       1.154229893996
              std dev =       0.567839827436
             le_variance =       0.322442069622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119411
                                         uncertainty =       0.003726446116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119411
                                         uncertainty =       0.003726446116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523393
  error estimate for blocks of size 2^( 2) =       0.000410992495
  error estimate for blocks of size 2^( 3) =       0.000419417895
  error estimate for blocks of size 2^( 4) =       0.000425993328
  error estimate for blocks of size 2^( 5) =       0.000430265806
  error estimate for blocks of size 2^( 6) =       0.000434149864
  error estimate for blocks of size 2^( 7) =       0.000435099104

      target function =                  N/A
              le_mean =     -17.216147701139
             les_mean =     296.718183576214
             stat err =       0.000431377026
             autocorr =       1.154229894324
              std dev =       0.567839827758
             le_variance =       0.322442069988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119731
                                         uncertainty =       0.003726446122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322553119731
                                         uncertainty =       0.003726446122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523393
  error estimate for blocks of size 2^( 2) =       0.000410992495
  error estimate for blocks of size 2^( 3) =       0.000419417895
  error estimate for blocks of size 2^( 4) =       0.000425993328
  error estimate for blocks of size 2^( 5) =       0.000430265806
  error estimate for blocks of size 2^( 6) =       0.000434149865
  error estimate for blocks of size 2^( 7) =       0.000435099105

      target function =                  N/A
              le_mean =     -17.216147701130
             les_mean =     296.718183576203
             stat err =       0.000431377026
             autocorr =       1.154229894611
              std dev =       0.567839828040
             le_variance =       0.322442070308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216147701128        initial
     3.8147e+04     3.8147e+05             9.7685e-09       -17.216147701150  <--
     1.5259e+05     1.5259e+06             2.4421e-09       -17.216147701139
     6.1035e+05     6.1035e+06             6.1053e-10       -17.216147701130

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.8961e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777390e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089690e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408113e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536962e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853287e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499358e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.374548
====================================================
  Execution time = 2.0021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319226612261
                                         uncertainty =       0.003212737102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319226612261
                                         uncertainty =       0.003212737102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399474532
  error estimate for blocks of size 2^( 2) =       0.000408968832
  error estimate for blocks of size 2^( 3) =       0.000418158251
  error estimate for blocks of size 2^( 4) =       0.000424225188
  error estimate for blocks of size 2^( 5) =       0.000427889139
  error estimate for blocks of size 2^( 6) =       0.000431915020
  error estimate for blocks of size 2^( 7) =       0.000432833464

      target function =                  N/A
              le_mean =     -17.216489156050
             les_mean =     296.726658503593
             stat err =       0.000429215703
             autocorr =       1.154444375153
              std dev =       0.564942300390
             le_variance =       0.319159802770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648915605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489156050       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489156155       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489156189       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489156139       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216489156187       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216489156157       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216489156159       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.962701e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489156050       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489156077       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489156085       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489156087       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216489156084       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216489156062       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216489156107       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 9.906829e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216489156050       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489156057       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489156059       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489156056       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216489156051       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216489155951       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216489156143       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.476713e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5584e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810359e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089691e-02 1 1  ON 11
 ud_2                -1.344563e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408110e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561638e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536962e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278659e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261190e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386844e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618821e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1731
    reference variance = 0.112055
====================================================
  Execution time = 1.9889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2024e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244159117
                                         uncertainty =       0.002871185006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244159117
                                         uncertainty =       0.002871185006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400150826
  error estimate for blocks of size 2^( 2) =       0.000409987260
  error estimate for blocks of size 2^( 3) =       0.000418994997
  error estimate for blocks of size 2^( 4) =       0.000425913646
  error estimate for blocks of size 2^( 5) =       0.000430053794
  error estimate for blocks of size 2^( 6) =       0.000431335935
  error estimate for blocks of size 2^( 7) =       0.000432055159

      target function =                  N/A
              le_mean =     -17.216363061811
             les_mean =     296.723398283640
             stat err =       0.000429839634
             autocorr =       1.153892840466
              std dev =       0.565898725620
             le_variance =       0.320241367659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244158453
                                         uncertainty =       0.002871185019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244158453
                                         uncertainty =       0.002871185019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400150826
  error estimate for blocks of size 2^( 2) =       0.000409987259
  error estimate for blocks of size 2^( 3) =       0.000418994996
  error estimate for blocks of size 2^( 4) =       0.000425913645
  error estimate for blocks of size 2^( 5) =       0.000430053792
  error estimate for blocks of size 2^( 6) =       0.000431335934
  error estimate for blocks of size 2^( 7) =       0.000432055157

      target function =                  N/A
              le_mean =     -17.216363061979
             les_mean =     296.723398288761
             stat err =       0.000429839632
             autocorr =       1.153892834701
              std dev =       0.565898725030
             le_variance =       0.320241366991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244158785
                                         uncertainty =       0.002871185012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244158785
                                         uncertainty =       0.002871185012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400150826
  error estimate for blocks of size 2^( 2) =       0.000409987259
  error estimate for blocks of size 2^( 3) =       0.000418994997
  error estimate for blocks of size 2^( 4) =       0.000425913645
  error estimate for blocks of size 2^( 5) =       0.000430053793
  error estimate for blocks of size 2^( 6) =       0.000431335935
  error estimate for blocks of size 2^( 7) =       0.000432055158

      target function =                  N/A
              le_mean =     -17.216363061895
             les_mean =     296.723398286201
             stat err =       0.000429839633
             autocorr =       1.153892837584
              std dev =       0.565898725325
             le_variance =       0.320241367325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244159076
                                         uncertainty =       0.002871185007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320244159076
                                         uncertainty =       0.002871185007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400150826
  error estimate for blocks of size 2^( 2) =       0.000409987260
  error estimate for blocks of size 2^( 3) =       0.000418994997
  error estimate for blocks of size 2^( 4) =       0.000425913646
  error estimate for blocks of size 2^( 5) =       0.000430053794
  error estimate for blocks of size 2^( 6) =       0.000431335935
  error estimate for blocks of size 2^( 7) =       0.000432055159

      target function =                  N/A
              le_mean =     -17.216363061822
             les_mean =     296.723398283960
             stat err =       0.000429839634
             autocorr =       1.153892840108
              std dev =       0.565898725583
             le_variance =       0.320241367617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216363061811        initial
     9.5367e+03     9.5367e+04             3.9627e-08       -17.216363061979  <--
     3.8147e+04     3.8147e+05             9.9068e-09       -17.216363061895
     1.5259e+05     1.5259e+06             2.4767e-09       -17.216363061822

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9076e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2783
    reference variance = 0.224018
====================================================
  Execution time = 2.0030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1857e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318660933404
                                         uncertainty =       0.003020906094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318660933404
                                         uncertainty =       0.003020906094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399106907
  error estimate for blocks of size 2^( 2) =       0.000408692359
  error estimate for blocks of size 2^( 3) =       0.000417712605
  error estimate for blocks of size 2^( 4) =       0.000424100695
  error estimate for blocks of size 2^( 5) =       0.000428591236
  error estimate for blocks of size 2^( 6) =       0.000430043618
  error estimate for blocks of size 2^( 7) =       0.000428605876

      target function =                  N/A
              le_mean =     -17.216305416893
             les_mean =     296.719744694639
             stat err =       0.000427835356
             autocorr =       1.149145064838
              std dev =       0.564422400485
             le_variance =       0.318572646169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630541689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305416893       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305417174       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216305417651       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216305417968       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216305417959       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216305417961       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216305417937       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.242044e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305416893       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305416964       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216305417083       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216305417162       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216305417160       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216305417161       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216305417152       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.105193e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305416893       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305416911       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216305416941       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216305416961       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216305416960       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216305416980       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216305416964       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.763035e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5599e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810362e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942881e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385149e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257134e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172743e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556994e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408097e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536965e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665663e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840234e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261192e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407570e-02 1 1  ON 42
eH2_3                -2.758519e-02 1 1  ON 43
eH2_4                 1.792701e-02 1 1  ON 44
eH2_5                 3.386842e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618823e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.169146
====================================================
  Execution time = 2.0070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1860e-01
  Total weights = 2.0000e+06
  Execution time = 1.8474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642055328
                                         uncertainty =       0.002897517471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642055328
                                         uncertainty =       0.002897517471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399126686
  error estimate for blocks of size 2^( 2) =       0.000408910148
  error estimate for blocks of size 2^( 3) =       0.000417920248
  error estimate for blocks of size 2^( 4) =       0.000424148192
  error estimate for blocks of size 2^( 5) =       0.000428384428
  error estimate for blocks of size 2^( 6) =       0.000431676105
  error estimate for blocks of size 2^( 7) =       0.000432259734

      target function =                  N/A
              le_mean =     -17.216351195824
             les_mean =     296.721352561083
             stat err =       0.000429117115
             autocorr =       1.155926288050
              std dev =       0.564450371974
             le_variance =       0.318604222421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642076956
                                         uncertainty =       0.002897517657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642076956
                                         uncertainty =       0.002897517657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399126699
  error estimate for blocks of size 2^( 2) =       0.000408910160
  error estimate for blocks of size 2^( 3) =       0.000417920260
  error estimate for blocks of size 2^( 4) =       0.000424148202
  error estimate for blocks of size 2^( 5) =       0.000428384438
  error estimate for blocks of size 2^( 6) =       0.000431676115
  error estimate for blocks of size 2^( 7) =       0.000432259743

      target function =                  N/A
              le_mean =     -17.216351195735
             les_mean =     296.721352579658
             stat err =       0.000429117124
             autocorr =       1.155926261124
              std dev =       0.564450391147
             le_variance =       0.318604244066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642066143
                                         uncertainty =       0.002897517564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642066143
                                         uncertainty =       0.002897517564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399126692
  error estimate for blocks of size 2^( 2) =       0.000408910154
  error estimate for blocks of size 2^( 3) =       0.000417920254
  error estimate for blocks of size 2^( 4) =       0.000424148197
  error estimate for blocks of size 2^( 5) =       0.000428384433
  error estimate for blocks of size 2^( 6) =       0.000431676110
  error estimate for blocks of size 2^( 7) =       0.000432259739

      target function =                  N/A
              le_mean =     -17.216351195780
             les_mean =     296.721352570371
             stat err =       0.000429117119
             autocorr =       1.155926274580
              std dev =       0.564450381561
             le_variance =       0.318604233245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642056680
                                         uncertainty =       0.002897517483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318642056680
                                         uncertainty =       0.002897517483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399126687
  error estimate for blocks of size 2^( 2) =       0.000408910149
  error estimate for blocks of size 2^( 3) =       0.000417920249
  error estimate for blocks of size 2^( 4) =       0.000424148192
  error estimate for blocks of size 2^( 5) =       0.000428384428
  error estimate for blocks of size 2^( 6) =       0.000431676105
  error estimate for blocks of size 2^( 7) =       0.000432259735

      target function =                  N/A
              le_mean =     -17.216351195819
             les_mean =     296.721352562244
             stat err =       0.000429117115
             autocorr =       1.155926286364
              std dev =       0.564450373172
             le_variance =       0.318604223774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216351195824        initial  <--
     2.3842e+03     2.3842e+04             1.2420e-07       -17.216351195735
     9.5367e+03     9.5367e+04             3.1052e-08       -17.216351195780
     3.8147e+04     3.8147e+05             7.7630e-09       -17.216351195819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3505
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1689
    reference variance = 0.382047
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322927688588
                                         uncertainty =       0.003685664857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322927688588
                                         uncertainty =       0.003685664857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401886410
  error estimate for blocks of size 2^( 2) =       0.000411583312
  error estimate for blocks of size 2^( 3) =       0.000419790810
  error estimate for blocks of size 2^( 4) =       0.000426488722
  error estimate for blocks of size 2^( 5) =       0.000430324444
  error estimate for blocks of size 2^( 6) =       0.000430874171
  error estimate for blocks of size 2^( 7) =       0.000432097696

      target function =                  N/A
              le_mean =     -17.216508740720
             les_mean =     296.731198430422
             stat err =       0.000429946258
             autocorr =       1.144515574773
              std dev =       0.568353211180
             le_variance =       0.323025372659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650874072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508740720       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508740713       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508740736       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508740715       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508740733       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508740758       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508740762       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.120444e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508740720       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508740718       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508740724       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508740718       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508740719       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508740726       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508740712       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.801113e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508740720       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508740719       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508740721       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508740761       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508740810       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508740908       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508740518       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.002784e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5767e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257134e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408102e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1557
    reference variance = 0.355958
====================================================
  Execution time = 1.9754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3200e-01
  Total weights = 2.0000e+06
  Execution time = 1.8480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670505966
                                         uncertainty =       0.012339736761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670505966
                                         uncertainty =       0.012339736761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407428042
  error estimate for blocks of size 2^( 2) =       0.000416482201
  error estimate for blocks of size 2^( 3) =       0.000425063827
  error estimate for blocks of size 2^( 4) =       0.000431105873
  error estimate for blocks of size 2^( 5) =       0.000434789960
  error estimate for blocks of size 2^( 6) =       0.000436614822
  error estimate for blocks of size 2^( 7) =       0.000438022763

      target function =                  N/A
              le_mean =     -17.216555017147
             les_mean =     296.741761710917
             stat err =       0.000435133354
             autocorr =       1.140625078038
              std dev =       0.576190262388
             le_variance =       0.331995218471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670508168
                                         uncertainty =       0.012339737055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670508168
                                         uncertainty =       0.012339737055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407428043
  error estimate for blocks of size 2^( 2) =       0.000416482202
  error estimate for blocks of size 2^( 3) =       0.000425063828
  error estimate for blocks of size 2^( 4) =       0.000431105874
  error estimate for blocks of size 2^( 5) =       0.000434789961
  error estimate for blocks of size 2^( 6) =       0.000436614823
  error estimate for blocks of size 2^( 7) =       0.000438022763

      target function =                  N/A
              le_mean =     -17.216555017142
             les_mean =     296.741761712943
             stat err =       0.000435133355
             autocorr =       1.140625075690
              std dev =       0.576190264300
             le_variance =       0.331995220674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670507067
                                         uncertainty =       0.012339736908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670507067
                                         uncertainty =       0.012339736908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407428042
  error estimate for blocks of size 2^( 2) =       0.000416482201
  error estimate for blocks of size 2^( 3) =       0.000425063828
  error estimate for blocks of size 2^( 4) =       0.000431105873
  error estimate for blocks of size 2^( 5) =       0.000434789960
  error estimate for blocks of size 2^( 6) =       0.000436614823
  error estimate for blocks of size 2^( 7) =       0.000438022763

      target function =                  N/A
              le_mean =     -17.216555017144
             les_mean =     296.741761711930
             stat err =       0.000435133355
             autocorr =       1.140625076866
              std dev =       0.576190263344
             le_variance =       0.331995219573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670506104
                                         uncertainty =       0.012339736779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331670506104
                                         uncertainty =       0.012339736779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407428042
  error estimate for blocks of size 2^( 2) =       0.000416482201
  error estimate for blocks of size 2^( 3) =       0.000425063827
  error estimate for blocks of size 2^( 4) =       0.000431105873
  error estimate for blocks of size 2^( 5) =       0.000434789960
  error estimate for blocks of size 2^( 6) =       0.000436614822
  error estimate for blocks of size 2^( 7) =       0.000438022763

      target function =                  N/A
              le_mean =     -17.216555017147
             les_mean =     296.741761711043
             stat err =       0.000435133354
             autocorr =       1.140625077891
              std dev =       0.576190262508
             le_variance =       0.331995218609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216555017147        initial  <--
     2.3842e+04     2.3842e+05             1.1204e-08       -17.216555017142
     9.5367e+04     9.5367e+05             2.8011e-09       -17.216555017144
     3.8147e+05     3.8147e+06             7.0028e-10       -17.216555017147

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0168
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1528
    reference variance = 0.342139
====================================================
  Execution time = 2.0449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324125172288
                                         uncertainty =       0.004350183894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324125172288
                                         uncertainty =       0.004350183894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501321
  error estimate for blocks of size 2^( 2) =       0.000412481390
  error estimate for blocks of size 2^( 3) =       0.000420912496
  error estimate for blocks of size 2^( 4) =       0.000427026512
  error estimate for blocks of size 2^( 5) =       0.000429941544
  error estimate for blocks of size 2^( 6) =       0.000431831598
  error estimate for blocks of size 2^( 7) =       0.000431913262

      target function =                  N/A
              le_mean =     -17.216809551516
             les_mean =     296.742545598577
             stat err =       0.000430178229
             autocorr =       1.142252806313
              std dev =       0.569222827555
             le_variance =       0.324014627410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680955152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809551516       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809551517       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809551517       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809551550       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216809551501       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216809551515       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216809551447       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.600568e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809551516       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809551516       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809551516       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809551214       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216809551342       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216809551132       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216809551150       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 4.001422e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809551516       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809551516       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809551516       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809551395       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216809551753       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216809551717       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216809552172       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.000356e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5987e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2153
    reference variance = 0.307777
====================================================
  Execution time = 2.2145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.0000e+06
  Execution time = 1.8516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436499108
                                         uncertainty =       0.003860985540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436499108
                                         uncertainty =       0.003860985540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484914
  error estimate for blocks of size 2^( 2) =       0.000410786556
  error estimate for blocks of size 2^( 3) =       0.000419694067
  error estimate for blocks of size 2^( 4) =       0.000425145446
  error estimate for blocks of size 2^( 5) =       0.000429251812
  error estimate for blocks of size 2^( 6) =       0.000431927153
  error estimate for blocks of size 2^( 7) =       0.000432740535

      target function =                  N/A
              le_mean =     -17.216481537863
             les_mean =     296.729616654834
             stat err =       0.000429766237
             autocorr =       1.145845661372
              std dev =       0.567785410563
             le_variance =       0.322380272449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436498672
                                         uncertainty =       0.003860985536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436498672
                                         uncertainty =       0.003860985536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484914
  error estimate for blocks of size 2^( 2) =       0.000410786556
  error estimate for blocks of size 2^( 3) =       0.000419694067
  error estimate for blocks of size 2^( 4) =       0.000425145446
  error estimate for blocks of size 2^( 5) =       0.000429251812
  error estimate for blocks of size 2^( 6) =       0.000431927153
  error estimate for blocks of size 2^( 7) =       0.000432740535

      target function =                  N/A
              le_mean =     -17.216481537858
             les_mean =     296.729616654232
             stat err =       0.000429766237
             autocorr =       1.145845661619
              std dev =       0.567785410180
             le_variance =       0.322380272013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436498890
                                         uncertainty =       0.003860985538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436498890
                                         uncertainty =       0.003860985538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484914
  error estimate for blocks of size 2^( 2) =       0.000410786556
  error estimate for blocks of size 2^( 3) =       0.000419694067
  error estimate for blocks of size 2^( 4) =       0.000425145446
  error estimate for blocks of size 2^( 5) =       0.000429251812
  error estimate for blocks of size 2^( 6) =       0.000431927153
  error estimate for blocks of size 2^( 7) =       0.000432740535

      target function =                  N/A
              le_mean =     -17.216481537861
             les_mean =     296.729616654533
             stat err =       0.000429766237
             autocorr =       1.145845661496
              std dev =       0.567785410371
             le_variance =       0.322380272231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436499081
                                         uncertainty =       0.003860985540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322436499081
                                         uncertainty =       0.003860985540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484914
  error estimate for blocks of size 2^( 2) =       0.000410786556
  error estimate for blocks of size 2^( 3) =       0.000419694067
  error estimate for blocks of size 2^( 4) =       0.000425145446
  error estimate for blocks of size 2^( 5) =       0.000429251812
  error estimate for blocks of size 2^( 6) =       0.000431927153
  error estimate for blocks of size 2^( 7) =       0.000432740535

      target function =                  N/A
              le_mean =     -17.216481537863
             les_mean =     296.729616654796
             stat err =       0.000429766237
             autocorr =       1.145845661399
              std dev =       0.567785410539
             le_variance =       0.322380272421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216481537863        initial  <--
     2.3842e+05     2.3842e+06             1.6006e-09       -17.216481537858
     9.5367e+05     9.5367e+06             4.0014e-10       -17.216481537861
     3.8147e+06     3.8147e+07             1.0004e-10       -17.216481537863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.9878
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.205129
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3888e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338925603988
                                         uncertainty =       0.016268569170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338925603988
                                         uncertainty =       0.016268569170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411632640
  error estimate for blocks of size 2^( 2) =       0.000421053294
  error estimate for blocks of size 2^( 3) =       0.000429337282
  error estimate for blocks of size 2^( 4) =       0.000436057029
  error estimate for blocks of size 2^( 5) =       0.000439828258
  error estimate for blocks of size 2^( 6) =       0.000440519640
  error estimate for blocks of size 2^( 7) =       0.000443414050

      target function =                  N/A
              le_mean =     -17.216926372406
             les_mean =     296.761436404491
             stat err =       0.000439954744
             autocorr =       1.142342674991
              std dev =       0.582136462604
             le_variance =       0.338882861094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692637241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926372406       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926372406       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926372406       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216926372406       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216926371525       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216926371530       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216926372728       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.308087e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926372406       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926372406       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926372406       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216926372898       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216926373102       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216926380710       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216926371003       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.270192e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926372406       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926372406       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926372406       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216926372406       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216926370867       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216926365000       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216926368343       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 8.175751e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6069e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.190374
====================================================
  Execution time = 1.9875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2433e-01
  Total weights = 2.0000e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391854
                                         uncertainty =       0.004042915390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391854
                                         uncertainty =       0.004042915390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402699214
  error estimate for blocks of size 2^( 2) =       0.000412368482
  error estimate for blocks of size 2^( 3) =       0.000420449200
  error estimate for blocks of size 2^( 4) =       0.000426756623
  error estimate for blocks of size 2^( 5) =       0.000430663282
  error estimate for blocks of size 2^( 6) =       0.000433552704
  error estimate for blocks of size 2^( 7) =       0.000432992044

      target function =                  N/A
              le_mean =     -17.215798759863
             les_mean =     296.708060092300
             stat err =       0.000430991163
             autocorr =       1.145447442456
              std dev =       0.569502690400
             le_variance =       0.324333314372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391870
                                         uncertainty =       0.004042915389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391870
                                         uncertainty =       0.004042915389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402699214
  error estimate for blocks of size 2^( 2) =       0.000412368482
  error estimate for blocks of size 2^( 3) =       0.000420449200
  error estimate for blocks of size 2^( 4) =       0.000426756623
  error estimate for blocks of size 2^( 5) =       0.000430663282
  error estimate for blocks of size 2^( 6) =       0.000433552704
  error estimate for blocks of size 2^( 7) =       0.000432992044

      target function =                  N/A
              le_mean =     -17.215798759863
             les_mean =     296.708060092314
             stat err =       0.000430991163
             autocorr =       1.145447442440
              std dev =       0.569502690414
             le_variance =       0.324333314389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391862
                                         uncertainty =       0.004042915389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391862
                                         uncertainty =       0.004042915389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402699214
  error estimate for blocks of size 2^( 2) =       0.000412368482
  error estimate for blocks of size 2^( 3) =       0.000420449200
  error estimate for blocks of size 2^( 4) =       0.000426756623
  error estimate for blocks of size 2^( 5) =       0.000430663282
  error estimate for blocks of size 2^( 6) =       0.000433552704
  error estimate for blocks of size 2^( 7) =       0.000432992044

      target function =                  N/A
              le_mean =     -17.215798759863
             les_mean =     296.708060092307
             stat err =       0.000430991163
             autocorr =       1.145447442459
              std dev =       0.569502690407
             le_variance =       0.324333314380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391855
                                         uncertainty =       0.004042915390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324312391855
                                         uncertainty =       0.004042915390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402699214
  error estimate for blocks of size 2^( 2) =       0.000412368482
  error estimate for blocks of size 2^( 3) =       0.000420449200
  error estimate for blocks of size 2^( 4) =       0.000426756623
  error estimate for blocks of size 2^( 5) =       0.000430663282
  error estimate for blocks of size 2^( 6) =       0.000433552704
  error estimate for blocks of size 2^( 7) =       0.000432992044

      target function =                  N/A
              le_mean =     -17.215798759863
             les_mean =     296.708060092301
             stat err =       0.000430991163
             autocorr =       1.145447442452
              std dev =       0.569502690401
             le_variance =       0.324333314374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215798759863        initial  <--
     2.3842e+06     2.3842e+07             1.3081e-10       -17.215798759863
     9.5367e+06     9.5367e+07             3.2702e-11       -17.215798759863
     3.8147e+07     3.8147e+08             8.1758e-12       -17.215798759863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1489
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1915
    reference variance = 0.303287
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1896e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319008120344
                                         uncertainty =       0.002825854632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319008120344
                                         uncertainty =       0.002825854632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399348757
  error estimate for blocks of size 2^( 2) =       0.000409075136
  error estimate for blocks of size 2^( 3) =       0.000417772508
  error estimate for blocks of size 2^( 4) =       0.000423661883
  error estimate for blocks of size 2^( 5) =       0.000426910452
  error estimate for blocks of size 2^( 6) =       0.000429160006
  error estimate for blocks of size 2^( 7) =       0.000430631449

      target function =                  N/A
              le_mean =     -17.215687955216
             les_mean =     296.698870470609
             stat err =       0.000427590947
             autocorr =       1.146442642101
              std dev =       0.564764427635
             le_variance =       0.318958858722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721568795522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687955216       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687955216       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687955216       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215687955216       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215687942557       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215687943101       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215687945553       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215687961571       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.496639e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687955216       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687955216       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687955216       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215687953190       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215687958661       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215687971028       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215687965046       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215687963561       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.741389e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687955216       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687955216       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687955216       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215687955216       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215687832481       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215687858292       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215688115171       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215689231434       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 9.352109e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5899e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.0968
    reference variance = 0.236794
====================================================
  Execution time = 1.9786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369994
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369994
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987494
  error estimate for blocks of size 2^( 2) =       0.000413630935
  error estimate for blocks of size 2^( 3) =       0.000422437463
  error estimate for blocks of size 2^( 4) =       0.000428136635
  error estimate for blocks of size 2^( 5) =       0.000433078218
  error estimate for blocks of size 2^( 6) =       0.000434998632
  error estimate for blocks of size 2^( 7) =       0.000436291656

      target function =                  N/A
              le_mean =     -17.216162540422
             les_mean =     296.722664245889
             stat err =       0.000433126285
             autocorr =       1.149458347487
              std dev =       0.571324593250
             le_variance =       0.326411790852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350370003
                                         uncertainty =       0.005361530434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350370003
                                         uncertainty =       0.005361530434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987494
  error estimate for blocks of size 2^( 2) =       0.000413630935
  error estimate for blocks of size 2^( 3) =       0.000422437463
  error estimate for blocks of size 2^( 4) =       0.000428136635
  error estimate for blocks of size 2^( 5) =       0.000433078218
  error estimate for blocks of size 2^( 6) =       0.000434998632
  error estimate for blocks of size 2^( 7) =       0.000436291656

      target function =                  N/A
              le_mean =     -17.216162540422
             les_mean =     296.722664245901
             stat err =       0.000433126285
             autocorr =       1.149458347484
              std dev =       0.571324593258
             le_variance =       0.326411790861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369998
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369998
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987494
  error estimate for blocks of size 2^( 2) =       0.000413630935
  error estimate for blocks of size 2^( 3) =       0.000422437463
  error estimate for blocks of size 2^( 4) =       0.000428136635
  error estimate for blocks of size 2^( 5) =       0.000433078218
  error estimate for blocks of size 2^( 6) =       0.000434998632
  error estimate for blocks of size 2^( 7) =       0.000436291656

      target function =                  N/A
              le_mean =     -17.216162540422
             les_mean =     296.722664245895
             stat err =       0.000433126285
             autocorr =       1.149458347478
              std dev =       0.571324593254
             le_variance =       0.326411790857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369994
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326350369994
                                         uncertainty =       0.005361530433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403987494
  error estimate for blocks of size 2^( 2) =       0.000413630935
  error estimate for blocks of size 2^( 3) =       0.000422437463
  error estimate for blocks of size 2^( 4) =       0.000428136635
  error estimate for blocks of size 2^( 5) =       0.000433078218
  error estimate for blocks of size 2^( 6) =       0.000434998632
  error estimate for blocks of size 2^( 7) =       0.000436291656

      target function =                  N/A
              le_mean =     -17.216162540422
             les_mean =     296.722664245889
             stat err =       0.000433126285
             autocorr =       1.149458347491
              std dev =       0.571324593250
             le_variance =       0.326411790853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216162540422        initial
     2.3842e+07     2.3842e+08             1.4966e-11       -17.216162540422  <--
     9.5367e+07     9.5367e+08             3.7414e-12       -17.216162540422
     3.8147e+08     3.8147e+09             9.3521e-13       -17.216162540422

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 2.9026e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.193266
====================================================
  Execution time = 2.0116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322291225432
                                         uncertainty =       0.003231249062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322291225432
                                         uncertainty =       0.003231249062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401419172
  error estimate for blocks of size 2^( 2) =       0.000411344780
  error estimate for blocks of size 2^( 3) =       0.000419905345
  error estimate for blocks of size 2^( 4) =       0.000426804286
  error estimate for blocks of size 2^( 5) =       0.000430553588
  error estimate for blocks of size 2^( 6) =       0.000433279128
  error estimate for blocks of size 2^( 7) =       0.000435293763

      target function =                  N/A
              le_mean =     -17.216530405901
             les_mean =     296.731193759201
             stat err =       0.000431482691
             autocorr =       1.155395139781
              std dev =       0.567692437006
             le_variance =       0.322274703034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653040590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530405901       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530405901       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530405901       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530405901       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216530405901       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216530406455       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216530414568       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 5.491686e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530405901       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530405901       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530405901       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530405710       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216530406740       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216530393764       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216530389784       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.372911e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216530405901       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216530405901       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216530405901       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216530405901       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216530405901       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216530405835       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216530405089       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 3.432317e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5740e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.198
    reference variance = 0.139414
====================================================
  Execution time = 1.9598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2601e-01
  Total weights = 2.0000e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981729
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981729
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403740485
  error estimate for blocks of size 2^( 2) =       0.000413316766
  error estimate for blocks of size 2^( 3) =       0.000421614653
  error estimate for blocks of size 2^( 4) =       0.000427781732
  error estimate for blocks of size 2^( 5) =       0.000431901515
  error estimate for blocks of size 2^( 6) =       0.000434890002
  error estimate for blocks of size 2^( 7) =       0.000435012110

      target function =                  N/A
              le_mean =     -17.216233405918
             les_mean =     296.724705282891
             stat err =       0.000432396340
             autocorr =       1.146989433171
              std dev =       0.570975269920
             le_variance =       0.326012758860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981761
                                         uncertainty =       0.005117888463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981761
                                         uncertainty =       0.005117888463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403740485
  error estimate for blocks of size 2^( 2) =       0.000413316766
  error estimate for blocks of size 2^( 3) =       0.000421614653
  error estimate for blocks of size 2^( 4) =       0.000427781732
  error estimate for blocks of size 2^( 5) =       0.000431901515
  error estimate for blocks of size 2^( 6) =       0.000434890002
  error estimate for blocks of size 2^( 7) =       0.000435012110

      target function =                  N/A
              le_mean =     -17.216233405918
             les_mean =     296.724705282925
             stat err =       0.000432396340
             autocorr =       1.146989433150
              std dev =       0.570975269947
             le_variance =       0.326012758891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981745
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981745
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403740485
  error estimate for blocks of size 2^( 2) =       0.000413316766
  error estimate for blocks of size 2^( 3) =       0.000421614653
  error estimate for blocks of size 2^( 4) =       0.000427781732
  error estimate for blocks of size 2^( 5) =       0.000431901515
  error estimate for blocks of size 2^( 6) =       0.000434890002
  error estimate for blocks of size 2^( 7) =       0.000435012110

      target function =                  N/A
              le_mean =     -17.216233405918
             les_mean =     296.724705282908
             stat err =       0.000432396340
             autocorr =       1.146989433151
              std dev =       0.570975269934
             le_variance =       0.326012758876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981731
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326136981731
                                         uncertainty =       0.005117888462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403740485
  error estimate for blocks of size 2^( 2) =       0.000413316766
  error estimate for blocks of size 2^( 3) =       0.000421614653
  error estimate for blocks of size 2^( 4) =       0.000427781732
  error estimate for blocks of size 2^( 5) =       0.000431901515
  error estimate for blocks of size 2^( 6) =       0.000434890002
  error estimate for blocks of size 2^( 7) =       0.000435012110

      target function =                  N/A
              le_mean =     -17.216233405918
             les_mean =     296.724705282893
             stat err =       0.000432396340
             autocorr =       1.146989433164
              std dev =       0.570975269922
             le_variance =       0.326012758862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216233405918        initial
     5.9605e+06     5.9605e+07             5.4917e-11       -17.216233405918  <--
     2.3842e+07     2.3842e+08             1.3729e-11       -17.216233405918
     9.5367e+07     9.5367e+08             3.4323e-12       -17.216233405918

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.8783e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.342543
====================================================
  Execution time = 2.0222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2857e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328085647765
                                         uncertainty =       0.007089607680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328085647765
                                         uncertainty =       0.007089607680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405321436
  error estimate for blocks of size 2^( 2) =       0.000415071285
  error estimate for blocks of size 2^( 3) =       0.000424446844
  error estimate for blocks of size 2^( 4) =       0.000431130501
  error estimate for blocks of size 2^( 5) =       0.000434357543
  error estimate for blocks of size 2^( 6) =       0.000436043003
  error estimate for blocks of size 2^( 7) =       0.000436847695

      target function =                  N/A
              le_mean =     -17.217184451918
             les_mean =     296.760011219916
             stat err =       0.000434594685
             autocorr =       1.149660676502
              std dev =       0.573211071803
             le_variance =       0.328570932838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718445192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184451918       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184451918       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184451917       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184451918       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184451821       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184451978       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184451903       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217184450990       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.752874e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184451918       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184451918       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184451918       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184451918       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184451531       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184451146       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184450517       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217184450800       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 6.882195e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184451918       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184451918       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184451918       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184456539       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184450576       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184451863       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184452559       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217184448771       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.720543e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5813e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.3151
    reference variance = 0.227522
====================================================
  Execution time = 1.9638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2396e-01
  Total weights = 2.0000e+06
  Execution time = 1.8309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309324
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309324
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402466918
  error estimate for blocks of size 2^( 2) =       0.000412299163
  error estimate for blocks of size 2^( 3) =       0.000420835807
  error estimate for blocks of size 2^( 4) =       0.000426978122
  error estimate for blocks of size 2^( 5) =       0.000431242282
  error estimate for blocks of size 2^( 6) =       0.000433766552
  error estimate for blocks of size 2^( 7) =       0.000433666374

      target function =                  N/A
              le_mean =     -17.216880081967
             les_mean =     296.744918835392
             stat err =       0.000431413332
             autocorr =       1.149017778512
              std dev =       0.569174174162
             le_variance =       0.323959240533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309353
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309353
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402466918
  error estimate for blocks of size 2^( 2) =       0.000412299163
  error estimate for blocks of size 2^( 3) =       0.000420835807
  error estimate for blocks of size 2^( 4) =       0.000426978122
  error estimate for blocks of size 2^( 5) =       0.000431242282
  error estimate for blocks of size 2^( 6) =       0.000433766552
  error estimate for blocks of size 2^( 7) =       0.000433666374

      target function =                  N/A
              le_mean =     -17.216880081968
             les_mean =     296.744918835437
             stat err =       0.000431413332
             autocorr =       1.149017778467
              std dev =       0.569174174187
             le_variance =       0.323959240561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309338
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309338
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402466918
  error estimate for blocks of size 2^( 2) =       0.000412299163
  error estimate for blocks of size 2^( 3) =       0.000420835807
  error estimate for blocks of size 2^( 4) =       0.000426978122
  error estimate for blocks of size 2^( 5) =       0.000431242282
  error estimate for blocks of size 2^( 6) =       0.000433766552
  error estimate for blocks of size 2^( 7) =       0.000433666374

      target function =                  N/A
              le_mean =     -17.216880081967
             les_mean =     296.744918835415
             stat err =       0.000431413332
             autocorr =       1.149017778488
              std dev =       0.569174174174
             le_variance =       0.323959240547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309326
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768309326
                                         uncertainty =       0.003972606922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402466918
  error estimate for blocks of size 2^( 2) =       0.000412299163
  error estimate for blocks of size 2^( 3) =       0.000420835807
  error estimate for blocks of size 2^( 4) =       0.000426978122
  error estimate for blocks of size 2^( 5) =       0.000431242282
  error estimate for blocks of size 2^( 6) =       0.000433766552
  error estimate for blocks of size 2^( 7) =       0.000433666374

      target function =                  N/A
              le_mean =     -17.216880081967
             les_mean =     296.744918835395
             stat err =       0.000431413332
             autocorr =       1.149017778504
              std dev =       0.569174174163
             le_variance =       0.323959240535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216880081967        initial
     1.4901e+06     1.4901e+07             2.7529e-10       -17.216880081968  <--
     5.9605e+06     5.9605e+07             6.8822e-11       -17.216880081967
     2.3842e+07     2.3842e+08             1.7205e-11       -17.216880081967

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 2.8836e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1814
    reference variance = 0.159882
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325784447945
                                         uncertainty =       0.005450821800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325784447945
                                         uncertainty =       0.005450821800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403580274
  error estimate for blocks of size 2^( 2) =       0.000413140789
  error estimate for blocks of size 2^( 3) =       0.000421982461
  error estimate for blocks of size 2^( 4) =       0.000427734550
  error estimate for blocks of size 2^( 5) =       0.000430700347
  error estimate for blocks of size 2^( 6) =       0.000434400495
  error estimate for blocks of size 2^( 7) =       0.000434893296

      target function =                  N/A
              le_mean =     -17.216607643177
             les_mean =     296.737332652088
             stat err =       0.000431932172
             autocorr =       1.145437095454
              std dev =       0.570748697646
             le_variance =       0.325754075865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660764318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607643177       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607643177       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607643176       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607643154       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607643198       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607643107       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607643359       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.254149e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607643177       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607643177       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607643177       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607643177       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607643797       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607642253       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607644395       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.135373e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216607643177       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607643177       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607643177       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607643177       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216607639787       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216607642962       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216607641834       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 7.838450e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5599e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.392366
====================================================
  Execution time = 1.9549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1291e-01
  Total weights = 2.0000e+06
  Execution time = 2.2795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616269
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616269
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395543842
  error estimate for blocks of size 2^( 2) =       0.000404995157
  error estimate for blocks of size 2^( 3) =       0.000413588604
  error estimate for blocks of size 2^( 4) =       0.000420151962
  error estimate for blocks of size 2^( 5) =       0.000423778624
  error estimate for blocks of size 2^( 6) =       0.000425048728
  error estimate for blocks of size 2^( 7) =       0.000427245811

      target function =                  N/A
              le_mean =     -17.215580561352
             les_mean =     296.689123770568
             stat err =       0.000424056282
             autocorr =       1.149364410453
              std dev =       0.559383466516
             le_variance =       0.312909862611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616404
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616404
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395543843
  error estimate for blocks of size 2^( 2) =       0.000404995157
  error estimate for blocks of size 2^( 3) =       0.000413588604
  error estimate for blocks of size 2^( 4) =       0.000420151963
  error estimate for blocks of size 2^( 5) =       0.000423778624
  error estimate for blocks of size 2^( 6) =       0.000425048728
  error estimate for blocks of size 2^( 7) =       0.000427245812

      target function =                  N/A
              le_mean =     -17.215580561349
             les_mean =     296.689123770593
             stat err =       0.000424056282
             autocorr =       1.149364410332
              std dev =       0.559383466636
             le_variance =       0.312909862746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616336
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616336
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395543842
  error estimate for blocks of size 2^( 2) =       0.000404995157
  error estimate for blocks of size 2^( 3) =       0.000413588604
  error estimate for blocks of size 2^( 4) =       0.000420151962
  error estimate for blocks of size 2^( 5) =       0.000423778624
  error estimate for blocks of size 2^( 6) =       0.000425048728
  error estimate for blocks of size 2^( 7) =       0.000427245811

      target function =                  N/A
              le_mean =     -17.215580561351
             les_mean =     296.689123770581
             stat err =       0.000424056282
             autocorr =       1.149364410394
              std dev =       0.559383466576
             le_variance =       0.312909862678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616277
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312976616277
                                         uncertainty =       0.002251377059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395543842
  error estimate for blocks of size 2^( 2) =       0.000404995157
  error estimate for blocks of size 2^( 3) =       0.000413588604
  error estimate for blocks of size 2^( 4) =       0.000420151962
  error estimate for blocks of size 2^( 5) =       0.000423778624
  error estimate for blocks of size 2^( 6) =       0.000425048728
  error estimate for blocks of size 2^( 7) =       0.000427245811

      target function =                  N/A
              le_mean =     -17.215580561352
             les_mean =     296.689123770570
             stat err =       0.000424056282
             autocorr =       1.149364410454
              std dev =       0.559383466523
             le_variance =       0.312909862619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215580561352        initial  <--
     3.7253e+05     3.7253e+06             1.2541e-09       -17.215580561349
     1.4901e+06     1.4901e+07             3.1354e-10       -17.215580561351
     5.9605e+06     5.9605e+07             7.8384e-11       -17.215580561352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8916
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6497e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.3082
    reference variance = 1.69149
====================================================
  Execution time = 1.9983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333093008545
                                         uncertainty =       0.013252618529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333093008545
                                         uncertainty =       0.013252618529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408120626
  error estimate for blocks of size 2^( 2) =       0.000417608967
  error estimate for blocks of size 2^( 3) =       0.000426479901
  error estimate for blocks of size 2^( 4) =       0.000432416040
  error estimate for blocks of size 2^( 5) =       0.000435721625
  error estimate for blocks of size 2^( 6) =       0.000438765179
  error estimate for blocks of size 2^( 7) =       0.000439750730

      target function =                  N/A
              le_mean =     -17.215869105222
             les_mean =     296.719273773113
             stat err =       0.000436663394
             autocorr =       1.144765366585
              std dev =       0.577169725077
             le_variance =       0.333124891545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586910522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869105222       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869105222       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869105222       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869105550       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215869105285       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869103165       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869093674       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 9.211727e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869105222       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869105222       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869105222       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869105222       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215869105727       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869104233       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869112437       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.302939e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869105222       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869105222       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869105222       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869106993       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215869114705       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869071179       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869151185       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 5.757525e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5872e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.242123
====================================================
  Execution time = 1.9518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2392e-01
  Total weights = 2.0000e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875716
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875716
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402441031
  error estimate for blocks of size 2^( 2) =       0.000412102509
  error estimate for blocks of size 2^( 3) =       0.000420446847
  error estimate for blocks of size 2^( 4) =       0.000426922601
  error estimate for blocks of size 2^( 5) =       0.000431177462
  error estimate for blocks of size 2^( 6) =       0.000433552001
  error estimate for blocks of size 2^( 7) =       0.000434721060

      target function =                  N/A
              le_mean =     -17.215924530570
             les_mean =     296.711974846461
             stat err =       0.000431593281
             autocorr =       1.150124472629
              std dev =       0.569137563462
             le_variance =       0.323917566144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875721
                                         uncertainty =       0.004916217000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875721
                                         uncertainty =       0.004916217000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402441031
  error estimate for blocks of size 2^( 2) =       0.000412102509
  error estimate for blocks of size 2^( 3) =       0.000420446847
  error estimate for blocks of size 2^( 4) =       0.000426922601
  error estimate for blocks of size 2^( 5) =       0.000431177462
  error estimate for blocks of size 2^( 6) =       0.000433552001
  error estimate for blocks of size 2^( 7) =       0.000434721060

      target function =                  N/A
              le_mean =     -17.215924530569
             les_mean =     296.711974846452
             stat err =       0.000431593281
             autocorr =       1.150124472623
              std dev =       0.569137563467
             le_variance =       0.323917566149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875718
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875718
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402441031
  error estimate for blocks of size 2^( 2) =       0.000412102509
  error estimate for blocks of size 2^( 3) =       0.000420446847
  error estimate for blocks of size 2^( 4) =       0.000426922601
  error estimate for blocks of size 2^( 5) =       0.000431177462
  error estimate for blocks of size 2^( 6) =       0.000433552001
  error estimate for blocks of size 2^( 7) =       0.000434721060

      target function =                  N/A
              le_mean =     -17.215924530570
             les_mean =     296.711974846457
             stat err =       0.000431593281
             autocorr =       1.150124472610
              std dev =       0.569137563464
             le_variance =       0.323917566146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875716
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324002875716
                                         uncertainty =       0.004916216999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402441031
  error estimate for blocks of size 2^( 2) =       0.000412102509
  error estimate for blocks of size 2^( 3) =       0.000420446847
  error estimate for blocks of size 2^( 4) =       0.000426922601
  error estimate for blocks of size 2^( 5) =       0.000431177462
  error estimate for blocks of size 2^( 6) =       0.000433552001
  error estimate for blocks of size 2^( 7) =       0.000434721060

      target function =                  N/A
              le_mean =     -17.215924530570
             les_mean =     296.711974846461
             stat err =       0.000431593281
             autocorr =       1.150124472630
              std dev =       0.569137563462
             le_variance =       0.323917566144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215924530570        initial  <--
     3.7253e+06     3.7253e+07             9.2117e-11       -17.215924530569
     1.4901e+07     1.4901e+08             2.3029e-11       -17.215924530570
     5.9605e+07     5.9605e+08             5.7575e-12       -17.215924530570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7314
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2491
    reference variance = 0.40591
====================================================
  Execution time = 1.9977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315125422541
                                         uncertainty =       0.002894060396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315125422541
                                         uncertainty =       0.002894060396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397112325
  error estimate for blocks of size 2^( 2) =       0.000406742337
  error estimate for blocks of size 2^( 3) =       0.000415378238
  error estimate for blocks of size 2^( 4) =       0.000421720471
  error estimate for blocks of size 2^( 5) =       0.000425428451
  error estimate for blocks of size 2^( 6) =       0.000427849109
  error estimate for blocks of size 2^( 7) =       0.000428863765

      target function =                  N/A
              le_mean =     -17.216296255970
             les_mean =     296.716253013607
             stat err =       0.000425965449
             autocorr =       1.150593760265
              std dev =       0.561601636375
             le_variance =       0.315396397979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629625597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216296255970       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216296255970       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216296255970       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216296258229       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216296251082       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216296266014       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216296265573       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.031524e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216296255970       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216296255970       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216296255970       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216296255549       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216296255475       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216296189722       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216296260171       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.578879e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216296255970       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216296255970       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216296255970       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216296255970       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216295777732       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216296575097       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216296647529       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 6.447388e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5565e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.267898
====================================================
  Execution time = 2.0166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1628e-01
  Total weights = 2.0000e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517139
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517139
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397669966
  error estimate for blocks of size 2^( 2) =       0.000407241044
  error estimate for blocks of size 2^( 3) =       0.000416443869
  error estimate for blocks of size 2^( 4) =       0.000423102337
  error estimate for blocks of size 2^( 5) =       0.000427368534
  error estimate for blocks of size 2^( 6) =       0.000428970213
  error estimate for blocks of size 2^( 7) =       0.000429338584

      target function =                  N/A
              le_mean =     -17.216879857244
             les_mean =     296.737234664262
             stat err =       0.000427194917
             autocorr =       1.154002019508
              std dev =       0.562390259187
             le_variance =       0.316282803629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517137
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517137
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397669966
  error estimate for blocks of size 2^( 2) =       0.000407241044
  error estimate for blocks of size 2^( 3) =       0.000416443869
  error estimate for blocks of size 2^( 4) =       0.000423102337
  error estimate for blocks of size 2^( 5) =       0.000427368534
  error estimate for blocks of size 2^( 6) =       0.000428970213
  error estimate for blocks of size 2^( 7) =       0.000429338584

      target function =                  N/A
              le_mean =     -17.216879857244
             les_mean =     296.737234664260
             stat err =       0.000427194917
             autocorr =       1.154002019500
              std dev =       0.562390259185
             le_variance =       0.316282803626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517138
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517138
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397669966
  error estimate for blocks of size 2^( 2) =       0.000407241044
  error estimate for blocks of size 2^( 3) =       0.000416443869
  error estimate for blocks of size 2^( 4) =       0.000423102337
  error estimate for blocks of size 2^( 5) =       0.000427368534
  error estimate for blocks of size 2^( 6) =       0.000428970213
  error estimate for blocks of size 2^( 7) =       0.000429338584

      target function =                  N/A
              le_mean =     -17.216879857244
             les_mean =     296.737234664261
             stat err =       0.000427194917
             autocorr =       1.154002019499
              std dev =       0.562390259186
             le_variance =       0.316282803628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517139
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316351517139
                                         uncertainty =       0.003607760103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397669966
  error estimate for blocks of size 2^( 2) =       0.000407241044
  error estimate for blocks of size 2^( 3) =       0.000416443869
  error estimate for blocks of size 2^( 4) =       0.000423102337
  error estimate for blocks of size 2^( 5) =       0.000427368534
  error estimate for blocks of size 2^( 6) =       0.000428970213
  error estimate for blocks of size 2^( 7) =       0.000429338584

      target function =                  N/A
              le_mean =     -17.216879857244
             les_mean =     296.737234664262
             stat err =       0.000427194917
             autocorr =       1.154002019506
              std dev =       0.562390259187
             le_variance =       0.316282803628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216879857244        initial
     3.7253e+07     3.7253e+08             1.0315e-11       -17.216879857244  <--
     1.4901e+08     1.4901e+09             2.5789e-12       -17.216879857244
     5.9605e+08     5.9605e+09             6.4474e-13       -17.216879857244

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 2.9382e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1667
    reference variance = 0.249094
====================================================
  Execution time = 1.9976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319905998938
                                         uncertainty =       0.004306114825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319905998938
                                         uncertainty =       0.004306114825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399881095
  error estimate for blocks of size 2^( 2) =       0.000409855891
  error estimate for blocks of size 2^( 3) =       0.000418398408
  error estimate for blocks of size 2^( 4) =       0.000426047889
  error estimate for blocks of size 2^( 5) =       0.000430247196
  error estimate for blocks of size 2^( 6) =       0.000430559910
  error estimate for blocks of size 2^( 7) =       0.000434779771

      target function =                  N/A
              le_mean =     -17.216044761898
             les_mean =     296.712006864454
             stat err =       0.000430408692
             autocorr =       1.158511422139
              std dev =       0.565517268232
             le_variance =       0.319809780669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604476190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044761898       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044761898       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216044761898       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216044761898       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216044769585       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216044769140       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216044755172       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.935528e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044761898       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044761898       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216044761898       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216044761808       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216044755023       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216044784309       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216044718941       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 9.838732e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216044761898       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216044761898       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216044761898       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216044761898       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216044748283       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216044749568       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216044751197       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 2.459570e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5812e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.404986
====================================================
  Execution time = 1.9597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2430e-01
  Total weights = 2.0000e+06
  Execution time = 1.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813735
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813735
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402677179
  error estimate for blocks of size 2^( 2) =       0.000412079751
  error estimate for blocks of size 2^( 3) =       0.000420844087
  error estimate for blocks of size 2^( 4) =       0.000426777589
  error estimate for blocks of size 2^( 5) =       0.000430104795
  error estimate for blocks of size 2^( 6) =       0.000433844664
  error estimate for blocks of size 2^( 7) =       0.000435053429

      target function =                  N/A
              le_mean =     -17.216191625768
             les_mean =     296.721551754312
             stat err =       0.000431445119
             autocorr =       1.147987305591
              std dev =       0.569471528081
             le_variance =       0.324297821295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813733
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813733
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402677179
  error estimate for blocks of size 2^( 2) =       0.000412079751
  error estimate for blocks of size 2^( 3) =       0.000420844087
  error estimate for blocks of size 2^( 4) =       0.000426777589
  error estimate for blocks of size 2^( 5) =       0.000430104795
  error estimate for blocks of size 2^( 6) =       0.000433844664
  error estimate for blocks of size 2^( 7) =       0.000435053429

      target function =                  N/A
              le_mean =     -17.216191625768
             les_mean =     296.721551754310
             stat err =       0.000431445119
             autocorr =       1.147987305582
              std dev =       0.569471528079
             le_variance =       0.324297821293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813734
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813734
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402677179
  error estimate for blocks of size 2^( 2) =       0.000412079751
  error estimate for blocks of size 2^( 3) =       0.000420844087
  error estimate for blocks of size 2^( 4) =       0.000426777589
  error estimate for blocks of size 2^( 5) =       0.000430104795
  error estimate for blocks of size 2^( 6) =       0.000433844664
  error estimate for blocks of size 2^( 7) =       0.000435053429

      target function =                  N/A
              le_mean =     -17.216191625768
             les_mean =     296.721551754311
             stat err =       0.000431445119
             autocorr =       1.147987305580
              std dev =       0.569471528080
             le_variance =       0.324297821294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813735
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324341813735
                                         uncertainty =       0.004584203045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402677179
  error estimate for blocks of size 2^( 2) =       0.000412079751
  error estimate for blocks of size 2^( 3) =       0.000420844087
  error estimate for blocks of size 2^( 4) =       0.000426777589
  error estimate for blocks of size 2^( 5) =       0.000430104795
  error estimate for blocks of size 2^( 6) =       0.000433844664
  error estimate for blocks of size 2^( 7) =       0.000435053429

      target function =                  N/A
              le_mean =     -17.216191625768
             les_mean =     296.721551754312
             stat err =       0.000431445119
             autocorr =       1.147987305584
              std dev =       0.569471528081
             le_variance =       0.324297821295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216191625768        initial  <--
     9.3132e+06     9.3132e+07             3.9355e-11       -17.216191625768
     3.7253e+07     3.7253e+08             9.8387e-12       -17.216191625768
     1.4901e+08     1.4901e+09             2.4596e-12       -17.216191625768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7846
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.141927
====================================================
  Execution time = 1.9989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322827708760
                                         uncertainty =       0.004474892340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322827708760
                                         uncertainty =       0.004474892340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401706960
  error estimate for blocks of size 2^( 2) =       0.000411320459
  error estimate for blocks of size 2^( 3) =       0.000419442113
  error estimate for blocks of size 2^( 4) =       0.000425038980
  error estimate for blocks of size 2^( 5) =       0.000429627706
  error estimate for blocks of size 2^( 6) =       0.000430517879
  error estimate for blocks of size 2^( 7) =       0.000433564288

      target function =                  N/A
              le_mean =     -17.216417669329
             les_mean =     296.727774167475
             stat err =       0.000429687213
             autocorr =       1.144158381082
              std dev =       0.568099431505
             le_variance =       0.322736964076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641766933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417669329       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216417669329       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216417669329       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216417669329       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216417699837       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216417621555       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216417675728       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.407506e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417669329       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216417669329       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216417669329       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216417665004       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216417719643       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216417560134       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216417547571       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.518280e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417669329       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216417669329       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216417669329       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216417669329       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216418519910       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216416417678       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216417643468       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 2.128768e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5559e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2984
    reference variance = 0.308031
====================================================
  Execution time = 1.9513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2034e-01
  Total weights = 2.0000e+06
  Execution time = 1.8313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033916
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033916
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400211953
  error estimate for blocks of size 2^( 2) =       0.000409722098
  error estimate for blocks of size 2^( 3) =       0.000418079551
  error estimate for blocks of size 2^( 4) =       0.000424066890
  error estimate for blocks of size 2^( 5) =       0.000428549649
  error estimate for blocks of size 2^( 6) =       0.000429924158
  error estimate for blocks of size 2^( 7) =       0.000432925478

      target function =                  N/A
              le_mean =     -17.216420318226
             les_mean =     296.725467629014
             stat err =       0.000428866544
             autocorr =       1.148323424359
              std dev =       0.565985172375
             le_variance =       0.320339215348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033917
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033917
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400211953
  error estimate for blocks of size 2^( 2) =       0.000409722098
  error estimate for blocks of size 2^( 3) =       0.000418079551
  error estimate for blocks of size 2^( 4) =       0.000424066890
  error estimate for blocks of size 2^( 5) =       0.000428549649
  error estimate for blocks of size 2^( 6) =       0.000429924158
  error estimate for blocks of size 2^( 7) =       0.000432925478

      target function =                  N/A
              le_mean =     -17.216420318226
             les_mean =     296.725467629015
             stat err =       0.000428866544
             autocorr =       1.148323424348
              std dev =       0.565985172375
             le_variance =       0.320339215349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033917
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033917
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400211953
  error estimate for blocks of size 2^( 2) =       0.000409722098
  error estimate for blocks of size 2^( 3) =       0.000418079551
  error estimate for blocks of size 2^( 4) =       0.000424066890
  error estimate for blocks of size 2^( 5) =       0.000428549649
  error estimate for blocks of size 2^( 6) =       0.000429924158
  error estimate for blocks of size 2^( 7) =       0.000432925478

      target function =                  N/A
              le_mean =     -17.216420318226
             les_mean =     296.725467629015
             stat err =       0.000428866544
             autocorr =       1.148323424345
              std dev =       0.565985172375
             le_variance =       0.320339215348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033916
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320396033916
                                         uncertainty =       0.002973012682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400211953
  error estimate for blocks of size 2^( 2) =       0.000409722098
  error estimate for blocks of size 2^( 3) =       0.000418079551
  error estimate for blocks of size 2^( 4) =       0.000424066890
  error estimate for blocks of size 2^( 5) =       0.000428549649
  error estimate for blocks of size 2^( 6) =       0.000429924158
  error estimate for blocks of size 2^( 7) =       0.000432925478

      target function =                  N/A
              le_mean =     -17.216420318226
             les_mean =     296.725467629014
             stat err =       0.000428866544
             autocorr =       1.148323424345
              std dev =       0.565985172375
             le_variance =       0.320339215348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420318226        initial
     9.3132e+07     9.3132e+08             3.4075e-12       -17.216420318226  <--
     3.7253e+08     3.7253e+09             8.5183e-13       -17.216420318226
     1.4901e+09     1.4901e+10             2.1288e-13       -17.216420318226

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 2.8737e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.227
    reference variance = 0.206273
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318203319230
                                         uncertainty =       0.003052606368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318203319230
                                         uncertainty =       0.003052606368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398956244
  error estimate for blocks of size 2^( 2) =       0.000408663654
  error estimate for blocks of size 2^( 3) =       0.000417527565
  error estimate for blocks of size 2^( 4) =       0.000424033644
  error estimate for blocks of size 2^( 5) =       0.000427285886
  error estimate for blocks of size 2^( 6) =       0.000429659601
  error estimate for blocks of size 2^( 7) =       0.000429433635

      target function =                  N/A
              le_mean =     -17.216424264860
             les_mean =     296.723596478506
             stat err =       0.000427603191
             autocorr =       1.148765386321
              std dev =       0.564209331722
             le_variance =       0.318332170002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642426486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424264860       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424264860       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216424264860       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216424250124       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216424266754       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216424266154       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216424271248       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.307641e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424264860       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424264860       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216424264860       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216424264860       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216424282750       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216424252924       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216424179894       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 3.269303e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424264860       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424264860       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216424264860       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216424383448       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216424283104       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216424257167       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216424153822       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 8.172600e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5660e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1951
    reference variance = 0.27181
====================================================
  Execution time = 1.9782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2085e-01
  Total weights = 2.0000e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512665
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512665
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533480
  error estimate for blocks of size 2^( 2) =       0.000410119886
  error estimate for blocks of size 2^( 3) =       0.000418728467
  error estimate for blocks of size 2^( 4) =       0.000425098348
  error estimate for blocks of size 2^( 5) =       0.000428916701
  error estimate for blocks of size 2^( 6) =       0.000430746058
  error estimate for blocks of size 2^( 7) =       0.000432188185

      target function =                  N/A
              le_mean =     -17.215035369067
             les_mean =     296.678296735336
             stat err =       0.000429237323
             autocorr =       1.148463790551
              std dev =       0.566439879898
             le_variance =       0.320854137539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512664
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512664
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533480
  error estimate for blocks of size 2^( 2) =       0.000410119886
  error estimate for blocks of size 2^( 3) =       0.000418728467
  error estimate for blocks of size 2^( 4) =       0.000425098348
  error estimate for blocks of size 2^( 5) =       0.000428916701
  error estimate for blocks of size 2^( 6) =       0.000430746058
  error estimate for blocks of size 2^( 7) =       0.000432188185

      target function =                  N/A
              le_mean =     -17.215035369067
             les_mean =     296.678296735333
             stat err =       0.000429237323
             autocorr =       1.148463790559
              std dev =       0.566439879897
             le_variance =       0.320854137538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512664
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512664
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533480
  error estimate for blocks of size 2^( 2) =       0.000410119886
  error estimate for blocks of size 2^( 3) =       0.000418728467
  error estimate for blocks of size 2^( 4) =       0.000425098348
  error estimate for blocks of size 2^( 5) =       0.000428916701
  error estimate for blocks of size 2^( 6) =       0.000430746058
  error estimate for blocks of size 2^( 7) =       0.000432188185

      target function =                  N/A
              le_mean =     -17.215035369067
             les_mean =     296.678296735334
             stat err =       0.000429237323
             autocorr =       1.148463790551
              std dev =       0.566439879898
             le_variance =       0.320854137538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512665
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320792512665
                                         uncertainty =       0.004767339804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533480
  error estimate for blocks of size 2^( 2) =       0.000410119886
  error estimate for blocks of size 2^( 3) =       0.000418728467
  error estimate for blocks of size 2^( 4) =       0.000425098348
  error estimate for blocks of size 2^( 5) =       0.000428916701
  error estimate for blocks of size 2^( 6) =       0.000430746058
  error estimate for blocks of size 2^( 7) =       0.000432188185

      target function =                  N/A
              le_mean =     -17.215035369067
             les_mean =     296.678296735336
             stat err =       0.000429237323
             autocorr =       1.148463790557
              std dev =       0.566439879898
             le_variance =       0.320854137539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215035369067        initial  <--
     2.3283e+07     2.3283e+08             1.3076e-11       -17.215035369067
     9.3132e+07     9.3132e+08             3.2693e-12       -17.215035369067
     3.7253e+08     3.7253e+09             8.1726e-13       -17.215035369067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9948
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.336
    reference variance = 2.97847
====================================================
  Execution time = 2.1730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322313551260
                                         uncertainty =       0.004359508908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322313551260
                                         uncertainty =       0.004359508908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401526662
  error estimate for blocks of size 2^( 2) =       0.000410596844
  error estimate for blocks of size 2^( 3) =       0.000418731745
  error estimate for blocks of size 2^( 4) =       0.000424528140
  error estimate for blocks of size 2^( 5) =       0.000427695935
  error estimate for blocks of size 2^( 6) =       0.000429186048
  error estimate for blocks of size 2^( 7) =       0.000430677904

      target function =                  N/A
              le_mean =     -17.216356697023
             les_mean =     296.725385079135
             stat err =       0.000428022007
             autocorr =       1.136327247514
              std dev =       0.567844451612
             le_variance =       0.322447321227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635669702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216356697023       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216356697023       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216356697023       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216356698774       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216356751951       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216356745129       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216356746663       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.367704e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216356697023       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216356697023       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216356697023       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216356697023       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216357731884       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216356555518       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216356841360       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 3.416554e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216356697023       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216356697023       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216356697023       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216356697023       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216356987087       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216358228376       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216358290643       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 8.530635e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7374e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.200677
====================================================
  Execution time = 2.0662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2236e-01
  Total weights = 2.0000e+06
  Execution time = 2.1658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401470252
  error estimate for blocks of size 2^( 2) =       0.000411330532
  error estimate for blocks of size 2^( 3) =       0.000419573886
  error estimate for blocks of size 2^( 4) =       0.000425338944
  error estimate for blocks of size 2^( 5) =       0.000428995236
  error estimate for blocks of size 2^( 6) =       0.000431548039
  error estimate for blocks of size 2^( 7) =       0.000432855523

      target function =                  N/A
              le_mean =     -17.215954583660
             les_mean =     296.711448791648
             stat err =       0.000429684435
             autocorr =       1.145493169963
              std dev =       0.567764674992
             le_variance =       0.322356726168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401470252
  error estimate for blocks of size 2^( 2) =       0.000411330532
  error estimate for blocks of size 2^( 3) =       0.000419573886
  error estimate for blocks of size 2^( 4) =       0.000425338944
  error estimate for blocks of size 2^( 5) =       0.000428995236
  error estimate for blocks of size 2^( 6) =       0.000431548039
  error estimate for blocks of size 2^( 7) =       0.000432855523

      target function =                  N/A
              le_mean =     -17.215954583660
             les_mean =     296.711448791649
             stat err =       0.000429684435
             autocorr =       1.145493169963
              std dev =       0.567764674992
             le_variance =       0.322356726168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401470252
  error estimate for blocks of size 2^( 2) =       0.000411330532
  error estimate for blocks of size 2^( 3) =       0.000419573886
  error estimate for blocks of size 2^( 4) =       0.000425338944
  error estimate for blocks of size 2^( 5) =       0.000428995236
  error estimate for blocks of size 2^( 6) =       0.000431548039
  error estimate for blocks of size 2^( 7) =       0.000432855523

      target function =                  N/A
              le_mean =     -17.215954583660
             les_mean =     296.711448791649
             stat err =       0.000429684435
             autocorr =       1.145493169963
              std dev =       0.567764674992
             le_variance =       0.322356726168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322367286080
                                         uncertainty =       0.003548041108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401470252
  error estimate for blocks of size 2^( 2) =       0.000411330532
  error estimate for blocks of size 2^( 3) =       0.000419573886
  error estimate for blocks of size 2^( 4) =       0.000425338944
  error estimate for blocks of size 2^( 5) =       0.000428995236
  error estimate for blocks of size 2^( 6) =       0.000431548039
  error estimate for blocks of size 2^( 7) =       0.000432855523

      target function =                  N/A
              le_mean =     -17.215954583660
             les_mean =     296.711448791648
             stat err =       0.000429684435
             autocorr =       1.145493169964
              std dev =       0.567764674992
             le_variance =       0.322356726168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215954583660        initial  <--
     2.3283e+08     2.3283e+09             1.3677e-12       -17.215954583660
     9.3132e+08     9.3132e+09             3.4166e-13       -17.215954583660
     3.7253e+09     3.7253e+10             8.5306e-14       -17.215954583660

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5150
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1408
    reference variance = 0.266506
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022252361
                                         uncertainty =       0.003516989962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022252361
                                         uncertainty =       0.003516989962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946804
  error estimate for blocks of size 2^( 2) =       0.000409407253
  error estimate for blocks of size 2^( 3) =       0.000418558087
  error estimate for blocks of size 2^( 4) =       0.000424432032
  error estimate for blocks of size 2^( 5) =       0.000428995131
  error estimate for blocks of size 2^( 6) =       0.000433105775
  error estimate for blocks of size 2^( 7) =       0.000433257587

      target function =                  N/A
              le_mean =     -17.215965985243
             les_mean =     296.709399536440
             stat err =       0.000429947631
             autocorr =       1.155650897304
              std dev =       0.565610193806
             le_variance =       0.319914891337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596598524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215965985243       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215965985243       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215965985243       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215965985243       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215965985243       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964907144       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215971497324       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215961001366       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.528498e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215965985243       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215965985243       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215965985243       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215963432060       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215966244884       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215970345441       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215968292401       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 3.785416e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215965985243       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215965985243       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215965985243       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215960307730       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215937134448       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215955279159       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216028447827       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216020137275       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216071391468       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216021610974       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216107408830       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216435543123       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216606396197       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215868469461       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214575022258       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216543530067       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213182069434       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215136987786       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217099060039       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217408119015       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219373629557       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215211373511       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.208140112904       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.223767373468       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.220343992256       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.225613598618       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.210932816263       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.195615484970       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.171404136872       residual = 3.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.200335451958       residual = 3.94e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.221750242100       residual = 5.77e-03           smallest_sin_value = 9.94e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.55e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 8.897066e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5630e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2075
    reference variance = 0.235758
====================================================
  Execution time = 1.9704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2429e-01
  Total weights = 2.0000e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402674162
  error estimate for blocks of size 2^( 2) =       0.000411916372
  error estimate for blocks of size 2^( 3) =       0.000420294713
  error estimate for blocks of size 2^( 4) =       0.000426650424
  error estimate for blocks of size 2^( 5) =       0.000431649320
  error estimate for blocks of size 2^( 6) =       0.000434140880
  error estimate for blocks of size 2^( 7) =       0.000434358360

      target function =                  N/A
              le_mean =     -17.216536750553
             les_mean =     296.733430482131
             stat err =       0.000431699746
             autocorr =       1.149359948987
              std dev =       0.569467260802
             le_variance =       0.324292961125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402674162
  error estimate for blocks of size 2^( 2) =       0.000411916372
  error estimate for blocks of size 2^( 3) =       0.000420294713
  error estimate for blocks of size 2^( 4) =       0.000426650424
  error estimate for blocks of size 2^( 5) =       0.000431649320
  error estimate for blocks of size 2^( 6) =       0.000434140880
  error estimate for blocks of size 2^( 7) =       0.000434358360

      target function =                  N/A
              le_mean =     -17.216536750553
             les_mean =     296.733430482131
             stat err =       0.000431699746
             autocorr =       1.149359948987
              std dev =       0.569467260802
             le_variance =       0.324292961126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402674162
  error estimate for blocks of size 2^( 2) =       0.000411916372
  error estimate for blocks of size 2^( 3) =       0.000420294713
  error estimate for blocks of size 2^( 4) =       0.000426650424
  error estimate for blocks of size 2^( 5) =       0.000431649320
  error estimate for blocks of size 2^( 6) =       0.000434140880
  error estimate for blocks of size 2^( 7) =       0.000434358360

      target function =                  N/A
              le_mean =     -17.216536750553
             les_mean =     296.733430482131
             stat err =       0.000431699746
             autocorr =       1.149359948987
              std dev =       0.569467260802
             le_variance =       0.324292961126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423515394
                                         uncertainty =       0.005348437205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402674162
  error estimate for blocks of size 2^( 2) =       0.000411916372
  error estimate for blocks of size 2^( 3) =       0.000420294713
  error estimate for blocks of size 2^( 4) =       0.000426650424
  error estimate for blocks of size 2^( 5) =       0.000431649320
  error estimate for blocks of size 2^( 6) =       0.000434140880
  error estimate for blocks of size 2^( 7) =       0.000434358360

      target function =                  N/A
              le_mean =     -17.216536750553
             les_mean =     296.733430482131
             stat err =       0.000431699746
             autocorr =       1.149359948988
              std dev =       0.569467260802
             le_variance =       0.324292961125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216536750553        initial  <--
     2.3283e+09     2.3283e+10             1.5285e-13       -17.216536750553
     9.3132e+09     9.3132e+10             3.7854e-14       -17.216536750553
     3.7253e+10     3.7253e+11             8.8971e-15       -17.216536750553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9300
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3678
    reference variance = 0.536156
====================================================
  Execution time = 2.0190e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2456e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518794137
                                         uncertainty =       0.003441565302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518794137
                                         uncertainty =       0.003441565302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402838146
  error estimate for blocks of size 2^( 2) =       0.000412248187
  error estimate for blocks of size 2^( 3) =       0.000420213887
  error estimate for blocks of size 2^( 4) =       0.000426529277
  error estimate for blocks of size 2^( 5) =       0.000430585606
  error estimate for blocks of size 2^( 6) =       0.000432599252
  error estimate for blocks of size 2^( 7) =       0.000433621388

      target function =                  N/A
              le_mean =     -17.216361639969
             les_mean =     296.727665099479
             stat err =       0.000430833881
             autocorr =       1.143822199194
              std dev =       0.569699169341
             le_variance =       0.324557143547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636163997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216361639969       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216361639969       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216361639969       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216382006943       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216361330034       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216357033244       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216335675023       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216388064108       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216306244341       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216276844636       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216381976771       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216047388928       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216221627491       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216092868294       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216018029187       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217904487293       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215819954091       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215149423274       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216690529853       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.209402098272       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216914064389       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.210580303671       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217453348965       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215308052350       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.226403859237       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214896552788       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216371066060       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.210356754142       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.205773006607       residual = 1.73e-02           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.437866e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216361639969       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216361639969       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216361639969       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368177527       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216361639969       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216328636758       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216328885067       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216370930244       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216320117534       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216897914571       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216583468583       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217500738709       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216753239693       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214318893898       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.222019949688       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217669498987       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216486558746       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218679365153       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213599968496       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.212901063512       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213640641420       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213234613016       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.208994103931       residual = 8.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216827389563       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.220865080073       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215729540255       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.209771306529       residual = 7.18e-03           smallest_sin_value = 9.99e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 3.814224e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216361639969       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216361639969       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216361639969       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368094442       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216298499762       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214419408821       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216913058379       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217628084935       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217822521391       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217951692874       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211911840353       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.222790122614       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.222294436144       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216815845894       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.245883478984       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.209951782374       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.224222810244       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.185992876524       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.191183267544       residual = 9.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.161963331744       residual = 4.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.186982777898       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.244499436707       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.204870382398       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.229318125580       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.221680301423       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.201092090788       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.290213106873       residual = 8.52e-01           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.141354891422       residual = 8.74e-01           smallest_sin_value = 9.92e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.32e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 5.543232e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5838e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2962
    reference variance = 0.631489
====================================================
  Execution time = 1.9846e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1784e-01
  Total weights = 2.0000e+06
  Execution time = 1.8317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398650692
  error estimate for blocks of size 2^( 2) =       0.000407938058
  error estimate for blocks of size 2^( 3) =       0.000415947037
  error estimate for blocks of size 2^( 4) =       0.000421996695
  error estimate for blocks of size 2^( 5) =       0.000425731879
  error estimate for blocks of size 2^( 6) =       0.000427643564
  error estimate for blocks of size 2^( 7) =       0.000428409170

      target function =                  N/A
              le_mean =     -17.216721942739
             les_mean =     296.733359042924
             stat err =       0.000425945327
             autocorr =       1.141622898924
              std dev =       0.563777215076
             le_variance =       0.317844748239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398650692
  error estimate for blocks of size 2^( 2) =       0.000407938058
  error estimate for blocks of size 2^( 3) =       0.000415947037
  error estimate for blocks of size 2^( 4) =       0.000421996695
  error estimate for blocks of size 2^( 5) =       0.000425731879
  error estimate for blocks of size 2^( 6) =       0.000427643564
  error estimate for blocks of size 2^( 7) =       0.000428409170

      target function =                  N/A
              le_mean =     -17.216721942739
             les_mean =     296.733359042924
             stat err =       0.000425945327
             autocorr =       1.141622898924
              std dev =       0.563777215076
             le_variance =       0.317844748239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398650692
  error estimate for blocks of size 2^( 2) =       0.000407938058
  error estimate for blocks of size 2^( 3) =       0.000415947037
  error estimate for blocks of size 2^( 4) =       0.000421996695
  error estimate for blocks of size 2^( 5) =       0.000425731879
  error estimate for blocks of size 2^( 6) =       0.000427643564
  error estimate for blocks of size 2^( 7) =       0.000428409170

      target function =                  N/A
              le_mean =     -17.216721942739
             les_mean =     296.733359042924
             stat err =       0.000425945327
             autocorr =       1.141622898923
              std dev =       0.563777215076
             le_variance =       0.317844748239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317816288155
                                         uncertainty =       0.003286120436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398650692
  error estimate for blocks of size 2^( 2) =       0.000407938058
  error estimate for blocks of size 2^( 3) =       0.000415947037
  error estimate for blocks of size 2^( 4) =       0.000421996695
  error estimate for blocks of size 2^( 5) =       0.000425731879
  error estimate for blocks of size 2^( 6) =       0.000427643564
  error estimate for blocks of size 2^( 7) =       0.000428409170

      target function =                  N/A
              le_mean =     -17.216721942739
             les_mean =     296.733359042924
             stat err =       0.000425945327
             autocorr =       1.141622898927
              std dev =       0.563777215076
             le_variance =       0.317844748239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216721942739        initial  <--
     2.3283e+10     2.3283e+11             1.4379e-14       -17.216721942739
     9.3132e+10     9.3132e+11             3.8142e-15       -17.216721942739
     3.7253e+11     3.7253e+12             5.5432e-16       -17.216721942739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0608
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4905e+01 secs
  Total Execution time = 2.2358e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
