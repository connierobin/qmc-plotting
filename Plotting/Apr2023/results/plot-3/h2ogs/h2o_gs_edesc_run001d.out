Rank =    0  Free Memory = 68740 MB
Rank =    1  Free Memory = 68740 MB
Rank =    2  Free Memory = 68740 MB
Rank =    3  Free Memory = 68740 MB
Rank =    4  Free Memory = 68739 MB
Rank =    5  Free Memory = 68739 MB
Rank =    6  Free Memory = 68738 MB
Rank =    7  Free Memory = 68738 MB
Rank =    8  Free Memory = 68738 MB
Rank =    9  Free Memory = 68738 MB
Rank =   10  Free Memory = 68738 MB
Rank =   11  Free Memory = 68738 MB
Rank =   12  Free Memory = 68738 MB
Rank =   13  Free Memory = 68738 MB
Rank =   14  Free Memory = 68738 MB
Rank =   15  Free Memory = 68723 MB
Rank =   16  Free Memory = 68723 MB
Rank =   17  Free Memory = 68723 MB
Rank =   18  Free Memory = 68723 MB
Rank =   19  Free Memory = 68723 MB
Rank =   20  Free Memory = 68723 MB
Rank =   21  Free Memory = 68723 MB
Rank =   22  Free Memory = 68723 MB
Rank =   23  Free Memory = 68723 MB
Rank =   24  Free Memory = 68723 MB
Rank =   25  Free Memory = 68723 MB
Rank =   26  Free Memory = 68723 MB
Rank =   27  Free Memory = 68723 MB
Rank =   28  Free Memory = 68722 MB
Rank =   29  Free Memory = 68722 MB
Rank =   30  Free Memory = 68722 MB
Rank =   31  Free Memory = 68722 MB
Rank =   32  Free Memory = 90366 MB
Rank =   33  Free Memory = 90366 MB
Rank =   34  Free Memory = 90366 MB
Rank =   35  Free Memory = 90366 MB
Rank =   36  Free Memory = 90365 MB
Rank =   37  Free Memory = 90365 MB
Rank =   38  Free Memory = 90365 MB
Rank =   39  Free Memory = 90365 MB
Rank =   40  Free Memory = 90365 MB
Rank =   41  Free Memory = 90365 MB
Rank =   42  Free Memory = 90365 MB
Rank =   43  Free Memory = 90365 MB
Rank =   44  Free Memory = 90365 MB
Rank =   45  Free Memory = 90365 MB
Rank =   46  Free Memory = 90365 MB
Rank =   47  Free Memory = 90365 MB
Rank =   48  Free Memory = 90365 MB
Rank =   49  Free Memory = 90365 MB
Rank =   50  Free Memory = 90365 MB
Rank =   51  Free Memory = 90365 MB
Rank =   52  Free Memory = 90365 MB
Rank =   53  Free Memory = 90365 MB
Rank =   54  Free Memory = 90365 MB
Rank =   55  Free Memory = 90365 MB
Rank =   56  Free Memory = 90365 MB
Rank =   57  Free Memory = 90365 MB
Rank =   58  Free Memory = 90365 MB
Rank =   59  Free Memory = 90365 MB
Rank =   60  Free Memory = 90365 MB
Rank =   61  Free Memory = 90365 MB
Rank =   62  Free Memory = 90365 MB
Rank =   63  Free Memory = 90365 MB
Rank =   64  Free Memory = 90860 MB
Rank =   65  Free Memory = 90860 MB
Rank =   66  Free Memory = 90860 MB
Rank =   67  Free Memory = 90860 MB
Rank =   68  Free Memory = 90859 MB
Rank =   69  Free Memory = 90859 MB
Rank =   70  Free Memory = 90859 MB
Rank =   71  Free Memory = 90859 MB
Rank =   72  Free Memory = 90859 MB
Rank =   73  Free Memory = 90859 MB
Rank =   74  Free Memory = 90859 MB
Rank =   75  Free Memory = 90859 MB
Rank =   76  Free Memory = 90859 MB
Rank =   77  Free Memory = 90859 MB
Rank =   78  Free Memory = 90859 MB
Rank =   79  Free Memory = 90859 MB
Rank =   80  Free Memory = 90859 MB
Rank =   81  Free Memory = 90859 MB
Rank =   82  Free Memory = 90859 MB
Rank =   83  Free Memory = 90859 MB
Rank =   84  Free Memory = 90859 MB
Rank =   85  Free Memory = 90859 MB
Rank =   86  Free Memory = 90859 MB
Rank =   87  Free Memory = 90859 MB
Rank =   88  Free Memory = 90859 MB
Rank =   89  Free Memory = 90859 MB
Rank =   90  Free Memory = 90859 MB
Rank =   91  Free Memory = 90859 MB
Rank =   92  Free Memory = 90859 MB
Rank =   93  Free Memory = 90859 MB
Rank =   94  Free Memory = 90859 MB
Rank =   95  Free Memory = 90859 MB
Rank =   96  Free Memory = 88605 MB
Rank =   97  Free Memory = 88605 MB
Rank =   98  Free Memory = 88605 MB
Rank =   99  Free Memory = 88605 MB
Rank =  100  Free Memory = 88605 MB
Rank =  101  Free Memory = 88605 MB
Rank =  102  Free Memory = 88605 MB
Rank =  103  Free Memory = 88605 MB
Rank =  104  Free Memory = 88605 MB
Rank =  105  Free Memory = 88605 MB
Rank =  106  Free Memory = 88605 MB
Rank =  107  Free Memory = 88605 MB
Rank =  108  Free Memory = 88605 MB
Rank =  109  Free Memory = 88605 MB
Rank =  110  Free Memory = 88605 MB
Rank =  111  Free Memory = 88605 MB
Rank =  112  Free Memory = 88605 MB
Rank =  113  Free Memory = 88605 MB
Rank =  114  Free Memory = 88605 MB
Rank =  115  Free Memory = 88605 MB
Rank =  116  Free Memory = 88605 MB
Rank =  117  Free Memory = 88605 MB
Rank =  118  Free Memory = 88605 MB
Rank =  119  Free Memory = 88605 MB
Rank =  120  Free Memory = 88605 MB
Rank =  121  Free Memory = 88605 MB
Rank =  122  Free Memory = 88605 MB
Rank =  123  Free Memory = 88605 MB
Rank =  124  Free Memory = 88605 MB
Rank =  125  Free Memory = 88605 MB
Rank =  126  Free Memory = 88605 MB
Rank =  127  Free Memory = 88605 MB
  Input file(s): opt_h2o_gs_edesc_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_edesc_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:29:26 PST
  host    = n0068.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 758

  Range of prime numbers to use as seeds over processors and threads = 5791-6907


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.028865e-01    1         1  ON     0
     uu_1                 4.341226e-02    1         1  ON     1
     uu_2                -4.815379e-02    1         1  ON     2
     uu_3                -9.957681e-02    1         1  ON     3
     uu_4                -1.295071e-01    1         1  ON     4
     uu_5                -1.341431e-01    1         1  ON     5
     uu_6                -1.112603e-01    1         1  ON     6
     uu_7                -3.671392e-02    1         1  ON     7
     uu_8                 1.013742e-01    1         1  ON     8
     uu_9                 1.199991e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.409141e-01    1         1  ON     0
     ud_1                 8.679005e-02    1         1  ON     1
     ud_2                -1.577149e-02    1         1  ON     2
     ud_3                -7.113979e-02    1         1  ON     3
     ud_4                -1.166522e-01    1         1  ON     4
     ud_5                -1.495871e-01    1         1  ON     5
     ud_6                -1.552919e-01    1         1  ON     6
     ud_7                -1.100750e-01    1         1  ON     7
     ud_8                 6.790927e-03    1         1  ON     8
     ud_9                 9.255039e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.304561e-01    1         1  ON     0
     eO_1                -4.238770e-01    1         1  ON     1
     eO_2                -3.823282e-02    1         1  ON     2
     eO_3                 1.951443e-01    1         1  ON     3
     eO_4                 2.772289e-01    1         1  ON     4
     eO_5                 3.042422e-01    1         1  ON     5
     eO_6                 2.489277e-01    1         1  ON     6
     eO_7                 1.104808e-01    1         1  ON     7
     eO_8                 2.772371e-02    1         1  ON     8
     eO_9                 1.832715e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.792584e-01    1         1  ON     0
     eH1_1                -1.010438e-01    1         1  ON     1
     eH1_2                -6.216424e-02    1         1  ON     2
     eH1_3                -2.653657e-02    1         1  ON     3
     eH1_4                 1.925680e-02    1         1  ON     4
     eH1_5                 3.327877e-02    1         1  ON     5
     eH1_6                 7.689937e-02    1         1  ON     6
     eH1_7                 1.105349e-01    1         1  ON     7
     eH1_8                 8.980147e-02    1         1  ON     8
     eH1_9                 2.403540e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.814281e-01    1         1  ON     0
     eH2_1                -1.026921e-01    1         1  ON     1
     eH2_2                -6.368410e-02    1         1  ON     2
     eH2_3                -2.776411e-02    1         1  ON     3
     eH2_4                 1.810884e-02    1         1  ON     4
     eH2_5                 3.402513e-02    1         1  ON     5
     eH2_6                 7.850032e-02    1         1  ON     6
     eH2_7                 1.138562e-01    1         1  ON     7
     eH2_8                 9.285880e-02    1         1  ON     8
     eH2_9                 2.615484e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.704364e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1506e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2236
    reference variance = 0.217166
====================================================
  Execution time = 2.0870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312738444033
                                         uncertainty =       0.003489952571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312738444033
                                         uncertainty =       0.003489952571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395391832
  error estimate for blocks of size 2^( 2) =       0.000405710140
  error estimate for blocks of size 2^( 3) =       0.000415159882
  error estimate for blocks of size 2^( 4) =       0.000421432548
  error estimate for blocks of size 2^( 5) =       0.000425435015
  error estimate for blocks of size 2^( 6) =       0.000425725561
  error estimate for blocks of size 2^( 7) =       0.000426234588

      target function =                  N/A
              le_mean =     -17.216605962223
             les_mean =     296.724190103391
             stat err =       0.000424706928
             autocorr =       1.153780792525
              std dev =       0.559168490950
             le_variance =       0.312669401272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721660596222e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605962223       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621866845       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216634805694       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216654117238       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666165566       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216673722443       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216676079445       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216675963287       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216676249481       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216677857840       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216677726275       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216677573831       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.948294e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605962223       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216612594190       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216617954835       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216624007793       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216628820734       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216631441920       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631290846       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216631027287       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216631168775       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216631084782       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.111415e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605962223       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607952569       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609604941       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611213620       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216612468702       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216613218566       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216613065349       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216613086900       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216613095362       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.650013e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6386e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.031811e-01                 1 1 ON  0
uu_1  4.368380e-02                 1 1 ON  1
uu_2  -4.813248e-02                1 1 ON  2
uu_3  -9.964120e-02                1 1 ON  3
uu_4  -1.296688e-01                1 1 ON  4
uu_5  -1.342848e-01                1 1 ON  5
uu_6  -1.113842e-01                1 1 ON  6
uu_7  -3.687466e-02                1 1 ON  7
uu_8  1.012979e-01                 1 1 ON  8
uu_9  1.200569e-01                 1 1 ON  9
ud_0  3.421538e-01                 1 1 ON  10
ud_1  8.745541e-02                 1 1 ON  11
ud_2  -1.631509e-02                1 1 ON  12
ud_3  -7.193243e-02                1 1 ON  13
ud_4  -1.170504e-01                1 1 ON  14
ud_5  -1.496401e-01                1 1 ON  15
ud_6  -1.552561e-01                1 1 ON  16
ud_7  -1.101678e-01                1 1 ON  17
ud_8  6.639184e-03                 1 1 ON  18
ud_9  9.256009e-02                 1 1 ON  19
eO_0  -7.325676e-01                1 1 ON  20
eO_1  -4.249168e-01                1 1 ON  21
eO_2  -3.725462e-02                1 1 ON  22
eO_3  1.965561e-01                 1 1 ON  23
eO_4  2.779020e-01                 1 1 ON  24
eO_5  3.041343e-01                 1 1 ON  25
eO_6  2.489661e-01                 1 1 ON  26
eO_7  1.105998e-01                 1 1 ON  27
eO_8  2.774200e-02                 1 1 ON  28
eO_9  1.833883e-02                 1 1 ON  29
eH1_0 -1.794718e-01                1 1 ON  30
eH1_1 -1.011234e-01                1 1 ON  31
eH1_2 -6.222262e-02                1 1 ON  32
eH1_3 -2.644578e-02                1 1 ON  33
eH1_4 1.933888e-02                 1 1 ON  34
eH1_5 3.343503e-02                 1 1 ON  35
eH1_6 7.685229e-02                 1 1 ON  36
eH1_7 1.104902e-01                 1 1 ON  37
eH1_8 8.989271e-02                 1 1 ON  38
eH1_9 2.405773e-02                 1 1 ON  39
eH2_0 -1.816297e-01                1 1 ON  40
eH2_1 -1.027291e-01                1 1 ON  41
eH2_2 -6.372720e-02                1 1 ON  42
eH2_3 -2.763055e-02                1 1 ON  43
eH2_4 1.826204e-02                 1 1 ON  44
eH2_5 3.406967e-02                 1 1 ON  45
eH2_6 7.839970e-02                 1 1 ON  46
eH2_7 1.138061e-01                 1 1 ON  47
eH2_8 9.292427e-02                 1 1 ON  48
eH2_9 2.617693e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.272187
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312679596340
                                         uncertainty =       0.003760342957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312679596340
                                         uncertainty =       0.003760342957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395389387
  error estimate for blocks of size 2^( 2) =       0.000405655059
  error estimate for blocks of size 2^( 3) =       0.000414631526
  error estimate for blocks of size 2^( 4) =       0.000420624159
  error estimate for blocks of size 2^( 5) =       0.000424509484
  error estimate for blocks of size 2^( 6) =       0.000424288037
  error estimate for blocks of size 2^( 7) =       0.000425671404

      target function =                  N/A
              le_mean =     -17.217037131180
             les_mean =     296.739032954506
             stat err =       0.000423773271
             autocorr =       1.148727732026
              std dev =       0.559165033250
             le_variance =       0.312665534409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315529508946
                                         uncertainty =       0.003800010085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315529508946
                                         uncertainty =       0.003800010085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397186642
  error estimate for blocks of size 2^( 2) =       0.000407279460
  error estimate for blocks of size 2^( 3) =       0.000416090183
  error estimate for blocks of size 2^( 4) =       0.000421980491
  error estimate for blocks of size 2^( 5) =       0.000425839150
  error estimate for blocks of size 2^( 6) =       0.000425599457
  error estimate for blocks of size 2^( 7) =       0.000426949910

      target function =                  N/A
              le_mean =     -17.217052560322
             les_mean =     296.742413163861
             stat err =       0.000425092252
             autocorr =       1.145452568716
              std dev =       0.561706735514
             le_variance =       0.315514456721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314812985231
                                         uncertainty =       0.003791890689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314812985231
                                         uncertainty =       0.003791890689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396735584
  error estimate for blocks of size 2^( 2) =       0.000406869756
  error estimate for blocks of size 2^( 3) =       0.000415721951
  error estimate for blocks of size 2^( 4) =       0.000421641840
  error estimate for blocks of size 2^( 5) =       0.000425518071
  error estimate for blocks of size 2^( 6) =       0.000425281362
  error estimate for blocks of size 2^( 7) =       0.000426631983

      target function =                  N/A
              le_mean =     -17.217044119417
             les_mean =     296.741406300280
             stat err =       0.000424768314
             autocorr =       1.146309561175
              std dev =       0.561068844030
             le_variance =       0.314798247741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312974800504
                                         uncertainty =       0.003765018393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312974800504
                                         uncertainty =       0.003765018393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395575937
  error estimate for blocks of size 2^( 2) =       0.000405821225
  error estimate for blocks of size 2^( 3) =       0.000414778672
  error estimate for blocks of size 2^( 4) =       0.000420760443
  error estimate for blocks of size 2^( 5) =       0.000424645158
  error estimate for blocks of size 2^( 6) =       0.000424421192
  error estimate for blocks of size 2^( 7) =       0.000425799027

      target function =                  N/A
              le_mean =     -17.217035627326
             les_mean =     296.739276279883
             stat err =       0.000423906455
             autocorr =       1.148366008549
              std dev =       0.559428854959
             le_variance =       0.312960643761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217037131180        initial
     2.5000e-01     2.5000e+00             6.9483e-03       -17.217052560322  <--
     1.0000e+00     1.0000e+01             2.1114e-03       -17.217044119417
     4.0000e+00     4.0000e+01             5.6500e-04       -17.217035627326

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0047e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.041134e-01 1 1  ON 0
 uu_1                 4.436361e-02 1 1  ON 1
 uu_2                -4.794775e-02 1 1  ON 2
 uu_3                -9.983611e-02 1 1  ON 3
 uu_4                -1.301558e-01 1 1  ON 4
 uu_5                -1.347967e-01 1 1  ON 5
 uu_6                -1.117368e-01 1 1  ON 6
 uu_7                -3.733088e-02 1 1  ON 7
 uu_8                 1.010737e-01 1 1  ON 8
 uu_9                 1.202331e-01 1 1  ON 9
 ud_0                 3.443250e-01 1 1  ON 10
 ud_1                 8.852590e-02 1 1  ON 11
 ud_2                -1.682540e-02 1 1  ON 12
 ud_3                -7.330134e-02 1 1  ON 13
 ud_4                -1.180758e-01 1 1  ON 14
 ud_5                -1.498950e-01 1 1  ON 15
 ud_6                -1.550240e-01 1 1  ON 16
 ud_7                -1.103338e-01 1 1  ON 17
 ud_8                 6.210073e-03 1 1  ON 18
 ud_9                 9.259350e-02 1 1  ON 19
 eO_0                -7.374044e-01 1 1  ON 20
 eO_1                -4.274599e-01 1 1  ON 21
 eO_2                -3.597093e-02 1 1  ON 22
 eO_3                 1.998000e-01 1 1  ON 23
 eO_4                 2.802075e-01 1 1  ON 24
 eO_5                 3.040457e-01 1 1  ON 25
 eO_6                 2.491172e-01 1 1  ON 26
 eO_7                 1.109655e-01 1 1  ON 27
 eO_8                 2.779875e-02 1 1  ON 28
 eO_9                 1.837445e-02 1 1  ON 29
eH1_0                -1.800153e-01 1 1  ON 30
eH1_1                -1.014397e-01 1 1  ON 31
eH1_2                -6.226714e-02 1 1  ON 32
eH1_3                -2.627667e-02 1 1  ON 33
eH1_4                 1.943381e-02 1 1  ON 34
eH1_5                 3.386451e-02 1 1  ON 35
eH1_6                 7.681876e-02 1 1  ON 36
eH1_7                 1.103841e-01 1 1  ON 37
eH1_8                 9.017250e-02 1 1  ON 38
eH1_9                 2.412630e-02 1 1  ON 39
eH2_0                -1.821144e-01 1 1  ON 40
eH2_1                -1.029357e-01 1 1  ON 41
eH2_2                -6.370824e-02 1 1  ON 42
eH2_3                -2.738210e-02 1 1  ON 43
eH2_4                 1.851869e-02 1 1  ON 44
eH2_5                 3.424600e-02 1 1  ON 45
eH2_6                 7.820597e-02 1 1  ON 46
eH2_7                 1.136805e-01 1 1  ON 47
eH2_8                 9.312562e-02 1 1  ON 48
eH2_9                 2.624454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2484
    reference variance = 0.23281
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1168e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311728088461
                                         uncertainty =       0.002978113679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311728088461
                                         uncertainty =       0.002978113679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394766300
  error estimate for blocks of size 2^( 2) =       0.000404935199
  error estimate for blocks of size 2^( 3) =       0.000414037608
  error estimate for blocks of size 2^( 4) =       0.000420232404
  error estimate for blocks of size 2^( 5) =       0.000425187850
  error estimate for blocks of size 2^( 6) =       0.000427142595
  error estimate for blocks of size 2^( 7) =       0.000428571420

      target function =                  N/A
              le_mean =     -17.216571331875
             les_mean =     296.722009132799
             stat err =       0.000425283567
             autocorr =       1.160585290451
              std dev =       0.558283855303
             le_variance =       0.311680863092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657133188e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571331875       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577947545       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216588058683       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216620502955       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629972017       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216644058544       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216647144788       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216650182403       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216649751781       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216652592509       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216652421779       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216651218098       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216651856884       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216651883889       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216652070689       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216652047662       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.500354e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571331875       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216575734655       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216580631079       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216596902152       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216602654660       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605359581       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605239642       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216605664665       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216605261362       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216605982456       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216605872908       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216605685819       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.488077e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571331875       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216573215039       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574760132       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579849931       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216582035561       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216582238330       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216582201677       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216582150747       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216582110025       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216582247496       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.650877e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6414e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.054381e-01 1 1  ON 0
 uu_1                 4.505061e-02 1 1  ON 1
 uu_2                -4.772020e-02 1 1  ON 2
 uu_3                -1.000651e-01 1 1  ON 3
 uu_4                -1.307062e-01 1 1  ON 4
 uu_5                -1.354655e-01 1 1  ON 5
 uu_6                -1.120529e-01 1 1  ON 6
 uu_7                -3.798497e-02 1 1  ON 7
 uu_8                 1.007740e-01 1 1  ON 8
 uu_9                 1.204456e-01 1 1  ON 9
 ud_0                 3.462437e-01 1 1  ON 10
 ud_1                 8.952034e-02 1 1  ON 11
 ud_2                -1.716953e-02 1 1  ON 12
 ud_3                -7.453770e-02 1 1  ON 13
 ud_4                -1.192153e-01 1 1  ON 14
 ud_5                -1.502281e-01 1 1  ON 15
 ud_6                -1.544082e-01 1 1  ON 16
 ud_7                -1.105653e-01 1 1  ON 17
 ud_8                 5.690287e-03 1 1  ON 18
 ud_9                 9.262650e-02 1 1  ON 19
 eO_0                -7.428925e-01 1 1  ON 20
 eO_1                -4.301972e-01 1 1  ON 21
 eO_2                -3.538767e-02 1 1  ON 22
 eO_3                 2.033205e-01 1 1  ON 23
 eO_4                 2.833764e-01 1 1  ON 24
 eO_5                 3.042266e-01 1 1  ON 25
 eO_6                 2.493788e-01 1 1  ON 26
 eO_7                 1.113415e-01 1 1  ON 27
 eO_8                 2.786667e-02 1 1  ON 28
 eO_9                 1.841637e-02 1 1  ON 29
eH1_0                -1.804014e-01 1 1  ON 30
eH1_1                -1.018294e-01 1 1  ON 31
eH1_2                -6.236693e-02 1 1  ON 32
eH1_3                -2.605283e-02 1 1  ON 33
eH1_4                 1.954096e-02 1 1  ON 34
eH1_5                 3.408612e-02 1 1  ON 35
eH1_6                 7.680532e-02 1 1  ON 36
eH1_7                 1.103422e-01 1 1  ON 37
eH1_8                 9.044281e-02 1 1  ON 38
eH1_9                 2.419399e-02 1 1  ON 39
eH2_0                -1.825605e-01 1 1  ON 40
eH2_1                -1.034487e-01 1 1  ON 41
eH2_2                -6.363392e-02 1 1  ON 42
eH2_3                -2.706803e-02 1 1  ON 43
eH2_4                 1.861305e-02 1 1  ON 44
eH2_5                 3.453753e-02 1 1  ON 45
eH2_6                 7.813126e-02 1 1  ON 46
eH2_7                 1.135831e-01 1 1  ON 47
eH2_8                 9.338928e-02 1 1  ON 48
eH2_9                 2.632009e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.18
    reference variance = 0.178252
====================================================
  Execution time = 2.0008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2485e-01
  Total weights = 2.0000e+06
  Execution time = 1.8463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322894129925
                                         uncertainty =       0.006945336887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322894129925
                                         uncertainty =       0.006945336887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401881427
  error estimate for blocks of size 2^( 2) =       0.000411845891
  error estimate for blocks of size 2^( 3) =       0.000420671715
  error estimate for blocks of size 2^( 4) =       0.000427287226
  error estimate for blocks of size 2^( 5) =       0.000430957059
  error estimate for blocks of size 2^( 6) =       0.000433560974
  error estimate for blocks of size 2^( 7) =       0.000436376335

      target function =                  N/A
              le_mean =     -17.217032929816
             les_mean =     296.749240108398
             stat err =       0.000432045398
             autocorr =       1.155747320330
              std dev =       0.568346165223
             le_variance =       0.323017363524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326707020544
                                         uncertainty =       0.007040803104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326707020544
                                         uncertainty =       0.007040803104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404247217
  error estimate for blocks of size 2^( 2) =       0.000414049049
  error estimate for blocks of size 2^( 3) =       0.000422692933
  error estimate for blocks of size 2^( 4) =       0.000429190213
  error estimate for blocks of size 2^( 5) =       0.000432806047
  error estimate for blocks of size 2^( 6) =       0.000435355517
  error estimate for blocks of size 2^( 7) =       0.000438081008

      target function =                  N/A
              le_mean =     -17.217050681351
             les_mean =     296.753665626224
             stat err =       0.000433858196
             autocorr =       1.151864874833
              std dev =       0.571691897291
             le_variance =       0.326831625428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326657534715
                                         uncertainty =       0.007034309475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326657534715
                                         uncertainty =       0.007034309475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404216407
  error estimate for blocks of size 2^( 2) =       0.000414029370
  error estimate for blocks of size 2^( 3) =       0.000422690737
  error estimate for blocks of size 2^( 4) =       0.000429205165
  error estimate for blocks of size 2^( 5) =       0.000432826335
  error estimate for blocks of size 2^( 6) =       0.000435366850
  error estimate for blocks of size 2^( 7) =       0.000438123124

      target function =                  N/A
              le_mean =     -17.217048457116
             les_mean =     296.753539217890
             stat err =       0.000433880368
             autocorr =       1.152158230344
              std dev =       0.571648324241
             le_variance =       0.326781806608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537021270
                                         uncertainty =       0.006960459679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323537021270
                                         uncertainty =       0.006960459679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402281232
  error estimate for blocks of size 2^( 2) =       0.000412216772
  error estimate for blocks of size 2^( 3) =       0.000421012358
  error estimate for blocks of size 2^( 4) =       0.000427609878
  error estimate for blocks of size 2^( 5) =       0.000431270512
  error estimate for blocks of size 2^( 6) =       0.000433861525
  error estimate for blocks of size 2^( 7) =       0.000436669165

      target function =                  N/A
              le_mean =     -17.217030688654
             les_mean =     296.749805950912
             stat err =       0.000432352770
             autocorr =       1.155092993160
              std dev =       0.568911573687
             le_variance =       0.323660378676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217032929816        initial
     6.2500e-02     6.2500e-01             1.5004e-02       -17.217050681351  <--
     2.5000e-01     2.5000e+00             5.4881e-03       -17.217048457116
     1.0000e+00     1.0000e+01             1.6509e-03       -17.217030688654

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9266e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.078933e-01 1 1  ON 0
 uu_1                 4.664776e-02 1 1  ON 1
 uu_2                -4.688180e-02 1 1  ON 2
 uu_3                -1.001860e-01 1 1  ON 3
 uu_4                -1.317832e-01 1 1  ON 4
 uu_5                -1.369903e-01 1 1  ON 5
 uu_6                -1.130308e-01 1 1  ON 6
 uu_7                -3.976821e-02 1 1  ON 7
 uu_8                 9.988904e-02 1 1  ON 8
 uu_9                 1.210985e-01 1 1  ON 9
 ud_0                 3.485192e-01 1 1  ON 10
 ud_1                 9.096458e-02 1 1  ON 11
 ud_2                -1.688760e-02 1 1  ON 12
 ud_3                -7.548446e-02 1 1  ON 13
 ud_4                -1.208210e-01 1 1  ON 14
 ud_5                -1.514457e-01 1 1  ON 15
 ud_6                -1.538096e-01 1 1  ON 16
 ud_7                -1.108697e-01 1 1  ON 17
 ud_8                 4.296550e-03 1 1  ON 18
 ud_9                 9.274263e-02 1 1  ON 19
 eO_0                -7.524080e-01 1 1  ON 20
 eO_1                -4.364131e-01 1 1  ON 21
 eO_2                -3.674966e-02 1 1  ON 22
 eO_3                 2.079095e-01 1 1  ON 23
 eO_4                 2.910419e-01 1 1  ON 24
 eO_5                 3.063389e-01 1 1  ON 25
 eO_6                 2.504979e-01 1 1  ON 26
 eO_7                 1.125292e-01 1 1  ON 27
 eO_8                 2.808139e-02 1 1  ON 28
 eO_9                 1.854586e-02 1 1  ON 29
eH1_0                -1.811642e-01 1 1  ON 30
eH1_1                -1.025671e-01 1 1  ON 31
eH1_2                -6.247194e-02 1 1  ON 32
eH1_3                -2.589619e-02 1 1  ON 33
eH1_4                 1.955013e-02 1 1  ON 34
eH1_5                 3.394039e-02 1 1  ON 35
eH1_6                 7.710489e-02 1 1  ON 36
eH1_7                 1.104302e-01 1 1  ON 37
eH1_8                 9.130296e-02 1 1  ON 38
eH1_9                 2.440655e-02 1 1  ON 39
eH2_0                -1.833627e-01 1 1  ON 40
eH2_1                -1.041716e-01 1 1  ON 41
eH2_2                -6.360220e-02 1 1  ON 42
eH2_3                -2.676368e-02 1 1  ON 43
eH2_4                 1.867724e-02 1 1  ON 44
eH2_5                 3.448779e-02 1 1  ON 45
eH2_6                 7.825250e-02 1 1  ON 46
eH2_7                 1.135072e-01 1 1  ON 47
eH2_8                 9.422601e-02 1 1  ON 48
eH2_9                 2.655660e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2736
    reference variance = 0.492999
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1856e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318597347717
                                         uncertainty =       0.004081408490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318597347717
                                         uncertainty =       0.004081408490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399100887
  error estimate for blocks of size 2^( 2) =       0.000408892949
  error estimate for blocks of size 2^( 3) =       0.000417715518
  error estimate for blocks of size 2^( 4) =       0.000424375537
  error estimate for blocks of size 2^( 5) =       0.000428860623
  error estimate for blocks of size 2^( 6) =       0.000431524611
  error estimate for blocks of size 2^( 7) =       0.000433016067

      target function =                  N/A
              le_mean =     -17.216601852618
             les_mean =     296.729942228989
             stat err =       0.000429444210
             autocorr =       1.157838844242
              std dev =       0.564413887763
             le_variance =       0.318563036699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660185262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601852618       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604253336       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216613053009       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216627004748       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216643969932       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216655257579       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658461522       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216659175837       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216658695492       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216661877828       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216662746735       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216663688180       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216666296797       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216668364098       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216669576880       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216669876164       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216669559582       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216669563527       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216670059968       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216669500803       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.172559e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601852618       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603772036       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216610891058       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216619710320       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216630199720       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216633697273       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216633598248       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216632995235       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216633131804       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216632723331       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216633194699       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216633310037       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216633591070       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216633852823       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 8.610294e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601852618       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216602917821       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216606915731       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216609970849       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216613990781       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216614093086       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216613829082       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216613529678       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216613487152       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216613427295       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216613470331       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.809094e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5843e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.099529e-01 1 1  ON 0
 uu_1                 4.837243e-02 1 1  ON 1
 uu_2                -4.573838e-02 1 1  ON 2
 uu_3                -1.000312e-01 1 1  ON 3
 uu_4                -1.323796e-01 1 1  ON 4
 uu_5                -1.381314e-01 1 1  ON 5
 uu_6                -1.150005e-01 1 1  ON 6
 uu_7                -4.152170e-02 1 1  ON 7
 uu_8                 9.882427e-02 1 1  ON 8
 uu_9                 1.218220e-01 1 1  ON 9
 ud_0                 3.507052e-01 1 1  ON 10
 ud_1                 9.255113e-02 1 1  ON 11
 ud_2                -1.608838e-02 1 1  ON 12
 ud_3                -7.572262e-02 1 1  ON 13
 ud_4                -1.220158e-01 1 1  ON 14
 ud_5                -1.523024e-01 1 1  ON 15
 ud_6                -1.540264e-01 1 1  ON 16
 ud_7                -1.113248e-01 1 1  ON 17
 ud_8                 2.372826e-03 1 1  ON 18
 ud_9                 9.258024e-02 1 1  ON 19
 eO_0                -7.610183e-01 1 1  ON 20
 eO_1                -4.429622e-01 1 1  ON 21
 eO_2                -3.894240e-02 1 1  ON 22
 eO_3                 2.106539e-01 1 1  ON 23
 eO_4                 2.989141e-01 1 1  ON 24
 eO_5                 3.094244e-01 1 1  ON 25
 eO_6                 2.516974e-01 1 1  ON 26
 eO_7                 1.145674e-01 1 1  ON 27
 eO_8                 2.843957e-02 1 1  ON 28
 eO_9                 1.858600e-02 1 1  ON 29
eH1_0                -1.820026e-01 1 1  ON 30
eH1_1                -1.029266e-01 1 1  ON 31
eH1_2                -6.236209e-02 1 1  ON 32
eH1_3                -2.550464e-02 1 1  ON 33
eH1_4                 1.952473e-02 1 1  ON 34
eH1_5                 3.366853e-02 1 1  ON 35
eH1_6                 7.705534e-02 1 1  ON 36
eH1_7                 1.100565e-01 1 1  ON 37
eH1_8                 9.235631e-02 1 1  ON 38
eH1_9                 2.473113e-02 1 1  ON 39
eH2_0                -1.839180e-01 1 1  ON 40
eH2_1                -1.044011e-01 1 1  ON 41
eH2_2                -6.366697e-02 1 1  ON 42
eH2_3                -2.672381e-02 1 1  ON 43
eH2_4                 1.847295e-02 1 1  ON 44
eH2_5                 3.375311e-02 1 1  ON 45
eH2_6                 7.877831e-02 1 1  ON 46
eH2_7                 1.135429e-01 1 1  ON 47
eH2_8                 9.515796e-02 1 1  ON 48
eH2_9                 2.678762e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.281
    reference variance = 0.16665
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2073e-01
  Total weights = 2.0000e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319267110285
                                         uncertainty =       0.005323371231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319267110285
                                         uncertainty =       0.005323371231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399590601
  error estimate for blocks of size 2^( 2) =       0.000409440576
  error estimate for blocks of size 2^( 3) =       0.000418217619
  error estimate for blocks of size 2^( 4) =       0.000425254720
  error estimate for blocks of size 2^( 5) =       0.000428868839
  error estimate for blocks of size 2^( 6) =       0.000431583937
  error estimate for blocks of size 2^( 7) =       0.000432325197

      target function =                  N/A
              le_mean =     -17.216553012317
             les_mean =     296.729042762745
             stat err =       0.000429508174
             autocorr =       1.155346724998
              std dev =       0.565106447039
             le_variance =       0.319345296486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321904227721
                                         uncertainty =       0.005321061409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321904227721
                                         uncertainty =       0.005321061409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401238091
  error estimate for blocks of size 2^( 2) =       0.000410985668
  error estimate for blocks of size 2^( 3) =       0.000419627428
  error estimate for blocks of size 2^( 4) =       0.000426533754
  error estimate for blocks of size 2^( 5) =       0.000430073946
  error estimate for blocks of size 2^( 6) =       0.000432737841
  error estimate for blocks of size 2^( 7) =       0.000433386807

      target function =                  N/A
              le_mean =     -17.216580746892
             les_mean =     296.732636463808
             stat err =       0.000430683087
             autocorr =       1.152156104071
              std dev =       0.567436349344
             le_variance =       0.321984010557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322111513904
                                         uncertainty =       0.005329934392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322111513904
                                         uncertainty =       0.005329934392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401367239
  error estimate for blocks of size 2^( 2) =       0.000411114376
  error estimate for blocks of size 2^( 3) =       0.000419759259
  error estimate for blocks of size 2^( 4) =       0.000426671348
  error estimate for blocks of size 2^( 5) =       0.000430214974
  error estimate for blocks of size 2^( 6) =       0.000432867363
  error estimate for blocks of size 2^( 7) =       0.000433536938

      target function =                  N/A
              le_mean =     -17.216582823785
             les_mean =     296.732915288117
             stat err =       0.000430822656
             autocorr =       1.152161145577
              std dev =       0.567618992769
             le_variance =       0.322191320952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319860453891
                                         uncertainty =       0.005327275656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319860453891
                                         uncertainty =       0.005327275656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399961826
  error estimate for blocks of size 2^( 2) =       0.000409788019
  error estimate for blocks of size 2^( 3) =       0.000418536210
  error estimate for blocks of size 2^( 4) =       0.000425547900
  error estimate for blocks of size 2^( 5) =       0.000429147609
  error estimate for blocks of size 2^( 6) =       0.000431847650
  error estimate for blocks of size 2^( 7) =       0.000432578588

      target function =                  N/A
              le_mean =     -17.216554249822
             les_mean =     296.729679001940
             stat err =       0.000429780437
             autocorr =       1.154665528716
              std dev =       0.565631439058
             le_variance =       0.319938924851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216553012317        initial
     1.5625e-02     1.5625e-01             2.1726e-02       -17.216580746892
     6.2500e-02     6.2500e-01             8.6103e-03       -17.216582823785  <--
     2.5000e-01     2.5000e+00             2.8091e-03       -17.216554249822

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9600e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.099529e-01 1 1  ON 0
 uu_1                 4.837243e-02 1 1  ON 1
 uu_2                -4.573838e-02 1 1  ON 2
 uu_3                -1.000312e-01 1 1  ON 3
 uu_4                -1.323796e-01 1 1  ON 4
 uu_5                -1.381314e-01 1 1  ON 5
 uu_6                -1.150005e-01 1 1  ON 6
 uu_7                -4.152170e-02 1 1  ON 7
 uu_8                 9.882427e-02 1 1  ON 8
 uu_9                 1.218220e-01 1 1  ON 9
 ud_0                 3.507052e-01 1 1  ON 10
 ud_1                 9.255113e-02 1 1  ON 11
 ud_2                -1.608838e-02 1 1  ON 12
 ud_3                -7.572262e-02 1 1  ON 13
 ud_4                -1.220158e-01 1 1  ON 14
 ud_5                -1.523024e-01 1 1  ON 15
 ud_6                -1.540264e-01 1 1  ON 16
 ud_7                -1.113248e-01 1 1  ON 17
 ud_8                 2.372826e-03 1 1  ON 18
 ud_9                 9.258024e-02 1 1  ON 19
 eO_0                -7.610183e-01 1 1  ON 20
 eO_1                -4.429622e-01 1 1  ON 21
 eO_2                -3.894240e-02 1 1  ON 22
 eO_3                 2.106539e-01 1 1  ON 23
 eO_4                 2.989141e-01 1 1  ON 24
 eO_5                 3.094244e-01 1 1  ON 25
 eO_6                 2.516974e-01 1 1  ON 26
 eO_7                 1.145674e-01 1 1  ON 27
 eO_8                 2.843957e-02 1 1  ON 28
 eO_9                 1.858600e-02 1 1  ON 29
eH1_0                -1.820026e-01 1 1  ON 30
eH1_1                -1.029266e-01 1 1  ON 31
eH1_2                -6.236209e-02 1 1  ON 32
eH1_3                -2.550464e-02 1 1  ON 33
eH1_4                 1.952473e-02 1 1  ON 34
eH1_5                 3.366853e-02 1 1  ON 35
eH1_6                 7.705534e-02 1 1  ON 36
eH1_7                 1.100565e-01 1 1  ON 37
eH1_8                 9.235631e-02 1 1  ON 38
eH1_9                 2.473113e-02 1 1  ON 39
eH2_0                -1.839180e-01 1 1  ON 40
eH2_1                -1.044011e-01 1 1  ON 41
eH2_2                -6.366697e-02 1 1  ON 42
eH2_3                -2.672381e-02 1 1  ON 43
eH2_4                 1.847295e-02 1 1  ON 44
eH2_5                 3.375311e-02 1 1  ON 45
eH2_6                 7.877831e-02 1 1  ON 46
eH2_7                 1.135429e-01 1 1  ON 47
eH2_8                 9.515796e-02 1 1  ON 48
eH2_9                 2.678762e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5449e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7242e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.222899
====================================================
  Execution time = 2.0359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2341e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323451682521
                                         uncertainty =       0.005547049592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323451682521
                                         uncertainty =       0.005547049592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402122666
  error estimate for blocks of size 2^( 2) =       0.000411883033
  error estimate for blocks of size 2^( 3) =       0.000420625347
  error estimate for blocks of size 2^( 4) =       0.000427562633
  error estimate for blocks of size 2^( 5) =       0.000431874816
  error estimate for blocks of size 2^( 6) =       0.000433258646
  error estimate for blocks of size 2^( 7) =       0.000435477040

      target function =                  N/A
              le_mean =     -17.216827731833
             les_mean =     296.742562262182
             stat err =       0.000432043284
             autocorr =       1.154349745039
              std dev =       0.568687327334
             le_variance =       0.323405276270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682773183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827731833       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829664751       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216830900194       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216833303062       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835386130       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835584063       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216842991651       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216843631970       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216844526748       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216848942277       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216847005897       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216851281491       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216854947569       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216854915495       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216855325764       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216857420247       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216856939382       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216856385545       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216857045660       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216856977946       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.702472e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827731833       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829384706       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216830191754       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216831628611       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216832814208       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216832550880       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835873478       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216835730490       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216836067305       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216837332952       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216836480436       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216837375543       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216838142879       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216837865903       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.275647e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827731833       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216828778269       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216829073925       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829483562       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829840733       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216829673950       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216830491528       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216830380985       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216830484778       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216830649694       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.933368e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5889e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.115736e-01 1 1  ON 0
 uu_1                 4.963221e-02 1 1  ON 1
 uu_2                -4.504739e-02 1 1  ON 2
 uu_3                -9.974443e-02 1 1  ON 3
 uu_4                -1.330097e-01 1 1  ON 4
 uu_5                -1.393206e-01 1 1  ON 5
 uu_6                -1.158177e-01 1 1  ON 6
 uu_7                -4.353696e-02 1 1  ON 7
 uu_8                 9.762879e-02 1 1  ON 8
 uu_9                 1.227229e-01 1 1  ON 9
 ud_0                 3.520564e-01 1 1  ON 10
 ud_1                 9.369804e-02 1 1  ON 11
 ud_2                -1.529089e-02 1 1  ON 12
 ud_3                -7.556923e-02 1 1  ON 13
 ud_4                -1.225992e-01 1 1  ON 14
 ud_5                -1.536251e-01 1 1  ON 15
 ud_6                -1.543457e-01 1 1  ON 16
 ud_7                -1.114456e-01 1 1  ON 17
 ud_8                 5.643304e-04 1 1  ON 18
 ud_9                 9.243735e-02 1 1  ON 19
 eO_0                -7.672939e-01 1 1  ON 20
 eO_1                -4.480181e-01 1 1  ON 21
 eO_2                -4.136821e-02 1 1  ON 22
 eO_3                 2.121460e-01 1 1  ON 23
 eO_4                 3.039928e-01 1 1  ON 24
 eO_5                 3.124159e-01 1 1  ON 25
 eO_6                 2.533833e-01 1 1  ON 26
 eO_7                 1.165655e-01 1 1  ON 27
 eO_8                 2.873413e-02 1 1  ON 28
 eO_9                 1.871285e-02 1 1  ON 29
eH1_0                -1.826365e-01 1 1  ON 30
eH1_1                -1.035751e-01 1 1  ON 31
eH1_2                -6.258749e-02 1 1  ON 32
eH1_3                -2.570745e-02 1 1  ON 33
eH1_4                 1.954244e-02 1 1  ON 34
eH1_5                 3.319896e-02 1 1  ON 35
eH1_6                 7.741541e-02 1 1  ON 36
eH1_7                 1.102541e-01 1 1  ON 37
eH1_8                 9.351618e-02 1 1  ON 38
eH1_9                 2.509924e-02 1 1  ON 39
eH2_0                -1.837907e-01 1 1  ON 40
eH2_1                -1.053852e-01 1 1  ON 41
eH2_2                -6.405043e-02 1 1  ON 42
eH2_3                -2.670360e-02 1 1  ON 43
eH2_4                 1.890348e-02 1 1  ON 44
eH2_5                 3.311662e-02 1 1  ON 45
eH2_6                 7.873029e-02 1 1  ON 46
eH2_7                 1.133758e-01 1 1  ON 47
eH2_8                 9.637355e-02 1 1  ON 48
eH2_9                 2.710787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.202198
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1837e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317650021879
                                         uncertainty =       0.003483942264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317650021879
                                         uncertainty =       0.003483942264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398509785
  error estimate for blocks of size 2^( 2) =       0.000408125817
  error estimate for blocks of size 2^( 3) =       0.000417075484
  error estimate for blocks of size 2^( 4) =       0.000423433756
  error estimate for blocks of size 2^( 5) =       0.000428064741
  error estimate for blocks of size 2^( 6) =       0.000429520877
  error estimate for blocks of size 2^( 7) =       0.000430700084

      target function =                  N/A
              le_mean =     -17.216591488671
             les_mean =     296.728642426900
             stat err =       0.000427929864
             autocorr =       1.153100637752
              std dev =       0.563577943093
             le_variance =       0.317620097941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319229306363
                                         uncertainty =       0.003479725127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319229306363
                                         uncertainty =       0.003479725127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399499168
  error estimate for blocks of size 2^( 2) =       0.000409053022
  error estimate for blocks of size 2^( 3) =       0.000417921080
  error estimate for blocks of size 2^( 4) =       0.000424195083
  error estimate for blocks of size 2^( 5) =       0.000428774423
  error estimate for blocks of size 2^( 6) =       0.000430213956
  error estimate for blocks of size 2^( 7) =       0.000431399412

      target function =                  N/A
              le_mean =     -17.216587955417
             les_mean =     296.730099837308
             stat err =       0.000428645719
             autocorr =       1.151238281188
              std dev =       0.564977141387
             le_variance =       0.319199170290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319181815761
                                         uncertainty =       0.003475771962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319181815761
                                         uncertainty =       0.003475771962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399469504
  error estimate for blocks of size 2^( 2) =       0.000409030639
  error estimate for blocks of size 2^( 3) =       0.000417912164
  error estimate for blocks of size 2^( 4) =       0.000424198761
  error estimate for blocks of size 2^( 5) =       0.000428782317
  error estimate for blocks of size 2^( 6) =       0.000430206816
  error estimate for blocks of size 2^( 7) =       0.000431397904

      target function =                  N/A
              le_mean =     -17.216585785407
             les_mean =     296.729977716323
             stat err =       0.000428646449
             autocorr =       1.151413190318
              std dev =       0.564935190638
             le_variance =       0.319151769621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317911493370
                                         uncertainty =       0.003481314569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317911493370
                                         uncertainty =       0.003481314569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398673795
  error estimate for blocks of size 2^( 2) =       0.000408279671
  error estimate for blocks of size 2^( 3) =       0.000417217637
  error estimate for blocks of size 2^( 4) =       0.000423563493
  error estimate for blocks of size 2^( 5) =       0.000428185988
  error estimate for blocks of size 2^( 6) =       0.000429632358
  error estimate for blocks of size 2^( 7) =       0.000430814891

      target function =                  N/A
              le_mean =     -17.216587769934
             les_mean =     296.728775870656
             stat err =       0.000428049182
             autocorr =       1.152794678593
              std dev =       0.563809887940
             le_variance =       0.317881589739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216591488671        initial  <--
     1.5625e-02     1.5625e-01             1.7025e-02       -17.216587955417
     6.2500e-02     6.2500e-01             6.2756e-03       -17.216585785407
     2.5000e-01     2.5000e+00             1.9334e-03       -17.216587769934

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3817
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.099529e-01 1 1  ON 0
 uu_1                 4.837243e-02 1 1  ON 1
 uu_2                -4.573838e-02 1 1  ON 2
 uu_3                -1.000312e-01 1 1  ON 3
 uu_4                -1.323796e-01 1 1  ON 4
 uu_5                -1.381314e-01 1 1  ON 5
 uu_6                -1.150005e-01 1 1  ON 6
 uu_7                -4.152170e-02 1 1  ON 7
 uu_8                 9.882427e-02 1 1  ON 8
 uu_9                 1.218220e-01 1 1  ON 9
 ud_0                 3.507052e-01 1 1  ON 10
 ud_1                 9.255113e-02 1 1  ON 11
 ud_2                -1.608838e-02 1 1  ON 12
 ud_3                -7.572262e-02 1 1  ON 13
 ud_4                -1.220158e-01 1 1  ON 14
 ud_5                -1.523024e-01 1 1  ON 15
 ud_6                -1.540264e-01 1 1  ON 16
 ud_7                -1.113248e-01 1 1  ON 17
 ud_8                 2.372826e-03 1 1  ON 18
 ud_9                 9.258024e-02 1 1  ON 19
 eO_0                -7.610183e-01 1 1  ON 20
 eO_1                -4.429622e-01 1 1  ON 21
 eO_2                -3.894240e-02 1 1  ON 22
 eO_3                 2.106539e-01 1 1  ON 23
 eO_4                 2.989141e-01 1 1  ON 24
 eO_5                 3.094244e-01 1 1  ON 25
 eO_6                 2.516974e-01 1 1  ON 26
 eO_7                 1.145674e-01 1 1  ON 27
 eO_8                 2.843957e-02 1 1  ON 28
 eO_9                 1.858600e-02 1 1  ON 29
eH1_0                -1.820026e-01 1 1  ON 30
eH1_1                -1.029266e-01 1 1  ON 31
eH1_2                -6.236209e-02 1 1  ON 32
eH1_3                -2.550464e-02 1 1  ON 33
eH1_4                 1.952473e-02 1 1  ON 34
eH1_5                 3.366853e-02 1 1  ON 35
eH1_6                 7.705534e-02 1 1  ON 36
eH1_7                 1.100565e-01 1 1  ON 37
eH1_8                 9.235631e-02 1 1  ON 38
eH1_9                 2.473113e-02 1 1  ON 39
eH2_0                -1.839180e-01 1 1  ON 40
eH2_1                -1.044011e-01 1 1  ON 41
eH2_2                -6.366697e-02 1 1  ON 42
eH2_3                -2.672381e-02 1 1  ON 43
eH2_4                 1.847295e-02 1 1  ON 44
eH2_5                 3.375311e-02 1 1  ON 45
eH2_6                 7.877831e-02 1 1  ON 46
eH2_7                 1.135429e-01 1 1  ON 47
eH2_8                 9.515796e-02 1 1  ON 48
eH2_9                 2.678762e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5277e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.278365
====================================================
  Execution time = 2.0441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314622439889
                                         uncertainty =       0.005029507015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314622439889
                                         uncertainty =       0.005029507015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396595679
  error estimate for blocks of size 2^( 2) =       0.000406305229
  error estimate for blocks of size 2^( 3) =       0.000415362206
  error estimate for blocks of size 2^( 4) =       0.000421217980
  error estimate for blocks of size 2^( 5) =       0.000425379836
  error estimate for blocks of size 2^( 6) =       0.000427427647
  error estimate for blocks of size 2^( 7) =       0.000426743674

      target function =                  N/A
              le_mean =     -17.216322877109
             les_mean =     296.716349516492
             stat err =       0.000425192284
             autocorr =       1.149409530428
              std dev =       0.560870987770
             le_variance =       0.314576264922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632287711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322877109       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216323345940       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216323136797       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216323439862       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216322000722       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216323898090       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216324044854       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216325991369       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216326760097       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216326137236       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216326302802       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.724761e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322877109       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216323129031       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216323002140       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216323213688       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216323082932       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216323575864       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216323686577       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216324046605       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 7.252156e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322877109       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216322965483       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216322924616       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216322993414       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216323048664       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216323107176       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216323166253       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216323182475       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.873028e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6020e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.103149e-01 1 1  ON 0
 uu_1                 4.849392e-02 1 1  ON 1
 uu_2                -4.570906e-02 1 1  ON 2
 uu_3                -9.991759e-02 1 1  ON 3
 uu_4                -1.323611e-01 1 1  ON 4
 uu_5                -1.383324e-01 1 1  ON 5
 uu_6                -1.152435e-01 1 1  ON 6
 uu_7                -4.173404e-02 1 1  ON 7
 uu_8                 9.866901e-02 1 1  ON 8
 uu_9                 1.218978e-01 1 1  ON 9
 ud_0                 3.510575e-01 1 1  ON 10
 ud_1                 9.275518e-02 1 1  ON 11
 ud_2                -1.600457e-02 1 1  ON 12
 ud_3                -7.580945e-02 1 1  ON 13
 ud_4                -1.220671e-01 1 1  ON 14
 ud_5                -1.525240e-01 1 1  ON 15
 ud_6                -1.540711e-01 1 1  ON 16
 ud_7                -1.113978e-01 1 1  ON 17
 ud_8                 2.142421e-03 1 1  ON 18
 ud_9                 9.257291e-02 1 1  ON 19
 eO_0                -7.617435e-01 1 1  ON 20
 eO_1                -4.436357e-01 1 1  ON 21
 eO_2                -3.909704e-02 1 1  ON 22
 eO_3                 2.109891e-01 1 1  ON 23
 eO_4                 2.995017e-01 1 1  ON 24
 eO_5                 3.097147e-01 1 1  ON 25
 eO_6                 2.518105e-01 1 1  ON 26
 eO_7                 1.147569e-01 1 1  ON 27
 eO_8                 2.846525e-02 1 1  ON 28
 eO_9                 1.859035e-02 1 1  ON 29
eH1_0                -1.820856e-01 1 1  ON 30
eH1_1                -1.029675e-01 1 1  ON 31
eH1_2                -6.238436e-02 1 1  ON 32
eH1_3                -2.562394e-02 1 1  ON 33
eH1_4                 1.949168e-02 1 1  ON 34
eH1_5                 3.381516e-02 1 1  ON 35
eH1_6                 7.713542e-02 1 1  ON 36
eH1_7                 1.100060e-01 1 1  ON 37
eH1_8                 9.244117e-02 1 1  ON 38
eH1_9                 2.475962e-02 1 1  ON 39
eH2_0                -1.838647e-01 1 1  ON 40
eH2_1                -1.044284e-01 1 1  ON 41
eH2_2                -6.363872e-02 1 1  ON 42
eH2_3                -2.685953e-02 1 1  ON 43
eH2_4                 1.847160e-02 1 1  ON 44
eH2_5                 3.376867e-02 1 1  ON 45
eH2_6                 7.873448e-02 1 1  ON 46
eH2_7                 1.134943e-01 1 1  ON 47
eH2_8                 9.527561e-02 1 1  ON 48
eH2_9                 2.682508e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.267484
====================================================
  Execution time = 2.2005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1664e-01
  Total weights = 2.0000e+06
  Execution time = 1.8507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316453362778
                                         uncertainty =       0.004648711567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316453362778
                                         uncertainty =       0.004648711567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397738659
  error estimate for blocks of size 2^( 2) =       0.000407204969
  error estimate for blocks of size 2^( 3) =       0.000415633559
  error estimate for blocks of size 2^( 4) =       0.000421943068
  error estimate for blocks of size 2^( 5) =       0.000426609611
  error estimate for blocks of size 2^( 6) =       0.000430150594
  error estimate for blocks of size 2^( 7) =       0.000430185512

      target function =                  N/A
              le_mean =     -17.216867051466
             les_mean =     296.736902991324
             stat err =       0.000427222196
             autocorr =       1.153750775298
              std dev =       0.562487405784
             le_variance =       0.316392081666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317073996941
                                         uncertainty =       0.004659839264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317073996941
                                         uncertainty =       0.004659839264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398128374
  error estimate for blocks of size 2^( 2) =       0.000407577621
  error estimate for blocks of size 2^( 3) =       0.000415982811
  error estimate for blocks of size 2^( 4) =       0.000422267630
  error estimate for blocks of size 2^( 5) =       0.000426920064
  error estimate for blocks of size 2^( 6) =       0.000430447072
  error estimate for blocks of size 2^( 7) =       0.000430472122

      target function =                  N/A
              le_mean =     -17.216867942184
             les_mean =     296.737553984963
             stat err =       0.000427526722
             autocorr =       1.153135306085
              std dev =       0.563038546518
             le_variance =       0.317012404865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316960542233
                                         uncertainty =       0.004659615114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316960542233
                                         uncertainty =       0.004659615114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398057156
  error estimate for blocks of size 2^( 2) =       0.000407511119
  error estimate for blocks of size 2^( 3) =       0.000415924098
  error estimate for blocks of size 2^( 4) =       0.000422215086
  error estimate for blocks of size 2^( 5) =       0.000426871290
  error estimate for blocks of size 2^( 6) =       0.000430400839
  error estimate for blocks of size 2^( 7) =       0.000430425854

      target function =                  N/A
              le_mean =     -17.216867589877
             les_mean =     296.737428447960
             stat err =       0.000427478268
             autocorr =       1.153286503207
              std dev =       0.562937828754
             le_variance =       0.316898999042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316533725542
                                         uncertainty =       0.004650537508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316533725542
                                         uncertainty =       0.004650537508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397789141
  error estimate for blocks of size 2^( 2) =       0.000407253451
  error estimate for blocks of size 2^( 3) =       0.000415679671
  error estimate for blocks of size 2^( 4) =       0.000421986322
  error estimate for blocks of size 2^( 5) =       0.000426651380
  error estimate for blocks of size 2^( 6) =       0.000430190430
  error estimate for blocks of size 2^( 7) =       0.000430223533

      target function =                  N/A
              le_mean =     -17.216866956613
             les_mean =     296.736980045256
             stat err =       0.000427262916
             autocorr =       1.153677845919
              std dev =       0.562558798503
             le_variance =       0.316472401773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216867051466        initial
     1.5625e-01     1.5625e+00             2.7248e-03       -17.216867942184  <--
     6.2500e-01     6.2500e+00             7.2522e-04       -17.216867589877
     2.5000e+00     2.5000e+01             1.8730e-04       -17.216866956613

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.1271e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.109760e-01 1 1  ON 0
 uu_1                 4.891236e-02 1 1  ON 1
 uu_2                -4.541666e-02 1 1  ON 2
 uu_3                -9.970995e-02 1 1  ON 3
 uu_4                -1.323335e-01 1 1  ON 4
 uu_5                -1.387777e-01 1 1  ON 5
 uu_6                -1.158257e-01 1 1  ON 6
 uu_7                -4.234934e-02 1 1  ON 7
 uu_8                 9.819404e-02 1 1  ON 8
 uu_9                 1.221300e-01 1 1  ON 9
 ud_0                 3.516794e-01 1 1  ON 10
 ud_1                 9.321283e-02 1 1  ON 11
 ud_2                -1.574368e-02 1 1  ON 12
 ud_3                -7.581895e-02 1 1  ON 13
 ud_4                -1.222119e-01 1 1  ON 14
 ud_5                -1.529268e-01 1 1  ON 15
 ud_6                -1.541925e-01 1 1  ON 16
 ud_7                -1.115840e-01 1 1  ON 17
 ud_8                 1.457253e-03 1 1  ON 18
 ud_9                 9.255195e-02 1 1  ON 19
 eO_0                -7.637430e-01 1 1  ON 20
 eO_1                -4.452781e-01 1 1  ON 21
 eO_2                -3.977996e-02 1 1  ON 22
 eO_3                 2.115717e-01 1 1  ON 23
 eO_4                 3.011572e-01 1 1  ON 24
 eO_5                 3.107167e-01 1 1  ON 25
 eO_6                 2.521929e-01 1 1  ON 26
 eO_7                 1.153429e-01 1 1  ON 27
 eO_8                 2.854471e-02 1 1  ON 28
 eO_9                 1.860371e-02 1 1  ON 29
eH1_0                -1.822985e-01 1 1  ON 30
eH1_1                -1.031346e-01 1 1  ON 31
eH1_2                -6.252135e-02 1 1  ON 32
eH1_3                -2.580260e-02 1 1  ON 33
eH1_4                 1.942279e-02 1 1  ON 34
eH1_5                 3.406612e-02 1 1  ON 35
eH1_6                 7.739763e-02 1 1  ON 36
eH1_7                 1.098772e-01 1 1  ON 37
eH1_8                 9.270539e-02 1 1  ON 38
eH1_9                 2.484748e-02 1 1  ON 39
eH2_0                -1.838303e-01 1 1  ON 40
eH2_1                -1.045240e-01 1 1  ON 41
eH2_2                -6.368507e-02 1 1  ON 42
eH2_3                -2.702054e-02 1 1  ON 43
eH2_4                 1.845424e-02 1 1  ON 44
eH2_5                 3.377432e-02 1 1  ON 45
eH2_6                 7.864979e-02 1 1  ON 46
eH2_7                 1.133662e-01 1 1  ON 47
eH2_8                 9.563893e-02 1 1  ON 48
eH2_9                 2.694048e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2464
    reference variance = 0.233407
====================================================
  Execution time = 2.0538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348781548916
                                         uncertainty =       0.030168627914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348781548916
                                         uncertainty =       0.030168627914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417529742
  error estimate for blocks of size 2^( 2) =       0.000426647239
  error estimate for blocks of size 2^( 3) =       0.000435126096
  error estimate for blocks of size 2^( 4) =       0.000441008874
  error estimate for blocks of size 2^( 5) =       0.000443719275
  error estimate for blocks of size 2^( 6) =       0.000446273581
  error estimate for blocks of size 2^( 7) =       0.000446081017

      target function =                  N/A
              le_mean =     -17.216508628068
             les_mean =     296.756831337011
             stat err =       0.000444270687
             autocorr =       1.132193047937
              std dev =       0.590476223902
             le_variance =       0.348662170993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650862807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508628068       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216509239624       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216511867023       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216509707472       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216512264041       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216518642028       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216518425560       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216518571279       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216518652869       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216522120913       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216522967077       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216522465438       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216523227262       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216523357776       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216523305676       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 8.632352e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508628068       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216509056792       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216509820362       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216511374599       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216510176476       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216513104535       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216512380976       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216512557112       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216512671787       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216513254000       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216513182618       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.751827e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508628068       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508823311       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508750554       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216509632171       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216509151847       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216509504506       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216509842091       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216509752290       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 7.421036e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6087e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.115538e-01 1 1  ON 0
 uu_1                 4.944125e-02 1 1  ON 1
 uu_2                -4.514966e-02 1 1  ON 2
 uu_3                -9.996987e-02 1 1  ON 3
 uu_4                -1.330749e-01 1 1  ON 4
 uu_5                -1.394399e-01 1 1  ON 5
 uu_6                -1.159805e-01 1 1  ON 6
 uu_7                -4.253181e-02 1 1  ON 7
 uu_8                 9.791988e-02 1 1  ON 8
 uu_9                 1.225246e-01 1 1  ON 9
 ud_0                 3.518292e-01 1 1  ON 10
 ud_1                 9.344483e-02 1 1  ON 11
 ud_2                -1.549682e-02 1 1  ON 12
 ud_3                -7.555685e-02 1 1  ON 13
 ud_4                -1.223932e-01 1 1  ON 14
 ud_5                -1.533417e-01 1 1  ON 15
 ud_6                -1.545774e-01 1 1  ON 16
 ud_7                -1.114930e-01 1 1  ON 17
 ud_8                 9.442068e-04 1 1  ON 18
 ud_9                 9.262172e-02 1 1  ON 19
 eO_0                -7.664949e-01 1 1  ON 20
 eO_1                -4.475377e-01 1 1  ON 21
 eO_2                -4.071130e-02 1 1  ON 22
 eO_3                 2.123404e-01 1 1  ON 23
 eO_4                 3.028530e-01 1 1  ON 24
 eO_5                 3.121972e-01 1 1  ON 25
 eO_6                 2.531560e-01 1 1  ON 26
 eO_7                 1.161399e-01 1 1  ON 27
 eO_8                 2.866702e-02 1 1  ON 28
 eO_9                 1.867524e-02 1 1  ON 29
eH1_0                -1.823241e-01 1 1  ON 30
eH1_1                -1.032609e-01 1 1  ON 31
eH1_2                -6.231582e-02 1 1  ON 32
eH1_3                -2.579678e-02 1 1  ON 33
eH1_4                 1.914915e-02 1 1  ON 34
eH1_5                 3.357876e-02 1 1  ON 35
eH1_6                 7.727608e-02 1 1  ON 36
eH1_7                 1.098353e-01 1 1  ON 37
eH1_8                 9.327084e-02 1 1  ON 38
eH1_9                 2.506733e-02 1 1  ON 39
eH2_0                -1.840716e-01 1 1  ON 40
eH2_1                -1.046919e-01 1 1  ON 41
eH2_2                -6.382583e-02 1 1  ON 42
eH2_3                -2.709574e-02 1 1  ON 43
eH2_4                 1.813893e-02 1 1  ON 44
eH2_5                 3.376976e-02 1 1  ON 45
eH2_6                 7.880403e-02 1 1  ON 46
eH2_7                 1.134039e-01 1 1  ON 47
eH2_8                 9.619794e-02 1 1  ON 48
eH2_9                 2.707942e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.278647
====================================================
  Execution time = 2.0357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1423e-01
  Total weights = 2.0000e+06
  Execution time = 1.8436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314174647446
                                         uncertainty =       0.003100982119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314174647446
                                         uncertainty =       0.003100982119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396295821
  error estimate for blocks of size 2^( 2) =       0.000406221707
  error estimate for blocks of size 2^( 3) =       0.000414555777
  error estimate for blocks of size 2^( 4) =       0.000421353637
  error estimate for blocks of size 2^( 5) =       0.000425248931
  error estimate for blocks of size 2^( 6) =       0.000426675829
  error estimate for blocks of size 2^( 7) =       0.000427503628

      target function =                  N/A
              le_mean =     -17.216806643923
             les_mean =     296.732531612902
             stat err =       0.000425195506
             autocorr =       1.151167040222
              std dev =       0.560446924973
             le_variance =       0.314100755712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314755873540
                                         uncertainty =       0.003110042020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314755873540
                                         uncertainty =       0.003110042020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396662071
  error estimate for blocks of size 2^( 2) =       0.000406566881
  error estimate for blocks of size 2^( 3) =       0.000414865920
  error estimate for blocks of size 2^( 4) =       0.000421642831
  error estimate for blocks of size 2^( 5) =       0.000425532878
  error estimate for blocks of size 2^( 6) =       0.000426916328
  error estimate for blocks of size 2^( 7) =       0.000427722737

      target function =                  N/A
              le_mean =     -17.216811999820
             les_mean =     296.733296876391
             stat err =       0.000425453693
             autocorr =       1.150438075691
              std dev =       0.560964879985
             le_variance =       0.314681596577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314452992899
                                         uncertainty =       0.003107202526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314452992899
                                         uncertainty =       0.003107202526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396471225
  error estimate for blocks of size 2^( 2) =       0.000406385156
  error estimate for blocks of size 2^( 3) =       0.000414698942
  error estimate for blocks of size 2^( 4) =       0.000421488203
  error estimate for blocks of size 2^( 5) =       0.000425382694
  error estimate for blocks of size 2^( 6) =       0.000426777414
  error estimate for blocks of size 2^( 7) =       0.000427588926

      target function =                  N/A
              le_mean =     -17.216812888406
             les_mean =     296.733024742423
             stat err =       0.000425309309
             autocorr =       1.150764435001
              std dev =       0.560694984122
             le_variance =       0.314378865219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314168754139
                                         uncertainty =       0.003101549764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314168754139
                                         uncertainty =       0.003101549764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396292090
  error estimate for blocks of size 2^( 2) =       0.000406216640
  error estimate for blocks of size 2^( 3) =       0.000414548503
  error estimate for blocks of size 2^( 4) =       0.000421345895
  error estimate for blocks of size 2^( 5) =       0.000425241497
  error estimate for blocks of size 2^( 6) =       0.000426663441
  error estimate for blocks of size 2^( 7) =       0.000427488828

      target function =                  N/A
              le_mean =     -17.216807140546
             les_mean =     296.732542799398
             stat err =       0.000425184915
             autocorr =       1.151131367146
              std dev =       0.560441648784
             le_variance =       0.314094841692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216806643923        initial
     3.9062e-02     3.9062e-01             8.6324e-03       -17.216811999820
     1.5625e-01     1.5625e+00             2.7518e-03       -17.216812888406  <--
     6.2500e-01     6.2500e+00             7.4210e-04       -17.216807140546

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9591e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.115538e-01 1 1  ON 0
 uu_1                 4.944125e-02 1 1  ON 1
 uu_2                -4.514966e-02 1 1  ON 2
 uu_3                -9.996987e-02 1 1  ON 3
 uu_4                -1.330749e-01 1 1  ON 4
 uu_5                -1.394399e-01 1 1  ON 5
 uu_6                -1.159805e-01 1 1  ON 6
 uu_7                -4.253181e-02 1 1  ON 7
 uu_8                 9.791988e-02 1 1  ON 8
 uu_9                 1.225246e-01 1 1  ON 9
 ud_0                 3.518292e-01 1 1  ON 10
 ud_1                 9.344483e-02 1 1  ON 11
 ud_2                -1.549682e-02 1 1  ON 12
 ud_3                -7.555685e-02 1 1  ON 13
 ud_4                -1.223932e-01 1 1  ON 14
 ud_5                -1.533417e-01 1 1  ON 15
 ud_6                -1.545774e-01 1 1  ON 16
 ud_7                -1.114930e-01 1 1  ON 17
 ud_8                 9.442068e-04 1 1  ON 18
 ud_9                 9.262172e-02 1 1  ON 19
 eO_0                -7.664949e-01 1 1  ON 20
 eO_1                -4.475377e-01 1 1  ON 21
 eO_2                -4.071130e-02 1 1  ON 22
 eO_3                 2.123404e-01 1 1  ON 23
 eO_4                 3.028530e-01 1 1  ON 24
 eO_5                 3.121972e-01 1 1  ON 25
 eO_6                 2.531560e-01 1 1  ON 26
 eO_7                 1.161399e-01 1 1  ON 27
 eO_8                 2.866702e-02 1 1  ON 28
 eO_9                 1.867524e-02 1 1  ON 29
eH1_0                -1.823241e-01 1 1  ON 30
eH1_1                -1.032609e-01 1 1  ON 31
eH1_2                -6.231582e-02 1 1  ON 32
eH1_3                -2.579678e-02 1 1  ON 33
eH1_4                 1.914915e-02 1 1  ON 34
eH1_5                 3.357876e-02 1 1  ON 35
eH1_6                 7.727608e-02 1 1  ON 36
eH1_7                 1.098353e-01 1 1  ON 37
eH1_8                 9.327084e-02 1 1  ON 38
eH1_9                 2.506733e-02 1 1  ON 39
eH2_0                -1.840716e-01 1 1  ON 40
eH2_1                -1.046919e-01 1 1  ON 41
eH2_2                -6.382583e-02 1 1  ON 42
eH2_3                -2.709574e-02 1 1  ON 43
eH2_4                 1.813893e-02 1 1  ON 44
eH2_5                 3.376976e-02 1 1  ON 45
eH2_6                 7.880403e-02 1 1  ON 46
eH2_7                 1.134039e-01 1 1  ON 47
eH2_8                 9.619794e-02 1 1  ON 48
eH2_9                 2.707942e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7236e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.237978
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325471301215
                                         uncertainty =       0.009962438677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325471301215
                                         uncertainty =       0.009962438677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403365053
  error estimate for blocks of size 2^( 2) =       0.000412875299
  error estimate for blocks of size 2^( 3) =       0.000421304759
  error estimate for blocks of size 2^( 4) =       0.000428021898
  error estimate for blocks of size 2^( 5) =       0.000432156157
  error estimate for blocks of size 2^( 6) =       0.000435081426
  error estimate for blocks of size 2^( 7) =       0.000437230165

      target function =                  N/A
              le_mean =     -17.216553901523
             les_mean =     296.735134812676
             stat err =       0.000433122412
             autocorr =       1.152987970472
              std dev =       0.570444327974
             le_variance =       0.325406731317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655390152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553901523       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216555715828       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216557009282       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216558068909       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216564403141       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567649102       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216565623537       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216563066371       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216564015779       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216564957213       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216564989136       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216564100296       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216565685566       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216565529057       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.914375e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553901523       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216555003119       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216555915369       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216556599918       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216558340547       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216559288951       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216558854988       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216558509208       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216558736027       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216558365770       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216558520698       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.476457e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553901523       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554329941       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554779938       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216555071541       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554939716       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216555387873       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216555493853       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216555545742       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.864946e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6020e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.120454e-01 1 1  ON 0
 uu_1                 4.964588e-02 1 1  ON 1
 uu_2                -4.508172e-02 1 1  ON 2
 uu_3                -9.998255e-02 1 1  ON 3
 uu_4                -1.332915e-01 1 1  ON 4
 uu_5                -1.395880e-01 1 1  ON 5
 uu_6                -1.163407e-01 1 1  ON 6
 uu_7                -4.304697e-02 1 1  ON 7
 uu_8                 9.752751e-02 1 1  ON 8
 uu_9                 1.229105e-01 1 1  ON 9
 ud_0                 3.523048e-01 1 1  ON 10
 ud_1                 9.407289e-02 1 1  ON 11
 ud_2                -1.517544e-02 1 1  ON 12
 ud_3                -7.546122e-02 1 1  ON 13
 ud_4                -1.224973e-01 1 1  ON 14
 ud_5                -1.535624e-01 1 1  ON 15
 ud_6                -1.550683e-01 1 1  ON 16
 ud_7                -1.118326e-01 1 1  ON 17
 ud_8                 3.115610e-04 1 1  ON 18
 ud_9                 9.253878e-02 1 1  ON 19
 eO_0                -7.689713e-01 1 1  ON 20
 eO_1                -4.494704e-01 1 1  ON 21
 eO_2                -4.187052e-02 1 1  ON 22
 eO_3                 2.125252e-01 1 1  ON 23
 eO_4                 3.052711e-01 1 1  ON 24
 eO_5                 3.137309e-01 1 1  ON 25
 eO_6                 2.535360e-01 1 1  ON 26
 eO_7                 1.169500e-01 1 1  ON 27
 eO_8                 2.881732e-02 1 1  ON 28
 eO_9                 1.872269e-02 1 1  ON 29
eH1_0                -1.827164e-01 1 1  ON 30
eH1_1                -1.035620e-01 1 1  ON 31
eH1_2                -6.265761e-02 1 1  ON 32
eH1_3                -2.583339e-02 1 1  ON 33
eH1_4                 1.924497e-02 1 1  ON 34
eH1_5                 3.379781e-02 1 1  ON 35
eH1_6                 7.739712e-02 1 1  ON 36
eH1_7                 1.097286e-01 1 1  ON 37
eH1_8                 9.384019e-02 1 1  ON 38
eH1_9                 2.522725e-02 1 1  ON 39
eH2_0                -1.841064e-01 1 1  ON 40
eH2_1                -1.046816e-01 1 1  ON 41
eH2_2                -6.393784e-02 1 1  ON 42
eH2_3                -2.721791e-02 1 1  ON 43
eH2_4                 1.818977e-02 1 1  ON 44
eH2_5                 3.348871e-02 1 1  ON 45
eH2_6                 7.895629e-02 1 1  ON 46
eH2_7                 1.131436e-01 1 1  ON 47
eH2_8                 9.657890e-02 1 1  ON 48
eH2_9                 2.722088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1213
    reference variance = 0.21455
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1829e-01
  Total weights = 2.0000e+06
  Execution time = 1.8498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318156100660
                                         uncertainty =       0.003672892459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318156100660
                                         uncertainty =       0.003672892459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398794437
  error estimate for blocks of size 2^( 2) =       0.000408676427
  error estimate for blocks of size 2^( 3) =       0.000416854044
  error estimate for blocks of size 2^( 4) =       0.000423688808
  error estimate for blocks of size 2^( 5) =       0.000427783014
  error estimate for blocks of size 2^( 6) =       0.000430851227
  error estimate for blocks of size 2^( 7) =       0.000433826641

      target function =                  N/A
              le_mean =     -17.215860884035
             les_mean =     296.703939825967
             stat err =       0.000429037423
             autocorr =       1.157423154013
              std dev =       0.563980501938
             le_variance =       0.318074006566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318881257611
                                         uncertainty =       0.003678264347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318881257611
                                         uncertainty =       0.003678264347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399248576
  error estimate for blocks of size 2^( 2) =       0.000409107280
  error estimate for blocks of size 2^( 3) =       0.000417250166
  error estimate for blocks of size 2^( 4) =       0.000424052190
  error estimate for blocks of size 2^( 5) =       0.000428136612
  error estimate for blocks of size 2^( 6) =       0.000431180801
  error estimate for blocks of size 2^( 7) =       0.000434155003

      target function =                  N/A
              le_mean =     -17.215856619340
             les_mean =     296.704517828627
             stat err =       0.000429381152
             autocorr =       1.156642649214
              std dev =       0.564622750459
             le_variance =       0.318798850336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318601608653
                                         uncertainty =       0.003674397130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318601608653
                                         uncertainty =       0.003674397130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399073556
  error estimate for blocks of size 2^( 2) =       0.000408941106
  error estimate for blocks of size 2^( 3) =       0.000417097197
  error estimate for blocks of size 2^( 4) =       0.000423910859
  error estimate for blocks of size 2^( 5) =       0.000428003878
  error estimate for blocks of size 2^( 6) =       0.000431050146
  error estimate for blocks of size 2^( 7) =       0.000434031904

      target function =                  N/A
              le_mean =     -17.215857648271
             les_mean =     296.704273812774
             stat err =       0.000429249197
             autocorr =       1.156945976449
              std dev =       0.564375235547
             le_variance =       0.318519406499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318206888129
                                         uncertainty =       0.003672588362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318206888129
                                         uncertainty =       0.003672588362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398826281
  error estimate for blocks of size 2^( 2) =       0.000408706077
  error estimate for blocks of size 2^( 3) =       0.000416880647
  error estimate for blocks of size 2^( 4) =       0.000423711867
  error estimate for blocks of size 2^( 5) =       0.000427806660
  error estimate for blocks of size 2^( 6) =       0.000430870711
  error estimate for blocks of size 2^( 7) =       0.000433847996

      target function =                  N/A
              le_mean =     -17.215859922810
             les_mean =     296.703957527899
             stat err =       0.000429059308
             autocorr =       1.157356403395
              std dev =       0.564025535904
             le_variance =       0.318124805152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215860884035        initial  <--
     3.9062e-02     3.9062e-01             7.9144e-03       -17.215856619340
     1.5625e-01     1.5625e+00             2.4765e-03       -17.215857648271
     6.2500e-01     6.2500e+00             6.8649e-04       -17.215859922810

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4530
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.115538e-01 1 1  ON 0
 uu_1                 4.944125e-02 1 1  ON 1
 uu_2                -4.514966e-02 1 1  ON 2
 uu_3                -9.996987e-02 1 1  ON 3
 uu_4                -1.330749e-01 1 1  ON 4
 uu_5                -1.394399e-01 1 1  ON 5
 uu_6                -1.159805e-01 1 1  ON 6
 uu_7                -4.253181e-02 1 1  ON 7
 uu_8                 9.791988e-02 1 1  ON 8
 uu_9                 1.225246e-01 1 1  ON 9
 ud_0                 3.518292e-01 1 1  ON 10
 ud_1                 9.344483e-02 1 1  ON 11
 ud_2                -1.549682e-02 1 1  ON 12
 ud_3                -7.555685e-02 1 1  ON 13
 ud_4                -1.223932e-01 1 1  ON 14
 ud_5                -1.533417e-01 1 1  ON 15
 ud_6                -1.545774e-01 1 1  ON 16
 ud_7                -1.114930e-01 1 1  ON 17
 ud_8                 9.442068e-04 1 1  ON 18
 ud_9                 9.262172e-02 1 1  ON 19
 eO_0                -7.664949e-01 1 1  ON 20
 eO_1                -4.475377e-01 1 1  ON 21
 eO_2                -4.071130e-02 1 1  ON 22
 eO_3                 2.123404e-01 1 1  ON 23
 eO_4                 3.028530e-01 1 1  ON 24
 eO_5                 3.121972e-01 1 1  ON 25
 eO_6                 2.531560e-01 1 1  ON 26
 eO_7                 1.161399e-01 1 1  ON 27
 eO_8                 2.866702e-02 1 1  ON 28
 eO_9                 1.867524e-02 1 1  ON 29
eH1_0                -1.823241e-01 1 1  ON 30
eH1_1                -1.032609e-01 1 1  ON 31
eH1_2                -6.231582e-02 1 1  ON 32
eH1_3                -2.579678e-02 1 1  ON 33
eH1_4                 1.914915e-02 1 1  ON 34
eH1_5                 3.357876e-02 1 1  ON 35
eH1_6                 7.727608e-02 1 1  ON 36
eH1_7                 1.098353e-01 1 1  ON 37
eH1_8                 9.327084e-02 1 1  ON 38
eH1_9                 2.506733e-02 1 1  ON 39
eH2_0                -1.840716e-01 1 1  ON 40
eH2_1                -1.046919e-01 1 1  ON 41
eH2_2                -6.382583e-02 1 1  ON 42
eH2_3                -2.709574e-02 1 1  ON 43
eH2_4                 1.813893e-02 1 1  ON 44
eH2_5                 3.376976e-02 1 1  ON 45
eH2_6                 7.880403e-02 1 1  ON 46
eH2_7                 1.134039e-01 1 1  ON 47
eH2_8                 9.619794e-02 1 1  ON 48
eH2_9                 2.707942e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.199126
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313852446603
                                         uncertainty =       0.003007454332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313852446603
                                         uncertainty =       0.003007454332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396229618
  error estimate for blocks of size 2^( 2) =       0.000405675046
  error estimate for blocks of size 2^( 3) =       0.000413895127
  error estimate for blocks of size 2^( 4) =       0.000420147205
  error estimate for blocks of size 2^( 5) =       0.000424664957
  error estimate for blocks of size 2^( 6) =       0.000427201195
  error estimate for blocks of size 2^( 7) =       0.000426712210

      target function =                  N/A
              le_mean =     -17.216207396480
             les_mean =     296.711792782772
             stat err =       0.000424681392
             autocorr =       1.148768693140
              std dev =       0.560353300292
             le_variance =       0.313995821148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620739648e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216207396480       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216207350179       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216207491372       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216208904778       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216209542182       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216209366433       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216209356997       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216209494488       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216209370496       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.013387e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216207396480       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216207382106       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216207425592       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216207884439       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216208053717       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216207938583       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216208004110       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216207990794       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.744016e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216207396480       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216207392656       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216207404221       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216207528443       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216207570972       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216207540312       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216207555211       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.011848e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6079e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.115592e-01 1 1  ON 0
 uu_1                 4.949952e-02 1 1  ON 1
 uu_2                -4.515512e-02 1 1  ON 2
 uu_3                -9.993991e-02 1 1  ON 3
 uu_4                -1.331392e-01 1 1  ON 4
 uu_5                -1.394354e-01 1 1  ON 5
 uu_6                -1.159906e-01 1 1  ON 6
 uu_7                -4.259103e-02 1 1  ON 7
 uu_8                 9.788366e-02 1 1  ON 8
 uu_9                 1.225597e-01 1 1  ON 9
 ud_0                 3.519135e-01 1 1  ON 10
 ud_1                 9.347335e-02 1 1  ON 11
 ud_2                -1.547438e-02 1 1  ON 12
 ud_3                -7.558555e-02 1 1  ON 13
 ud_4                -1.224322e-01 1 1  ON 14
 ud_5                -1.533699e-01 1 1  ON 15
 ud_6                -1.545848e-01 1 1  ON 16
 ud_7                -1.114872e-01 1 1  ON 17
 ud_8                 8.685542e-04 1 1  ON 18
 ud_9                 9.261910e-02 1 1  ON 19
 eO_0                -7.667693e-01 1 1  ON 20
 eO_1                -4.477087e-01 1 1  ON 21
 eO_2                -4.082111e-02 1 1  ON 22
 eO_3                 2.123825e-01 1 1  ON 23
 eO_4                 3.030663e-01 1 1  ON 24
 eO_5                 3.123255e-01 1 1  ON 25
 eO_6                 2.532282e-01 1 1  ON 26
 eO_7                 1.162155e-01 1 1  ON 27
 eO_8                 2.867974e-02 1 1  ON 28
 eO_9                 1.868253e-02 1 1  ON 29
eH1_0                -1.823963e-01 1 1  ON 30
eH1_1                -1.032754e-01 1 1  ON 31
eH1_2                -6.236135e-02 1 1  ON 32
eH1_3                -2.584262e-02 1 1  ON 33
eH1_4                 1.918725e-02 1 1  ON 34
eH1_5                 3.361849e-02 1 1  ON 35
eH1_6                 7.730170e-02 1 1  ON 36
eH1_7                 1.098404e-01 1 1  ON 37
eH1_8                 9.332043e-02 1 1  ON 38
eH1_9                 2.508259e-02 1 1  ON 39
eH2_0                -1.840788e-01 1 1  ON 40
eH2_1                -1.047236e-01 1 1  ON 41
eH2_2                -6.383814e-02 1 1  ON 42
eH2_3                -2.707730e-02 1 1  ON 43
eH2_4                 1.817835e-02 1 1  ON 44
eH2_5                 3.373482e-02 1 1  ON 45
eH2_6                 7.879593e-02 1 1  ON 46
eH2_7                 1.133836e-01 1 1  ON 47
eH2_8                 9.623519e-02 1 1  ON 48
eH2_9                 2.709359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.212718
====================================================
  Execution time = 2.0238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2861e-01
  Total weights = 2.0000e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328656065044
                                         uncertainty =       0.006355552968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328656065044
                                         uncertainty =       0.006355552968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405305027
  error estimate for blocks of size 2^( 2) =       0.000414976347
  error estimate for blocks of size 2^( 3) =       0.000423764013
  error estimate for blocks of size 2^( 4) =       0.000430427718
  error estimate for blocks of size 2^( 5) =       0.000434625931
  error estimate for blocks of size 2^( 6) =       0.000435718286
  error estimate for blocks of size 2^( 7) =       0.000438028792

      target function =                  N/A
              le_mean =     -17.216703894673
             les_mean =     296.743437162278
             stat err =       0.000434700182
             autocorr =       1.150312033562
              std dev =       0.573187865963
             le_variance =       0.328544329688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328859111954
                                         uncertainty =       0.006355956575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328859111954
                                         uncertainty =       0.006355956575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405430185
  error estimate for blocks of size 2^( 2) =       0.000415095722
  error estimate for blocks of size 2^( 3) =       0.000423874530
  error estimate for blocks of size 2^( 4) =       0.000430531932
  error estimate for blocks of size 2^( 5) =       0.000434726894
  error estimate for blocks of size 2^( 6) =       0.000435814985
  error estimate for blocks of size 2^( 7) =       0.000438127038

      target function =                  N/A
              le_mean =     -17.216704832094
             les_mean =     296.743672380798
             stat err =       0.000434800212
             autocorr =       1.150131069566
              std dev =       0.573364866154
             le_variance =       0.328747269740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328791998003
                                         uncertainty =       0.006356036650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328791998003
                                         uncertainty =       0.006356036650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405388806
  error estimate for blocks of size 2^( 2) =       0.000415056580
  error estimate for blocks of size 2^( 3) =       0.000423838792
  error estimate for blocks of size 2^( 4) =       0.000430498609
  error estimate for blocks of size 2^( 5) =       0.000434694757
  error estimate for blocks of size 2^( 6) =       0.000435783437
  error estimate for blocks of size 2^( 7) =       0.000438095109

      target function =                  N/A
              le_mean =     -17.216704688920
             les_mean =     296.743600348789
             stat err =       0.000434767978
             autocorr =       1.150195317497
              std dev =       0.573306347130
             le_variance =       0.328680167660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328675507936
                                         uncertainty =       0.006355654072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328675507936
                                         uncertainty =       0.006355654072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405317011
  error estimate for blocks of size 2^( 2) =       0.000414987869
  error estimate for blocks of size 2^( 3) =       0.000423774797
  error estimate for blocks of size 2^( 4) =       0.000430437971
  error estimate for blocks of size 2^( 5) =       0.000434635928
  error estimate for blocks of size 2^( 6) =       0.000435727703
  error estimate for blocks of size 2^( 7) =       0.000438038359

      target function =                  N/A
              le_mean =     -17.216704014674
             les_mean =     296.743460722749
             stat err =       0.000434709990
             autocorr =       1.150295921437
              std dev =       0.573204813443
             le_variance =       0.328563758154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216703894673        initial
     3.9062e-01     3.9062e+00             1.0134e-03       -17.216704832094  <--
     1.5625e+00     1.5625e+01             2.7440e-04       -17.216704688920
     6.2500e+00     6.2500e+01             7.0118e-05       -17.216704014674

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9499e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.116307e-01 1 1  ON 0
 uu_1                 4.962133e-02 1 1  ON 1
 uu_2                -4.513693e-02 1 1  ON 2
 uu_3                -9.989958e-02 1 1  ON 3
 uu_4                -1.332667e-01 1 1  ON 4
 uu_5                -1.394853e-01 1 1  ON 5
 uu_6                -1.160219e-01 1 1  ON 6
 uu_7                -4.275768e-02 1 1  ON 7
 uu_8                 9.777780e-02 1 1  ON 8
 uu_9                 1.226640e-01 1 1  ON 9
 ud_0                 3.521000e-01 1 1  ON 10
 ud_1                 9.358288e-02 1 1  ON 11
 ud_2                -1.541635e-02 1 1  ON 12
 ud_3                -7.562579e-02 1 1  ON 13
 ud_4                -1.225374e-01 1 1  ON 14
 ud_5                -1.534690e-01 1 1  ON 15
 ud_6                -1.546077e-01 1 1  ON 16
 ud_7                -1.114649e-01 1 1  ON 17
 ud_8                 6.470233e-04 1 1  ON 18
 ud_9                 9.261175e-02 1 1  ON 19
 eO_0                -7.675082e-01 1 1  ON 20
 eO_1                -4.482470e-01 1 1  ON 21
 eO_2                -4.113758e-02 1 1  ON 22
 eO_3                 2.124645e-01 1 1  ON 23
 eO_4                 3.036703e-01 1 1  ON 24
 eO_5                 3.127166e-01 1 1  ON 25
 eO_6                 2.534483e-01 1 1  ON 26
 eO_7                 1.164413e-01 1 1  ON 27
 eO_8                 2.871769e-02 1 1  ON 28
 eO_9                 1.870420e-02 1 1  ON 29
eH1_0                -1.825808e-01 1 1  ON 30
eH1_1                -1.033488e-01 1 1  ON 31
eH1_2                -6.248091e-02 1 1  ON 32
eH1_3                -2.594393e-02 1 1  ON 33
eH1_4                 1.925284e-02 1 1  ON 34
eH1_5                 3.372394e-02 1 1  ON 35
eH1_6                 7.738338e-02 1 1  ON 36
eH1_7                 1.098592e-01 1 1  ON 37
eH1_8                 9.346845e-02 1 1  ON 38
eH1_9                 2.512803e-02 1 1  ON 39
eH2_0                -1.840987e-01 1 1  ON 40
eH2_1                -1.048013e-01 1 1  ON 41
eH2_2                -6.385437e-02 1 1  ON 42
eH2_3                -2.704186e-02 1 1  ON 43
eH2_4                 1.827138e-02 1 1  ON 44
eH2_5                 3.363216e-02 1 1  ON 45
eH2_6                 7.877340e-02 1 1  ON 46
eH2_7                 1.133255e-01 1 1  ON 47
eH2_8                 9.634641e-02 1 1  ON 48
eH2_9                 2.713577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2917
    reference variance = 0.342976
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1528e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315309355301
                                         uncertainty =       0.002562593458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315309355301
                                         uncertainty =       0.002562593458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397037239
  error estimate for blocks of size 2^( 2) =       0.000406433084
  error estimate for blocks of size 2^( 3) =       0.000415474422
  error estimate for blocks of size 2^( 4) =       0.000421862260
  error estimate for blocks of size 2^( 5) =       0.000424243923
  error estimate for blocks of size 2^( 6) =       0.000425680969
  error estimate for blocks of size 2^( 7) =       0.000427127403

      target function =                  N/A
              le_mean =     -17.217046443979
             les_mean =     296.741965235021
             stat err =       0.000424728639
             autocorr =       1.144354565927
              std dev =       0.561495448359
             le_variance =       0.315277138528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704644398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046443979       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217050541129       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217052754109       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217056008389       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217056679715       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217053135126       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217056433655       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217056260705       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217055379547       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217056868970       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217056303585       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217056443405       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.166897e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046443979       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048626800       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217049642182       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217051020377       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217051769196       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217050317698       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217051378527       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217050886990       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217051048148       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 9.055032e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217046443979       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217047204825       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217047539931       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217047986720       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217048428921       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047977842       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217048176301       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217048068957       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.462307e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.120087e-01 1 1  ON 0
 uu_1                 4.965292e-02 1 1  ON 1
 uu_2                -4.511493e-02 1 1  ON 2
 uu_3                -9.994548e-02 1 1  ON 3
 uu_4                -1.333362e-01 1 1  ON 4
 uu_5                -1.395715e-01 1 1  ON 5
 uu_6                -1.160650e-01 1 1  ON 6
 uu_7                -4.300944e-02 1 1  ON 7
 uu_8                 9.753716e-02 1 1  ON 8
 uu_9                 1.227731e-01 1 1  ON 9
 ud_0                 3.520372e-01 1 1  ON 10
 ud_1                 9.371822e-02 1 1  ON 11
 ud_2                -1.528592e-02 1 1  ON 12
 ud_3                -7.556386e-02 1 1  ON 13
 ud_4                -1.224801e-01 1 1  ON 14
 ud_5                -1.535282e-01 1 1  ON 15
 ud_6                -1.545578e-01 1 1  ON 16
 ud_7                -1.115711e-01 1 1  ON 17
 ud_8                 2.426713e-04 1 1  ON 18
 ud_9                 9.259258e-02 1 1  ON 19
 eO_0                -7.684137e-01 1 1  ON 20
 eO_1                -4.487570e-01 1 1  ON 21
 eO_2                -4.163773e-02 1 1  ON 22
 eO_3                 2.123305e-01 1 1  ON 23
 eO_4                 3.043783e-01 1 1  ON 24
 eO_5                 3.133771e-01 1 1  ON 25
 eO_6                 2.537457e-01 1 1  ON 26
 eO_7                 1.167438e-01 1 1  ON 27
 eO_8                 2.875148e-02 1 1  ON 28
 eO_9                 1.872915e-02 1 1  ON 29
eH1_0                -1.826220e-01 1 1  ON 30
eH1_1                -1.036158e-01 1 1  ON 31
eH1_2                -6.249893e-02 1 1  ON 32
eH1_3                -2.595180e-02 1 1  ON 33
eH1_4                 1.904974e-02 1 1  ON 34
eH1_5                 3.380083e-02 1 1  ON 35
eH1_6                 7.757487e-02 1 1  ON 36
eH1_7                 1.099059e-01 1 1  ON 37
eH1_8                 9.364079e-02 1 1  ON 38
eH1_9                 2.516288e-02 1 1  ON 39
eH2_0                -1.840730e-01 1 1  ON 40
eH2_1                -1.046807e-01 1 1  ON 41
eH2_2                -6.361092e-02 1 1  ON 42
eH2_3                -2.699893e-02 1 1  ON 43
eH2_4                 1.811034e-02 1 1  ON 44
eH2_5                 3.323184e-02 1 1  ON 45
eH2_6                 7.872450e-02 1 1  ON 46
eH2_7                 1.132788e-01 1 1  ON 47
eH2_8                 9.648847e-02 1 1  ON 48
eH2_9                 2.717845e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.15501
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315527532914
                                         uncertainty =       0.003386949067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315527532914
                                         uncertainty =       0.003386949067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397169929
  error estimate for blocks of size 2^( 2) =       0.000407217643
  error estimate for blocks of size 2^( 3) =       0.000416182198
  error estimate for blocks of size 2^( 4) =       0.000422137139
  error estimate for blocks of size 2^( 5) =       0.000427326960
  error estimate for blocks of size 2^( 6) =       0.000428927692
  error estimate for blocks of size 2^( 7) =       0.000428245011

      target function =                  N/A
              le_mean =     -17.216646985668
             les_mean =     296.728421175640
             stat err =       0.000426659200
             autocorr =       1.154009842063
              std dev =       0.561683099501
             le_variance =       0.315487904266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315536000775
                                         uncertainty =       0.003387313011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315536000775
                                         uncertainty =       0.003387313011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397175262
  error estimate for blocks of size 2^( 2) =       0.000407222168
  error estimate for blocks of size 2^( 3) =       0.000416186116
  error estimate for blocks of size 2^( 4) =       0.000422139009
  error estimate for blocks of size 2^( 5) =       0.000427324201
  error estimate for blocks of size 2^( 6) =       0.000428928650
  error estimate for blocks of size 2^( 7) =       0.000428241425

      target function =                  N/A
              le_mean =     -17.216642630180
             les_mean =     296.728279674485
             stat err =       0.000426658321
             autocorr =       1.153974095385
              std dev =       0.561690641622
             le_variance =       0.315496376886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315389657189
                                         uncertainty =       0.003385020848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315389657189
                                         uncertainty =       0.003385020848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397083212
  error estimate for blocks of size 2^( 2) =       0.000407135332
  error estimate for blocks of size 2^( 3) =       0.000416106266
  error estimate for blocks of size 2^( 4) =       0.000422063759
  error estimate for blocks of size 2^( 5) =       0.000427250932
  error estimate for blocks of size 2^( 6) =       0.000428857671
  error estimate for blocks of size 2^( 7) =       0.000428171682

      target function =                  N/A
              le_mean =     -17.216643858503
             les_mean =     296.728175747855
             stat err =       0.000426586011
             autocorr =       1.154117871684
              std dev =       0.561560464252
             le_variance =       0.315350155011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315477029448
                                         uncertainty =       0.003386222505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315477029448
                                         uncertainty =       0.003386222505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397138156
  error estimate for blocks of size 2^( 2) =       0.000407187295
  error estimate for blocks of size 2^( 3) =       0.000416153597
  error estimate for blocks of size 2^( 4) =       0.000422109380
  error estimate for blocks of size 2^( 5) =       0.000427298915
  error estimate for blocks of size 2^( 6) =       0.000428900732
  error estimate for blocks of size 2^( 7) =       0.000428217270

      target function =                  N/A
              le_mean =     -17.216646498375
             les_mean =     296.728353922587
             stat err =       0.000426631574
             autocorr =       1.154045034865
              std dev =       0.561638166689
             le_variance =       0.315437430282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216646985668        initial  <--
     9.7656e-02     9.7656e-01             3.1669e-03       -17.216642630180
     3.9062e-01     3.9062e+00             9.0550e-04       -17.216643858503
     1.5625e+00     1.5625e+01             2.4623e-04       -17.216646498375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5540
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.116307e-01 1 1  ON 0
 uu_1                 4.962133e-02 1 1  ON 1
 uu_2                -4.513693e-02 1 1  ON 2
 uu_3                -9.989958e-02 1 1  ON 3
 uu_4                -1.332667e-01 1 1  ON 4
 uu_5                -1.394853e-01 1 1  ON 5
 uu_6                -1.160219e-01 1 1  ON 6
 uu_7                -4.275768e-02 1 1  ON 7
 uu_8                 9.777780e-02 1 1  ON 8
 uu_9                 1.226640e-01 1 1  ON 9
 ud_0                 3.521000e-01 1 1  ON 10
 ud_1                 9.358288e-02 1 1  ON 11
 ud_2                -1.541635e-02 1 1  ON 12
 ud_3                -7.562579e-02 1 1  ON 13
 ud_4                -1.225374e-01 1 1  ON 14
 ud_5                -1.534690e-01 1 1  ON 15
 ud_6                -1.546077e-01 1 1  ON 16
 ud_7                -1.114649e-01 1 1  ON 17
 ud_8                 6.470233e-04 1 1  ON 18
 ud_9                 9.261175e-02 1 1  ON 19
 eO_0                -7.675082e-01 1 1  ON 20
 eO_1                -4.482470e-01 1 1  ON 21
 eO_2                -4.113758e-02 1 1  ON 22
 eO_3                 2.124645e-01 1 1  ON 23
 eO_4                 3.036703e-01 1 1  ON 24
 eO_5                 3.127166e-01 1 1  ON 25
 eO_6                 2.534483e-01 1 1  ON 26
 eO_7                 1.164413e-01 1 1  ON 27
 eO_8                 2.871769e-02 1 1  ON 28
 eO_9                 1.870420e-02 1 1  ON 29
eH1_0                -1.825808e-01 1 1  ON 30
eH1_1                -1.033488e-01 1 1  ON 31
eH1_2                -6.248091e-02 1 1  ON 32
eH1_3                -2.594393e-02 1 1  ON 33
eH1_4                 1.925284e-02 1 1  ON 34
eH1_5                 3.372394e-02 1 1  ON 35
eH1_6                 7.738338e-02 1 1  ON 36
eH1_7                 1.098592e-01 1 1  ON 37
eH1_8                 9.346845e-02 1 1  ON 38
eH1_9                 2.512803e-02 1 1  ON 39
eH2_0                -1.840987e-01 1 1  ON 40
eH2_1                -1.048013e-01 1 1  ON 41
eH2_2                -6.385437e-02 1 1  ON 42
eH2_3                -2.704186e-02 1 1  ON 43
eH2_4                 1.827138e-02 1 1  ON 44
eH2_5                 3.363216e-02 1 1  ON 45
eH2_6                 7.877340e-02 1 1  ON 46
eH2_7                 1.133255e-01 1 1  ON 47
eH2_8                 9.634641e-02 1 1  ON 48
eH2_9                 2.713577e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1937
    reference variance = 0.333715
====================================================
  Execution time = 2.1078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316398109250
                                         uncertainty =       0.003471590651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316398109250
                                         uncertainty =       0.003471590651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397714216
  error estimate for blocks of size 2^( 2) =       0.000407324978
  error estimate for blocks of size 2^( 3) =       0.000416077026
  error estimate for blocks of size 2^( 4) =       0.000422252609
  error estimate for blocks of size 2^( 5) =       0.000425709496
  error estimate for blocks of size 2^( 6) =       0.000428241661
  error estimate for blocks of size 2^( 7) =       0.000430050753

      target function =                  N/A
              le_mean =     -17.216547769335
             les_mean =     296.725870130563
             stat err =       0.000426563630
             autocorr =       1.150337868682
              std dev =       0.562452837977
             le_variance =       0.316353194949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654776933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547769335       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547974124       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548267661       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547907613       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548169902       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548297370       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548510651       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216548476379       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.906205e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547769335       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547827409       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547916318       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547797056       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216547839553       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216547857905       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216547907212       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.026889e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547769335       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547784358       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547807889       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216547775637       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216547783809       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216547787161       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216547798733       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.617096e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6662e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.116797e-01 1 1  ON 0
 uu_1                 4.960700e-02 1 1  ON 1
 uu_2                -4.512435e-02 1 1  ON 2
 uu_3                -9.990990e-02 1 1  ON 3
 uu_4                -1.332589e-01 1 1  ON 4
 uu_5                -1.394957e-01 1 1  ON 5
 uu_6                -1.160428e-01 1 1  ON 6
 uu_7                -4.279118e-02 1 1  ON 7
 uu_8                 9.775798e-02 1 1  ON 8
 uu_9                 1.226798e-01 1 1  ON 9
 ud_0                 3.520852e-01 1 1  ON 10
 ud_1                 9.363278e-02 1 1  ON 11
 ud_2                -1.541035e-02 1 1  ON 12
 ud_3                -7.562681e-02 1 1  ON 13
 ud_4                -1.225490e-01 1 1  ON 14
 ud_5                -1.534922e-01 1 1  ON 15
 ud_6                -1.546144e-01 1 1  ON 16
 ud_7                -1.114564e-01 1 1  ON 17
 ud_8                 6.228987e-04 1 1  ON 18
 ud_9                 9.261137e-02 1 1  ON 19
 eO_0                -7.675908e-01 1 1  ON 20
 eO_1                -4.483497e-01 1 1  ON 21
 eO_2                -4.118360e-02 1 1  ON 22
 eO_3                 2.124793e-01 1 1  ON 23
 eO_4                 3.037684e-01 1 1  ON 24
 eO_5                 3.127730e-01 1 1  ON 25
 eO_6                 2.534711e-01 1 1  ON 26
 eO_7                 1.164701e-01 1 1  ON 27
 eO_8                 2.872300e-02 1 1  ON 28
 eO_9                 1.870687e-02 1 1  ON 29
eH1_0                -1.825863e-01 1 1  ON 30
eH1_1                -1.033726e-01 1 1  ON 31
eH1_2                -6.247500e-02 1 1  ON 32
eH1_3                -2.592281e-02 1 1  ON 33
eH1_4                 1.925392e-02 1 1  ON 34
eH1_5                 3.371774e-02 1 1  ON 35
eH1_6                 7.737591e-02 1 1  ON 36
eH1_7                 1.098538e-01 1 1  ON 37
eH1_8                 9.348083e-02 1 1  ON 38
eH1_9                 2.513231e-02 1 1  ON 39
eH2_0                -1.840974e-01 1 1  ON 40
eH2_1                -1.048215e-01 1 1  ON 41
eH2_2                -6.385881e-02 1 1  ON 42
eH2_3                -2.705091e-02 1 1  ON 43
eH2_4                 1.826550e-02 1 1  ON 44
eH2_5                 3.363126e-02 1 1  ON 45
eH2_6                 7.878221e-02 1 1  ON 46
eH2_7                 1.133299e-01 1 1  ON 47
eH2_8                 9.636492e-02 1 1  ON 48
eH2_9                 2.714213e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2133
    reference variance = 0.270819
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1951e-01
  Total weights = 2.0000e+06
  Execution time = 2.0637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577012858
                                         uncertainty =       0.003992539984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577012858
                                         uncertainty =       0.003992539984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399708313
  error estimate for blocks of size 2^( 2) =       0.000409242305
  error estimate for blocks of size 2^( 3) =       0.000418640943
  error estimate for blocks of size 2^( 4) =       0.000424770399
  error estimate for blocks of size 2^( 5) =       0.000428397247
  error estimate for blocks of size 2^( 6) =       0.000430921665
  error estimate for blocks of size 2^( 7) =       0.000431593072

      target function =                  N/A
              le_mean =     -17.216409052667
             les_mean =     296.724273980046
             stat err =       0.000428920596
             autocorr =       1.151509274413
              std dev =       0.565272917330
             le_variance =       0.319533471067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319527439525
                                         uncertainty =       0.003992776670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319527439525
                                         uncertainty =       0.003992776670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399677341
  error estimate for blocks of size 2^( 2) =       0.000409212740
  error estimate for blocks of size 2^( 3) =       0.000418610248
  error estimate for blocks of size 2^( 4) =       0.000424737742
  error estimate for blocks of size 2^( 5) =       0.000428363938
  error estimate for blocks of size 2^( 6) =       0.000430884209
  error estimate for blocks of size 2^( 7) =       0.000431559632

      target function =                  N/A
              le_mean =     -17.216409229365
             les_mean =     296.724230546281
             stat err =       0.000428886380
             autocorr =       1.151504013449
              std dev =       0.565229115548
             le_variance =       0.319483953063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319525184811
                                         uncertainty =       0.003992468962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319525184811
                                         uncertainty =       0.003992468962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399675923
  error estimate for blocks of size 2^( 2) =       0.000409211463
  error estimate for blocks of size 2^( 3) =       0.000418609861
  error estimate for blocks of size 2^( 4) =       0.000424738472
  error estimate for blocks of size 2^( 5) =       0.000428364984
  error estimate for blocks of size 2^( 6) =       0.000430886854
  error estimate for blocks of size 2^( 7) =       0.000431560819

      target function =                  N/A
              le_mean =     -17.216409119369
             les_mean =     296.724224492016
             stat err =       0.000428887782
             autocorr =       1.151519713846
              std dev =       0.565227110334
             le_variance =       0.319481686256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319569474543
                                         uncertainty =       0.003992527755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319569474543
                                         uncertainty =       0.003992527755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399703602
  error estimate for blocks of size 2^( 2) =       0.000409237815
  error estimate for blocks of size 2^( 3) =       0.000418636431
  error estimate for blocks of size 2^( 4) =       0.000424765781
  error estimate for blocks of size 2^( 5) =       0.000428392585
  error estimate for blocks of size 2^( 6) =       0.000430916669
  error estimate for blocks of size 2^( 7) =       0.000431588425

      target function =                  N/A
              le_mean =     -17.216409055713
             les_mean =     296.724266552500
             stat err =       0.000428915865
             autocorr =       1.151511016285
              std dev =       0.565266254626
             le_variance =       0.319525938619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216409052667        initial
     9.7656e-01     9.7656e+00             3.9062e-04       -17.216409229365  <--
     3.9062e+00     3.9062e+01             1.0269e-04       -17.216409119369
     1.5625e+01     1.5625e+02             2.6171e-05       -17.216409055713

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.1429e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959442e-02 1 1  ON 1
 uu_2                -4.508724e-02 1 1  ON 2
 uu_3                -9.992603e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395268e-01 1 1  ON 5
 uu_6                -1.161054e-01 1 1  ON 6
 uu_7                -4.289296e-02 1 1  ON 7
 uu_8                 9.769773e-02 1 1  ON 8
 uu_9                 1.227273e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373530e-02 1 1  ON 11
 ud_2                -1.539165e-02 1 1  ON 12
 ud_3                -7.563105e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.499640e-04 1 1  ON 18
 ud_9                 9.261022e-02 1 1  ON 19
 eO_0                -7.678534e-01 1 1  ON 20
 eO_1                -4.486310e-01 1 1  ON 21
 eO_2                -4.132728e-02 1 1  ON 22
 eO_3                 2.125147e-01 1 1  ON 23
 eO_4                 3.040609e-01 1 1  ON 24
 eO_5                 3.129450e-01 1 1  ON 25
 eO_6                 2.535401e-01 1 1  ON 26
 eO_7                 1.165571e-01 1 1  ON 27
 eO_8                 2.873903e-02 1 1  ON 28
 eO_9                 1.871495e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245985e-02 1 1  ON 32
eH1_3                -2.586408e-02 1 1  ON 33
eH1_4                 1.925833e-02 1 1  ON 34
eH1_5                 3.369582e-02 1 1  ON 35
eH1_6                 7.735266e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351818e-02 1 1  ON 38
eH1_9                 2.514521e-02 1 1  ON 39
eH2_0                -1.840962e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387911e-02 1 1  ON 42
eH2_3                -2.707606e-02 1 1  ON 43
eH2_4                 1.824686e-02 1 1  ON 44
eH2_5                 3.362775e-02 1 1  ON 45
eH2_6                 7.880913e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642083e-02 1 1  ON 48
eH2_9                 2.716134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1364
    reference variance = 0.168618
====================================================
  Execution time = 2.0822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330637060643
                                         uncertainty =       0.013270735093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330637060643
                                         uncertainty =       0.013270735093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406656944
  error estimate for blocks of size 2^( 2) =       0.000415975676
  error estimate for blocks of size 2^( 3) =       0.000424417785
  error estimate for blocks of size 2^( 4) =       0.000431977705
  error estimate for blocks of size 2^( 5) =       0.000435974380
  error estimate for blocks of size 2^( 6) =       0.000438382846
  error estimate for blocks of size 2^( 7) =       0.000439310462

      target function =                  N/A
              le_mean =     -17.216034665821
             les_mean =     296.722589189057
             stat err =       0.000436411349
             autocorr =       1.151690240284
              std dev =       0.575099764987
             le_variance =       0.330739739688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721603466582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216034665821       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216034511827       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216033645548       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216032968339       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216035642307       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216036119958       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216035851244       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216036014042       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216036044086       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216035996137       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.558098e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216034665821       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216034602740       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216034284896       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216034001785       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216034821982       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216034938272       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216034937788       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216034914402       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.317715e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216034665821       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216034647055       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216034555211       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216034472242       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216034676948       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216034709123       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216034716271       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.127297e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6333e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.119517e-01 1 1  ON 0
 uu_1                 4.964005e-02 1 1  ON 1
 uu_2                -4.505769e-02 1 1  ON 2
 uu_3                -9.990052e-02 1 1  ON 3
 uu_4                -1.332770e-01 1 1  ON 4
 uu_5                -1.396694e-01 1 1  ON 5
 uu_6                -1.162022e-01 1 1  ON 6
 uu_7                -4.294803e-02 1 1  ON 7
 uu_8                 9.764361e-02 1 1  ON 8
 uu_9                 1.227830e-01 1 1  ON 9
 ud_0                 3.521601e-01 1 1  ON 10
 ud_1                 9.377446e-02 1 1  ON 11
 ud_2                -1.537873e-02 1 1  ON 12
 ud_3                -7.567692e-02 1 1  ON 13
 ud_4                -1.226159e-01 1 1  ON 14
 ud_5                -1.535377e-01 1 1  ON 15
 ud_6                -1.546490e-01 1 1  ON 16
 ud_7                -1.114317e-01 1 1  ON 17
 ud_8                 4.593003e-04 1 1  ON 18
 ud_9                 9.260876e-02 1 1  ON 19
 eO_0                -7.682852e-01 1 1  ON 20
 eO_1                -4.488762e-01 1 1  ON 21
 eO_2                -4.150799e-02 1 1  ON 22
 eO_3                 2.125170e-01 1 1  ON 23
 eO_4                 3.043879e-01 1 1  ON 24
 eO_5                 3.131666e-01 1 1  ON 25
 eO_6                 2.536673e-01 1 1  ON 26
 eO_7                 1.167087e-01 1 1  ON 27
 eO_8                 2.876154e-02 1 1  ON 28
 eO_9                 1.871765e-02 1 1  ON 29
eH1_0                -1.827323e-01 1 1  ON 30
eH1_1                -1.033809e-01 1 1  ON 31
eH1_2                -6.248614e-02 1 1  ON 32
eH1_3                -2.585883e-02 1 1  ON 33
eH1_4                 1.923745e-02 1 1  ON 34
eH1_5                 3.362965e-02 1 1  ON 35
eH1_6                 7.739613e-02 1 1  ON 36
eH1_7                 1.098619e-01 1 1  ON 37
eH1_8                 9.361005e-02 1 1  ON 38
eH1_9                 2.516635e-02 1 1  ON 39
eH2_0                -1.841520e-01 1 1  ON 40
eH2_1                -1.049622e-01 1 1  ON 41
eH2_2                -6.387033e-02 1 1  ON 42
eH2_3                -2.709273e-02 1 1  ON 43
eH2_4                 1.823909e-02 1 1  ON 44
eH2_5                 3.368885e-02 1 1  ON 45
eH2_6                 7.879485e-02 1 1  ON 46
eH2_7                 1.133422e-01 1 1  ON 47
eH2_8                 9.650886e-02 1 1  ON 48
eH2_9                 2.718407e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1416
    reference variance = 0.267697
====================================================
  Execution time = 2.0165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2719e-01
  Total weights = 2.0000e+06
  Execution time = 1.8349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327226872384
                                         uncertainty =       0.008475104621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327226872384
                                         uncertainty =       0.008475104621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404421735
  error estimate for blocks of size 2^( 2) =       0.000414239503
  error estimate for blocks of size 2^( 3) =       0.000422672870
  error estimate for blocks of size 2^( 4) =       0.000428965415
  error estimate for blocks of size 2^( 5) =       0.000433050290
  error estimate for blocks of size 2^( 6) =       0.000434132826
  error estimate for blocks of size 2^( 7) =       0.000436229915

      target function =                  N/A
              le_mean =     -17.216979748799
             les_mean =     296.751505386577
             stat err =       0.000433094612
             autocorr =       1.146823502720
              std dev =       0.571938702646
             le_variance =       0.327113879584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327465086569
                                         uncertainty =       0.008479830699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327465086569
                                         uncertainty =       0.008479830699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404568919
  error estimate for blocks of size 2^( 2) =       0.000414379978
  error estimate for blocks of size 2^( 3) =       0.000422806430
  error estimate for blocks of size 2^( 4) =       0.000429092079
  error estimate for blocks of size 2^( 5) =       0.000433176823
  error estimate for blocks of size 2^( 6) =       0.000434257600
  error estimate for blocks of size 2^( 7) =       0.000436350542

      target function =                  N/A
              le_mean =     -17.216979139289
             les_mean =     296.751722539488
             stat err =       0.000433219261
             autocorr =       1.146648967924
              std dev =       0.572146852182
             le_variance =       0.327352020462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327379228175
                                         uncertainty =       0.008477329088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327379228175
                                         uncertainty =       0.008477329088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404515886
  error estimate for blocks of size 2^( 2) =       0.000414329704
  error estimate for blocks of size 2^( 3) =       0.000422758925
  error estimate for blocks of size 2^( 4) =       0.000429047164
  error estimate for blocks of size 2^( 5) =       0.000433132181
  error estimate for blocks of size 2^( 6) =       0.000434214463
  error estimate for blocks of size 2^( 7) =       0.000436308450

      target function =                  N/A
              le_mean =     -17.216979500500
             les_mean =     296.751649161559
             stat err =       0.000433175564
             autocorr =       1.146718280038
              std dev =       0.572071852629
             le_variance =       0.327266204571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327249191240
                                         uncertainty =       0.008475403964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327249191240
                                         uncertainty =       0.008475403964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404435528
  error estimate for blocks of size 2^( 2) =       0.000414252745
  error estimate for blocks of size 2^( 3) =       0.000422685565
  error estimate for blocks of size 2^( 4) =       0.000428977502
  error estimate for blocks of size 2^( 5) =       0.000433062397
  error estimate for blocks of size 2^( 6) =       0.000434144992
  error estimate for blocks of size 2^( 7) =       0.000436241660

      target function =                  N/A
              le_mean =     -17.216979708518
             les_mean =     296.751526313024
             stat err =       0.000433106638
             autocorr =       1.146808965871
              std dev =       0.571958209214
             le_variance =       0.327136193087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216979748799        initial  <--
     2.4414e-01     2.4414e+00             1.5581e-03       -17.216979139289
     9.7656e-01     9.7656e+00             4.3177e-04       -17.216979500500
     3.9062e+00     3.9062e+01             1.1273e-04       -17.216979708518

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4156
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959442e-02 1 1  ON 1
 uu_2                -4.508724e-02 1 1  ON 2
 uu_3                -9.992603e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395268e-01 1 1  ON 5
 uu_6                -1.161054e-01 1 1  ON 6
 uu_7                -4.289296e-02 1 1  ON 7
 uu_8                 9.769773e-02 1 1  ON 8
 uu_9                 1.227273e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373530e-02 1 1  ON 11
 ud_2                -1.539165e-02 1 1  ON 12
 ud_3                -7.563105e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.499640e-04 1 1  ON 18
 ud_9                 9.261022e-02 1 1  ON 19
 eO_0                -7.678534e-01 1 1  ON 20
 eO_1                -4.486310e-01 1 1  ON 21
 eO_2                -4.132728e-02 1 1  ON 22
 eO_3                 2.125147e-01 1 1  ON 23
 eO_4                 3.040609e-01 1 1  ON 24
 eO_5                 3.129450e-01 1 1  ON 25
 eO_6                 2.535401e-01 1 1  ON 26
 eO_7                 1.165571e-01 1 1  ON 27
 eO_8                 2.873903e-02 1 1  ON 28
 eO_9                 1.871495e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245985e-02 1 1  ON 32
eH1_3                -2.586408e-02 1 1  ON 33
eH1_4                 1.925833e-02 1 1  ON 34
eH1_5                 3.369582e-02 1 1  ON 35
eH1_6                 7.735266e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351818e-02 1 1  ON 38
eH1_9                 2.514521e-02 1 1  ON 39
eH2_0                -1.840962e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387911e-02 1 1  ON 42
eH2_3                -2.707606e-02 1 1  ON 43
eH2_4                 1.824686e-02 1 1  ON 44
eH2_5                 3.362775e-02 1 1  ON 45
eH2_6                 7.880913e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642083e-02 1 1  ON 48
eH2_9                 2.716134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.207707
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100671074
                                         uncertainty =       0.018772164949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337100671074
                                         uncertainty =       0.018772164949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571326
  error estimate for blocks of size 2^( 2) =       0.000420204418
  error estimate for blocks of size 2^( 3) =       0.000428890225
  error estimate for blocks of size 2^( 4) =       0.000435077565
  error estimate for blocks of size 2^( 5) =       0.000440572120
  error estimate for blocks of size 2^( 6) =       0.000440554827
  error estimate for blocks of size 2^( 7) =       0.000440462892

      target function =                  N/A
              le_mean =     -17.216255056702
             les_mean =     296.736575636869
             stat err =       0.000439166851
             autocorr =       1.144147119716
              std dev =       0.580635538036
             le_variance =       0.337137628031


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625505670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216255056702       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216255462738       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216255514327       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216255685492       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216255864381       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216255882692       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216255861051       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216255851645       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.746226e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216255056702       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216255165110       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216255179193       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216255229768       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216255272304       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216255276416       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216255273118       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.418468e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216255056702       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216255084272       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216255087889       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216255101110       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216255111571       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216255112571       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216255111900       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.111929e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6374e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.118160e-01 1 1  ON 0
 uu_1                 4.959436e-02 1 1  ON 1
 uu_2                -4.508584e-02 1 1  ON 2
 uu_3                -9.993351e-02 1 1  ON 3
 uu_4                -1.332466e-01 1 1  ON 4
 uu_5                -1.395280e-01 1 1  ON 5
 uu_6                -1.161088e-01 1 1  ON 6
 uu_7                -4.291054e-02 1 1  ON 7
 uu_8                 9.768776e-02 1 1  ON 8
 uu_9                 1.227332e-01 1 1  ON 9
 ud_0                 3.520925e-01 1 1  ON 10
 ud_1                 9.375231e-02 1 1  ON 11
 ud_2                -1.538440e-02 1 1  ON 12
 ud_3                -7.563893e-02 1 1  ON 13
 ud_4                -1.225756e-01 1 1  ON 14
 ud_5                -1.535682e-01 1 1  ON 15
 ud_6                -1.546494e-01 1 1  ON 16
 ud_7                -1.114415e-01 1 1  ON 17
 ud_8                 5.395920e-04 1 1  ON 18
 ud_9                 9.261210e-02 1 1  ON 19
 eO_0                -7.678976e-01 1 1  ON 20
 eO_1                -4.486575e-01 1 1  ON 21
 eO_2                -4.134005e-02 1 1  ON 22
 eO_3                 2.125182e-01 1 1  ON 23
 eO_4                 3.040950e-01 1 1  ON 24
 eO_5                 3.129665e-01 1 1  ON 25
 eO_6                 2.535489e-01 1 1  ON 26
 eO_7                 1.165676e-01 1 1  ON 27
 eO_8                 2.874112e-02 1 1  ON 28
 eO_9                 1.871624e-02 1 1  ON 29
eH1_0                -1.826070e-01 1 1  ON 30
eH1_1                -1.034373e-01 1 1  ON 31
eH1_2                -6.246591e-02 1 1  ON 32
eH1_3                -2.585600e-02 1 1  ON 33
eH1_4                 1.924970e-02 1 1  ON 34
eH1_5                 3.370153e-02 1 1  ON 35
eH1_6                 7.735224e-02 1 1  ON 36
eH1_7                 1.098355e-01 1 1  ON 37
eH1_8                 9.352496e-02 1 1  ON 38
eH1_9                 2.514804e-02 1 1  ON 39
eH2_0                -1.840865e-01 1 1  ON 40
eH2_1                -1.048827e-01 1 1  ON 41
eH2_2                -6.388899e-02 1 1  ON 42
eH2_3                -2.708007e-02 1 1  ON 43
eH2_4                 1.824927e-02 1 1  ON 44
eH2_5                 3.363003e-02 1 1  ON 45
eH2_6                 7.880842e-02 1 1  ON 46
eH2_7                 1.133410e-01 1 1  ON 47
eH2_8                 9.642825e-02 1 1  ON 48
eH2_9                 2.716351e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.71096
====================================================
  Execution time = 2.0256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856457777
                                         uncertainty =       0.003429152792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856457777
                                         uncertainty =       0.003429152792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399285601
  error estimate for blocks of size 2^( 2) =       0.000408354211
  error estimate for blocks of size 2^( 3) =       0.000417565454
  error estimate for blocks of size 2^( 4) =       0.000423526480
  error estimate for blocks of size 2^( 5) =       0.000427433502
  error estimate for blocks of size 2^( 6) =       0.000431013769
  error estimate for blocks of size 2^( 7) =       0.000431158700

      target function =                  N/A
              le_mean =     -17.216580981181
             les_mean =     296.729518503882
             stat err =       0.000428283113
             autocorr =       1.150521142231
              std dev =       0.564675111683
             le_variance =       0.318857981754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318870274480
                                         uncertainty =       0.003428723351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318870274480
                                         uncertainty =       0.003428723351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399294261
  error estimate for blocks of size 2^( 2) =       0.000408362192
  error estimate for blocks of size 2^( 3) =       0.000417572736
  error estimate for blocks of size 2^( 4) =       0.000423533144
  error estimate for blocks of size 2^( 5) =       0.000427440368
  error estimate for blocks of size 2^( 6) =       0.000431019860
  error estimate for blocks of size 2^( 7) =       0.000431163827

      target function =                  N/A
              le_mean =     -17.216580868501
             les_mean =     296.729528455150
             stat err =       0.000428289300
             autocorr =       1.150504478917
              std dev =       0.564687358598
             le_variance =       0.318871812960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318858216665
                                         uncertainty =       0.003428860196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318858216665
                                         uncertainty =       0.003428860196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399286706
  error estimate for blocks of size 2^( 2) =       0.000408355134
  error estimate for blocks of size 2^( 3) =       0.000417566159
  error estimate for blocks of size 2^( 4) =       0.000423526964
  error estimate for blocks of size 2^( 5) =       0.000427434170
  error estimate for blocks of size 2^( 6) =       0.000431014022
  error estimate for blocks of size 2^( 7) =       0.000431158342

      target function =                  N/A
              le_mean =     -17.216580897469
             les_mean =     296.729517387010
             stat err =       0.000428283374
             autocorr =       1.150516177231
              std dev =       0.564676675060
             le_variance =       0.318859747357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856561073
                                         uncertainty =       0.003429114089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318856561073
                                         uncertainty =       0.003429114089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399285666
  error estimate for blocks of size 2^( 2) =       0.000408354256
  error estimate for blocks of size 2^( 3) =       0.000417565475
  error estimate for blocks of size 2^( 4) =       0.000423526474
  error estimate for blocks of size 2^( 5) =       0.000427433521
  error estimate for blocks of size 2^( 6) =       0.000431013735
  error estimate for blocks of size 2^( 7) =       0.000431158588

      target function =                  N/A
              le_mean =     -17.216580969341
             les_mean =     296.729518200349
             stat err =       0.000428283079
             autocorr =       1.150520586862
              std dev =       0.564675203918
             le_variance =       0.318858085919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216580981181        initial  <--
     2.4414e+00     2.4414e+01             1.7462e-04       -17.216580868501
     9.7656e+00     9.7656e+01             4.4185e-05       -17.216580897469
     3.9062e+01     3.9062e+02             1.1119e-05       -17.216580969341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4833
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959442e-02 1 1  ON 1
 uu_2                -4.508724e-02 1 1  ON 2
 uu_3                -9.992603e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395268e-01 1 1  ON 5
 uu_6                -1.161054e-01 1 1  ON 6
 uu_7                -4.289296e-02 1 1  ON 7
 uu_8                 9.769773e-02 1 1  ON 8
 uu_9                 1.227273e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373530e-02 1 1  ON 11
 ud_2                -1.539165e-02 1 1  ON 12
 ud_3                -7.563105e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.499640e-04 1 1  ON 18
 ud_9                 9.261022e-02 1 1  ON 19
 eO_0                -7.678534e-01 1 1  ON 20
 eO_1                -4.486310e-01 1 1  ON 21
 eO_2                -4.132728e-02 1 1  ON 22
 eO_3                 2.125147e-01 1 1  ON 23
 eO_4                 3.040609e-01 1 1  ON 24
 eO_5                 3.129450e-01 1 1  ON 25
 eO_6                 2.535401e-01 1 1  ON 26
 eO_7                 1.165571e-01 1 1  ON 27
 eO_8                 2.873903e-02 1 1  ON 28
 eO_9                 1.871495e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245985e-02 1 1  ON 32
eH1_3                -2.586408e-02 1 1  ON 33
eH1_4                 1.925833e-02 1 1  ON 34
eH1_5                 3.369582e-02 1 1  ON 35
eH1_6                 7.735266e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351818e-02 1 1  ON 38
eH1_9                 2.514521e-02 1 1  ON 39
eH2_0                -1.840962e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387911e-02 1 1  ON 42
eH2_3                -2.707606e-02 1 1  ON 43
eH2_4                 1.824686e-02 1 1  ON 44
eH2_5                 3.362775e-02 1 1  ON 45
eH2_6                 7.880913e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642083e-02 1 1  ON 48
eH2_9                 2.716134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.19642
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1299e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312985801066
                                         uncertainty =       0.002330113464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312985801066
                                         uncertainty =       0.002330113464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395594226
  error estimate for blocks of size 2^( 2) =       0.000405420446
  error estimate for blocks of size 2^( 3) =       0.000414302241
  error estimate for blocks of size 2^( 4) =       0.000419997338
  error estimate for blocks of size 2^( 5) =       0.000424337598
  error estimate for blocks of size 2^( 6) =       0.000427377477
  error estimate for blocks of size 2^( 7) =       0.000430757372

      target function =                  N/A
              le_mean =     -17.217040638153
             les_mean =     296.739477763355
             stat err =       0.000425617446
             autocorr =       1.157547853359
              std dev =       0.559454720273
             le_variance =       0.312989584036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704063815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040638153       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040654452       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040656421       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040682650       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040678620       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040681974       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040675453       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.745776e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040638153       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040642249       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040642745       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040649342       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040648369       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040649198       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040647598       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.385945e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040638153       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040639178       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040639303       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040640954       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040640713       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040640920       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040640522       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.097852e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6295e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.117998e-01 1 1  ON 0
 uu_1                 4.959488e-02 1 1  ON 1
 uu_2                -4.508628e-02 1 1  ON 2
 uu_3                -9.992576e-02 1 1  ON 3
 uu_4                -1.332517e-01 1 1  ON 4
 uu_5                -1.395278e-01 1 1  ON 5
 uu_6                -1.161060e-01 1 1  ON 6
 uu_7                -4.289402e-02 1 1  ON 7
 uu_8                 9.769693e-02 1 1  ON 8
 uu_9                 1.227277e-01 1 1  ON 9
 ud_0                 3.520883e-01 1 1  ON 10
 ud_1                 9.373616e-02 1 1  ON 11
 ud_2                -1.539101e-02 1 1  ON 12
 ud_3                -7.563031e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546382e-01 1 1  ON 16
 ud_7                -1.114321e-01 1 1  ON 17
 ud_8                 5.490546e-04 1 1  ON 18
 ud_9                 9.261024e-02 1 1  ON 19
 eO_0                -7.678578e-01 1 1  ON 20
 eO_1                -4.486315e-01 1 1  ON 21
 eO_2                -4.133025e-02 1 1  ON 22
 eO_3                 2.125149e-01 1 1  ON 23
 eO_4                 3.040642e-01 1 1  ON 24
 eO_5                 3.129470e-01 1 1  ON 25
 eO_6                 2.535409e-01 1 1  ON 26
 eO_7                 1.165583e-01 1 1  ON 27
 eO_8                 2.873922e-02 1 1  ON 28
 eO_9                 1.871504e-02 1 1  ON 29
eH1_0                -1.826061e-01 1 1  ON 30
eH1_1                -1.034306e-01 1 1  ON 31
eH1_2                -6.246060e-02 1 1  ON 32
eH1_3                -2.586371e-02 1 1  ON 33
eH1_4                 1.925779e-02 1 1  ON 34
eH1_5                 3.369581e-02 1 1  ON 35
eH1_6                 7.735221e-02 1 1  ON 36
eH1_7                 1.098378e-01 1 1  ON 37
eH1_8                 9.351902e-02 1 1  ON 38
eH1_9                 2.514547e-02 1 1  ON 39
eH2_0                -1.840968e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387905e-02 1 1  ON 42
eH2_3                -2.707564e-02 1 1  ON 43
eH2_4                 1.824709e-02 1 1  ON 44
eH2_5                 3.362702e-02 1 1  ON 45
eH2_6                 7.880911e-02 1 1  ON 46
eH2_7                 1.133430e-01 1 1  ON 47
eH2_8                 9.642146e-02 1 1  ON 48
eH2_9                 2.716151e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2617
    reference variance = 0.259729
====================================================
  Execution time = 1.9992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1324e-01
  Total weights = 2.0000e+06
  Execution time = 1.8211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313352902961
                                         uncertainty =       0.002430649484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313352902961
                                         uncertainty =       0.002430649484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395754199
  error estimate for blocks of size 2^( 2) =       0.000405396918
  error estimate for blocks of size 2^( 3) =       0.000414011355
  error estimate for blocks of size 2^( 4) =       0.000420119490
  error estimate for blocks of size 2^( 5) =       0.000424142767
  error estimate for blocks of size 2^( 6) =       0.000426266916
  error estimate for blocks of size 2^( 7) =       0.000427085392

      target function =                  N/A
              le_mean =     -17.216551527281
             les_mean =     296.722889107447
             stat err =       0.000424403641
             autocorr =       1.150024623454
              std dev =       0.559680956040
             le_variance =       0.313242772554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313349513195
                                         uncertainty =       0.002430610679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313349513195
                                         uncertainty =       0.002430610679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395752061
  error estimate for blocks of size 2^( 2) =       0.000405394836
  error estimate for blocks of size 2^( 3) =       0.000414009324
  error estimate for blocks of size 2^( 4) =       0.000420117466
  error estimate for blocks of size 2^( 5) =       0.000424140724
  error estimate for blocks of size 2^( 6) =       0.000426264898
  error estimate for blocks of size 2^( 7) =       0.000427083220

      target function =                  N/A
              le_mean =     -17.216551504282
             les_mean =     296.722884930976
             stat err =       0.000424401577
             autocorr =       1.150025861828
              std dev =       0.559677932376
             le_variance =       0.313239387989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313351170607
                                         uncertainty =       0.002430629702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313351170607
                                         uncertainty =       0.002430629702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395753107
  error estimate for blocks of size 2^( 2) =       0.000405395854
  error estimate for blocks of size 2^( 3) =       0.000414010318
  error estimate for blocks of size 2^( 4) =       0.000420118456
  error estimate for blocks of size 2^( 5) =       0.000424141724
  error estimate for blocks of size 2^( 6) =       0.000426265885
  error estimate for blocks of size 2^( 7) =       0.000427084283

      target function =                  N/A
              le_mean =     -17.216551515587
             les_mean =     296.722886975076
             stat err =       0.000424402587
             autocorr =       1.150025261725
              std dev =       0.559679410776
             le_variance =       0.313241042846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313352685176
                                         uncertainty =       0.002430646999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313352685176
                                         uncertainty =       0.002430646999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395754062
  error estimate for blocks of size 2^( 2) =       0.000405396784
  error estimate for blocks of size 2^( 3) =       0.000414011224
  error estimate for blocks of size 2^( 4) =       0.000420119360
  error estimate for blocks of size 2^( 5) =       0.000424142636
  error estimate for blocks of size 2^( 6) =       0.000426266786
  error estimate for blocks of size 2^( 7) =       0.000427085253

      target function =                  N/A
              le_mean =     -17.216551525808
             les_mean =     296.722888839286
             stat err =       0.000424403509
             autocorr =       1.150024703838
              std dev =       0.559680761776
             le_variance =       0.313242555102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216551527281        initial  <--
     2.4414e+01     2.4414e+02             1.7458e-05       -17.216551504282
     9.7656e+01     9.7656e+02             4.3859e-06       -17.216551515587
     3.9062e+02     3.9062e+03             1.0979e-06       -17.216551525808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1920
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959442e-02 1 1  ON 1
 uu_2                -4.508724e-02 1 1  ON 2
 uu_3                -9.992603e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395268e-01 1 1  ON 5
 uu_6                -1.161054e-01 1 1  ON 6
 uu_7                -4.289296e-02 1 1  ON 7
 uu_8                 9.769773e-02 1 1  ON 8
 uu_9                 1.227273e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373530e-02 1 1  ON 11
 ud_2                -1.539165e-02 1 1  ON 12
 ud_3                -7.563105e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.499640e-04 1 1  ON 18
 ud_9                 9.261022e-02 1 1  ON 19
 eO_0                -7.678534e-01 1 1  ON 20
 eO_1                -4.486310e-01 1 1  ON 21
 eO_2                -4.132728e-02 1 1  ON 22
 eO_3                 2.125147e-01 1 1  ON 23
 eO_4                 3.040609e-01 1 1  ON 24
 eO_5                 3.129450e-01 1 1  ON 25
 eO_6                 2.535401e-01 1 1  ON 26
 eO_7                 1.165571e-01 1 1  ON 27
 eO_8                 2.873903e-02 1 1  ON 28
 eO_9                 1.871495e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245985e-02 1 1  ON 32
eH1_3                -2.586408e-02 1 1  ON 33
eH1_4                 1.925833e-02 1 1  ON 34
eH1_5                 3.369582e-02 1 1  ON 35
eH1_6                 7.735266e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351818e-02 1 1  ON 38
eH1_9                 2.514521e-02 1 1  ON 39
eH2_0                -1.840962e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387911e-02 1 1  ON 42
eH2_3                -2.707606e-02 1 1  ON 43
eH2_4                 1.824686e-02 1 1  ON 44
eH2_5                 3.362775e-02 1 1  ON 45
eH2_6                 7.880913e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642083e-02 1 1  ON 48
eH2_9                 2.716134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.399106
====================================================
  Execution time = 2.0566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1636e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316344697845
                                         uncertainty =       0.003967189510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316344697845
                                         uncertainty =       0.003967189510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397721558
  error estimate for blocks of size 2^( 2) =       0.000407405867
  error estimate for blocks of size 2^( 3) =       0.000415846395
  error estimate for blocks of size 2^( 4) =       0.000422272199
  error estimate for blocks of size 2^( 5) =       0.000427486979
  error estimate for blocks of size 2^( 6) =       0.000431810618
  error estimate for blocks of size 2^( 7) =       0.000431953581

      target function =                  N/A
              le_mean =     -17.216500281345
             les_mean =     296.724246655001
             stat err =       0.000428380844
             autocorr =       1.160117077253
              std dev =       0.562463221578
             le_variance =       0.316364875628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650028135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500281345       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500280866       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500285642       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500286382       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500285997       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500286327       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500286314       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.558675e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500281345       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500281225       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500282420       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500282606       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500282511       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500282593       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500282590       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.896990e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500281345       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500281315       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500281614       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500281661       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500281637       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500281657       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500281657       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 9.742663e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6096e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959450e-02 1 1  ON 1
 uu_2                -4.508720e-02 1 1  ON 2
 uu_3                -9.992593e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395268e-01 1 1  ON 5
 uu_6                -1.161055e-01 1 1  ON 6
 uu_7                -4.289309e-02 1 1  ON 7
 uu_8                 9.769765e-02 1 1  ON 8
 uu_9                 1.227274e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373529e-02 1 1  ON 11
 ud_2                -1.539155e-02 1 1  ON 12
 ud_3                -7.563110e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.498268e-04 1 1  ON 18
 ud_9                 9.261020e-02 1 1  ON 19
 eO_0                -7.678538e-01 1 1  ON 20
 eO_1                -4.486313e-01 1 1  ON 21
 eO_2                -4.132754e-02 1 1  ON 22
 eO_3                 2.125148e-01 1 1  ON 23
 eO_4                 3.040612e-01 1 1  ON 24
 eO_5                 3.129453e-01 1 1  ON 25
 eO_6                 2.535402e-01 1 1  ON 26
 eO_7                 1.165572e-01 1 1  ON 27
 eO_8                 2.873904e-02 1 1  ON 28
 eO_9                 1.871495e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245987e-02 1 1  ON 32
eH1_3                -2.586398e-02 1 1  ON 33
eH1_4                 1.925833e-02 1 1  ON 34
eH1_5                 3.369567e-02 1 1  ON 35
eH1_6                 7.735267e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351825e-02 1 1  ON 38
eH1_9                 2.514524e-02 1 1  ON 39
eH2_0                -1.840963e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387899e-02 1 1  ON 42
eH2_3                -2.707614e-02 1 1  ON 43
eH2_4                 1.824685e-02 1 1  ON 44
eH2_5                 3.362768e-02 1 1  ON 45
eH2_6                 7.880914e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642089e-02 1 1  ON 48
eH2_9                 2.716136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.34729
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1487e-01
  Total weights = 2.0000e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314805055720
                                         uncertainty =       0.003289342455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314805055720
                                         uncertainty =       0.003289342455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396781362
  error estimate for blocks of size 2^( 2) =       0.000406427937
  error estimate for blocks of size 2^( 3) =       0.000415649647
  error estimate for blocks of size 2^( 4) =       0.000422029206
  error estimate for blocks of size 2^( 5) =       0.000425646910
  error estimate for blocks of size 2^( 6) =       0.000426472026
  error estimate for blocks of size 2^( 7) =       0.000427690311

      target function =                  N/A
              le_mean =     -17.216617893852
             les_mean =     296.726802444189
             stat err =       0.000425459613
             autocorr =       1.149778420812
              std dev =       0.561133583670
             le_variance =       0.314870898723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314804898017
                                         uncertainty =       0.003289346539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314804898017
                                         uncertainty =       0.003289346539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396781263
  error estimate for blocks of size 2^( 2) =       0.000406427846
  error estimate for blocks of size 2^( 3) =       0.000415649560
  error estimate for blocks of size 2^( 4) =       0.000422029121
  error estimate for blocks of size 2^( 5) =       0.000425646824
  error estimate for blocks of size 2^( 6) =       0.000426471963
  error estimate for blocks of size 2^( 7) =       0.000427690258

      target function =                  N/A
              le_mean =     -17.216617894046
             les_mean =     296.726802293045
             stat err =       0.000425459541
             autocorr =       1.149778609570
              std dev =       0.561133443024
             le_variance =       0.314870740879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314804976762
                                         uncertainty =       0.003289344498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314804976762
                                         uncertainty =       0.003289344498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396781312
  error estimate for blocks of size 2^( 2) =       0.000406427891
  error estimate for blocks of size 2^( 3) =       0.000415649603
  error estimate for blocks of size 2^( 4) =       0.000422029163
  error estimate for blocks of size 2^( 5) =       0.000425646867
  error estimate for blocks of size 2^( 6) =       0.000426471994
  error estimate for blocks of size 2^( 7) =       0.000427690284

      target function =                  N/A
              le_mean =     -17.216617893951
             les_mean =     296.726802368574
             stat err =       0.000425459577
             autocorr =       1.149778515381
              std dev =       0.561133513252
             le_variance =       0.314870819694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314805045847
                                         uncertainty =       0.003289342710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314805045847
                                         uncertainty =       0.003289342710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396781356
  error estimate for blocks of size 2^( 2) =       0.000406427931
  error estimate for blocks of size 2^( 3) =       0.000415649641
  error estimate for blocks of size 2^( 4) =       0.000422029201
  error estimate for blocks of size 2^( 5) =       0.000425646905
  error estimate for blocks of size 2^( 6) =       0.000426472022
  error estimate for blocks of size 2^( 7) =       0.000427690307

      target function =                  N/A
              le_mean =     -17.216617893864
             les_mean =     296.726802434734
             stat err =       0.000425459609
             autocorr =       1.149778432633
              std dev =       0.561133574865
             le_variance =       0.314870888840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216617893852        initial
     2.4414e+02     2.4414e+03             1.5587e-06       -17.216617894046  <--
     9.7656e+02     9.7656e+03             3.8970e-07       -17.216617893951
     3.9062e+03     3.9062e+04             9.7427e-08       -17.216617893864

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9211e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.117997e-01 1 1  ON 0
 uu_1                 4.959475e-02 1 1  ON 1
 uu_2                -4.508707e-02 1 1  ON 2
 uu_3                -9.992563e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395270e-01 1 1  ON 5
 uu_6                -1.161058e-01 1 1  ON 6
 uu_7                -4.289348e-02 1 1  ON 7
 uu_8                 9.769738e-02 1 1  ON 8
 uu_9                 1.227275e-01 1 1  ON 9
 ud_0                 3.520889e-01 1 1  ON 10
 ud_1                 9.373525e-02 1 1  ON 11
 ud_2                -1.539124e-02 1 1  ON 12
 ud_3                -7.563127e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546374e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.494152e-04 1 1  ON 18
 ud_9                 9.261015e-02 1 1  ON 19
 eO_0                -7.678550e-01 1 1  ON 20
 eO_1                -4.486321e-01 1 1  ON 21
 eO_2                -4.132831e-02 1 1  ON 22
 eO_3                 2.125152e-01 1 1  ON 23
 eO_4                 3.040621e-01 1 1  ON 24
 eO_5                 3.129460e-01 1 1  ON 25
 eO_6                 2.535405e-01 1 1  ON 26
 eO_7                 1.165576e-01 1 1  ON 27
 eO_8                 2.873907e-02 1 1  ON 28
 eO_9                 1.871496e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034313e-01 1 1  ON 31
eH1_2                -6.245992e-02 1 1  ON 32
eH1_3                -2.586369e-02 1 1  ON 33
eH1_4                 1.925836e-02 1 1  ON 34
eH1_5                 3.369521e-02 1 1  ON 35
eH1_6                 7.735270e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351846e-02 1 1  ON 38
eH1_9                 2.514531e-02 1 1  ON 39
eH2_0                -1.840965e-01 1 1  ON 40
eH2_1                -1.048737e-01 1 1  ON 41
eH2_2                -6.387864e-02 1 1  ON 42
eH2_3                -2.707637e-02 1 1  ON 43
eH2_4                 1.824680e-02 1 1  ON 44
eH2_5                 3.362746e-02 1 1  ON 45
eH2_6                 7.880919e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642107e-02 1 1  ON 48
eH2_9                 2.716142e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2632
    reference variance = 0.183487
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 4.2785e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.427989754793
                                         uncertainty =       0.083520314092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.427989754793
                                         uncertainty =       0.083520314092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462520527
  error estimate for blocks of size 2^( 2) =       0.000470716707
  error estimate for blocks of size 2^( 3) =       0.000478505151
  error estimate for blocks of size 2^( 4) =       0.000484557225
  error estimate for blocks of size 2^( 5) =       0.000488439661
  error estimate for blocks of size 2^( 6) =       0.000488815560
  error estimate for blocks of size 2^( 7) =       0.000489437275

      target function =                  N/A
              le_mean =     -17.216545905410
             les_mean =     296.837303175307
             stat err =       0.000487812430
             autocorr =       1.112355741785
              std dev =       0.654102802424
             le_variance =       0.427850476139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654590541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545905410       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545908920       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545929300       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545938174       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545937658       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545939537       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545936539       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.616059e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545905410       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545906289       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545911406       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545913621       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545913488       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545913971       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545913227       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.905649e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545905410       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545905630       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545906911       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545907464       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545907430       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545907552       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545907366       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.765149e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5932e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.118001e-01 1 1  ON 0
 uu_1                 4.959514e-02 1 1  ON 1
 uu_2                -4.508714e-02 1 1  ON 2
 uu_3                -9.992542e-02 1 1  ON 3
 uu_4                -1.332523e-01 1 1  ON 4
 uu_5                -1.395273e-01 1 1  ON 5
 uu_6                -1.161060e-01 1 1  ON 6
 uu_7                -4.289393e-02 1 1  ON 7
 uu_8                 9.769709e-02 1 1  ON 8
 uu_9                 1.227278e-01 1 1  ON 9
 ud_0                 3.520888e-01 1 1  ON 10
 ud_1                 9.373584e-02 1 1  ON 11
 ud_2                -1.539104e-02 1 1  ON 12
 ud_3                -7.563152e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535596e-01 1 1  ON 15
 ud_6                -1.546376e-01 1 1  ON 16
 ud_7                -1.114317e-01 1 1  ON 17
 ud_8                 5.490041e-04 1 1  ON 18
 ud_9                 9.261014e-02 1 1  ON 19
 eO_0                -7.678569e-01 1 1  ON 20
 eO_1                -4.486333e-01 1 1  ON 21
 eO_2                -4.132862e-02 1 1  ON 22
 eO_3                 2.125157e-01 1 1  ON 23
 eO_4                 3.040630e-01 1 1  ON 24
 eO_5                 3.129470e-01 1 1  ON 25
 eO_6                 2.535410e-01 1 1  ON 26
 eO_7                 1.165580e-01 1 1  ON 27
 eO_8                 2.873914e-02 1 1  ON 28
 eO_9                 1.871500e-02 1 1  ON 29
eH1_0                -1.826058e-01 1 1  ON 30
eH1_1                -1.034311e-01 1 1  ON 31
eH1_2                -6.245983e-02 1 1  ON 32
eH1_3                -2.586367e-02 1 1  ON 33
eH1_4                 1.925808e-02 1 1  ON 34
eH1_5                 3.369465e-02 1 1  ON 35
eH1_6                 7.735280e-02 1 1  ON 36
eH1_7                 1.098379e-01 1 1  ON 37
eH1_8                 9.351873e-02 1 1  ON 38
eH1_9                 2.514538e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048735e-01 1 1  ON 41
eH2_2                -6.387856e-02 1 1  ON 42
eH2_3                -2.707626e-02 1 1  ON 43
eH2_4                 1.824647e-02 1 1  ON 44
eH2_5                 3.362716e-02 1 1  ON 45
eH2_6                 7.880888e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642137e-02 1 1  ON 48
eH2_9                 2.716151e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2966
    reference variance = 0.181872
====================================================
  Execution time = 2.0107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1379e-01
  Total weights = 2.0000e+06
  Execution time = 1.8681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873644149
                                         uncertainty =       0.002694726533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873644149
                                         uncertainty =       0.002694726533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396097002
  error estimate for blocks of size 2^( 2) =       0.000406079361
  error estimate for blocks of size 2^( 3) =       0.000414924169
  error estimate for blocks of size 2^( 4) =       0.000421228887
  error estimate for blocks of size 2^( 5) =       0.000425498490
  error estimate for blocks of size 2^( 6) =       0.000428105728
  error estimate for blocks of size 2^( 7) =       0.000429562359

      target function =                  N/A
              le_mean =     -17.217272587475
             les_mean =     296.748260864624
             stat err =       0.000426098866
             autocorr =       1.157224570682
              std dev =       0.560165752329
             le_variance =       0.313785670083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873048576
                                         uncertainty =       0.002694730231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873048576
                                         uncertainty =       0.002694730231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396096627
  error estimate for blocks of size 2^( 2) =       0.000406079015
  error estimate for blocks of size 2^( 3) =       0.000414923838
  error estimate for blocks of size 2^( 4) =       0.000421228535
  error estimate for blocks of size 2^( 5) =       0.000425498142
  error estimate for blocks of size 2^( 6) =       0.000428105356
  error estimate for blocks of size 2^( 7) =       0.000429562006

      target function =                  N/A
              le_mean =     -17.217272561682
             les_mean =     296.748259381504
             stat err =       0.000426098510
             autocorr =       1.157224829594
              std dev =       0.560165221288
             le_variance =       0.313785075141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873340266
                                         uncertainty =       0.002694728355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873340266
                                         uncertainty =       0.002694728355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396096810
  error estimate for blocks of size 2^( 2) =       0.000406079184
  error estimate for blocks of size 2^( 3) =       0.000414924000
  error estimate for blocks of size 2^( 4) =       0.000421228708
  error estimate for blocks of size 2^( 5) =       0.000425498313
  error estimate for blocks of size 2^( 6) =       0.000428105539
  error estimate for blocks of size 2^( 7) =       0.000429562179

      target function =                  N/A
              le_mean =     -17.217272574508
             les_mean =     296.748260114533
             stat err =       0.000426098685
             autocorr =       1.157224704197
              std dev =       0.560165481369
             le_variance =       0.313785366517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873605967
                                         uncertainty =       0.002694726760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313873605967
                                         uncertainty =       0.002694726760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396096978
  error estimate for blocks of size 2^( 2) =       0.000406079339
  error estimate for blocks of size 2^( 3) =       0.000414924148
  error estimate for blocks of size 2^( 4) =       0.000421228865
  error estimate for blocks of size 2^( 5) =       0.000425498468
  error estimate for blocks of size 2^( 6) =       0.000428105704
  error estimate for blocks of size 2^( 7) =       0.000429562336

      target function =                  N/A
              le_mean =     -17.217272585852
             les_mean =     296.748260770571
             stat err =       0.000426098843
             autocorr =       1.157224587495
              std dev =       0.560165718284
             le_variance =       0.313785631940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217272587475        initial  <--
     6.1035e+01     6.1035e+02             7.6161e-06       -17.217272561682
     2.4414e+02     2.4414e+03             1.9056e-06       -17.217272574508
     9.7656e+02     9.7656e+03             4.7651e-07       -17.217272585852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4979
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.117997e-01 1 1  ON 0
 uu_1                 4.959475e-02 1 1  ON 1
 uu_2                -4.508707e-02 1 1  ON 2
 uu_3                -9.992563e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395270e-01 1 1  ON 5
 uu_6                -1.161058e-01 1 1  ON 6
 uu_7                -4.289348e-02 1 1  ON 7
 uu_8                 9.769738e-02 1 1  ON 8
 uu_9                 1.227275e-01 1 1  ON 9
 ud_0                 3.520889e-01 1 1  ON 10
 ud_1                 9.373525e-02 1 1  ON 11
 ud_2                -1.539124e-02 1 1  ON 12
 ud_3                -7.563127e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535595e-01 1 1  ON 15
 ud_6                -1.546374e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.494152e-04 1 1  ON 18
 ud_9                 9.261015e-02 1 1  ON 19
 eO_0                -7.678550e-01 1 1  ON 20
 eO_1                -4.486321e-01 1 1  ON 21
 eO_2                -4.132831e-02 1 1  ON 22
 eO_3                 2.125152e-01 1 1  ON 23
 eO_4                 3.040621e-01 1 1  ON 24
 eO_5                 3.129460e-01 1 1  ON 25
 eO_6                 2.535405e-01 1 1  ON 26
 eO_7                 1.165576e-01 1 1  ON 27
 eO_8                 2.873907e-02 1 1  ON 28
 eO_9                 1.871496e-02 1 1  ON 29
eH1_0                -1.826056e-01 1 1  ON 30
eH1_1                -1.034313e-01 1 1  ON 31
eH1_2                -6.245992e-02 1 1  ON 32
eH1_3                -2.586369e-02 1 1  ON 33
eH1_4                 1.925836e-02 1 1  ON 34
eH1_5                 3.369521e-02 1 1  ON 35
eH1_6                 7.735270e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351846e-02 1 1  ON 38
eH1_9                 2.514531e-02 1 1  ON 39
eH2_0                -1.840965e-01 1 1  ON 40
eH2_1                -1.048737e-01 1 1  ON 41
eH2_2                -6.387864e-02 1 1  ON 42
eH2_3                -2.707637e-02 1 1  ON 43
eH2_4                 1.824680e-02 1 1  ON 44
eH2_5                 3.362746e-02 1 1  ON 45
eH2_6                 7.880919e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642107e-02 1 1  ON 48
eH2_9                 2.716142e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.239
    reference variance = 0.41676
====================================================
  Execution time = 2.2476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023531856
                                         uncertainty =       0.004388242927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023531856
                                         uncertainty =       0.004388242927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401436974
  error estimate for blocks of size 2^( 2) =       0.000411365484
  error estimate for blocks of size 2^( 3) =       0.000419934682
  error estimate for blocks of size 2^( 4) =       0.000427107694
  error estimate for blocks of size 2^( 5) =       0.000430691629
  error estimate for blocks of size 2^( 6) =       0.000434740711
  error estimate for blocks of size 2^( 7) =       0.000432483778

      target function =                  N/A
              le_mean =     -17.217571121160
             les_mean =     296.767058439313
             stat err =       0.000431255953
             autocorr =       1.154078804890
              std dev =       0.567717613121
             le_variance =       0.322303288248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721757112116e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571121160       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571121535       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571121629       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217571123115       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217571124238       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217571123981       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217571124050       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 6.855650e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571121160       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571121254       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571121277       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217571121649       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217571121930       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217571121867       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217571121887       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.714185e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571121160       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571121184       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571121190       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217571121276       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217571121353       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217571121337       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217571121339       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 4.285633e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8003e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.117997e-01 1 1  ON 0
 uu_1                 4.959476e-02 1 1  ON 1
 uu_2                -4.508704e-02 1 1  ON 2
 uu_3                -9.992560e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395270e-01 1 1  ON 5
 uu_6                -1.161058e-01 1 1  ON 6
 uu_7                -4.289353e-02 1 1  ON 7
 uu_8                 9.769735e-02 1 1  ON 8
 uu_9                 1.227275e-01 1 1  ON 9
 ud_0                 3.520889e-01 1 1  ON 10
 ud_1                 9.373527e-02 1 1  ON 11
 ud_2                -1.539121e-02 1 1  ON 12
 ud_3                -7.563127e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535596e-01 1 1  ON 15
 ud_6                -1.546374e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.493810e-04 1 1  ON 18
 ud_9                 9.261015e-02 1 1  ON 19
 eO_0                -7.678552e-01 1 1  ON 20
 eO_1                -4.486321e-01 1 1  ON 21
 eO_2                -4.132841e-02 1 1  ON 22
 eO_3                 2.125152e-01 1 1  ON 23
 eO_4                 3.040622e-01 1 1  ON 24
 eO_5                 3.129461e-01 1 1  ON 25
 eO_6                 2.535406e-01 1 1  ON 26
 eO_7                 1.165576e-01 1 1  ON 27
 eO_8                 2.873908e-02 1 1  ON 28
 eO_9                 1.871497e-02 1 1  ON 29
eH1_0                -1.826057e-01 1 1  ON 30
eH1_1                -1.034313e-01 1 1  ON 31
eH1_2                -6.245993e-02 1 1  ON 32
eH1_3                -2.586370e-02 1 1  ON 33
eH1_4                 1.925835e-02 1 1  ON 34
eH1_5                 3.369519e-02 1 1  ON 35
eH1_6                 7.735270e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351849e-02 1 1  ON 38
eH1_9                 2.514531e-02 1 1  ON 39
eH2_0                -1.840965e-01 1 1  ON 40
eH2_1                -1.048737e-01 1 1  ON 41
eH2_2                -6.387864e-02 1 1  ON 42
eH2_3                -2.707635e-02 1 1  ON 43
eH2_4                 1.824678e-02 1 1  ON 44
eH2_5                 3.362740e-02 1 1  ON 45
eH2_6                 7.880919e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642109e-02 1 1  ON 48
eH2_9                 2.716143e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.16
    reference variance = 0.208551
====================================================
  Execution time = 2.0093e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2297e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014666095
                                         uncertainty =       0.007529824299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014666095
                                         uncertainty =       0.007529824299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401850101
  error estimate for blocks of size 2^( 2) =       0.000411211293
  error estimate for blocks of size 2^( 3) =       0.000420141649
  error estimate for blocks of size 2^( 4) =       0.000426077432
  error estimate for blocks of size 2^( 5) =       0.000429579981
  error estimate for blocks of size 2^( 6) =       0.000431955412
  error estimate for blocks of size 2^( 7) =       0.000433881801

      target function =                  N/A
              le_mean =     -17.216394007526
             les_mean =     296.727189469003
             stat err =       0.000430373657
             autocorr =       1.146999412315
              std dev =       0.568301863555
             le_variance =       0.322967008120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014598462
                                         uncertainty =       0.007529821339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014598462
                                         uncertainty =       0.007529821339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401850059
  error estimate for blocks of size 2^( 2) =       0.000411211252
  error estimate for blocks of size 2^( 3) =       0.000420141608
  error estimate for blocks of size 2^( 4) =       0.000426077393
  error estimate for blocks of size 2^( 5) =       0.000429579939
  error estimate for blocks of size 2^( 6) =       0.000431955370
  error estimate for blocks of size 2^( 7) =       0.000433881767

      target function =                  N/A
              le_mean =     -17.216394008649
             les_mean =     296.727189440057
             stat err =       0.000430373617
             autocorr =       1.146999442743
              std dev =       0.568301804062
             le_variance =       0.322966940500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014632241
                                         uncertainty =       0.007529822817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014632241
                                         uncertainty =       0.007529822817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401850080
  error estimate for blocks of size 2^( 2) =       0.000411211272
  error estimate for blocks of size 2^( 3) =       0.000420141628
  error estimate for blocks of size 2^( 4) =       0.000426077413
  error estimate for blocks of size 2^( 5) =       0.000429579960
  error estimate for blocks of size 2^( 6) =       0.000431955391
  error estimate for blocks of size 2^( 7) =       0.000433881784

      target function =                  N/A
              le_mean =     -17.216394008088
             les_mean =     296.727189454506
             stat err =       0.000430373637
             autocorr =       1.146999427561
              std dev =       0.568301833776
             le_variance =       0.322966974273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014661862
                                         uncertainty =       0.007529824114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323014661862
                                         uncertainty =       0.007529824114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401850099
  error estimate for blocks of size 2^( 2) =       0.000411211290
  error estimate for blocks of size 2^( 3) =       0.000420141646
  error estimate for blocks of size 2^( 4) =       0.000426077430
  error estimate for blocks of size 2^( 5) =       0.000429579978
  error estimate for blocks of size 2^( 6) =       0.000431955410
  error estimate for blocks of size 2^( 7) =       0.000433881799

      target function =                  N/A
              le_mean =     -17.216394007596
             les_mean =     296.727189467190
             stat err =       0.000430373654
             autocorr =       1.146999414225
              std dev =       0.568301859832
             le_variance =       0.322967003888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216394007526        initial
     6.1035e+02     6.1035e+03             6.8556e-07       -17.216394008649  <--
     2.4414e+03     2.4414e+04             1.7142e-07       -17.216394008088
     9.7656e+03     9.7656e+04             4.2856e-08       -17.216394007596

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9485e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959480e-02 1 1  ON 1
 uu_2                -4.508696e-02 1 1  ON 2
 uu_3                -9.992553e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395269e-01 1 1  ON 5
 uu_6                -1.161059e-01 1 1  ON 6
 uu_7                -4.289368e-02 1 1  ON 7
 uu_8                 9.769726e-02 1 1  ON 8
 uu_9                 1.227276e-01 1 1  ON 9
 ud_0                 3.520889e-01 1 1  ON 10
 ud_1                 9.373532e-02 1 1  ON 11
 ud_2                -1.539111e-02 1 1  ON 12
 ud_3                -7.563128e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.492785e-04 1 1  ON 18
 ud_9                 9.261014e-02 1 1  ON 19
 eO_0                -7.678557e-01 1 1  ON 20
 eO_1                -4.486322e-01 1 1  ON 21
 eO_2                -4.132873e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040625e-01 1 1  ON 24
 eO_5                 3.129464e-01 1 1  ON 25
 eO_6                 2.535407e-01 1 1  ON 26
 eO_7                 1.165578e-01 1 1  ON 27
 eO_8                 2.873910e-02 1 1  ON 28
 eO_9                 1.871497e-02 1 1  ON 29
eH1_0                -1.826057e-01 1 1  ON 30
eH1_1                -1.034311e-01 1 1  ON 31
eH1_2                -6.245994e-02 1 1  ON 32
eH1_3                -2.586375e-02 1 1  ON 33
eH1_4                 1.925832e-02 1 1  ON 34
eH1_5                 3.369511e-02 1 1  ON 35
eH1_6                 7.735268e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351857e-02 1 1  ON 38
eH1_9                 2.514533e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048736e-01 1 1  ON 41
eH2_2                -6.387862e-02 1 1  ON 42
eH2_3                -2.707628e-02 1 1  ON 43
eH2_4                 1.824675e-02 1 1  ON 44
eH2_5                 3.362721e-02 1 1  ON 45
eH2_6                 7.880918e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642116e-02 1 1  ON 48
eH2_9                 2.716145e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.308269
====================================================
  Execution time = 2.0864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313085499403
                                         uncertainty =       0.002636128256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313085499403
                                         uncertainty =       0.002636128256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395620230
  error estimate for blocks of size 2^( 2) =       0.000405557320
  error estimate for blocks of size 2^( 3) =       0.000414292570
  error estimate for blocks of size 2^( 4) =       0.000420489227
  error estimate for blocks of size 2^( 5) =       0.000425088628
  error estimate for blocks of size 2^( 6) =       0.000428137209
  error estimate for blocks of size 2^( 7) =       0.000429966150

      target function =                  N/A
              le_mean =     -17.217013536153
             les_mean =     296.738585680029
             stat err =       0.000425920303
             autocorr =       1.159043416535
              std dev =       0.559491494538
             le_variance =       0.313030732461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701353615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217013536153       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217013539565       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217013538744       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217013542717       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217013541116       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217013542945       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217013541517       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.305203e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217013536153       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217013537007       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217013536801       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217013537794       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217013537391       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217013537851       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217013537495       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 8.267077e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217013536153       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217013536367       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217013536315       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217013536564       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217013536463       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217013536578       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217013536489       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.067024e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6379e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959496e-02 1 1  ON 1
 uu_2                -4.508694e-02 1 1  ON 2
 uu_3                -9.992550e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395270e-01 1 1  ON 5
 uu_6                -1.161061e-01 1 1  ON 6
 uu_7                -4.289377e-02 1 1  ON 7
 uu_8                 9.769719e-02 1 1  ON 8
 uu_9                 1.227277e-01 1 1  ON 9
 ud_0                 3.520890e-01 1 1  ON 10
 ud_1                 9.373540e-02 1 1  ON 11
 ud_2                -1.539108e-02 1 1  ON 12
 ud_3                -7.563131e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535599e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114314e-01 1 1  ON 17
 ud_8                 5.491525e-04 1 1  ON 18
 ud_9                 9.261012e-02 1 1  ON 19
 eO_0                -7.678565e-01 1 1  ON 20
 eO_1                -4.486327e-01 1 1  ON 21
 eO_2                -4.132884e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040630e-01 1 1  ON 24
 eO_5                 3.129467e-01 1 1  ON 25
 eO_6                 2.535408e-01 1 1  ON 26
 eO_7                 1.165580e-01 1 1  ON 27
 eO_8                 2.873914e-02 1 1  ON 28
 eO_9                 1.871498e-02 1 1  ON 29
eH1_0                -1.826059e-01 1 1  ON 30
eH1_1                -1.034310e-01 1 1  ON 31
eH1_2                -6.245991e-02 1 1  ON 32
eH1_3                -2.586377e-02 1 1  ON 33
eH1_4                 1.925830e-02 1 1  ON 34
eH1_5                 3.369497e-02 1 1  ON 35
eH1_6                 7.735273e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351869e-02 1 1  ON 38
eH1_9                 2.514537e-02 1 1  ON 39
eH2_0                -1.840965e-01 1 1  ON 40
eH2_1                -1.048737e-01 1 1  ON 41
eH2_2                -6.387870e-02 1 1  ON 42
eH2_3                -2.707627e-02 1 1  ON 43
eH2_4                 1.824674e-02 1 1  ON 44
eH2_5                 3.362725e-02 1 1  ON 45
eH2_6                 7.880927e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642127e-02 1 1  ON 48
eH2_9                 2.716148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 0.291938
====================================================
  Execution time = 2.0189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1904e-01
  Total weights = 2.0000e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319047968958
                                         uncertainty =       0.003075686322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319047968958
                                         uncertainty =       0.003075686322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399398018
  error estimate for blocks of size 2^( 2) =       0.000408866194
  error estimate for blocks of size 2^( 3) =       0.000417206716
  error estimate for blocks of size 2^( 4) =       0.000422421453
  error estimate for blocks of size 2^( 5) =       0.000426023504
  error estimate for blocks of size 2^( 6) =       0.000429148589
  error estimate for blocks of size 2^( 7) =       0.000428873586

      target function =                  N/A
              le_mean =     -17.216745434336
             les_mean =     296.735360744258
             stat err =       0.000426616783
             autocorr =       1.140943303084
              std dev =       0.564834093368
             le_variance =       0.319037553030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048076935
                                         uncertainty =       0.003075686446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048076935
                                         uncertainty =       0.003075686446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399398085
  error estimate for blocks of size 2^( 2) =       0.000408866256
  error estimate for blocks of size 2^( 3) =       0.000417206771
  error estimate for blocks of size 2^( 4) =       0.000422421494
  error estimate for blocks of size 2^( 5) =       0.000426023545
  error estimate for blocks of size 2^( 6) =       0.000429148623
  error estimate for blocks of size 2^( 7) =       0.000428873649

      target function =                  N/A
              le_mean =     -17.216745433855
             les_mean =     296.735360835506
             stat err =       0.000426616828
             autocorr =       1.140943154859
              std dev =       0.564834188814
             le_variance =       0.319037660853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048022699
                                         uncertainty =       0.003075686380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048022699
                                         uncertainty =       0.003075686380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399398051
  error estimate for blocks of size 2^( 2) =       0.000408866225
  error estimate for blocks of size 2^( 3) =       0.000417206743
  error estimate for blocks of size 2^( 4) =       0.000422421474
  error estimate for blocks of size 2^( 5) =       0.000426023524
  error estimate for blocks of size 2^( 6) =       0.000429148606
  error estimate for blocks of size 2^( 7) =       0.000428873618

      target function =                  N/A
              le_mean =     -17.216745434093
             les_mean =     296.735360789523
             stat err =       0.000426616805
             autocorr =       1.140943229066
              std dev =       0.564834140872
             le_variance =       0.319037606694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319047975668
                                         uncertainty =       0.003075686329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319047975668
                                         uncertainty =       0.003075686329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399398022
  error estimate for blocks of size 2^( 2) =       0.000408866197
  error estimate for blocks of size 2^( 3) =       0.000417206719
  error estimate for blocks of size 2^( 4) =       0.000422421456
  error estimate for blocks of size 2^( 5) =       0.000426023507
  error estimate for blocks of size 2^( 6) =       0.000429148591
  error estimate for blocks of size 2^( 7) =       0.000428873590

      target function =                  N/A
              le_mean =     -17.216745434306
             les_mean =     296.735360749903
             stat err =       0.000426616786
             autocorr =       1.140943293837
              std dev =       0.564834099298
             le_variance =       0.319037559730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216745434336        initial  <--
     1.5259e+02     1.5259e+03             3.3052e-06       -17.216745433855
     6.1035e+02     6.1035e+03             8.2671e-07       -17.216745434093
     2.4414e+03     2.4414e+04             2.0670e-07       -17.216745434306

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5726
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959480e-02 1 1  ON 1
 uu_2                -4.508696e-02 1 1  ON 2
 uu_3                -9.992553e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395269e-01 1 1  ON 5
 uu_6                -1.161059e-01 1 1  ON 6
 uu_7                -4.289368e-02 1 1  ON 7
 uu_8                 9.769726e-02 1 1  ON 8
 uu_9                 1.227276e-01 1 1  ON 9
 ud_0                 3.520889e-01 1 1  ON 10
 ud_1                 9.373532e-02 1 1  ON 11
 ud_2                -1.539111e-02 1 1  ON 12
 ud_3                -7.563128e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.492785e-04 1 1  ON 18
 ud_9                 9.261014e-02 1 1  ON 19
 eO_0                -7.678557e-01 1 1  ON 20
 eO_1                -4.486322e-01 1 1  ON 21
 eO_2                -4.132873e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040625e-01 1 1  ON 24
 eO_5                 3.129464e-01 1 1  ON 25
 eO_6                 2.535407e-01 1 1  ON 26
 eO_7                 1.165578e-01 1 1  ON 27
 eO_8                 2.873910e-02 1 1  ON 28
 eO_9                 1.871497e-02 1 1  ON 29
eH1_0                -1.826057e-01 1 1  ON 30
eH1_1                -1.034311e-01 1 1  ON 31
eH1_2                -6.245994e-02 1 1  ON 32
eH1_3                -2.586375e-02 1 1  ON 33
eH1_4                 1.925832e-02 1 1  ON 34
eH1_5                 3.369511e-02 1 1  ON 35
eH1_6                 7.735268e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351857e-02 1 1  ON 38
eH1_9                 2.514533e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048736e-01 1 1  ON 41
eH2_2                -6.387862e-02 1 1  ON 42
eH2_3                -2.707628e-02 1 1  ON 43
eH2_4                 1.824675e-02 1 1  ON 44
eH2_5                 3.362721e-02 1 1  ON 45
eH2_6                 7.880918e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642116e-02 1 1  ON 48
eH2_9                 2.716145e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2111
    reference variance = 0.180658
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317958181588
                                         uncertainty =       0.004228180951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317958181588
                                         uncertainty =       0.004228180951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398723719
  error estimate for blocks of size 2^( 2) =       0.000408752059
  error estimate for blocks of size 2^( 3) =       0.000417684199
  error estimate for blocks of size 2^( 4) =       0.000424005162
  error estimate for blocks of size 2^( 5) =       0.000427281061
  error estimate for blocks of size 2^( 6) =       0.000429762136
  error estimate for blocks of size 2^( 7) =       0.000431054047

      target function =                  N/A
              le_mean =     -17.216845250784
             les_mean =     296.737721438827
             stat err =       0.000428025602
             autocorr =       1.152379037886
              std dev =       0.563880491209
             le_variance =       0.317961208366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684525078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216845250784       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216845250533       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216845251025       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216845251235       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216845251355       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216845251624       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216845251551       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.076449e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216845250784       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216845250721       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216845250844       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216845250894       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216845250927       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216845250994       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216845250976       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 7.691395e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216845250784       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216845250768       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216845250799       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216845250807       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216845250816       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216845250834       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216845250826       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.922866e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6145e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959480e-02 1 1  ON 1
 uu_2                -4.508694e-02 1 1  ON 2
 uu_3                -9.992552e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395269e-01 1 1  ON 5
 uu_6                -1.161059e-01 1 1  ON 6
 uu_7                -4.289370e-02 1 1  ON 7
 uu_8                 9.769724e-02 1 1  ON 8
 uu_9                 1.227276e-01 1 1  ON 9
 ud_0                 3.520890e-01 1 1  ON 10
 ud_1                 9.373534e-02 1 1  ON 11
 ud_2                -1.539110e-02 1 1  ON 12
 ud_3                -7.563127e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546375e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.492605e-04 1 1  ON 18
 ud_9                 9.261014e-02 1 1  ON 19
 eO_0                -7.678557e-01 1 1  ON 20
 eO_1                -4.486323e-01 1 1  ON 21
 eO_2                -4.132875e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040626e-01 1 1  ON 24
 eO_5                 3.129464e-01 1 1  ON 25
 eO_6                 2.535407e-01 1 1  ON 26
 eO_7                 1.165578e-01 1 1  ON 27
 eO_8                 2.873910e-02 1 1  ON 28
 eO_9                 1.871497e-02 1 1  ON 29
eH1_0                -1.826057e-01 1 1  ON 30
eH1_1                -1.034311e-01 1 1  ON 31
eH1_2                -6.245992e-02 1 1  ON 32
eH1_3                -2.586377e-02 1 1  ON 33
eH1_4                 1.925834e-02 1 1  ON 34
eH1_5                 3.369511e-02 1 1  ON 35
eH1_6                 7.735268e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351858e-02 1 1  ON 38
eH1_9                 2.514533e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048736e-01 1 1  ON 41
eH2_2                -6.387861e-02 1 1  ON 42
eH2_3                -2.707628e-02 1 1  ON 43
eH2_4                 1.824673e-02 1 1  ON 44
eH2_5                 3.362719e-02 1 1  ON 45
eH2_6                 7.880918e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642117e-02 1 1  ON 48
eH2_9                 2.716145e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2088
    reference variance = 0.262127
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1840e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492205062
                                         uncertainty =       0.003969060916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492205062
                                         uncertainty =       0.003969060916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398998442
  error estimate for blocks of size 2^( 2) =       0.000409128463
  error estimate for blocks of size 2^( 3) =       0.000417858084
  error estimate for blocks of size 2^( 4) =       0.000424682907
  error estimate for blocks of size 2^( 5) =       0.000428771189
  error estimate for blocks of size 2^( 6) =       0.000431263293
  error estimate for blocks of size 2^( 7) =       0.000432339506

      target function =                  N/A
              le_mean =     -17.216934635313
             les_mean =     296.741237590930
             stat err =       0.000429264224
             autocorr =       1.157462658430
              std dev =       0.564269008093
             le_variance =       0.318399513494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492170799
                                         uncertainty =       0.003969061001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492170799
                                         uncertainty =       0.003969061001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398998421
  error estimate for blocks of size 2^( 2) =       0.000409128441
  error estimate for blocks of size 2^( 3) =       0.000417858063
  error estimate for blocks of size 2^( 4) =       0.000424682885
  error estimate for blocks of size 2^( 5) =       0.000428771167
  error estimate for blocks of size 2^( 6) =       0.000431263269
  error estimate for blocks of size 2^( 7) =       0.000432339481

      target function =                  N/A
              le_mean =     -17.216934636092
             les_mean =     296.741237583488
             stat err =       0.000429264200
             autocorr =       1.157462657701
              std dev =       0.564268977733
             le_variance =       0.318399479232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492187921
                                         uncertainty =       0.003969060959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492187921
                                         uncertainty =       0.003969060959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398998431
  error estimate for blocks of size 2^( 2) =       0.000409128452
  error estimate for blocks of size 2^( 3) =       0.000417858074
  error estimate for blocks of size 2^( 4) =       0.000424682896
  error estimate for blocks of size 2^( 5) =       0.000428771178
  error estimate for blocks of size 2^( 6) =       0.000431263281
  error estimate for blocks of size 2^( 7) =       0.000432339493

      target function =                  N/A
              le_mean =     -17.216934635702
             les_mean =     296.741237587202
             stat err =       0.000429264212
             autocorr =       1.157462658063
              std dev =       0.564268992905
             le_variance =       0.318399496354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492202919
                                         uncertainty =       0.003969060921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492202919
                                         uncertainty =       0.003969060921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398998441
  error estimate for blocks of size 2^( 2) =       0.000409128462
  error estimate for blocks of size 2^( 3) =       0.000417858083
  error estimate for blocks of size 2^( 4) =       0.000424682905
  error estimate for blocks of size 2^( 5) =       0.000428771187
  error estimate for blocks of size 2^( 6) =       0.000431263291
  error estimate for blocks of size 2^( 7) =       0.000432339505

      target function =                  N/A
              le_mean =     -17.216934635362
             les_mean =     296.741237590463
             stat err =       0.000429264222
             autocorr =       1.157462658381
              std dev =       0.564269006194
             le_variance =       0.318399511351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934635313        initial
     1.5259e+03     1.5259e+04             3.0764e-07       -17.216934636092  <--
     6.1035e+03     6.1035e+04             7.6914e-08       -17.216934635702
     2.4414e+04     2.4414e+05             1.9229e-08       -17.216934635362

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9769e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959481e-02 1 1  ON 1
 uu_2                -4.508687e-02 1 1  ON 2
 uu_3                -9.992550e-02 1 1  ON 3
 uu_4                -1.332521e-01 1 1  ON 4
 uu_5                -1.395269e-01 1 1  ON 5
 uu_6                -1.161060e-01 1 1  ON 6
 uu_7                -4.289378e-02 1 1  ON 7
 uu_8                 9.769719e-02 1 1  ON 8
 uu_9                 1.227276e-01 1 1  ON 9
 ud_0                 3.520890e-01 1 1  ON 10
 ud_1                 9.373540e-02 1 1  ON 11
 ud_2                -1.539107e-02 1 1  ON 12
 ud_3                -7.563126e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546376e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.492063e-04 1 1  ON 18
 ud_9                 9.261012e-02 1 1  ON 19
 eO_0                -7.678560e-01 1 1  ON 20
 eO_1                -4.486324e-01 1 1  ON 21
 eO_2                -4.132881e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040628e-01 1 1  ON 24
 eO_5                 3.129465e-01 1 1  ON 25
 eO_6                 2.535408e-01 1 1  ON 26
 eO_7                 1.165578e-01 1 1  ON 27
 eO_8                 2.873910e-02 1 1  ON 28
 eO_9                 1.871497e-02 1 1  ON 29
eH1_0                -1.826058e-01 1 1  ON 30
eH1_1                -1.034311e-01 1 1  ON 31
eH1_2                -6.245987e-02 1 1  ON 32
eH1_3                -2.586380e-02 1 1  ON 33
eH1_4                 1.925839e-02 1 1  ON 34
eH1_5                 3.369509e-02 1 1  ON 35
eH1_6                 7.735267e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351860e-02 1 1  ON 38
eH1_9                 2.514534e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048736e-01 1 1  ON 41
eH2_2                -6.387858e-02 1 1  ON 42
eH2_3                -2.707627e-02 1 1  ON 43
eH2_4                 1.824668e-02 1 1  ON 44
eH2_5                 3.362715e-02 1 1  ON 45
eH2_6                 7.880918e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642120e-02 1 1  ON 48
eH2_9                 2.716146e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2003
    reference variance = 0.341263
====================================================
  Execution time = 2.0882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317629368351
                                         uncertainty =       0.006337224964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317629368351
                                         uncertainty =       0.006337224964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398541133
  error estimate for blocks of size 2^( 2) =       0.000408246652
  error estimate for blocks of size 2^( 3) =       0.000417063623
  error estimate for blocks of size 2^( 4) =       0.000423037827
  error estimate for blocks of size 2^( 5) =       0.000427080279
  error estimate for blocks of size 2^( 6) =       0.000428619449
  error estimate for blocks of size 2^( 7) =       0.000430021640

      target function =                  N/A
              le_mean =     -17.216806414771
             les_mean =     296.736093034878
             stat err =       0.000427189799
             autocorr =       1.148934956518
              std dev =       0.563622276008
             le_variance =       0.317670070013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680641477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806414771       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806414284       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806414767       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806414406       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216806415101       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216806415808       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216806415843       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.718934e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806414771       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806414649       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806414770       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806414680       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216806414853       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216806415030       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216806415038       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.429716e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806414771       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806414741       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806414771       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806414748       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216806414791       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216806414837       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216806414838       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 6.074278e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6495e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959488e-02 1 1  ON 1
 uu_2                -4.508681e-02 1 1  ON 2
 uu_3                -9.992547e-02 1 1  ON 3
 uu_4                -1.332521e-01 1 1  ON 4
 uu_5                -1.395270e-01 1 1  ON 5
 uu_6                -1.161060e-01 1 1  ON 6
 uu_7                -4.289387e-02 1 1  ON 7
 uu_8                 9.769714e-02 1 1  ON 8
 uu_9                 1.227277e-01 1 1  ON 9
 ud_0                 3.520891e-01 1 1  ON 10
 ud_1                 9.373536e-02 1 1  ON 11
 ud_2                -1.539102e-02 1 1  ON 12
 ud_3                -7.563128e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546376e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.491299e-04 1 1  ON 18
 ud_9                 9.261013e-02 1 1  ON 19
 eO_0                -7.678562e-01 1 1  ON 20
 eO_1                -4.486326e-01 1 1  ON 21
 eO_2                -4.132887e-02 1 1  ON 22
 eO_3                 2.125153e-01 1 1  ON 23
 eO_4                 3.040630e-01 1 1  ON 24
 eO_5                 3.129467e-01 1 1  ON 25
 eO_6                 2.535408e-01 1 1  ON 26
 eO_7                 1.165579e-01 1 1  ON 27
 eO_8                 2.873912e-02 1 1  ON 28
 eO_9                 1.871498e-02 1 1  ON 29
eH1_0                -1.826058e-01 1 1  ON 30
eH1_1                -1.034312e-01 1 1  ON 31
eH1_2                -6.245985e-02 1 1  ON 32
eH1_3                -2.586379e-02 1 1  ON 33
eH1_4                 1.925839e-02 1 1  ON 34
eH1_5                 3.369510e-02 1 1  ON 35
eH1_6                 7.735269e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351864e-02 1 1  ON 38
eH1_9                 2.514535e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048736e-01 1 1  ON 41
eH2_2                -6.387854e-02 1 1  ON 42
eH2_3                -2.707631e-02 1 1  ON 43
eH2_4                 1.824663e-02 1 1  ON 44
eH2_5                 3.362709e-02 1 1  ON 45
eH2_6                 7.880919e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642125e-02 1 1  ON 48
eH2_9                 2.716148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.298138
====================================================
  Execution time = 2.0312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1931e-01
  Total weights = 2.0000e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312795440
                                         uncertainty =       0.004605123498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312795440
                                         uncertainty =       0.004605123498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399570337
  error estimate for blocks of size 2^( 2) =       0.000409327830
  error estimate for blocks of size 2^( 3) =       0.000417569538
  error estimate for blocks of size 2^( 4) =       0.000425008904
  error estimate for blocks of size 2^( 5) =       0.000429596349
  error estimate for blocks of size 2^( 6) =       0.000432534952
  error estimate for blocks of size 2^( 7) =       0.000435731843

      target function =                  N/A
              le_mean =     -17.217177059024
             les_mean =     296.750498630450
             stat err =       0.000430718012
             autocorr =       1.161982499226
              std dev =       0.565077789625
             le_variance =       0.319312908327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319313096911
                                         uncertainty =       0.004605132703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319313096911
                                         uncertainty =       0.004605132703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399570526
  error estimate for blocks of size 2^( 2) =       0.000409328010
  error estimate for blocks of size 2^( 3) =       0.000417569711
  error estimate for blocks of size 2^( 4) =       0.000425009071
  error estimate for blocks of size 2^( 5) =       0.000429596511
  error estimate for blocks of size 2^( 6) =       0.000432535110
  error estimate for blocks of size 2^( 7) =       0.000435732005

      target function =                  N/A
              le_mean =     -17.217177061523
             les_mean =     296.750499017909
             stat err =       0.000430718174
             autocorr =       1.161982277448
              std dev =       0.565078056315
             le_variance =       0.319313209728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312946315
                                         uncertainty =       0.004605128107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312946315
                                         uncertainty =       0.004605128107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399570431
  error estimate for blocks of size 2^( 2) =       0.000409327920
  error estimate for blocks of size 2^( 3) =       0.000417569624
  error estimate for blocks of size 2^( 4) =       0.000425008987
  error estimate for blocks of size 2^( 5) =       0.000429596430
  error estimate for blocks of size 2^( 6) =       0.000432535031
  error estimate for blocks of size 2^( 7) =       0.000435731924

      target function =                  N/A
              le_mean =     -17.217177060276
             les_mean =     296.750498824394
             stat err =       0.000430718093
             autocorr =       1.161982388281
              std dev =       0.565077923093
             le_variance =       0.319313059168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312814304
                                         uncertainty =       0.004605124074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319312814304
                                         uncertainty =       0.004605124074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399570349
  error estimate for blocks of size 2^( 2) =       0.000409327842
  error estimate for blocks of size 2^( 3) =       0.000417569549
  error estimate for blocks of size 2^( 4) =       0.000425008914
  error estimate for blocks of size 2^( 5) =       0.000429596359
  error estimate for blocks of size 2^( 6) =       0.000432534962
  error estimate for blocks of size 2^( 7) =       0.000435731853

      target function =                  N/A
              le_mean =     -17.217177059180
             les_mean =     296.750498654699
             stat err =       0.000430718022
             autocorr =       1.161982485353
              std dev =       0.565077806312
             le_variance =       0.319312927187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217177059024        initial
     3.8147e+02     3.8147e+03             9.7189e-07       -17.217177061523  <--
     1.5259e+03     1.5259e+04             2.4297e-07       -17.217177060276
     6.1035e+03     6.1035e+04             6.0743e-08       -17.217177059180

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.9678e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.117996e-01 1 1  ON 0
 uu_1                 4.959509e-02 1 1  ON 1
 uu_2                -4.508663e-02 1 1  ON 2
 uu_3                -9.992540e-02 1 1  ON 3
 uu_4                -1.332521e-01 1 1  ON 4
 uu_5                -1.395272e-01 1 1  ON 5
 uu_6                -1.161062e-01 1 1  ON 6
 uu_7                -4.289414e-02 1 1  ON 7
 uu_8                 9.769701e-02 1 1  ON 8
 uu_9                 1.227278e-01 1 1  ON 9
 ud_0                 3.520895e-01 1 1  ON 10
 ud_1                 9.373523e-02 1 1  ON 11
 ud_2                -1.539087e-02 1 1  ON 12
 ud_3                -7.563136e-02 1 1  ON 13
 ud_4                -1.225825e-01 1 1  ON 14
 ud_5                -1.535596e-01 1 1  ON 15
 ud_6                -1.546378e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.489007e-04 1 1  ON 18
 ud_9                 9.261013e-02 1 1  ON 19
 eO_0                -7.678569e-01 1 1  ON 20
 eO_1                -4.486332e-01 1 1  ON 21
 eO_2                -4.132906e-02 1 1  ON 22
 eO_3                 2.125154e-01 1 1  ON 23
 eO_4                 3.040635e-01 1 1  ON 24
 eO_5                 3.129471e-01 1 1  ON 25
 eO_6                 2.535410e-01 1 1  ON 26
 eO_7                 1.165581e-01 1 1  ON 27
 eO_8                 2.873916e-02 1 1  ON 28
 eO_9                 1.871500e-02 1 1  ON 29
eH1_0                -1.826060e-01 1 1  ON 30
eH1_1                -1.034314e-01 1 1  ON 31
eH1_2                -6.245981e-02 1 1  ON 32
eH1_3                -2.586376e-02 1 1  ON 33
eH1_4                 1.925838e-02 1 1  ON 34
eH1_5                 3.369514e-02 1 1  ON 35
eH1_6                 7.735273e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351878e-02 1 1  ON 38
eH1_9                 2.514539e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048737e-01 1 1  ON 41
eH2_2                -6.387844e-02 1 1  ON 42
eH2_3                -2.707644e-02 1 1  ON 43
eH2_4                 1.824650e-02 1 1  ON 44
eH2_5                 3.362693e-02 1 1  ON 45
eH2_6                 7.880924e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642141e-02 1 1  ON 48
eH2_9                 2.716153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.20022
====================================================
  Execution time = 2.0284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2474e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749876708
                                         uncertainty =       0.004541830800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749876708
                                         uncertainty =       0.004541830800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402953697
  error estimate for blocks of size 2^( 2) =       0.000412215327
  error estimate for blocks of size 2^( 3) =       0.000420991500
  error estimate for blocks of size 2^( 4) =       0.000427497392
  error estimate for blocks of size 2^( 5) =       0.000431974877
  error estimate for blocks of size 2^( 6) =       0.000435373654
  error estimate for blocks of size 2^( 7) =       0.000436318589

      target function =                  N/A
              le_mean =     -17.216879504726
             les_mean =     296.745683081547
             stat err =       0.000432791128
             autocorr =       1.153576524818
              std dev =       0.569862583141
             le_variance =       0.324743363664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687950473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879504726       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879511351       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879521687       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879526469       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879530694       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879528004       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879525656       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 4.220439e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879504726       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879506385       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879508976       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879510174       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879511230       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879510562       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879509973       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.055663e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879504726       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879505141       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879505789       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879506089       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879506353       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879506186       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879506038       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.639503e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5785e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.117997e-01 1 1  ON 0
 uu_1                 4.959529e-02 1 1  ON 1
 uu_2                -4.508633e-02 1 1  ON 2
 uu_3                -9.992541e-02 1 1  ON 3
 uu_4                -1.332521e-01 1 1  ON 4
 uu_5                -1.395274e-01 1 1  ON 5
 uu_6                -1.161064e-01 1 1  ON 6
 uu_7                -4.289437e-02 1 1  ON 7
 uu_8                 9.769683e-02 1 1  ON 8
 uu_9                 1.227279e-01 1 1  ON 9
 ud_0                 3.520898e-01 1 1  ON 10
 ud_1                 9.373518e-02 1 1  ON 11
 ud_2                -1.539076e-02 1 1  ON 12
 ud_3                -7.563153e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535598e-01 1 1  ON 15
 ud_6                -1.546379e-01 1 1  ON 16
 ud_7                -1.114315e-01 1 1  ON 17
 ud_8                 5.486586e-04 1 1  ON 18
 ud_9                 9.261014e-02 1 1  ON 19
 eO_0                -7.678580e-01 1 1  ON 20
 eO_1                -4.486338e-01 1 1  ON 21
 eO_2                -4.132947e-02 1 1  ON 22
 eO_3                 2.125155e-01 1 1  ON 23
 eO_4                 3.040642e-01 1 1  ON 24
 eO_5                 3.129475e-01 1 1  ON 25
 eO_6                 2.535414e-01 1 1  ON 26
 eO_7                 1.165584e-01 1 1  ON 27
 eO_8                 2.873923e-02 1 1  ON 28
 eO_9                 1.871502e-02 1 1  ON 29
eH1_0                -1.826062e-01 1 1  ON 30
eH1_1                -1.034316e-01 1 1  ON 31
eH1_2                -6.245993e-02 1 1  ON 32
eH1_3                -2.586361e-02 1 1  ON 33
eH1_4                 1.925850e-02 1 1  ON 34
eH1_5                 3.369502e-02 1 1  ON 35
eH1_6                 7.735283e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351896e-02 1 1  ON 38
eH1_9                 2.514546e-02 1 1  ON 39
eH2_0                -1.840962e-01 1 1  ON 40
eH2_1                -1.048738e-01 1 1  ON 41
eH2_2                -6.387847e-02 1 1  ON 42
eH2_3                -2.707645e-02 1 1  ON 43
eH2_4                 1.824641e-02 1 1  ON 44
eH2_5                 3.362668e-02 1 1  ON 45
eH2_6                 7.880917e-02 1 1  ON 46
eH2_7                 1.133432e-01 1 1  ON 47
eH2_8                 9.642163e-02 1 1  ON 48
eH2_9                 2.716161e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.166135
====================================================
  Execution time = 1.9891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2007e-01
  Total weights = 2.0000e+06
  Execution time = 1.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320136624178
                                         uncertainty =       0.004007435852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320136624178
                                         uncertainty =       0.004007435852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400041969
  error estimate for blocks of size 2^( 2) =       0.000409324262
  error estimate for blocks of size 2^( 3) =       0.000418322130
  error estimate for blocks of size 2^( 4) =       0.000425087935
  error estimate for blocks of size 2^( 5) =       0.000429552606
  error estimate for blocks of size 2^( 6) =       0.000431490637
  error estimate for blocks of size 2^( 7) =       0.000432949042

      target function =                  N/A
              le_mean =     -17.216889181892
             les_mean =     296.741340095949
             stat err =       0.000429770055
             autocorr =       1.154147169816
              std dev =       0.565744778530
             le_variance =       0.320067154434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320137441386
                                         uncertainty =       0.004007450228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320137441386
                                         uncertainty =       0.004007450228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400042480
  error estimate for blocks of size 2^( 2) =       0.000409324742
  error estimate for blocks of size 2^( 3) =       0.000418322579
  error estimate for blocks of size 2^( 4) =       0.000425088394
  error estimate for blocks of size 2^( 5) =       0.000429553048
  error estimate for blocks of size 2^( 6) =       0.000431491079
  error estimate for blocks of size 2^( 7) =       0.000432949454

      target function =                  N/A
              le_mean =     -17.216889190049
             les_mean =     296.741341194107
             stat err =       0.000429770494
             autocorr =       1.154146578782
              std dev =       0.565745500842
             le_variance =       0.320067971723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320137033129
                                         uncertainty =       0.004007443058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320137033129
                                         uncertainty =       0.004007443058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400042225
  error estimate for blocks of size 2^( 2) =       0.000409324502
  error estimate for blocks of size 2^( 3) =       0.000418322355
  error estimate for blocks of size 2^( 4) =       0.000425088165
  error estimate for blocks of size 2^( 5) =       0.000429552827
  error estimate for blocks of size 2^( 6) =       0.000431490858
  error estimate for blocks of size 2^( 7) =       0.000432949248

      target function =                  N/A
              le_mean =     -17.216889185976
             les_mean =     296.741340645553
             stat err =       0.000429770275
             autocorr =       1.154146874512
              std dev =       0.565745139993
             le_variance =       0.320067563426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320136675306
                                         uncertainty =       0.004007436753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320136675306
                                         uncertainty =       0.004007436753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400042001
  error estimate for blocks of size 2^( 2) =       0.000409324292
  error estimate for blocks of size 2^( 3) =       0.000418322158
  error estimate for blocks of size 2^( 4) =       0.000425087964
  error estimate for blocks of size 2^( 5) =       0.000429552633
  error estimate for blocks of size 2^( 6) =       0.000431490665
  error estimate for blocks of size 2^( 7) =       0.000432949068

      target function =                  N/A
              le_mean =     -17.216889182402
             les_mean =     296.741340164658
             stat err =       0.000429770083
             autocorr =       1.154147132902
              std dev =       0.565744823721
             le_variance =       0.320067205567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216889181892        initial
     9.5367e+01     9.5367e+02             4.2204e-06       -17.216889190049  <--
     3.8147e+02     3.8147e+03             1.0557e-06       -17.216889185976
     1.5259e+03     1.5259e+04             2.6395e-07       -17.216889182402

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9058e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.117998e-01 1 1  ON 0
 uu_1                 4.959591e-02 1 1  ON 1
 uu_2                -4.508542e-02 1 1  ON 2
 uu_3                -9.992545e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395281e-01 1 1  ON 5
 uu_6                -1.161072e-01 1 1  ON 6
 uu_7                -4.289505e-02 1 1  ON 7
 uu_8                 9.769628e-02 1 1  ON 8
 uu_9                 1.227284e-01 1 1  ON 9
 ud_0                 3.520907e-01 1 1  ON 10
 ud_1                 9.373503e-02 1 1  ON 11
 ud_2                -1.539041e-02 1 1  ON 12
 ud_3                -7.563204e-02 1 1  ON 13
 ud_4                -1.225821e-01 1 1  ON 14
 ud_5                -1.535606e-01 1 1  ON 15
 ud_6                -1.546381e-01 1 1  ON 16
 ud_7                -1.114311e-01 1 1  ON 17
 ud_8                 5.479326e-04 1 1  ON 18
 ud_9                 9.261017e-02 1 1  ON 19
 eO_0                -7.678612e-01 1 1  ON 20
 eO_1                -4.486355e-01 1 1  ON 21
 eO_2                -4.133069e-02 1 1  ON 22
 eO_3                 2.125158e-01 1 1  ON 23
 eO_4                 3.040663e-01 1 1  ON 24
 eO_5                 3.129489e-01 1 1  ON 25
 eO_6                 2.535424e-01 1 1  ON 26
 eO_7                 1.165594e-01 1 1  ON 27
 eO_8                 2.873945e-02 1 1  ON 28
 eO_9                 1.871510e-02 1 1  ON 29
eH1_0                -1.826069e-01 1 1  ON 30
eH1_1                -1.034322e-01 1 1  ON 31
eH1_2                -6.246027e-02 1 1  ON 32
eH1_3                -2.586318e-02 1 1  ON 33
eH1_4                 1.925889e-02 1 1  ON 34
eH1_5                 3.369465e-02 1 1  ON 35
eH1_6                 7.735313e-02 1 1  ON 36
eH1_7                 1.098378e-01 1 1  ON 37
eH1_8                 9.351950e-02 1 1  ON 38
eH1_9                 2.514567e-02 1 1  ON 39
eH2_0                -1.840957e-01 1 1  ON 40
eH2_1                -1.048741e-01 1 1  ON 41
eH2_2                -6.387855e-02 1 1  ON 42
eH2_3                -2.707648e-02 1 1  ON 43
eH2_4                 1.824614e-02 1 1  ON 44
eH2_5                 3.362591e-02 1 1  ON 45
eH2_6                 7.880898e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642231e-02 1 1  ON 48
eH2_9                 2.716184e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1662
    reference variance = 0.252588
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322916662446
                                         uncertainty =       0.004790964386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322916662446
                                         uncertainty =       0.004790964386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401812866
  error estimate for blocks of size 2^( 2) =       0.000411282149
  error estimate for blocks of size 2^( 3) =       0.000419946023
  error estimate for blocks of size 2^( 4) =       0.000426825058
  error estimate for blocks of size 2^( 5) =       0.000430789129
  error estimate for blocks of size 2^( 6) =       0.000432269019
  error estimate for blocks of size 2^( 7) =       0.000435699864

      target function =                  N/A
              le_mean =     -17.217635438238
             les_mean =     296.769877081912
             stat err =       0.000431395767
             autocorr =       1.152667587101
              std dev =       0.568249205281
             le_variance =       0.322907159302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721763543824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217635438238       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217635452091       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217635418974       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217635404557       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217635435924       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217635435638       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217635436004       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.794422e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217635438238       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217635441719       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217635433332       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217635429648       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217635437501       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217635437469       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217635437580       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 4.499874e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217635438238       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217635439109       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217635437006       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217635436080       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217635438043       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217635438038       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217635438067       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.125842e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5763e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.117999e-01 1 1  ON 0
 uu_1                 4.959636e-02 1 1  ON 1
 uu_2                -4.508461e-02 1 1  ON 2
 uu_3                -9.992512e-02 1 1  ON 3
 uu_4                -1.332511e-01 1 1  ON 4
 uu_5                -1.395288e-01 1 1  ON 5
 uu_6                -1.161080e-01 1 1  ON 6
 uu_7                -4.289643e-02 1 1  ON 7
 uu_8                 9.769529e-02 1 1  ON 8
 uu_9                 1.227288e-01 1 1  ON 9
 ud_0                 3.520908e-01 1 1  ON 10
 ud_1                 9.373590e-02 1 1  ON 11
 ud_2                -1.538918e-02 1 1  ON 12
 ud_3                -7.563196e-02 1 1  ON 13
 ud_4                -1.225829e-01 1 1  ON 14
 ud_5                -1.535608e-01 1 1  ON 15
 ud_6                -1.546381e-01 1 1  ON 16
 ud_7                -1.114316e-01 1 1  ON 17
 ud_8                 5.464007e-04 1 1  ON 18
 ud_9                 9.261010e-02 1 1  ON 19
 eO_0                -7.678657e-01 1 1  ON 20
 eO_1                -4.486371e-01 1 1  ON 21
 eO_2                -4.133226e-02 1 1  ON 22
 eO_3                 2.125154e-01 1 1  ON 23
 eO_4                 3.040694e-01 1 1  ON 24
 eO_5                 3.129515e-01 1 1  ON 25
 eO_6                 2.535434e-01 1 1  ON 26
 eO_7                 1.165605e-01 1 1  ON 27
 eO_8                 2.873957e-02 1 1  ON 28
 eO_9                 1.871514e-02 1 1  ON 29
eH1_0                -1.826075e-01 1 1  ON 30
eH1_1                -1.034325e-01 1 1  ON 31
eH1_2                -6.246054e-02 1 1  ON 32
eH1_3                -2.586331e-02 1 1  ON 33
eH1_4                 1.925830e-02 1 1  ON 34
eH1_5                 3.369520e-02 1 1  ON 35
eH1_6                 7.735382e-02 1 1  ON 36
eH1_7                 1.098376e-01 1 1  ON 37
eH1_8                 9.351999e-02 1 1  ON 38
eH1_9                 2.514588e-02 1 1  ON 39
eH2_0                -1.840963e-01 1 1  ON 40
eH2_1                -1.048751e-01 1 1  ON 41
eH2_2                -6.387787e-02 1 1  ON 42
eH2_3                -2.707613e-02 1 1  ON 43
eH2_4                 1.824627e-02 1 1  ON 44
eH2_5                 3.362533e-02 1 1  ON 45
eH2_6                 7.880903e-02 1 1  ON 46
eH2_7                 1.133433e-01 1 1  ON 47
eH2_8                 9.642305e-02 1 1  ON 48
eH2_9                 2.716210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2515
    reference variance = 0.451775
====================================================
  Execution time = 2.1734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1601e-01
  Total weights = 2.0000e+06
  Execution time = 1.8175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084559860
                                         uncertainty =       0.003150700595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084559860
                                         uncertainty =       0.003150700595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397501956
  error estimate for blocks of size 2^( 2) =       0.000407164849
  error estimate for blocks of size 2^( 3) =       0.000415683427
  error estimate for blocks of size 2^( 4) =       0.000421762341
  error estimate for blocks of size 2^( 5) =       0.000425073776
  error estimate for blocks of size 2^( 6) =       0.000425534223
  error estimate for blocks of size 2^( 7) =       0.000426399704

      target function =                  N/A
              le_mean =     -17.216236156089
             les_mean =     296.714802833919
             stat err =       0.000424692511
             autocorr =       1.141486200567
              std dev =       0.562152656952
             le_variance =       0.316015609718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316081042299
                                         uncertainty =       0.003150682390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316081042299
                                         uncertainty =       0.003150682390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397499747
  error estimate for blocks of size 2^( 2) =       0.000407162711
  error estimate for blocks of size 2^( 3) =       0.000415681328
  error estimate for blocks of size 2^( 4) =       0.000421760343
  error estimate for blocks of size 2^( 5) =       0.000425071779
  error estimate for blocks of size 2^( 6) =       0.000425532256
  error estimate for blocks of size 2^( 7) =       0.000426397717

      target function =                  N/A
              le_mean =     -17.216236148339
             les_mean =     296.714799054551
             stat err =       0.000424690524
             autocorr =       1.141488205432
              std dev =       0.562149532758
             le_variance =       0.316012097180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316082766188
                                         uncertainty =       0.003150691330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316082766188
                                         uncertainty =       0.003150691330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397500829
  error estimate for blocks of size 2^( 2) =       0.000407163759
  error estimate for blocks of size 2^( 3) =       0.000415682357
  error estimate for blocks of size 2^( 4) =       0.000421761323
  error estimate for blocks of size 2^( 5) =       0.000425072759
  error estimate for blocks of size 2^( 6) =       0.000425533221
  error estimate for blocks of size 2^( 7) =       0.000426398692

      target function =                  N/A
              le_mean =     -17.216236151979
             les_mean =     296.714800901290
             stat err =       0.000424691499
             autocorr =       1.141487230436
              std dev =       0.562151063852
             le_variance =       0.316013818590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084334508
                                         uncertainty =       0.003150699432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084334508
                                         uncertainty =       0.003150699432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397501814
  error estimate for blocks of size 2^( 2) =       0.000407164712
  error estimate for blocks of size 2^( 3) =       0.000415683292
  error estimate for blocks of size 2^( 4) =       0.000421762213
  error estimate for blocks of size 2^( 5) =       0.000425073648
  error estimate for blocks of size 2^( 6) =       0.000425534097
  error estimate for blocks of size 2^( 7) =       0.000426399577

      target function =                  N/A
              le_mean =     -17.216236155563
             les_mean =     296.714802590784
             stat err =       0.000424692384
             autocorr =       1.141486330170
              std dev =       0.562152456799
             le_variance =       0.316015384685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216236156089        initial  <--
     2.3842e+01     2.3842e+02             1.7944e-05       -17.216236148339
     9.5367e+01     9.5367e+02             4.4999e-06       -17.216236151979
     3.8147e+02     3.8147e+03             1.1258e-06       -17.216236155563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9173
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.117998e-01 1 1  ON 0
 uu_1                 4.959591e-02 1 1  ON 1
 uu_2                -4.508542e-02 1 1  ON 2
 uu_3                -9.992545e-02 1 1  ON 3
 uu_4                -1.332522e-01 1 1  ON 4
 uu_5                -1.395281e-01 1 1  ON 5
 uu_6                -1.161072e-01 1 1  ON 6
 uu_7                -4.289505e-02 1 1  ON 7
 uu_8                 9.769628e-02 1 1  ON 8
 uu_9                 1.227284e-01 1 1  ON 9
 ud_0                 3.520907e-01 1 1  ON 10
 ud_1                 9.373503e-02 1 1  ON 11
 ud_2                -1.539041e-02 1 1  ON 12
 ud_3                -7.563204e-02 1 1  ON 13
 ud_4                -1.225821e-01 1 1  ON 14
 ud_5                -1.535606e-01 1 1  ON 15
 ud_6                -1.546381e-01 1 1  ON 16
 ud_7                -1.114311e-01 1 1  ON 17
 ud_8                 5.479326e-04 1 1  ON 18
 ud_9                 9.261017e-02 1 1  ON 19
 eO_0                -7.678612e-01 1 1  ON 20
 eO_1                -4.486355e-01 1 1  ON 21
 eO_2                -4.133069e-02 1 1  ON 22
 eO_3                 2.125158e-01 1 1  ON 23
 eO_4                 3.040663e-01 1 1  ON 24
 eO_5                 3.129489e-01 1 1  ON 25
 eO_6                 2.535424e-01 1 1  ON 26
 eO_7                 1.165594e-01 1 1  ON 27
 eO_8                 2.873945e-02 1 1  ON 28
 eO_9                 1.871510e-02 1 1  ON 29
eH1_0                -1.826069e-01 1 1  ON 30
eH1_1                -1.034322e-01 1 1  ON 31
eH1_2                -6.246027e-02 1 1  ON 32
eH1_3                -2.586318e-02 1 1  ON 33
eH1_4                 1.925889e-02 1 1  ON 34
eH1_5                 3.369465e-02 1 1  ON 35
eH1_6                 7.735313e-02 1 1  ON 36
eH1_7                 1.098378e-01 1 1  ON 37
eH1_8                 9.351950e-02 1 1  ON 38
eH1_9                 2.514567e-02 1 1  ON 39
eH2_0                -1.840957e-01 1 1  ON 40
eH2_1                -1.048741e-01 1 1  ON 41
eH2_2                -6.387855e-02 1 1  ON 42
eH2_3                -2.707648e-02 1 1  ON 43
eH2_4                 1.824614e-02 1 1  ON 44
eH2_5                 3.362591e-02 1 1  ON 45
eH2_6                 7.880898e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642231e-02 1 1  ON 48
eH2_9                 2.716184e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1465
    reference variance = 0.129745
====================================================
  Execution time = 2.0348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313916099798
                                         uncertainty =       0.003274603423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313916099798
                                         uncertainty =       0.003274603423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396142763
  error estimate for blocks of size 2^( 2) =       0.000405681500
  error estimate for blocks of size 2^( 3) =       0.000414622572
  error estimate for blocks of size 2^( 4) =       0.000420713893
  error estimate for blocks of size 2^( 5) =       0.000424881042
  error estimate for blocks of size 2^( 6) =       0.000427191507
  error estimate for blocks of size 2^( 7) =       0.000426234012

      target function =                  N/A
              le_mean =     -17.216266411189
             les_mean =     296.713687162130
             stat err =       0.000424755114
             autocorr =       1.149671533934
              std dev =       0.560230468662
             le_variance =       0.313858178017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626641119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266411189       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266409901       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216266411323       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216266412379       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266413335       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216266413325       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216266413833       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.372897e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266411189       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266410867       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216266411223       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216266411487       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266411725       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216266411723       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216266411850       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.432667e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266411189       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266411109       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216266411198       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216266411264       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266411324       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216266411323       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216266411354       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 8.581933e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5918e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.118000e-01 1 1  ON 0
 uu_1                 4.959602e-02 1 1  ON 1
 uu_2                -4.508531e-02 1 1  ON 2
 uu_3                -9.992545e-02 1 1  ON 3
 uu_4                -1.332521e-01 1 1  ON 4
 uu_5                -1.395283e-01 1 1  ON 5
 uu_6                -1.161073e-01 1 1  ON 6
 uu_7                -4.289519e-02 1 1  ON 7
 uu_8                 9.769618e-02 1 1  ON 8
 uu_9                 1.227284e-01 1 1  ON 9
 ud_0                 3.520908e-01 1 1  ON 10
 ud_1                 9.373502e-02 1 1  ON 11
 ud_2                -1.539039e-02 1 1  ON 12
 ud_3                -7.563199e-02 1 1  ON 13
 ud_4                -1.225822e-01 1 1  ON 14
 ud_5                -1.535605e-01 1 1  ON 15
 ud_6                -1.546382e-01 1 1  ON 16
 ud_7                -1.114311e-01 1 1  ON 17
 ud_8                 5.478207e-04 1 1  ON 18
 ud_9                 9.261016e-02 1 1  ON 19
 eO_0                -7.678615e-01 1 1  ON 20
 eO_1                -4.486358e-01 1 1  ON 21
 eO_2                -4.133093e-02 1 1  ON 22
 eO_3                 2.125158e-01 1 1  ON 23
 eO_4                 3.040666e-01 1 1  ON 24
 eO_5                 3.129492e-01 1 1  ON 25
 eO_6                 2.535426e-01 1 1  ON 26
 eO_7                 1.165595e-01 1 1  ON 27
 eO_8                 2.873946e-02 1 1  ON 28
 eO_9                 1.871510e-02 1 1  ON 29
eH1_0                -1.826069e-01 1 1  ON 30
eH1_1                -1.034323e-01 1 1  ON 31
eH1_2                -6.246028e-02 1 1  ON 32
eH1_3                -2.586321e-02 1 1  ON 33
eH1_4                 1.925892e-02 1 1  ON 34
eH1_5                 3.369468e-02 1 1  ON 35
eH1_6                 7.735310e-02 1 1  ON 36
eH1_7                 1.098378e-01 1 1  ON 37
eH1_8                 9.351955e-02 1 1  ON 38
eH1_9                 2.514568e-02 1 1  ON 39
eH2_0                -1.840957e-01 1 1  ON 40
eH2_1                -1.048742e-01 1 1  ON 41
eH2_2                -6.387858e-02 1 1  ON 42
eH2_3                -2.707644e-02 1 1  ON 43
eH2_4                 1.824607e-02 1 1  ON 44
eH2_5                 3.362591e-02 1 1  ON 45
eH2_6                 7.880900e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642238e-02 1 1  ON 48
eH2_9                 2.716187e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1881
    reference variance = 0.322163
====================================================
  Execution time = 1.9574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1798e-01
  Total weights = 2.0000e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036164271
                                         uncertainty =       0.005323055900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036164271
                                         uncertainty =       0.005323055900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733331
  error estimate for blocks of size 2^( 2) =       0.000407993261
  error estimate for blocks of size 2^( 3) =       0.000416387300
  error estimate for blocks of size 2^( 4) =       0.000422667840
  error estimate for blocks of size 2^( 5) =       0.000426230500
  error estimate for blocks of size 2^( 6) =       0.000429032375
  error estimate for blocks of size 2^( 7) =       0.000429324086

      target function =                  N/A
              le_mean =     -17.216974346867
             les_mean =     296.742182039958
             stat err =       0.000426813700
             autocorr =       1.145807397015
              std dev =       0.563894084261
             le_variance =       0.317976538265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036421931
                                         uncertainty =       0.005323059017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036421931
                                         uncertainty =       0.005323059017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733492
  error estimate for blocks of size 2^( 2) =       0.000407993413
  error estimate for blocks of size 2^( 3) =       0.000416387443
  error estimate for blocks of size 2^( 4) =       0.000422667976
  error estimate for blocks of size 2^( 5) =       0.000426230631
  error estimate for blocks of size 2^( 6) =       0.000429032512
  error estimate for blocks of size 2^( 7) =       0.000429324236

      target function =                  N/A
              le_mean =     -17.216974347868
             les_mean =     296.742182331987
             stat err =       0.000426813839
             autocorr =       1.145807211885
              std dev =       0.563894312647
             le_variance =       0.317976795836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036293257
                                         uncertainty =       0.005323057463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036293257
                                         uncertainty =       0.005323057463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733412
  error estimate for blocks of size 2^( 2) =       0.000407993337
  error estimate for blocks of size 2^( 3) =       0.000416387371
  error estimate for blocks of size 2^( 4) =       0.000422667908
  error estimate for blocks of size 2^( 5) =       0.000426230566
  error estimate for blocks of size 2^( 6) =       0.000429032444
  error estimate for blocks of size 2^( 7) =       0.000429324161

      target function =                  N/A
              le_mean =     -17.216974347367
             les_mean =     296.742182186124
             stat err =       0.000426813770
             autocorr =       1.145807304397
              std dev =       0.563894198592
             le_variance =       0.317976667206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036180399
                                         uncertainty =       0.005323056095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036180399
                                         uncertainty =       0.005323056095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398733341
  error estimate for blocks of size 2^( 2) =       0.000407993270
  error estimate for blocks of size 2^( 3) =       0.000416387309
  error estimate for blocks of size 2^( 4) =       0.000422667849
  error estimate for blocks of size 2^( 5) =       0.000426230509
  error estimate for blocks of size 2^( 6) =       0.000429032384
  error estimate for blocks of size 2^( 7) =       0.000429324095

      target function =                  N/A
              le_mean =     -17.216974346930
             les_mean =     296.742182058232
             stat err =       0.000426813709
             autocorr =       1.145807385441
              std dev =       0.563894098557
             le_variance =       0.317976554387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216974346867        initial
     2.3842e+02     2.3842e+03             1.3729e-06       -17.216974347868  <--
     9.5367e+02     9.5367e+03             3.4327e-07       -17.216974347367
     3.8147e+03     3.8147e+04             8.5819e-08       -17.216974346930

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 2.8772e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.118005e-01 1 1  ON 0
 uu_1                 4.959633e-02 1 1  ON 1
 uu_2                -4.508499e-02 1 1  ON 2
 uu_3                -9.992543e-02 1 1  ON 3
 uu_4                -1.332520e-01 1 1  ON 4
 uu_5                -1.395289e-01 1 1  ON 5
 uu_6                -1.161075e-01 1 1  ON 6
 uu_7                -4.289559e-02 1 1  ON 7
 uu_8                 9.769586e-02 1 1  ON 8
 uu_9                 1.227285e-01 1 1  ON 9
 ud_0                 3.520909e-01 1 1  ON 10
 ud_1                 9.373499e-02 1 1  ON 11
 ud_2                -1.539031e-02 1 1  ON 12
 ud_3                -7.563182e-02 1 1  ON 13
 ud_4                -1.225824e-01 1 1  ON 14
 ud_5                -1.535604e-01 1 1  ON 15
 ud_6                -1.546383e-01 1 1  ON 16
 ud_7                -1.114311e-01 1 1  ON 17
 ud_8                 5.474851e-04 1 1  ON 18
 ud_9                 9.261015e-02 1 1  ON 19
 eO_0                -7.678625e-01 1 1  ON 20
 eO_1                -4.486365e-01 1 1  ON 21
 eO_2                -4.133165e-02 1 1  ON 22
 eO_3                 2.125157e-01 1 1  ON 23
 eO_4                 3.040675e-01 1 1  ON 24
 eO_5                 3.129500e-01 1 1  ON 25
 eO_6                 2.535429e-01 1 1  ON 26
 eO_7                 1.165599e-01 1 1  ON 27
 eO_8                 2.873951e-02 1 1  ON 28
 eO_9                 1.871510e-02 1 1  ON 29
eH1_0                -1.826068e-01 1 1  ON 30
eH1_1                -1.034325e-01 1 1  ON 31
eH1_2                -6.246030e-02 1 1  ON 32
eH1_3                -2.586330e-02 1 1  ON 33
eH1_4                 1.925902e-02 1 1  ON 34
eH1_5                 3.369476e-02 1 1  ON 35
eH1_6                 7.735299e-02 1 1  ON 36
eH1_7                 1.098377e-01 1 1  ON 37
eH1_8                 9.351972e-02 1 1  ON 38
eH1_9                 2.514572e-02 1 1  ON 39
eH2_0                -1.840957e-01 1 1  ON 40
eH2_1                -1.048742e-01 1 1  ON 41
eH2_2                -6.387868e-02 1 1  ON 42
eH2_3                -2.707630e-02 1 1  ON 43
eH2_4                 1.824586e-02 1 1  ON 44
eH2_5                 3.362589e-02 1 1  ON 45
eH2_6                 7.880906e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642258e-02 1 1  ON 48
eH2_9                 2.716194e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.263437
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311523157528
                                         uncertainty =       0.002387199322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311523157528
                                         uncertainty =       0.002387199322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394680951
  error estimate for blocks of size 2^( 2) =       0.000404380000
  error estimate for blocks of size 2^( 3) =       0.000412658826
  error estimate for blocks of size 2^( 4) =       0.000418942119
  error estimate for blocks of size 2^( 5) =       0.000422587301
  error estimate for blocks of size 2^( 6) =       0.000424952279
  error estimate for blocks of size 2^( 7) =       0.000427474776

      target function =                  N/A
              le_mean =     -17.216822069932
             les_mean =     296.730508138298
             stat err =       0.000423489119
             autocorr =       1.151309740772
              std dev =       0.558163153914
             le_variance =       0.311546106387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682206993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216822069932       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216822073308       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216822071316       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216822080454       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216822081778       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216822083553       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216822083188       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 7.631553e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216822069932       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216822070778       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216822070279       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216822072566       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216822072903       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216822073345       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216822073252       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.909819e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216822069932       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216822070143       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216822070019       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216822070591       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216822070676       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216822070786       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216822070762       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.775759e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5975e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.118009e-01 1 1  ON 0
 uu_1                 4.959671e-02 1 1  ON 1
 uu_2                -4.508503e-02 1 1  ON 2
 uu_3                -9.992547e-02 1 1  ON 3
 uu_4                -1.332518e-01 1 1  ON 4
 uu_5                -1.395294e-01 1 1  ON 5
 uu_6                -1.161079e-01 1 1  ON 6
 uu_7                -4.289603e-02 1 1  ON 7
 uu_8                 9.769568e-02 1 1  ON 8
 uu_9                 1.227288e-01 1 1  ON 9
 ud_0                 3.520911e-01 1 1  ON 10
 ud_1                 9.373521e-02 1 1  ON 11
 ud_2                -1.539037e-02 1 1  ON 12
 ud_3                -7.563213e-02 1 1  ON 13
 ud_4                -1.225826e-01 1 1  ON 14
 ud_5                -1.535603e-01 1 1  ON 15
 ud_6                -1.546384e-01 1 1  ON 16
 ud_7                -1.114309e-01 1 1  ON 17
 ud_8                 5.471073e-04 1 1  ON 18
 ud_9                 9.261013e-02 1 1  ON 19
 eO_0                -7.678644e-01 1 1  ON 20
 eO_1                -4.486374e-01 1 1  ON 21
 eO_2                -4.133196e-02 1 1  ON 22
 eO_3                 2.125157e-01 1 1  ON 23
 eO_4                 3.040684e-01 1 1  ON 24
 eO_5                 3.129509e-01 1 1  ON 25
 eO_6                 2.535435e-01 1 1  ON 26
 eO_7                 1.165605e-01 1 1  ON 27
 eO_8                 2.873959e-02 1 1  ON 28
 eO_9                 1.871513e-02 1 1  ON 29
eH1_0                -1.826072e-01 1 1  ON 30
eH1_1                -1.034323e-01 1 1  ON 31
eH1_2                -6.246025e-02 1 1  ON 32
eH1_3                -2.586329e-02 1 1  ON 33
eH1_4                 1.925878e-02 1 1  ON 34
eH1_5                 3.369468e-02 1 1  ON 35
eH1_6                 7.735309e-02 1 1  ON 36
eH1_7                 1.098376e-01 1 1  ON 37
eH1_8                 9.352003e-02 1 1  ON 38
eH1_9                 2.514581e-02 1 1  ON 39
eH2_0                -1.840959e-01 1 1  ON 40
eH2_1                -1.048743e-01 1 1  ON 41
eH2_2                -6.387862e-02 1 1  ON 42
eH2_3                -2.707651e-02 1 1  ON 43
eH2_4                 1.824582e-02 1 1  ON 44
eH2_5                 3.362571e-02 1 1  ON 45
eH2_6                 7.880919e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642296e-02 1 1  ON 48
eH2_9                 2.716206e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2612
    reference variance = 0.346411
====================================================
  Execution time = 1.9786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1660e-01
  Total weights = 2.0000e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609988808
                                         uncertainty =       0.002570471567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316609988808
                                         uncertainty =       0.002570471567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867774
  error estimate for blocks of size 2^( 2) =       0.000407655119
  error estimate for blocks of size 2^( 3) =       0.000416210670
  error estimate for blocks of size 2^( 4) =       0.000423493604
  error estimate for blocks of size 2^( 5) =       0.000427605309
  error estimate for blocks of size 2^( 6) =       0.000431226648
  error estimate for blocks of size 2^( 7) =       0.000433187589

      target function =                  N/A
              le_mean =     -17.216924947291
             les_mean =     296.739102014009
             stat err =       0.000428878287
             autocorr =       1.161958430511
              std dev =       0.562670002438
             le_variance =       0.316597531644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316611299062
                                         uncertainty =       0.002570481264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316611299062
                                         uncertainty =       0.002570481264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397868597
  error estimate for blocks of size 2^( 2) =       0.000407655900
  error estimate for blocks of size 2^( 3) =       0.000416211419
  error estimate for blocks of size 2^( 4) =       0.000423494337
  error estimate for blocks of size 2^( 5) =       0.000427606048
  error estimate for blocks of size 2^( 6) =       0.000431227365
  error estimate for blocks of size 2^( 7) =       0.000433188286

      target function =                  N/A
              le_mean =     -17.216924968661
             les_mean =     296.739104059268
             stat err =       0.000428879009
             autocorr =       1.161957533331
              std dev =       0.562671166015
             le_variance =       0.316598841065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316610643934
                                         uncertainty =       0.002570476411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316610643934
                                         uncertainty =       0.002570476411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397868186
  error estimate for blocks of size 2^( 2) =       0.000407655510
  error estimate for blocks of size 2^( 3) =       0.000416211045
  error estimate for blocks of size 2^( 4) =       0.000423493970
  error estimate for blocks of size 2^( 5) =       0.000427605678
  error estimate for blocks of size 2^( 6) =       0.000431227007
  error estimate for blocks of size 2^( 7) =       0.000433187937

      target function =                  N/A
              le_mean =     -17.216924958031
             les_mean =     296.739103038509
             stat err =       0.000428878648
             autocorr =       1.161957981863
              std dev =       0.562670584227
             le_variance =       0.316598186354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316610070696
                                         uncertainty =       0.002570472172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316610070696
                                         uncertainty =       0.002570472172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867826
  error estimate for blocks of size 2^( 2) =       0.000407655168
  error estimate for blocks of size 2^( 3) =       0.000416210717
  error estimate for blocks of size 2^( 4) =       0.000423493650
  error estimate for blocks of size 2^( 5) =       0.000427605355
  error estimate for blocks of size 2^( 6) =       0.000431226693
  error estimate for blocks of size 2^( 7) =       0.000433187632

      target function =                  N/A
              le_mean =     -17.216924948635
             les_mean =     296.739102142114
             stat err =       0.000428878333
             autocorr =       1.161958374428
              std dev =       0.562670075159
             le_variance =       0.316597613480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216924947291        initial
     5.9605e+01     5.9605e+02             7.6316e-06       -17.216924968661  <--
     2.3842e+02     2.3842e+03             1.9098e-06       -17.216924958031
     9.5367e+02     9.5367e+03             4.7758e-07       -17.216924948635

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.8984e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.118022e-01 1 1  ON 0
 uu_1                 4.959785e-02 1 1  ON 1
 uu_2                -4.508517e-02 1 1  ON 2
 uu_3                -9.992558e-02 1 1  ON 3
 uu_4                -1.332515e-01 1 1  ON 4
 uu_5                -1.395311e-01 1 1  ON 5
 uu_6                -1.161088e-01 1 1  ON 6
 uu_7                -4.289736e-02 1 1  ON 7
 uu_8                 9.769512e-02 1 1  ON 8
 uu_9                 1.227296e-01 1 1  ON 9
 ud_0                 3.520916e-01 1 1  ON 10
 ud_1                 9.373587e-02 1 1  ON 11
 ud_2                -1.539055e-02 1 1  ON 12
 ud_3                -7.563307e-02 1 1  ON 13
 ud_4                -1.225831e-01 1 1  ON 14
 ud_5                -1.535601e-01 1 1  ON 15
 ud_6                -1.546385e-01 1 1  ON 16
 ud_7                -1.114303e-01 1 1  ON 17
 ud_8                 5.459743e-04 1 1  ON 18
 ud_9                 9.261007e-02 1 1  ON 19
 eO_0                -7.678702e-01 1 1  ON 20
 eO_1                -4.486400e-01 1 1  ON 21
 eO_2                -4.133291e-02 1 1  ON 22
 eO_3                 2.125157e-01 1 1  ON 23
 eO_4                 3.040712e-01 1 1  ON 24
 eO_5                 3.129534e-01 1 1  ON 25
 eO_6                 2.535451e-01 1 1  ON 26
 eO_7                 1.165623e-01 1 1  ON 27
 eO_8                 2.873984e-02 1 1  ON 28
 eO_9                 1.871523e-02 1 1  ON 29
eH1_0                -1.826086e-01 1 1  ON 30
eH1_1                -1.034316e-01 1 1  ON 31
eH1_2                -6.246008e-02 1 1  ON 32
eH1_3                -2.586328e-02 1 1  ON 33
eH1_4                 1.925804e-02 1 1  ON 34
eH1_5                 3.369444e-02 1 1  ON 35
eH1_6                 7.735340e-02 1 1  ON 36
eH1_7                 1.098375e-01 1 1  ON 37
eH1_8                 9.352095e-02 1 1  ON 38
eH1_9                 2.514606e-02 1 1  ON 39
eH2_0                -1.840964e-01 1 1  ON 40
eH2_1                -1.048748e-01 1 1  ON 41
eH2_2                -6.387846e-02 1 1  ON 42
eH2_3                -2.707714e-02 1 1  ON 43
eH2_4                 1.824568e-02 1 1  ON 44
eH2_5                 3.362519e-02 1 1  ON 45
eH2_6                 7.880959e-02 1 1  ON 46
eH2_7                 1.133434e-01 1 1  ON 47
eH2_8                 9.642409e-02 1 1  ON 48
eH2_9                 2.716240e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4964e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.118857
====================================================
  Execution time = 2.0092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325297101795
                                         uncertainty =       0.006141594052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325297101795
                                         uncertainty =       0.006141594052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403307784
  error estimate for blocks of size 2^( 2) =       0.000412693825
  error estimate for blocks of size 2^( 3) =       0.000420883330
  error estimate for blocks of size 2^( 4) =       0.000426679756
  error estimate for blocks of size 2^( 5) =       0.000429967838
  error estimate for blocks of size 2^( 6) =       0.000433238645
  error estimate for blocks of size 2^( 7) =       0.000434981129

      target function =                  N/A
              le_mean =     -17.217499402829
             les_mean =     296.767599860984
             stat err =       0.000431216842
             autocorr =       1.143189484884
              std dev =       0.570363337890
             le_variance =       0.325314337209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721749940283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217499402829       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217499392514       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217499418815       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217499422430       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217499421823       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217499441501       residual = 6.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217499442587       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 3.193165e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217499402829       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217499400199       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217499406877       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217499407766       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217499407686       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217499412530       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217499412791       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 8.026795e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217499402829       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217499402169       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217499403845       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217499404066       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217499404051       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217499405257       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217499405322       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.009485e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5633e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.118022e-01 1 1  ON 0
 uu_1                 4.959912e-02 1 1  ON 1
 uu_2                -4.508432e-02 1 1  ON 2
 uu_3                -9.992527e-02 1 1  ON 3
 uu_4                -1.332509e-01 1 1  ON 4
 uu_5                -1.395311e-01 1 1  ON 5
 uu_6                -1.161111e-01 1 1  ON 6
 uu_7                -4.289931e-02 1 1  ON 7
 uu_8                 9.769371e-02 1 1  ON 8
 uu_9                 1.227305e-01 1 1  ON 9
 ud_0                 3.520913e-01 1 1  ON 10
 ud_1                 9.373577e-02 1 1  ON 11
 ud_2                -1.538841e-02 1 1  ON 12
 ud_3                -7.563291e-02 1 1  ON 13
 ud_4                -1.225841e-01 1 1  ON 14
 ud_5                -1.535597e-01 1 1  ON 15
 ud_6                -1.546386e-01 1 1  ON 16
 ud_7                -1.114310e-01 1 1  ON 17
 ud_8                 5.440521e-04 1 1  ON 18
 ud_9                 9.261010e-02 1 1  ON 19
 eO_0                -7.678782e-01 1 1  ON 20
 eO_1                -4.486424e-01 1 1  ON 21
 eO_2                -4.133565e-02 1 1  ON 22
 eO_3                 2.125149e-01 1 1  ON 23
 eO_4                 3.040768e-01 1 1  ON 24
 eO_5                 3.129571e-01 1 1  ON 25
 eO_6                 2.535472e-01 1 1  ON 26
 eO_7                 1.165643e-01 1 1  ON 27
 eO_8                 2.874009e-02 1 1  ON 28
 eO_9                 1.871539e-02 1 1  ON 29
eH1_0                -1.826078e-01 1 1  ON 30
eH1_1                -1.034319e-01 1 1  ON 31
eH1_2                -6.245976e-02 1 1  ON 32
eH1_3                -2.586321e-02 1 1  ON 33
eH1_4                 1.925766e-02 1 1  ON 34
eH1_5                 3.369290e-02 1 1  ON 35
eH1_6                 7.735251e-02 1 1  ON 36
eH1_7                 1.098374e-01 1 1  ON 37
eH1_8                 9.352226e-02 1 1  ON 38
eH1_9                 2.514647e-02 1 1  ON 39
eH2_0                -1.840994e-01 1 1  ON 40
eH2_1                -1.048759e-01 1 1  ON 41
eH2_2                -6.387780e-02 1 1  ON 42
eH2_3                -2.707668e-02 1 1  ON 43
eH2_4                 1.824588e-02 1 1  ON 44
eH2_5                 3.362633e-02 1 1  ON 45
eH2_6                 7.881003e-02 1 1  ON 46
eH2_7                 1.133431e-01 1 1  ON 47
eH2_8                 9.642510e-02 1 1  ON 48
eH2_9                 2.716279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1392
    reference variance = 0.270797
====================================================
  Execution time = 1.9788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2064e-01
  Total weights = 2.0000e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320622211969
                                         uncertainty =       0.004518872870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320622211969
                                         uncertainty =       0.004518872870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400397918
  error estimate for blocks of size 2^( 2) =       0.000409823435
  error estimate for blocks of size 2^( 3) =       0.000418643294
  error estimate for blocks of size 2^( 4) =       0.000425023031
  error estimate for blocks of size 2^( 5) =       0.000429365566
  error estimate for blocks of size 2^( 6) =       0.000430269025
  error estimate for blocks of size 2^( 7) =       0.000430830181

      target function =                  N/A
              le_mean =     -17.216301520742
             les_mean =     296.721674878713
             stat err =       0.000428871951
             autocorr =       1.147285922827
              std dev =       0.566248166386
             le_variance =       0.320636985936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320617251563
                                         uncertainty =       0.004518634702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320617251563
                                         uncertainty =       0.004518634702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400394820
  error estimate for blocks of size 2^( 2) =       0.000409820493
  error estimate for blocks of size 2^( 3) =       0.000418640540
  error estimate for blocks of size 2^( 4) =       0.000425020381
  error estimate for blocks of size 2^( 5) =       0.000429363032
  error estimate for blocks of size 2^( 6) =       0.000430266722
  error estimate for blocks of size 2^( 7) =       0.000430828201

      target function =                  N/A
              le_mean =     -17.216301569770
             les_mean =     296.721671604062
             stat err =       0.000428869584
             autocorr =       1.147291017394
              std dev =       0.566243784158
             le_variance =       0.320632023097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320619671401
                                         uncertainty =       0.004518750384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320619671401
                                         uncertainty =       0.004518750384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400396331
  error estimate for blocks of size 2^( 2) =       0.000409821929
  error estimate for blocks of size 2^( 3) =       0.000418641886
  error estimate for blocks of size 2^( 4) =       0.000425021677
  error estimate for blocks of size 2^( 5) =       0.000429364272
  error estimate for blocks of size 2^( 6) =       0.000430267848
  error estimate for blocks of size 2^( 7) =       0.000430829169

      target function =                  N/A
              le_mean =     -17.216301546020
             les_mean =     296.721673207321
             stat err =       0.000428870742
             autocorr =       1.147288548556
              std dev =       0.566245921964
             le_variance =       0.320634444141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320621892347
                                         uncertainty =       0.004518857449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320621892347
                                         uncertainty =       0.004518857449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400397719
  error estimate for blocks of size 2^( 2) =       0.000409823246
  error estimate for blocks of size 2^( 3) =       0.000418643117
  error estimate for blocks of size 2^( 4) =       0.000425022861
  error estimate for blocks of size 2^( 5) =       0.000429365403
  error estimate for blocks of size 2^( 6) =       0.000430268877
  error estimate for blocks of size 2^( 7) =       0.000430830054

      target function =                  N/A
              le_mean =     -17.216301523911
             les_mean =     296.721674668055
             stat err =       0.000428871799
             autocorr =       1.147286253523
              std dev =       0.566247884022
             le_variance =       0.320636666160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216301520742        initial
     1.4901e+01     1.4901e+02             3.1932e-05       -17.216301569770  <--
     5.9605e+01     5.9605e+02             8.0268e-06       -17.216301546020
     2.3842e+02     2.3842e+03             2.0095e-06       -17.216301523911

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.9018e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.118024e-01 1 1  ON 0
 uu_1                 4.960293e-02 1 1  ON 1
 uu_2                -4.508185e-02 1 1  ON 2
 uu_3                -9.992428e-02 1 1  ON 3
 uu_4                -1.332495e-01 1 1  ON 4
 uu_5                -1.395309e-01 1 1  ON 5
 uu_6                -1.161180e-01 1 1  ON 6
 uu_7                -4.290516e-02 1 1  ON 7
 uu_8                 9.768945e-02 1 1  ON 8
 uu_9                 1.227335e-01 1 1  ON 9
 ud_0                 3.520902e-01 1 1  ON 10
 ud_1                 9.373563e-02 1 1  ON 11
 ud_2                -1.538218e-02 1 1  ON 12
 ud_3                -7.563235e-02 1 1  ON 13
 ud_4                -1.225871e-01 1 1  ON 14
 ud_5                -1.535585e-01 1 1  ON 15
 ud_6                -1.546387e-01 1 1  ON 16
 ud_7                -1.114329e-01 1 1  ON 17
 ud_8                 5.382927e-04 1 1  ON 18
 ud_9                 9.261020e-02 1 1  ON 19
 eO_0                -7.679021e-01 1 1  ON 20
 eO_1                -4.486497e-01 1 1  ON 21
 eO_2                -4.134376e-02 1 1  ON 22
 eO_3                 2.125125e-01 1 1  ON 23
 eO_4                 3.040935e-01 1 1  ON 24
 eO_5                 3.129680e-01 1 1  ON 25
 eO_6                 2.535535e-01 1 1  ON 26
 eO_7                 1.165703e-01 1 1  ON 27
 eO_8                 2.874081e-02 1 1  ON 28
 eO_9                 1.871589e-02 1 1  ON 29
eH1_0                -1.826052e-01 1 1  ON 30
eH1_1                -1.034327e-01 1 1  ON 31
eH1_2                -6.245881e-02 1 1  ON 32
eH1_3                -2.586300e-02 1 1  ON 33
eH1_4                 1.925652e-02 1 1  ON 34
eH1_5                 3.368826e-02 1 1  ON 35
eH1_6                 7.734985e-02 1 1  ON 36
eH1_7                 1.098370e-01 1 1  ON 37
eH1_8                 9.352618e-02 1 1  ON 38
eH1_9                 2.514771e-02 1 1  ON 39
eH2_0                -1.841082e-01 1 1  ON 40
eH2_1                -1.048792e-01 1 1  ON 41
eH2_2                -6.387584e-02 1 1  ON 42
eH2_3                -2.707538e-02 1 1  ON 43
eH2_4                 1.824648e-02 1 1  ON 44
eH2_5                 3.362972e-02 1 1  ON 45
eH2_6                 7.881134e-02 1 1  ON 46
eH2_7                 1.133422e-01 1 1  ON 47
eH2_8                 9.642812e-02 1 1  ON 48
eH2_9                 2.716394e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2423
    reference variance = 0.340834
====================================================
  Execution time = 2.0128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1595e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315852399546
                                         uncertainty =       0.002831469895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315852399546
                                         uncertainty =       0.002831469895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397461264
  error estimate for blocks of size 2^( 2) =       0.000407322735
  error estimate for blocks of size 2^( 3) =       0.000416033033
  error estimate for blocks of size 2^( 4) =       0.000422671126
  error estimate for blocks of size 2^( 5) =       0.000427183452
  error estimate for blocks of size 2^( 6) =       0.000428560567
  error estimate for blocks of size 2^( 7) =       0.000427468883

      target function =                  N/A
              le_mean =     -17.216215504311
             les_mean =     296.714027046252
             stat err =       0.000426471007
             autocorr =       1.151302383254
              std dev =       0.562095110605
             le_variance =       0.315950913366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621550431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215504311       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215521182       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215653047       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215545496       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215606353       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215674878       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215671404       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 1.140594e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215504311       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215508678       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215544486       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215518748       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215531432       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215547549       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215546955       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.885464e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215504311       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215505412       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215514553       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215508210       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215511220       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215515161       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215515016       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 7.235704e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5657e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.118081e-01 1 1  ON 0
 uu_1                 4.960698e-02 1 1  ON 1
 uu_2                -4.507757e-02 1 1  ON 2
 uu_3                -9.992801e-02 1 1  ON 3
 uu_4                -1.332520e-01 1 1  ON 4
 uu_5                -1.395312e-01 1 1  ON 5
 uu_6                -1.161194e-01 1 1  ON 6
 uu_7                -4.291701e-02 1 1  ON 7
 uu_8                 9.768556e-02 1 1  ON 8
 uu_9                 1.227383e-01 1 1  ON 9
 ud_0                 3.520968e-01 1 1  ON 10
 ud_1                 9.374012e-02 1 1  ON 11
 ud_2                -1.537778e-02 1 1  ON 12
 ud_3                -7.563420e-02 1 1  ON 13
 ud_4                -1.225905e-01 1 1  ON 14
 ud_5                -1.535638e-01 1 1  ON 15
 ud_6                -1.546405e-01 1 1  ON 16
 ud_7                -1.114338e-01 1 1  ON 17
 ud_8                 5.312027e-04 1 1  ON 18
 ud_9                 9.261103e-02 1 1  ON 19
 eO_0                -7.679310e-01 1 1  ON 20
 eO_1                -4.486671e-01 1 1  ON 21
 eO_2                -4.135408e-02 1 1  ON 22
 eO_3                 2.125188e-01 1 1  ON 23
 eO_4                 3.041154e-01 1 1  ON 24
 eO_5                 3.129799e-01 1 1  ON 25
 eO_6                 2.535602e-01 1 1  ON 26
 eO_7                 1.165774e-01 1 1  ON 27
 eO_8                 2.874265e-02 1 1  ON 28
 eO_9                 1.871643e-02 1 1  ON 29
eH1_0                -1.826115e-01 1 1  ON 30
eH1_1                -1.034393e-01 1 1  ON 31
eH1_2                -6.246310e-02 1 1  ON 32
eH1_3                -2.586040e-02 1 1  ON 33
eH1_4                 1.925450e-02 1 1  ON 34
eH1_5                 3.369333e-02 1 1  ON 35
eH1_6                 7.735572e-02 1 1  ON 36
eH1_7                 1.098375e-01 1 1  ON 37
eH1_8                 9.353014e-02 1 1  ON 38
eH1_9                 2.514872e-02 1 1  ON 39
eH2_0                -1.841123e-01 1 1  ON 40
eH2_1                -1.048743e-01 1 1  ON 41
eH2_2                -6.387915e-02 1 1  ON 42
eH2_3                -2.707484e-02 1 1  ON 43
eH2_4                 1.824299e-02 1 1  ON 44
eH2_5                 3.362443e-02 1 1  ON 45
eH2_6                 7.881205e-02 1 1  ON 46
eH2_7                 1.133440e-01 1 1  ON 47
eH2_8                 9.643406e-02 1 1  ON 48
eH2_9                 2.716572e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.33712
====================================================
  Execution time = 1.9626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2447e-01
  Total weights = 2.0000e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324528159144
                                         uncertainty =       0.005134695002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324528159144
                                         uncertainty =       0.005134695002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402781468
  error estimate for blocks of size 2^( 2) =       0.000412437698
  error estimate for blocks of size 2^( 3) =       0.000421538684
  error estimate for blocks of size 2^( 4) =       0.000428047476
  error estimate for blocks of size 2^( 5) =       0.000432155405
  error estimate for blocks of size 2^( 6) =       0.000433803753
  error estimate for blocks of size 2^( 7) =       0.000434312839

      target function =                  N/A
              le_mean =     -17.216584287439
             les_mean =     296.735240185592
             stat err =       0.000432079868
             autocorr =       1.150771516296
              std dev =       0.569619014209
             le_variance =       0.324465821349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324546947564
                                         uncertainty =       0.005135158141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324546947564
                                         uncertainty =       0.005135158141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402793115
  error estimate for blocks of size 2^( 2) =       0.000412448794
  error estimate for blocks of size 2^( 3) =       0.000421549071
  error estimate for blocks of size 2^( 4) =       0.000428056998
  error estimate for blocks of size 2^( 5) =       0.000432164423
  error estimate for blocks of size 2^( 6) =       0.000433812365
  error estimate for blocks of size 2^( 7) =       0.000434321267

      target function =                  N/A
              le_mean =     -17.216584323275
             les_mean =     296.735260185862
             stat err =       0.000432088763
             autocorr =       1.150752339508
              std dev =       0.569635486653
             le_variance =       0.324484587655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324537510795
                                         uncertainty =       0.005134932165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324537510795
                                         uncertainty =       0.005134932165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402787265
  error estimate for blocks of size 2^( 2) =       0.000412443220
  error estimate for blocks of size 2^( 3) =       0.000421543851
  error estimate for blocks of size 2^( 4) =       0.000428052203
  error estimate for blocks of size 2^( 5) =       0.000432159882
  error estimate for blocks of size 2^( 6) =       0.000433808020
  error estimate for blocks of size 2^( 7) =       0.000434316999

      target function =                  N/A
              le_mean =     -17.216584304634
             les_mean =     296.735250117673
             stat err =       0.000432084276
             autocorr =       1.150761869885
              std dev =       0.569627212598
             le_variance =       0.324475161332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529325193
                                         uncertainty =       0.005134724839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324529325193
                                         uncertainty =       0.005134724839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402782190
  error estimate for blocks of size 2^( 2) =       0.000412438387
  error estimate for blocks of size 2^( 3) =       0.000421539328
  error estimate for blocks of size 2^( 4) =       0.000428048064
  error estimate for blocks of size 2^( 5) =       0.000432155963
  error estimate for blocks of size 2^( 6) =       0.000433804284
  error estimate for blocks of size 2^( 7) =       0.000434313356

      target function =                  N/A
              le_mean =     -17.216584289450
             les_mean =     296.735241419434
             stat err =       0.000432080417
             autocorr =       1.150770308468
              std dev =       0.569620036442
             le_variance =       0.324466985917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216584287439        initial
     3.7253e+00     3.7253e+01             1.1406e-04       -17.216584323275  <--
     1.4901e+01     1.4901e+02             2.8855e-05       -17.216584304634
     5.9605e+01     5.9605e+02             7.2357e-06       -17.216584289450

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.8864e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961908e-02 1 1  ON 1
 uu_2                -4.506552e-02 1 1  ON 2
 uu_3                -9.993798e-02 1 1  ON 3
 uu_4                -1.332600e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295232e-02 1 1  ON 7
 uu_8                 9.767394e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521165e-01 1 1  ON 10
 ud_1                 9.375382e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226007e-01 1 1  ON 14
 ud_5                -1.535798e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100848e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680162e-01 1 1  ON 20
 eO_1                -4.487196e-01 1 1  ON 21
 eO_2                -4.138430e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041805e-01 1 1  ON 24
 eO_5                 3.130153e-01 1 1  ON 25
 eO_6                 2.535802e-01 1 1  ON 26
 eO_7                 1.165985e-01 1 1  ON 27
 eO_8                 2.874811e-02 1 1  ON 28
 eO_9                 1.871804e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034587e-01 1 1  ON 31
eH1_2                -6.247532e-02 1 1  ON 32
eH1_3                -2.585370e-02 1 1  ON 33
eH1_4                 1.924874e-02 1 1  ON 34
eH1_5                 3.370848e-02 1 1  ON 35
eH1_6                 7.737328e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354191e-02 1 1  ON 38
eH1_9                 2.515171e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388843e-02 1 1  ON 42
eH2_3                -2.707297e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360841e-02 1 1  ON 45
eH2_6                 7.881412e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645171e-02 1 1  ON 48
eH2_9                 2.717103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1812
    reference variance = 0.337535
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317968836447
                                         uncertainty =       0.003231475184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317968836447
                                         uncertainty =       0.003231475184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398760199
  error estimate for blocks of size 2^( 2) =       0.000408624743
  error estimate for blocks of size 2^( 3) =       0.000417275687
  error estimate for blocks of size 2^( 4) =       0.000423556567
  error estimate for blocks of size 2^( 5) =       0.000428309945
  error estimate for blocks of size 2^( 6) =       0.000429321765
  error estimate for blocks of size 2^( 7) =       0.000430953225

      target function =                  N/A
              le_mean =     -17.216681756677
             les_mean =     296.732149944217
             stat err =       0.000428035375
             autocorr =       1.152220819830
              std dev =       0.563932081492
             le_variance =       0.318019392536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668175668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681756677       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681452187       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216681279075       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216681516280       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216682622510       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216682500072       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216682421433       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216682372198       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 3.484619e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681756677       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681672830       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216681621470       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216681686838       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216681997680       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216681958662       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216681935600       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216681932612       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 9.104999e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681756677       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681735170       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216681721689       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216681738427       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216681818243       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216681808592       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216681802388       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216681802652       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.308089e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5964e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.118629e-01 1 1  ON 0
 uu_1                 4.963134e-02 1 1  ON 1
 uu_2                -4.505305e-02 1 1  ON 2
 uu_3                -9.994756e-02 1 1  ON 3
 uu_4                -1.332693e-01 1 1  ON 4
 uu_5                -1.395439e-01 1 1  ON 5
 uu_6                -1.161321e-01 1 1  ON 6
 uu_7                -4.298041e-02 1 1  ON 7
 uu_8                 9.765368e-02 1 1  ON 8
 uu_9                 1.227642e-01 1 1  ON 9
 ud_0                 3.521615e-01 1 1  ON 10
 ud_1                 9.376832e-02 1 1  ON 11
 ud_2                -1.534868e-02 1 1  ON 12
 ud_3                -7.563152e-02 1 1  ON 13
 ud_4                -1.226019e-01 1 1  ON 14
 ud_5                -1.536169e-01 1 1  ON 15
 ud_6                -1.546714e-01 1 1  ON 16
 ud_7                -1.114435e-01 1 1  ON 17
 ud_8                 4.853990e-04 1 1  ON 18
 ud_9                 9.261410e-02 1 1  ON 19
 eO_0                -7.681021e-01 1 1  ON 20
 eO_1                -4.488107e-01 1 1  ON 21
 eO_2                -4.142471e-02 1 1  ON 22
 eO_3                 2.125457e-01 1 1  ON 23
 eO_4                 3.042557e-01 1 1  ON 24
 eO_5                 3.130792e-01 1 1  ON 25
 eO_6                 2.536080e-01 1 1  ON 26
 eO_7                 1.166333e-01 1 1  ON 27
 eO_8                 2.875369e-02 1 1  ON 28
 eO_9                 1.871907e-02 1 1  ON 29
eH1_0                -1.826648e-01 1 1  ON 30
eH1_1                -1.034500e-01 1 1  ON 31
eH1_2                -6.248816e-02 1 1  ON 32
eH1_3                -2.586219e-02 1 1  ON 33
eH1_4                 1.928344e-02 1 1  ON 34
eH1_5                 3.368282e-02 1 1  ON 35
eH1_6                 7.737466e-02 1 1  ON 36
eH1_7                 1.098455e-01 1 1  ON 37
eH1_8                 9.356326e-02 1 1  ON 38
eH1_9                 2.515826e-02 1 1  ON 39
eH2_0                -1.840920e-01 1 1  ON 40
eH2_1                -1.048689e-01 1 1  ON 41
eH2_2                -6.389277e-02 1 1  ON 42
eH2_3                -2.704738e-02 1 1  ON 43
eH2_4                 1.820191e-02 1 1  ON 44
eH2_5                 3.358832e-02 1 1  ON 45
eH2_6                 7.880279e-02 1 1  ON 46
eH2_7                 1.133445e-01 1 1  ON 47
eH2_8                 9.646765e-02 1 1  ON 48
eH2_9                 2.717575e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2302
    reference variance = 0.16696
====================================================
  Execution time = 2.0101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2308e-01
  Total weights = 2.0000e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092074198
                                         uncertainty =       0.003785231273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323092074198
                                         uncertainty =       0.003785231273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896690
  error estimate for blocks of size 2^( 2) =       0.000411845753
  error estimate for blocks of size 2^( 3) =       0.000420337038
  error estimate for blocks of size 2^( 4) =       0.000425872363
  error estimate for blocks of size 2^( 5) =       0.000429875141
  error estimate for blocks of size 2^( 6) =       0.000432491700
  error estimate for blocks of size 2^( 7) =       0.000433771078

      target function =                  N/A
              le_mean =     -17.216351943067
             les_mean =     296.725815964291
             stat err =       0.000430502570
             autocorr =       1.147420591093
              std dev =       0.568367749132
             le_variance =       0.323041898254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323207111808
                                         uncertainty =       0.003787030462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323207111808
                                         uncertainty =       0.003787030462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401968254
  error estimate for blocks of size 2^( 2) =       0.000411914505
  error estimate for blocks of size 2^( 3) =       0.000420402047
  error estimate for blocks of size 2^( 4) =       0.000425934910
  error estimate for blocks of size 2^( 5) =       0.000429934353
  error estimate for blocks of size 2^( 6) =       0.000432549479
  error estimate for blocks of size 2^( 7) =       0.000433826789

      target function =                  N/A
              le_mean =     -17.216350623404
             les_mean =     296.725885580883
             stat err =       0.000430561383
             autocorr =       1.147325481286
              std dev =       0.568468956466
             le_variance =       0.323156954466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323161571106
                                         uncertainty =       0.003786272806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323161571106
                                         uncertainty =       0.003786272806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401939927
  error estimate for blocks of size 2^( 2) =       0.000411887293
  error estimate for blocks of size 2^( 3) =       0.000420376361
  error estimate for blocks of size 2^( 4) =       0.000425910316
  error estimate for blocks of size 2^( 5) =       0.000429911093
  error estimate for blocks of size 2^( 6) =       0.000432526814
  error estimate for blocks of size 2^( 7) =       0.000433805170

      target function =                  N/A
              le_mean =     -17.216351177180
             les_mean =     296.725859104526
             stat err =       0.000430538348
             autocorr =       1.147364429496
              std dev =       0.568428896267
             le_variance =       0.323111410111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323101269572
                                         uncertainty =       0.003785367444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323101269572
                                         uncertainty =       0.003785367444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401902411
  error estimate for blocks of size 2^( 2) =       0.000411851249
  error estimate for blocks of size 2^( 3) =       0.000420342243
  error estimate for blocks of size 2^( 4) =       0.000425877389
  error estimate for blocks of size 2^( 5) =       0.000429879903
  error estimate for blocks of size 2^( 6) =       0.000432496352
  error estimate for blocks of size 2^( 7) =       0.000433775606

      target function =                  N/A
              le_mean =     -17.216351841562
             les_mean =     296.725821666725
             stat err =       0.000430507313
             autocorr =       1.147413202933
              std dev =       0.568375840264
             le_variance =       0.323051095795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216351943067        initial  <--
     9.3132e-01     9.3132e+00             3.4846e-04       -17.216350623404
     3.7253e+00     3.7253e+01             9.1050e-05       -17.216351177180
     1.4901e+01     1.4901e+02             2.3081e-05       -17.216351841562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3249
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961908e-02 1 1  ON 1
 uu_2                -4.506552e-02 1 1  ON 2
 uu_3                -9.993798e-02 1 1  ON 3
 uu_4                -1.332600e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295232e-02 1 1  ON 7
 uu_8                 9.767394e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521165e-01 1 1  ON 10
 ud_1                 9.375382e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226007e-01 1 1  ON 14
 ud_5                -1.535798e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100848e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680162e-01 1 1  ON 20
 eO_1                -4.487196e-01 1 1  ON 21
 eO_2                -4.138430e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041805e-01 1 1  ON 24
 eO_5                 3.130153e-01 1 1  ON 25
 eO_6                 2.535802e-01 1 1  ON 26
 eO_7                 1.165985e-01 1 1  ON 27
 eO_8                 2.874811e-02 1 1  ON 28
 eO_9                 1.871804e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034587e-01 1 1  ON 31
eH1_2                -6.247532e-02 1 1  ON 32
eH1_3                -2.585370e-02 1 1  ON 33
eH1_4                 1.924874e-02 1 1  ON 34
eH1_5                 3.370848e-02 1 1  ON 35
eH1_6                 7.737328e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354191e-02 1 1  ON 38
eH1_9                 2.515171e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388843e-02 1 1  ON 42
eH2_3                -2.707297e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360841e-02 1 1  ON 45
eH2_6                 7.881412e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645171e-02 1 1  ON 48
eH2_9                 2.717103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1808
    reference variance = 0.195523
====================================================
  Execution time = 2.2415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1188e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311862280878
                                         uncertainty =       0.002676735646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311862280878
                                         uncertainty =       0.002676735646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394894894
  error estimate for blocks of size 2^( 2) =       0.000404752512
  error estimate for blocks of size 2^( 3) =       0.000413909925
  error estimate for blocks of size 2^( 4) =       0.000420579331
  error estimate for blocks of size 2^( 5) =       0.000424499576
  error estimate for blocks of size 2^( 6) =       0.000426255253
  error estimate for blocks of size 2^( 7) =       0.000427115980

      target function =                  N/A
              le_mean =     -17.216835752685
             les_mean =     296.731317133684
             stat err =       0.000424612535
             autocorr =       1.156172365121
              std dev =       0.558465714886
             le_variance =       0.311883954703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683575268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835752685       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835799598       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835799747       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835821320       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835815116       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835802890       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835827638       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 4.572613e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835752685       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835764667       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835764685       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835770091       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835768258       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835765225       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835771389       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.150499e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835752685       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835755697       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835755700       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835757052       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835756576       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835755819       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835757359       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.881012e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8052e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.118287e-01 1 1  ON 0
 uu_1                 4.961977e-02 1 1  ON 1
 uu_2                -4.506548e-02 1 1  ON 2
 uu_3                -9.993833e-02 1 1  ON 3
 uu_4                -1.332604e-01 1 1  ON 4
 uu_5                -1.395339e-01 1 1  ON 5
 uu_6                -1.161254e-01 1 1  ON 6
 uu_7                -4.295474e-02 1 1  ON 7
 uu_8                 9.767222e-02 1 1  ON 8
 uu_9                 1.227546e-01 1 1  ON 9
 ud_0                 3.521182e-01 1 1  ON 10
 ud_1                 9.375643e-02 1 1  ON 11
 ud_2                -1.536495e-02 1 1  ON 12
 ud_3                -7.563766e-02 1 1  ON 13
 ud_4                -1.226012e-01 1 1  ON 14
 ud_5                -1.535812e-01 1 1  ON 15
 ud_6                -1.546470e-01 1 1  ON 16
 ud_7                -1.114381e-01 1 1  ON 17
 ud_8                 5.062936e-04 1 1  ON 18
 ud_9                 9.261336e-02 1 1  ON 19
 eO_0                -7.680277e-01 1 1  ON 20
 eO_1                -4.487249e-01 1 1  ON 21
 eO_2                -4.139049e-02 1 1  ON 22
 eO_3                 2.125385e-01 1 1  ON 23
 eO_4                 3.041895e-01 1 1  ON 24
 eO_5                 3.130210e-01 1 1  ON 25
 eO_6                 2.535828e-01 1 1  ON 26
 eO_7                 1.166016e-01 1 1  ON 27
 eO_8                 2.874873e-02 1 1  ON 28
 eO_9                 1.871838e-02 1 1  ON 29
eH1_0                -1.826308e-01 1 1  ON 30
eH1_1                -1.034596e-01 1 1  ON 31
eH1_2                -6.247594e-02 1 1  ON 32
eH1_3                -2.585021e-02 1 1  ON 33
eH1_4                 1.924790e-02 1 1  ON 34
eH1_5                 3.370792e-02 1 1  ON 35
eH1_6                 7.737215e-02 1 1  ON 36
eH1_7                 1.098372e-01 1 1  ON 37
eH1_8                 9.354346e-02 1 1  ON 38
eH1_9                 2.515233e-02 1 1  ON 39
eH2_0                -1.841228e-01 1 1  ON 40
eH2_1                -1.048591e-01 1 1  ON 41
eH2_2                -6.388749e-02 1 1  ON 42
eH2_3                -2.707525e-02 1 1  ON 43
eH2_4                 1.823051e-02 1 1  ON 44
eH2_5                 3.360601e-02 1 1  ON 45
eH2_6                 7.881455e-02 1 1  ON 46
eH2_7                 1.133490e-01 1 1  ON 47
eH2_8                 9.645344e-02 1 1  ON 48
eH2_9                 2.717169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.234789
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1909e-01
  Total weights = 2.0000e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319211736946
                                         uncertainty =       0.005101398439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319211736946
                                         uncertainty =       0.005101398439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399430469
  error estimate for blocks of size 2^( 2) =       0.000408989831
  error estimate for blocks of size 2^( 3) =       0.000417095861
  error estimate for blocks of size 2^( 4) =       0.000424519535
  error estimate for blocks of size 2^( 5) =       0.000427923016
  error estimate for blocks of size 2^( 6) =       0.000429381308
  error estimate for blocks of size 2^( 7) =       0.000429678540

      target function =                  N/A
              le_mean =     -17.216954593383
             les_mean =     296.742614710656
             stat err =       0.000427875600
             autocorr =       1.147499910317
              std dev =       0.564879986897
             le_variance =       0.319089399597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319219628113
                                         uncertainty =       0.005101603843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319219628113
                                         uncertainty =       0.005101603843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435403
  error estimate for blocks of size 2^( 2) =       0.000408994535
  error estimate for blocks of size 2^( 3) =       0.000417100281
  error estimate for blocks of size 2^( 4) =       0.000424523748
  error estimate for blocks of size 2^( 5) =       0.000427927240
  error estimate for blocks of size 2^( 6) =       0.000429385832
  error estimate for blocks of size 2^( 7) =       0.000429683628

      target function =                  N/A
              le_mean =     -17.216954555859
             les_mean =     296.742621302029
             stat err =       0.000427880112
             autocorr =       1.147495763419
              std dev =       0.564886964851
             le_variance =       0.319097283059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319215689614
                                         uncertainty =       0.005101502252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319215689614
                                         uncertainty =       0.005101502252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399432941
  error estimate for blocks of size 2^( 2) =       0.000408992186
  error estimate for blocks of size 2^( 3) =       0.000417098073
  error estimate for blocks of size 2^( 4) =       0.000424521643
  error estimate for blocks of size 2^( 5) =       0.000427925131
  error estimate for blocks of size 2^( 6) =       0.000429383576
  error estimate for blocks of size 2^( 7) =       0.000429681100

      target function =                  N/A
              le_mean =     -17.216954574233
             les_mean =     296.742618000013
             stat err =       0.000427877862
             autocorr =       1.147497847226
              std dev =       0.564883482092
             le_variance =       0.319093348341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319212231037
                                         uncertainty =       0.005101411451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319212231037
                                         uncertainty =       0.005101411451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399430778
  error estimate for blocks of size 2^( 2) =       0.000408990125
  error estimate for blocks of size 2^( 3) =       0.000417096138
  error estimate for blocks of size 2^( 4) =       0.000424519798
  error estimate for blocks of size 2^( 5) =       0.000427923280
  error estimate for blocks of size 2^( 6) =       0.000429381591
  error estimate for blocks of size 2^( 7) =       0.000429678860

      target function =                  N/A
              le_mean =     -17.216954590957
             les_mean =     296.742615120711
             stat err =       0.000427875882
             autocorr =       1.147499652732
              std dev =       0.564880423802
             le_variance =       0.319089893195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216954593383        initial  <--
     9.3132e+00     9.3132e+01             4.5726e-05       -17.216954555859
     3.7253e+01     3.7253e+02             1.1505e-05       -17.216954574233
     1.4901e+02     1.4901e+03             2.8810e-06       -17.216954590957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2294
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961908e-02 1 1  ON 1
 uu_2                -4.506552e-02 1 1  ON 2
 uu_3                -9.993798e-02 1 1  ON 3
 uu_4                -1.332600e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295232e-02 1 1  ON 7
 uu_8                 9.767394e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521165e-01 1 1  ON 10
 ud_1                 9.375382e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226007e-01 1 1  ON 14
 ud_5                -1.535798e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100848e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680162e-01 1 1  ON 20
 eO_1                -4.487196e-01 1 1  ON 21
 eO_2                -4.138430e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041805e-01 1 1  ON 24
 eO_5                 3.130153e-01 1 1  ON 25
 eO_6                 2.535802e-01 1 1  ON 26
 eO_7                 1.165985e-01 1 1  ON 27
 eO_8                 2.874811e-02 1 1  ON 28
 eO_9                 1.871804e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034587e-01 1 1  ON 31
eH1_2                -6.247532e-02 1 1  ON 32
eH1_3                -2.585370e-02 1 1  ON 33
eH1_4                 1.924874e-02 1 1  ON 34
eH1_5                 3.370848e-02 1 1  ON 35
eH1_6                 7.737328e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354191e-02 1 1  ON 38
eH1_9                 2.515171e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388843e-02 1 1  ON 42
eH2_3                -2.707297e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360841e-02 1 1  ON 45
eH2_6                 7.881412e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645171e-02 1 1  ON 48
eH2_9                 2.717103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1909
    reference variance = 0.197721
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316019841826
                                         uncertainty =       0.003389059705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316019841826
                                         uncertainty =       0.003389059705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397534153
  error estimate for blocks of size 2^( 2) =       0.000407459188
  error estimate for blocks of size 2^( 3) =       0.000415690158
  error estimate for blocks of size 2^( 4) =       0.000421726075
  error estimate for blocks of size 2^( 5) =       0.000425936522
  error estimate for blocks of size 2^( 6) =       0.000428383999
  error estimate for blocks of size 2^( 7) =       0.000430258607

      target function =                  N/A
              le_mean =     -17.217383908837
             les_mean =     296.754375311670
             stat err =       0.000426576301
             autocorr =       1.151448600751
              std dev =       0.562198190520
             le_variance =       0.316066805423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738390884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217383908837       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217383910283       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217383896697       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217383898344       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217383902516       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217383908659       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217383908575       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 4.758379e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217383908837       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217383909199       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217383905794       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217383906199       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217383907243       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217383908776       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217383908760       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 1.190543e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217383908837       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217383908928       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217383908076       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217383908177       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217383908437       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217383908816       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217383908817       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.976953e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5731e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961907e-02 1 1  ON 1
 uu_2                -4.506516e-02 1 1  ON 2
 uu_3                -9.993811e-02 1 1  ON 3
 uu_4                -1.332599e-01 1 1  ON 4
 uu_5                -1.395321e-01 1 1  ON 5
 uu_6                -1.161235e-01 1 1  ON 6
 uu_7                -4.295262e-02 1 1  ON 7
 uu_8                 9.767363e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521164e-01 1 1  ON 10
 ud_1                 9.375416e-02 1 1  ON 11
 ud_2                -1.536521e-02 1 1  ON 12
 ud_3                -7.563904e-02 1 1  ON 13
 ud_4                -1.226004e-01 1 1  ON 14
 ud_5                -1.535801e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114366e-01 1 1  ON 17
 ud_8                 5.096789e-04 1 1  ON 18
 ud_9                 9.261346e-02 1 1  ON 19
 eO_0                -7.680174e-01 1 1  ON 20
 eO_1                -4.487203e-01 1 1  ON 21
 eO_2                -4.138461e-02 1 1  ON 22
 eO_3                 2.125372e-01 1 1  ON 23
 eO_4                 3.041814e-01 1 1  ON 24
 eO_5                 3.130159e-01 1 1  ON 25
 eO_6                 2.535805e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871806e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034589e-01 1 1  ON 31
eH1_2                -6.247530e-02 1 1  ON 32
eH1_3                -2.585356e-02 1 1  ON 33
eH1_4                 1.924863e-02 1 1  ON 34
eH1_5                 3.370841e-02 1 1  ON 35
eH1_6                 7.737336e-02 1 1  ON 36
eH1_7                 1.098387e-01 1 1  ON 37
eH1_8                 9.354201e-02 1 1  ON 38
eH1_9                 2.515174e-02 1 1  ON 39
eH2_0                -1.841245e-01 1 1  ON 40
eH2_1                -1.048604e-01 1 1  ON 41
eH2_2                -6.388839e-02 1 1  ON 42
eH2_3                -2.707274e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360844e-02 1 1  ON 45
eH2_6                 7.881409e-02 1 1  ON 46
eH2_7                 1.133490e-01 1 1  ON 47
eH2_8                 9.645186e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.16431
====================================================
  Execution time = 1.9934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315300197518
                                         uncertainty =       0.003312966483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315300197518
                                         uncertainty =       0.003312966483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397021380
  error estimate for blocks of size 2^( 2) =       0.000406617863
  error estimate for blocks of size 2^( 3) =       0.000415167451
  error estimate for blocks of size 2^( 4) =       0.000421322997
  error estimate for blocks of size 2^( 5) =       0.000424334501
  error estimate for blocks of size 2^( 6) =       0.000426802581
  error estimate for blocks of size 2^( 7) =       0.000426837984

      target function =                  N/A
              le_mean =     -17.217554085449
             les_mean =     296.759420480454
             stat err =       0.000424824516
             autocorr =       1.144962736041
              std dev =       0.561473020461
             le_variance =       0.315251952705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315298896229
                                         uncertainty =       0.003312938429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315298896229
                                         uncertainty =       0.003312938429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397020561
  error estimate for blocks of size 2^( 2) =       0.000406617064
  error estimate for blocks of size 2^( 3) =       0.000415166665
  error estimate for blocks of size 2^( 4) =       0.000421322228
  error estimate for blocks of size 2^( 5) =       0.000424333736
  error estimate for blocks of size 2^( 6) =       0.000426801830
  error estimate for blocks of size 2^( 7) =       0.000426837231

      target function =                  N/A
              le_mean =     -17.217554082825
             les_mean =     296.759419088665
             stat err =       0.000424823756
             autocorr =       1.144963369143
              std dev =       0.561471861512
             le_variance =       0.315250651270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315299543219
                                         uncertainty =       0.003312952377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315299543219
                                         uncertainty =       0.003312952377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397020968
  error estimate for blocks of size 2^( 2) =       0.000406617461
  error estimate for blocks of size 2^( 3) =       0.000415167056
  error estimate for blocks of size 2^( 4) =       0.000421322610
  error estimate for blocks of size 2^( 5) =       0.000424334117
  error estimate for blocks of size 2^( 6) =       0.000426802203
  error estimate for blocks of size 2^( 7) =       0.000426837606

      target function =                  N/A
              le_mean =     -17.217554084122
             les_mean =     296.759419780379
             stat err =       0.000424824134
             autocorr =       1.144963054518
              std dev =       0.561472437732
             le_variance =       0.315251298332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315300115613
                                         uncertainty =       0.003312964717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315300115613
                                         uncertainty =       0.003312964717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397021329
  error estimate for blocks of size 2^( 2) =       0.000406617812
  error estimate for blocks of size 2^( 3) =       0.000415167401
  error estimate for blocks of size 2^( 4) =       0.000421322948
  error estimate for blocks of size 2^( 5) =       0.000424334453
  error estimate for blocks of size 2^( 6) =       0.000426802533
  error estimate for blocks of size 2^( 7) =       0.000426837937

      target function =                  N/A
              le_mean =     -17.217554085283
             les_mean =     296.759420392796
             stat err =       0.000424824468
             autocorr =       1.144962775909
              std dev =       0.561472947514
             le_variance =       0.315251870790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217554085449        initial  <--
     9.3132e+01     9.3132e+02             4.7584e-06       -17.217554082825
     3.7253e+02     3.7253e+03             1.1905e-06       -17.217554084122
     1.4901e+03     1.4901e+04             2.9770e-07       -17.217554085283

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1727
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961908e-02 1 1  ON 1
 uu_2                -4.506552e-02 1 1  ON 2
 uu_3                -9.993798e-02 1 1  ON 3
 uu_4                -1.332600e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295232e-02 1 1  ON 7
 uu_8                 9.767394e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521165e-01 1 1  ON 10
 ud_1                 9.375382e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226007e-01 1 1  ON 14
 ud_5                -1.535798e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100848e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680162e-01 1 1  ON 20
 eO_1                -4.487196e-01 1 1  ON 21
 eO_2                -4.138430e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041805e-01 1 1  ON 24
 eO_5                 3.130153e-01 1 1  ON 25
 eO_6                 2.535802e-01 1 1  ON 26
 eO_7                 1.165985e-01 1 1  ON 27
 eO_8                 2.874811e-02 1 1  ON 28
 eO_9                 1.871804e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034587e-01 1 1  ON 31
eH1_2                -6.247532e-02 1 1  ON 32
eH1_3                -2.585370e-02 1 1  ON 33
eH1_4                 1.924874e-02 1 1  ON 34
eH1_5                 3.370848e-02 1 1  ON 35
eH1_6                 7.737328e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354191e-02 1 1  ON 38
eH1_9                 2.515171e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388843e-02 1 1  ON 42
eH2_3                -2.707297e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360841e-02 1 1  ON 45
eH2_6                 7.881412e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645171e-02 1 1  ON 48
eH2_9                 2.717103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1556
    reference variance = 0.158749
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2315e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322969087534
                                         uncertainty =       0.004488748457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322969087534
                                         uncertainty =       0.004488748457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401965122
  error estimate for blocks of size 2^( 2) =       0.000411360070
  error estimate for blocks of size 2^( 3) =       0.000419831240
  error estimate for blocks of size 2^( 4) =       0.000426452026
  error estimate for blocks of size 2^( 5) =       0.000431233998
  error estimate for blocks of size 2^( 6) =       0.000434614862
  error estimate for blocks of size 2^( 7) =       0.000434781335

      target function =                  N/A
              le_mean =     -17.216427930370
             les_mean =     296.728542438233
             stat err =       0.000431770555
             autocorr =       1.153796724157
              std dev =       0.568464526764
             le_variance =       0.323151918188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642793037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216427930370       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216427930212       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216427930392       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216427930508       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216427930172       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216427930437       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216427930508       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 5.216685e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216427930370       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216427930331       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216427930375       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216427930404       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216427930320       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216427930389       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216427930406       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.304264e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216427930370       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216427930360       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216427930371       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216427930378       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216427930365       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216427930378       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216427930391       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 3.260718e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5772e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961911e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993798e-02 1 1  ON 3
 uu_4                -1.332600e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295234e-02 1 1  ON 7
 uu_8                 9.767393e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521165e-01 1 1  ON 10
 ud_1                 9.375386e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226007e-01 1 1  ON 14
 ud_5                -1.535799e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100704e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680163e-01 1 1  ON 20
 eO_1                -4.487197e-01 1 1  ON 21
 eO_2                -4.138431e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041806e-01 1 1  ON 24
 eO_5                 3.130154e-01 1 1  ON 25
 eO_6                 2.535802e-01 1 1  ON 26
 eO_7                 1.165985e-01 1 1  ON 27
 eO_8                 2.874812e-02 1 1  ON 28
 eO_9                 1.871804e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034587e-01 1 1  ON 31
eH1_2                -6.247533e-02 1 1  ON 32
eH1_3                -2.585372e-02 1 1  ON 33
eH1_4                 1.924876e-02 1 1  ON 34
eH1_5                 3.370850e-02 1 1  ON 35
eH1_6                 7.737329e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354192e-02 1 1  ON 38
eH1_9                 2.515171e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388846e-02 1 1  ON 42
eH2_3                -2.707296e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360841e-02 1 1  ON 45
eH2_6                 7.881412e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645173e-02 1 1  ON 48
eH2_9                 2.717104e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.27159
====================================================
  Execution time = 1.9765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2067e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696646694
                                         uncertainty =       0.004158221625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696646694
                                         uncertainty =       0.004158221625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400418015
  error estimate for blocks of size 2^( 2) =       0.000409943497
  error estimate for blocks of size 2^( 3) =       0.000418732004
  error estimate for blocks of size 2^( 4) =       0.000424640816
  error estimate for blocks of size 2^( 5) =       0.000429220055
  error estimate for blocks of size 2^( 6) =       0.000431279963
  error estimate for blocks of size 2^( 7) =       0.000431284840

      target function =                  N/A
              le_mean =     -17.217298815228
             les_mean =     296.756047506491
             stat err =       0.000429106418
             autocorr =       1.148425438208
              std dev =       0.566276587885
             le_variance =       0.320669173987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696775685
                                         uncertainty =       0.004158223210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696775685
                                         uncertainty =       0.004158223210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400418096
  error estimate for blocks of size 2^( 2) =       0.000409943573
  error estimate for blocks of size 2^( 3) =       0.000418732074
  error estimate for blocks of size 2^( 4) =       0.000424640882
  error estimate for blocks of size 2^( 5) =       0.000429220115
  error estimate for blocks of size 2^( 6) =       0.000431280023
  error estimate for blocks of size 2^( 7) =       0.000431284895

      target function =                  N/A
              le_mean =     -17.217298815952
             les_mean =     296.756047660414
             stat err =       0.000429106479
             autocorr =       1.148425299026
              std dev =       0.566276701764
             le_variance =       0.320669302960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696711189
                                         uncertainty =       0.004158222417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696711189
                                         uncertainty =       0.004158222417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400418056
  error estimate for blocks of size 2^( 2) =       0.000409943535
  error estimate for blocks of size 2^( 3) =       0.000418732039
  error estimate for blocks of size 2^( 4) =       0.000424640849
  error estimate for blocks of size 2^( 5) =       0.000429220085
  error estimate for blocks of size 2^( 6) =       0.000431279993
  error estimate for blocks of size 2^( 7) =       0.000431284867

      target function =                  N/A
              le_mean =     -17.217298815590
             les_mean =     296.756047583456
             stat err =       0.000429106449
             autocorr =       1.148425368603
              std dev =       0.566276644824
             le_variance =       0.320669238473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696654756
                                         uncertainty =       0.004158221724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696654756
                                         uncertainty =       0.004158221724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400418020
  error estimate for blocks of size 2^( 2) =       0.000409943502
  error estimate for blocks of size 2^( 3) =       0.000418732009
  error estimate for blocks of size 2^( 4) =       0.000424640821
  error estimate for blocks of size 2^( 5) =       0.000429220058
  error estimate for blocks of size 2^( 6) =       0.000431279967
  error estimate for blocks of size 2^( 7) =       0.000431284843

      target function =                  N/A
              le_mean =     -17.217298815273
             les_mean =     296.756047516112
             stat err =       0.000429106422
             autocorr =       1.148425429502
              std dev =       0.566276595003
             le_variance =       0.320669182048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217298815228        initial
     9.3132e+02     9.3132e+03             5.2167e-07       -17.217298815952  <--
     3.7253e+03     3.7253e+04             1.3043e-07       -17.217298815590
     1.4901e+04     1.4901e+05             3.2607e-08       -17.217298815273

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 2.8927e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961919e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295240e-02 1 1  ON 7
 uu_8                 9.767389e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100272e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487199e-01 1 1  ON 21
 eO_2                -4.138435e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041808e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881411e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1801
    reference variance = 0.157924
====================================================
  Execution time = 2.0325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084951750
                                         uncertainty =       0.003811795164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084951750
                                         uncertainty =       0.003811795164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397497934
  error estimate for blocks of size 2^( 2) =       0.000407089180
  error estimate for blocks of size 2^( 3) =       0.000415813719
  error estimate for blocks of size 2^( 4) =       0.000422476686
  error estimate for blocks of size 2^( 5) =       0.000426542522
  error estimate for blocks of size 2^( 6) =       0.000428874906
  error estimate for blocks of size 2^( 7) =       0.000432224577

      target function =                  N/A
              le_mean =     -17.217325731628
             les_mean =     296.752314406521
             stat err =       0.000427529673
             autocorr =       1.156811968476
              std dev =       0.562146969718
             le_variance =       0.316009215563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721732573163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217325731628       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217325734988       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217325735027       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217325734717       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217325739767       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217325738880       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217325739002       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 2.222360e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217325731628       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217325732468       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217325732478       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217325732399       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217325733661       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217325733441       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217325733471       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 5.558520e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217325731628       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217325731838       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217325731840       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217325731820       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217325732136       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217325732081       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217325732086       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.389794e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.118250e-01 1 1  ON 0
 uu_1                 4.961931e-02 1 1  ON 1
 uu_2                -4.506547e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161235e-01 1 1  ON 6
 uu_7                -4.295252e-02 1 1  ON 7
 uu_8                 9.767382e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521164e-01 1 1  ON 10
 ud_1                 9.375412e-02 1 1  ON 11
 ud_2                -1.536533e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114364e-01 1 1  ON 17
 ud_8                 5.099351e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680172e-01 1 1  ON 20
 eO_1                -4.487201e-01 1 1  ON 21
 eO_2                -4.138449e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041812e-01 1 1  ON 24
 eO_5                 3.130159e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165988e-01 1 1  ON 27
 eO_8                 2.874816e-02 1 1  ON 28
 eO_9                 1.871806e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034589e-01 1 1  ON 31
eH1_2                -6.247545e-02 1 1  ON 32
eH1_3                -2.585369e-02 1 1  ON 33
eH1_4                 1.924870e-02 1 1  ON 34
eH1_5                 3.370863e-02 1 1  ON 35
eH1_6                 7.737338e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354204e-02 1 1  ON 38
eH1_9                 2.515175e-02 1 1  ON 39
eH2_0                -1.841242e-01 1 1  ON 40
eH2_1                -1.048606e-01 1 1  ON 41
eH2_2                -6.388850e-02 1 1  ON 42
eH2_3                -2.707284e-02 1 1  ON 43
eH2_4                 1.823255e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881416e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645186e-02 1 1  ON 48
eH2_9                 2.717108e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.186726
====================================================
  Execution time = 1.9794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2345e-01
  Total weights = 2.0000e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455489623
                                         uncertainty =       0.007484009517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455489623
                                         uncertainty =       0.007484009517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151938
  error estimate for blocks of size 2^( 2) =       0.000411549539
  error estimate for blocks of size 2^( 3) =       0.000420546942
  error estimate for blocks of size 2^( 4) =       0.000426988974
  error estimate for blocks of size 2^( 5) =       0.000429740950
  error estimate for blocks of size 2^( 6) =       0.000431704600
  error estimate for blocks of size 2^( 7) =       0.000431398590

      target function =                  N/A
              le_mean =     -17.216168797416
             les_mean =     296.719920262287
             stat err =       0.000429958279
             autocorr =       1.143068609919
              std dev =       0.568728725220
             le_variance =       0.323452362891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323454737684
                                         uncertainty =       0.007484016741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323454737684
                                         uncertainty =       0.007484016741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151471
  error estimate for blocks of size 2^( 2) =       0.000411549084
  error estimate for blocks of size 2^( 3) =       0.000420546498
  error estimate for blocks of size 2^( 4) =       0.000426988537
  error estimate for blocks of size 2^( 5) =       0.000429740532
  error estimate for blocks of size 2^( 6) =       0.000431704197
  error estimate for blocks of size 2^( 7) =       0.000431398208

      target function =                  N/A
              le_mean =     -17.216168796260
             les_mean =     296.719919470189
             stat err =       0.000429957868
             autocorr =       1.143069086439
              std dev =       0.568728063848
             le_variance =       0.323451610608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455112965
                                         uncertainty =       0.007484013131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455112965
                                         uncertainty =       0.007484013131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151704
  error estimate for blocks of size 2^( 2) =       0.000411549311
  error estimate for blocks of size 2^( 3) =       0.000420546719
  error estimate for blocks of size 2^( 4) =       0.000426988755
  error estimate for blocks of size 2^( 5) =       0.000429740741
  error estimate for blocks of size 2^( 6) =       0.000431704398
  error estimate for blocks of size 2^( 7) =       0.000431398399

      target function =                  N/A
              le_mean =     -17.216168796836
             les_mean =     296.719919865479
             stat err =       0.000429958073
             autocorr =       1.143068848644
              std dev =       0.568728393929
             le_variance =       0.323451986061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455442519
                                         uncertainty =       0.007484009969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323455442519
                                         uncertainty =       0.007484009969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151909
  error estimate for blocks of size 2^( 2) =       0.000411549511
  error estimate for blocks of size 2^( 3) =       0.000420546914
  error estimate for blocks of size 2^( 4) =       0.000426988946
  error estimate for blocks of size 2^( 5) =       0.000429740924
  error estimate for blocks of size 2^( 6) =       0.000431704575
  error estimate for blocks of size 2^( 7) =       0.000431398566

      target function =                  N/A
              le_mean =     -17.216168797343
             les_mean =     296.719920212658
             stat err =       0.000429958253
             autocorr =       1.143068639772
              std dev =       0.568728683789
             le_variance =       0.323452315765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216168797416        initial  <--
     2.3283e+02     2.3283e+03             2.2224e-06       -17.216168796260
     9.3132e+02     9.3132e+03             5.5585e-07       -17.216168796836
     3.7253e+03     3.7253e+04             1.3898e-07       -17.216168797343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0184
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961919e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295240e-02 1 1  ON 7
 uu_8                 9.767389e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100272e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487199e-01 1 1  ON 21
 eO_2                -4.138435e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041808e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881411e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.299975
====================================================
  Execution time = 2.0372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2153e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321523143102
                                         uncertainty =       0.005532602687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321523143102
                                         uncertainty =       0.005532602687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400958028
  error estimate for blocks of size 2^( 2) =       0.000410578602
  error estimate for blocks of size 2^( 3) =       0.000419614276
  error estimate for blocks of size 2^( 4) =       0.000426666498
  error estimate for blocks of size 2^( 5) =       0.000430687291
  error estimate for blocks of size 2^( 6) =       0.000433549286
  error estimate for blocks of size 2^( 7) =       0.000432425667

      target function =                  N/A
              le_mean =     -17.217166434154
             les_mean =     296.752354541033
             stat err =       0.000430832186
             autocorr =       1.154565175172
              std dev =       0.567040281141
             le_variance =       0.321534680436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716643415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166434154       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166434393       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166434195       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166434150       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166434282       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166434388       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166434378       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.511364e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166434154       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166434214       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166434164       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166434155       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166434187       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166434211       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166434205       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.778440e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166434154       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166434169       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217166434157       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217166434154       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217166434176       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217166434179       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217166434181       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 9.446120e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5825e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961919e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295241e-02 1 1  ON 7
 uu_8                 9.767388e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100155e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138438e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247538e-02 1 1  ON 32
eH1_3                -2.585377e-02 1 1  ON 33
eH1_4                 1.924880e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360838e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1255
    reference variance = 0.240551
====================================================
  Execution time = 1.9982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1129e-01
  Total weights = 2.0000e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133674225
                                         uncertainty =       0.002186270317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133674225
                                         uncertainty =       0.002186270317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394520482
  error estimate for blocks of size 2^( 2) =       0.000404215875
  error estimate for blocks of size 2^( 3) =       0.000412313793
  error estimate for blocks of size 2^( 4) =       0.000417926587
  error estimate for blocks of size 2^( 5) =       0.000421609127
  error estimate for blocks of size 2^( 6) =       0.000423370187
  error estimate for blocks of size 2^( 7) =       0.000421363339

      target function =                  N/A
              le_mean =     -17.216422099327
             les_mean =     296.716482567952
             stat err =       0.000421067310
             autocorr =       1.139105480287
              std dev =       0.557936216261
             le_variance =       0.311292821416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133689323
                                         uncertainty =       0.002186270405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133689323
                                         uncertainty =       0.002186270405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394520492
  error estimate for blocks of size 2^( 2) =       0.000404215885
  error estimate for blocks of size 2^( 3) =       0.000412313803
  error estimate for blocks of size 2^( 4) =       0.000417926596
  error estimate for blocks of size 2^( 5) =       0.000421609135
  error estimate for blocks of size 2^( 6) =       0.000423370194
  error estimate for blocks of size 2^( 7) =       0.000421363345

      target function =                  N/A
              le_mean =     -17.216422098887
             les_mean =     296.716482567912
             stat err =       0.000421067317
             autocorr =       1.139105466281
              std dev =       0.557936229794
             le_variance =       0.311292836517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133681774
                                         uncertainty =       0.002186270361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133681774
                                         uncertainty =       0.002186270361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394520487
  error estimate for blocks of size 2^( 2) =       0.000404215880
  error estimate for blocks of size 2^( 3) =       0.000412313798
  error estimate for blocks of size 2^( 4) =       0.000417926592
  error estimate for blocks of size 2^( 5) =       0.000421609131
  error estimate for blocks of size 2^( 6) =       0.000423370190
  error estimate for blocks of size 2^( 7) =       0.000421363342

      target function =                  N/A
              le_mean =     -17.216422099107
             les_mean =     296.716482567930
             stat err =       0.000421067314
             autocorr =       1.139105473272
              std dev =       0.557936223028
             le_variance =       0.311292828966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133675169
                                         uncertainty =       0.002186270323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311133675169
                                         uncertainty =       0.002186270323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394520483
  error estimate for blocks of size 2^( 2) =       0.000404215876
  error estimate for blocks of size 2^( 3) =       0.000412313793
  error estimate for blocks of size 2^( 4) =       0.000417926588
  error estimate for blocks of size 2^( 5) =       0.000421609127
  error estimate for blocks of size 2^( 6) =       0.000423370187
  error estimate for blocks of size 2^( 7) =       0.000421363339

      target function =                  N/A
              le_mean =     -17.216422099299
             les_mean =     296.716482567949
             stat err =       0.000421067310
             autocorr =       1.139105479407
              std dev =       0.557936217107
             le_variance =       0.311292822360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216422099327        initial  <--
     2.3283e+03     2.3283e+04             1.5114e-07       -17.216422098887
     9.3132e+03     9.3132e+04             3.7784e-08       -17.216422099107
     3.7253e+04     3.7253e+05             9.4461e-09       -17.216422099299

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2043
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961919e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295240e-02 1 1  ON 7
 uu_8                 9.767389e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100272e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487199e-01 1 1  ON 21
 eO_2                -4.138435e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041808e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881411e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1599
    reference variance = 0.366604
====================================================
  Execution time = 2.0246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314103182478
                                         uncertainty =       0.004270486585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314103182478
                                         uncertainty =       0.004270486585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396291609
  error estimate for blocks of size 2^( 2) =       0.000406281448
  error estimate for blocks of size 2^( 3) =       0.000415287760
  error estimate for blocks of size 2^( 4) =       0.000422383504
  error estimate for blocks of size 2^( 5) =       0.000425997363
  error estimate for blocks of size 2^( 6) =       0.000427327413
  error estimate for blocks of size 2^( 7) =       0.000427556805

      target function =                  N/A
              le_mean =     -17.216362140573
             les_mean =     296.717219276511
             stat err =       0.000425816271
             autocorr =       1.154555335752
              std dev =       0.560440967621
             le_variance =       0.314094078188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636214057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216362140573       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216362140567       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216362140513       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216362140513       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216362140519       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216362140522       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216362140524       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.639416e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216362140573       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216362140572       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216362140558       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216362140558       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216362140559       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216362140507       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216362140133       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 4.098560e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216362140573       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216362140573       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216362140570       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216362140558       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216362140696       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216362140570       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216362140620       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.024641e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8479e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961919e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295240e-02 1 1  ON 7
 uu_8                 9.767389e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563917e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100256e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487199e-01 1 1  ON 21
 eO_2                -4.138436e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041808e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881411e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.147869
====================================================
  Execution time = 1.9845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1769e-01
  Total weights = 2.0000e+06
  Execution time = 1.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733247231
                                         uncertainty =       0.003633257089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733247231
                                         uncertainty =       0.003633257089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398554208
  error estimate for blocks of size 2^( 2) =       0.000408147330
  error estimate for blocks of size 2^( 3) =       0.000417213636
  error estimate for blocks of size 2^( 4) =       0.000423729838
  error estimate for blocks of size 2^( 5) =       0.000427815613
  error estimate for blocks of size 2^( 6) =       0.000430933727
  error estimate for blocks of size 2^( 7) =       0.000431668238

      target function =                  N/A
              le_mean =     -17.216837108795
             les_mean =     296.737170785778
             stat err =       0.000428536854
             autocorr =       1.156116382471
              std dev =       0.563640766646
             le_variance =       0.317690913826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733250869
                                         uncertainty =       0.003633257128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733250869
                                         uncertainty =       0.003633257128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398554211
  error estimate for blocks of size 2^( 2) =       0.000408147332
  error estimate for blocks of size 2^( 3) =       0.000417213638
  error estimate for blocks of size 2^( 4) =       0.000423729840
  error estimate for blocks of size 2^( 5) =       0.000427815614
  error estimate for blocks of size 2^( 6) =       0.000430933729
  error estimate for blocks of size 2^( 7) =       0.000431668239

      target function =                  N/A
              le_mean =     -17.216837108874
             les_mean =     296.737170792106
             stat err =       0.000428536856
             autocorr =       1.156116379085
              std dev =       0.563640769866
             le_variance =       0.317690917455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733249050
                                         uncertainty =       0.003633257108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733249050
                                         uncertainty =       0.003633257108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398554209
  error estimate for blocks of size 2^( 2) =       0.000408147331
  error estimate for blocks of size 2^( 3) =       0.000417213637
  error estimate for blocks of size 2^( 4) =       0.000423729839
  error estimate for blocks of size 2^( 5) =       0.000427815613
  error estimate for blocks of size 2^( 6) =       0.000430933728
  error estimate for blocks of size 2^( 7) =       0.000431668238

      target function =                  N/A
              le_mean =     -17.216837108835
             les_mean =     296.737170788942
             stat err =       0.000428536855
             autocorr =       1.156116380770
              std dev =       0.563640768256
             le_variance =       0.317690915640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733247458
                                         uncertainty =       0.003633257091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317733247458
                                         uncertainty =       0.003633257091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398554208
  error estimate for blocks of size 2^( 2) =       0.000408147330
  error estimate for blocks of size 2^( 3) =       0.000417213636
  error estimate for blocks of size 2^( 4) =       0.000423729838
  error estimate for blocks of size 2^( 5) =       0.000427815613
  error estimate for blocks of size 2^( 6) =       0.000430933727
  error estimate for blocks of size 2^( 7) =       0.000431668238

      target function =                  N/A
              le_mean =     -17.216837108800
             les_mean =     296.737170786173
             stat err =       0.000428536854
             autocorr =       1.156116382263
              std dev =       0.563640766848
             le_variance =       0.317690914052


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216837108795        initial
     2.3283e+04     2.3283e+05             1.6394e-08       -17.216837108874  <--
     9.3132e+04     9.3132e+05             4.0986e-09       -17.216837108835
     3.7253e+05     3.7253e+06             1.0246e-09       -17.216837108800

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9065e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961920e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295240e-02 1 1  ON 7
 uu_8                 9.767388e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100208e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487199e-01 1 1  ON 21
 eO_2                -4.138436e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874813e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707292e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360839e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1346
    reference variance = 0.186109
====================================================
  Execution time = 2.0040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1889e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319011066749
                                         uncertainty =       0.004782648541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319011066749
                                         uncertainty =       0.004782648541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399303812
  error estimate for blocks of size 2^( 2) =       0.000409106425
  error estimate for blocks of size 2^( 3) =       0.000417311949
  error estimate for blocks of size 2^( 4) =       0.000423803403
  error estimate for blocks of size 2^( 5) =       0.000428070310
  error estimate for blocks of size 2^( 6) =       0.000429634889
  error estimate for blocks of size 2^( 7) =       0.000430642202

      target function =                  N/A
              le_mean =     -17.216312154513
             les_mean =     296.720291110349
             stat err =       0.000428037701
             autocorr =       1.149098170894
              std dev =       0.564700866097
             le_variance =       0.318887068170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631215451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312154513       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216312154706       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312154824       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312154984       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312155053       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216312155016       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312154999       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 6.419708e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312154513       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216312154561       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312154591       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312154631       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312154651       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216312154654       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312154634       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.604929e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216312154513       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216312154525       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216312154532       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216312154542       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216312154513       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216312154575       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216312154526       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 4.012323e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5499e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961920e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295241e-02 1 1  ON 7
 uu_8                 9.767388e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375397e-02 1 1  ON 11
 ud_2                -1.536538e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100158e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680167e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138436e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247537e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354197e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707293e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360838e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645181e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.146
    reference variance = 1.42823
====================================================
  Execution time = 1.9819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1918e-01
  Total weights = 2.0000e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194350079
                                         uncertainty =       0.004709973758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194350079
                                         uncertainty =       0.004709973758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399488157
  error estimate for blocks of size 2^( 2) =       0.000409348203
  error estimate for blocks of size 2^( 3) =       0.000418443221
  error estimate for blocks of size 2^( 4) =       0.000425078075
  error estimate for blocks of size 2^( 5) =       0.000429590962
  error estimate for blocks of size 2^( 6) =       0.000431429810
  error estimate for blocks of size 2^( 7) =       0.000432861902

      target function =                  N/A
              le_mean =     -17.217496643777
             les_mean =     296.761372094531
             stat err =       0.000429740187
             autocorr =       1.157188525814
              std dev =       0.564961570063
             le_variance =       0.319181575649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194365150
                                         uncertainty =       0.004709974004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194365150
                                         uncertainty =       0.004709974004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399488167
  error estimate for blocks of size 2^( 2) =       0.000409348212
  error estimate for blocks of size 2^( 3) =       0.000418443230
  error estimate for blocks of size 2^( 4) =       0.000425078084
  error estimate for blocks of size 2^( 5) =       0.000429590969
  error estimate for blocks of size 2^( 6) =       0.000431429817
  error estimate for blocks of size 2^( 7) =       0.000432861908

      target function =                  N/A
              le_mean =     -17.217496643885
             les_mean =     296.761372113335
             stat err =       0.000429740195
             autocorr =       1.157188511385
              std dev =       0.564961583415
             le_variance =       0.319181590735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194357615
                                         uncertainty =       0.004709973881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194357615
                                         uncertainty =       0.004709973881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399488162
  error estimate for blocks of size 2^( 2) =       0.000409348208
  error estimate for blocks of size 2^( 3) =       0.000418443225
  error estimate for blocks of size 2^( 4) =       0.000425078079
  error estimate for blocks of size 2^( 5) =       0.000429590966
  error estimate for blocks of size 2^( 6) =       0.000431429814
  error estimate for blocks of size 2^( 7) =       0.000432861905

      target function =                  N/A
              le_mean =     -17.217496643831
             les_mean =     296.761372103933
             stat err =       0.000429740191
             autocorr =       1.157188518592
              std dev =       0.564961576739
             le_variance =       0.319181583192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194351021
                                         uncertainty =       0.004709973774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194351021
                                         uncertainty =       0.004709973774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399488158
  error estimate for blocks of size 2^( 2) =       0.000409348203
  error estimate for blocks of size 2^( 3) =       0.000418443222
  error estimate for blocks of size 2^( 4) =       0.000425078076
  error estimate for blocks of size 2^( 5) =       0.000429590962
  error estimate for blocks of size 2^( 6) =       0.000431429810
  error estimate for blocks of size 2^( 7) =       0.000432861902

      target function =                  N/A
              le_mean =     -17.217496643784
             les_mean =     296.761372095706
             stat err =       0.000429740188
             autocorr =       1.157188524910
              std dev =       0.564961570898
             le_variance =       0.319181576591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217496643777        initial
     5.8208e+03     5.8208e+04             6.4197e-08       -17.217496643885  <--
     2.3283e+04     2.3283e+05             1.6049e-08       -17.217496643831
     9.3132e+04     9.3132e+05             4.0123e-09       -17.217496643784

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9053e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100006e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1828
    reference variance = 0.288235
====================================================
  Execution time = 1.9884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317123464716
                                         uncertainty =       0.003458307050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317123464716
                                         uncertainty =       0.003458307050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398169292
  error estimate for blocks of size 2^( 2) =       0.000407531045
  error estimate for blocks of size 2^( 3) =       0.000416482327
  error estimate for blocks of size 2^( 4) =       0.000422755064
  error estimate for blocks of size 2^( 5) =       0.000427293196
  error estimate for blocks of size 2^( 6) =       0.000430098677
  error estimate for blocks of size 2^( 7) =       0.000429310222

      target function =                  N/A
              le_mean =     -17.216744662864
             les_mean =     296.733374197752
             stat err =       0.000427364290
             autocorr =       1.152022428383
              std dev =       0.563096412730
             le_variance =       0.317077570030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674466286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744662864       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744663040       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216744663396       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216744663273       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216744663217       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216744663667       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216744663680       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.856422e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744662864       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744662908       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216744662997       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216744662966       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216744662956       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216744663063       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216744663075       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 7.141156e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744662864       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744662875       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216744662897       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216744662890       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216744662881       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216744662914       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216744662911       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.785295e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5436e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993801e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295244e-02 1 1  ON 7
 uu_8                 9.767386e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375401e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563920e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099760e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138440e-02 1 1  ON 22
 eO_3                 2.125371e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585377e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737336e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354199e-02 1 1  ON 38
eH1_9                 2.515174e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360838e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645183e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2755
    reference variance = 0.168126
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2178e-01
  Total weights = 2.0000e+06
  Execution time = 1.8262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863932632
                                         uncertainty =       0.004945814800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863932632
                                         uncertainty =       0.004945814800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113117
  error estimate for blocks of size 2^( 2) =       0.000410690547
  error estimate for blocks of size 2^( 3) =       0.000419655405
  error estimate for blocks of size 2^( 4) =       0.000426442427
  error estimate for blocks of size 2^( 5) =       0.000430888084
  error estimate for blocks of size 2^( 6) =       0.000434110328
  error estimate for blocks of size 2^( 7) =       0.000435824899

      target function =                  N/A
              le_mean =     -17.216591829748
             les_mean =     296.732817536118
             stat err =       0.000431816435
             autocorr =       1.158949750286
              std dev =       0.567259609757
             le_variance =       0.321783464862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863997721
                                         uncertainty =       0.004945815256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863997721
                                         uncertainty =       0.004945815256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113157
  error estimate for blocks of size 2^( 2) =       0.000410690586
  error estimate for blocks of size 2^( 3) =       0.000419655442
  error estimate for blocks of size 2^( 4) =       0.000426442463
  error estimate for blocks of size 2^( 5) =       0.000430888119
  error estimate for blocks of size 2^( 6) =       0.000434110362
  error estimate for blocks of size 2^( 7) =       0.000435824931

      target function =                  N/A
              le_mean =     -17.216591829426
             les_mean =     296.732817590088
             stat err =       0.000431816469
             autocorr =       1.158949699619
              std dev =       0.567259667115
             le_variance =       0.321783529935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863965176
                                         uncertainty =       0.004945815028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863965176
                                         uncertainty =       0.004945815028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113137
  error estimate for blocks of size 2^( 2) =       0.000410690566
  error estimate for blocks of size 2^( 3) =       0.000419655424
  error estimate for blocks of size 2^( 4) =       0.000426442445
  error estimate for blocks of size 2^( 5) =       0.000430888101
  error estimate for blocks of size 2^( 6) =       0.000434110345
  error estimate for blocks of size 2^( 7) =       0.000435824915

      target function =                  N/A
              le_mean =     -17.216591829587
             les_mean =     296.732817563101
             stat err =       0.000431816452
             autocorr =       1.158949724955
              std dev =       0.567259638435
             le_variance =       0.321783497397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863936700
                                         uncertainty =       0.004945814828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321863936700
                                         uncertainty =       0.004945814828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113119
  error estimate for blocks of size 2^( 2) =       0.000410690549
  error estimate for blocks of size 2^( 3) =       0.000419655408
  error estimate for blocks of size 2^( 4) =       0.000426442429
  error estimate for blocks of size 2^( 5) =       0.000430888086
  error estimate for blocks of size 2^( 6) =       0.000434110330
  error estimate for blocks of size 2^( 7) =       0.000435824901

      target function =                  N/A
              le_mean =     -17.216591829728
             les_mean =     296.732817539491
             stat err =       0.000431816437
             autocorr =       1.158949747118
              std dev =       0.567259613342
             le_variance =       0.321783468929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216591829748        initial  <--
     1.4552e+03     1.4552e+04             2.8564e-07       -17.216591829426
     5.8208e+03     5.8208e+04             7.1412e-08       -17.216591829587
     2.3283e+04     2.3283e+05             1.7853e-08       -17.216591829728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4063
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100006e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.293
    reference variance = 0.507936
====================================================
  Execution time = 1.9924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317537889502
                                         uncertainty =       0.003547742589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317537889502
                                         uncertainty =       0.003547742589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398549984
  error estimate for blocks of size 2^( 2) =       0.000408054969
  error estimate for blocks of size 2^( 3) =       0.000416663278
  error estimate for blocks of size 2^( 4) =       0.000422888622
  error estimate for blocks of size 2^( 5) =       0.000426599076
  error estimate for blocks of size 2^( 6) =       0.000427852878
  error estimate for blocks of size 2^( 7) =       0.000427834695

      target function =                  N/A
              le_mean =     -17.217371225177
             les_mean =     296.755555925946
             stat err =       0.000426293818
             autocorr =       1.144069683025
              std dev =       0.563634792416
             le_variance =       0.317684179222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721737122518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217371225177       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217371225117       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217371225142       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217371225142       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217371225122       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217371225121       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217371225134       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217371225123       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 4.021474e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217371225177       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217371225162       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217371225168       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217371225169       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217371225162       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217371224702       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217371225139       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217371225174       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.005376e-08

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217371225177       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217371225174       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217371225175       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217371225179       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217371225173       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217371225265       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217371225329       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217371225279       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 2.513443e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5473e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099986e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1715
    reference variance = 0.147221
====================================================
  Execution time = 1.9828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1515e-01
  Total weights = 2.0000e+06
  Execution time = 1.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248208388
                                         uncertainty =       0.005237210457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248208388
                                         uncertainty =       0.005237210457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396960201
  error estimate for blocks of size 2^( 2) =       0.000406699171
  error estimate for blocks of size 2^( 3) =       0.000415322041
  error estimate for blocks of size 2^( 4) =       0.000421425979
  error estimate for blocks of size 2^( 5) =       0.000425198575
  error estimate for blocks of size 2^( 6) =       0.000428230456
  error estimate for blocks of size 2^( 7) =       0.000427449032

      target function =                  N/A
              le_mean =     -17.216981937871
             les_mean =     296.739621693777
             stat err =       0.000425576010
             autocorr =       1.149371287758
              std dev =       0.561386500008
             le_variance =       0.315154802391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248199816
                                         uncertainty =       0.005237209998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248199816
                                         uncertainty =       0.005237209998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396960196
  error estimate for blocks of size 2^( 2) =       0.000406699165
  error estimate for blocks of size 2^( 3) =       0.000415322036
  error estimate for blocks of size 2^( 4) =       0.000421425974
  error estimate for blocks of size 2^( 5) =       0.000425198569
  error estimate for blocks of size 2^( 6) =       0.000428230450
  error estimate for blocks of size 2^( 7) =       0.000427449027

      target function =                  N/A
              le_mean =     -17.216981937866
             les_mean =     296.739621685052
             stat err =       0.000425576005
             autocorr =       1.149371290066
              std dev =       0.561386492380
             le_variance =       0.315154793827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248204102
                                         uncertainty =       0.005237210227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248204102
                                         uncertainty =       0.005237210227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396960198
  error estimate for blocks of size 2^( 2) =       0.000406699168
  error estimate for blocks of size 2^( 3) =       0.000415322039
  error estimate for blocks of size 2^( 4) =       0.000421425976
  error estimate for blocks of size 2^( 5) =       0.000425198572
  error estimate for blocks of size 2^( 6) =       0.000428230453
  error estimate for blocks of size 2^( 7) =       0.000427449029

      target function =                  N/A
              le_mean =     -17.216981937868
             les_mean =     296.739621689414
             stat err =       0.000425576008
             autocorr =       1.149371288910
              std dev =       0.561386496194
             le_variance =       0.315154798109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248207852
                                         uncertainty =       0.005237210428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315248207852
                                         uncertainty =       0.005237210428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396960201
  error estimate for blocks of size 2^( 2) =       0.000406699170
  error estimate for blocks of size 2^( 3) =       0.000415322041
  error estimate for blocks of size 2^( 4) =       0.000421425979
  error estimate for blocks of size 2^( 5) =       0.000425198574
  error estimate for blocks of size 2^( 6) =       0.000428230455
  error estimate for blocks of size 2^( 7) =       0.000427449032

      target function =                  N/A
              le_mean =     -17.216981937870
             les_mean =     296.739621693232
             stat err =       0.000425576010
             autocorr =       1.149371287904
              std dev =       0.561386499531
             le_variance =       0.315154801856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216981937871        initial  <--
     1.4552e+04     1.4552e+05             4.0215e-08       -17.216981937866
     5.8208e+04     5.8208e+05             1.0054e-08       -17.216981937868
     2.3283e+05     2.3283e+06             2.5134e-09       -17.216981937870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0802
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100006e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1645
    reference variance = 0.208378
====================================================
  Execution time = 2.0014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324296426027
                                         uncertainty =       0.004329576953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324296426027
                                         uncertainty =       0.004329576953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402676677
  error estimate for blocks of size 2^( 2) =       0.000412222866
  error estimate for blocks of size 2^( 3) =       0.000420972947
  error estimate for blocks of size 2^( 4) =       0.000427333146
  error estimate for blocks of size 2^( 5) =       0.000431572689
  error estimate for blocks of size 2^( 6) =       0.000433985895
  error estimate for blocks of size 2^( 7) =       0.000434079406

      target function =                  N/A
              le_mean =     -17.216762820664
             les_mean =     296.741218873435
             stat err =       0.000431742784
             autocorr =       1.149574766806
              std dev =       0.569470818019
             le_variance =       0.324297012575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676282066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762820664       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762820666       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216762820662       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216762820659       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216762820715       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216762820664       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216762820688       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.145196e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762820664       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762820665       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216762820664       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216762820646       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216762820836       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216762821036       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216762820480       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 5.362988e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762820664       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762820664       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216762820664       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216762820664       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216762820615       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216762820634       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216762819449       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.340749e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5556e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.100004e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1658
    reference variance = 0.176519
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2429e-01
  Total weights = 2.0000e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869536
                                         uncertainty =       0.004138786752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869536
                                         uncertainty =       0.004138786752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402670978
  error estimate for blocks of size 2^( 2) =       0.000412513513
  error estimate for blocks of size 2^( 3) =       0.000421416303
  error estimate for blocks of size 2^( 4) =       0.000427736521
  error estimate for blocks of size 2^( 5) =       0.000431502668
  error estimate for blocks of size 2^( 6) =       0.000432401402
  error estimate for blocks of size 2^( 7) =       0.000435114936

      target function =                  N/A
              le_mean =     -17.216855000524
             les_mean =     296.744383780475
             stat err =       0.000431688882
             autocorr =       1.149320273650
              std dev =       0.569462758692
             le_variance =       0.324287833537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869130
                                         uncertainty =       0.004138786750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869130
                                         uncertainty =       0.004138786750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402670978
  error estimate for blocks of size 2^( 2) =       0.000412513512
  error estimate for blocks of size 2^( 3) =       0.000421416303
  error estimate for blocks of size 2^( 4) =       0.000427736521
  error estimate for blocks of size 2^( 5) =       0.000431502668
  error estimate for blocks of size 2^( 6) =       0.000432401402
  error estimate for blocks of size 2^( 7) =       0.000435114936

      target function =                  N/A
              le_mean =     -17.216855000529
             les_mean =     296.744383780211
             stat err =       0.000431688882
             autocorr =       1.149320273986
              std dev =       0.569462758336
             le_variance =       0.324287833131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869333
                                         uncertainty =       0.004138786751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869333
                                         uncertainty =       0.004138786751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402670978
  error estimate for blocks of size 2^( 2) =       0.000412513513
  error estimate for blocks of size 2^( 3) =       0.000421416303
  error estimate for blocks of size 2^( 4) =       0.000427736521
  error estimate for blocks of size 2^( 5) =       0.000431502668
  error estimate for blocks of size 2^( 6) =       0.000432401402
  error estimate for blocks of size 2^( 7) =       0.000435114936

      target function =                  N/A
              le_mean =     -17.216855000526
             les_mean =     296.744383780343
             stat err =       0.000431688882
             autocorr =       1.149320273818
              std dev =       0.569462758514
             le_variance =       0.324287833334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869511
                                         uncertainty =       0.004138786752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414869511
                                         uncertainty =       0.004138786752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402670978
  error estimate for blocks of size 2^( 2) =       0.000412513513
  error estimate for blocks of size 2^( 3) =       0.000421416303
  error estimate for blocks of size 2^( 4) =       0.000427736521
  error estimate for blocks of size 2^( 5) =       0.000431502668
  error estimate for blocks of size 2^( 6) =       0.000432401402
  error estimate for blocks of size 2^( 7) =       0.000435114936

      target function =                  N/A
              le_mean =     -17.216855000525
             les_mean =     296.744383780459
             stat err =       0.000431688882
             autocorr =       1.149320273666
              std dev =       0.569462758670
             le_variance =       0.324287833512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216855000524        initial
     1.4552e+05     1.4552e+06             2.1452e-09       -17.216855000529  <--
     5.8208e+05     5.8208e+06             5.3630e-10       -17.216855000526
     2.3283e+06     2.3283e+07             1.3407e-10       -17.216855000525

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.9070e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099996e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823267e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.129452
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318614521401
                                         uncertainty =       0.003605675622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318614521401
                                         uncertainty =       0.003605675622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399212099
  error estimate for blocks of size 2^( 2) =       0.000409026082
  error estimate for blocks of size 2^( 3) =       0.000417795682
  error estimate for blocks of size 2^( 4) =       0.000424412620
  error estimate for blocks of size 2^( 5) =       0.000428673910
  error estimate for blocks of size 2^( 6) =       0.000430595896
  error estimate for blocks of size 2^( 7) =       0.000432547715

      target function =                  N/A
              le_mean =     -17.216988684411
             les_mean =     296.743439799124
             stat err =       0.000429057535
             autocorr =       1.155110888799
              std dev =       0.564571164112
             le_variance =       0.318740599346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698868441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988684411       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988684417       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988684420       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988684410       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988684264       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988684424       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988684424       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 9.607796e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988684411       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988684413       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988684414       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988684435       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988684417       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988684363       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988684417       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.401953e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988684411       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988684412       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988684412       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988684414       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988684412       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988684508       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988683918       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 6.004885e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5618e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961921e-02 1 1  ON 1
 uu_2                -4.506551e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375398e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099986e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165986e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1688
    reference variance = 0.162667
====================================================
  Execution time = 2.0018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2821e-01
  Total weights = 2.0000e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256881877
                                         uncertainty =       0.009210824403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256881877
                                         uncertainty =       0.009210824403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405101703
  error estimate for blocks of size 2^( 2) =       0.000414760086
  error estimate for blocks of size 2^( 3) =       0.000423319565
  error estimate for blocks of size 2^( 4) =       0.000430124848
  error estimate for blocks of size 2^( 5) =       0.000434766395
  error estimate for blocks of size 2^( 6) =       0.000437683774
  error estimate for blocks of size 2^( 7) =       0.000439759523

      target function =                  N/A
              le_mean =     -17.217099175371
             les_mean =     296.756718629726
             stat err =       0.000435583635
             autocorr =       1.156152099407
              std dev =       0.572900322286
             le_variance =       0.328214779276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256882872
                                         uncertainty =       0.009210824476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256882872
                                         uncertainty =       0.009210824476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405101703
  error estimate for blocks of size 2^( 2) =       0.000414760086
  error estimate for blocks of size 2^( 3) =       0.000423319565
  error estimate for blocks of size 2^( 4) =       0.000430124849
  error estimate for blocks of size 2^( 5) =       0.000434766395
  error estimate for blocks of size 2^( 6) =       0.000437683774
  error estimate for blocks of size 2^( 7) =       0.000439759524

      target function =                  N/A
              le_mean =     -17.217099175378
             les_mean =     296.756718630964
             stat err =       0.000435583635
             autocorr =       1.156152097827
              std dev =       0.572900323154
             le_variance =       0.328214780270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256882375
                                         uncertainty =       0.009210824439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256882375
                                         uncertainty =       0.009210824439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405101703
  error estimate for blocks of size 2^( 2) =       0.000414760086
  error estimate for blocks of size 2^( 3) =       0.000423319565
  error estimate for blocks of size 2^( 4) =       0.000430124848
  error estimate for blocks of size 2^( 5) =       0.000434766395
  error estimate for blocks of size 2^( 6) =       0.000437683774
  error estimate for blocks of size 2^( 7) =       0.000439759524

      target function =                  N/A
              le_mean =     -17.217099175374
             les_mean =     296.756718630345
             stat err =       0.000435583635
             autocorr =       1.156152098615
              std dev =       0.572900322720
             le_variance =       0.328214779773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256881939
                                         uncertainty =       0.009210824408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328256881939
                                         uncertainty =       0.009210824408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405101703
  error estimate for blocks of size 2^( 2) =       0.000414760086
  error estimate for blocks of size 2^( 3) =       0.000423319565
  error estimate for blocks of size 2^( 4) =       0.000430124848
  error estimate for blocks of size 2^( 5) =       0.000434766395
  error estimate for blocks of size 2^( 6) =       0.000437683774
  error estimate for blocks of size 2^( 7) =       0.000439759523

      target function =                  N/A
              le_mean =     -17.217099175371
             les_mean =     296.756718629803
             stat err =       0.000435583635
             autocorr =       1.156152099308
              std dev =       0.572900322341
             le_variance =       0.328214779338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217099175371        initial
     3.6380e+04     3.6380e+05             9.6078e-09       -17.217099175378  <--
     1.4552e+05     1.4552e+06             2.4020e-09       -17.217099175374
     5.8208e+05     5.8208e+06             6.0049e-10       -17.217099175371

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 3.2432e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295242e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099955e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138437e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826307e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.216928
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314934093113
                                         uncertainty =       0.003271773660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314934093113
                                         uncertainty =       0.003271773660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396797345
  error estimate for blocks of size 2^( 2) =       0.000406402044
  error estimate for blocks of size 2^( 3) =       0.000415111849
  error estimate for blocks of size 2^( 4) =       0.000421265468
  error estimate for blocks of size 2^( 5) =       0.000425596221
  error estimate for blocks of size 2^( 6) =       0.000427519603
  error estimate for blocks of size 2^( 7) =       0.000428681321

      target function =                  N/A
              le_mean =     -17.216768687552
             les_mean =     296.732020149227
             stat err =       0.000425765653
             autocorr =       1.151340368334
              std dev =       0.561156186814
             le_variance =       0.314896265999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676868755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768687552       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768687548       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768687524       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768687417       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768687469       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768687489       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768687507       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 5.199356e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768687552       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768687551       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768687545       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768687518       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768687506       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768687545       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768687551       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.299853e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768687552       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768687552       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768687550       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768687544       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768687619       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768687434       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768687733       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 3.249643e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5987e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295243e-02 1 1  ON 7
 uu_8                 9.767387e-02 1 1  ON 8
 uu_9                 1.227529e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536537e-02 1 1  ON 12
 ud_3                -7.563919e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099929e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138438e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041809e-01 1 1  ON 24
 eO_5                 3.130156e-01 1 1  ON 25
 eO_6                 2.535803e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924882e-02 1 1  ON 34
eH1_5                 3.370857e-02 1 1  ON 35
eH1_6                 7.737334e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354198e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645182e-02 1 1  ON 48
eH2_9                 2.717106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.120952
====================================================
  Execution time = 1.9937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1823e-01
  Total weights = 2.0000e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813332062
                                         uncertainty =       0.003061178221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813332062
                                         uncertainty =       0.003061178221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398895157
  error estimate for blocks of size 2^( 2) =       0.000408735354
  error estimate for blocks of size 2^( 3) =       0.000416786885
  error estimate for blocks of size 2^( 4) =       0.000423652462
  error estimate for blocks of size 2^( 5) =       0.000428644449
  error estimate for blocks of size 2^( 6) =       0.000430302858
  error estimate for blocks of size 2^( 7) =       0.000433187179

      target function =                  N/A
              le_mean =     -17.217370694464
             les_mean =     296.756088164208
             stat err =       0.000428946737
             autocorr =       1.156349745005
              std dev =       0.564122941168
             le_variance =       0.318234692753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813336113
                                         uncertainty =       0.003061178202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813336113
                                         uncertainty =       0.003061178202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398895160
  error estimate for blocks of size 2^( 2) =       0.000408735356
  error estimate for blocks of size 2^( 3) =       0.000416786887
  error estimate for blocks of size 2^( 4) =       0.000423652464
  error estimate for blocks of size 2^( 5) =       0.000428644450
  error estimate for blocks of size 2^( 6) =       0.000430302860
  error estimate for blocks of size 2^( 7) =       0.000433187180

      target function =                  N/A
              le_mean =     -17.217370694496
             les_mean =     296.756088169421
             stat err =       0.000428946738
             autocorr =       1.156349739594
              std dev =       0.564122944786
             le_variance =       0.318234696834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813334087
                                         uncertainty =       0.003061178211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813334087
                                         uncertainty =       0.003061178211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398895158
  error estimate for blocks of size 2^( 2) =       0.000408735355
  error estimate for blocks of size 2^( 3) =       0.000416786886
  error estimate for blocks of size 2^( 4) =       0.000423652463
  error estimate for blocks of size 2^( 5) =       0.000428644450
  error estimate for blocks of size 2^( 6) =       0.000430302859
  error estimate for blocks of size 2^( 7) =       0.000433187179

      target function =                  N/A
              le_mean =     -17.217370694480
             les_mean =     296.756088166815
             stat err =       0.000428946738
             autocorr =       1.156349742308
              std dev =       0.564122942977
             le_variance =       0.318234694793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813332315
                                         uncertainty =       0.003061178220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813332315
                                         uncertainty =       0.003061178220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398895157
  error estimate for blocks of size 2^( 2) =       0.000408735354
  error estimate for blocks of size 2^( 3) =       0.000416786885
  error estimate for blocks of size 2^( 4) =       0.000423652462
  error estimate for blocks of size 2^( 5) =       0.000428644449
  error estimate for blocks of size 2^( 6) =       0.000430302858
  error estimate for blocks of size 2^( 7) =       0.000433187179

      target function =                  N/A
              le_mean =     -17.217370694466
             les_mean =     296.756088164534
             stat err =       0.000428946737
             autocorr =       1.156349744674
              std dev =       0.564122941395
             le_variance =       0.318234693008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217370694464        initial
     9.0949e+03     9.0949e+04             5.1994e-08       -17.217370694496  <--
     3.6380e+04     3.6380e+05             1.2999e-08       -17.217370694480
     1.4552e+05     1.4552e+06             3.2496e-09       -17.217370694466

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 2.9118e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295244e-02 1 1  ON 7
 uu_8                 9.767386e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099853e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138440e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924881e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737335e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354199e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645183e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.143015
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315301784100
                                         uncertainty =       0.002803822473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315301784100
                                         uncertainty =       0.002803822473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397004818
  error estimate for blocks of size 2^( 2) =       0.000406347890
  error estimate for blocks of size 2^( 3) =       0.000415049964
  error estimate for blocks of size 2^( 4) =       0.000421442476
  error estimate for blocks of size 2^( 5) =       0.000425040549
  error estimate for blocks of size 2^( 6) =       0.000426894843
  error estimate for blocks of size 2^( 7) =       0.000430214471

      target function =                  N/A
              le_mean =     -17.217241463866
             les_mean =     296.748629117803
             stat err =       0.000425898085
             autocorr =       1.150852909563
              std dev =       0.561449597347
             le_variance =       0.315225650361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724146387e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217241463866       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217241463872       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217241463835       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217241463746       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217241463956       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217241464045       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217241464114       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.889206e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217241463866       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217241463867       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217241463858       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217241463836       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217241463884       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217241463924       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217241463926       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 4.723142e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217241463866       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217241463866       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217241463864       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217241463868       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217241463870       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217241463877       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217241463891       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.180793e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5637e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961924e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161235e-01 1 1  ON 6
 uu_7                -4.295245e-02 1 1  ON 7
 uu_8                 9.767385e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375400e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099716e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680169e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138441e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247540e-02 1 1  ON 32
eH1_3                -2.585377e-02 1 1  ON 33
eH1_4                 1.924881e-02 1 1  ON 34
eH1_5                 3.370858e-02 1 1  ON 35
eH1_6                 7.737335e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354200e-02 1 1  ON 38
eH1_9                 2.515174e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388853e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823265e-02 1 1  ON 44
eH2_5                 3.360838e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645184e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.317207
====================================================
  Execution time = 1.9773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4549e-01
  Total weights = 2.0000e+06
  Execution time = 1.8338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535271551
                                         uncertainty =       0.016579315865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535271551
                                         uncertainty =       0.016579315865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625599
  error estimate for blocks of size 2^( 2) =       0.000424738770
  error estimate for blocks of size 2^( 3) =       0.000432671548
  error estimate for blocks of size 2^( 4) =       0.000438947743
  error estimate for blocks of size 2^( 5) =       0.000441959266
  error estimate for blocks of size 2^( 6) =       0.000442218006
  error estimate for blocks of size 2^( 7) =       0.000442590242

      target function =                  N/A
              le_mean =     -17.216753728938
             les_mean =     296.762098067940
             stat err =       0.000441428814
             autocorr =       1.128019945340
              std dev =       0.587783359564
             le_variance =       0.345489277780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535327480
                                         uncertainty =       0.016579319674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535327480
                                         uncertainty =       0.016579319674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625633
  error estimate for blocks of size 2^( 2) =       0.000424738802
  error estimate for blocks of size 2^( 3) =       0.000432671578
  error estimate for blocks of size 2^( 4) =       0.000438947772
  error estimate for blocks of size 2^( 5) =       0.000441959294
  error estimate for blocks of size 2^( 6) =       0.000442218034
  error estimate for blocks of size 2^( 7) =       0.000442590270

      target function =                  N/A
              le_mean =     -17.216753728685
             les_mean =     296.762098115134
             stat err =       0.000441428842
             autocorr =       1.128019906097
              std dev =       0.587783407126
             le_variance =       0.345489333692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535299517
                                         uncertainty =       0.016579317769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535299517
                                         uncertainty =       0.016579317769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625616
  error estimate for blocks of size 2^( 2) =       0.000424738786
  error estimate for blocks of size 2^( 3) =       0.000432671563
  error estimate for blocks of size 2^( 4) =       0.000438947758
  error estimate for blocks of size 2^( 5) =       0.000441959280
  error estimate for blocks of size 2^( 6) =       0.000442218020
  error estimate for blocks of size 2^( 7) =       0.000442590256

      target function =                  N/A
              le_mean =     -17.216753728812
             les_mean =     296.762098091538
             stat err =       0.000441428828
             autocorr =       1.128019925709
              std dev =       0.587783383346
             le_variance =       0.345489305738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535275047
                                         uncertainty =       0.016579316103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345535275047
                                         uncertainty =       0.016579316103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415625602
  error estimate for blocks of size 2^( 2) =       0.000424738772
  error estimate for blocks of size 2^( 3) =       0.000432671550
  error estimate for blocks of size 2^( 4) =       0.000438947745
  error estimate for blocks of size 2^( 5) =       0.000441959268
  error estimate for blocks of size 2^( 6) =       0.000442218007
  error estimate for blocks of size 2^( 7) =       0.000442590244

      target function =                  N/A
              le_mean =     -17.216753728922
             les_mean =     296.762098070890
             stat err =       0.000441428816
             autocorr =       1.128019942878
              std dev =       0.587783362537
             le_variance =       0.345489281275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216753728938        initial  <--
     2.2737e+03     2.2737e+04             1.8892e-07       -17.216753728685
     9.0949e+03     9.0949e+04             4.7231e-08       -17.216753728812
     3.6380e+04     3.6380e+05             1.1808e-08       -17.216753728922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0427
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295244e-02 1 1  ON 7
 uu_8                 9.767386e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099853e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138440e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924881e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737335e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354199e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645183e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.70353
====================================================
  Execution time = 1.9843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240536091
                                         uncertainty =       0.008207337110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240536091
                                         uncertainty =       0.008207337110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065766
  error estimate for blocks of size 2^( 2) =       0.000411471266
  error estimate for blocks of size 2^( 3) =       0.000419890319
  error estimate for blocks of size 2^( 4) =       0.000425959921
  error estimate for blocks of size 2^( 5) =       0.000431101350
  error estimate for blocks of size 2^( 6) =       0.000435008240
  error estimate for blocks of size 2^( 7) =       0.000436072512

      target function =                  N/A
              le_mean =     -17.216199304487
             les_mean =     296.720832089980
             stat err =       0.000432035506
             autocorr =       1.154634918064
              std dev =       0.568606858758
             le_variance =       0.323313759827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619930449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216199304487       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216199304475       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216199304470       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216199304505       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199304517       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216199304524       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216199304539       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.669346e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216199304487       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216199304484       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216199304483       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216199304510       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199304639       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216199304453       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216199304482       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 4.173372e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216199304487       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216199304486       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216199304486       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216199304488       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199304479       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216199304549       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216199304526       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.043343e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5322e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295244e-02 1 1  ON 7
 uu_8                 9.767386e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099840e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138440e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924881e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737335e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354199e-02 1 1  ON 38
eH1_9                 2.515174e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645183e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.325563
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427183124
                                         uncertainty =       0.002638296277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427183124
                                         uncertainty =       0.002638296277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393988043
  error estimate for blocks of size 2^( 2) =       0.000403680513
  error estimate for blocks of size 2^( 3) =       0.000412030965
  error estimate for blocks of size 2^( 4) =       0.000418938658
  error estimate for blocks of size 2^( 5) =       0.000423410798
  error estimate for blocks of size 2^( 6) =       0.000426313071
  error estimate for blocks of size 2^( 7) =       0.000426806187

      target function =                  N/A
              le_mean =     -17.216274986978
             les_mean =     296.710577427574
             stat err =       0.000423867178
             autocorr =       1.157426695239
              std dev =       0.557183233383
             le_variance =       0.310453155563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427187357
                                         uncertainty =       0.002638296319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427187357
                                         uncertainty =       0.002638296319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393988045
  error estimate for blocks of size 2^( 2) =       0.000403680515
  error estimate for blocks of size 2^( 3) =       0.000412030968
  error estimate for blocks of size 2^( 4) =       0.000418938660
  error estimate for blocks of size 2^( 5) =       0.000423410800
  error estimate for blocks of size 2^( 6) =       0.000426313073
  error estimate for blocks of size 2^( 7) =       0.000426806189

      target function =                  N/A
              le_mean =     -17.216274986953
             les_mean =     296.710577430961
             stat err =       0.000423867180
             autocorr =       1.157426690107
              std dev =       0.557183237177
             le_variance =       0.310453159790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427185240
                                         uncertainty =       0.002638296298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427185240
                                         uncertainty =       0.002638296298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393988044
  error estimate for blocks of size 2^( 2) =       0.000403680514
  error estimate for blocks of size 2^( 3) =       0.000412030966
  error estimate for blocks of size 2^( 4) =       0.000418938659
  error estimate for blocks of size 2^( 5) =       0.000423410799
  error estimate for blocks of size 2^( 6) =       0.000426313072
  error estimate for blocks of size 2^( 7) =       0.000426806188

      target function =                  N/A
              le_mean =     -17.216274986966
             les_mean =     296.710577429267
             stat err =       0.000423867179
             autocorr =       1.157426692675
              std dev =       0.557183235280
             le_variance =       0.310453157677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427183388
                                         uncertainty =       0.002638296280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310427183388
                                         uncertainty =       0.002638296280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393988043
  error estimate for blocks of size 2^( 2) =       0.000403680513
  error estimate for blocks of size 2^( 3) =       0.000412030965
  error estimate for blocks of size 2^( 4) =       0.000418938658
  error estimate for blocks of size 2^( 5) =       0.000423410798
  error estimate for blocks of size 2^( 6) =       0.000426313071
  error estimate for blocks of size 2^( 7) =       0.000426806187

      target function =                  N/A
              le_mean =     -17.216274986976
             les_mean =     296.710577427785
             stat err =       0.000423867179
             autocorr =       1.157426694918
              std dev =       0.557183233620
             le_variance =       0.310453155827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216274986978        initial  <--
     2.2737e+04     2.2737e+05             1.6693e-08       -17.216274986953
     9.0949e+04     9.0949e+05             4.1734e-09       -17.216274986966
     3.6380e+05     3.6380e+06             1.0433e-09       -17.216274986976

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0094
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.118251e-01 1 1  ON 0
 uu_1                 4.961922e-02 1 1  ON 1
 uu_2                -4.506550e-02 1 1  ON 2
 uu_3                -9.993802e-02 1 1  ON 3
 uu_4                -1.332601e-01 1 1  ON 4
 uu_5                -1.395322e-01 1 1  ON 5
 uu_6                -1.161234e-01 1 1  ON 6
 uu_7                -4.295244e-02 1 1  ON 7
 uu_8                 9.767386e-02 1 1  ON 8
 uu_9                 1.227530e-01 1 1  ON 9
 ud_0                 3.521166e-01 1 1  ON 10
 ud_1                 9.375399e-02 1 1  ON 11
 ud_2                -1.536536e-02 1 1  ON 12
 ud_3                -7.563918e-02 1 1  ON 13
 ud_4                -1.226008e-01 1 1  ON 14
 ud_5                -1.535800e-01 1 1  ON 15
 ud_6                -1.546461e-01 1 1  ON 16
 ud_7                -1.114365e-01 1 1  ON 17
 ud_8                 5.099853e-04 1 1  ON 18
 ud_9                 9.261350e-02 1 1  ON 19
 eO_0                -7.680168e-01 1 1  ON 20
 eO_1                -4.487200e-01 1 1  ON 21
 eO_2                -4.138440e-02 1 1  ON 22
 eO_3                 2.125370e-01 1 1  ON 23
 eO_4                 3.041810e-01 1 1  ON 24
 eO_5                 3.130157e-01 1 1  ON 25
 eO_6                 2.535804e-01 1 1  ON 26
 eO_7                 1.165987e-01 1 1  ON 27
 eO_8                 2.874814e-02 1 1  ON 28
 eO_9                 1.871805e-02 1 1  ON 29
eH1_0                -1.826306e-01 1 1  ON 30
eH1_1                -1.034588e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.585376e-02 1 1  ON 33
eH1_4                 1.924881e-02 1 1  ON 34
eH1_5                 3.370856e-02 1 1  ON 35
eH1_6                 7.737335e-02 1 1  ON 36
eH1_7                 1.098388e-01 1 1  ON 37
eH1_8                 9.354199e-02 1 1  ON 38
eH1_9                 2.515173e-02 1 1  ON 39
eH2_0                -1.841241e-01 1 1  ON 40
eH2_1                -1.048605e-01 1 1  ON 41
eH2_2                -6.388854e-02 1 1  ON 42
eH2_3                -2.707294e-02 1 1  ON 43
eH2_4                 1.823266e-02 1 1  ON 44
eH2_5                 3.360837e-02 1 1  ON 45
eH2_6                 7.881410e-02 1 1  ON 46
eH2_7                 1.133491e-01 1 1  ON 47
eH2_8                 9.645183e-02 1 1  ON 48
eH2_9                 2.717107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4336e+01 secs
  Total Execution time = 2.2252e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
