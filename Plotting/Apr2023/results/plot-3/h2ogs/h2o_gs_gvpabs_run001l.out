Rank =    0  Free Memory = 80817 MB
Rank =    1  Free Memory = 80817 MB
Rank =    2  Free Memory = 80817 MB
Rank =    3  Free Memory = 80817 MB
Rank =    4  Free Memory = 80817 MB
Rank =    5  Free Memory = 80817 MB
Rank =    6  Free Memory = 80816 MB
Rank =    7  Free Memory = 80816 MB
Rank =    8  Free Memory = 80816 MB
Rank =    9  Free Memory = 80816 MB
Rank =   10  Free Memory = 80816 MB
Rank =   11  Free Memory = 80816 MB
Rank =   12  Free Memory = 80816 MB
Rank =   13  Free Memory = 80816 MB
Rank =   14  Free Memory = 80816 MB
Rank =   15  Free Memory = 80801 MB
Rank =   16  Free Memory = 80801 MB
Rank =   17  Free Memory = 80801 MB
Rank =   18  Free Memory = 80801 MB
Rank =   19  Free Memory = 80801 MB
Rank =   20  Free Memory = 80801 MB
Rank =   21  Free Memory = 80801 MB
Rank =   22  Free Memory = 80801 MB
Rank =   23  Free Memory = 80801 MB
Rank =   24  Free Memory = 80801 MB
Rank =   25  Free Memory = 80801 MB
Rank =   26  Free Memory = 80801 MB
Rank =   27  Free Memory = 80801 MB
Rank =   28  Free Memory = 80801 MB
Rank =   29  Free Memory = 80801 MB
Rank =   30  Free Memory = 80801 MB
Rank =   31  Free Memory = 80801 MB
Rank =   32  Free Memory = 80216 MB
Rank =   33  Free Memory = 80216 MB
Rank =   34  Free Memory = 80216 MB
Rank =   35  Free Memory = 80216 MB
Rank =   36  Free Memory = 80216 MB
Rank =   37  Free Memory = 80216 MB
Rank =   38  Free Memory = 80216 MB
Rank =   39  Free Memory = 80216 MB
Rank =   40  Free Memory = 80216 MB
Rank =   41  Free Memory = 80216 MB
Rank =   42  Free Memory = 80216 MB
Rank =   43  Free Memory = 80216 MB
Rank =   44  Free Memory = 80216 MB
Rank =   45  Free Memory = 80216 MB
Rank =   46  Free Memory = 80216 MB
Rank =   47  Free Memory = 80216 MB
Rank =   48  Free Memory = 80216 MB
Rank =   49  Free Memory = 80216 MB
Rank =   50  Free Memory = 80216 MB
Rank =   51  Free Memory = 80216 MB
Rank =   52  Free Memory = 80216 MB
Rank =   53  Free Memory = 80216 MB
Rank =   54  Free Memory = 80216 MB
Rank =   55  Free Memory = 80216 MB
Rank =   56  Free Memory = 80216 MB
Rank =   57  Free Memory = 80216 MB
Rank =   58  Free Memory = 80216 MB
Rank =   59  Free Memory = 80216 MB
Rank =   60  Free Memory = 80216 MB
Rank =   61  Free Memory = 80216 MB
Rank =   62  Free Memory = 80216 MB
Rank =   63  Free Memory = 80216 MB
Rank =   64  Free Memory = 83154 MB
Rank =   65  Free Memory = 83154 MB
Rank =   66  Free Memory = 83154 MB
Rank =   67  Free Memory = 83154 MB
Rank =   68  Free Memory = 83154 MB
Rank =   69  Free Memory = 83154 MB
Rank =   70  Free Memory = 83154 MB
Rank =   71  Free Memory = 83154 MB
Rank =   72  Free Memory = 83154 MB
Rank =   73  Free Memory = 83154 MB
Rank =   74  Free Memory = 83154 MB
Rank =   75  Free Memory = 83154 MB
Rank =   76  Free Memory = 83154 MB
Rank =   77  Free Memory = 83154 MB
Rank =   78  Free Memory = 83154 MB
Rank =   79  Free Memory = 83154 MB
Rank =   80  Free Memory = 83154 MB
Rank =   81  Free Memory = 83154 MB
Rank =   82  Free Memory = 83154 MB
Rank =   83  Free Memory = 83154 MB
Rank =   84  Free Memory = 83154 MB
Rank =   85  Free Memory = 83154 MB
Rank =   86  Free Memory = 83154 MB
Rank =   87  Free Memory = 83154 MB
Rank =   88  Free Memory = 83154 MB
Rank =   89  Free Memory = 83154 MB
Rank =   90  Free Memory = 83154 MB
Rank =   91  Free Memory = 83154 MB
Rank =   92  Free Memory = 83154 MB
Rank =   93  Free Memory = 83154 MB
Rank =   94  Free Memory = 83154 MB
Rank =   95  Free Memory = 83154 MB
Rank =   96  Free Memory = 83154 MB
Rank =   97  Free Memory = 83154 MB
Rank =   98  Free Memory = 83154 MB
Rank =   99  Free Memory = 83154 MB
Rank =  100  Free Memory = 83154 MB
Rank =  101  Free Memory = 83154 MB
Rank =  102  Free Memory = 83154 MB
Rank =  103  Free Memory = 83154 MB
  Input file(s): opt_h2o_gs_gvpabs_run001l.xml 
Rank =  104  Free Memory = 83646 MB
Rank =  105  Free Memory = 83646 MB
Rank =  106  Free Memory = 83646 MB
Rank =  107  Free Memory = 83646 MB
Rank =  108  Free Memory = 83646 MB
Rank =  109  Free Memory = 83646 MB
Rank =  110  Free Memory = 83646 MB
Rank =  111  Free Memory = 83646 MB
Rank =  112  Free Memory = 83646 MB
Rank =  113  Free Memory = 83646 MB
Rank =  114  Free Memory = 83646 MB
Rank =  115  Free Memory = 83646 MB
Rank =  116  Free Memory = 83646 MB
Rank =  117  Free Memory = 83646 MB
Rank =  118  Free Memory = 83646 MB
Rank =  119  Free Memory = 83646 MB
Rank =  120  Free Memory = 83646 MB
Rank =  121  Free Memory = 83646 MB
Rank =  122  Free Memory = 83646 MB
Rank =  123  Free Memory = 83646 MB
Rank =  124  Free Memory = 83646 MB
Rank =  125  Free Memory = 83646 MB
Rank =  126  Free Memory = 83646 MB
Rank =  127  Free Memory = 83646 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001l.xml

  Project = H2O
  date    = 2023-04-09 18:36:55 PDT
  host    = n0124.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 55

  Range of prime numbers to use as seeds over processors and threads = 269-1103


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.156912e-01    1         1  ON     0
     uu_1                 5.283271e-02    1         1  ON     1
     uu_2                -4.310085e-02    1         1  ON     2
     uu_3                -9.922194e-02    1         1  ON     3
     uu_4                -1.339340e-01    1         1  ON     4
     uu_5                -1.423882e-01    1         1  ON     5
     uu_6                -1.214845e-01    1         1  ON     6
     uu_7                -5.067670e-02    1         1  ON     7
     uu_8                 9.127637e-02    1         1  ON     8
     uu_9                 1.286003e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.566038e-01    1         1  ON     0
     ud_1                 9.745547e-02    1         1  ON     1
     ud_2                -1.335848e-02    1         1  ON     2
     ud_3                -7.533275e-02    1         1  ON     3
     ud_4                -1.237856e-01    1         1  ON     4
     ud_5                -1.561952e-01    1         1  ON     5
     ud_6                -1.581595e-01    1         1  ON     6
     ud_7                -1.130833e-01    1         1  ON     7
     ud_8                -7.762622e-03    1         1  ON     8
     ud_9                 9.284799e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.912428e-01    1         1  ON     0
     eO_1                -4.679996e-01    1         1  ON     1
     eO_2                -5.368371e-02    1         1  ON     2
     eO_3                 2.095254e-01    1         1  ON     3
     eO_4                 3.133042e-01    1         1  ON     4
     eO_5                 3.322902e-01    1         1  ON     5
     eO_6                 2.669470e-01    1         1  ON     6
     eO_7                 1.290913e-01    1         1  ON     7
     eO_8                 3.079994e-02    1         1  ON     8
     eO_9                 1.934752e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.848039e-01    1         1  ON     0
     eH1_1                -1.055318e-01    1         1  ON     1
     eH1_2                -6.396372e-02    1         1  ON     2
     eH1_3                -2.690894e-02    1         1  ON     3
     eH1_4                 1.858034e-02    1         1  ON     4
     eH1_5                 3.152379e-02    1         1  ON     5
     eH1_6                 7.693536e-02    1         1  ON     6
     eH1_7                 1.101110e-01    1         1  ON     7
     eH1_8                 1.001610e-01    1         1  ON     8
     eH1_9                 2.744408e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.867203e-01    1         1  ON     0
     eH2_1                -1.072055e-01    1         1  ON     1
     eH2_2                -6.543685e-02    1         1  ON     2
     eH2_3                -2.806682e-02    1         1  ON     3
     eH2_4                 1.757694e-02    1         1  ON     4
     eH2_5                 3.166396e-02    1         1  ON     5
     eH2_6                 7.875444e-02    1         1  ON     6
     eH2_7                 1.136555e-01    1         1  ON     7
     eH2_8                 1.030145e-01    1         1  ON     8
     eH2_9                 2.961682e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.695983e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.0773e+00 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1647
    reference variance = 0.157133
====================================================
  Execution time = 2.0756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2186e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321971385964
                                         uncertainty =       0.006378111498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321971385964
                                         uncertainty =       0.006378111498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401160412
  error estimate for blocks of size 2^( 2) =       0.000411015599
  error estimate for blocks of size 2^( 3) =       0.000420309359
  error estimate for blocks of size 2^( 4) =       0.000426261775
  error estimate for blocks of size 2^( 5) =       0.000429777106
  error estimate for blocks of size 2^( 6) =       0.000432140374
  error estimate for blocks of size 2^( 7) =       0.000432973974

      target function =                  N/A
              le_mean =     -17.216461075822
             les_mean =     296.728391166397
             stat err =       0.000430288308
             autocorr =       1.150490277809
              std dev =       0.567326495078
             le_variance =       0.321859352017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721646107582e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461075822       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461744835       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461984887       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461755382       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216462420449       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461139812       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462522211       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216462762905       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216463025231       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216462905645       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.522774e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461075822       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461332234       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461500891       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461274337       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461320745       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461213921       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461450938       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216461495125       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.574388e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461075822       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461149782       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461210558       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461125853       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461086703       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461116203       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461125018       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.330153e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6338e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.157522e-01                 1 1 ON  0
uu_1  5.282925e-02                 1 1 ON  1
uu_2  -4.310200e-02                1 1 ON  2
uu_3  -9.922826e-02                1 1 ON  3
uu_4  -1.339691e-01                1 1 ON  4
uu_5  -1.425007e-01                1 1 ON  5
uu_6  -1.214934e-01                1 1 ON  6
uu_7  -5.073665e-02                1 1 ON  7
uu_8  9.122892e-02                 1 1 ON  8
uu_9  1.286836e-01                 1 1 ON  9
ud_0  3.567546e-01                 1 1 ON  10
ud_1  9.752607e-02                 1 1 ON  11
ud_2  -1.350720e-02                1 1 ON  12
ud_3  -7.541862e-02                1 1 ON  13
ud_4  -1.238651e-01                1 1 ON  14
ud_5  -1.562196e-01                1 1 ON  15
ud_6  -1.581497e-01                1 1 ON  16
ud_7  -1.130778e-01                1 1 ON  17
ud_8  -7.809584e-03                1 1 ON  18
ud_9  9.287748e-02                 1 1 ON  19
eO_0  -7.915003e-01                1 1 ON  20
eO_1  -4.681915e-01                1 1 ON  21
eO_2  -5.372441e-02                1 1 ON  22
eO_3  2.094876e-01                 1 1 ON  23
eO_4  3.133650e-01                 1 1 ON  24
eO_5  3.324088e-01                 1 1 ON  25
eO_6  2.670874e-01                 1 1 ON  26
eO_7  1.292247e-01                 1 1 ON  27
eO_8  3.083300e-02                 1 1 ON  28
eO_9  1.936728e-02                 1 1 ON  29
eH1_0 -1.848471e-01                1 1 ON  30
eH1_1 -1.055066e-01                1 1 ON  31
eH1_2 -6.395444e-02                1 1 ON  32
eH1_3 -2.683113e-02                1 1 ON  33
eH1_4 1.855802e-02                 1 1 ON  34
eH1_5 3.142252e-02                 1 1 ON  35
eH1_6 7.687461e-02                 1 1 ON  36
eH1_7 1.100961e-01                 1 1 ON  37
eH1_8 1.002345e-01                 1 1 ON  38
eH1_9 2.748710e-02                 1 1 ON  39
eH2_0 -1.866852e-01                1 1 ON  40
eH2_1 -1.072954e-01                1 1 ON  41
eH2_2 -6.546786e-02                1 1 ON  42
eH2_3 -2.801399e-02                1 1 ON  43
eH2_4 1.756587e-02                 1 1 ON  44
eH2_5 3.159181e-02                 1 1 ON  45
eH2_6 7.874428e-02                 1 1 ON  46
eH2_7 1.136625e-01                 1 1 ON  47
eH2_8 1.030834e-01                 1 1 ON  48
eH2_9 2.963933e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1922
    reference variance = 0.397695
====================================================
  Execution time = 2.0359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2481e-01
  Total weights = 2.0000e+06
  Execution time = 1.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650119901
                                         uncertainty =       0.006021968014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650119901
                                         uncertainty =       0.006021968014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402865578
  error estimate for blocks of size 2^( 2) =       0.000412510952
  error estimate for blocks of size 2^( 3) =       0.000421009640
  error estimate for blocks of size 2^( 4) =       0.000427649243
  error estimate for blocks of size 2^( 5) =       0.000430907048
  error estimate for blocks of size 2^( 6) =       0.000431179252
  error estimate for blocks of size 2^( 7) =       0.000431818436

      target function =                  N/A
              le_mean =     -17.216789549042
             les_mean =     296.742443562290
             stat err =       0.000430388495
             autocorr =       1.141303060674
              std dev =       0.569737964835
             le_variance =       0.324601348574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325147465017
                                         uncertainty =       0.006024337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325147465017
                                         uncertainty =       0.006024337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403174117
  error estimate for blocks of size 2^( 2) =       0.000412800708
  error estimate for blocks of size 2^( 3) =       0.000421280161
  error estimate for blocks of size 2^( 4) =       0.000427912371
  error estimate for blocks of size 2^( 5) =       0.000431166641
  error estimate for blocks of size 2^( 6) =       0.000431439410
  error estimate for blocks of size 2^( 7) =       0.000432060295

      target function =                  N/A
              le_mean =     -17.216792648864
             les_mean =     296.743047688352
             stat err =       0.000430644679
             autocorr =       1.140913936790
              std dev =       0.570174303977
             le_variance =       0.325098736915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061958766
                                         uncertainty =       0.006022786935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325061958766
                                         uncertainty =       0.006022786935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403121082
  error estimate for blocks of size 2^( 2) =       0.000412749744
  error estimate for blocks of size 2^( 3) =       0.000421232387
  error estimate for blocks of size 2^( 4) =       0.000427866556
  error estimate for blocks of size 2^( 5) =       0.000431122744
  error estimate for blocks of size 2^( 6) =       0.000431397611
  error estimate for blocks of size 2^( 7) =       0.000432019590

      target function =                  N/A
              le_mean =     -17.216791774639
             les_mean =     296.742932062017
             stat err =       0.000430601625
             autocorr =       1.140985979500
              std dev =       0.570099301222
             le_variance =       0.325013213253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324713498846
                                         uncertainty =       0.006021975272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324713498846
                                         uncertainty =       0.006021975272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402904908
  error estimate for blocks of size 2^( 2) =       0.000412547548
  error estimate for blocks of size 2^( 3) =       0.000421043776
  error estimate for blocks of size 2^( 4) =       0.000427682577
  error estimate for blocks of size 2^( 5) =       0.000430940336
  error estimate for blocks of size 2^( 6) =       0.000431213158
  error estimate for blocks of size 2^( 7) =       0.000431849472

      target function =                  N/A
              le_mean =     -17.216789792748
             les_mean =     296.742515335009
             stat err =       0.000430421386
             autocorr =       1.141254670238
              std dev =       0.569793585156
             le_variance =       0.324664729685


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216789549042        initial
     2.5000e-01     2.5000e+00             9.5228e-04       -17.216792648864  <--
     1.0000e+00     1.0000e+01             2.5744e-04       -17.216791774639
     4.0000e+00     4.0000e+01             6.3302e-05       -17.216789792748

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9694e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.158680e-01 1 1  ON 0
 uu_1                 5.283222e-02 1 1  ON 1
 uu_2                -4.310529e-02 1 1  ON 2
 uu_3                -9.925465e-02 1 1  ON 3
 uu_4                -1.340805e-01 1 1  ON 4
 uu_5                -1.427485e-01 1 1  ON 5
 uu_6                -1.215475e-01 1 1  ON 6
 uu_7                -5.091711e-02 1 1  ON 7
 uu_8                 9.108919e-02 1 1  ON 8
 uu_9                 1.289344e-01 1 1  ON 9
 ud_0                 3.569549e-01 1 1  ON 10
 ud_1                 9.758093e-02 1 1  ON 11
 ud_2                -1.368481e-02 1 1  ON 12
 ud_3                -7.561155e-02 1 1  ON 13
 ud_4                -1.240527e-01 1 1  ON 14
 ud_5                -1.562960e-01 1 1  ON 15
 ud_6                -1.581134e-01 1 1  ON 16
 ud_7                -1.130493e-01 1 1  ON 17
 ud_8                -7.944804e-03 1 1  ON 18
 ud_9                 9.296733e-02 1 1  ON 19
 eO_0                -7.921951e-01 1 1  ON 20
 eO_1                -4.687173e-01 1 1  ON 21
 eO_2                -5.400959e-02 1 1  ON 22
 eO_3                 2.093818e-01 1 1  ON 23
 eO_4                 3.135519e-01 1 1  ON 24
 eO_5                 3.327761e-01 1 1  ON 25
 eO_6                 2.675157e-01 1 1  ON 26
 eO_7                 1.296285e-01 1 1  ON 27
 eO_8                 3.093307e-02 1 1  ON 28
 eO_9                 1.942684e-02 1 1  ON 29
eH1_0                -1.849426e-01 1 1  ON 30
eH1_1                -1.054790e-01 1 1  ON 31
eH1_2                -6.390575e-02 1 1  ON 32
eH1_3                -2.668832e-02 1 1  ON 33
eH1_4                 1.854097e-02 1 1  ON 34
eH1_5                 3.114879e-02 1 1  ON 35
eH1_6                 7.669235e-02 1 1  ON 36
eH1_7                 1.100527e-01 1 1  ON 37
eH1_8                 1.004563e-01 1 1  ON 38
eH1_9                 2.761688e-02 1 1  ON 39
eH2_0                -1.866604e-01 1 1  ON 40
eH2_1                -1.074597e-01 1 1  ON 41
eH2_2                -6.552062e-02 1 1  ON 42
eH2_3                -2.795339e-02 1 1  ON 43
eH2_4                 1.754565e-02 1 1  ON 44
eH2_5                 3.139115e-02 1 1  ON 45
eH2_6                 7.871317e-02 1 1  ON 46
eH2_7                 1.136853e-01 1 1  ON 47
eH2_8                 1.032916e-01 1 1  ON 48
eH2_9                 2.970743e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7178e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2155
    reference variance = 0.134936
====================================================
  Execution time = 2.0265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314631997816
                                         uncertainty =       0.002811047213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314631997816
                                         uncertainty =       0.002811047213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396577158
  error estimate for blocks of size 2^( 2) =       0.000406475366
  error estimate for blocks of size 2^( 3) =       0.000415203333
  error estimate for blocks of size 2^( 4) =       0.000421744649
  error estimate for blocks of size 2^( 5) =       0.000425538504
  error estimate for blocks of size 2^( 6) =       0.000427564029
  error estimate for blocks of size 2^( 7) =       0.000428894623

      target function =                  N/A
              le_mean =     -17.216749298190
             les_mean =     296.731003124419
             stat err =       0.000425935451
             autocorr =       1.153538738789
              std dev =       0.560844795793
             le_variance =       0.314546884968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674929819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749298190       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749817541       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216750142786       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216753456364       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216752738194       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216752433150       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216753018553       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216753030929       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216755838796       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216755329192       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216754768265       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216754953125       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.068086e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749298190       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749605063       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216749870397       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216751842130       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216751258148       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216750811874       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216751072674       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216751221785       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216751752708       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216751574919       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.680990e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749298190       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749414584       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216749551442       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216750195570       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216749997734       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216749865503       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216749919786       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216749960448       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.777418e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5775e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.158248e-01 1 1  ON 0
 uu_1                 5.300583e-02 1 1  ON 1
 uu_2                -4.297848e-02 1 1  ON 2
 uu_3                -9.919960e-02 1 1  ON 3
 uu_4                -1.341688e-01 1 1  ON 4
 uu_5                -1.426980e-01 1 1  ON 5
 uu_6                -1.216019e-01 1 1  ON 6
 uu_7                -5.124295e-02 1 1  ON 7
 uu_8                 9.068580e-02 1 1  ON 8
 uu_9                 1.291027e-01 1 1  ON 9
 ud_0                 3.573594e-01 1 1  ON 10
 ud_1                 9.773837e-02 1 1  ON 11
 ud_2                -1.362207e-02 1 1  ON 12
 ud_3                -7.571319e-02 1 1  ON 13
 ud_4                -1.238692e-01 1 1  ON 14
 ud_5                -1.561578e-01 1 1  ON 15
 ud_6                -1.583042e-01 1 1  ON 16
 ud_7                -1.135112e-01 1 1  ON 17
 ud_8                -8.401700e-03 1 1  ON 18
 ud_9                 9.294121e-02 1 1  ON 19
 eO_0                -7.931632e-01 1 1  ON 20
 eO_1                -4.693221e-01 1 1  ON 21
 eO_2                -5.433530e-02 1 1  ON 22
 eO_3                 2.096097e-01 1 1  ON 23
 eO_4                 3.136330e-01 1 1  ON 24
 eO_5                 3.332981e-01 1 1  ON 25
 eO_6                 2.680294e-01 1 1  ON 26
 eO_7                 1.300574e-01 1 1  ON 27
 eO_8                 3.098008e-02 1 1  ON 28
 eO_9                 1.945933e-02 1 1  ON 29
eH1_0                -1.848515e-01 1 1  ON 30
eH1_1                -1.056893e-01 1 1  ON 31
eH1_2                -6.391110e-02 1 1  ON 32
eH1_3                -2.645585e-02 1 1  ON 33
eH1_4                 1.848355e-02 1 1  ON 34
eH1_5                 3.106907e-02 1 1  ON 35
eH1_6                 7.646851e-02 1 1  ON 36
eH1_7                 1.100126e-01 1 1  ON 37
eH1_8                 1.006649e-01 1 1  ON 38
eH1_9                 2.765032e-02 1 1  ON 39
eH2_0                -1.869436e-01 1 1  ON 40
eH2_1                -1.073894e-01 1 1  ON 41
eH2_2                -6.553159e-02 1 1  ON 42
eH2_3                -2.778370e-02 1 1  ON 43
eH2_4                 1.763893e-02 1 1  ON 44
eH2_5                 3.104187e-02 1 1  ON 45
eH2_6                 7.857367e-02 1 1  ON 46
eH2_7                 1.137351e-01 1 1  ON 47
eH2_8                 1.035840e-01 1 1  ON 48
eH2_9                 2.979889e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.143487
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2039e-01
  Total weights = 2.0000e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320129310657
                                         uncertainty =       0.002465047421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320129310657
                                         uncertainty =       0.002465047421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400089614
  error estimate for blocks of size 2^( 2) =       0.000410259655
  error estimate for blocks of size 2^( 3) =       0.000418815268
  error estimate for blocks of size 2^( 4) =       0.000425316352
  error estimate for blocks of size 2^( 5) =       0.000429015049
  error estimate for blocks of size 2^( 6) =       0.000432310540
  error estimate for blocks of size 2^( 7) =       0.000432600664

      target function =                  N/A
              le_mean =     -17.216702173611
             les_mean =     296.734976973460
             stat err =       0.000429810651
             autocorr =       1.154090302855
              std dev =       0.565812158507
             le_variance =       0.320143398714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606584485
                                         uncertainty =       0.002469209099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320606584485
                                         uncertainty =       0.002469209099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400387511
  error estimate for blocks of size 2^( 2) =       0.000410539452
  error estimate for blocks of size 2^( 3) =       0.000419074978
  error estimate for blocks of size 2^( 4) =       0.000425562010
  error estimate for blocks of size 2^( 5) =       0.000429256403
  error estimate for blocks of size 2^( 6) =       0.000432551746
  error estimate for blocks of size 2^( 7) =       0.000432860300

      target function =                  N/A
              le_mean =     -17.216700886798
             les_mean =     296.735409583820
             stat err =       0.000430057615
             autocorr =       1.153698260684
              std dev =       0.566233448908
             le_variance =       0.320620318663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320621946791
                                         uncertainty =       0.002469005637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320621946791
                                         uncertainty =       0.002469005637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400397035
  error estimate for blocks of size 2^( 2) =       0.000410548518
  error estimate for blocks of size 2^( 3) =       0.000419083822
  error estimate for blocks of size 2^( 4) =       0.000425573084
  error estimate for blocks of size 2^( 5) =       0.000429266319
  error estimate for blocks of size 2^( 6) =       0.000432558081
  error estimate for blocks of size 2^( 7) =       0.000432873197

      target function =                  N/A
              le_mean =     -17.216701171860
             les_mean =     296.735434651935
             stat err =       0.000430067670
             autocorr =       1.153697328392
              std dev =       0.566246917111
             le_variance =       0.320635571137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320232681605
                                         uncertainty =       0.002465848463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320232681605
                                         uncertainty =       0.002465848463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400154134
  error estimate for blocks of size 2^( 2) =       0.000410320095
  error estimate for blocks of size 2^( 3) =       0.000418871229
  error estimate for blocks of size 2^( 4) =       0.000425369849
  error estimate for blocks of size 2^( 5) =       0.000429067208
  error estimate for blocks of size 2^( 6) =       0.000432361684
  error estimate for blocks of size 2^( 7) =       0.000432657194

      target function =                  N/A
              le_mean =     -17.216701694760
             les_mean =     296.735063748077
             stat err =       0.000429863984
             autocorr =       1.154004500111
              std dev =       0.565903403274
             le_variance =       0.320246661837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216702173611        initial  <--
     6.2500e-02     6.2500e-01             3.0681e-03       -17.216700886798
     2.5000e-01     2.5000e+00             9.6810e-04       -17.216701171860
     1.0000e+00     1.0000e+01             2.7774e-04       -17.216701694760

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0461
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.158680e-01 1 1  ON 0
 uu_1                 5.283222e-02 1 1  ON 1
 uu_2                -4.310529e-02 1 1  ON 2
 uu_3                -9.925465e-02 1 1  ON 3
 uu_4                -1.340805e-01 1 1  ON 4
 uu_5                -1.427485e-01 1 1  ON 5
 uu_6                -1.215475e-01 1 1  ON 6
 uu_7                -5.091711e-02 1 1  ON 7
 uu_8                 9.108919e-02 1 1  ON 8
 uu_9                 1.289344e-01 1 1  ON 9
 ud_0                 3.569549e-01 1 1  ON 10
 ud_1                 9.758093e-02 1 1  ON 11
 ud_2                -1.368481e-02 1 1  ON 12
 ud_3                -7.561155e-02 1 1  ON 13
 ud_4                -1.240527e-01 1 1  ON 14
 ud_5                -1.562960e-01 1 1  ON 15
 ud_6                -1.581134e-01 1 1  ON 16
 ud_7                -1.130493e-01 1 1  ON 17
 ud_8                -7.944804e-03 1 1  ON 18
 ud_9                 9.296733e-02 1 1  ON 19
 eO_0                -7.921951e-01 1 1  ON 20
 eO_1                -4.687173e-01 1 1  ON 21
 eO_2                -5.400959e-02 1 1  ON 22
 eO_3                 2.093818e-01 1 1  ON 23
 eO_4                 3.135519e-01 1 1  ON 24
 eO_5                 3.327761e-01 1 1  ON 25
 eO_6                 2.675157e-01 1 1  ON 26
 eO_7                 1.296285e-01 1 1  ON 27
 eO_8                 3.093307e-02 1 1  ON 28
 eO_9                 1.942684e-02 1 1  ON 29
eH1_0                -1.849426e-01 1 1  ON 30
eH1_1                -1.054790e-01 1 1  ON 31
eH1_2                -6.390575e-02 1 1  ON 32
eH1_3                -2.668832e-02 1 1  ON 33
eH1_4                 1.854097e-02 1 1  ON 34
eH1_5                 3.114879e-02 1 1  ON 35
eH1_6                 7.669235e-02 1 1  ON 36
eH1_7                 1.100527e-01 1 1  ON 37
eH1_8                 1.004563e-01 1 1  ON 38
eH1_9                 2.761688e-02 1 1  ON 39
eH2_0                -1.866604e-01 1 1  ON 40
eH2_1                -1.074597e-01 1 1  ON 41
eH2_2                -6.552062e-02 1 1  ON 42
eH2_3                -2.795339e-02 1 1  ON 43
eH2_4                 1.754565e-02 1 1  ON 44
eH2_5                 3.139115e-02 1 1  ON 45
eH2_6                 7.871317e-02 1 1  ON 46
eH2_7                 1.136853e-01 1 1  ON 47
eH2_8                 1.032916e-01 1 1  ON 48
eH2_9                 2.970743e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2704
    reference variance = 0.287189
====================================================
  Execution time = 2.0809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320201717531
                                         uncertainty =       0.004520938169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320201717531
                                         uncertainty =       0.004520938169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400066996
  error estimate for blocks of size 2^( 2) =       0.000409589354
  error estimate for blocks of size 2^( 3) =       0.000418372292
  error estimate for blocks of size 2^( 4) =       0.000424840242
  error estimate for blocks of size 2^( 5) =       0.000429058433
  error estimate for blocks of size 2^( 6) =       0.000432603387
  error estimate for blocks of size 2^( 7) =       0.000433284392

      target function =                  N/A
              le_mean =     -17.216120279849
             les_mean =     296.714904532446
             stat err =       0.000429946613
             autocorr =       1.154951148001
              std dev =       0.565780171345
             le_variance =       0.320107202287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612027985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120279849       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120891569       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216121310228       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216122065944       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216121735635       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216121801234       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216121812517       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216121817408       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216121902278       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.311262e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120279849       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120461915       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120565500       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216120837807       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216120824099       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216120764849       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216120736339       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216120746483       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.108503e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216120279849       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216120327642       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120352992       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216120422998       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216120427443       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216120413617       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216120402970       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.802386e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6409e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.158875e-01 1 1  ON 0
 uu_1                 5.285494e-02 1 1  ON 1
 uu_2                -4.312016e-02 1 1  ON 2
 uu_3                -9.926184e-02 1 1  ON 3
 uu_4                -1.341093e-01 1 1  ON 4
 uu_5                -1.427493e-01 1 1  ON 5
 uu_6                -1.215343e-01 1 1  ON 6
 uu_7                -5.092251e-02 1 1  ON 7
 uu_8                 9.105615e-02 1 1  ON 8
 uu_9                 1.289459e-01 1 1  ON 9
 ud_0                 3.570219e-01 1 1  ON 10
 ud_1                 9.762096e-02 1 1  ON 11
 ud_2                -1.371266e-02 1 1  ON 12
 ud_3                -7.563602e-02 1 1  ON 13
 ud_4                -1.240755e-01 1 1  ON 14
 ud_5                -1.562979e-01 1 1  ON 15
 ud_6                -1.581235e-01 1 1  ON 16
 ud_7                -1.130495e-01 1 1  ON 17
 ud_8                -7.982035e-03 1 1  ON 18
 ud_9                 9.296406e-02 1 1  ON 19
 eO_0                -7.923060e-01 1 1  ON 20
 eO_1                -4.688242e-01 1 1  ON 21
 eO_2                -5.395981e-02 1 1  ON 22
 eO_3                 2.093899e-01 1 1  ON 23
 eO_4                 3.135274e-01 1 1  ON 24
 eO_5                 3.328424e-01 1 1  ON 25
 eO_6                 2.675735e-01 1 1  ON 26
 eO_7                 1.296786e-01 1 1  ON 27
 eO_8                 3.093834e-02 1 1  ON 28
 eO_9                 1.942937e-02 1 1  ON 29
eH1_0                -1.849291e-01 1 1  ON 30
eH1_1                -1.054841e-01 1 1  ON 31
eH1_2                -6.390906e-02 1 1  ON 32
eH1_3                -2.668126e-02 1 1  ON 33
eH1_4                 1.850871e-02 1 1  ON 34
eH1_5                 3.113344e-02 1 1  ON 35
eH1_6                 7.668732e-02 1 1  ON 36
eH1_7                 1.100561e-01 1 1  ON 37
eH1_8                 1.004839e-01 1 1  ON 38
eH1_9                 2.762475e-02 1 1  ON 39
eH2_0                -1.866742e-01 1 1  ON 40
eH2_1                -1.074246e-01 1 1  ON 41
eH2_2                -6.552567e-02 1 1  ON 42
eH2_3                -2.795589e-02 1 1  ON 43
eH2_4                 1.750904e-02 1 1  ON 44
eH2_5                 3.138447e-02 1 1  ON 45
eH2_6                 7.871538e-02 1 1  ON 46
eH2_7                 1.136768e-01 1 1  ON 47
eH2_8                 1.033181e-01 1 1  ON 48
eH2_9                 2.971418e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.134162
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1981e-01
  Total weights = 2.0000e+06
  Execution time = 1.8401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319390673570
                                         uncertainty =       0.003914022325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319390673570
                                         uncertainty =       0.003914022325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399835096
  error estimate for blocks of size 2^( 2) =       0.000409622415
  error estimate for blocks of size 2^( 3) =       0.000418365951
  error estimate for blocks of size 2^( 4) =       0.000424767828
  error estimate for blocks of size 2^( 5) =       0.000427950468
  error estimate for blocks of size 2^( 6) =       0.000431060059
  error estimate for blocks of size 2^( 7) =       0.000432682177

      target function =                  N/A
              le_mean =     -17.216917156396
             les_mean =     296.741972418354
             stat err =       0.000429115133
             autocorr =       1.151823239500
              std dev =       0.565452215502
             le_variance =       0.319736208016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319634620530
                                         uncertainty =       0.003914204455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319634620530
                                         uncertainty =       0.003914204455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399987914
  error estimate for blocks of size 2^( 2) =       0.000409768397
  error estimate for blocks of size 2^( 3) =       0.000418504274
  error estimate for blocks of size 2^( 4) =       0.000424899550
  error estimate for blocks of size 2^( 5) =       0.000428078178
  error estimate for blocks of size 2^( 6) =       0.000431182294
  error estimate for blocks of size 2^( 7) =       0.000432801242

      target function =                  N/A
              le_mean =     -17.216918365918
             les_mean =     296.742258520783
             stat err =       0.000429240316
             autocorr =       1.151614898654
              std dev =       0.565668332227
             le_variance =       0.319980662084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547108423
                                         uncertainty =       0.003914089226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547108423
                                         uncertainty =       0.003914089226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399933107
  error estimate for blocks of size 2^( 2) =       0.000409715859
  error estimate for blocks of size 2^( 3) =       0.000418454616
  error estimate for blocks of size 2^( 4) =       0.000424852312
  error estimate for blocks of size 2^( 5) =       0.000428032382
  error estimate for blocks of size 2^( 6) =       0.000431138139
  error estimate for blocks of size 2^( 7) =       0.000432758594

      target function =                  N/A
              le_mean =     -17.216917839621
             les_mean =     296.742152716148
             stat err =       0.000429195357
             autocorr =       1.151689258670
              std dev =       0.565590823679
             le_variance =       0.319892979830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319411548264
                                         uncertainty =       0.003914032779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319411548264
                                         uncertainty =       0.003914032779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399848177
  error estimate for blocks of size 2^( 2) =       0.000409634874
  error estimate for blocks of size 2^( 3) =       0.000418377793
  error estimate for blocks of size 2^( 4) =       0.000424779127
  error estimate for blocks of size 2^( 5) =       0.000427961432
  error estimate for blocks of size 2^( 6) =       0.000431070484
  error estimate for blocks of size 2^( 7) =       0.000432692424

      target function =                  N/A
              le_mean =     -17.216917238317
             les_mean =     296.741996160516
             stat err =       0.000429125867
             autocorr =       1.151805496961
              std dev =       0.565470714849
             le_variance =       0.319757129352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216917156396        initial
     6.2500e-01     6.2500e+00             4.3113e-04       -17.216918365918  <--
     2.5000e+00     2.5000e+01             1.1085e-04       -17.216917839621
     1.0000e+01     1.0000e+02             2.8024e-05       -17.216917238317

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9436e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.159401e-01 1 1  ON 0
 uu_1                 5.289862e-02 1 1  ON 1
 uu_2                -4.314545e-02 1 1  ON 2
 uu_3                -9.928646e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214972e-01 1 1  ON 6
 uu_7                -5.093574e-02 1 1  ON 7
 uu_8                 9.095907e-02 1 1  ON 8
 uu_9                 1.289802e-01 1 1  ON 9
 ud_0                 3.571749e-01 1 1  ON 10
 ud_1                 9.770874e-02 1 1  ON 11
 ud_2                -1.374845e-02 1 1  ON 12
 ud_3                -7.569643e-02 1 1  ON 13
 ud_4                -1.241301e-01 1 1  ON 14
 ud_5                -1.563079e-01 1 1  ON 15
 ud_6                -1.581489e-01 1 1  ON 16
 ud_7                -1.130468e-01 1 1  ON 17
 ud_8                -8.091242e-03 1 1  ON 18
 ud_9                 9.295464e-02 1 1  ON 19
 eO_0                -7.926262e-01 1 1  ON 20
 eO_1                -4.690912e-01 1 1  ON 21
 eO_2                -5.388998e-02 1 1  ON 22
 eO_3                 2.094282e-01 1 1  ON 23
 eO_4                 3.134568e-01 1 1  ON 24
 eO_5                 3.330383e-01 1 1  ON 25
 eO_6                 2.677475e-01 1 1  ON 26
 eO_7                 1.298284e-01 1 1  ON 27
 eO_8                 3.095412e-02 1 1  ON 28
 eO_9                 1.943692e-02 1 1  ON 29
eH1_0                -1.849006e-01 1 1  ON 30
eH1_1                -1.054939e-01 1 1  ON 31
eH1_2                -6.391664e-02 1 1  ON 32
eH1_3                -2.666983e-02 1 1  ON 33
eH1_4                 1.842421e-02 1 1  ON 34
eH1_5                 3.108960e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100671e-01 1 1  ON 37
eH1_8                 1.005663e-01 1 1  ON 38
eH1_9                 2.764826e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.073495e-01 1 1  ON 41
eH2_2                -6.553322e-02 1 1  ON 42
eH2_3                -2.796080e-02 1 1  ON 43
eH2_4                 1.741207e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872170e-02 1 1  ON 46
eH2_7                 1.136527e-01 1 1  ON 47
eH2_8                 1.033973e-01 1 1  ON 48
eH2_9                 2.973432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5859e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.166048
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325668091214
                                         uncertainty =       0.006740010000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325668091214
                                         uncertainty =       0.006740010000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403466184
  error estimate for blocks of size 2^( 2) =       0.000413291348
  error estimate for blocks of size 2^( 3) =       0.000422144231
  error estimate for blocks of size 2^( 4) =       0.000428208679
  error estimate for blocks of size 2^( 5) =       0.000432859571
  error estimate for blocks of size 2^( 6) =       0.000433943745
  error estimate for blocks of size 2^( 7) =       0.000434662966

      target function =                  N/A
              le_mean =     -17.216655303424
             les_mean =     296.738789598183
             stat err =       0.000432418740
             autocorr =       1.148668553193
              std dev =       0.570587350073
             le_variance =       0.325569924063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665530342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655303424       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216656455046       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216657917767       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216657672578       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658466516       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216659049459       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216659401191       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216659223628       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216659480558       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216659545908       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.240662e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655303424       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216655801289       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216656691189       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216656596949       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216656959638       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216657283611       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216657250576       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216657187356       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.387546e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655303424       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216655455642       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216655781176       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216655758454       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216655872361       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216655975336       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216655950326       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.945652e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6266e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.157890e-01 1 1  ON 0
 uu_1                 5.277908e-02 1 1  ON 1
 uu_2                -4.307687e-02 1 1  ON 2
 uu_3                -9.924478e-02 1 1  ON 3
 uu_4                -1.342008e-01 1 1  ON 4
 uu_5                -1.427648e-01 1 1  ON 5
 uu_6                -1.213635e-01 1 1  ON 6
 uu_7                -5.093929e-02 1 1  ON 7
 uu_8                 9.087539e-02 1 1  ON 8
 uu_9                 1.290483e-01 1 1  ON 9
 ud_0                 3.573438e-01 1 1  ON 10
 ud_1                 9.771549e-02 1 1  ON 11
 ud_2                -1.373249e-02 1 1  ON 12
 ud_3                -7.574518e-02 1 1  ON 13
 ud_4                -1.241650e-01 1 1  ON 14
 ud_5                -1.563618e-01 1 1  ON 15
 ud_6                -1.581443e-01 1 1  ON 16
 ud_7                -1.130429e-01 1 1  ON 17
 ud_8                -8.209404e-03 1 1  ON 18
 ud_9                 9.293635e-02 1 1  ON 19
 eO_0                -7.929650e-01 1 1  ON 20
 eO_1                -4.693074e-01 1 1  ON 21
 eO_2                -5.411319e-02 1 1  ON 22
 eO_3                 2.094374e-01 1 1  ON 23
 eO_4                 3.135234e-01 1 1  ON 24
 eO_5                 3.332551e-01 1 1  ON 25
 eO_6                 2.679938e-01 1 1  ON 26
 eO_7                 1.300273e-01 1 1  ON 27
 eO_8                 3.098471e-02 1 1  ON 28
 eO_9                 1.944316e-02 1 1  ON 29
eH1_0                -1.848118e-01 1 1  ON 30
eH1_1                -1.057110e-01 1 1  ON 31
eH1_2                -6.396353e-02 1 1  ON 32
eH1_3                -2.659618e-02 1 1  ON 33
eH1_4                 1.840970e-02 1 1  ON 34
eH1_5                 3.107599e-02 1 1  ON 35
eH1_6                 7.664368e-02 1 1  ON 36
eH1_7                 1.100749e-01 1 1  ON 37
eH1_8                 1.006790e-01 1 1  ON 38
eH1_9                 2.767867e-02 1 1  ON 39
eH2_0                -1.867295e-01 1 1  ON 40
eH2_1                -1.073948e-01 1 1  ON 41
eH2_2                -6.552425e-02 1 1  ON 42
eH2_3                -2.800428e-02 1 1  ON 43
eH2_4                 1.738363e-02 1 1  ON 44
eH2_5                 3.133286e-02 1 1  ON 45
eH2_6                 7.873765e-02 1 1  ON 46
eH2_7                 1.136712e-01 1 1  ON 47
eH2_8                 1.034964e-01 1 1  ON 48
eH2_9                 2.975721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1411
    reference variance = 0.268326
====================================================
  Execution time = 2.0084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1990e-01
  Total weights = 2.0000e+06
  Execution time = 1.8344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319839794420
                                         uncertainty =       0.003439450206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319839794420
                                         uncertainty =       0.003439450206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399898239
  error estimate for blocks of size 2^( 2) =       0.000409322899
  error estimate for blocks of size 2^( 3) =       0.000417270488
  error estimate for blocks of size 2^( 4) =       0.000423098042
  error estimate for blocks of size 2^( 5) =       0.000427175165
  error estimate for blocks of size 2^( 6) =       0.000427650074
  error estimate for blocks of size 2^( 7) =       0.000426660069

      target function =                  N/A
              le_mean =     -17.216710976352
             les_mean =     296.734973886532
             stat err =       0.000426145837
             autocorr =       1.135579431573
              std dev =       0.565541513252
             le_variance =       0.319837203211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319984200427
                                         uncertainty =       0.003441674421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319984200427
                                         uncertainty =       0.003441674421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399988242
  error estimate for blocks of size 2^( 2) =       0.000409406282
  error estimate for blocks of size 2^( 3) =       0.000417347911
  error estimate for blocks of size 2^( 4) =       0.000423171554
  error estimate for blocks of size 2^( 5) =       0.000427234450
  error estimate for blocks of size 2^( 6) =       0.000427712408
  error estimate for blocks of size 2^( 7) =       0.000426716511

      target function =                  N/A
              le_mean =     -17.216710527314
             les_mean =     296.735102408474
             stat err =       0.000426208731
             autocorr =       1.135403514798
              std dev =       0.565668796323
             le_variance =       0.319981187133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319960133313
                                         uncertainty =       0.003441804569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319960133313
                                         uncertainty =       0.003441804569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399973229
  error estimate for blocks of size 2^( 2) =       0.000409392050
  error estimate for blocks of size 2^( 3) =       0.000417335195
  error estimate for blocks of size 2^( 4) =       0.000423159857
  error estimate for blocks of size 2^( 5) =       0.000427224859
  error estimate for blocks of size 2^( 6) =       0.000427703239
  error estimate for blocks of size 2^( 7) =       0.000426707458

      target function =                  N/A
              le_mean =     -17.216710236515
             les_mean =     296.735068375404
             stat err =       0.000426198853
             autocorr =       1.135436122388
              std dev =       0.565647564543
             le_variance =       0.319957167274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319862536101
                                         uncertainty =       0.003439910143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319862536101
                                         uncertainty =       0.003439910143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399912419
  error estimate for blocks of size 2^( 2) =       0.000409336076
  error estimate for blocks of size 2^( 3) =       0.000417282889
  error estimate for blocks of size 2^( 4) =       0.000423109964
  error estimate for blocks of size 2^( 5) =       0.000427185037
  error estimate for blocks of size 2^( 6) =       0.000427660475
  error estimate for blocks of size 2^( 7) =       0.000426669349

      target function =                  N/A
              le_mean =     -17.216710732919
             les_mean =     296.734988187070
             stat err =       0.000426156206
             autocorr =       1.135554158465
              std dev =       0.565561566918
             le_variance =       0.319859885975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216710976352        initial  <--
     1.5625e-01     1.5625e+00             1.2407e-03       -17.216710527314
     6.2500e-01     6.2500e+00             3.3875e-04       -17.216710236515
     2.5000e+00     2.5000e+01             8.9457e-05       -17.216710732919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4362
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.159401e-01 1 1  ON 0
 uu_1                 5.289862e-02 1 1  ON 1
 uu_2                -4.314545e-02 1 1  ON 2
 uu_3                -9.928646e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214972e-01 1 1  ON 6
 uu_7                -5.093574e-02 1 1  ON 7
 uu_8                 9.095907e-02 1 1  ON 8
 uu_9                 1.289802e-01 1 1  ON 9
 ud_0                 3.571749e-01 1 1  ON 10
 ud_1                 9.770874e-02 1 1  ON 11
 ud_2                -1.374845e-02 1 1  ON 12
 ud_3                -7.569643e-02 1 1  ON 13
 ud_4                -1.241301e-01 1 1  ON 14
 ud_5                -1.563079e-01 1 1  ON 15
 ud_6                -1.581489e-01 1 1  ON 16
 ud_7                -1.130468e-01 1 1  ON 17
 ud_8                -8.091242e-03 1 1  ON 18
 ud_9                 9.295464e-02 1 1  ON 19
 eO_0                -7.926262e-01 1 1  ON 20
 eO_1                -4.690912e-01 1 1  ON 21
 eO_2                -5.388998e-02 1 1  ON 22
 eO_3                 2.094282e-01 1 1  ON 23
 eO_4                 3.134568e-01 1 1  ON 24
 eO_5                 3.330383e-01 1 1  ON 25
 eO_6                 2.677475e-01 1 1  ON 26
 eO_7                 1.298284e-01 1 1  ON 27
 eO_8                 3.095412e-02 1 1  ON 28
 eO_9                 1.943692e-02 1 1  ON 29
eH1_0                -1.849006e-01 1 1  ON 30
eH1_1                -1.054939e-01 1 1  ON 31
eH1_2                -6.391664e-02 1 1  ON 32
eH1_3                -2.666983e-02 1 1  ON 33
eH1_4                 1.842421e-02 1 1  ON 34
eH1_5                 3.108960e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100671e-01 1 1  ON 37
eH1_8                 1.005663e-01 1 1  ON 38
eH1_9                 2.764826e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.073495e-01 1 1  ON 41
eH2_2                -6.553322e-02 1 1  ON 42
eH2_3                -2.796080e-02 1 1  ON 43
eH2_4                 1.741207e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872170e-02 1 1  ON 46
eH2_7                 1.136527e-01 1 1  ON 47
eH2_8                 1.033973e-01 1 1  ON 48
eH2_9                 2.973432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.297968
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1316e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153142139
                                         uncertainty =       0.002818356692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313153142139
                                         uncertainty =       0.002818356692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395702394
  error estimate for blocks of size 2^( 2) =       0.000405351464
  error estimate for blocks of size 2^( 3) =       0.000414159418
  error estimate for blocks of size 2^( 4) =       0.000420338709
  error estimate for blocks of size 2^( 5) =       0.000424370147
  error estimate for blocks of size 2^( 6) =       0.000426514683
  error estimate for blocks of size 2^( 7) =       0.000427033585

      target function =                  N/A
              le_mean =     -17.216524372624
             les_mean =     296.721872086271
             stat err =       0.000424564281
             autocorr =       1.151196740680
              std dev =       0.559607692660
             le_variance =       0.313160769685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652437262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524372624       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524359092       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216523900526       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524116943       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216524143205       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216524039943       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216524147730       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216524136064       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.331085e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524372624       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524368966       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216524234263       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524301772       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216524316833       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216524294297       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216524314828       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.289893e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524372624       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524371691       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216524336484       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524354449       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216524358946       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216524353775       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216524358180       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.232245e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6481e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.159226e-01 1 1  ON 0
 uu_1                 5.289604e-02 1 1  ON 1
 uu_2                -4.313574e-02 1 1  ON 2
 uu_3                -9.928536e-02 1 1  ON 3
 uu_4                -1.341682e-01 1 1  ON 4
 uu_5                -1.427754e-01 1 1  ON 5
 uu_6                -1.214951e-01 1 1  ON 6
 uu_7                -5.093427e-02 1 1  ON 7
 uu_8                 9.095065e-02 1 1  ON 8
 uu_9                 1.289891e-01 1 1  ON 9
 ud_0                 3.572035e-01 1 1  ON 10
 ud_1                 9.769928e-02 1 1  ON 11
 ud_2                -1.374367e-02 1 1  ON 12
 ud_3                -7.571653e-02 1 1  ON 13
 ud_4                -1.241122e-01 1 1  ON 14
 ud_5                -1.563234e-01 1 1  ON 15
 ud_6                -1.581516e-01 1 1  ON 16
 ud_7                -1.130526e-01 1 1  ON 17
 ud_8                -8.103164e-03 1 1  ON 18
 ud_9                 9.295795e-02 1 1  ON 19
 eO_0                -7.926591e-01 1 1  ON 20
 eO_1                -4.691194e-01 1 1  ON 21
 eO_2                -5.389630e-02 1 1  ON 22
 eO_3                 2.094168e-01 1 1  ON 23
 eO_4                 3.134657e-01 1 1  ON 24
 eO_5                 3.330595e-01 1 1  ON 25
 eO_6                 2.677672e-01 1 1  ON 26
 eO_7                 1.298492e-01 1 1  ON 27
 eO_8                 3.095933e-02 1 1  ON 28
 eO_9                 1.943862e-02 1 1  ON 29
eH1_0                -1.849123e-01 1 1  ON 30
eH1_1                -1.054864e-01 1 1  ON 31
eH1_2                -6.391395e-02 1 1  ON 32
eH1_3                -2.668566e-02 1 1  ON 33
eH1_4                 1.842396e-02 1 1  ON 34
eH1_5                 3.109301e-02 1 1  ON 35
eH1_6                 7.666929e-02 1 1  ON 36
eH1_7                 1.100663e-01 1 1  ON 37
eH1_8                 1.005778e-01 1 1  ON 38
eH1_9                 2.765257e-02 1 1  ON 39
eH2_0                -1.867202e-01 1 1  ON 40
eH2_1                -1.073418e-01 1 1  ON 41
eH2_2                -6.552998e-02 1 1  ON 42
eH2_3                -2.797460e-02 1 1  ON 43
eH2_4                 1.741206e-02 1 1  ON 44
eH2_5                 3.135997e-02 1 1  ON 45
eH2_6                 7.872138e-02 1 1  ON 46
eH2_7                 1.136538e-01 1 1  ON 47
eH2_8                 1.034073e-01 1 1  ON 48
eH2_9                 2.973911e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1468
    reference variance = 0.172812
====================================================
  Execution time = 2.2584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1547e-01
  Total weights = 2.0000e+06
  Execution time = 1.8399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315529533964
                                         uncertainty =       0.003341232861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315529533964
                                         uncertainty =       0.003341232861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397146972
  error estimate for blocks of size 2^( 2) =       0.000406737910
  error estimate for blocks of size 2^( 3) =       0.000415429993
  error estimate for blocks of size 2^( 4) =       0.000421898968
  error estimate for blocks of size 2^( 5) =       0.000425929668
  error estimate for blocks of size 2^( 6) =       0.000426871821
  error estimate for blocks of size 2^( 7) =       0.000427230982

      target function =                  N/A
              le_mean =     -17.216587943207
             les_mean =     296.726351682550
             stat err =       0.000425482860
             autocorr =       1.147787863811
              std dev =       0.561650633493
             le_variance =       0.315451434103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315570266013
                                         uncertainty =       0.003341736553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315570266013
                                         uncertainty =       0.003341736553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397172597
  error estimate for blocks of size 2^( 2) =       0.000406762398
  error estimate for blocks of size 2^( 3) =       0.000415453469
  error estimate for blocks of size 2^( 4) =       0.000421922075
  error estimate for blocks of size 2^( 5) =       0.000425951933
  error estimate for blocks of size 2^( 6) =       0.000426894002
  error estimate for blocks of size 2^( 7) =       0.000427256135

      target function =                  N/A
              le_mean =     -17.216587646286
             les_mean =     296.726382168403
             stat err =       0.000425506036
             autocorr =       1.147764789167
              std dev =       0.561686873541
             le_variance =       0.315492143908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315557254662
                                         uncertainty =       0.003341561562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315557254662
                                         uncertainty =       0.003341561562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397164411
  error estimate for blocks of size 2^( 2) =       0.000406754589
  error estimate for blocks of size 2^( 3) =       0.000415446044
  error estimate for blocks of size 2^( 4) =       0.000421914846
  error estimate for blocks of size 2^( 5) =       0.000425944959
  error estimate for blocks of size 2^( 6) =       0.000426887208
  error estimate for blocks of size 2^( 7) =       0.000427248246

      target function =                  N/A
              le_mean =     -17.216587704074
             les_mean =     296.726371152741
             stat err =       0.000425498815
             autocorr =       1.147773144705
              std dev =       0.561675296243
             le_variance =       0.315479138409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315533090286
                                         uncertainty =       0.003341274949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315533090286
                                         uncertainty =       0.003341274949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397149209
  error estimate for blocks of size 2^( 2) =       0.000406740050
  error estimate for blocks of size 2^( 3) =       0.000415432053
  error estimate for blocks of size 2^( 4) =       0.000421901010
  error estimate for blocks of size 2^( 5) =       0.000425931631
  error estimate for blocks of size 2^( 6) =       0.000426873802
  error estimate for blocks of size 2^( 7) =       0.000427233213

      target function =                  N/A
              le_mean =     -17.216587909485
             les_mean =     296.726354075562
             stat err =       0.000425484914
             autocorr =       1.147786014930
              std dev =       0.561653797526
             le_variance =       0.315454988276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216587943207        initial  <--
     1.5625e+00     1.5625e+01             1.3311e-04       -17.216587646286
     6.2500e+00     6.2500e+01             3.2899e-05       -17.216587704074
     2.5000e+01     2.5000e+02             8.2322e-06       -17.216587909485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8942
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.159401e-01 1 1  ON 0
 uu_1                 5.289862e-02 1 1  ON 1
 uu_2                -4.314545e-02 1 1  ON 2
 uu_3                -9.928646e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214972e-01 1 1  ON 6
 uu_7                -5.093574e-02 1 1  ON 7
 uu_8                 9.095907e-02 1 1  ON 8
 uu_9                 1.289802e-01 1 1  ON 9
 ud_0                 3.571749e-01 1 1  ON 10
 ud_1                 9.770874e-02 1 1  ON 11
 ud_2                -1.374845e-02 1 1  ON 12
 ud_3                -7.569643e-02 1 1  ON 13
 ud_4                -1.241301e-01 1 1  ON 14
 ud_5                -1.563079e-01 1 1  ON 15
 ud_6                -1.581489e-01 1 1  ON 16
 ud_7                -1.130468e-01 1 1  ON 17
 ud_8                -8.091242e-03 1 1  ON 18
 ud_9                 9.295464e-02 1 1  ON 19
 eO_0                -7.926262e-01 1 1  ON 20
 eO_1                -4.690912e-01 1 1  ON 21
 eO_2                -5.388998e-02 1 1  ON 22
 eO_3                 2.094282e-01 1 1  ON 23
 eO_4                 3.134568e-01 1 1  ON 24
 eO_5                 3.330383e-01 1 1  ON 25
 eO_6                 2.677475e-01 1 1  ON 26
 eO_7                 1.298284e-01 1 1  ON 27
 eO_8                 3.095412e-02 1 1  ON 28
 eO_9                 1.943692e-02 1 1  ON 29
eH1_0                -1.849006e-01 1 1  ON 30
eH1_1                -1.054939e-01 1 1  ON 31
eH1_2                -6.391664e-02 1 1  ON 32
eH1_3                -2.666983e-02 1 1  ON 33
eH1_4                 1.842421e-02 1 1  ON 34
eH1_5                 3.108960e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100671e-01 1 1  ON 37
eH1_8                 1.005663e-01 1 1  ON 38
eH1_9                 2.764826e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.073495e-01 1 1  ON 41
eH2_2                -6.553322e-02 1 1  ON 42
eH2_3                -2.796080e-02 1 1  ON 43
eH2_4                 1.741207e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872170e-02 1 1  ON 46
eH2_7                 1.136527e-01 1 1  ON 47
eH2_8                 1.033973e-01 1 1  ON 48
eH2_9                 2.973432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8554e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.155837
====================================================
  Execution time = 2.0680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1408e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314156396647
                                         uncertainty =       0.002257655257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314156396647
                                         uncertainty =       0.002257655257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396285810
  error estimate for blocks of size 2^( 2) =       0.000406229237
  error estimate for blocks of size 2^( 3) =       0.000414635269
  error estimate for blocks of size 2^( 4) =       0.000421055401
  error estimate for blocks of size 2^( 5) =       0.000424688414
  error estimate for blocks of size 2^( 6) =       0.000426482564
  error estimate for blocks of size 2^( 7) =       0.000427691127

      target function =                  N/A
              le_mean =     -17.216629211312
             les_mean =     296.726406128768
             stat err =       0.000424979376
             autocorr =       1.150055150006
              std dev =       0.560432766716
             le_variance =       0.314084886009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662921131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629211312       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629204275       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629217269       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629245176       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629261188       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629271583       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629276451       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.311194e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629211312       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629209535       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629212833       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629219930       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629223987       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629226531       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629227796       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.344951e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629211312       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629210867       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629211694       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629213477       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629214494       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629215127       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629215446       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 8.405725e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6420e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.159426e-01 1 1  ON 0
 uu_1                 5.289755e-02 1 1  ON 1
 uu_2                -4.314463e-02 1 1  ON 2
 uu_3                -9.928805e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427638e-01 1 1  ON 5
 uu_6                -1.214968e-01 1 1  ON 6
 uu_7                -5.093642e-02 1 1  ON 7
 uu_8                 9.095799e-02 1 1  ON 8
 uu_9                 1.289809e-01 1 1  ON 9
 ud_0                 3.571771e-01 1 1  ON 10
 ud_1                 9.770671e-02 1 1  ON 11
 ud_2                -1.374773e-02 1 1  ON 12
 ud_3                -7.569977e-02 1 1  ON 13
 ud_4                -1.241304e-01 1 1  ON 14
 ud_5                -1.563069e-01 1 1  ON 15
 ud_6                -1.581486e-01 1 1  ON 16
 ud_7                -1.130460e-01 1 1  ON 17
 ud_8                -8.092075e-03 1 1  ON 18
 ud_9                 9.295483e-02 1 1  ON 19
 eO_0                -7.926292e-01 1 1  ON 20
 eO_1                -4.690940e-01 1 1  ON 21
 eO_2                -5.389110e-02 1 1  ON 22
 eO_3                 2.094279e-01 1 1  ON 23
 eO_4                 3.134566e-01 1 1  ON 24
 eO_5                 3.330408e-01 1 1  ON 25
 eO_6                 2.677497e-01 1 1  ON 26
 eO_7                 1.298304e-01 1 1  ON 27
 eO_8                 3.095444e-02 1 1  ON 28
 eO_9                 1.943712e-02 1 1  ON 29
eH1_0                -1.849002e-01 1 1  ON 30
eH1_1                -1.054949e-01 1 1  ON 31
eH1_2                -6.391816e-02 1 1  ON 32
eH1_3                -2.666967e-02 1 1  ON 33
eH1_4                 1.842584e-02 1 1  ON 34
eH1_5                 3.108851e-02 1 1  ON 35
eH1_6                 7.667113e-02 1 1  ON 36
eH1_7                 1.100671e-01 1 1  ON 37
eH1_8                 1.005676e-01 1 1  ON 38
eH1_9                 2.764859e-02 1 1  ON 39
eH2_0                -1.867107e-01 1 1  ON 40
eH2_1                -1.073494e-01 1 1  ON 41
eH2_2                -6.553289e-02 1 1  ON 42
eH2_3                -2.796063e-02 1 1  ON 43
eH2_4                 1.741296e-02 1 1  ON 44
eH2_5                 3.136456e-02 1 1  ON 45
eH2_6                 7.871957e-02 1 1  ON 46
eH2_7                 1.136527e-01 1 1  ON 47
eH2_8                 1.033986e-01 1 1  ON 48
eH2_9                 2.973465e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2786
    reference variance = 0.713145
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.0000e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327109121113
                                         uncertainty =       0.007156344391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327109121113
                                         uncertainty =       0.007156344391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404368723
  error estimate for blocks of size 2^( 2) =       0.000413919781
  error estimate for blocks of size 2^( 3) =       0.000421974761
  error estimate for blocks of size 2^( 4) =       0.000428848999
  error estimate for blocks of size 2^( 5) =       0.000432482759
  error estimate for blocks of size 2^( 6) =       0.000434779715
  error estimate for blocks of size 2^( 7) =       0.000438639495

      target function =                  N/A
              le_mean =     -17.215638290861
             les_mean =     296.705229725844
             stat err =       0.000433687742
             autocorr =       1.150268381690
              std dev =       0.571863731666
             le_variance =       0.327028127595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327118796016
                                         uncertainty =       0.007156787216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327118796016
                                         uncertainty =       0.007156787216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404374703
  error estimate for blocks of size 2^( 2) =       0.000413925593
  error estimate for blocks of size 2^( 3) =       0.000421980294
  error estimate for blocks of size 2^( 4) =       0.000428854293
  error estimate for blocks of size 2^( 5) =       0.000432488118
  error estimate for blocks of size 2^( 6) =       0.000434784853
  error estimate for blocks of size 2^( 7) =       0.000438644392

      target function =                  N/A
              le_mean =     -17.215638233526
             les_mean =     296.705237425550
             stat err =       0.000433692914
             autocorr =       1.150261791798
              std dev =       0.571872189767
             le_variance =       0.327037801429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327114018151
                                         uncertainty =       0.007156570825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327114018151
                                         uncertainty =       0.007156570825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404371750
  error estimate for blocks of size 2^( 2) =       0.000413922724
  error estimate for blocks of size 2^( 3) =       0.000421977563
  error estimate for blocks of size 2^( 4) =       0.000428851679
  error estimate for blocks of size 2^( 5) =       0.000432485475
  error estimate for blocks of size 2^( 6) =       0.000434782317
  error estimate for blocks of size 2^( 7) =       0.000438641975

      target function =                  N/A
              le_mean =     -17.215638261552
             les_mean =     296.705233613192
             stat err =       0.000433690362
             autocorr =       1.150265055394
              std dev =       0.571868012836
             le_variance =       0.327033024105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327109734936
                                         uncertainty =       0.007156372857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327109734936
                                         uncertainty =       0.007156372857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404369102
  error estimate for blocks of size 2^( 2) =       0.000413920150
  error estimate for blocks of size 2^( 3) =       0.000421975112
  error estimate for blocks of size 2^( 4) =       0.000428849335
  error estimate for blocks of size 2^( 5) =       0.000432483100
  error estimate for blocks of size 2^( 6) =       0.000434780041
  error estimate for blocks of size 2^( 7) =       0.000438639806

      target function =                  N/A
              le_mean =     -17.215638287160
             les_mean =     296.705230212182
             stat err =       0.000433688070
             autocorr =       1.150267964949
              std dev =       0.571864268295
             le_variance =       0.327028741352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215638290861        initial  <--
     1.5625e+01     1.5625e+02             1.3112e-05       -17.215638233526
     6.2500e+01     6.2500e+02             3.3450e-06       -17.215638261552
     2.5000e+02     2.5000e+03             8.4057e-07       -17.215638287160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5610
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.159401e-01 1 1  ON 0
 uu_1                 5.289862e-02 1 1  ON 1
 uu_2                -4.314545e-02 1 1  ON 2
 uu_3                -9.928646e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214972e-01 1 1  ON 6
 uu_7                -5.093574e-02 1 1  ON 7
 uu_8                 9.095907e-02 1 1  ON 8
 uu_9                 1.289802e-01 1 1  ON 9
 ud_0                 3.571749e-01 1 1  ON 10
 ud_1                 9.770874e-02 1 1  ON 11
 ud_2                -1.374845e-02 1 1  ON 12
 ud_3                -7.569643e-02 1 1  ON 13
 ud_4                -1.241301e-01 1 1  ON 14
 ud_5                -1.563079e-01 1 1  ON 15
 ud_6                -1.581489e-01 1 1  ON 16
 ud_7                -1.130468e-01 1 1  ON 17
 ud_8                -8.091242e-03 1 1  ON 18
 ud_9                 9.295464e-02 1 1  ON 19
 eO_0                -7.926262e-01 1 1  ON 20
 eO_1                -4.690912e-01 1 1  ON 21
 eO_2                -5.388998e-02 1 1  ON 22
 eO_3                 2.094282e-01 1 1  ON 23
 eO_4                 3.134568e-01 1 1  ON 24
 eO_5                 3.330383e-01 1 1  ON 25
 eO_6                 2.677475e-01 1 1  ON 26
 eO_7                 1.298284e-01 1 1  ON 27
 eO_8                 3.095412e-02 1 1  ON 28
 eO_9                 1.943692e-02 1 1  ON 29
eH1_0                -1.849006e-01 1 1  ON 30
eH1_1                -1.054939e-01 1 1  ON 31
eH1_2                -6.391664e-02 1 1  ON 32
eH1_3                -2.666983e-02 1 1  ON 33
eH1_4                 1.842421e-02 1 1  ON 34
eH1_5                 3.108960e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100671e-01 1 1  ON 37
eH1_8                 1.005663e-01 1 1  ON 38
eH1_9                 2.764826e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.073495e-01 1 1  ON 41
eH2_2                -6.553322e-02 1 1  ON 42
eH2_3                -2.796080e-02 1 1  ON 43
eH2_4                 1.741207e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872170e-02 1 1  ON 46
eH2_7                 1.136527e-01 1 1  ON 47
eH2_8                 1.033973e-01 1 1  ON 48
eH2_9                 2.973432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.26702
====================================================
  Execution time = 2.0262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770738229
                                         uncertainty =       0.004775774851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323770738229
                                         uncertainty =       0.004775774851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387661
  error estimate for blocks of size 2^( 2) =       0.000412326075
  error estimate for blocks of size 2^( 3) =       0.000420792219
  error estimate for blocks of size 2^( 4) =       0.000427813302
  error estimate for blocks of size 2^( 5) =       0.000432307985
  error estimate for blocks of size 2^( 6) =       0.000434909840
  error estimate for blocks of size 2^( 7) =       0.000437699680

      target function =                  N/A
              le_mean =     -17.216676073274
             les_mean =     296.737766509396
             stat err =       0.000433182701
             autocorr =       1.158918515224
              std dev =       0.569062087360
             le_variance =       0.323831659271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667607327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216676073274       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216676072253       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216676077748       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216676079955       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216676077725       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216676077989       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216676077879       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.402864e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216676073274       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216676073018       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216676074394       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216676074946       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216676074389       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216676074454       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216676074427       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.507677e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216676073274       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216676073210       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216676073554       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216676073692       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216676073553       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216676073569       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216676073561       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 8.769514e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5807e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.159401e-01 1 1  ON 0
 uu_1                 5.289851e-02 1 1  ON 1
 uu_2                -4.314538e-02 1 1  ON 2
 uu_3                -9.928639e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214971e-01 1 1  ON 6
 uu_7                -5.093584e-02 1 1  ON 7
 uu_8                 9.095889e-02 1 1  ON 8
 uu_9                 1.289803e-01 1 1  ON 9
 ud_0                 3.571751e-01 1 1  ON 10
 ud_1                 9.770886e-02 1 1  ON 11
 ud_2                -1.374835e-02 1 1  ON 12
 ud_3                -7.569654e-02 1 1  ON 13
 ud_4                -1.241300e-01 1 1  ON 14
 ud_5                -1.563080e-01 1 1  ON 15
 ud_6                -1.581490e-01 1 1  ON 16
 ud_7                -1.130469e-01 1 1  ON 17
 ud_8                -8.091442e-03 1 1  ON 18
 ud_9                 9.295462e-02 1 1  ON 19
 eO_0                -7.926266e-01 1 1  ON 20
 eO_1                -4.690914e-01 1 1  ON 21
 eO_2                -5.389018e-02 1 1  ON 22
 eO_3                 2.094284e-01 1 1  ON 23
 eO_4                 3.134569e-01 1 1  ON 24
 eO_5                 3.330385e-01 1 1  ON 25
 eO_6                 2.677477e-01 1 1  ON 26
 eO_7                 1.298285e-01 1 1  ON 27
 eO_8                 3.095413e-02 1 1  ON 28
 eO_9                 1.943692e-02 1 1  ON 29
eH1_0                -1.849007e-01 1 1  ON 30
eH1_1                -1.054940e-01 1 1  ON 31
eH1_2                -6.391671e-02 1 1  ON 32
eH1_3                -2.666986e-02 1 1  ON 33
eH1_4                 1.842429e-02 1 1  ON 34
eH1_5                 3.108973e-02 1 1  ON 35
eH1_6                 7.667156e-02 1 1  ON 36
eH1_7                 1.100670e-01 1 1  ON 37
eH1_8                 1.005664e-01 1 1  ON 38
eH1_9                 2.764828e-02 1 1  ON 39
eH2_0                -1.867110e-01 1 1  ON 40
eH2_1                -1.073496e-01 1 1  ON 41
eH2_2                -6.553328e-02 1 1  ON 42
eH2_3                -2.796090e-02 1 1  ON 43
eH2_4                 1.741214e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872164e-02 1 1  ON 46
eH2_7                 1.136526e-01 1 1  ON 47
eH2_8                 1.033974e-01 1 1  ON 48
eH2_9                 2.973435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1245
    reference variance = 0.509377
====================================================
  Execution time = 2.0193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1564e-01
  Total weights = 2.0000e+06
  Execution time = 1.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693599179
                                         uncertainty =       0.003664412820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693599179
                                         uncertainty =       0.003664412820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397265304
  error estimate for blocks of size 2^( 2) =       0.000407287426
  error estimate for blocks of size 2^( 3) =       0.000416416468
  error estimate for blocks of size 2^( 4) =       0.000422452712
  error estimate for blocks of size 2^( 5) =       0.000426891643
  error estimate for blocks of size 2^( 6) =       0.000429255398
  error estimate for blocks of size 2^( 7) =       0.000430993197

      target function =                  N/A
              le_mean =     -17.217279736195
             les_mean =     296.750360800362
             stat err =       0.000427398238
             autocorr =       1.157455173363
              std dev =       0.561817981001
             le_variance =       0.315639443776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693917607
                                         uncertainty =       0.003664404159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693917607
                                         uncertainty =       0.003664404159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397265505
  error estimate for blocks of size 2^( 2) =       0.000407287612
  error estimate for blocks of size 2^( 3) =       0.000416416637
  error estimate for blocks of size 2^( 4) =       0.000422452870
  error estimate for blocks of size 2^( 5) =       0.000426891795
  error estimate for blocks of size 2^( 6) =       0.000429255532
  error estimate for blocks of size 2^( 7) =       0.000430993294

      target function =                  N/A
              le_mean =     -17.217279739191
             les_mean =     296.750361222098
             stat err =       0.000427398373
             autocorr =       1.157454735769
              std dev =       0.561818264533
             le_variance =       0.315639762362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693758357
                                         uncertainty =       0.003664408480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693758357
                                         uncertainty =       0.003664408480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397265404
  error estimate for blocks of size 2^( 2) =       0.000407287519
  error estimate for blocks of size 2^( 3) =       0.000416416553
  error estimate for blocks of size 2^( 4) =       0.000422452791
  error estimate for blocks of size 2^( 5) =       0.000426891719
  error estimate for blocks of size 2^( 6) =       0.000429255465
  error estimate for blocks of size 2^( 7) =       0.000430993246

      target function =                  N/A
              le_mean =     -17.217279737697
             les_mean =     296.750361011331
             stat err =       0.000427398305
             autocorr =       1.157454954442
              std dev =       0.561818122734
             le_variance =       0.315639603033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693619075
                                         uncertainty =       0.003664412277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315693619075
                                         uncertainty =       0.003664412277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397265317
  error estimate for blocks of size 2^( 2) =       0.000407287437
  error estimate for blocks of size 2^( 3) =       0.000416416479
  error estimate for blocks of size 2^( 4) =       0.000422452722
  error estimate for blocks of size 2^( 5) =       0.000426891652
  error estimate for blocks of size 2^( 6) =       0.000429255407
  error estimate for blocks of size 2^( 7) =       0.000430993203

      target function =                  N/A
              le_mean =     -17.217279736383
             les_mean =     296.750360826733
             stat err =       0.000427398246
             autocorr =       1.157455146007
              std dev =       0.561817998716
             le_variance =       0.315639463681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217279736195        initial
     1.5625e+02     1.5625e+03             1.4029e-06       -17.217279739191  <--
     6.2500e+02     6.2500e+03             3.5077e-07       -17.217279737697
     2.5000e+03     2.5000e+04             8.7695e-08       -17.217279736383

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 2.9518e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770922e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092040e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926276e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842453e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741234e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.210374
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2089e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925134953
                                         uncertainty =       0.003991175106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925134953
                                         uncertainty =       0.003991175106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400556809
  error estimate for blocks of size 2^( 2) =       0.000410166829
  error estimate for blocks of size 2^( 3) =       0.000418853242
  error estimate for blocks of size 2^( 4) =       0.000425719614
  error estimate for blocks of size 2^( 5) =       0.000430305041
  error estimate for blocks of size 2^( 6) =       0.000431124977
  error estimate for blocks of size 2^( 7) =       0.000433764372

      target function =                  N/A
              le_mean =     -17.217564290978
             les_mean =     296.765411467546
             stat err =       0.000430228501
             autocorr =       1.153639502513
              std dev =       0.566472871403
             le_variance =       0.320891514036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721756429098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217564290978       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217564285640       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217564294696       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217564289469       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217564293019       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217564299464       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217564299473       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.083043e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217564290978       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217564289636       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217564291909       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217564290596       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217564291475       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217564293091       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217564293088       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.024036e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217564290978       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217564290642       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217564291211       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217564290882       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217564291101       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217564291506       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217564291505       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.062149e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6322e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.159409e-01 1 1  ON 0
 uu_1                 5.289778e-02 1 1  ON 1
 uu_2                -4.314476e-02 1 1  ON 2
 uu_3                -9.928639e-02 1 1  ON 3
 uu_4                -1.341724e-01 1 1  ON 4
 uu_5                -1.427628e-01 1 1  ON 5
 uu_6                -1.214968e-01 1 1  ON 6
 uu_7                -5.093684e-02 1 1  ON 7
 uu_8                 9.095792e-02 1 1  ON 8
 uu_9                 1.289808e-01 1 1  ON 9
 ud_0                 3.571770e-01 1 1  ON 10
 ud_1                 9.770923e-02 1 1  ON 11
 ud_2                -1.374821e-02 1 1  ON 12
 ud_3                -7.569736e-02 1 1  ON 13
 ud_4                -1.241297e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581498e-01 1 1  ON 16
 ud_7                -1.130474e-01 1 1  ON 17
 ud_8                -8.092671e-03 1 1  ON 18
 ud_9                 9.295453e-02 1 1  ON 19
 eO_0                -7.926297e-01 1 1  ON 20
 eO_1                -4.690926e-01 1 1  ON 21
 eO_2                -5.389095e-02 1 1  ON 22
 eO_3                 2.094292e-01 1 1  ON 23
 eO_4                 3.134571e-01 1 1  ON 24
 eO_5                 3.330396e-01 1 1  ON 25
 eO_6                 2.677490e-01 1 1  ON 26
 eO_7                 1.298298e-01 1 1  ON 27
 eO_8                 3.095426e-02 1 1  ON 28
 eO_9                 1.943700e-02 1 1  ON 29
eH1_0                -1.849010e-01 1 1  ON 30
eH1_1                -1.054940e-01 1 1  ON 31
eH1_2                -6.391719e-02 1 1  ON 32
eH1_3                -2.667037e-02 1 1  ON 33
eH1_4                 1.842445e-02 1 1  ON 34
eH1_5                 3.108984e-02 1 1  ON 35
eH1_6                 7.667183e-02 1 1  ON 36
eH1_7                 1.100668e-01 1 1  ON 37
eH1_8                 1.005671e-01 1 1  ON 38
eH1_9                 2.764849e-02 1 1  ON 39
eH2_0                -1.867111e-01 1 1  ON 40
eH2_1                -1.073496e-01 1 1  ON 41
eH2_2                -6.553290e-02 1 1  ON 42
eH2_3                -2.796172e-02 1 1  ON 43
eH2_4                 1.741268e-02 1 1  ON 44
eH2_5                 3.136589e-02 1 1  ON 45
eH2_6                 7.872109e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033982e-01 1 1  ON 48
eH2_9                 2.973455e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.400703
====================================================
  Execution time = 2.0665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2441e-01
  Total weights = 2.0000e+06
  Execution time = 1.8427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324391052980
                                         uncertainty =       0.008995342011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324391052980
                                         uncertainty =       0.008995342011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402743481
  error estimate for blocks of size 2^( 2) =       0.000412362905
  error estimate for blocks of size 2^( 3) =       0.000421417022
  error estimate for blocks of size 2^( 4) =       0.000427387198
  error estimate for blocks of size 2^( 5) =       0.000430952989
  error estimate for blocks of size 2^( 6) =       0.000433649741
  error estimate for blocks of size 2^( 7) =       0.000435838292

      target function =                  N/A
              le_mean =     -17.216420559267
             les_mean =     296.729541334740
             stat err =       0.000431957055
             autocorr =       1.150334391621
              std dev =       0.569565293342
             le_variance =       0.324404623380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324394911895
                                         uncertainty =       0.008995133446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324394911895
                                         uncertainty =       0.008995133446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402745877
  error estimate for blocks of size 2^( 2) =       0.000412365182
  error estimate for blocks of size 2^( 3) =       0.000421419205
  error estimate for blocks of size 2^( 4) =       0.000427389336
  error estimate for blocks of size 2^( 5) =       0.000430955093
  error estimate for blocks of size 2^( 6) =       0.000433651839
  error estimate for blocks of size 2^( 7) =       0.000435840410

      target function =                  N/A
              le_mean =     -17.216420547583
             les_mean =     296.729544791677
             stat err =       0.000431959170
             autocorr =       1.150331968043
              std dev =       0.569568681221
             le_variance =       0.324408482628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324392991732
                                         uncertainty =       0.008995236292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324392991732
                                         uncertainty =       0.008995236292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402744685
  error estimate for blocks of size 2^( 2) =       0.000412364049
  error estimate for blocks of size 2^( 3) =       0.000421418118
  error estimate for blocks of size 2^( 4) =       0.000427388272
  error estimate for blocks of size 2^( 5) =       0.000430954046
  error estimate for blocks of size 2^( 6) =       0.000433650795
  error estimate for blocks of size 2^( 7) =       0.000435839356

      target function =                  N/A
              le_mean =     -17.216420553424
             les_mean =     296.729543072454
             stat err =       0.000431958117
             autocorr =       1.150333173181
              std dev =       0.569566995440
             le_variance =       0.324406562295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324391295600
                                         uncertainty =       0.008995328751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324391295600
                                         uncertainty =       0.008995328751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402743632
  error estimate for blocks of size 2^( 2) =       0.000412363048
  error estimate for blocks of size 2^( 3) =       0.000421417159
  error estimate for blocks of size 2^( 4) =       0.000427387333
  error estimate for blocks of size 2^( 5) =       0.000430953121
  error estimate for blocks of size 2^( 6) =       0.000433649873
  error estimate for blocks of size 2^( 7) =       0.000435838426

      target function =                  N/A
              le_mean =     -17.216420558535
             les_mean =     296.729541552181
             stat err =       0.000431957188
             autocorr =       1.150334239100
              std dev =       0.569565506347
             le_variance =       0.324404866020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420559267        initial  <--
     3.9062e+01     3.9062e+02             8.0830e-06       -17.216420547583
     1.5625e+02     1.5625e+03             2.0240e-06       -17.216420553424
     6.2500e+02     6.2500e+03             5.0621e-07       -17.216420558535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9942
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770922e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092040e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926276e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842453e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741234e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.395706
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1384e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313782222450
                                         uncertainty =       0.002455722243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313782222450
                                         uncertainty =       0.002455722243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396129093
  error estimate for blocks of size 2^( 2) =       0.000406138230
  error estimate for blocks of size 2^( 3) =       0.000414654108
  error estimate for blocks of size 2^( 4) =       0.000420797235
  error estimate for blocks of size 2^( 5) =       0.000425756714
  error estimate for blocks of size 2^( 6) =       0.000426394583
  error estimate for blocks of size 2^( 7) =       0.000427401113

      target function =                  N/A
              le_mean =     -17.217142512405
             les_mean =     296.743832651692
             stat err =       0.000425087411
             autocorr =       1.151550555389
              std dev =       0.560211135328
             le_variance =       0.313836516145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714251241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142512405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142513886       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217142515367       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217142515944       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217142516788       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217142516901       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217142517343       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.541363e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142512405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142512775       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217142513146       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217142513291       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217142513503       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217142513529       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217142513640       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.386189e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142512405       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142512498       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217142512590       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217142512626       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217142512680       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217142512683       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217142512712       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 3.466004e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6354e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289810e-02 1 1  ON 1
 uu_2                -4.314509e-02 1 1  ON 2
 uu_3                -9.928618e-02 1 1  ON 3
 uu_4                -1.341726e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770918e-02 1 1  ON 11
 ud_2                -1.374797e-02 1 1  ON 12
 ud_3                -7.569692e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581497e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092120e-03 1 1  ON 18
 ud_9                 9.295456e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389081e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095415e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391693e-02 1 1  ON 32
eH1_3                -2.666997e-02 1 1  ON 33
eH1_4                 1.842455e-02 1 1  ON 34
eH1_5                 3.109013e-02 1 1  ON 35
eH1_6                 7.667154e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764837e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553351e-02 1 1  ON 42
eH2_3                -2.796121e-02 1 1  ON 43
eH2_4                 1.741242e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872140e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2752
    reference variance = 0.189713
====================================================
  Execution time = 2.0177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2114e-01
  Total weights = 2.0000e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244180430
                                         uncertainty =       0.007117614681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244180430
                                         uncertainty =       0.007117614681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400712051
  error estimate for blocks of size 2^( 2) =       0.000410552999
  error estimate for blocks of size 2^( 3) =       0.000419135684
  error estimate for blocks of size 2^( 4) =       0.000426227281
  error estimate for blocks of size 2^( 5) =       0.000429586897
  error estimate for blocks of size 2^( 6) =       0.000432158103
  error estimate for blocks of size 2^( 7) =       0.000434449215

      target function =                  N/A
              le_mean =     -17.216480650990
             les_mean =     296.728346141739
             stat err =       0.000430605374
             autocorr =       1.154766251652
              std dev =       0.566692417795
             le_variance =       0.321140296386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244378385
                                         uncertainty =       0.007117653769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244378385
                                         uncertainty =       0.007117653769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400712175
  error estimate for blocks of size 2^( 2) =       0.000410553121
  error estimate for blocks of size 2^( 3) =       0.000419135806
  error estimate for blocks of size 2^( 4) =       0.000426227400
  error estimate for blocks of size 2^( 5) =       0.000429587020
  error estimate for blocks of size 2^( 6) =       0.000432158237
  error estimate for blocks of size 2^( 7) =       0.000434449346

      target function =                  N/A
              le_mean =     -17.216480650231
             les_mean =     296.728346313580
             stat err =       0.000430605501
             autocorr =       1.154766218643
              std dev =       0.566692592468
             le_variance =       0.321140494358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244279433
                                         uncertainty =       0.007117634238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244279433
                                         uncertainty =       0.007117634238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400712113
  error estimate for blocks of size 2^( 2) =       0.000410553060
  error estimate for blocks of size 2^( 3) =       0.000419135745
  error estimate for blocks of size 2^( 4) =       0.000426227340
  error estimate for blocks of size 2^( 5) =       0.000429586959
  error estimate for blocks of size 2^( 6) =       0.000432158170
  error estimate for blocks of size 2^( 7) =       0.000434449281

      target function =                  N/A
              le_mean =     -17.216480650610
             les_mean =     296.728346227645
             stat err =       0.000430605437
             autocorr =       1.154766235225
              std dev =       0.566692505154
             le_variance =       0.321140395398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244192806
                                         uncertainty =       0.007117617126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244192806
                                         uncertainty =       0.007117617126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400712059
  error estimate for blocks of size 2^( 2) =       0.000410553007
  error estimate for blocks of size 2^( 3) =       0.000419135691
  error estimate for blocks of size 2^( 4) =       0.000426227288
  error estimate for blocks of size 2^( 5) =       0.000429586905
  error estimate for blocks of size 2^( 6) =       0.000432158111
  error estimate for blocks of size 2^( 7) =       0.000434449224

      target function =                  N/A
              le_mean =     -17.216480650943
             les_mean =     296.728346152475
             stat err =       0.000430605382
             autocorr =       1.154766249604
              std dev =       0.566692428715
             le_variance =       0.321140308763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216480650990        initial  <--
     3.9062e+02     3.9062e+03             5.5414e-07       -17.216480650231
     1.5625e+03     1.5625e+04             1.3862e-07       -17.216480650610
     6.2500e+03     6.2500e+04             3.4660e-08       -17.216480650943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4523
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770922e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092040e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926276e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842453e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741234e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.238262
====================================================
  Execution time = 2.1075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820473602
                                         uncertainty =       0.004075334562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820473602
                                         uncertainty =       0.004075334562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400460548
  error estimate for blocks of size 2^( 2) =       0.000410211304
  error estimate for blocks of size 2^( 3) =       0.000419359933
  error estimate for blocks of size 2^( 4) =       0.000426488591
  error estimate for blocks of size 2^( 5) =       0.000431506806
  error estimate for blocks of size 2^( 6) =       0.000433676465
  error estimate for blocks of size 2^( 7) =       0.000434412259

      target function =                  N/A
              le_mean =     -17.216560165115
             les_mean =     296.730681059621
             stat err =       0.000431521030
             autocorr =       1.161139653620
              std dev =       0.566336738145
             le_variance =       0.320737300973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656016511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560165115       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560165328       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560165629       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216560165597       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216560165660       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560165643       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216560165678       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 7.437087e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560165115       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560165168       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560165243       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216560165228       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216560165251       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560165243       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216560165290       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.859304e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216560165115       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560165128       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216560165147       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216560165176       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216560165149       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560165134       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216560165157       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 4.648281e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6812e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770921e-02 1 1  ON 11
 ud_2                -1.374806e-02 1 1  ON 12
 ud_3                -7.569688e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092043e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926277e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095415e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391692e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842454e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796120e-02 1 1  ON 43
eH2_4                 1.741234e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872145e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.158342
====================================================
  Execution time = 2.0078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807285622
                                         uncertainty =       0.003347651173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807285622
                                         uncertainty =       0.003347651173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397980326
  error estimate for blocks of size 2^( 2) =       0.000407797733
  error estimate for blocks of size 2^( 3) =       0.000417071818
  error estimate for blocks of size 2^( 4) =       0.000423860365
  error estimate for blocks of size 2^( 5) =       0.000427718570
  error estimate for blocks of size 2^( 6) =       0.000430299261
  error estimate for blocks of size 2^( 7) =       0.000431297891

      target function =                  N/A
              le_mean =     -17.216308159261
             les_mean =     296.718043156296
             stat err =       0.000428294022
             autocorr =       1.158139348322
              std dev =       0.562829174848
             le_variance =       0.316776680060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807337372
                                         uncertainty =       0.003347651746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807337372
                                         uncertainty =       0.003347651746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397980359
  error estimate for blocks of size 2^( 2) =       0.000407797764
  error estimate for blocks of size 2^( 3) =       0.000417071847
  error estimate for blocks of size 2^( 4) =       0.000423860393
  error estimate for blocks of size 2^( 5) =       0.000427718597
  error estimate for blocks of size 2^( 6) =       0.000430299288
  error estimate for blocks of size 2^( 7) =       0.000431297917

      target function =                  N/A
              le_mean =     -17.216308159248
             les_mean =     296.718043207630
             stat err =       0.000428294049
             autocorr =       1.158139305110
              std dev =       0.562829220825
             le_variance =       0.316776731815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807311499
                                         uncertainty =       0.003347651459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807311499
                                         uncertainty =       0.003347651459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397980342
  error estimate for blocks of size 2^( 2) =       0.000407797748
  error estimate for blocks of size 2^( 3) =       0.000417071833
  error estimate for blocks of size 2^( 4) =       0.000423860379
  error estimate for blocks of size 2^( 5) =       0.000427718583
  error estimate for blocks of size 2^( 6) =       0.000430299274
  error estimate for blocks of size 2^( 7) =       0.000431297904

      target function =                  N/A
              le_mean =     -17.216308159255
             les_mean =     296.718043181965
             stat err =       0.000428294035
             autocorr =       1.158139326717
              std dev =       0.562829197838
             le_variance =       0.316776705939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807288856
                                         uncertainty =       0.003347651209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316807288856
                                         uncertainty =       0.003347651209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397980328
  error estimate for blocks of size 2^( 2) =       0.000407797735
  error estimate for blocks of size 2^( 3) =       0.000417071820
  error estimate for blocks of size 2^( 4) =       0.000423860367
  error estimate for blocks of size 2^( 5) =       0.000427718571
  error estimate for blocks of size 2^( 6) =       0.000430299262
  error estimate for blocks of size 2^( 7) =       0.000431297892

      target function =                  N/A
              le_mean =     -17.216308159260
             les_mean =     296.718043159505
             stat err =       0.000428294023
             autocorr =       1.158139345621
              std dev =       0.562829177722
             le_variance =       0.316776683295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216308159261        initial  <--
     3.9062e+03     3.9062e+04             7.4371e-08       -17.216308159248
     1.5625e+04     1.5625e+05             1.8593e-08       -17.216308159255
     6.2500e+04     6.2500e+05             4.6483e-09       -17.216308159260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0724
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770922e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092040e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926276e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842453e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741234e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2804
    reference variance = 0.523359
====================================================
  Execution time = 2.0867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1388e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313896121664
                                         uncertainty =       0.002471549491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313896121664
                                         uncertainty =       0.002471549491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396157785
  error estimate for blocks of size 2^( 2) =       0.000405922230
  error estimate for blocks of size 2^( 3) =       0.000414789941
  error estimate for blocks of size 2^( 4) =       0.000421335298
  error estimate for blocks of size 2^( 5) =       0.000425820742
  error estimate for blocks of size 2^( 6) =       0.000427925424
  error estimate for blocks of size 2^( 7) =       0.000428114659

      target function =                  N/A
              le_mean =     -17.216765799287
             les_mean =     296.730906411581
             stat err =       0.000425799031
             autocorr =       1.155241940883
              std dev =       0.560251712206
             le_variance =       0.313881981030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676579929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216765799287       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216765799287       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216765799304       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216765799306       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216765799341       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216765799305       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216765799294       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.241715e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216765799287       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216765799287       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216765799291       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216765799292       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216765799447       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216765799253       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216765799246       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.560431e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216765799287       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216765799287       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216765799288       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216765799082       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216765799186       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216765799341       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216765799495       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 3.901078e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6385e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770922e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092040e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926276e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842454e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741233e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.232381
====================================================
  Execution time = 2.0418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1214e-01
  Total weights = 2.0000e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153010242
                                         uncertainty =       0.002515938259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153010242
                                         uncertainty =       0.002515938259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395057539
  error estimate for blocks of size 2^( 2) =       0.000405184317
  error estimate for blocks of size 2^( 3) =       0.000414085818
  error estimate for blocks of size 2^( 4) =       0.000420678218
  error estimate for blocks of size 2^( 5) =       0.000424409153
  error estimate for blocks of size 2^( 6) =       0.000427248264
  error estimate for blocks of size 2^( 7) =       0.000427926896

      target function =                  N/A
              le_mean =     -17.216858774308
             les_mean =     296.732366816490
             stat err =       0.000425065633
             autocorr =       1.157687324189
              std dev =       0.558695729441
             le_variance =       0.312140918095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153012015
                                         uncertainty =       0.002515938282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153012015
                                         uncertainty =       0.002515938282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395057540
  error estimate for blocks of size 2^( 2) =       0.000405184318
  error estimate for blocks of size 2^( 3) =       0.000414085819
  error estimate for blocks of size 2^( 4) =       0.000420678219
  error estimate for blocks of size 2^( 5) =       0.000424409154
  error estimate for blocks of size 2^( 6) =       0.000427248266
  error estimate for blocks of size 2^( 7) =       0.000427926897

      target function =                  N/A
              le_mean =     -17.216858774335
             les_mean =     296.732366819191
             stat err =       0.000425065634
             autocorr =       1.157687324164
              std dev =       0.558695731030
             le_variance =       0.312140919871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153011129
                                         uncertainty =       0.002515938271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153011129
                                         uncertainty =       0.002515938271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395057539
  error estimate for blocks of size 2^( 2) =       0.000405184317
  error estimate for blocks of size 2^( 3) =       0.000414085819
  error estimate for blocks of size 2^( 4) =       0.000420678218
  error estimate for blocks of size 2^( 5) =       0.000424409153
  error estimate for blocks of size 2^( 6) =       0.000427248265
  error estimate for blocks of size 2^( 7) =       0.000427926897

      target function =                  N/A
              le_mean =     -17.216858774321
             les_mean =     296.732366817841
             stat err =       0.000425065633
             autocorr =       1.157687324183
              std dev =       0.558695730235
             le_variance =       0.312140918983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153010353
                                         uncertainty =       0.002515938261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312153010353
                                         uncertainty =       0.002515938261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395057539
  error estimate for blocks of size 2^( 2) =       0.000405184317
  error estimate for blocks of size 2^( 3) =       0.000414085818
  error estimate for blocks of size 2^( 4) =       0.000420678218
  error estimate for blocks of size 2^( 5) =       0.000424409153
  error estimate for blocks of size 2^( 6) =       0.000427248265
  error estimate for blocks of size 2^( 7) =       0.000427926896

      target function =                  N/A
              le_mean =     -17.216858774310
             les_mean =     296.732366816659
             stat err =       0.000425065633
             autocorr =       1.157687324196
              std dev =       0.558695729540
             le_variance =       0.312140918206


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216858774308        initial
     3.9062e+04     3.9062e+05             6.2417e-09       -17.216858774335  <--
     1.5625e+05     1.5625e+06             1.5604e-09       -17.216858774321
     6.2500e+05     6.2500e+06             3.9011e-10       -17.216858774310

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 2.9667e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289816e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770921e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092041e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926277e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134572e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095414e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842454e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741233e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.160155
====================================================
  Execution time = 2.0715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1968e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319674543607
                                         uncertainty =       0.004009906136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319674543607
                                         uncertainty =       0.004009906136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399800116
  error estimate for blocks of size 2^( 2) =       0.000409430655
  error estimate for blocks of size 2^( 3) =       0.000418307620
  error estimate for blocks of size 2^( 4) =       0.000425497364
  error estimate for blocks of size 2^( 5) =       0.000429934950
  error estimate for blocks of size 2^( 6) =       0.000432598336
  error estimate for blocks of size 2^( 7) =       0.000433235380

      target function =                  N/A
              le_mean =     -17.216647601415
             les_mean =     296.732634736241
             stat err =       0.000430316508
             autocorr =       1.158484380382
              std dev =       0.565402745631
             le_variance =       0.319680264768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664760142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216647601415       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216647601423       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216647601504       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216647601526       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216647601497       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216647601499       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216647601502       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.915291e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216647601415       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216647601417       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216647601437       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216647601431       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216647601436       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216647601459       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216647601305       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.788257e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216647601415       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216647601416       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216647601421       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216647601449       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216647601427       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216647601327       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216647601464       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.197067e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6324e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289816e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095836e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770921e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569687e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092043e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926277e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389077e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095415e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842454e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667158e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741233e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1376
    reference variance = 0.259102
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2210e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185000134
                                         uncertainty =       0.005266994290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185000134
                                         uncertainty =       0.005266994290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401310153
  error estimate for blocks of size 2^( 2) =       0.000410725517
  error estimate for blocks of size 2^( 3) =       0.000419182622
  error estimate for blocks of size 2^( 4) =       0.000426155365
  error estimate for blocks of size 2^( 5) =       0.000430251302
  error estimate for blocks of size 2^( 6) =       0.000433321914
  error estimate for blocks of size 2^( 7) =       0.000433777664

      target function =                  N/A
              le_mean =     -17.216111729287
             les_mean =     296.716602591503
             stat err =       0.000430876561
             autocorr =       1.152777380739
              std dev =       0.567538260612
             le_variance =       0.322099677258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185009008
                                         uncertainty =       0.005266994426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185009008
                                         uncertainty =       0.005266994426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401310158
  error estimate for blocks of size 2^( 2) =       0.000410725522
  error estimate for blocks of size 2^( 3) =       0.000419182627
  error estimate for blocks of size 2^( 4) =       0.000426155370
  error estimate for blocks of size 2^( 5) =       0.000430251307
  error estimate for blocks of size 2^( 6) =       0.000433321919
  error estimate for blocks of size 2^( 7) =       0.000433777669

      target function =                  N/A
              le_mean =     -17.216111729320
             les_mean =     296.716602601509
             stat err =       0.000430876566
             autocorr =       1.152777373397
              std dev =       0.567538268428
             le_variance =       0.322099686130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185004571
                                         uncertainty =       0.005266994358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185004571
                                         uncertainty =       0.005266994358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401310155
  error estimate for blocks of size 2^( 2) =       0.000410725520
  error estimate for blocks of size 2^( 3) =       0.000419182625
  error estimate for blocks of size 2^( 4) =       0.000426155367
  error estimate for blocks of size 2^( 5) =       0.000430251304
  error estimate for blocks of size 2^( 6) =       0.000433321917
  error estimate for blocks of size 2^( 7) =       0.000433777666

      target function =                  N/A
              le_mean =     -17.216111729304
             les_mean =     296.716602596507
             stat err =       0.000430876564
             autocorr =       1.152777377075
              std dev =       0.567538264520
             le_variance =       0.322099681694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185000689
                                         uncertainty =       0.005266994299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185000689
                                         uncertainty =       0.005266994299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401310153
  error estimate for blocks of size 2^( 2) =       0.000410725518
  error estimate for blocks of size 2^( 3) =       0.000419182623
  error estimate for blocks of size 2^( 4) =       0.000426155365
  error estimate for blocks of size 2^( 5) =       0.000430251302
  error estimate for blocks of size 2^( 6) =       0.000433321915
  error estimate for blocks of size 2^( 7) =       0.000433777664

      target function =                  N/A
              le_mean =     -17.216111729289
             les_mean =     296.716602592129
             stat err =       0.000430876562
             autocorr =       1.152777380273
              std dev =       0.567538261101
             le_variance =       0.322099677813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216111729287        initial
     9.7656e+03     9.7656e+04             1.9153e-08       -17.216111729320  <--
     3.9062e+04     3.9062e+05             4.7883e-09       -17.216111729304
     1.5625e+05     1.5625e+06             1.1971e-09       -17.216111729289

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 2.9492e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289817e-02 1 1  ON 1
 uu_2                -4.314518e-02 1 1  ON 2
 uu_3                -9.928618e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095835e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770921e-02 1 1  ON 11
 ud_2                -1.374806e-02 1 1  ON 12
 ud_3                -7.569688e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092050e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926277e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389079e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298290e-01 1 1  ON 27
 eO_8                 3.095415e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842453e-02 1 1  ON 34
eH1_5                 3.109010e-02 1 1  ON 35
eH1_6                 7.667157e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764836e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796119e-02 1 1  ON 43
eH2_4                 1.741233e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.183931
====================================================
  Execution time = 2.0357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2038e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320353945890
                                         uncertainty =       0.003664987486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320353945890
                                         uncertainty =       0.003664987486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400236841
  error estimate for blocks of size 2^( 2) =       0.000410033234
  error estimate for blocks of size 2^( 3) =       0.000418568643
  error estimate for blocks of size 2^( 4) =       0.000425725773
  error estimate for blocks of size 2^( 5) =       0.000429897095
  error estimate for blocks of size 2^( 6) =       0.000431081694
  error estimate for blocks of size 2^( 7) =       0.000431742035

      target function =                  N/A
              le_mean =     -17.216988665513
             les_mean =     296.745077605979
             stat err =       0.000429611649
             autocorr =       1.152173744009
              std dev =       0.566020368687
             le_variance =       0.320379057768


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698866551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988665513       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988665718       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988665239       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988665263       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988665294       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988665459       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988665420       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.253503e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988665513       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988665564       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988665444       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988665450       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988665458       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988665497       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988665485       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.133853e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216988665513       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216988665526       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988665496       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988665497       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216988665484       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216988665504       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216988665476       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 7.834691e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5962e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289816e-02 1 1  ON 1
 uu_2                -4.314517e-02 1 1  ON 2
 uu_3                -9.928618e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095835e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770920e-02 1 1  ON 11
 ud_2                -1.374805e-02 1 1  ON 12
 ud_3                -7.569689e-02 1 1  ON 13
 ud_4                -1.241299e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092058e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926277e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389080e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095415e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054945e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842455e-02 1 1  ON 34
eH1_5                 3.109010e-02 1 1  ON 35
eH1_6                 7.667157e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764837e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796120e-02 1 1  ON 43
eH2_4                 1.741233e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033977e-01 1 1  ON 48
eH2_9                 2.973445e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.360022
====================================================
  Execution time = 2.0345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1980e-01
  Total weights = 2.0000e+06
  Execution time = 1.8369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902225234
                                         uncertainty =       0.006012715545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902225234
                                         uncertainty =       0.006012715545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399873268
  error estimate for blocks of size 2^( 2) =       0.000409699873
  error estimate for blocks of size 2^( 3) =       0.000418257789
  error estimate for blocks of size 2^( 4) =       0.000425435571
  error estimate for blocks of size 2^( 5) =       0.000429764065
  error estimate for blocks of size 2^( 6) =       0.000433344507
  error estimate for blocks of size 2^( 7) =       0.000436223873

      target function =                  N/A
              le_mean =     -17.216278343719
             les_mean =     296.720037110080
             stat err =       0.000431192004
             autocorr =       1.162777589162
              std dev =       0.565506199424
             le_variance =       0.319797261587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902224065
                                         uncertainty =       0.006012712980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902224065
                                         uncertainty =       0.006012712980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399873268
  error estimate for blocks of size 2^( 2) =       0.000409699872
  error estimate for blocks of size 2^( 3) =       0.000418257788
  error estimate for blocks of size 2^( 4) =       0.000425435570
  error estimate for blocks of size 2^( 5) =       0.000429764064
  error estimate for blocks of size 2^( 6) =       0.000433344504
  error estimate for blocks of size 2^( 7) =       0.000436223873

      target function =                  N/A
              le_mean =     -17.216278344038
             les_mean =     296.720037119867
             stat err =       0.000431192003
             autocorr =       1.162777586029
              std dev =       0.565506198348
             le_variance =       0.319797260371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902224648
                                         uncertainty =       0.006012714262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902224648
                                         uncertainty =       0.006012714262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399873268
  error estimate for blocks of size 2^( 2) =       0.000409699873
  error estimate for blocks of size 2^( 3) =       0.000418257789
  error estimate for blocks of size 2^( 4) =       0.000425435571
  error estimate for blocks of size 2^( 5) =       0.000429764064
  error estimate for blocks of size 2^( 6) =       0.000433344506
  error estimate for blocks of size 2^( 7) =       0.000436223873

      target function =                  N/A
              le_mean =     -17.216278343878
             les_mean =     296.720037114974
             stat err =       0.000431192003
             autocorr =       1.162777587602
              std dev =       0.565506198885
             le_variance =       0.319797260978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902225161
                                         uncertainty =       0.006012715384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319902225161
                                         uncertainty =       0.006012715384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399873268
  error estimate for blocks of size 2^( 2) =       0.000409699873
  error estimate for blocks of size 2^( 3) =       0.000418257789
  error estimate for blocks of size 2^( 4) =       0.000425435571
  error estimate for blocks of size 2^( 5) =       0.000429764065
  error estimate for blocks of size 2^( 6) =       0.000433344507
  error estimate for blocks of size 2^( 7) =       0.000436223873

      target function =                  N/A
              le_mean =     -17.216278343739
             les_mean =     296.720037110692
             stat err =       0.000431192004
             autocorr =       1.162777588968
              std dev =       0.565506199356
             le_variance =       0.319797261510


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216278343719        initial
     2.4414e+03     2.4414e+04             1.2535e-07       -17.216278344038  <--
     9.7656e+03     9.7656e+04             3.1339e-08       -17.216278343878
     3.9062e+04     3.9062e+05             7.8347e-09       -17.216278343739

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9628e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289814e-02 1 1  ON 1
 uu_2                -4.314513e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095834e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374804e-02 1 1  ON 12
 ud_3                -7.569693e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092082e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389084e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134572e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666995e-02 1 1  ON 33
eH1_4                 1.842459e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667156e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741232e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.419708
====================================================
  Execution time = 2.0719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313992463475
                                         uncertainty =       0.003840830627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313992463475
                                         uncertainty =       0.003840830627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396146397
  error estimate for blocks of size 2^( 2) =       0.000406180435
  error estimate for blocks of size 2^( 3) =       0.000414947525
  error estimate for blocks of size 2^( 4) =       0.000421700003
  error estimate for blocks of size 2^( 5) =       0.000426762591
  error estimate for blocks of size 2^( 6) =       0.000428381405
  error estimate for blocks of size 2^( 7) =       0.000429562304

      target function =                  N/A
              le_mean =     -17.215964690475
             les_mean =     296.703304002634
             stat err =       0.000426601576
             autocorr =       1.159667509421
              std dev =       0.560235607469
             le_variance =       0.313863935876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596469048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964690475       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964690766       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964688565       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964689205       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964688974       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964689277       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215964689282       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.301014e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964690475       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964690548       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964689997       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964690158       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964690099       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964690176       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215964690176       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.256499e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964690475       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964690493       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964690356       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964690396       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964690383       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964690396       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215964690403       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.064373e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6217e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289814e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928617e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427624e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093617e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770913e-02 1 1  ON 11
 ud_2                -1.374800e-02 1 1  ON 12
 ud_3                -7.569701e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581497e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389092e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298292e-01 1 1  ON 27
 eO_8                 3.095417e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391696e-02 1 1  ON 32
eH1_3                -2.666996e-02 1 1  ON 33
eH1_4                 1.842463e-02 1 1  ON 34
eH1_5                 3.109008e-02 1 1  ON 35
eH1_6                 7.667154e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553349e-02 1 1  ON 42
eH2_3                -2.796127e-02 1 1  ON 43
eH2_4                 1.741232e-02 1 1  ON 44
eH2_5                 3.136613e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1754
    reference variance = 0.151046
====================================================
  Execution time = 2.1038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316228940600
                                         uncertainty =       0.003662973380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316228940600
                                         uncertainty =       0.003662973380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630972
  error estimate for blocks of size 2^( 2) =       0.000407669303
  error estimate for blocks of size 2^( 3) =       0.000416318894
  error estimate for blocks of size 2^( 4) =       0.000422799700
  error estimate for blocks of size 2^( 5) =       0.000427416480
  error estimate for blocks of size 2^( 6) =       0.000430267364
  error estimate for blocks of size 2^( 7) =       0.000432481604

      target function =                  N/A
              le_mean =     -17.216493360353
             les_mean =     296.723864248708
             stat err =       0.000428241287
             autocorr =       1.159889619924
              std dev =       0.562335113379
             le_variance =       0.316220779739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316229116259
                                         uncertainty =       0.003662976716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316229116259
                                         uncertainty =       0.003662976716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397631082
  error estimate for blocks of size 2^( 2) =       0.000407669410
  error estimate for blocks of size 2^( 3) =       0.000416318999
  error estimate for blocks of size 2^( 4) =       0.000422799798
  error estimate for blocks of size 2^( 5) =       0.000427416584
  error estimate for blocks of size 2^( 6) =       0.000430267481
  error estimate for blocks of size 2^( 7) =       0.000432481718

      target function =                  N/A
              le_mean =     -17.216493359640
             les_mean =     296.723864399606
             stat err =       0.000428241395
             autocorr =       1.159889561029
              std dev =       0.562335269375
             le_variance =       0.316220955183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316229028459
                                         uncertainty =       0.003662975049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316229028459
                                         uncertainty =       0.003662975049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397631027
  error estimate for blocks of size 2^( 2) =       0.000407669357
  error estimate for blocks of size 2^( 3) =       0.000416318946
  error estimate for blocks of size 2^( 4) =       0.000422799749
  error estimate for blocks of size 2^( 5) =       0.000427416532
  error estimate for blocks of size 2^( 6) =       0.000430267422
  error estimate for blocks of size 2^( 7) =       0.000432481661

      target function =                  N/A
              le_mean =     -17.216493359996
             les_mean =     296.723864324166
             stat err =       0.000428241341
             autocorr =       1.159889590488
              std dev =       0.562335191403
             le_variance =       0.316220867490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316228951584
                                         uncertainty =       0.003662973589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316228951584
                                         uncertainty =       0.003662973589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630979
  error estimate for blocks of size 2^( 2) =       0.000407669310
  error estimate for blocks of size 2^( 3) =       0.000416318901
  error estimate for blocks of size 2^( 4) =       0.000422799706
  error estimate for blocks of size 2^( 5) =       0.000427416486
  error estimate for blocks of size 2^( 6) =       0.000430267372
  error estimate for blocks of size 2^( 7) =       0.000432481611

      target function =                  N/A
              le_mean =     -17.216493360308
             les_mean =     296.723864258140
             stat err =       0.000428241294
             autocorr =       1.159889616238
              std dev =       0.562335123133
             le_variance =       0.316220790709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216493360353        initial  <--
     6.1035e+02     6.1035e+03             3.3010e-07       -17.216493359640
     2.4414e+03     2.4414e+04             8.2565e-08       -17.216493359996
     9.7656e+03     9.7656e+04             2.0644e-08       -17.216493360308

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3275
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289814e-02 1 1  ON 1
 uu_2                -4.314513e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093613e-02 1 1  ON 7
 uu_8                 9.095834e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374804e-02 1 1  ON 12
 ud_3                -7.569693e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092082e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389084e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134572e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666995e-02 1 1  ON 33
eH1_4                 1.842459e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667156e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741232e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872146e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2279
    reference variance = 0.183105
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0890e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308131524330
                                         uncertainty =       0.002351220085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308131524330
                                         uncertainty =       0.002351220085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392999117
  error estimate for blocks of size 2^( 2) =       0.000403066816
  error estimate for blocks of size 2^( 3) =       0.000411490312
  error estimate for blocks of size 2^( 4) =       0.000418830848
  error estimate for blocks of size 2^( 5) =       0.000423227159
  error estimate for blocks of size 2^( 6) =       0.000423301408
  error estimate for blocks of size 2^( 7) =       0.000424257897

      target function =                  N/A
              le_mean =     -17.215742927819
             les_mean =     296.690701014732
             stat err =       0.000422404328
             autocorr =       1.155243593203
              std dev =       0.555784681729
             le_variance =       0.308896612445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721574292782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215742927819       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215742927841       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215742928004       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215742928028       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215742928049       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215742928050       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215742928049       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.542263e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215742927819       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215742927824       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215742927865       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215742927872       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215742927882       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215742927860       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215742927884       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.135579e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215742927819       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215742927820       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215742927830       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215742927836       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215742927848       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215742927827       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215742927812       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.838955e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6053e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289814e-02 1 1  ON 1
 uu_2                -4.314513e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093614e-02 1 1  ON 7
 uu_8                 9.095833e-02 1 1  ON 8
 uu_9                 1.289804e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374804e-02 1 1  ON 12
 ud_3                -7.569694e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092084e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389084e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134572e-01 1 1  ON 24
 eO_5                 3.330389e-01 1 1  ON 25
 eO_6                 2.677483e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943695e-02 1 1  ON 29
eH1_0                -1.849008e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666995e-02 1 1  ON 33
eH1_4                 1.842459e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872145e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.274826
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0981e-01
  Total weights = 2.0000e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823839168
                                         uncertainty =       0.002413586751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823839168
                                         uncertainty =       0.002413586751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393577998
  error estimate for blocks of size 2^( 2) =       0.000403387107
  error estimate for blocks of size 2^( 3) =       0.000411877128
  error estimate for blocks of size 2^( 4) =       0.000418647935
  error estimate for blocks of size 2^( 5) =       0.000422520196
  error estimate for blocks of size 2^( 6) =       0.000424274468
  error estimate for blocks of size 2^( 7) =       0.000425310016

      target function =                  N/A
              le_mean =     -17.216633491300
             les_mean =     296.722275899866
             stat err =       0.000422688154
             autocorr =       1.153396233538
              std dev =       0.556603342605
             le_variance =       0.309807280999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823846031
                                         uncertainty =       0.002413586806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823846031
                                         uncertainty =       0.002413586806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393578002
  error estimate for blocks of size 2^( 2) =       0.000403387111
  error estimate for blocks of size 2^( 3) =       0.000411877132
  error estimate for blocks of size 2^( 4) =       0.000418647938
  error estimate for blocks of size 2^( 5) =       0.000422520200
  error estimate for blocks of size 2^( 6) =       0.000424274471
  error estimate for blocks of size 2^( 7) =       0.000425310019

      target function =                  N/A
              le_mean =     -17.216633491387
             les_mean =     296.722275909701
             stat err =       0.000422688157
             autocorr =       1.153396224670
              std dev =       0.556603348779
             le_variance =       0.309807287872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823842600
                                         uncertainty =       0.002413586779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823842600
                                         uncertainty =       0.002413586779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393578000
  error estimate for blocks of size 2^( 2) =       0.000403387109
  error estimate for blocks of size 2^( 3) =       0.000411877130
  error estimate for blocks of size 2^( 4) =       0.000418647936
  error estimate for blocks of size 2^( 5) =       0.000422520198
  error estimate for blocks of size 2^( 6) =       0.000424274470
  error estimate for blocks of size 2^( 7) =       0.000425310018

      target function =                  N/A
              le_mean =     -17.216633491344
             les_mean =     296.722275904783
             stat err =       0.000422688156
             autocorr =       1.153396229116
              std dev =       0.556603345692
             le_variance =       0.309807284436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823839597
                                         uncertainty =       0.002413586755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309823839597
                                         uncertainty =       0.002413586755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393577998
  error estimate for blocks of size 2^( 2) =       0.000403387107
  error estimate for blocks of size 2^( 3) =       0.000411877129
  error estimate for blocks of size 2^( 4) =       0.000418647935
  error estimate for blocks of size 2^( 5) =       0.000422520197
  error estimate for blocks of size 2^( 6) =       0.000424274469
  error estimate for blocks of size 2^( 7) =       0.000425310017

      target function =                  N/A
              le_mean =     -17.216633491306
             les_mean =     296.722275900480
             stat err =       0.000422688154
             autocorr =       1.153396232979
              std dev =       0.556603342991
             le_variance =       0.309807281429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216633491300        initial
     6.1035e+03     6.1035e+04             4.5423e-08       -17.216633491387  <--
     2.4414e+04     2.4414e+05             1.1356e-08       -17.216633491344
     9.7656e+04     9.7656e+05             2.8390e-09       -17.216633491306

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 2.9382e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095833e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569695e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092091e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389085e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741230e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872145e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3224
    reference variance = 0.237823
====================================================
  Execution time = 2.2988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1474e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873000669
                                         uncertainty =       0.003306031689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314873000669
                                         uncertainty =       0.003306031689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396696069
  error estimate for blocks of size 2^( 2) =       0.000406465155
  error estimate for blocks of size 2^( 3) =       0.000414781011
  error estimate for blocks of size 2^( 4) =       0.000420915677
  error estimate for blocks of size 2^( 5) =       0.000424412192
  error estimate for blocks of size 2^( 6) =       0.000426958955
  error estimate for blocks of size 2^( 7) =       0.000426112615

      target function =                  N/A
              le_mean =     -17.216857765044
             les_mean =     296.734926686918
             stat err =       0.000424599860
             autocorr =       1.145628735889
              std dev =       0.561012961094
             le_variance =       0.314735542515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685776504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857765044       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857765299       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216857765224       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216857765500       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216857765555       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216857765558       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216857765450       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216857765487       residual = 7.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.999011e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857765044       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857765108       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216857765089       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216857765158       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216857765176       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216857765172       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216857765141       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216857765159       residual = 7.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.997790e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857765044       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857765060       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216857765056       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216857765073       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216857765074       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216857765078       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216857765011       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216857765020       residual = 7.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.249464e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8774e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314512e-02 1 1  ON 2
 uu_3                -9.928618e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770918e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092110e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389085e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391692e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842458e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667156e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553346e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.295271
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3174e-01
  Total weights = 2.0000e+06
  Execution time = 1.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890972304
                                         uncertainty =       0.007953789066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890972304
                                         uncertainty =       0.007953789066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407270461
  error estimate for blocks of size 2^( 2) =       0.000417237597
  error estimate for blocks of size 2^( 3) =       0.000425047379
  error estimate for blocks of size 2^( 4) =       0.000431788108
  error estimate for blocks of size 2^( 5) =       0.000436461170
  error estimate for blocks of size 2^( 6) =       0.000438498000
  error estimate for blocks of size 2^( 7) =       0.000439347745

      target function =                  N/A
              le_mean =     -17.216703033422
             les_mean =     296.746601632189
             stat err =       0.000436523756
             autocorr =       1.148814588120
              std dev =       0.575967409681
             le_variance =       0.331738457015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331891015753
                                         uncertainty =       0.007953792547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331891015753
                                         uncertainty =       0.007953792547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407270488
  error estimate for blocks of size 2^( 2) =       0.000417237624
  error estimate for blocks of size 2^( 3) =       0.000425047405
  error estimate for blocks of size 2^( 4) =       0.000431788134
  error estimate for blocks of size 2^( 5) =       0.000436461195
  error estimate for blocks of size 2^( 6) =       0.000438498025
  error estimate for blocks of size 2^( 7) =       0.000439347772

      target function =                  N/A
              le_mean =     -17.216703032994
             les_mean =     296.746601660902
             stat err =       0.000436523781
             autocorr =       1.148814572463
              std dev =       0.575967447406
             le_variance =       0.331738500471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890994030
                                         uncertainty =       0.007953790807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890994030
                                         uncertainty =       0.007953790807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407270474
  error estimate for blocks of size 2^( 2) =       0.000417237610
  error estimate for blocks of size 2^( 3) =       0.000425047392
  error estimate for blocks of size 2^( 4) =       0.000431788121
  error estimate for blocks of size 2^( 5) =       0.000436461182
  error estimate for blocks of size 2^( 6) =       0.000438498013
  error estimate for blocks of size 2^( 7) =       0.000439347759

      target function =                  N/A
              le_mean =     -17.216703033208
             les_mean =     296.746601646546
             stat err =       0.000436523769
             autocorr =       1.148814580296
              std dev =       0.575967428545
             le_variance =       0.331738478744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890975020
                                         uncertainty =       0.007953789283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331890975020
                                         uncertainty =       0.007953789283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407270463
  error estimate for blocks of size 2^( 2) =       0.000417237599
  error estimate for blocks of size 2^( 3) =       0.000425047381
  error estimate for blocks of size 2^( 4) =       0.000431788110
  error estimate for blocks of size 2^( 5) =       0.000436461171
  error estimate for blocks of size 2^( 6) =       0.000438498002
  error estimate for blocks of size 2^( 7) =       0.000439347747

      target function =                  N/A
              le_mean =     -17.216703033395
             les_mean =     296.746601633983
             stat err =       0.000436523757
             autocorr =       1.148814587147
              std dev =       0.575967412039
             le_variance =       0.331738459731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216703033422        initial  <--
     1.5259e+03     1.5259e+04             1.9990e-07       -17.216703032994
     6.1035e+03     6.1035e+04             4.9978e-08       -17.216703033208
     2.4414e+04     2.4414e+05             1.2495e-08       -17.216703033395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6585
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095833e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569695e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092091e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389085e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741230e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872145e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2694
    reference variance = 0.251964
====================================================
  Execution time = 2.1242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2042e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320501541133
                                         uncertainty =       0.003849557238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320501541133
                                         uncertainty =       0.003849557238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400262501
  error estimate for blocks of size 2^( 2) =       0.000410111244
  error estimate for blocks of size 2^( 3) =       0.000418324166
  error estimate for blocks of size 2^( 4) =       0.000424510777
  error estimate for blocks of size 2^( 5) =       0.000428415633
  error estimate for blocks of size 2^( 6) =       0.000431574535
  error estimate for blocks of size 2^( 7) =       0.000432932069

      target function =                  N/A
              le_mean =     -17.216937919807
             les_mean =     296.743371314235
             stat err =       0.000429358254
             autocorr =       1.150667432720
              std dev =       0.566056657910
             le_variance =       0.320420139964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693791981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216937919807       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216937919831       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216937919802       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216937919748       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216937919749       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216937919779       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216937919777       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.993444e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216937919807       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216937919813       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216937919806       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216937919793       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216937919793       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216937919791       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216937919774       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.983642e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216937919807       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216937919808       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216937919806       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216937919656       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216937919774       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216937919802       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216937919804       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.245912e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6756e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095833e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770917e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569695e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130472e-01 1 1  ON 17
 ud_8                -8.092092e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926278e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389085e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741230e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872145e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.138208
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3300e-01
  Total weights = 2.0000e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100639803
                                         uncertainty =       0.005322523357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100639803
                                         uncertainty =       0.005322523357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408047025
  error estimate for blocks of size 2^( 2) =       0.000417539428
  error estimate for blocks of size 2^( 3) =       0.000425782821
  error estimate for blocks of size 2^( 4) =       0.000431871315
  error estimate for blocks of size 2^( 5) =       0.000437092984
  error estimate for blocks of size 2^( 6) =       0.000439922012
  error estimate for blocks of size 2^( 7) =       0.000441804124

      target function =                  N/A
              le_mean =     -17.217253918388
             les_mean =     296.766837073200
             stat err =       0.000437672609
             autocorr =       1.150477959767
              std dev =       0.577065637051
             le_variance =       0.333004749465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100646464
                                         uncertainty =       0.005322523458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100646464
                                         uncertainty =       0.005322523458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408047029
  error estimate for blocks of size 2^( 2) =       0.000417539432
  error estimate for blocks of size 2^( 3) =       0.000425782825
  error estimate for blocks of size 2^( 4) =       0.000431871319
  error estimate for blocks of size 2^( 5) =       0.000437092987
  error estimate for blocks of size 2^( 6) =       0.000439922015
  error estimate for blocks of size 2^( 7) =       0.000441804127

      target function =                  N/A
              le_mean =     -17.217253918420
             les_mean =     296.766837080965
             stat err =       0.000437672612
             autocorr =       1.150477955915
              std dev =       0.577065642816
             le_variance =       0.333004756118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100643133
                                         uncertainty =       0.005322523407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100643133
                                         uncertainty =       0.005322523407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408047027
  error estimate for blocks of size 2^( 2) =       0.000417539430
  error estimate for blocks of size 2^( 3) =       0.000425782823
  error estimate for blocks of size 2^( 4) =       0.000431871317
  error estimate for blocks of size 2^( 5) =       0.000437092986
  error estimate for blocks of size 2^( 6) =       0.000439922014
  error estimate for blocks of size 2^( 7) =       0.000441804126

      target function =                  N/A
              le_mean =     -17.217253918404
             les_mean =     296.766837077083
             stat err =       0.000437672610
             autocorr =       1.150477957838
              std dev =       0.577065639933
             le_variance =       0.333004752792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100640219
                                         uncertainty =       0.005322523363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333100640219
                                         uncertainty =       0.005322523363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408047025
  error estimate for blocks of size 2^( 2) =       0.000417539429
  error estimate for blocks of size 2^( 3) =       0.000425782821
  error estimate for blocks of size 2^( 4) =       0.000431871315
  error estimate for blocks of size 2^( 5) =       0.000437092984
  error estimate for blocks of size 2^( 6) =       0.000439922012
  error estimate for blocks of size 2^( 7) =       0.000441804124

      target function =                  N/A
              le_mean =     -17.217253918390
             les_mean =     296.766837073685
             stat err =       0.000437672609
             autocorr =       1.150477959522
              std dev =       0.577065637411
             le_variance =       0.333004749881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217253918388        initial
     1.5259e+04     1.5259e+05             1.9934e-08       -17.217253918420  <--
     6.1035e+04     6.1035e+05             4.9836e-09       -17.217253918404
     2.4414e+05     2.4414e+06             1.2459e-09       -17.217253918390

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 2.9484e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092097e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389086e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.3224
    reference variance = 0.251811
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1500e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315033280733
                                         uncertainty =       0.003096240877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315033280733
                                         uncertainty =       0.003096240877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396863656
  error estimate for blocks of size 2^( 2) =       0.000406533549
  error estimate for blocks of size 2^( 3) =       0.000415152645
  error estimate for blocks of size 2^( 4) =       0.000421674840
  error estimate for blocks of size 2^( 5) =       0.000426016761
  error estimate for blocks of size 2^( 6) =       0.000428253094
  error estimate for blocks of size 2^( 7) =       0.000428283860

      target function =                  N/A
              le_mean =     -17.216131887820
             les_mean =     296.710198544143
             stat err =       0.000426057139
             autocorr =       1.152532112895
              std dev =       0.561249964662
             le_variance =       0.315001522833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613188782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131887820       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131887790       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131887624       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131887406       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216131887385       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216131887453       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216131887464       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 8.121317e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131887820       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131887813       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131887771       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131887717       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216131887706       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216131887729       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216131887748       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.030382e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131887820       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131887818       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131887808       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131887782       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216131887801       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216131887837       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216131887735       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 5.075988e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6334e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092103e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391691e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109012e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741230e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2612
    reference variance = 0.369535
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1800e-01
  Total weights = 2.0000e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114578582
                                         uncertainty =       0.002941725880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114578582
                                         uncertainty =       0.002941725880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398748295
  error estimate for blocks of size 2^( 2) =       0.000408500271
  error estimate for blocks of size 2^( 3) =       0.000417812146
  error estimate for blocks of size 2^( 4) =       0.000424571647
  error estimate for blocks of size 2^( 5) =       0.000428561166
  error estimate for blocks of size 2^( 6) =       0.000432183257
  error estimate for blocks of size 2^( 7) =       0.000434656208

      target function =                  N/A
              le_mean =     -17.215694484591
             les_mean =     296.698136832795
             stat err =       0.000429993069
             autocorr =       1.162854115146
              std dev =       0.563915246313
             le_variance =       0.318000405024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114599158
                                         uncertainty =       0.002941725875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114599158
                                         uncertainty =       0.002941725875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398748308
  error estimate for blocks of size 2^( 2) =       0.000408500283
  error estimate for blocks of size 2^( 3) =       0.000417812159
  error estimate for blocks of size 2^( 4) =       0.000424571659
  error estimate for blocks of size 2^( 5) =       0.000428561178
  error estimate for blocks of size 2^( 6) =       0.000432183269
  error estimate for blocks of size 2^( 7) =       0.000434656221

      target function =                  N/A
              le_mean =     -17.215694483992
             les_mean =     296.698136832727
             stat err =       0.000429993082
             autocorr =       1.162854107490
              std dev =       0.563915264534
             le_variance =       0.318000425574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114588871
                                         uncertainty =       0.002941725877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114588871
                                         uncertainty =       0.002941725877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398748301
  error estimate for blocks of size 2^( 2) =       0.000408500277
  error estimate for blocks of size 2^( 3) =       0.000417812152
  error estimate for blocks of size 2^( 4) =       0.000424571653
  error estimate for blocks of size 2^( 5) =       0.000428561172
  error estimate for blocks of size 2^( 6) =       0.000432183263
  error estimate for blocks of size 2^( 7) =       0.000434656215

      target function =                  N/A
              le_mean =     -17.215694484291
             les_mean =     296.698136832760
             stat err =       0.000429993076
             autocorr =       1.162854111311
              std dev =       0.563915255424
             le_variance =       0.318000415300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114579868
                                         uncertainty =       0.002941725879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114579868
                                         uncertainty =       0.002941725879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398748295
  error estimate for blocks of size 2^( 2) =       0.000408500271
  error estimate for blocks of size 2^( 3) =       0.000417812147
  error estimate for blocks of size 2^( 4) =       0.000424571648
  error estimate for blocks of size 2^( 5) =       0.000428561167
  error estimate for blocks of size 2^( 6) =       0.000432183258
  error estimate for blocks of size 2^( 7) =       0.000434656209

      target function =                  N/A
              le_mean =     -17.215694484553
             les_mean =     296.698136832791
             stat err =       0.000429993070
             autocorr =       1.162854114661
              std dev =       0.563915247452
             le_variance =       0.318000406308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215694484591        initial  <--
     3.8147e+03     3.8147e+04             8.1213e-08       -17.215694483992
     1.5259e+04     1.5259e+05             2.0304e-08       -17.215694484291
     6.1035e+04     6.1035e+05             5.0760e-09       -17.215694484553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5694
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092097e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389086e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.346276
====================================================
  Execution time = 2.1083e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313430856604
                                         uncertainty =       0.002399076352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313430856604
                                         uncertainty =       0.002399076352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395810013
  error estimate for blocks of size 2^( 2) =       0.000405542519
  error estimate for blocks of size 2^( 3) =       0.000414193235
  error estimate for blocks of size 2^( 4) =       0.000420447527
  error estimate for blocks of size 2^( 5) =       0.000424365158
  error estimate for blocks of size 2^( 6) =       0.000427973638
  error estimate for blocks of size 2^( 7) =       0.000429743558

      target function =                  N/A
              le_mean =     -17.216227445786
             les_mean =     296.711818441923
             stat err =       0.000425632470
             autocorr =       1.156367689880
              std dev =       0.559759889195
             le_variance =       0.313331133552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622744579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216227445786       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216227445758       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216227445742       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216227445744       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216227445769       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216227445746       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216227445758       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216227445758       residual = 9.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.381167e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216227445786       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216227445779       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216227445775       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216227445686       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216227445782       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216227445819       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216227445820       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216227445817       residual = 9.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.345295e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216227445786       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216227445784       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216227445783       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216227445783       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216227446278       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216227445807       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216227445814       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216227446057       residual = 9.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.363238e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6595e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093615e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571759e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092098e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389086e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136612e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.25953
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1521e-01
  Total weights = 2.0000e+06
  Execution time = 1.8324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042295978
                                         uncertainty =       0.003771570062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042295978
                                         uncertainty =       0.003771570062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396992292
  error estimate for blocks of size 2^( 2) =       0.000407212473
  error estimate for blocks of size 2^( 3) =       0.000415850176
  error estimate for blocks of size 2^( 4) =       0.000423177724
  error estimate for blocks of size 2^( 5) =       0.000427148033
  error estimate for blocks of size 2^( 6) =       0.000430111301
  error estimate for blocks of size 2^( 7) =       0.000431578907

      target function =                  N/A
              le_mean =     -17.216297784805
             les_mean =     296.716115017258
             stat err =       0.000428003991
             autocorr =       1.162335463288
              std dev =       0.561431883484
             le_variance =       0.315205759792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042298161
                                         uncertainty =       0.003771570085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042298161
                                         uncertainty =       0.003771570085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396992293
  error estimate for blocks of size 2^( 2) =       0.000407212474
  error estimate for blocks of size 2^( 3) =       0.000415850177
  error estimate for blocks of size 2^( 4) =       0.000423177726
  error estimate for blocks of size 2^( 5) =       0.000427148034
  error estimate for blocks of size 2^( 6) =       0.000430111302
  error estimate for blocks of size 2^( 7) =       0.000431578908

      target function =                  N/A
              le_mean =     -17.216297784813
             les_mean =     296.716115019744
             stat err =       0.000428003992
             autocorr =       1.162335462147
              std dev =       0.561431885429
             le_variance =       0.315205761976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042297070
                                         uncertainty =       0.003771570073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042297070
                                         uncertainty =       0.003771570073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396992293
  error estimate for blocks of size 2^( 2) =       0.000407212474
  error estimate for blocks of size 2^( 3) =       0.000415850176
  error estimate for blocks of size 2^( 4) =       0.000423177725
  error estimate for blocks of size 2^( 5) =       0.000427148033
  error estimate for blocks of size 2^( 6) =       0.000430111301
  error estimate for blocks of size 2^( 7) =       0.000431578907

      target function =                  N/A
              le_mean =     -17.216297784809
             les_mean =     296.716115018501
             stat err =       0.000428003992
             autocorr =       1.162335462723
              std dev =       0.561431884456
             le_variance =       0.315205760884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042296115
                                         uncertainty =       0.003771570063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315042296115
                                         uncertainty =       0.003771570063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396992292
  error estimate for blocks of size 2^( 2) =       0.000407212473
  error estimate for blocks of size 2^( 3) =       0.000415850176
  error estimate for blocks of size 2^( 4) =       0.000423177724
  error estimate for blocks of size 2^( 5) =       0.000427148033
  error estimate for blocks of size 2^( 6) =       0.000430111301
  error estimate for blocks of size 2^( 7) =       0.000431578907

      target function =                  N/A
              le_mean =     -17.216297784805
             les_mean =     296.716115017413
             stat err =       0.000428003991
             autocorr =       1.162335463225
              std dev =       0.561431883606
             le_variance =       0.315205759929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216297784805        initial
     3.8147e+04     3.8147e+05             5.3812e-09       -17.216297784813  <--
     1.5259e+05     1.5259e+06             1.3453e-09       -17.216297784809
     6.1035e+05     6.1035e+06             3.3632e-10       -17.216297784805

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9963e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314511e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569696e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092099e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389086e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1688
    reference variance = 0.222409
====================================================
  Execution time = 2.0708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314577387299
                                         uncertainty =       0.002825885200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314577387299
                                         uncertainty =       0.002825885200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396554852
  error estimate for blocks of size 2^( 2) =       0.000406391057
  error estimate for blocks of size 2^( 3) =       0.000414840763
  error estimate for blocks of size 2^( 4) =       0.000421677880
  error estimate for blocks of size 2^( 5) =       0.000425620150
  error estimate for blocks of size 2^( 6) =       0.000427766864
  error estimate for blocks of size 2^( 7) =       0.000427310297

      target function =                  N/A
              le_mean =     -17.215968603950
             les_mean =     296.704086316314
             stat err =       0.000425593798
             autocorr =       1.151818486114
              std dev =       0.560813249997
             le_variance =       0.314511501372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596860395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215968603950       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215968603952       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215968604004       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215968603960       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215968603927       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215968603951       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215968603943       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.701317e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215968603950       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215968603951       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215968603964       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215968603952       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215968603866       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215968603875       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215968603944       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.753359e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215968603950       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215968603950       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215968603954       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215968603987       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215968603950       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215968604045       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215968604002       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.688343e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6191e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928619e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095832e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374803e-02 1 1  ON 12
 ud_3                -7.569697e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092101e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690923e-01 1 1  ON 21
 eO_2                -5.389086e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764838e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741230e-02 1 1  ON 44
eH2_5                 3.136611e-02 1 1  ON 45
eH2_6                 7.872144e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2487
    reference variance = 0.261138
====================================================
  Execution time = 2.0098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1699e-01
  Total weights = 2.0000e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018320518
                                         uncertainty =       0.003281702109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018320518
                                         uncertainty =       0.003281702109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398113172
  error estimate for blocks of size 2^( 2) =       0.000408241933
  error estimate for blocks of size 2^( 3) =       0.000417178598
  error estimate for blocks of size 2^( 4) =       0.000423271646
  error estimate for blocks of size 2^( 5) =       0.000426904176
  error estimate for blocks of size 2^( 6) =       0.000429644806
  error estimate for blocks of size 2^( 7) =       0.000432816959

      target function =                  N/A
              le_mean =     -17.217472255900
             les_mean =     296.758338919324
             stat err =       0.000428159397
             autocorr =       1.156639091792
              std dev =       0.563017046931
             le_variance =       0.316988195134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018328106
                                         uncertainty =       0.003281702267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018328106
                                         uncertainty =       0.003281702267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398113177
  error estimate for blocks of size 2^( 2) =       0.000408241937
  error estimate for blocks of size 2^( 3) =       0.000417178602
  error estimate for blocks of size 2^( 4) =       0.000423271650
  error estimate for blocks of size 2^( 5) =       0.000426904180
  error estimate for blocks of size 2^( 6) =       0.000429644810
  error estimate for blocks of size 2^( 7) =       0.000432816962

      target function =                  N/A
              le_mean =     -17.217472255929
             les_mean =     296.758338927906
             stat err =       0.000428159401
             autocorr =       1.156639085566
              std dev =       0.563017053671
             le_variance =       0.316988202724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018324312
                                         uncertainty =       0.003281702188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018324312
                                         uncertainty =       0.003281702188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398113174
  error estimate for blocks of size 2^( 2) =       0.000408241935
  error estimate for blocks of size 2^( 3) =       0.000417178600
  error estimate for blocks of size 2^( 4) =       0.000423271648
  error estimate for blocks of size 2^( 5) =       0.000426904178
  error estimate for blocks of size 2^( 6) =       0.000429644808
  error estimate for blocks of size 2^( 7) =       0.000432816961

      target function =                  N/A
              le_mean =     -17.217472255914
             les_mean =     296.758338923615
             stat err =       0.000428159399
             autocorr =       1.156639088679
              std dev =       0.563017050301
             le_variance =       0.316988198929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018320993
                                         uncertainty =       0.003281702119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317018320993
                                         uncertainty =       0.003281702119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398113172
  error estimate for blocks of size 2^( 2) =       0.000408241933
  error estimate for blocks of size 2^( 3) =       0.000417178598
  error estimate for blocks of size 2^( 4) =       0.000423271646
  error estimate for blocks of size 2^( 5) =       0.000426904176
  error estimate for blocks of size 2^( 6) =       0.000429644806
  error estimate for blocks of size 2^( 7) =       0.000432816959

      target function =                  N/A
              le_mean =     -17.217472255902
             les_mean =     296.758338919860
             stat err =       0.000428159397
             autocorr =       1.156639091413
              std dev =       0.563017047352
             le_variance =       0.316988195609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217472255900        initial
     9.5367e+03     9.5367e+04             2.7013e-08       -17.217472255929  <--
     3.8147e+04     3.8147e+05             6.7534e-09       -17.217472255914
     1.5259e+05     1.5259e+06             1.6883e-09       -17.217472255902

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9344e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5623e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.136
    reference variance = 1.22125
====================================================
  Execution time = 2.0891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2463e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324658645760
                                         uncertainty =       0.004839357913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324658645760
                                         uncertainty =       0.004839357913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402882294
  error estimate for blocks of size 2^( 2) =       0.000412356618
  error estimate for blocks of size 2^( 3) =       0.000421143436
  error estimate for blocks of size 2^( 4) =       0.000427568083
  error estimate for blocks of size 2^( 5) =       0.000432094462
  error estimate for blocks of size 2^( 6) =       0.000433828730
  error estimate for blocks of size 2^( 7) =       0.000433906169

      target function =                  N/A
              le_mean =     -17.216418863229
             les_mean =     296.729706597159
             stat err =       0.000431849361
             autocorr =       1.148968705841
              std dev =       0.569761603950
             le_variance =       0.324628285335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641886323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418863229       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418863164       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216418863137       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216418863349       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216418863426       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216418863465       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216418863459       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.127301e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418863229       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418863213       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216418863206       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216418863259       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216418863274       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216418863283       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216418863279       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.818341e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216418863229       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216418863225       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216418863223       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216418863236       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216418863253       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216418863245       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216418863237       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.045909e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6604e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289811e-02 1 1  ON 1
 uu_2                -4.314509e-02 1 1  ON 2
 uu_3                -9.928621e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095830e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569699e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092112e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298292e-01 1 1  ON 27
 eO_8                 3.095417e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842460e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667154e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741229e-02 1 1  ON 44
eH2_5                 3.136608e-02 1 1  ON 45
eH2_6                 7.872142e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.237248
====================================================
  Execution time = 2.2469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2572e-01
  Total weights = 2.0000e+06
  Execution time = 1.8401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732556279
                                         uncertainty =       0.005259033341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732556279
                                         uncertainty =       0.005259033341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403557952
  error estimate for blocks of size 2^( 2) =       0.000413111878
  error estimate for blocks of size 2^( 3) =       0.000421418605
  error estimate for blocks of size 2^( 4) =       0.000427305416
  error estimate for blocks of size 2^( 5) =       0.000431683991
  error estimate for blocks of size 2^( 6) =       0.000435112196
  error estimate for blocks of size 2^( 7) =       0.000438351719

      target function =                  N/A
              le_mean =     -17.216059961233
             les_mean =     296.718438467887
             stat err =       0.000433113331
             autocorr =       1.151837681991
              std dev =       0.570717129550
             le_variance =       0.325718041962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732576592
                                         uncertainty =       0.005259033464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732576592
                                         uncertainty =       0.005259033464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403557965
  error estimate for blocks of size 2^( 2) =       0.000413111891
  error estimate for blocks of size 2^( 3) =       0.000421418617
  error estimate for blocks of size 2^( 4) =       0.000427305428
  error estimate for blocks of size 2^( 5) =       0.000431684004
  error estimate for blocks of size 2^( 6) =       0.000435112207
  error estimate for blocks of size 2^( 7) =       0.000438351730

      target function =                  N/A
              le_mean =     -17.216059960819
             les_mean =     296.718438473913
             stat err =       0.000433113343
             autocorr =       1.151837673356
              std dev =       0.570717147334
             le_variance =       0.325718062261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732566434
                                         uncertainty =       0.005259033403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732566434
                                         uncertainty =       0.005259033403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403557959
  error estimate for blocks of size 2^( 2) =       0.000413111885
  error estimate for blocks of size 2^( 3) =       0.000421418611
  error estimate for blocks of size 2^( 4) =       0.000427305422
  error estimate for blocks of size 2^( 5) =       0.000431683997
  error estimate for blocks of size 2^( 6) =       0.000435112202
  error estimate for blocks of size 2^( 7) =       0.000438351725

      target function =                  N/A
              le_mean =     -17.216059961026
             les_mean =     296.718438470897
             stat err =       0.000433113337
             autocorr =       1.151837677673
              std dev =       0.570717138441
             le_variance =       0.325718052110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732557548
                                         uncertainty =       0.005259033349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325732557548
                                         uncertainty =       0.005259033349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403557953
  error estimate for blocks of size 2^( 2) =       0.000413111879
  error estimate for blocks of size 2^( 3) =       0.000421418605
  error estimate for blocks of size 2^( 4) =       0.000427305417
  error estimate for blocks of size 2^( 5) =       0.000431683992
  error estimate for blocks of size 2^( 6) =       0.000435112197
  error estimate for blocks of size 2^( 7) =       0.000438351720

      target function =                  N/A
              le_mean =     -17.216059961207
             les_mean =     296.718438468263
             stat err =       0.000433113331
             autocorr =       1.151837681452
              std dev =       0.570717130661
             le_variance =       0.325718043230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216059961233        initial  <--
     2.3842e+03     2.3842e+04             1.1273e-07       -17.216059960819
     9.5367e+03     9.5367e+04             2.8183e-08       -17.216059961026
     3.8147e+04     3.8147e+05             7.0459e-09       -17.216059961207

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7453
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.364629
====================================================
  Execution time = 2.0875e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018393694
                                         uncertainty =       0.004685757605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018393694
                                         uncertainty =       0.004685757605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400617404
  error estimate for blocks of size 2^( 2) =       0.000409499016
  error estimate for blocks of size 2^( 3) =       0.000418260855
  error estimate for blocks of size 2^( 4) =       0.000424938086
  error estimate for blocks of size 2^( 5) =       0.000428479402
  error estimate for blocks of size 2^( 6) =       0.000430888573
  error estimate for blocks of size 2^( 7) =       0.000429993323

      target function =                  N/A
              le_mean =     -17.216500044638
             les_mean =     296.728862235580
             stat err =       0.000428574846
             autocorr =       1.144441847848
              std dev =       0.566558566301
             le_variance =       0.320988609049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650004464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500044638       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500044625       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500044634       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500044661       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500044665       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500044670       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500044653       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.526235e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500044638       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500044635       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500044637       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500044646       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500044657       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500044637       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500044658       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.131569e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500044638       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500044637       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500044638       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500044639       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216500044652       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500044591       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500044740       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.328929e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6461e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314509e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092107e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109012e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.116252
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1773e-01
  Total weights = 2.0000e+06
  Execution time = 1.8367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757462386
                                         uncertainty =       0.004466839049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757462386
                                         uncertainty =       0.004466839049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398581860
  error estimate for blocks of size 2^( 2) =       0.000407984478
  error estimate for blocks of size 2^( 3) =       0.000416856322
  error estimate for blocks of size 2^( 4) =       0.000423234119
  error estimate for blocks of size 2^( 5) =       0.000427121401
  error estimate for blocks of size 2^( 6) =       0.000428381279
  error estimate for blocks of size 2^( 7) =       0.000428832712

      target function =                  N/A
              le_mean =     -17.217191195838
             les_mean =     296.749407512631
             stat err =       0.000426892378
             autocorr =       1.147101223747
              std dev =       0.563679871428
             le_variance =       0.317734997453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757464105
                                         uncertainty =       0.004466839146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757464105
                                         uncertainty =       0.004466839146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398581861
  error estimate for blocks of size 2^( 2) =       0.000407984479
  error estimate for blocks of size 2^( 3) =       0.000416856323
  error estimate for blocks of size 2^( 4) =       0.000423234120
  error estimate for blocks of size 2^( 5) =       0.000427121401
  error estimate for blocks of size 2^( 6) =       0.000428381280
  error estimate for blocks of size 2^( 7) =       0.000428832713

      target function =                  N/A
              le_mean =     -17.217191195826
             les_mean =     296.749407513935
             stat err =       0.000426892379
             autocorr =       1.147101221545
              std dev =       0.563679872952
             le_variance =       0.317734999172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757463245
                                         uncertainty =       0.004466839098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757463245
                                         uncertainty =       0.004466839098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398581860
  error estimate for blocks of size 2^( 2) =       0.000407984478
  error estimate for blocks of size 2^( 3) =       0.000416856322
  error estimate for blocks of size 2^( 4) =       0.000423234119
  error estimate for blocks of size 2^( 5) =       0.000427121401
  error estimate for blocks of size 2^( 6) =       0.000428381280
  error estimate for blocks of size 2^( 7) =       0.000428832712

      target function =                  N/A
              le_mean =     -17.217191195832
             les_mean =     296.749407513283
             stat err =       0.000426892378
             autocorr =       1.147101222636
              std dev =       0.563679872191
             le_variance =       0.317734998313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757462494
                                         uncertainty =       0.004466839055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317757462494
                                         uncertainty =       0.004466839055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398581860
  error estimate for blocks of size 2^( 2) =       0.000407984478
  error estimate for blocks of size 2^( 3) =       0.000416856322
  error estimate for blocks of size 2^( 4) =       0.000423234119
  error estimate for blocks of size 2^( 5) =       0.000427121401
  error estimate for blocks of size 2^( 6) =       0.000428381280
  error estimate for blocks of size 2^( 7) =       0.000428832712

      target function =                  N/A
              le_mean =     -17.217191195837
             les_mean =     296.749407512713
             stat err =       0.000426892378
             autocorr =       1.147101223606
              std dev =       0.563679871524
             le_variance =       0.317734997561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217191195838        initial  <--
     2.3842e+04     2.3842e+05             8.5262e-09       -17.217191195826
     9.5367e+04     9.5367e+05             2.1316e-09       -17.217191195832
     3.8147e+05     3.8147e+06             5.3289e-10       -17.217191195837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4449
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.209377
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.6991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369894106648
                                         uncertainty =       0.036345956336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369894106648
                                         uncertainty =       0.036345956336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430064503
  error estimate for blocks of size 2^( 2) =       0.000439405384
  error estimate for blocks of size 2^( 3) =       0.000447641585
  error estimate for blocks of size 2^( 4) =       0.000453835546
  error estimate for blocks of size 2^( 5) =       0.000457007899
  error estimate for blocks of size 2^( 6) =       0.000458343124
  error estimate for blocks of size 2^( 7) =       0.000458778100

      target function =                  N/A
              le_mean =     -17.216522638750
             les_mean =     296.778562538301
             stat err =       0.000456991167
             autocorr =       1.129141624644
              std dev =       0.608203052155
             le_variance =       0.369910952650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652263875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522638750       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522638751       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216522638751       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216522638750       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216522638828       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216522638776       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216522638539       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.193034e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522638750       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522638751       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216522638751       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216522638750       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216522638143       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216522638470       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216522638709       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.982585e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522638750       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522638750       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216522638750       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216522637495       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216522640764       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216522638214       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216522636428       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.456467e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6284e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.32219
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1482e-01
  Total weights = 2.0000e+06
  Execution time = 1.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365061
                                         uncertainty =       0.002715387527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365061
                                         uncertainty =       0.002715387527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396749241
  error estimate for blocks of size 2^( 2) =       0.000406718981
  error estimate for blocks of size 2^( 3) =       0.000415194809
  error estimate for blocks of size 2^( 4) =       0.000421507757
  error estimate for blocks of size 2^( 5) =       0.000426609758
  error estimate for blocks of size 2^( 6) =       0.000428426190
  error estimate for blocks of size 2^( 7) =       0.000428415894

      target function =                  N/A
              le_mean =     -17.217037036054
             les_mean =     296.741184063474
             stat err =       0.000426239900
             autocorr =       1.154186509270
              std dev =       0.561088157104
             le_variance =       0.314819920043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750366202
                                         uncertainty =       0.002715387535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750366202
                                         uncertainty =       0.002715387535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396749241
  error estimate for blocks of size 2^( 2) =       0.000406718982
  error estimate for blocks of size 2^( 3) =       0.000415194810
  error estimate for blocks of size 2^( 4) =       0.000421507758
  error estimate for blocks of size 2^( 5) =       0.000426609759
  error estimate for blocks of size 2^( 6) =       0.000428426191
  error estimate for blocks of size 2^( 7) =       0.000428415895

      target function =                  N/A
              le_mean =     -17.217037036041
             les_mean =     296.741184064183
             stat err =       0.000426239901
             autocorr =       1.154186508455
              std dev =       0.561088158121
             le_variance =       0.314819921184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365631
                                         uncertainty =       0.002715387531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365631
                                         uncertainty =       0.002715387531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396749241
  error estimate for blocks of size 2^( 2) =       0.000406718982
  error estimate for blocks of size 2^( 3) =       0.000415194809
  error estimate for blocks of size 2^( 4) =       0.000421507757
  error estimate for blocks of size 2^( 5) =       0.000426609759
  error estimate for blocks of size 2^( 6) =       0.000428426191
  error estimate for blocks of size 2^( 7) =       0.000428415894

      target function =                  N/A
              le_mean =     -17.217037036047
             les_mean =     296.741184063829
             stat err =       0.000426239900
             autocorr =       1.154186508853
              std dev =       0.561088157613
             le_variance =       0.314819920613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365132
                                         uncertainty =       0.002715387527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314750365132
                                         uncertainty =       0.002715387527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396749241
  error estimate for blocks of size 2^( 2) =       0.000406718982
  error estimate for blocks of size 2^( 3) =       0.000415194809
  error estimate for blocks of size 2^( 4) =       0.000421507757
  error estimate for blocks of size 2^( 5) =       0.000426609759
  error estimate for blocks of size 2^( 6) =       0.000428426190
  error estimate for blocks of size 2^( 7) =       0.000428415894

      target function =                  N/A
              le_mean =     -17.217037036053
             les_mean =     296.741184063518
             stat err =       0.000426239900
             autocorr =       1.154186509218
              std dev =       0.561088157168
             le_variance =       0.314819920114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217037036054        initial  <--
     2.3842e+05     2.3842e+06             1.1930e-09       -17.217037036041
     9.5367e+05     9.5367e+06             2.9826e-10       -17.217037036047
     3.8147e+06     3.8147e+07             7.4565e-11       -17.217037036053

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7665
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2365
    reference variance = 0.267606
====================================================
  Execution time = 2.1120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0913e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309165845144
                                         uncertainty =       0.002336555412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309165845144
                                         uncertainty =       0.002336555412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393149990
  error estimate for blocks of size 2^( 2) =       0.000403286814
  error estimate for blocks of size 2^( 3) =       0.000412062292
  error estimate for blocks of size 2^( 4) =       0.000418658294
  error estimate for blocks of size 2^( 5) =       0.000423440806
  error estimate for blocks of size 2^( 6) =       0.000426669808
  error estimate for blocks of size 2^( 7) =       0.000429309150

      target function =                  N/A
              le_mean =     -17.216970486861
             les_mean =     296.733206419783
             stat err =       0.000424519515
             autocorr =       1.165946922346
              std dev =       0.555998047570
             le_variance =       0.309133828901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697048686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216970486861       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216970486861       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216970486861       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216970486055       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216970486752       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216970477991       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216970488279       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.310504e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216970486861       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216970486861       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216970486861       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216970487025       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216970486994       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216970489633       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216970486706       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 3.276222e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216970486861       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216970486861       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216970486861       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216970486268       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216970462553       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216970486678       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216970487215       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 8.190786e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6840e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.556083
====================================================
  Execution time = 2.0732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2447e-01
  Total weights = 2.0000e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856940
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856940
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402786889
  error estimate for blocks of size 2^( 2) =       0.000412294505
  error estimate for blocks of size 2^( 3) =       0.000421237770
  error estimate for blocks of size 2^( 4) =       0.000428491072
  error estimate for blocks of size 2^( 5) =       0.000432867393
  error estimate for blocks of size 2^( 6) =       0.000433141495
  error estimate for blocks of size 2^( 7) =       0.000433078498

      target function =                  N/A
              le_mean =     -17.216608180601
             les_mean =     296.736071638537
             stat err =       0.000431894615
             autocorr =       1.149753991850
              std dev =       0.569626681630
             le_variance =       0.324474556425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856958
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856958
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402786889
  error estimate for blocks of size 2^( 2) =       0.000412294505
  error estimate for blocks of size 2^( 3) =       0.000421237770
  error estimate for blocks of size 2^( 4) =       0.000428491072
  error estimate for blocks of size 2^( 5) =       0.000432867393
  error estimate for blocks of size 2^( 6) =       0.000433141495
  error estimate for blocks of size 2^( 7) =       0.000433078498

      target function =                  N/A
              le_mean =     -17.216608180601
             les_mean =     296.736071638554
             stat err =       0.000431894615
             autocorr =       1.149753991827
              std dev =       0.569626681646
             le_variance =       0.324474556443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856949
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856949
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402786889
  error estimate for blocks of size 2^( 2) =       0.000412294505
  error estimate for blocks of size 2^( 3) =       0.000421237770
  error estimate for blocks of size 2^( 4) =       0.000428491072
  error estimate for blocks of size 2^( 5) =       0.000432867393
  error estimate for blocks of size 2^( 6) =       0.000433141495
  error estimate for blocks of size 2^( 7) =       0.000433078498

      target function =                  N/A
              le_mean =     -17.216608180601
             les_mean =     296.736071638546
             stat err =       0.000431894615
             autocorr =       1.149753991836
              std dev =       0.569626681638
             le_variance =       0.324474556434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856941
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324511856941
                                         uncertainty =       0.005156118747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402786889
  error estimate for blocks of size 2^( 2) =       0.000412294505
  error estimate for blocks of size 2^( 3) =       0.000421237770
  error estimate for blocks of size 2^( 4) =       0.000428491072
  error estimate for blocks of size 2^( 5) =       0.000432867393
  error estimate for blocks of size 2^( 6) =       0.000433141495
  error estimate for blocks of size 2^( 7) =       0.000433078498

      target function =                  N/A
              le_mean =     -17.216608180601
             les_mean =     296.736071638538
             stat err =       0.000431894615
             autocorr =       1.149753991852
              std dev =       0.569626681631
             le_variance =       0.324474556426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216608180601        initial  <--
     2.3842e+06     2.3842e+07             1.3105e-10       -17.216608180601
     9.5367e+06     9.5367e+07             3.2762e-11       -17.216608180601
     3.8147e+07     3.8147e+08             8.1908e-12       -17.216608180601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9596
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2174
    reference variance = 0.359815
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1696e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317006670715
                                         uncertainty =       0.002964757861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317006670715
                                         uncertainty =       0.002964757861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398094280
  error estimate for blocks of size 2^( 2) =       0.000407913538
  error estimate for blocks of size 2^( 3) =       0.000416377243
  error estimate for blocks of size 2^( 4) =       0.000422707532
  error estimate for blocks of size 2^( 5) =       0.000426592944
  error estimate for blocks of size 2^( 6) =       0.000428632089
  error estimate for blocks of size 2^( 7) =       0.000427433222

      target function =                  N/A
              le_mean =     -17.216929175677
             les_mean =     296.739608193058
             stat err =       0.000426341447
             autocorr =       1.146946698238
              std dev =       0.562990329631
             le_variance =       0.316958111258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692917568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929175677       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929175677       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929175677       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929180730       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929186718       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929168506       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929176836       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 7.552538e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929175677       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929175677       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929175677       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929274411       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929177500       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929218380       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929161711       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 1.888552e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929175677       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929175677       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216929175677       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216929177595       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216929178731       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216929270729       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929071458       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 4.720895e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6281e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1941
    reference variance = 0.207721
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2316e-01
  Total weights = 2.0000e+06
  Execution time = 1.8447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886631
                                         uncertainty =       0.006390053479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886631
                                         uncertainty =       0.006390053479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401973129
  error estimate for blocks of size 2^( 2) =       0.000411815190
  error estimate for blocks of size 2^( 3) =       0.000420818687
  error estimate for blocks of size 2^( 4) =       0.000427420752
  error estimate for blocks of size 2^( 5) =       0.000431622249
  error estimate for blocks of size 2^( 6) =       0.000434127440
  error estimate for blocks of size 2^( 7) =       0.000435491160

      target function =                  N/A
              le_mean =     -17.216775260765
             les_mean =     296.740515011663
             stat err =       0.000432165400
             autocorr =       1.155861881104
              std dev =       0.568475851348
             le_variance =       0.323164793565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886635
                                         uncertainty =       0.006390053480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886635
                                         uncertainty =       0.006390053480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401973129
  error estimate for blocks of size 2^( 2) =       0.000411815190
  error estimate for blocks of size 2^( 3) =       0.000420818687
  error estimate for blocks of size 2^( 4) =       0.000427420752
  error estimate for blocks of size 2^( 5) =       0.000431622249
  error estimate for blocks of size 2^( 6) =       0.000434127440
  error estimate for blocks of size 2^( 7) =       0.000435491160

      target function =                  N/A
              le_mean =     -17.216775260765
             les_mean =     296.740515011667
             stat err =       0.000432165400
             autocorr =       1.155861881095
              std dev =       0.568475851351
             le_variance =       0.323164793570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886633
                                         uncertainty =       0.006390053480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886633
                                         uncertainty =       0.006390053480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401973129
  error estimate for blocks of size 2^( 2) =       0.000411815190
  error estimate for blocks of size 2^( 3) =       0.000420818687
  error estimate for blocks of size 2^( 4) =       0.000427420752
  error estimate for blocks of size 2^( 5) =       0.000431622249
  error estimate for blocks of size 2^( 6) =       0.000434127440
  error estimate for blocks of size 2^( 7) =       0.000435491160

      target function =                  N/A
              le_mean =     -17.216775260765
             les_mean =     296.740515011665
             stat err =       0.000432165400
             autocorr =       1.155861881093
              std dev =       0.568475851350
             le_variance =       0.323164793568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886631
                                         uncertainty =       0.006390053479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323175886631
                                         uncertainty =       0.006390053479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401973129
  error estimate for blocks of size 2^( 2) =       0.000411815190
  error estimate for blocks of size 2^( 3) =       0.000420818687
  error estimate for blocks of size 2^( 4) =       0.000427420752
  error estimate for blocks of size 2^( 5) =       0.000431622249
  error estimate for blocks of size 2^( 6) =       0.000434127440
  error estimate for blocks of size 2^( 7) =       0.000435491160

      target function =                  N/A
              le_mean =     -17.216775260765
             les_mean =     296.740515011663
             stat err =       0.000432165400
             autocorr =       1.155861881100
              std dev =       0.568475851348
             le_variance =       0.323164793566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216775260765        initial  <--
     2.3842e+07     2.3842e+08             7.5525e-12       -17.216775260765
     9.5367e+07     9.5367e+08             1.8886e-12       -17.216775260765
     3.8147e+08     3.8147e+09             4.7209e-13       -17.216775260765

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5695
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1707
    reference variance = 0.224419
====================================================
  Execution time = 2.0771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1850e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318417242817
                                         uncertainty =       0.002690032874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318417242817
                                         uncertainty =       0.002690032874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399063310
  error estimate for blocks of size 2^( 2) =       0.000408923218
  error estimate for blocks of size 2^( 3) =       0.000417442395
  error estimate for blocks of size 2^( 4) =       0.000423532435
  error estimate for blocks of size 2^( 5) =       0.000428018776
  error estimate for blocks of size 2^( 6) =       0.000431266857
  error estimate for blocks of size 2^( 7) =       0.000432850389

      target function =                  N/A
              le_mean =     -17.216308181670
             les_mean =     296.719770297870
             stat err =       0.000428917114
             autocorr =       1.155215878656
              std dev =       0.564360745333
             le_variance =       0.318503050872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630818167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308181670       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308181670       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216308181670       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216308196855       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216308160917       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216308369256       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216308234607       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 1.200554e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308181670       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308181670       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216308181670       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216308218685       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216308273774       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216308250798       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216308386777       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 3.001086e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308181670       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308181670       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216308181670       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216308813917       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307576374       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216306925047       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309834920       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 7.528204e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6296e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0861
    reference variance = 0.630961
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.0000e+06
  Execution time = 1.9941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134228
  error estimate for blocks of size 2^( 2) =       0.000420427841
  error estimate for blocks of size 2^( 3) =       0.000428862778
  error estimate for blocks of size 2^( 4) =       0.000434884363
  error estimate for blocks of size 2^( 5) =       0.000439261707
  error estimate for blocks of size 2^( 6) =       0.000442640334
  error estimate for blocks of size 2^( 7) =       0.000442364055

      target function =                  N/A
              le_mean =     -17.216606519654
             les_mean =     296.749602590746
             stat err =       0.000439787615
             autocorr =       1.144244201955
              std dev =       0.581431601461
             le_variance =       0.338062707177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134228
  error estimate for blocks of size 2^( 2) =       0.000420427841
  error estimate for blocks of size 2^( 3) =       0.000428862778
  error estimate for blocks of size 2^( 4) =       0.000434884363
  error estimate for blocks of size 2^( 5) =       0.000439261707
  error estimate for blocks of size 2^( 6) =       0.000442640334
  error estimate for blocks of size 2^( 7) =       0.000442364055

      target function =                  N/A
              le_mean =     -17.216606519654
             les_mean =     296.749602590746
             stat err =       0.000439787615
             autocorr =       1.144244201961
              std dev =       0.581431601461
             le_variance =       0.338062707178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134228
  error estimate for blocks of size 2^( 2) =       0.000420427841
  error estimate for blocks of size 2^( 3) =       0.000428862778
  error estimate for blocks of size 2^( 4) =       0.000434884363
  error estimate for blocks of size 2^( 5) =       0.000439261707
  error estimate for blocks of size 2^( 6) =       0.000442640334
  error estimate for blocks of size 2^( 7) =       0.000442364055

      target function =                  N/A
              le_mean =     -17.216606519654
             les_mean =     296.749602590746
             stat err =       0.000439787615
             autocorr =       1.144244201955
              std dev =       0.581431601461
             le_variance =       0.338062707177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338074222038
                                         uncertainty =       0.018663007695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411134228
  error estimate for blocks of size 2^( 2) =       0.000420427841
  error estimate for blocks of size 2^( 3) =       0.000428862778
  error estimate for blocks of size 2^( 4) =       0.000434884363
  error estimate for blocks of size 2^( 5) =       0.000439261707
  error estimate for blocks of size 2^( 6) =       0.000442640334
  error estimate for blocks of size 2^( 7) =       0.000442364055

      target function =                  N/A
              le_mean =     -17.216606519654
             les_mean =     296.749602590746
             stat err =       0.000439787615
             autocorr =       1.144244201957
              std dev =       0.581431601461
             le_variance =       0.338062707178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216606519654        initial  <--
     2.3842e+08     2.3842e+09             1.2006e-12       -17.216606519654
     9.5367e+08     9.5367e+09             3.0011e-13       -17.216606519654
     3.8147e+09     3.8147e+10             7.5282e-14       -17.216606519654

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2601
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.168745
====================================================
  Execution time = 2.1053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.3109e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331209455353
                                         uncertainty =       0.006495801590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331209455353
                                         uncertainty =       0.006495801590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406873157
  error estimate for blocks of size 2^( 2) =       0.000416480451
  error estimate for blocks of size 2^( 3) =       0.000425163301
  error estimate for blocks of size 2^( 4) =       0.000431333500
  error estimate for blocks of size 2^( 5) =       0.000434396542
  error estimate for blocks of size 2^( 6) =       0.000436703862
  error estimate for blocks of size 2^( 7) =       0.000436175310

      target function =                  N/A
              le_mean =     -17.217760606692
             les_mean =     296.782371675082
             stat err =       0.000434652303
             autocorr =       1.141210856163
              std dev =       0.575405536347
             le_variance =       0.331091531259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721776060669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217760606692       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217760606692       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217760606692       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217760343639       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217760535223       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217760617182       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217759545799       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 9.104528e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217760606692       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217760606692       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217760606692       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217760606692       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217761683353       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217760084634       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217758325943       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 2.274091e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217760606692       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217760606692       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217760606692       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217760546400       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217760072281       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217764832089       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217785632303       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217769844840       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217765634054       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 5.894120e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6567e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.275191
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2103e-01
  Total weights = 2.0000e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400642232
  error estimate for blocks of size 2^( 2) =       0.000410238104
  error estimate for blocks of size 2^( 3) =       0.000419224519
  error estimate for blocks of size 2^( 4) =       0.000426848742
  error estimate for blocks of size 2^( 5) =       0.000430585265
  error estimate for blocks of size 2^( 6) =       0.000434162951
  error estimate for blocks of size 2^( 7) =       0.000435832848

      target function =                  N/A
              le_mean =     -17.216393254955
             les_mean =     296.725224944453
             stat err =       0.000431857451
             autocorr =       1.161896335900
              std dev =       0.566593677774
             le_variance =       0.321028395693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400642232
  error estimate for blocks of size 2^( 2) =       0.000410238104
  error estimate for blocks of size 2^( 3) =       0.000419224519
  error estimate for blocks of size 2^( 4) =       0.000426848742
  error estimate for blocks of size 2^( 5) =       0.000430585265
  error estimate for blocks of size 2^( 6) =       0.000434162951
  error estimate for blocks of size 2^( 7) =       0.000435832848

      target function =                  N/A
              le_mean =     -17.216393254955
             les_mean =     296.725224944453
             stat err =       0.000431857451
             autocorr =       1.161896335908
              std dev =       0.566593677774
             le_variance =       0.321028395693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400642232
  error estimate for blocks of size 2^( 2) =       0.000410238104
  error estimate for blocks of size 2^( 3) =       0.000419224519
  error estimate for blocks of size 2^( 4) =       0.000426848742
  error estimate for blocks of size 2^( 5) =       0.000430585265
  error estimate for blocks of size 2^( 6) =       0.000434162951
  error estimate for blocks of size 2^( 7) =       0.000435832848

      target function =                  N/A
              le_mean =     -17.216393254955
             les_mean =     296.725224944453
             stat err =       0.000431857451
             autocorr =       1.161896335907
              std dev =       0.566593677774
             le_variance =       0.321028395693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321030279386
                                         uncertainty =       0.005093515888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400642232
  error estimate for blocks of size 2^( 2) =       0.000410238104
  error estimate for blocks of size 2^( 3) =       0.000419224519
  error estimate for blocks of size 2^( 4) =       0.000426848742
  error estimate for blocks of size 2^( 5) =       0.000430585265
  error estimate for blocks of size 2^( 6) =       0.000434162951
  error estimate for blocks of size 2^( 7) =       0.000435832848

      target function =                  N/A
              le_mean =     -17.216393254955
             les_mean =     296.725224944453
             stat err =       0.000431857451
             autocorr =       1.161896335899
              std dev =       0.566593677774
             le_variance =       0.321028395693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216393254955        initial  <--
     2.3842e+09     2.3842e+10             9.1045e-14       -17.216393254955
     9.5367e+09     9.5367e+10             2.2741e-14       -17.216393254955
     3.8147e+10     3.8147e+11             5.8941e-15       -17.216393254955

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5603
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1505
    reference variance = 0.251582
====================================================
  Execution time = 2.0879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2478e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324836511598
                                         uncertainty =       0.005192198598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324836511598
                                         uncertainty =       0.005192198598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402975995
  error estimate for blocks of size 2^( 2) =       0.000412489289
  error estimate for blocks of size 2^( 3) =       0.000421142918
  error estimate for blocks of size 2^( 4) =       0.000427588721
  error estimate for blocks of size 2^( 5) =       0.000431409213
  error estimate for blocks of size 2^( 6) =       0.000432613859
  error estimate for blocks of size 2^( 7) =       0.000433529724

      target function =                  N/A
              le_mean =     -17.217161403218
             les_mean =     296.755425926884
             stat err =       0.000431285379
             autocorr =       1.145436766914
              std dev =       0.569894117203
             le_variance =       0.324779304822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716140322e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161403218       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161403218       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161403218       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161484146       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217167214960       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217175828835       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161403218       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217159023600       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 1.557583e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161403218       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161403218       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161403218       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217148536929       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217157147334       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217133665192       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217653017950       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216925715932       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216826024401       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217058865430       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216763208904       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216166303520       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217164879521       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.218500832657       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217336931656       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213227411237       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214111921524       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213179737598       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.224681472171       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217721318778       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.206363197313       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.231711627241       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.207851579081       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.207655186061       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217248445612       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.171536857561       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.204728320250       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.230386419735       residual = 2.59e-02           smallest_sin_value = 9.98e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.211014823044       residual = 6.53e-03           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 3.644804e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161403218       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161403218       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161403218       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176417700       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217341396315       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216149081889       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.220616495596       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216454904338       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216670470069       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.221150317415       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211334772686       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215621316125       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.224643501101       residual = 9.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213255903072       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.226661089184       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.220450959231       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.247780129500       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.233237798772       residual = 4.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.235077633569       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.225661861287       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.220140739469       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.224078455433       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.193387145502       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200037097373       residual = 5.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.238849965054       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.184385826431       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.184966629492       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.175186253721       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.196835979407       residual = 8.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.827209225326       residual = 2.66e+01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.160449433097       residual = 1.29e+00           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.019538e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6461e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.264132
====================================================
  Execution time = 2.0461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1933e-01
  Total weights = 2.0000e+06
  Execution time = 1.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399579823
  error estimate for blocks of size 2^( 2) =       0.000409006872
  error estimate for blocks of size 2^( 3) =       0.000417372949
  error estimate for blocks of size 2^( 4) =       0.000422828707
  error estimate for blocks of size 2^( 5) =       0.000427719504
  error estimate for blocks of size 2^( 6) =       0.000430071820
  error estimate for blocks of size 2^( 7) =       0.000432032678

      target function =                  N/A
              le_mean =     -17.216768076943
             les_mean =     296.736430926100
             stat err =       0.000428163177
             autocorr =       1.148184097952
              std dev =       0.565091205503
             le_variance =       0.319328070537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399579823
  error estimate for blocks of size 2^( 2) =       0.000409006872
  error estimate for blocks of size 2^( 3) =       0.000417372949
  error estimate for blocks of size 2^( 4) =       0.000422828707
  error estimate for blocks of size 2^( 5) =       0.000427719504
  error estimate for blocks of size 2^( 6) =       0.000430071820
  error estimate for blocks of size 2^( 7) =       0.000432032678

      target function =                  N/A
              le_mean =     -17.216768076943
             les_mean =     296.736430926100
             stat err =       0.000428163177
             autocorr =       1.148184097954
              std dev =       0.565091205503
             le_variance =       0.319328070537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399579823
  error estimate for blocks of size 2^( 2) =       0.000409006872
  error estimate for blocks of size 2^( 3) =       0.000417372949
  error estimate for blocks of size 2^( 4) =       0.000422828707
  error estimate for blocks of size 2^( 5) =       0.000427719504
  error estimate for blocks of size 2^( 6) =       0.000430071820
  error estimate for blocks of size 2^( 7) =       0.000432032678

      target function =                  N/A
              le_mean =     -17.216768076943
             les_mean =     296.736430926100
             stat err =       0.000428163177
             autocorr =       1.148184097944
              std dev =       0.565091205503
             le_variance =       0.319328070537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319417749948
                                         uncertainty =       0.005570284414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399579823
  error estimate for blocks of size 2^( 2) =       0.000409006872
  error estimate for blocks of size 2^( 3) =       0.000417372949
  error estimate for blocks of size 2^( 4) =       0.000422828707
  error estimate for blocks of size 2^( 5) =       0.000427719504
  error estimate for blocks of size 2^( 6) =       0.000430071820
  error estimate for blocks of size 2^( 7) =       0.000432032678

      target function =                  N/A
              le_mean =     -17.216768076943
             les_mean =     296.736430926100
             stat err =       0.000428163177
             autocorr =       1.148184097944
              std dev =       0.565091205503
             le_variance =       0.319328070537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216768076943        initial  <--
     2.3842e+10     2.3842e+11             1.5576e-14       -17.216768076943
     9.5367e+10     9.5367e+11             3.6448e-15       -17.216768076943
     3.8147e+11     3.8147e+12             4.0195e-16       -17.216768076943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7434
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2792
    reference variance = 0.2062
====================================================
  Execution time = 2.0520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316847840805
                                         uncertainty =       0.003680108848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316847840805
                                         uncertainty =       0.003680108848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398009081
  error estimate for blocks of size 2^( 2) =       0.000407656120
  error estimate for blocks of size 2^( 3) =       0.000416440691
  error estimate for blocks of size 2^( 4) =       0.000422848368
  error estimate for blocks of size 2^( 5) =       0.000427332114
  error estimate for blocks of size 2^( 6) =       0.000430999876
  error estimate for blocks of size 2^( 7) =       0.000434044270

      target function =                  N/A
              le_mean =     -17.216492095184
             les_mean =     296.724422361797
             stat err =       0.000428806157
             autocorr =       1.160742973382
              std dev =       0.562869839904
             le_variance =       0.316822456673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649209518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492095184       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492095184       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492095184       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490568892       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499793072       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216462603431       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216446920556       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216819041736       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217258606694       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213844062342       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218373633064       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215434869870       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213161766017       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212112338066       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.229622463901       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.212058520792       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.224368626411       residual = 9.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.193192762608       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211648173540       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.210091861153       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219998939540       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.178607531468       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.219350745633       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.224271583207       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.202555857505       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.152623266643       residual = 6.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.231731379593       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.171573442880       residual = 2.87e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.193192025588       residual = 1.37e-01           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 8.620139e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492095184       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492095184       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492095184       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492095184       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6017e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.241
    reference variance = 0.178095
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1507e-01
  Total weights = 2.0000e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907055
  error estimate for blocks of size 2^( 2) =       0.000406648451
  error estimate for blocks of size 2^( 3) =       0.000415467106
  error estimate for blocks of size 2^( 4) =       0.000422604477
  error estimate for blocks of size 2^( 5) =       0.000427737216
  error estimate for blocks of size 2^( 6) =       0.000430234088
  error estimate for blocks of size 2^( 7) =       0.000430789129

      target function =                  N/A
              le_mean =     -17.216923148338
             les_mean =     296.737512958420
             stat err =       0.000427841227
             autocorr =       1.161950497656
              std dev =       0.561311339796
             le_variance =       0.315070420184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907055
  error estimate for blocks of size 2^( 2) =       0.000406648451
  error estimate for blocks of size 2^( 3) =       0.000415467106
  error estimate for blocks of size 2^( 4) =       0.000422604477
  error estimate for blocks of size 2^( 5) =       0.000427737216
  error estimate for blocks of size 2^( 6) =       0.000430234088
  error estimate for blocks of size 2^( 7) =       0.000430789129

      target function =                  N/A
              le_mean =     -17.216923148338
             les_mean =     296.737512958420
             stat err =       0.000427841227
             autocorr =       1.161950497657
              std dev =       0.561311339796
             le_variance =       0.315070420184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907055
  error estimate for blocks of size 2^( 2) =       0.000406648451
  error estimate for blocks of size 2^( 3) =       0.000415467106
  error estimate for blocks of size 2^( 4) =       0.000422604477
  error estimate for blocks of size 2^( 5) =       0.000427737216
  error estimate for blocks of size 2^( 6) =       0.000430234088
  error estimate for blocks of size 2^( 7) =       0.000430789129

      target function =                  N/A
              le_mean =     -17.216923148338
             les_mean =     296.737512958420
             stat err =       0.000427841227
             autocorr =       1.161950497656
              std dev =       0.561311339796
             le_variance =       0.315070420184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315151578337
                                         uncertainty =       0.002875438670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907055
  error estimate for blocks of size 2^( 2) =       0.000406648451
  error estimate for blocks of size 2^( 3) =       0.000415467106
  error estimate for blocks of size 2^( 4) =       0.000422604477
  error estimate for blocks of size 2^( 5) =       0.000427737216
  error estimate for blocks of size 2^( 6) =       0.000430234088
  error estimate for blocks of size 2^( 7) =       0.000430789129

      target function =                  N/A
              le_mean =     -17.216923148338
             les_mean =     296.737512958420
             stat err =       0.000427841227
             autocorr =       1.161950497656
              std dev =       0.561311339796
             le_variance =       0.315070420184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216923148338        initial  <--
     2.3842e+11     2.3842e+12             8.6201e-16       -17.216923148338
     9.5367e+11     9.5367e+12             0.0000e+00       -17.216923148338
     3.8147e+12     3.8147e+13             0.0000e+00       -17.216923148338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8736
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.304097
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1411e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112388758
                                         uncertainty =       0.003008119036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112388758
                                         uncertainty =       0.003008119036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396304128
  error estimate for blocks of size 2^( 2) =       0.000406266584
  error estimate for blocks of size 2^( 3) =       0.000414833648
  error estimate for blocks of size 2^( 4) =       0.000421330668
  error estimate for blocks of size 2^( 5) =       0.000425045125
  error estimate for blocks of size 2^( 6) =       0.000427941617
  error estimate for blocks of size 2^( 7) =       0.000430863915

      target function =                  N/A
              le_mean =     -17.216340356731
             les_mean =     296.716489044753
             stat err =       0.000426295331
             autocorr =       1.157081531633
              std dev =       0.560458671978
             le_variance =       0.314113922996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634035673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340356731       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340356731       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216340356731       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216340356731       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216326788751       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.226022610673       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216437656007       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.222907100617       residual = 6.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218655060740       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214175267914       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.233126122522       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.232393058025       residual = 4.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.234779907313       residual = 5.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.289108152699       residual = 8.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.277096009157       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.219195383206       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.174077291630       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.286237349591       residual = 8.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.303154263007       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.314278117415       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.207408979903       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.399390767538       residual = 5.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.412548115268       residual = 6.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.465315663909       residual = 9.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895541520193       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.369016225383       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.981779658327       residual = 9.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.846412532761       residual = 5.95e+01           smallest_sin_value = 9.97e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 6.034036e-17

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340356731       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340356731       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.12e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340356731       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340356731       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216340356731       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.225837662117       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.163806841965       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.380460946471       residual = 4.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.162453003357       residual = 5.08e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.156433202541       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.247134688090       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.237295529503       residual = 1.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.351851733193       residual = 3.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -14.531214555702       residual = 1.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.933494280413       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.228721772302       residual = 6.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.426784021744       residual = 9.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.457938761439       residual = 8.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -13.963572253329       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -11.838394098343       residual = 4.60e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.317745692563       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.596573350835       residual = 5.80e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.847755424968       residual = 4.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -20.125457727993       residual = 1.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -14.694850217356       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -19.409810792451       residual = 7.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.947526586856       residual = 4.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.016816813517       residual = 3.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.128217201657       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -12.781501618730       residual = 3.15e+03           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -22.919751115266       residual = 5.49e+03           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.24e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6250e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1839
    reference variance = 0.165079
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401476844
  error estimate for blocks of size 2^( 2) =       0.000410804311
  error estimate for blocks of size 2^( 3) =       0.000419454255
  error estimate for blocks of size 2^( 4) =       0.000425908584
  error estimate for blocks of size 2^( 5) =       0.000429098485
  error estimate for blocks of size 2^( 6) =       0.000432157964
  error estimate for blocks of size 2^( 7) =       0.000433308348

      target function =                  N/A
              le_mean =     -17.216944944226
             les_mean =     296.745560364228
             stat err =       0.000430118345
             autocorr =       1.147770158455
              std dev =       0.567773998097
             le_variance =       0.322367312915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401476844
  error estimate for blocks of size 2^( 2) =       0.000410804311
  error estimate for blocks of size 2^( 3) =       0.000419454255
  error estimate for blocks of size 2^( 4) =       0.000425908584
  error estimate for blocks of size 2^( 5) =       0.000429098485
  error estimate for blocks of size 2^( 6) =       0.000432157964
  error estimate for blocks of size 2^( 7) =       0.000433308348

      target function =                  N/A
              le_mean =     -17.216944944226
             les_mean =     296.745560364228
             stat err =       0.000430118345
             autocorr =       1.147770158452
              std dev =       0.567773998097
             le_variance =       0.322367312915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401476844
  error estimate for blocks of size 2^( 2) =       0.000410804311
  error estimate for blocks of size 2^( 3) =       0.000419454255
  error estimate for blocks of size 2^( 4) =       0.000425908584
  error estimate for blocks of size 2^( 5) =       0.000429098485
  error estimate for blocks of size 2^( 6) =       0.000432157964
  error estimate for blocks of size 2^( 7) =       0.000433308348

      target function =                  N/A
              le_mean =     -17.216944944226
             les_mean =     296.745560364228
             stat err =       0.000430118345
             autocorr =       1.147770158455
              std dev =       0.567773998097
             le_variance =       0.322367312915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322442381981
                                         uncertainty =       0.004564815929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401476844
  error estimate for blocks of size 2^( 2) =       0.000410804311
  error estimate for blocks of size 2^( 3) =       0.000419454255
  error estimate for blocks of size 2^( 4) =       0.000425908584
  error estimate for blocks of size 2^( 5) =       0.000429098485
  error estimate for blocks of size 2^( 6) =       0.000432157964
  error estimate for blocks of size 2^( 7) =       0.000433308348

      target function =                  N/A
              le_mean =     -17.216944944226
             les_mean =     296.745560364228
             stat err =       0.000430118345
             autocorr =       1.147770158455
              std dev =       0.567773998097
             le_variance =       0.322367312915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216944944226        initial  <--
     2.3842e+12     2.3842e+13             6.0340e-17       -17.216944944226
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216944944226
     3.8147e+13     3.8147e+14             0.0000e+00       -17.216944944226

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7596
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2526
    reference variance = 0.239892
====================================================
  Execution time = 2.1113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2560e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325686326468
                                         uncertainty =       0.004610270670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325686326468
                                         uncertainty =       0.004610270670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403484210
  error estimate for blocks of size 2^( 2) =       0.000412890095
  error estimate for blocks of size 2^( 3) =       0.000421211753
  error estimate for blocks of size 2^( 4) =       0.000428026057
  error estimate for blocks of size 2^( 5) =       0.000431396699
  error estimate for blocks of size 2^( 6) =       0.000432449587
  error estimate for blocks of size 2^( 7) =       0.000432908750

      target function =                  N/A
              le_mean =     -17.216755834452
             les_mean =     296.742280315512
             stat err =       0.000431195273
             autocorr =       1.142075712155
              std dev =       0.570612841752
             le_variance =       0.325599015173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675583445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755834452       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755834452       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755834452       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755834452       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.072671082867       residual = 3.39e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.078193650480       residual = 2.90e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.206857902944       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.274543248879       residual = 6.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.221207998664       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.236425622755       residual = 9.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.715178152451       residual = 3.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.179001776380       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.533842441718       residual = 7.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.123712987660       residual = 1.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.698229659554       residual = 3.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.889267932746       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.743850946596       residual = 3.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.063945946077       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -20.300136076802       residual = 1.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.680146805185       residual = 3.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.690717015677       residual = 3.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -18.657955892070       residual = 3.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.433331446331       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -20.003738048500       residual = 1.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.155472494820       residual = 6.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.598014289992       residual = 3.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.650623473435       residual = 4.04e+02           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -11.889334979959       residual = 4.31e+03           smallest_sin_value = 9.98e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 2.646545e-18

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755834452       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755834452       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755834452       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755834452       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6603e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.201639
====================================================
  Execution time = 2.0664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2855e-01
  Total weights = 2.0000e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405309726
  error estimate for blocks of size 2^( 2) =       0.000414907973
  error estimate for blocks of size 2^( 3) =       0.000423368804
  error estimate for blocks of size 2^( 4) =       0.000429555138
  error estimate for blocks of size 2^( 5) =       0.000433893683
  error estimate for blocks of size 2^( 6) =       0.000435467406
  error estimate for blocks of size 2^( 7) =       0.000436904143

      target function =                  N/A
              le_mean =     -17.216323746308
             les_mean =     296.730355121871
             stat err =       0.000433955093
             autocorr =       1.146345491606
              std dev =       0.573194511885
             le_variance =       0.328551948455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405309726
  error estimate for blocks of size 2^( 2) =       0.000414907973
  error estimate for blocks of size 2^( 3) =       0.000423368804
  error estimate for blocks of size 2^( 4) =       0.000429555138
  error estimate for blocks of size 2^( 5) =       0.000433893683
  error estimate for blocks of size 2^( 6) =       0.000435467406
  error estimate for blocks of size 2^( 7) =       0.000436904143

      target function =                  N/A
              le_mean =     -17.216323746308
             les_mean =     296.730355121871
             stat err =       0.000433955093
             autocorr =       1.146345491606
              std dev =       0.573194511885
             le_variance =       0.328551948455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405309726
  error estimate for blocks of size 2^( 2) =       0.000414907973
  error estimate for blocks of size 2^( 3) =       0.000423368804
  error estimate for blocks of size 2^( 4) =       0.000429555138
  error estimate for blocks of size 2^( 5) =       0.000433893683
  error estimate for blocks of size 2^( 6) =       0.000435467406
  error estimate for blocks of size 2^( 7) =       0.000436904143

      target function =                  N/A
              le_mean =     -17.216323746308
             les_mean =     296.730355121871
             stat err =       0.000433955093
             autocorr =       1.146345491606
              std dev =       0.573194511885
             le_variance =       0.328551948455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328523599834
                                         uncertainty =       0.006582332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405309726
  error estimate for blocks of size 2^( 2) =       0.000414907973
  error estimate for blocks of size 2^( 3) =       0.000423368804
  error estimate for blocks of size 2^( 4) =       0.000429555138
  error estimate for blocks of size 2^( 5) =       0.000433893683
  error estimate for blocks of size 2^( 6) =       0.000435467406
  error estimate for blocks of size 2^( 7) =       0.000436904143

      target function =                  N/A
              le_mean =     -17.216323746308
             les_mean =     296.730355121871
             stat err =       0.000433955093
             autocorr =       1.146345491606
              std dev =       0.573194511885
             le_variance =       0.328551948455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216323746308        initial  <--
     2.3842e+13     2.3842e+14             2.6465e-18       -17.216323746308
     9.5367e+13     9.5367e+14             0.0000e+00       -17.216323746308
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216323746308

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9194
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.201363
====================================================
  Execution time = 2.2959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337126085495
                                         uncertainty =       0.018987576139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337126085495
                                         uncertainty =       0.018987576139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410500114
  error estimate for blocks of size 2^( 2) =       0.000420142521
  error estimate for blocks of size 2^( 3) =       0.000428883297
  error estimate for blocks of size 2^( 4) =       0.000435322180
  error estimate for blocks of size 2^( 5) =       0.000438799881
  error estimate for blocks of size 2^( 6) =       0.000440565550
  error estimate for blocks of size 2^( 7) =       0.000442697415

      target function =                  N/A
              le_mean =     -17.216122868446
             les_mean =     296.731907139736
             stat err =       0.000439346257
             autocorr =       1.145479436114
              std dev =       0.580534828256
             le_variance =       0.337020686818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612286845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216122868446       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8403e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.202093
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2292e-01
  Total weights = 2.0000e+06
  Execution time = 1.8379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401822563
  error estimate for blocks of size 2^( 2) =       0.000411923129
  error estimate for blocks of size 2^( 3) =       0.000420812870
  error estimate for blocks of size 2^( 4) =       0.000428343481
  error estimate for blocks of size 2^( 5) =       0.000432131250
  error estimate for blocks of size 2^( 6) =       0.000433353945
  error estimate for blocks of size 2^( 7) =       0.000435764549

      target function =                  N/A
              le_mean =     -17.216262341001
             les_mean =     296.722611576424
             stat err =       0.000432398306
             autocorr =       1.157975390603
              std dev =       0.568262917778
             le_variance =       0.322922743721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401822563
  error estimate for blocks of size 2^( 2) =       0.000411923129
  error estimate for blocks of size 2^( 3) =       0.000420812870
  error estimate for blocks of size 2^( 4) =       0.000428343481
  error estimate for blocks of size 2^( 5) =       0.000432131250
  error estimate for blocks of size 2^( 6) =       0.000433353945
  error estimate for blocks of size 2^( 7) =       0.000435764549

      target function =                  N/A
              le_mean =     -17.216262341001
             les_mean =     296.722611576424
             stat err =       0.000432398306
             autocorr =       1.157975390603
              std dev =       0.568262917778
             le_variance =       0.322922743721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401822563
  error estimate for blocks of size 2^( 2) =       0.000411923129
  error estimate for blocks of size 2^( 3) =       0.000420812870
  error estimate for blocks of size 2^( 4) =       0.000428343481
  error estimate for blocks of size 2^( 5) =       0.000432131250
  error estimate for blocks of size 2^( 6) =       0.000433353945
  error estimate for blocks of size 2^( 7) =       0.000435764549

      target function =                  N/A
              le_mean =     -17.216262341001
             les_mean =     296.722611576424
             stat err =       0.000432398306
             autocorr =       1.157975390603
              std dev =       0.568262917778
             le_variance =       0.322922743721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322979854623
                                         uncertainty =       0.005660115519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401822563
  error estimate for blocks of size 2^( 2) =       0.000411923129
  error estimate for blocks of size 2^( 3) =       0.000420812870
  error estimate for blocks of size 2^( 4) =       0.000428343481
  error estimate for blocks of size 2^( 5) =       0.000432131250
  error estimate for blocks of size 2^( 6) =       0.000433353945
  error estimate for blocks of size 2^( 7) =       0.000435764549

      target function =                  N/A
              le_mean =     -17.216262341001
             les_mean =     296.722611576424
             stat err =       0.000432398306
             autocorr =       1.157975390603
              std dev =       0.568262917778
             le_variance =       0.322922743721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216262341001        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -17.216262341001
     9.5367e+14     9.5367e+15             0.0000e+00       -17.216262341001
     3.8147e+15     3.8147e+16             0.0000e+00       -17.216262341001

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7761
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.340462
====================================================
  Execution time = 2.0759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334100892030
                                         uncertainty =       0.010772334396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334100892030
                                         uncertainty =       0.010772334396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408655395
  error estimate for blocks of size 2^( 2) =       0.000418667752
  error estimate for blocks of size 2^( 3) =       0.000427248102
  error estimate for blocks of size 2^( 4) =       0.000433350035
  error estimate for blocks of size 2^( 5) =       0.000437560529
  error estimate for blocks of size 2^( 6) =       0.000440210639
  error estimate for blocks of size 2^( 7) =       0.000442009927

      target function =                  N/A
              le_mean =     -17.216823872745
             les_mean =     296.753022562285
             stat err =       0.000438282783
             autocorr =       1.150255573648
              std dev =       0.577926002327
             le_variance =       0.333998464165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682387274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823872745       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6176e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2666
    reference variance = 0.172474
====================================================
  Execution time = 2.0633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.3770e-01
  Total weights = 2.0000e+06
  Execution time = 1.8429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410913407
  error estimate for blocks of size 2^( 2) =       0.000420511114
  error estimate for blocks of size 2^( 3) =       0.000428699244
  error estimate for blocks of size 2^( 4) =       0.000435356118
  error estimate for blocks of size 2^( 5) =       0.000439801608
  error estimate for blocks of size 2^( 6) =       0.000442956282
  error estimate for blocks of size 2^( 7) =       0.000444520375

      target function =                  N/A
              le_mean =     -17.217937818702
             les_mean =     296.795082215252
             stat err =       0.000440658596
             autocorr =       1.150015969060
              std dev =       0.581119312539
             le_variance =       0.337699655406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410913407
  error estimate for blocks of size 2^( 2) =       0.000420511114
  error estimate for blocks of size 2^( 3) =       0.000428699244
  error estimate for blocks of size 2^( 4) =       0.000435356118
  error estimate for blocks of size 2^( 5) =       0.000439801608
  error estimate for blocks of size 2^( 6) =       0.000442956282
  error estimate for blocks of size 2^( 7) =       0.000444520375

      target function =                  N/A
              le_mean =     -17.217937818702
             les_mean =     296.795082215252
             stat err =       0.000440658596
             autocorr =       1.150015969060
              std dev =       0.581119312539
             le_variance =       0.337699655406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410913407
  error estimate for blocks of size 2^( 2) =       0.000420511114
  error estimate for blocks of size 2^( 3) =       0.000428699244
  error estimate for blocks of size 2^( 4) =       0.000435356118
  error estimate for blocks of size 2^( 5) =       0.000439801608
  error estimate for blocks of size 2^( 6) =       0.000442956282
  error estimate for blocks of size 2^( 7) =       0.000444520375

      target function =                  N/A
              le_mean =     -17.217937818702
             les_mean =     296.795082215252
             stat err =       0.000440658596
             autocorr =       1.150015969060
              std dev =       0.581119312539
             le_variance =       0.337699655406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337722618156
                                         uncertainty =       0.024207914627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410913407
  error estimate for blocks of size 2^( 2) =       0.000420511114
  error estimate for blocks of size 2^( 3) =       0.000428699244
  error estimate for blocks of size 2^( 4) =       0.000435356118
  error estimate for blocks of size 2^( 5) =       0.000439801608
  error estimate for blocks of size 2^( 6) =       0.000442956282
  error estimate for blocks of size 2^( 7) =       0.000444520375

      target function =                  N/A
              le_mean =     -17.217937818702
             les_mean =     296.795082215252
             stat err =       0.000440658596
             autocorr =       1.150015969060
              std dev =       0.581119312539
             le_variance =       0.337699655406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217937818702        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -17.217937818702
     9.5367e+15     9.5367e+16             0.0000e+00       -17.217937818702
     3.8147e+16     3.8147e+17             0.0000e+00       -17.217937818702

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0556
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2153
    reference variance = 0.123479
====================================================
  Execution time = 2.0633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1979e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319864301223
                                         uncertainty =       0.003760663628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319864301223
                                         uncertainty =       0.003760663628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399869257
  error estimate for blocks of size 2^( 2) =       0.000409273878
  error estimate for blocks of size 2^( 3) =       0.000418224365
  error estimate for blocks of size 2^( 4) =       0.000424769807
  error estimate for blocks of size 2^( 5) =       0.000428825506
  error estimate for blocks of size 2^( 6) =       0.000430644636
  error estimate for blocks of size 2^( 7) =       0.000432438056

      target function =                  N/A
              le_mean =     -17.216840967199
             les_mean =     296.739403574608
             stat err =       0.000429169501
             autocorr =       1.151918286296
              std dev =       0.565500525787
             le_variance =       0.319790844665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684096720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840967199       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840967199       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840967199       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216840967200       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 1.449359e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840967199       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840967199       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840967199       residual = 9.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 3.623398e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840967199       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840967199       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840967199       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 9.058494e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6139e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2938
    reference variance = 0.293212
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400817019
  error estimate for blocks of size 2^( 2) =       0.000410564672
  error estimate for blocks of size 2^( 3) =       0.000419276015
  error estimate for blocks of size 2^( 4) =       0.000425368681
  error estimate for blocks of size 2^( 5) =       0.000429263184
  error estimate for blocks of size 2^( 6) =       0.000430271532
  error estimate for blocks of size 2^( 7) =       0.000431492444

      target function =                  N/A
              le_mean =     -17.217677521411
             les_mean =     296.769727636740
             stat err =       0.000429098960
             autocorr =       1.146100273087
              std dev =       0.566840864867
             le_variance =       0.321308566083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400817019
  error estimate for blocks of size 2^( 2) =       0.000410564672
  error estimate for blocks of size 2^( 3) =       0.000419276015
  error estimate for blocks of size 2^( 4) =       0.000425368681
  error estimate for blocks of size 2^( 5) =       0.000429263184
  error estimate for blocks of size 2^( 6) =       0.000430271532
  error estimate for blocks of size 2^( 7) =       0.000431492444

      target function =                  N/A
              le_mean =     -17.217677521411
             les_mean =     296.769727636740
             stat err =       0.000429098960
             autocorr =       1.146100273087
              std dev =       0.566840864867
             le_variance =       0.321308566083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400817019
  error estimate for blocks of size 2^( 2) =       0.000410564672
  error estimate for blocks of size 2^( 3) =       0.000419276015
  error estimate for blocks of size 2^( 4) =       0.000425368681
  error estimate for blocks of size 2^( 5) =       0.000429263184
  error estimate for blocks of size 2^( 6) =       0.000430271532
  error estimate for blocks of size 2^( 7) =       0.000431492444

      target function =                  N/A
              le_mean =     -17.217677521411
             les_mean =     296.769727636740
             stat err =       0.000429098960
             autocorr =       1.146100273087
              std dev =       0.566840864867
             le_variance =       0.321308566083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321254189441
                                         uncertainty =       0.007032323528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400817019
  error estimate for blocks of size 2^( 2) =       0.000410564672
  error estimate for blocks of size 2^( 3) =       0.000419276015
  error estimate for blocks of size 2^( 4) =       0.000425368681
  error estimate for blocks of size 2^( 5) =       0.000429263184
  error estimate for blocks of size 2^( 6) =       0.000430271532
  error estimate for blocks of size 2^( 7) =       0.000431492444

      target function =                  N/A
              le_mean =     -17.217677521411
             les_mean =     296.769727636740
             stat err =       0.000429098960
             autocorr =       1.146100273087
              std dev =       0.566840864867
             le_variance =       0.321308566083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217677521411        initial  <--
     2.3842e+16     2.3842e+17             1.4494e-21       -17.217677521411
     9.5367e+16     9.5367e+17             3.6234e-22       -17.217677521411
     3.8147e+17     3.8147e+18             9.0585e-23       -17.217677521411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5440
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1674
    reference variance = 0.285543
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317206713529
                                         uncertainty =       0.002665019080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317206713529
                                         uncertainty =       0.002665019080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398208105
  error estimate for blocks of size 2^( 2) =       0.000407851735
  error estimate for blocks of size 2^( 3) =       0.000416482235
  error estimate for blocks of size 2^( 4) =       0.000423600926
  error estimate for blocks of size 2^( 5) =       0.000427421627
  error estimate for blocks of size 2^( 6) =       0.000429644807
  error estimate for blocks of size 2^( 7) =       0.000428400587

      target function =                  N/A
              le_mean =     -17.216946323367
             les_mean =     296.740379932377
             stat err =       0.000427266987
             autocorr =       1.151273440536
              std dev =       0.563151302276
             le_variance =       0.317139389255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694632337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216946323367       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 3.546246e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216946323367       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216946323367       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 8.865616e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6184e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.193399
====================================================
  Execution time = 2.1138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278159
  error estimate for blocks of size 2^( 2) =       0.000410181172
  error estimate for blocks of size 2^( 3) =       0.000418731892
  error estimate for blocks of size 2^( 4) =       0.000424958064
  error estimate for blocks of size 2^( 5) =       0.000428667193
  error estimate for blocks of size 2^( 6) =       0.000431751414
  error estimate for blocks of size 2^( 7) =       0.000433919606

      target function =                  N/A
              le_mean =     -17.216168756103
             les_mean =     296.716911687502
             stat err =       0.000429824069
             autocorr =       1.153075317619
              std dev =       0.566078801139
             le_variance =       0.320445209099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278159
  error estimate for blocks of size 2^( 2) =       0.000410181172
  error estimate for blocks of size 2^( 3) =       0.000418731892
  error estimate for blocks of size 2^( 4) =       0.000424958064
  error estimate for blocks of size 2^( 5) =       0.000428667193
  error estimate for blocks of size 2^( 6) =       0.000431751414
  error estimate for blocks of size 2^( 7) =       0.000433919606

      target function =                  N/A
              le_mean =     -17.216168756103
             les_mean =     296.716911687502
             stat err =       0.000429824069
             autocorr =       1.153075317619
              std dev =       0.566078801139
             le_variance =       0.320445209099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278159
  error estimate for blocks of size 2^( 2) =       0.000410181172
  error estimate for blocks of size 2^( 3) =       0.000418731892
  error estimate for blocks of size 2^( 4) =       0.000424958064
  error estimate for blocks of size 2^( 5) =       0.000428667193
  error estimate for blocks of size 2^( 6) =       0.000431751414
  error estimate for blocks of size 2^( 7) =       0.000433919606

      target function =                  N/A
              le_mean =     -17.216168756103
             les_mean =     296.716911687502
             stat err =       0.000429824069
             autocorr =       1.153075317619
              std dev =       0.566078801139
             le_variance =       0.320445209099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320491363811
                                         uncertainty =       0.004289304449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278159
  error estimate for blocks of size 2^( 2) =       0.000410181172
  error estimate for blocks of size 2^( 3) =       0.000418731892
  error estimate for blocks of size 2^( 4) =       0.000424958064
  error estimate for blocks of size 2^( 5) =       0.000428667193
  error estimate for blocks of size 2^( 6) =       0.000431751414
  error estimate for blocks of size 2^( 7) =       0.000433919606

      target function =                  N/A
              le_mean =     -17.216168756103
             les_mean =     296.716911687502
             stat err =       0.000429824069
             autocorr =       1.153075317619
              std dev =       0.566078801139
             le_variance =       0.320445209099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216168756103        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -17.216168756103
     9.5367e+17     9.5367e+18             3.5462e-23       -17.216168756103
     3.8147e+18     3.8147e+19             8.8656e-24       -17.216168756103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4112
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1653
    reference variance = 0.195052
====================================================
  Execution time = 2.1004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315936276495
                                         uncertainty =       0.003618166284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315936276495
                                         uncertainty =       0.003618166284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397375892
  error estimate for blocks of size 2^( 2) =       0.000406939199
  error estimate for blocks of size 2^( 3) =       0.000415457212
  error estimate for blocks of size 2^( 4) =       0.000421659251
  error estimate for blocks of size 2^( 5) =       0.000425974927
  error estimate for blocks of size 2^( 6) =       0.000428113724
  error estimate for blocks of size 2^( 7) =       0.000429427157

      target function =                  N/A
              le_mean =     -17.216601608677
             les_mean =     296.727185993430
             stat err =       0.000426293765
             autocorr =       1.150839948547
              std dev =       0.561974376133
             le_variance =       0.315815199431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660160868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601608677       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6463e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.192
    reference variance = 0.740237
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1877e-01
  Total weights = 2.0000e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399233359
  error estimate for blocks of size 2^( 2) =       0.000408719722
  error estimate for blocks of size 2^( 3) =       0.000417356736
  error estimate for blocks of size 2^( 4) =       0.000424044389
  error estimate for blocks of size 2^( 5) =       0.000428601000
  error estimate for blocks of size 2^( 6) =       0.000430615461
  error estimate for blocks of size 2^( 7) =       0.000431023574

      target function =                  N/A
              le_mean =     -17.216490252359
             les_mean =     296.726311000190
             stat err =       0.000428571106
             autocorr =       1.152370495741
              std dev =       0.564601230973
             le_variance =       0.318774550016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399233359
  error estimate for blocks of size 2^( 2) =       0.000408719722
  error estimate for blocks of size 2^( 3) =       0.000417356736
  error estimate for blocks of size 2^( 4) =       0.000424044389
  error estimate for blocks of size 2^( 5) =       0.000428601000
  error estimate for blocks of size 2^( 6) =       0.000430615461
  error estimate for blocks of size 2^( 7) =       0.000431023574

      target function =                  N/A
              le_mean =     -17.216490252359
             les_mean =     296.726311000190
             stat err =       0.000428571106
             autocorr =       1.152370495741
              std dev =       0.564601230973
             le_variance =       0.318774550016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399233359
  error estimate for blocks of size 2^( 2) =       0.000408719722
  error estimate for blocks of size 2^( 3) =       0.000417356736
  error estimate for blocks of size 2^( 4) =       0.000424044389
  error estimate for blocks of size 2^( 5) =       0.000428601000
  error estimate for blocks of size 2^( 6) =       0.000430615461
  error estimate for blocks of size 2^( 7) =       0.000431023574

      target function =                  N/A
              le_mean =     -17.216490252359
             les_mean =     296.726311000190
             stat err =       0.000428571106
             autocorr =       1.152370495741
              std dev =       0.564601230973
             le_variance =       0.318774550016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728205511
                                         uncertainty =       0.004550067353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399233359
  error estimate for blocks of size 2^( 2) =       0.000408719722
  error estimate for blocks of size 2^( 3) =       0.000417356736
  error estimate for blocks of size 2^( 4) =       0.000424044389
  error estimate for blocks of size 2^( 5) =       0.000428601000
  error estimate for blocks of size 2^( 6) =       0.000430615461
  error estimate for blocks of size 2^( 7) =       0.000431023574

      target function =                  N/A
              le_mean =     -17.216490252359
             les_mean =     296.726311000190
             stat err =       0.000428571106
             autocorr =       1.152370495741
              std dev =       0.564601230973
             le_variance =       0.318774550016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216490252359        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -17.216490252359
     9.5367e+18     9.5367e+19             0.0000e+00       -17.216490252359
     3.8147e+19     3.8147e+20             0.0000e+00       -17.216490252359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5428
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6026e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2596
    reference variance = 0.406361
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5208e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351936959776
                                         uncertainty =       0.016907843894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351936959776
                                         uncertainty =       0.016907843894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419572579
  error estimate for blocks of size 2^( 2) =       0.000428582518
  error estimate for blocks of size 2^( 3) =       0.000436981742
  error estimate for blocks of size 2^( 4) =       0.000443159596
  error estimate for blocks of size 2^( 5) =       0.000445720080
  error estimate for blocks of size 2^( 6) =       0.000448651218
  error estimate for blocks of size 2^( 7) =       0.000447709610

      target function =                  N/A
              le_mean =     -17.217089437313
             les_mean =     296.780250814833
             stat err =       0.000446310126
             autocorr =       1.131512316373
              std dev =       0.593365231908
             le_variance =       0.352082298437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708943731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089437313       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9167e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2012
    reference variance = 0.216343
====================================================
  Execution time = 2.0875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1819e-01
  Total weights = 2.0000e+06
  Execution time = 1.9088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398864468
  error estimate for blocks of size 2^( 2) =       0.000408621675
  error estimate for blocks of size 2^( 3) =       0.000417457461
  error estimate for blocks of size 2^( 4) =       0.000423396357
  error estimate for blocks of size 2^( 5) =       0.000428342100
  error estimate for blocks of size 2^( 6) =       0.000429966487
  error estimate for blocks of size 2^( 7) =       0.000430401171

      target function =                  N/A
              le_mean =     -17.217485405861
             les_mean =     296.759989269128
             stat err =       0.000428026529
             autocorr =       1.151570883149
              std dev =       0.564079539755
             le_variance =       0.318185727170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398864468
  error estimate for blocks of size 2^( 2) =       0.000408621675
  error estimate for blocks of size 2^( 3) =       0.000417457461
  error estimate for blocks of size 2^( 4) =       0.000423396357
  error estimate for blocks of size 2^( 5) =       0.000428342100
  error estimate for blocks of size 2^( 6) =       0.000429966487
  error estimate for blocks of size 2^( 7) =       0.000430401171

      target function =                  N/A
              le_mean =     -17.217485405861
             les_mean =     296.759989269128
             stat err =       0.000428026529
             autocorr =       1.151570883149
              std dev =       0.564079539755
             le_variance =       0.318185727170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398864468
  error estimate for blocks of size 2^( 2) =       0.000408621675
  error estimate for blocks of size 2^( 3) =       0.000417457461
  error estimate for blocks of size 2^( 4) =       0.000423396357
  error estimate for blocks of size 2^( 5) =       0.000428342100
  error estimate for blocks of size 2^( 6) =       0.000429966487
  error estimate for blocks of size 2^( 7) =       0.000430401171

      target function =                  N/A
              le_mean =     -17.217485405861
             les_mean =     296.759989269128
             stat err =       0.000428026529
             autocorr =       1.151570883149
              std dev =       0.564079539755
             le_variance =       0.318185727170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318157444974
                                         uncertainty =       0.003615362635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398864468
  error estimate for blocks of size 2^( 2) =       0.000408621675
  error estimate for blocks of size 2^( 3) =       0.000417457461
  error estimate for blocks of size 2^( 4) =       0.000423396357
  error estimate for blocks of size 2^( 5) =       0.000428342100
  error estimate for blocks of size 2^( 6) =       0.000429966487
  error estimate for blocks of size 2^( 7) =       0.000430401171

      target function =                  N/A
              le_mean =     -17.217485405861
             les_mean =     296.759989269128
             stat err =       0.000428026529
             autocorr =       1.151570883149
              std dev =       0.564079539755
             le_variance =       0.318185727170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217485405861        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -17.217485405861
     9.5367e+19     9.5367e+20             0.0000e+00       -17.217485405861
     3.8147e+20     3.8147e+21             0.0000e+00       -17.217485405861

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2191
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1754
    reference variance = 0.326149
====================================================
  Execution time = 2.1301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2166e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321771458565
                                         uncertainty =       0.003919736800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321771458565
                                         uncertainty =       0.003919736800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401033231
  error estimate for blocks of size 2^( 2) =       0.000410360534
  error estimate for blocks of size 2^( 3) =       0.000419321502
  error estimate for blocks of size 2^( 4) =       0.000426381267
  error estimate for blocks of size 2^( 5) =       0.000430390333
  error estimate for blocks of size 2^( 6) =       0.000433012928
  error estimate for blocks of size 2^( 7) =       0.000434199886

      target function =                  N/A
              le_mean =     -17.217359835962
             les_mean =     296.759134865670
             stat err =       0.000430996103
             autocorr =       1.155010584060
              std dev =       0.567146634914
             le_variance =       0.321655305495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721735983596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217359835962       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6753e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2861
    reference variance = 2.63943
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5404e-01
  Total weights = 2.0000e+06
  Execution time = 1.8463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420739710
  error estimate for blocks of size 2^( 2) =       0.000430009654
  error estimate for blocks of size 2^( 3) =       0.000438137057
  error estimate for blocks of size 2^( 4) =       0.000444314885
  error estimate for blocks of size 2^( 5) =       0.000448096553
  error estimate for blocks of size 2^( 6) =       0.000449222227
  error estimate for blocks of size 2^( 7) =       0.000449099314

      target function =                  N/A
              le_mean =     -17.216972519472
             les_mean =     296.778186366014
             stat err =       0.000447683245
             autocorr =       1.132177904548
              std dev =       0.595015803805
             le_variance =       0.354043806778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420739710
  error estimate for blocks of size 2^( 2) =       0.000430009654
  error estimate for blocks of size 2^( 3) =       0.000438137057
  error estimate for blocks of size 2^( 4) =       0.000444314885
  error estimate for blocks of size 2^( 5) =       0.000448096553
  error estimate for blocks of size 2^( 6) =       0.000449222227
  error estimate for blocks of size 2^( 7) =       0.000449099314

      target function =                  N/A
              le_mean =     -17.216972519472
             les_mean =     296.778186366014
             stat err =       0.000447683245
             autocorr =       1.132177904548
              std dev =       0.595015803805
             le_variance =       0.354043806778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420739710
  error estimate for blocks of size 2^( 2) =       0.000430009654
  error estimate for blocks of size 2^( 3) =       0.000438137057
  error estimate for blocks of size 2^( 4) =       0.000444314885
  error estimate for blocks of size 2^( 5) =       0.000448096553
  error estimate for blocks of size 2^( 6) =       0.000449222227
  error estimate for blocks of size 2^( 7) =       0.000449099314

      target function =                  N/A
              le_mean =     -17.216972519472
             les_mean =     296.778186366014
             stat err =       0.000447683245
             autocorr =       1.132177904548
              std dev =       0.595015803805
             le_variance =       0.354043806778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353969419630
                                         uncertainty =       0.022955047499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420739710
  error estimate for blocks of size 2^( 2) =       0.000430009654
  error estimate for blocks of size 2^( 3) =       0.000438137057
  error estimate for blocks of size 2^( 4) =       0.000444314885
  error estimate for blocks of size 2^( 5) =       0.000448096553
  error estimate for blocks of size 2^( 6) =       0.000449222227
  error estimate for blocks of size 2^( 7) =       0.000449099314

      target function =                  N/A
              le_mean =     -17.216972519472
             les_mean =     296.778186366014
             stat err =       0.000447683245
             autocorr =       1.132177904548
              std dev =       0.595015803805
             le_variance =       0.354043806778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216972519472        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -17.216972519472
     9.5367e+20     9.5367e+21             0.0000e+00       -17.216972519472
     3.8147e+21     3.8147e+22             0.0000e+00       -17.216972519472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1356
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.3352
    reference variance = 0.406856
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333808637388
                                         uncertainty =       0.015143780497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333808637388
                                         uncertainty =       0.015143780497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408525784
  error estimate for blocks of size 2^( 2) =       0.000418124123
  error estimate for blocks of size 2^( 3) =       0.000426451681
  error estimate for blocks of size 2^( 4) =       0.000431984706
  error estimate for blocks of size 2^( 5) =       0.000435882379
  error estimate for blocks of size 2^( 6) =       0.000437498304
  error estimate for blocks of size 2^( 7) =       0.000439167766

      target function =                  N/A
              le_mean =     -17.217121587432
             les_mean =     296.763062222595
             stat err =       0.000436133289
             autocorr =       1.139723563022
              std dev =       0.577742704892
             le_variance =       0.333786633056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712158743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217121587432       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6316e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1687
    reference variance = 0.243007
====================================================
  Execution time = 2.1069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1908e-01
  Total weights = 2.0000e+06
  Execution time = 1.8343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399421895
  error estimate for blocks of size 2^( 2) =       0.000409537623
  error estimate for blocks of size 2^( 3) =       0.000417964513
  error estimate for blocks of size 2^( 4) =       0.000424254517
  error estimate for blocks of size 2^( 5) =       0.000428482253
  error estimate for blocks of size 2^( 6) =       0.000429634266
  error estimate for blocks of size 2^( 7) =       0.000428954743

      target function =                  N/A
              le_mean =     -17.217119283563
             les_mean =     296.748271965787
             stat err =       0.000427831445
             autocorr =       1.147312343475
              std dev =       0.564867861429
             le_variance =       0.319075700876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399421895
  error estimate for blocks of size 2^( 2) =       0.000409537623
  error estimate for blocks of size 2^( 3) =       0.000417964513
  error estimate for blocks of size 2^( 4) =       0.000424254517
  error estimate for blocks of size 2^( 5) =       0.000428482253
  error estimate for blocks of size 2^( 6) =       0.000429634266
  error estimate for blocks of size 2^( 7) =       0.000428954743

      target function =                  N/A
              le_mean =     -17.217119283563
             les_mean =     296.748271965787
             stat err =       0.000427831445
             autocorr =       1.147312343475
              std dev =       0.564867861429
             le_variance =       0.319075700876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399421895
  error estimate for blocks of size 2^( 2) =       0.000409537623
  error estimate for blocks of size 2^( 3) =       0.000417964513
  error estimate for blocks of size 2^( 4) =       0.000424254517
  error estimate for blocks of size 2^( 5) =       0.000428482253
  error estimate for blocks of size 2^( 6) =       0.000429634266
  error estimate for blocks of size 2^( 7) =       0.000428954743

      target function =                  N/A
              le_mean =     -17.217119283563
             les_mean =     296.748271965787
             stat err =       0.000427831445
             autocorr =       1.147312343475
              std dev =       0.564867861429
             le_variance =       0.319075700876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318952855357
                                         uncertainty =       0.002798928378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399421895
  error estimate for blocks of size 2^( 2) =       0.000409537623
  error estimate for blocks of size 2^( 3) =       0.000417964513
  error estimate for blocks of size 2^( 4) =       0.000424254517
  error estimate for blocks of size 2^( 5) =       0.000428482253
  error estimate for blocks of size 2^( 6) =       0.000429634266
  error estimate for blocks of size 2^( 7) =       0.000428954743

      target function =                  N/A
              le_mean =     -17.217119283563
             les_mean =     296.748271965787
             stat err =       0.000427831445
             autocorr =       1.147312343475
              std dev =       0.564867861429
             le_variance =       0.319075700876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217119283563        initial  <--
     2.3842e+21     2.3842e+22             0.0000e+00       -17.217119283563
     9.5367e+21     9.5367e+22             0.0000e+00       -17.217119283563
     3.8147e+22     3.8147e+23             0.0000e+00       -17.217119283563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3210
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3845
    reference variance = 6.19735
====================================================
  Execution time = 2.0932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2024e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319933270960
                                         uncertainty =       0.003164494874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319933270960
                                         uncertainty =       0.003164494874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400150196
  error estimate for blocks of size 2^( 2) =       0.000409809871
  error estimate for blocks of size 2^( 3) =       0.000418738913
  error estimate for blocks of size 2^( 4) =       0.000425143149
  error estimate for blocks of size 2^( 5) =       0.000428685131
  error estimate for blocks of size 2^( 6) =       0.000431452309
  error estimate for blocks of size 2^( 7) =       0.000432126105

      target function =                  N/A
              le_mean =     -17.216850824728
             les_mean =     296.740192519942
             stat err =       0.000429351673
             autocorr =       1.151278121301
              std dev =       0.565897834520
             le_variance =       0.320240359115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685082473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850824728       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6513e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2573
    reference variance = 0.298249
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2761e-01
  Total weights = 2.0000e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404725559
  error estimate for blocks of size 2^( 2) =       0.000414047513
  error estimate for blocks of size 2^( 3) =       0.000422345435
  error estimate for blocks of size 2^( 4) =       0.000428665129
  error estimate for blocks of size 2^( 5) =       0.000432763194
  error estimate for blocks of size 2^( 6) =       0.000434547865
  error estimate for blocks of size 2^( 7) =       0.000435522797

      target function =                  N/A
              le_mean =     -17.216776373540
             les_mean =     296.744994089288
             stat err =       0.000432874746
             autocorr =       1.143939973752
              std dev =       0.572368374932
             le_variance =       0.327605556623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404725559
  error estimate for blocks of size 2^( 2) =       0.000414047513
  error estimate for blocks of size 2^( 3) =       0.000422345435
  error estimate for blocks of size 2^( 4) =       0.000428665129
  error estimate for blocks of size 2^( 5) =       0.000432763194
  error estimate for blocks of size 2^( 6) =       0.000434547865
  error estimate for blocks of size 2^( 7) =       0.000435522797

      target function =                  N/A
              le_mean =     -17.216776373540
             les_mean =     296.744994089288
             stat err =       0.000432874746
             autocorr =       1.143939973752
              std dev =       0.572368374932
             le_variance =       0.327605556623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404725559
  error estimate for blocks of size 2^( 2) =       0.000414047513
  error estimate for blocks of size 2^( 3) =       0.000422345435
  error estimate for blocks of size 2^( 4) =       0.000428665129
  error estimate for blocks of size 2^( 5) =       0.000432763194
  error estimate for blocks of size 2^( 6) =       0.000434547865
  error estimate for blocks of size 2^( 7) =       0.000435522797

      target function =                  N/A
              le_mean =     -17.216776373540
             les_mean =     296.744994089288
             stat err =       0.000432874746
             autocorr =       1.143939973752
              std dev =       0.572368374932
             le_variance =       0.327605556623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327320967067
                                         uncertainty =       0.005443843793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404725559
  error estimate for blocks of size 2^( 2) =       0.000414047513
  error estimate for blocks of size 2^( 3) =       0.000422345435
  error estimate for blocks of size 2^( 4) =       0.000428665129
  error estimate for blocks of size 2^( 5) =       0.000432763194
  error estimate for blocks of size 2^( 6) =       0.000434547865
  error estimate for blocks of size 2^( 7) =       0.000435522797

      target function =                  N/A
              le_mean =     -17.216776373540
             les_mean =     296.744994089288
             stat err =       0.000432874746
             autocorr =       1.143939973752
              std dev =       0.572368374932
             le_variance =       0.327605556623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216776373540        initial  <--
     2.3842e+22     2.3842e+23             0.0000e+00       -17.216776373540
     9.5367e+22     9.5367e+23             0.0000e+00       -17.216776373540
     3.8147e+23     3.8147e+24             0.0000e+00       -17.216776373540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5862
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.159402e-01 1 1  ON 0
 uu_1                 5.289813e-02 1 1  ON 1
 uu_2                -4.314510e-02 1 1  ON 2
 uu_3                -9.928620e-02 1 1  ON 3
 uu_4                -1.341727e-01 1 1  ON 4
 uu_5                -1.427623e-01 1 1  ON 5
 uu_6                -1.214969e-01 1 1  ON 6
 uu_7                -5.093616e-02 1 1  ON 7
 uu_8                 9.095831e-02 1 1  ON 8
 uu_9                 1.289805e-01 1 1  ON 9
 ud_0                 3.571760e-01 1 1  ON 10
 ud_1                 9.770916e-02 1 1  ON 11
 ud_2                -1.374802e-02 1 1  ON 12
 ud_3                -7.569698e-02 1 1  ON 13
 ud_4                -1.241298e-01 1 1  ON 14
 ud_5                -1.563081e-01 1 1  ON 15
 ud_6                -1.581496e-01 1 1  ON 16
 ud_7                -1.130473e-01 1 1  ON 17
 ud_8                -8.092106e-03 1 1  ON 18
 ud_9                 9.295457e-02 1 1  ON 19
 eO_0                -7.926279e-01 1 1  ON 20
 eO_1                -4.690924e-01 1 1  ON 21
 eO_2                -5.389087e-02 1 1  ON 22
 eO_3                 2.094289e-01 1 1  ON 23
 eO_4                 3.134573e-01 1 1  ON 24
 eO_5                 3.330390e-01 1 1  ON 25
 eO_6                 2.677484e-01 1 1  ON 26
 eO_7                 1.298291e-01 1 1  ON 27
 eO_8                 3.095416e-02 1 1  ON 28
 eO_9                 1.943696e-02 1 1  ON 29
eH1_0                -1.849009e-01 1 1  ON 30
eH1_1                -1.054946e-01 1 1  ON 31
eH1_2                -6.391690e-02 1 1  ON 32
eH1_3                -2.666994e-02 1 1  ON 33
eH1_4                 1.842461e-02 1 1  ON 34
eH1_5                 3.109011e-02 1 1  ON 35
eH1_6                 7.667155e-02 1 1  ON 36
eH1_7                 1.100669e-01 1 1  ON 37
eH1_8                 1.005667e-01 1 1  ON 38
eH1_9                 2.764839e-02 1 1  ON 39
eH2_0                -1.867106e-01 1 1  ON 40
eH2_1                -1.073498e-01 1 1  ON 41
eH2_2                -6.553348e-02 1 1  ON 42
eH2_3                -2.796123e-02 1 1  ON 43
eH2_4                 1.741231e-02 1 1  ON 44
eH2_5                 3.136610e-02 1 1  ON 45
eH2_6                 7.872143e-02 1 1  ON 46
eH2_7                 1.136525e-01 1 1  ON 47
eH2_8                 1.033978e-01 1 1  ON 48
eH2_9                 2.973447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6123e+01 secs
  Total Execution time = 2.2672e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
