Rank =    0  Free Memory = 85311 MB
Rank =    1  Free Memory = 85311 MB
Rank =    2  Free Memory = 85311 MB
Rank =    3  Free Memory = 85311 MB
Rank =    4  Free Memory = 85311 MB
Rank =    5  Free Memory = 85311 MB
Rank =    6  Free Memory = 85310 MB
Rank =    7  Free Memory = 85310 MB
Rank =    8  Free Memory = 85310 MB
Rank =    9  Free Memory = 85310 MB
Rank =   10  Free Memory = 85310 MB
Rank =   11  Free Memory = 85309 MB
Rank =   12  Free Memory = 85309 MB
Rank =   13  Free Memory = 85309 MB
Rank =   14  Free Memory = 85292 MB
Rank =   15  Free Memory = 85292 MB
Rank =   16  Free Memory = 85292 MB
Rank =   17  Free Memory = 85292 MB
Rank =   18  Free Memory = 85292 MB
Rank =   19  Free Memory = 85292 MB
Rank =   20  Free Memory = 85291 MB
Rank =   21  Free Memory = 85291 MB
Rank =   22  Free Memory = 85291 MB
Rank =   23  Free Memory = 85291 MB
Rank =   24  Free Memory = 85291 MB
Rank =   25  Free Memory = 85291 MB
Rank =   26  Free Memory = 85291 MB
Rank =   27  Free Memory = 85291 MB
Rank =   28  Free Memory = 85291 MB
Rank =   29  Free Memory = 85291 MB
Rank =   30  Free Memory = 85291 MB
Rank =   31  Free Memory = 85291 MB
Rank =   32  Free Memory = 79042 MB
Rank =   33  Free Memory = 79042 MB
Rank =   34  Free Memory = 79042 MB
Rank =   35  Free Memory = 79042 MB
Rank =   36  Free Memory = 79042 MB
Rank =   37  Free Memory = 79042 MB
Rank =   38  Free Memory = 79042 MB
Rank =   39  Free Memory = 79042 MB
Rank =   40  Free Memory = 79041 MB
Rank =   41  Free Memory = 79041 MB
Rank =   42  Free Memory = 79041 MB
Rank =   43  Free Memory = 79041 MB
Rank =   44  Free Memory = 79041 MB
Rank =   45  Free Memory = 79041 MB
Rank =   46  Free Memory = 79041 MB
Rank =   47  Free Memory = 79041 MB
Rank =   48  Free Memory = 79041 MB
Rank =   49  Free Memory = 79041 MB
Rank =   50  Free Memory = 79041 MB
Rank =   51  Free Memory = 79041 MB
Rank =   52  Free Memory = 79041 MB
Rank =   53  Free Memory = 79041 MB
Rank =   54  Free Memory = 79040 MB
Rank =   55  Free Memory = 79040 MB
Rank =   56  Free Memory = 79040 MB
Rank =   57  Free Memory = 79040 MB
Rank =   58  Free Memory = 79040 MB
Rank =   59  Free Memory = 79040 MB
Rank =   60  Free Memory = 79040 MB
Rank =   61  Free Memory = 79040 MB
Rank =   62  Free Memory = 79040 MB
Rank =   63  Free Memory = 79040 MB
Rank =   64  Free Memory = 81043 MB
Rank =   65  Free Memory = 81043 MB
Rank =   66  Free Memory = 81043 MB
Rank =   67  Free Memory = 81043 MB
Rank =   68  Free Memory = 81043 MB
Rank =   69  Free Memory = 81043 MB
Rank =   70  Free Memory = 81043 MB
Rank =   71  Free Memory = 81043 MB
Rank =   72  Free Memory = 81043 MB
Rank =   73  Free Memory = 81043 MB
Rank =   74  Free Memory = 81043 MB
Rank =   75  Free Memory = 81043 MB
Rank =   76  Free Memory = 81043 MB
Rank =   77  Free Memory = 81043 MB
Rank =   78  Free Memory = 81043 MB
Rank =   79  Free Memory = 81043 MB
Rank =   80  Free Memory = 81043 MB
Rank =   81  Free Memory = 81043 MB
Rank =   82  Free Memory = 81043 MB
Rank =   83  Free Memory = 81043 MB
Rank =   84  Free Memory = 81043 MB
Rank =   85  Free Memory = 81043 MB
Rank =   86  Free Memory = 81043 MB
Rank =   87  Free Memory = 81043 MB
Rank =   88  Free Memory = 81043 MB
Rank =   89  Free Memory = 81043 MB
Rank =   90  Free Memory = 81043 MB
Rank =   91  Free Memory = 81043 MB
Rank =   92  Free Memory = 81043 MB
Rank =   93  Free Memory = 81043 MB
Rank =   94  Free Memory = 81043 MB
Rank =   95  Free Memory = 81043 MB
Rank =   96  Free Memory = 78873 MB
Rank =   97  Free Memory = 78872 MB
Rank =   98  Free Memory = 78872 MB
Rank =   99  Free Memory = 78872 MB
Rank =  100  Free Memory = 78872 MB
Rank =  101  Free Memory = 78872 MB
Rank =  102  Free Memory = 78872 MB
Rank =  103  Free Memory = 78872 MB
Rank =  104  Free Memory = 78872 MB
Rank =  105  Free Memory = 78872 MB
Rank =  106  Free Memory = 78872 MB
Rank =  107  Free Memory = 78872 MB
Rank =  108  Free Memory = 78872 MB
Rank =  109  Free Memory = 78872 MB
Rank =  110  Free Memory = 78872 MB
Rank =  111  Free Memory = 78872 MB
Rank =  112  Free Memory = 78872 MB
Rank =  113  Free Memory = 78872 MB
Rank =  114  Free Memory = 78872 MB
Rank =  115  Free Memory = 78872 MB
Rank =  116  Free Memory = 78872 MB
Rank =  117  Free Memory = 78872 MB
Rank =  118  Free Memory = 78872 MB
Rank =  119  Free Memory = 78872 MB
Rank =  120  Free Memory = 78872 MB
Rank =  121  Free Memory = 78872 MB
Rank =  122  Free Memory = 78872 MB
Rank =  123  Free Memory = 78872 MB
Rank =  124  Free Memory = 78872 MB
Rank =  125  Free Memory = 78872 MB
Rank =  126  Free Memory = 78872 MB
Rank =  127  Free Memory = 78872 MB
  Input file(s): opt_form_n2pistar_gvptt_run001x.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_gvptt_run001x.xml

  Project = FORM
  date    = 2023-04-24 15:39:06 PDT
  host    = n0016.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 266

  Range of prime numbers to use as seeds over processors and threads = 1721-2713


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.016648e-01    1         1  ON     0
     uu_1                 1.258303e-01    1         1  ON     1
     uu_2                 1.198889e-02    1         1  ON     2
     uu_3                -5.598147e-02    1         1  ON     3
     uu_4                -9.721807e-02    1         1  ON     4
     uu_5                -1.239941e-01    1         1  ON     5
     uu_6                -1.404143e-01    1         1  ON     6
     uu_7                -1.459933e-01    1         1  ON     7
     uu_8                -1.385477e-01    1         1  ON     8
     uu_9                -1.140571e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.213381e-01    1         1  ON     0
     ud_1                 1.386782e-01    1         1  ON     1
     ud_2                -8.180950e-03    1         1  ON     2
     ud_3                -8.684704e-02    1         1  ON     3
     ud_4                -1.305705e-01    1         1  ON     4
     ud_5                -1.566635e-01    1         1  ON     5
     ud_6                -1.708227e-01    1         1  ON     6
     ud_7                -1.741527e-01    1         1  ON     7
     ud_8                -1.633166e-01    1         1  ON     8
     ud_9                -1.353805e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.954098e-01    1         1  ON     0
     eC_1                -4.426416e-01    1         1  ON     1
     eC_2                -1.891242e-01    1         1  ON     2
     eC_3                -3.198050e-02    1         1  ON     3
     eC_4                 5.248944e-02    1         1  ON     4
     eC_5                 1.596560e-01    1         1  ON     5
     eC_6                 2.590565e-01    1         1  ON     6
     eC_7                 3.714785e-01    1         1  ON     7
     eC_8                 3.100669e-01    1         1  ON     8
     eC_9                 9.772614e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.201519e+00    1         1  ON     0
     eO_1                -8.235419e-01    1         1  ON     1
     eO_2                -3.569573e-01    1         1  ON     2
     eO_3                -1.167762e-02    1         1  ON     3
     eO_4                 2.179151e-01    1         1  ON     4
     eO_5                 3.884474e-01    1         1  ON     5
     eO_6                 4.390601e-01    1         1  ON     6
     eO_7                 4.455382e-01    1         1  ON     7
     eO_8                 4.055918e-01    1         1  ON     8
     eO_9                 3.337701e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.148961e-01    1         1  ON     0
     eH1_1                -1.221765e-01    1         1  ON     1
     eH1_2                -8.453045e-02    1         1  ON     2
     eH1_3                -6.416871e-02    1         1  ON     3
     eH1_4                 7.361953e-03    1         1  ON     4
     eH1_5                 5.337438e-02    1         1  ON     5
     eH1_6                 9.032045e-02    1         1  ON     6
     eH1_7                 6.304562e-02    1         1  ON     7
     eH1_8                 2.132510e-02    1         1  ON     8
     eH1_9                 5.720285e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.095887e-01    1         1  ON     0
     eH2_1                -1.169440e-01    1         1  ON     1
     eH2_2                -7.964224e-02    1         1  ON     2
     eH2_3                -5.940056e-02    1         1  ON     3
     eH2_4                 1.195581e-02    1         1  ON     4
     eH2_5                 5.803888e-02    1         1  ON     5
     eH2_6                 9.472518e-02    1         1  ON     6
     eH2_7                 6.701915e-02    1         1  ON     7
     eH2_8                 2.545039e-02    1         1  ON     8
     eH2_9                 5.893593e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.948163e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.1260e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6903
    reference variance = 1.37863
====================================================
  Execution time = 4.5442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5122e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516963059284
                                         uncertainty =       0.005210491115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516963059284
                                         uncertainty =       0.005210491115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508392536
  error estimate for blocks of size 2^( 2) =       0.000526327772
  error estimate for blocks of size 2^( 3) =       0.000541605807
  error estimate for blocks of size 2^( 4) =       0.000552769177
  error estimate for blocks of size 2^( 5) =       0.000559581698
  error estimate for blocks of size 2^( 6) =       0.000563322175
  error estimate for blocks of size 2^( 7) =       0.000567673468

      target function =                  N/A
              le_mean =     -22.670219673284
             les_mean =     514.455785718332
             stat err =       0.000560836630
             autocorr =       1.216954691708
              std dev =       0.718975619771
             le_variance =       0.516925941825


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.267021967328e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670219673284       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670220536674       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670221225933       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670220763234       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670220886227       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670220301507       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670219591903       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670219539238       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670219841852       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670219859720       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670220149119       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670220152813       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670219973542       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.745683e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670219673284       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670219974257       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670220317403       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670220210577       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670220278063       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670220112337       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670219778110       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670219758556       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670219866426       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670219840181       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.427461e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670219673284       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670219756758       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670219867749       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670219848439       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670219875216       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670219832032       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670219736039       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670219721187       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670219747076       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670219736745       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 4.208326e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0841e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  3.016643e-01                 1 1 ON  0
uu_1  1.258649e-01                 1 1 ON  1
uu_2  1.198986e-02                 1 1 ON  2
uu_3  -5.597006e-02                1 1 ON  3
uu_4  -9.714956e-02                1 1 ON  4
uu_5  -1.239545e-01                1 1 ON  5
uu_6  -1.403669e-01                1 1 ON  6
uu_7  -1.460604e-01                1 1 ON  7
uu_8  -1.385726e-01                1 1 ON  8
uu_9  -1.140899e-01                1 1 ON  9
ud_0  4.213988e-01                 1 1 ON  10
ud_1  1.387108e-01                 1 1 ON  11
ud_2  -8.153588e-03                1 1 ON  12
ud_3  -8.686645e-02                1 1 ON  13
ud_4  -1.305582e-01                1 1 ON  14
ud_5  -1.566393e-01                1 1 ON  15
ud_6  -1.708165e-01                1 1 ON  16
ud_7  -1.741058e-01                1 1 ON  17
ud_8  -1.633621e-01                1 1 ON  18
ud_9  -1.353846e-01                1 1 ON  19
eC_0  -5.954618e-01                1 1 ON  20
eC_1  -4.426267e-01                1 1 ON  21
eC_2  -1.890955e-01                1 1 ON  22
eC_3  -3.201562e-02                1 1 ON  23
eC_4  5.237967e-02                 1 1 ON  24
eC_5  1.597167e-01                 1 1 ON  25
eC_6  2.590343e-01                 1 1 ON  26
eC_7  3.714541e-01                 1 1 ON  27
eC_8  3.101470e-01                 1 1 ON  28
eC_9  9.777843e-02                 1 1 ON  29
eO_0  -1.201661e+00                1 1 ON  30
eO_1  -8.234640e-01                1 1 ON  31
eO_2  -3.569540e-01                1 1 ON  32
eO_3  -1.156505e-02                1 1 ON  33
eO_4  2.177723e-01                 1 1 ON  34
eO_5  3.884845e-01                 1 1 ON  35
eO_6  4.390103e-01                 1 1 ON  36
eO_7  4.455231e-01                 1 1 ON  37
eO_8  4.055737e-01                 1 1 ON  38
eO_9  3.338291e-01                 1 1 ON  39
eH1_0 -2.148483e-01                1 1 ON  40
eH1_1 -1.222023e-01                1 1 ON  41
eH1_2 -8.454241e-02                1 1 ON  42
eH1_3 -6.423816e-02                1 1 ON  43
eH1_4 7.315593e-03                 1 1 ON  44
eH1_5 5.342423e-02                 1 1 ON  45
eH1_6 9.024960e-02                 1 1 ON  46
eH1_7 6.307241e-02                 1 1 ON  47
eH1_8 2.136297e-02                 1 1 ON  48
eH1_9 5.719781e-02                 1 1 ON  49
eH2_0 -2.096780e-01                1 1 ON  50
eH2_1 -1.169749e-01                1 1 ON  51
eH2_2 -7.962456e-02                1 1 ON  52
eH2_3 -5.935673e-02                1 1 ON  53
eH2_4 1.194725e-02                 1 1 ON  54
eH2_5 5.806090e-02                 1 1 ON  55
eH2_6 9.469842e-02                 1 1 ON  56
eH2_7 6.703538e-02                 1 1 ON  57
eH2_8 2.548316e-02                 1 1 ON  58
eH2_9 5.890476e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7027
    reference variance = 0.455362
====================================================
  Execution time = 4.3509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1099e-01
  Total weights = 2.0000e+06
  Execution time = 3.6566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510809593837
                                         uncertainty =       0.003612674355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510809593837
                                         uncertainty =       0.003612674355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505430676
  error estimate for blocks of size 2^( 2) =       0.000522981684
  error estimate for blocks of size 2^( 3) =       0.000538058274
  error estimate for blocks of size 2^( 4) =       0.000548910251
  error estimate for blocks of size 2^( 5) =       0.000554825933
  error estimate for blocks of size 2^( 6) =       0.000556858231
  error estimate for blocks of size 2^( 7) =       0.000555984936

      target function =                  N/A
              le_mean =     -22.669190279508
             les_mean =     514.403108010025
             stat err =       0.000554144838
             autocorr =       1.202052370423
              std dev =       0.714786917174
             le_variance =       0.510920336963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510990537763
                                         uncertainty =       0.003613252727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510990537763
                                         uncertainty =       0.003613252727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505520229
  error estimate for blocks of size 2^( 2) =       0.000523066036
  error estimate for blocks of size 2^( 3) =       0.000538137303
  error estimate for blocks of size 2^( 4) =       0.000548985657
  error estimate for blocks of size 2^( 5) =       0.000554902450
  error estimate for blocks of size 2^( 6) =       0.000556931255
  error estimate for blocks of size 2^( 7) =       0.000556061280

      target function =                  N/A
              le_mean =     -22.669190200864
             les_mean =     514.403285511298
             stat err =       0.000554220160
             autocorr =       1.201953208558
              std dev =       0.714913563934
             le_variance =       0.511101403898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510958441973
                                         uncertainty =       0.003613081471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510958441973
                                         uncertainty =       0.003613081471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505504378
  error estimate for blocks of size 2^( 2) =       0.000523050718
  error estimate for blocks of size 2^( 3) =       0.000538123139
  error estimate for blocks of size 2^( 4) =       0.000548971992
  error estimate for blocks of size 2^( 5) =       0.000554888688
  error estimate for blocks of size 2^( 6) =       0.000556918276
  error estimate for blocks of size 2^( 7) =       0.000556047416

      target function =                  N/A
              le_mean =     -22.669190154625
             les_mean =     514.403251363585
             stat err =       0.000554206593
             autocorr =       1.201969736553
              std dev =       0.714891147355
             le_variance =       0.511069352566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510829153769
                                         uncertainty =       0.003612714950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510829153769
                                         uncertainty =       0.003612714950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505440367
  error estimate for blocks of size 2^( 2) =       0.000522990725
  error estimate for blocks of size 2^( 3) =       0.000538066767
  error estimate for blocks of size 2^( 4) =       0.000548918342
  error estimate for blocks of size 2^( 5) =       0.000554834216
  error estimate for blocks of size 2^( 6) =       0.000556866110
  error estimate for blocks of size 2^( 7) =       0.000555993164

      target function =                  N/A
              le_mean =     -22.669190223301
             les_mean =     514.403125053186
             stat err =       0.000554152958
             autocorr =       1.202041507487
              std dev =       0.714800621480
             le_variance =       0.510939928468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669190279508        initial  <--
     2.5000e-01     2.5000e+00             3.7457e-04       -22.669190200864
     1.0000e+00     1.0000e+01             1.4275e-04       -22.669190154625
     4.0000e+00     4.0000e+01             4.2083e-05       -22.669190223301

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6994
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 3.016648e-01 1 1  ON 0
 uu_1                 1.258303e-01 1 1  ON 1
 uu_2                 1.198889e-02 1 1  ON 2
 uu_3                -5.598147e-02 1 1  ON 3
 uu_4                -9.721807e-02 1 1  ON 4
 uu_5                -1.239941e-01 1 1  ON 5
 uu_6                -1.404143e-01 1 1  ON 6
 uu_7                -1.459933e-01 1 1  ON 7
 uu_8                -1.385477e-01 1 1  ON 8
 uu_9                -1.140571e-01 1 1  ON 9
 ud_0                 4.213381e-01 1 1  ON 10
 ud_1                 1.386782e-01 1 1  ON 11
 ud_2                -8.180950e-03 1 1  ON 12
 ud_3                -8.684704e-02 1 1  ON 13
 ud_4                -1.305705e-01 1 1  ON 14
 ud_5                -1.566635e-01 1 1  ON 15
 ud_6                -1.708227e-01 1 1  ON 16
 ud_7                -1.741527e-01 1 1  ON 17
 ud_8                -1.633166e-01 1 1  ON 18
 ud_9                -1.353805e-01 1 1  ON 19
 eC_0                -5.954098e-01 1 1  ON 20
 eC_1                -4.426416e-01 1 1  ON 21
 eC_2                -1.891242e-01 1 1  ON 22
 eC_3                -3.198050e-02 1 1  ON 23
 eC_4                 5.248944e-02 1 1  ON 24
 eC_5                 1.596560e-01 1 1  ON 25
 eC_6                 2.590565e-01 1 1  ON 26
 eC_7                 3.714785e-01 1 1  ON 27
 eC_8                 3.100669e-01 1 1  ON 28
 eC_9                 9.772614e-02 1 1  ON 29
 eO_0                -1.201519e+00 1 1  ON 30
 eO_1                -8.235419e-01 1 1  ON 31
 eO_2                -3.569573e-01 1 1  ON 32
 eO_3                -1.167762e-02 1 1  ON 33
 eO_4                 2.179151e-01 1 1  ON 34
 eO_5                 3.884474e-01 1 1  ON 35
 eO_6                 4.390601e-01 1 1  ON 36
 eO_7                 4.455382e-01 1 1  ON 37
 eO_8                 4.055918e-01 1 1  ON 38
 eO_9                 3.337701e-01 1 1  ON 39
eH1_0                -2.148961e-01 1 1  ON 40
eH1_1                -1.221765e-01 1 1  ON 41
eH1_2                -8.453045e-02 1 1  ON 42
eH1_3                -6.416871e-02 1 1  ON 43
eH1_4                 7.361953e-03 1 1  ON 44
eH1_5                 5.337438e-02 1 1  ON 45
eH1_6                 9.032045e-02 1 1  ON 46
eH1_7                 6.304562e-02 1 1  ON 47
eH1_8                 2.132510e-02 1 1  ON 48
eH1_9                 5.720285e-02 1 1  ON 49
eH2_0                -2.095887e-01 1 1  ON 50
eH2_1                -1.169440e-01 1 1  ON 51
eH2_2                -7.964224e-02 1 1  ON 52
eH2_3                -5.940056e-02 1 1  ON 53
eH2_4                 1.195581e-02 1 1  ON 54
eH2_5                 5.803888e-02 1 1  ON 55
eH2_6                 9.472518e-02 1 1  ON 56
eH2_7                 6.701915e-02 1 1  ON 57
eH2_8                 2.545039e-02 1 1  ON 58
eH2_9                 5.893593e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2455e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2696e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7015
    reference variance = 0.827871
====================================================
  Execution time = 4.4578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.2085e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5501e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520913297541
                                         uncertainty =       0.009465263544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520913297541
                                         uncertainty =       0.009465263544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510316552
  error estimate for blocks of size 2^( 2) =       0.000527584697
  error estimate for blocks of size 2^( 3) =       0.000543323344
  error estimate for blocks of size 2^( 4) =       0.000554330359
  error estimate for blocks of size 2^( 5) =       0.000561586015
  error estimate for blocks of size 2^( 6) =       0.000565530489
  error estimate for blocks of size 2^( 7) =       0.000569256067

      target function =                  N/A
              le_mean =     -22.670827135249
             les_mean =     514.487248703005
             stat err =       0.000562675733
             autocorr =       1.215729794215
              std dev =       0.721696589351
             le_variance =       0.520845967081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267082713525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670827135249       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670827213705       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670827322412       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670827478024       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670827360444       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670827320402       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670827334037       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670827390075       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670827371798       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670827365534       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 5.984821e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670827135249       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670827156548       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670827186042       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670827231291       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670827204563       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670827193632       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670827197703       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670827210578       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670827206017       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670827203977       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.700740e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670827135249       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670827140691       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670827148234       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670827160004       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670827153556       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670827150796       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670827151911       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670827155054       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670827153913       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670827153360       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 4.412531e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0091e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 3.016649e-01 1 1  ON 0
 uu_1                 1.258250e-01 1 1  ON 1
 uu_2                 1.198569e-02 1 1  ON 2
 uu_3                -5.597830e-02 1 1  ON 3
 uu_4                -9.721911e-02 1 1  ON 4
 uu_5                -1.239927e-01 1 1  ON 5
 uu_6                -1.404011e-01 1 1  ON 6
 uu_7                -1.459889e-01 1 1  ON 7
 uu_8                -1.385534e-01 1 1  ON 8
 uu_9                -1.140534e-01 1 1  ON 9
 ud_0                 4.213403e-01 1 1  ON 10
 ud_1                 1.386952e-01 1 1  ON 11
 ud_2                -8.182363e-03 1 1  ON 12
 ud_3                -8.684292e-02 1 1  ON 13
 ud_4                -1.305676e-01 1 1  ON 14
 ud_5                -1.566606e-01 1 1  ON 15
 ud_6                -1.708284e-01 1 1  ON 16
 ud_7                -1.741632e-01 1 1  ON 17
 ud_8                -1.633182e-01 1 1  ON 18
 ud_9                -1.353724e-01 1 1  ON 19
 eC_0                -5.954106e-01 1 1  ON 20
 eC_1                -4.426341e-01 1 1  ON 21
 eC_2                -1.891317e-01 1 1  ON 22
 eC_3                -3.199402e-02 1 1  ON 23
 eC_4                 5.249113e-02 1 1  ON 24
 eC_5                 1.596540e-01 1 1  ON 25
 eC_6                 2.590603e-01 1 1  ON 26
 eC_7                 3.714785e-01 1 1  ON 27
 eC_8                 3.100735e-01 1 1  ON 28
 eC_9                 9.773005e-02 1 1  ON 29
 eO_0                -1.201527e+00 1 1  ON 30
 eO_1                -8.235400e-01 1 1  ON 31
 eO_2                -3.569601e-01 1 1  ON 32
 eO_3                -1.166845e-02 1 1  ON 33
 eO_4                 2.179031e-01 1 1  ON 34
 eO_5                 3.884522e-01 1 1  ON 35
 eO_6                 4.390561e-01 1 1  ON 36
 eO_7                 4.455374e-01 1 1  ON 37
 eO_8                 4.055914e-01 1 1  ON 38
 eO_9                 3.337764e-01 1 1  ON 39
eH1_0                -2.148974e-01 1 1  ON 40
eH1_1                -1.221759e-01 1 1  ON 41
eH1_2                -8.454126e-02 1 1  ON 42
eH1_3                -6.418041e-02 1 1  ON 43
eH1_4                 7.366077e-03 1 1  ON 44
eH1_5                 5.338839e-02 1 1  ON 45
eH1_6                 9.031262e-02 1 1  ON 46
eH1_7                 6.304903e-02 1 1  ON 47
eH1_8                 2.133009e-02 1 1  ON 48
eH1_9                 5.720211e-02 1 1  ON 49
eH2_0                -2.095857e-01 1 1  ON 50
eH2_1                -1.169466e-01 1 1  ON 51
eH2_2                -7.964831e-02 1 1  ON 52
eH2_3                -5.940317e-02 1 1  ON 53
eH2_4                 1.196373e-02 1 1  ON 54
eH2_5                 5.803535e-02 1 1  ON 55
eH2_6                 9.472653e-02 1 1  ON 56
eH2_7                 6.701926e-02 1 1  ON 57
eH2_8                 2.545043e-02 1 1  ON 58
eH2_9                 5.893399e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6095
    reference variance = 0.587101
====================================================
  Execution time = 4.3847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1239e-01
  Total weights = 2.0000e+06
  Execution time = 3.6605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512409187704
                                         uncertainty =       0.006397049919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512409187704
                                         uncertainty =       0.006397049919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506152718
  error estimate for blocks of size 2^( 2) =       0.000523600944
  error estimate for blocks of size 2^( 3) =       0.000539977940
  error estimate for blocks of size 2^( 4) =       0.000551410443
  error estimate for blocks of size 2^( 5) =       0.000559045777
  error estimate for blocks of size 2^( 6) =       0.000561129829
  error estimate for blocks of size 2^( 7) =       0.000563702663

      target function =                  N/A
              le_mean =     -22.669001927825
             les_mean =     514.396029295673
             stat err =       0.000558822178
             autocorr =       1.218945028659
              std dev =       0.715808038596
             le_variance =       0.512381148119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512430270718
                                         uncertainty =       0.006397786788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512430270718
                                         uncertainty =       0.006397786788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506163143
  error estimate for blocks of size 2^( 2) =       0.000523610304
  error estimate for blocks of size 2^( 3) =       0.000539985499
  error estimate for blocks of size 2^( 4) =       0.000551416649
  error estimate for blocks of size 2^( 5) =       0.000559051437
  error estimate for blocks of size 2^( 6) =       0.000561133900
  error estimate for blocks of size 2^( 7) =       0.000563706624

      target function =                  N/A
              le_mean =     -22.669001545247
             les_mean =     514.396033057548
             stat err =       0.000558827153
             autocorr =       1.218916517920
              std dev =       0.715822782070
             le_variance =       0.512402255331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512418895226
                                         uncertainty =       0.006397398950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512418895226
                                         uncertainty =       0.006397398950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506157521
  error estimate for blocks of size 2^( 2) =       0.000523605186
  error estimate for blocks of size 2^( 3) =       0.000539981203
  error estimate for blocks of size 2^( 4) =       0.000551412966
  error estimate for blocks of size 2^( 5) =       0.000559048018
  error estimate for blocks of size 2^( 6) =       0.000561131150
  error estimate for blocks of size 2^( 7) =       0.000563703891

      target function =                  N/A
              le_mean =     -22.669001714019
             les_mean =     514.396029325358
             stat err =       0.000558824006
             autocorr =       1.218929873173
              std dev =       0.715814830357
             le_variance =       0.512390871359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512410358028
                                         uncertainty =       0.006397092490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512410358028
                                         uncertainty =       0.006397092490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506153297
  error estimate for blocks of size 2^( 2) =       0.000523601452
  error estimate for blocks of size 2^( 3) =       0.000539978323
  error estimate for blocks of size 2^( 4) =       0.000551410730
  error estimate for blocks of size 2^( 5) =       0.000559046029
  error estimate for blocks of size 2^( 6) =       0.000561129961
  error estimate for blocks of size 2^( 7) =       0.000563702782

      target function =                  N/A
              le_mean =     -22.669001899527
             les_mean =     514.396029185119
             stat err =       0.000558822376
             autocorr =       1.218943101115
              std dev =       0.715808857554
             le_variance =       0.512382320553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669001927825        initial  <--
     2.5000e+00     2.5000e+01             5.9848e-05       -22.669001545247
     1.0000e+01     1.0000e+02             1.7007e-05       -22.669001714019
     4.0000e+01     4.0000e+02             4.4125e-06       -22.669001899527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2150
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 3.016648e-01 1 1  ON 0
 uu_1                 1.258303e-01 1 1  ON 1
 uu_2                 1.198889e-02 1 1  ON 2
 uu_3                -5.598147e-02 1 1  ON 3
 uu_4                -9.721807e-02 1 1  ON 4
 uu_5                -1.239941e-01 1 1  ON 5
 uu_6                -1.404143e-01 1 1  ON 6
 uu_7                -1.459933e-01 1 1  ON 7
 uu_8                -1.385477e-01 1 1  ON 8
 uu_9                -1.140571e-01 1 1  ON 9
 ud_0                 4.213381e-01 1 1  ON 10
 ud_1                 1.386782e-01 1 1  ON 11
 ud_2                -8.180950e-03 1 1  ON 12
 ud_3                -8.684704e-02 1 1  ON 13
 ud_4                -1.305705e-01 1 1  ON 14
 ud_5                -1.566635e-01 1 1  ON 15
 ud_6                -1.708227e-01 1 1  ON 16
 ud_7                -1.741527e-01 1 1  ON 17
 ud_8                -1.633166e-01 1 1  ON 18
 ud_9                -1.353805e-01 1 1  ON 19
 eC_0                -5.954098e-01 1 1  ON 20
 eC_1                -4.426416e-01 1 1  ON 21
 eC_2                -1.891242e-01 1 1  ON 22
 eC_3                -3.198050e-02 1 1  ON 23
 eC_4                 5.248944e-02 1 1  ON 24
 eC_5                 1.596560e-01 1 1  ON 25
 eC_6                 2.590565e-01 1 1  ON 26
 eC_7                 3.714785e-01 1 1  ON 27
 eC_8                 3.100669e-01 1 1  ON 28
 eC_9                 9.772614e-02 1 1  ON 29
 eO_0                -1.201519e+00 1 1  ON 30
 eO_1                -8.235419e-01 1 1  ON 31
 eO_2                -3.569573e-01 1 1  ON 32
 eO_3                -1.167762e-02 1 1  ON 33
 eO_4                 2.179151e-01 1 1  ON 34
 eO_5                 3.884474e-01 1 1  ON 35
 eO_6                 4.390601e-01 1 1  ON 36
 eO_7                 4.455382e-01 1 1  ON 37
 eO_8                 4.055918e-01 1 1  ON 38
 eO_9                 3.337701e-01 1 1  ON 39
eH1_0                -2.148961e-01 1 1  ON 40
eH1_1                -1.221765e-01 1 1  ON 41
eH1_2                -8.453045e-02 1 1  ON 42
eH1_3                -6.416871e-02 1 1  ON 43
eH1_4                 7.361953e-03 1 1  ON 44
eH1_5                 5.337438e-02 1 1  ON 45
eH1_6                 9.032045e-02 1 1  ON 46
eH1_7                 6.304562e-02 1 1  ON 47
eH1_8                 2.132510e-02 1 1  ON 48
eH1_9                 5.720285e-02 1 1  ON 49
eH2_0                -2.095887e-01 1 1  ON 50
eH2_1                -1.169440e-01 1 1  ON 51
eH2_2                -7.964224e-02 1 1  ON 52
eH2_3                -5.940056e-02 1 1  ON 53
eH2_4                 1.195581e-02 1 1  ON 54
eH2_5                 5.803888e-02 1 1  ON 55
eH2_6                 9.472518e-02 1 1  ON 56
eH2_7                 6.701915e-02 1 1  ON 57
eH2_8                 2.545039e-02 1 1  ON 58
eH2_9                 5.893593e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2231e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6833
    reference variance = 0.452139
====================================================
  Execution time = 4.4067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.4050e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5326e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540634833544
                                         uncertainty =       0.019021757599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.540634833544
                                         uncertainty =       0.019021757599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000519854735
  error estimate for blocks of size 2^( 2) =       0.000537338814
  error estimate for blocks of size 2^( 3) =       0.000552606271
  error estimate for blocks of size 2^( 4) =       0.000563772433
  error estimate for blocks of size 2^( 5) =       0.000569233607
  error estimate for blocks of size 2^( 6) =       0.000573360089
  error estimate for blocks of size 2^( 7) =       0.000576187082

      target function =                  N/A
              le_mean =     -22.669609334350
             les_mean =     514.451684993040
             stat err =       0.000570638303
             autocorr =       1.204918938069
              std dev =       0.735185616854
             le_variance =       0.540497891228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266960933435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669609334350       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669609375699       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669609402500       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669609431483       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669609429356       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669609430680       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669609433119       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669609429354       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669609431193       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669609430994       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 5.485090e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669609334350       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669609344760       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669609351529       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669609358895       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669609358394       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669609358730       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669609359338       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669609358375       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669609358817       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669609358767       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.395828e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669609334350       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669609336957       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669609338654       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669609340503       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669609340380       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669609340465       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669609340618       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669609340373       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669609340483       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669609340470       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 3.505320e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9406e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 3.016656e-01 1 1  ON 0
 uu_1                 1.258299e-01 1 1  ON 1
 uu_2                 1.198857e-02 1 1  ON 2
 uu_3                -5.598090e-02 1 1  ON 3
 uu_4                -9.721759e-02 1 1  ON 4
 uu_5                -1.239941e-01 1 1  ON 5
 uu_6                -1.404132e-01 1 1  ON 6
 uu_7                -1.459931e-01 1 1  ON 7
 uu_8                -1.385489e-01 1 1  ON 8
 uu_9                -1.140578e-01 1 1  ON 9
 ud_0                 4.213391e-01 1 1  ON 10
 ud_1                 1.386783e-01 1 1  ON 11
 ud_2                -8.179554e-03 1 1  ON 12
 ud_3                -8.684823e-02 1 1  ON 13
 ud_4                -1.305709e-01 1 1  ON 14
 ud_5                -1.566639e-01 1 1  ON 15
 ud_6                -1.708233e-01 1 1  ON 16
 ud_7                -1.741518e-01 1 1  ON 17
 ud_8                -1.633161e-01 1 1  ON 18
 ud_9                -1.353803e-01 1 1  ON 19
 eC_0                -5.954100e-01 1 1  ON 20
 eC_1                -4.426416e-01 1 1  ON 21
 eC_2                -1.891244e-01 1 1  ON 22
 eC_3                -3.198070e-02 1 1  ON 23
 eC_4                 5.248914e-02 1 1  ON 24
 eC_5                 1.596564e-01 1 1  ON 25
 eC_6                 2.590561e-01 1 1  ON 26
 eC_7                 3.714784e-01 1 1  ON 27
 eC_8                 3.100677e-01 1 1  ON 28
 eC_9                 9.772652e-02 1 1  ON 29
 eO_0                -1.201520e+00 1 1  ON 30
 eO_1                -8.235418e-01 1 1  ON 31
 eO_2                -3.569570e-01 1 1  ON 32
 eO_3                -1.167836e-02 1 1  ON 33
 eO_4                 2.179146e-01 1 1  ON 34
 eO_5                 3.884476e-01 1 1  ON 35
 eO_6                 4.390598e-01 1 1  ON 36
 eO_7                 4.455380e-01 1 1  ON 37
 eO_8                 4.055918e-01 1 1  ON 38
 eO_9                 3.337709e-01 1 1  ON 39
eH1_0                -2.148956e-01 1 1  ON 40
eH1_1                -1.221772e-01 1 1  ON 41
eH1_2                -8.453145e-02 1 1  ON 42
eH1_3                -6.416970e-02 1 1  ON 43
eH1_4                 7.362603e-03 1 1  ON 44
eH1_5                 5.337491e-02 1 1  ON 45
eH1_6                 9.032149e-02 1 1  ON 46
eH1_7                 6.304579e-02 1 1  ON 47
eH1_8                 2.132497e-02 1 1  ON 48
eH1_9                 5.720234e-02 1 1  ON 49
eH2_0                -2.095882e-01 1 1  ON 50
eH2_1                -1.169447e-01 1 1  ON 51
eH2_2                -7.964268e-02 1 1  ON 52
eH2_3                -5.939948e-02 1 1  ON 53
eH2_4                 1.195602e-02 1 1  ON 54
eH2_5                 5.803832e-02 1 1  ON 55
eH2_6                 9.472439e-02 1 1  ON 56
eH2_7                 6.701953e-02 1 1  ON 57
eH2_8                 2.545022e-02 1 1  ON 58
eH2_9                 5.893592e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6586
    reference variance = 0.31392
====================================================
  Execution time = 4.4359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1579e-01
  Total weights = 2.0000e+06
  Execution time = 3.6543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939056539
                                         uncertainty =       0.006824060252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939056539
                                         uncertainty =       0.006824060252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507835968
  error estimate for blocks of size 2^( 2) =       0.000525788525
  error estimate for blocks of size 2^( 3) =       0.000541297919
  error estimate for blocks of size 2^( 4) =       0.000552532684
  error estimate for blocks of size 2^( 5) =       0.000558482267
  error estimate for blocks of size 2^( 6) =       0.000562390968
  error estimate for blocks of size 2^( 7) =       0.000565618944

      target function =                  N/A
              le_mean =     -22.669664540759
             les_mean =     514.429484872701
             stat err =       0.000559756216
             autocorr =       1.214929106203
              std dev =       0.718188512894
             le_variance =       0.515794740053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515940114585
                                         uncertainty =       0.006824095169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515940114585
                                         uncertainty =       0.006824095169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507836488
  error estimate for blocks of size 2^( 2) =       0.000525789121
  error estimate for blocks of size 2^( 3) =       0.000541298509
  error estimate for blocks of size 2^( 4) =       0.000552533105
  error estimate for blocks of size 2^( 5) =       0.000558482453
  error estimate for blocks of size 2^( 6) =       0.000562390907
  error estimate for blocks of size 2^( 7) =       0.000565619149

      target function =                  N/A
              le_mean =     -22.669664566649
             les_mean =     514.429487104342
             stat err =       0.000559756404
             autocorr =       1.214927429291
              std dev =       0.718189249321
             le_variance =       0.515795797840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939571700
                                         uncertainty =       0.006824077729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939571700
                                         uncertainty =       0.006824077729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507836221
  error estimate for blocks of size 2^( 2) =       0.000525788817
  error estimate for blocks of size 2^( 3) =       0.000541298210
  error estimate for blocks of size 2^( 4) =       0.000552532889
  error estimate for blocks of size 2^( 5) =       0.000558482353
  error estimate for blocks of size 2^( 6) =       0.000562390928
  error estimate for blocks of size 2^( 7) =       0.000565619040

      target function =                  N/A
              le_mean =     -22.669664554065
             les_mean =     514.429485991009
             stat err =       0.000559756303
             autocorr =       1.214928269368
              std dev =       0.718188871465
             le_variance =       0.515795255096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939120404
                                         uncertainty =       0.006824062437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515939120404
                                         uncertainty =       0.006824062437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507835999
  error estimate for blocks of size 2^( 2) =       0.000525788562
  error estimate for blocks of size 2^( 3) =       0.000541297956
  error estimate for blocks of size 2^( 4) =       0.000552532710
  error estimate for blocks of size 2^( 5) =       0.000558482278
  error estimate for blocks of size 2^( 6) =       0.000562390963
  error estimate for blocks of size 2^( 7) =       0.000565618955

      target function =                  N/A
              le_mean =     -22.669664542422
             les_mean =     514.429485011951
             stat err =       0.000559756226
             autocorr =       1.214929001640
              std dev =       0.718188557346
             le_variance =       0.515794803903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669664540759        initial
     2.5000e+01     2.5000e+02             5.4851e-06       -22.669664566649  <--
     1.0000e+02     1.0000e+03             1.3958e-06       -22.669664554065
     4.0000e+02     4.0000e+03             3.5053e-07       -22.669664542422

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 6.2708e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 3.016681e-01 1 1  ON 0
 uu_1                 1.258287e-01 1 1  ON 1
 uu_2                 1.198762e-02 1 1  ON 2
 uu_3                -5.597922e-02 1 1  ON 3
 uu_4                -9.721616e-02 1 1  ON 4
 uu_5                -1.239941e-01 1 1  ON 5
 uu_6                -1.404101e-01 1 1  ON 6
 uu_7                -1.459923e-01 1 1  ON 7
 uu_8                -1.385526e-01 1 1  ON 8
 uu_9                -1.140599e-01 1 1  ON 9
 ud_0                 4.213419e-01 1 1  ON 10
 ud_1                 1.386788e-01 1 1  ON 11
 ud_2                -8.175465e-03 1 1  ON 12
 ud_3                -8.685171e-02 1 1  ON 13
 ud_4                -1.305721e-01 1 1  ON 14
 ud_5                -1.566649e-01 1 1  ON 15
 ud_6                -1.708249e-01 1 1  ON 16
 ud_7                -1.741490e-01 1 1  ON 17
 ud_8                -1.633145e-01 1 1  ON 18
 ud_9                -1.353797e-01 1 1  ON 19
 eC_0                -5.954105e-01 1 1  ON 20
 eC_1                -4.426418e-01 1 1  ON 21
 eC_2                -1.891253e-01 1 1  ON 22
 eC_3                -3.198130e-02 1 1  ON 23
 eC_4                 5.248824e-02 1 1  ON 24
 eC_5                 1.596574e-01 1 1  ON 25
 eC_6                 2.590552e-01 1 1  ON 26
 eC_7                 3.714779e-01 1 1  ON 27
 eC_8                 3.100699e-01 1 1  ON 28
 eC_9                 9.772766e-02 1 1  ON 29
 eO_0                -1.201521e+00 1 1  ON 30
 eO_1                -8.235415e-01 1 1  ON 31
 eO_2                -3.569559e-01 1 1  ON 32
 eO_3                -1.168055e-02 1 1  ON 33
 eO_4                 2.179132e-01 1 1  ON 34
 eO_5                 3.884484e-01 1 1  ON 35
 eO_6                 4.390590e-01 1 1  ON 36
 eO_7                 4.455374e-01 1 1  ON 37
 eO_8                 4.055919e-01 1 1  ON 38
 eO_9                 3.337732e-01 1 1  ON 39
eH1_0                -2.148942e-01 1 1  ON 40
eH1_1                -1.221791e-01 1 1  ON 41
eH1_2                -8.453441e-02 1 1  ON 42
eH1_3                -6.417267e-02 1 1  ON 43
eH1_4                 7.364531e-03 1 1  ON 44
eH1_5                 5.337648e-02 1 1  ON 45
eH1_6                 9.032462e-02 1 1  ON 46
eH1_7                 6.304630e-02 1 1  ON 47
eH1_8                 2.132457e-02 1 1  ON 48
eH1_9                 5.720083e-02 1 1  ON 49
eH2_0                -2.095869e-01 1 1  ON 50
eH2_1                -1.169466e-01 1 1  ON 51
eH2_2                -7.964398e-02 1 1  ON 52
eH2_3                -5.939629e-02 1 1  ON 53
eH2_4                 1.195665e-02 1 1  ON 54
eH2_5                 5.803666e-02 1 1  ON 55
eH2_6                 9.472202e-02 1 1  ON 56
eH2_7                 6.702067e-02 1 1  ON 57
eH2_8                 2.544974e-02 1 1  ON 58
eH2_9                 5.893592e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2212e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7541
    reference variance = 0.422358
====================================================
  Execution time = 4.4456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.0674e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5806e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506854812097
                                         uncertainty =       0.004115441236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506854812097
                                         uncertainty =       0.004115441236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503359962
  error estimate for blocks of size 2^( 2) =       0.000521431522
  error estimate for blocks of size 2^( 3) =       0.000537381452
  error estimate for blocks of size 2^( 4) =       0.000548671161
  error estimate for blocks of size 2^( 5) =       0.000555327846
  error estimate for blocks of size 2^( 6) =       0.000560730405
  error estimate for blocks of size 2^( 7) =       0.000561308146

      target function =                  N/A
              le_mean =     -22.669382177819
             les_mean =     514.407630574046
             stat err =       0.000556509390
             autocorr =       1.222327705342
              std dev =       0.711858485504
             le_variance =       0.506742503384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266938217782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669382177819       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669382345644       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669382394027       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669382415767       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669382364060       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669382349564       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669382360072       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669382340881       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669382336414       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669382345039       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 2.348244e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669382177819       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669382220492       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669382233178       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669382239037       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669382225744       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669382221679       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669382224548       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669382219812       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669382218482       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669382220598       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 6.043976e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669382177819       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669382188533       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669382191744       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669382193237       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669382189891       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669382188845       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669382189577       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669382188397       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669382188050       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669382188577       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 1.522343e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276793 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0275e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 3.016637e-01 1 1  ON 0
 uu_1                 1.258286e-01 1 1  ON 1
 uu_2                 1.198879e-02 1 1  ON 2
 uu_3                -5.597602e-02 1 1  ON 3
 uu_4                -9.721604e-02 1 1  ON 4
 uu_5                -1.239917e-01 1 1  ON 5
 uu_6                -1.404099e-01 1 1  ON 6
 uu_7                -1.459917e-01 1 1  ON 7
 uu_8                -1.385528e-01 1 1  ON 8
 uu_9                -1.140590e-01 1 1  ON 9
 ud_0                 4.213407e-01 1 1  ON 10
 ud_1                 1.386785e-01 1 1  ON 11
 ud_2                -8.173205e-03 1 1  ON 12
 ud_3                -8.685140e-02 1 1  ON 13
 ud_4                -1.305739e-01 1 1  ON 14
 ud_5                -1.566648e-01 1 1  ON 15
 ud_6                -1.708289e-01 1 1  ON 16
 ud_7                -1.741471e-01 1 1  ON 17
 ud_8                -1.633097e-01 1 1  ON 18
 ud_9                -1.353772e-01 1 1  ON 19
 eC_0                -5.954081e-01 1 1  ON 20
 eC_1                -4.426416e-01 1 1  ON 21
 eC_2                -1.891296e-01 1 1  ON 22
 eC_3                -3.198353e-02 1 1  ON 23
 eC_4                 5.248837e-02 1 1  ON 24
 eC_5                 1.596556e-01 1 1  ON 25
 eC_6                 2.590550e-01 1 1  ON 26
 eC_7                 3.714783e-01 1 1  ON 27
 eC_8                 3.100736e-01 1 1  ON 28
 eC_9                 9.772936e-02 1 1  ON 29
 eO_0                -1.201520e+00 1 1  ON 30
 eO_1                -8.235443e-01 1 1  ON 31
 eO_2                -3.569582e-01 1 1  ON 32
 eO_3                -1.168369e-02 1 1  ON 33
 eO_4                 2.179106e-01 1 1  ON 34
 eO_5                 3.884505e-01 1 1  ON 35
 eO_6                 4.390606e-01 1 1  ON 36
 eO_7                 4.455376e-01 1 1  ON 37
 eO_8                 4.055915e-01 1 1  ON 38
 eO_9                 3.337763e-01 1 1  ON 39
eH1_0                -2.148958e-01 1 1  ON 40
eH1_1                -1.221778e-01 1 1  ON 41
eH1_2                -8.453255e-02 1 1  ON 42
eH1_3                -6.417122e-02 1 1  ON 43
eH1_4                 7.365912e-03 1 1  ON 44
eH1_5                 5.337793e-02 1 1  ON 45
eH1_6                 9.032110e-02 1 1  ON 46
eH1_7                 6.304195e-02 1 1  ON 47
eH1_8                 2.132495e-02 1 1  ON 48
eH1_9                 5.720049e-02 1 1  ON 49
eH2_0                -2.095905e-01 1 1  ON 50
eH2_1                -1.169487e-01 1 1  ON 51
eH2_2                -7.964553e-02 1 1  ON 52
eH2_3                -5.939580e-02 1 1  ON 53
eH2_4                 1.196269e-02 1 1  ON 54
eH2_5                 5.803483e-02 1 1  ON 55
eH2_6                 9.471800e-02 1 1  ON 56
eH2_7                 6.702290e-02 1 1  ON 57
eH2_8                 2.545169e-02 1 1  ON 58
eH2_9                 5.893623e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6179
    reference variance = 0.550922
====================================================
  Execution time = 4.3783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1655e-01
  Total weights = 2.0000e+06
  Execution time = 3.6656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516521173170
                                         uncertainty =       0.010895487690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516521173170
                                         uncertainty =       0.010895487690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508211977
  error estimate for blocks of size 2^( 2) =       0.000525865504
  error estimate for blocks of size 2^( 3) =       0.000541270916
  error estimate for blocks of size 2^( 4) =       0.000552962903
  error estimate for blocks of size 2^( 5) =       0.000559057363
  error estimate for blocks of size 2^( 6) =       0.000563180078
  error estimate for blocks of size 2^( 7) =       0.000564786959

      target function =                  N/A
              le_mean =     -22.670722284506
             les_mean =     514.478207469446
             stat err =       0.000559996826
             autocorr =       1.214175148063
              std dev =       0.718720270026
             le_variance =       0.516558826546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516492379257
                                         uncertainty =       0.010894581664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516492379257
                                         uncertainty =       0.010894581664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508197813
  error estimate for blocks of size 2^( 2) =       0.000525852232
  error estimate for blocks of size 2^( 3) =       0.000541258541
  error estimate for blocks of size 2^( 4) =       0.000552951041
  error estimate for blocks of size 2^( 5) =       0.000559045926
  error estimate for blocks of size 2^( 6) =       0.000563168942
  error estimate for blocks of size 2^( 7) =       0.000564775866

      target function =                  N/A
              le_mean =     -22.670722323973
             les_mean =     514.478180465779
             stat err =       0.000559985444
             autocorr =       1.214193470929
              std dev =       0.718700238875
             le_variance =       0.516530033358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516506248435
                                         uncertainty =       0.010895015064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516506248435
                                         uncertainty =       0.010895015064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508204635
  error estimate for blocks of size 2^( 2) =       0.000525858628
  error estimate for blocks of size 2^( 3) =       0.000541264509
  error estimate for blocks of size 2^( 4) =       0.000552956766
  error estimate for blocks of size 2^( 5) =       0.000559051449
  error estimate for blocks of size 2^( 6) =       0.000563174315
  error estimate for blocks of size 2^( 7) =       0.000564781219

      target function =                  N/A
              le_mean =     -22.670722304550
             les_mean =     514.478193453795
             stat err =       0.000559990937
             autocorr =       1.214184692463
              std dev =       0.718709887251
             le_variance =       0.516543902033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516519289936
                                         uncertainty =       0.010895427961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516519289936
                                         uncertainty =       0.010895427961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508211050
  error estimate for blocks of size 2^( 2) =       0.000525864637
  error estimate for blocks of size 2^( 3) =       0.000541270108
  error estimate for blocks of size 2^( 4) =       0.000552962129
  error estimate for blocks of size 2^( 5) =       0.000559056617
  error estimate for blocks of size 2^( 6) =       0.000563179351
  error estimate for blocks of size 2^( 7) =       0.000564786235

      target function =                  N/A
              le_mean =     -22.670722286936
             les_mean =     514.478205696443
             stat err =       0.000559996083
             autocorr =       1.214176353503
              std dev =       0.718718959911
             le_variance =       0.516556943335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670722284506        initial
     6.2500e+00     6.2500e+01             2.3482e-05       -22.670722323973  <--
     2.5000e+01     2.5000e+02             6.0440e-06       -22.670722304550
     1.0000e+02     1.0000e+03             1.5223e-06       -22.670722286936

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 6.2196e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 3.016509e-01 1 1  ON 0
 uu_1                 1.258284e-01 1 1  ON 1
 uu_2                 1.199223e-02 1 1  ON 2
 uu_3                -5.596689e-02 1 1  ON 3
 uu_4                -9.721528e-02 1 1  ON 4
 uu_5                -1.239851e-01 1 1  ON 5
 uu_6                -1.404090e-01 1 1  ON 6
 uu_7                -1.459903e-01 1 1  ON 7
 uu_8                -1.385537e-01 1 1  ON 8
 uu_9                -1.140564e-01 1 1  ON 9
 ud_0                 4.213373e-01 1 1  ON 10
 ud_1                 1.386781e-01 1 1  ON 11
 ud_2                -8.166875e-03 1 1  ON 12
 ud_3                -8.685048e-02 1 1  ON 13
 ud_4                -1.305790e-01 1 1  ON 14
 ud_5                -1.566648e-01 1 1  ON 15
 ud_6                -1.708400e-01 1 1  ON 16
 ud_7                -1.741418e-01 1 1  ON 17
 ud_8                -1.632954e-01 1 1  ON 18
 ud_9                -1.353698e-01 1 1  ON 19
 eC_0                -5.954011e-01 1 1  ON 20
 eC_1                -4.426411e-01 1 1  ON 21
 eC_2                -1.891423e-01 1 1  ON 22
 eC_3                -3.199032e-02 1 1  ON 23
 eC_4                 5.248893e-02 1 1  ON 24
 eC_5                 1.596503e-01 1 1  ON 25
 eC_6                 2.590542e-01 1 1  ON 26
 eC_7                 3.714797e-01 1 1  ON 27
 eC_8                 3.100846e-01 1 1  ON 28
 eC_9                 9.773442e-02 1 1  ON 29
 eO_0                -1.201519e+00 1 1  ON 30
 eO_1                -8.235527e-01 1 1  ON 31
 eO_2                -3.569647e-01 1 1  ON 32
 eO_3                -1.169299e-02 1 1  ON 33
 eO_4                 2.179030e-01 1 1  ON 34
 eO_5                 3.884565e-01 1 1  ON 35
 eO_6                 4.390652e-01 1 1  ON 36
 eO_7                 4.455384e-01 1 1  ON 37
 eO_8                 4.055905e-01 1 1  ON 38
 eO_9                 3.337857e-01 1 1  ON 39
eH1_0                -2.149005e-01 1 1  ON 40
eH1_1                -1.221738e-01 1 1  ON 41
eH1_2                -8.452703e-02 1 1  ON 42
eH1_3                -6.416693e-02 1 1  ON 43
eH1_4                 7.370032e-03 1 1  ON 44
eH1_5                 5.338220e-02 1 1  ON 45
eH1_6                 9.031076e-02 1 1  ON 46
eH1_7                 6.302893e-02 1 1  ON 47
eH1_8                 2.132603e-02 1 1  ON 48
eH1_9                 5.719949e-02 1 1  ON 49
eH2_0                -2.096011e-01 1 1  ON 50
eH2_1                -1.169548e-01 1 1  ON 51
eH2_2                -7.965010e-02 1 1  ON 52
eH2_3                -5.939423e-02 1 1  ON 53
eH2_4                 1.198013e-02 1 1  ON 54
eH2_5                 5.802978e-02 1 1  ON 55
eH2_6                 9.470611e-02 1 1  ON 56
eH2_7                 6.702944e-02 1 1  ON 57
eH2_8                 2.545748e-02 1 1  ON 58
eH2_9                 5.893717e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2248e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.705
    reference variance = 0.576375
====================================================
  Execution time = 4.4545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5351e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511417291713
                                         uncertainty =       0.005434486037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511417291713
                                         uncertainty =       0.005434486037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505696922
  error estimate for blocks of size 2^( 2) =       0.000522930000
  error estimate for blocks of size 2^( 3) =       0.000538972786
  error estimate for blocks of size 2^( 4) =       0.000549920962
  error estimate for blocks of size 2^( 5) =       0.000556767746
  error estimate for blocks of size 2^( 6) =       0.000561310531
  error estimate for blocks of size 2^( 7) =       0.000565335789

      target function =                  N/A
              le_mean =     -22.669224942901
             les_mean =     514.405218009611
             stat err =       0.000558333757
             autocorr =       1.219009674268
              std dev =       0.715163445311
             le_variance =       0.511458753509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266922494290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669224942901       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669225207940       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669226183873       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669226634625       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669226596642       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669226639838       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669226736717       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669226769358       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669226794843       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669226800426       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 9.506248e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669224942901       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669225014250       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669225304529       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669225439285       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669225446483       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669225467763       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669225501748       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669225500557       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669225502955       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669225508033       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 2.494230e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669224942901       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669224961087       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669225037234       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669225072738       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669225076174       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669225082603       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669225092044       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669225091093       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669225091234       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669225092642       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 6.308091e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9909e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 3.016551e-01 1 1  ON 0
 uu_1                 1.258371e-01 1 1  ON 1
 uu_2                 1.198933e-02 1 1  ON 2
 uu_3                -5.596204e-02 1 1  ON 3
 uu_4                -9.722161e-02 1 1  ON 4
 uu_5                -1.239862e-01 1 1  ON 5
 uu_6                -1.404019e-01 1 1  ON 6
 uu_7                -1.460088e-01 1 1  ON 7
 uu_8                -1.385418e-01 1 1  ON 8
 uu_9                -1.140556e-01 1 1  ON 9
 ud_0                 4.213234e-01 1 1  ON 10
 ud_1                 1.386914e-01 1 1  ON 11
 ud_2                -8.170780e-03 1 1  ON 12
 ud_3                -8.686009e-02 1 1  ON 13
 ud_4                -1.305634e-01 1 1  ON 14
 ud_5                -1.566590e-01 1 1  ON 15
 ud_6                -1.708207e-01 1 1  ON 16
 ud_7                -1.741618e-01 1 1  ON 17
 ud_8                -1.632999e-01 1 1  ON 18
 ud_9                -1.353602e-01 1 1  ON 19
 eC_0                -5.954161e-01 1 1  ON 20
 eC_1                -4.426263e-01 1 1  ON 21
 eC_2                -1.891291e-01 1 1  ON 22
 eC_3                -3.199604e-02 1 1  ON 23
 eC_4                 5.246399e-02 1 1  ON 24
 eC_5                 1.596495e-01 1 1  ON 25
 eC_6                 2.590502e-01 1 1  ON 26
 eC_7                 3.714800e-01 1 1  ON 27
 eC_8                 3.100994e-01 1 1  ON 28
 eC_9                 9.774060e-02 1 1  ON 29
 eO_0                -1.201525e+00 1 1  ON 30
 eO_1                -8.235658e-01 1 1  ON 31
 eO_2                -3.569574e-01 1 1  ON 32
 eO_3                -1.168380e-02 1 1  ON 33
 eO_4                 2.178849e-01 1 1  ON 34
 eO_5                 3.884493e-01 1 1  ON 35
 eO_6                 4.390633e-01 1 1  ON 36
 eO_7                 4.455418e-01 1 1  ON 37
 eO_8                 4.055944e-01 1 1  ON 38
 eO_9                 3.337960e-01 1 1  ON 39
eH1_0                -2.149023e-01 1 1  ON 40
eH1_1                -1.221690e-01 1 1  ON 41
eH1_2                -8.452452e-02 1 1  ON 42
eH1_3                -6.416497e-02 1 1  ON 43
eH1_4                 7.371846e-03 1 1  ON 44
eH1_5                 5.337055e-02 1 1  ON 45
eH1_6                 9.031384e-02 1 1  ON 46
eH1_7                 6.302828e-02 1 1  ON 47
eH1_8                 2.132161e-02 1 1  ON 48
eH1_9                 5.719528e-02 1 1  ON 49
eH2_0                -2.096042e-01 1 1  ON 50
eH2_1                -1.169657e-01 1 1  ON 51
eH2_2                -7.963783e-02 1 1  ON 52
eH2_3                -5.939265e-02 1 1  ON 53
eH2_4                 1.198044e-02 1 1  ON 54
eH2_5                 5.802907e-02 1 1  ON 55
eH2_6                 9.469806e-02 1 1  ON 56
eH2_7                 6.702007e-02 1 1  ON 57
eH2_8                 2.546519e-02 1 1  ON 58
eH2_9                 5.893888e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5935
    reference variance = 0.416869
====================================================
  Execution time = 4.3803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0876e-01
  Total weights = 2.0000e+06
  Execution time = 3.6663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508655103808
                                         uncertainty =       0.003628485643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508655103808
                                         uncertainty =       0.003628485643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504361882
  error estimate for blocks of size 2^( 2) =       0.000522461835
  error estimate for blocks of size 2^( 3) =       0.000538158818
  error estimate for blocks of size 2^( 4) =       0.000549548578
  error estimate for blocks of size 2^( 5) =       0.000557081962
  error estimate for blocks of size 2^( 6) =       0.000560460424
  error estimate for blocks of size 2^( 7) =       0.000563269222

      target function =                  N/A
              le_mean =     -22.670245648603
             les_mean =     514.448799329535
             stat err =       0.000557590047
             autocorr =       1.222209097891
              std dev =       0.713275413780
             le_variance =       0.508761815902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654614063
                                         uncertainty =       0.003629176884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654614063
                                         uncertainty =       0.003629176884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504361621
  error estimate for blocks of size 2^( 2) =       0.000522460910
  error estimate for blocks of size 2^( 3) =       0.000538156135
  error estimate for blocks of size 2^( 4) =       0.000549545152
  error estimate for blocks of size 2^( 5) =       0.000557077374
  error estimate for blocks of size 2^( 6) =       0.000560456726
  error estimate for blocks of size 2^( 7) =       0.000563268535

      target function =                  N/A
              le_mean =     -22.670244809445
             les_mean =     514.448760756155
             stat err =       0.000557586947
             autocorr =       1.222196770661
              std dev =       0.713275045391
             le_variance =       0.508761290377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508649845797
                                         uncertainty =       0.003628795062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508649845797
                                         uncertainty =       0.003628795062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504359266
  error estimate for blocks of size 2^( 2) =       0.000522458962
  error estimate for blocks of size 2^( 3) =       0.000538154984
  error estimate for blocks of size 2^( 4) =       0.000549544398
  error estimate for blocks of size 2^( 5) =       0.000557077150
  error estimate for blocks of size 2^( 6) =       0.000560456177
  error estimate for blocks of size 2^( 7) =       0.000563266893

      target function =                  N/A
              le_mean =     -22.670245143405
             les_mean =     514.448771145366
             stat err =       0.000557586155
             autocorr =       1.222204716359
              std dev =       0.713271713770
             le_variance =       0.508756537664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654204946
                                         uncertainty =       0.003628522186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654204946
                                         uncertainty =       0.003628522186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504361435
  error estimate for blocks of size 2^( 2) =       0.000522461359
  error estimate for blocks of size 2^( 3) =       0.000538158219
  error estimate for blocks of size 2^( 4) =       0.000549547938
  error estimate for blocks of size 2^( 5) =       0.000557081241
  error estimate for blocks of size 2^( 6) =       0.000560459779
  error estimate for blocks of size 2^( 7) =       0.000563268835

      target function =                  N/A
              le_mean =     -22.670245579734
             les_mean =     514.448795305497
             stat err =       0.000557589448
             autocorr =       1.222208639284
              std dev =       0.713274781858
             le_variance =       0.508760914435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670245648603        initial  <--
     1.5625e+00     1.5625e+01             9.5062e-05       -22.670244809445
     6.2500e+00     6.2500e+01             2.4942e-05       -22.670245143405
     2.5000e+01     2.5000e+02             6.3081e-06       -22.670245579734

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1887
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 3.016509e-01 1 1  ON 0
 uu_1                 1.258284e-01 1 1  ON 1
 uu_2                 1.199223e-02 1 1  ON 2
 uu_3                -5.596689e-02 1 1  ON 3
 uu_4                -9.721528e-02 1 1  ON 4
 uu_5                -1.239851e-01 1 1  ON 5
 uu_6                -1.404090e-01 1 1  ON 6
 uu_7                -1.459903e-01 1 1  ON 7
 uu_8                -1.385537e-01 1 1  ON 8
 uu_9                -1.140564e-01 1 1  ON 9
 ud_0                 4.213373e-01 1 1  ON 10
 ud_1                 1.386781e-01 1 1  ON 11
 ud_2                -8.166875e-03 1 1  ON 12
 ud_3                -8.685048e-02 1 1  ON 13
 ud_4                -1.305790e-01 1 1  ON 14
 ud_5                -1.566648e-01 1 1  ON 15
 ud_6                -1.708400e-01 1 1  ON 16
 ud_7                -1.741418e-01 1 1  ON 17
 ud_8                -1.632954e-01 1 1  ON 18
 ud_9                -1.353698e-01 1 1  ON 19
 eC_0                -5.954011e-01 1 1  ON 20
 eC_1                -4.426411e-01 1 1  ON 21
 eC_2                -1.891423e-01 1 1  ON 22
 eC_3                -3.199032e-02 1 1  ON 23
 eC_4                 5.248893e-02 1 1  ON 24
 eC_5                 1.596503e-01 1 1  ON 25
 eC_6                 2.590542e-01 1 1  ON 26
 eC_7                 3.714797e-01 1 1  ON 27
 eC_8                 3.100846e-01 1 1  ON 28
 eC_9                 9.773442e-02 1 1  ON 29
 eO_0                -1.201519e+00 1 1  ON 30
 eO_1                -8.235527e-01 1 1  ON 31
 eO_2                -3.569647e-01 1 1  ON 32
 eO_3                -1.169299e-02 1 1  ON 33
 eO_4                 2.179030e-01 1 1  ON 34
 eO_5                 3.884565e-01 1 1  ON 35
 eO_6                 4.390652e-01 1 1  ON 36
 eO_7                 4.455384e-01 1 1  ON 37
 eO_8                 4.055905e-01 1 1  ON 38
 eO_9                 3.337857e-01 1 1  ON 39
eH1_0                -2.149005e-01 1 1  ON 40
eH1_1                -1.221738e-01 1 1  ON 41
eH1_2                -8.452703e-02 1 1  ON 42
eH1_3                -6.416693e-02 1 1  ON 43
eH1_4                 7.370032e-03 1 1  ON 44
eH1_5                 5.338220e-02 1 1  ON 45
eH1_6                 9.031076e-02 1 1  ON 46
eH1_7                 6.302893e-02 1 1  ON 47
eH1_8                 2.132603e-02 1 1  ON 48
eH1_9                 5.719949e-02 1 1  ON 49
eH2_0                -2.096011e-01 1 1  ON 50
eH2_1                -1.169548e-01 1 1  ON 51
eH2_2                -7.965010e-02 1 1  ON 52
eH2_3                -5.939423e-02 1 1  ON 53
eH2_4                 1.198013e-02 1 1  ON 54
eH2_5                 5.802978e-02 1 1  ON 55
eH2_6                 9.470611e-02 1 1  ON 56
eH2_7                 6.702944e-02 1 1  ON 57
eH2_8                 2.545748e-02 1 1  ON 58
eH2_9                 5.893717e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.666
    reference variance = 0.320224
====================================================
  Execution time = 4.4504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1261e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5524e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512531243696
                                         uncertainty =       0.003448526047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512531243696
                                         uncertainty =       0.003448526047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506264406
  error estimate for blocks of size 2^( 2) =       0.000523912622
  error estimate for blocks of size 2^( 3) =       0.000539380303
  error estimate for blocks of size 2^( 4) =       0.000551128548
  error estimate for blocks of size 2^( 5) =       0.000557181975
  error estimate for blocks of size 2^( 6) =       0.000561712907
  error estimate for blocks of size 2^( 7) =       0.000566072697

      target function =                  N/A
              le_mean =     -22.669611588717
             les_mean =     514.423896624273
             stat err =       0.000559024032
             autocorr =       1.219287628889
              std dev =       0.715965988908
             le_variance =       0.512607297274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266961158872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669611588717       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669611567891       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669611558836       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669611549249       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669611602193       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669611591076       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669611601089       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669611595450       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669611599994       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.005528e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669611588717       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669611583427       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669611581122       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669611578604       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669611592102       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669611589403       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669611592010       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669611590519       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669611591627       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 2.528249e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669611588717       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669611587389       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669611586810       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669611586173       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669611589564       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669611588895       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669611589553       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669611589176       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669611589451       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 6.329717e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0041e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 3.016512e-01 1 1  ON 0
 uu_1                 1.258291e-01 1 1  ON 1
 uu_2                 1.199001e-02 1 1  ON 2
 uu_3                -5.596626e-02 1 1  ON 3
 uu_4                -9.721534e-02 1 1  ON 4
 uu_5                -1.239842e-01 1 1  ON 5
 uu_6                -1.404069e-01 1 1  ON 6
 uu_7                -1.459900e-01 1 1  ON 7
 uu_8                -1.385543e-01 1 1  ON 8
 uu_9                -1.140573e-01 1 1  ON 9
 ud_0                 4.213366e-01 1 1  ON 10
 ud_1                 1.386782e-01 1 1  ON 11
 ud_2                -8.166369e-03 1 1  ON 12
 ud_3                -8.684987e-02 1 1  ON 13
 ud_4                -1.305773e-01 1 1  ON 14
 ud_5                -1.566666e-01 1 1  ON 15
 ud_6                -1.708414e-01 1 1  ON 16
 ud_7                -1.741409e-01 1 1  ON 17
 ud_8                -1.632935e-01 1 1  ON 18
 ud_9                -1.353698e-01 1 1  ON 19
 eC_0                -5.954013e-01 1 1  ON 20
 eC_1                -4.426393e-01 1 1  ON 21
 eC_2                -1.891430e-01 1 1  ON 22
 eC_3                -3.199222e-02 1 1  ON 23
 eC_4                 5.248964e-02 1 1  ON 24
 eC_5                 1.596495e-01 1 1  ON 25
 eC_6                 2.590541e-01 1 1  ON 26
 eC_7                 3.714793e-01 1 1  ON 27
 eC_8                 3.100856e-01 1 1  ON 28
 eC_9                 9.773500e-02 1 1  ON 29
 eO_0                -1.201521e+00 1 1  ON 30
 eO_1                -8.235513e-01 1 1  ON 31
 eO_2                -3.569653e-01 1 1  ON 32
 eO_3                -1.169437e-02 1 1  ON 33
 eO_4                 2.179013e-01 1 1  ON 34
 eO_5                 3.884565e-01 1 1  ON 35
 eO_6                 4.390663e-01 1 1  ON 36
 eO_7                 4.455394e-01 1 1  ON 37
 eO_8                 4.055906e-01 1 1  ON 38
 eO_9                 3.337865e-01 1 1  ON 39
eH1_0                -2.149001e-01 1 1  ON 40
eH1_1                -1.221725e-01 1 1  ON 41
eH1_2                -8.452835e-02 1 1  ON 42
eH1_3                -6.416651e-02 1 1  ON 43
eH1_4                 7.370907e-03 1 1  ON 44
eH1_5                 5.338132e-02 1 1  ON 45
eH1_6                 9.031033e-02 1 1  ON 46
eH1_7                 6.302809e-02 1 1  ON 47
eH1_8                 2.132614e-02 1 1  ON 48
eH1_9                 5.719919e-02 1 1  ON 49
eH2_0                -2.096009e-01 1 1  ON 50
eH2_1                -1.169549e-01 1 1  ON 51
eH2_2                -7.964898e-02 1 1  ON 52
eH2_3                -5.939437e-02 1 1  ON 53
eH2_4                 1.198145e-02 1 1  ON 54
eH2_5                 5.802987e-02 1 1  ON 55
eH2_6                 9.470359e-02 1 1  ON 56
eH2_7                 6.702901e-02 1 1  ON 57
eH2_8                 2.545775e-02 1 1  ON 58
eH2_9                 5.893677e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6583
    reference variance = 0.405222
====================================================
  Execution time = 4.4034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.4374e-01
  Total weights = 2.0000e+06
  Execution time = 4.1117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543872091934
                                         uncertainty =       0.031345565556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543872091934
                                         uncertainty =       0.031345565556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521412890
  error estimate for blocks of size 2^( 2) =       0.000538436063
  error estimate for blocks of size 2^( 3) =       0.000554224027
  error estimate for blocks of size 2^( 4) =       0.000565363867
  error estimate for blocks of size 2^( 5) =       0.000571829919
  error estimate for blocks of size 2^( 6) =       0.000574608465
  error estimate for blocks of size 2^( 7) =       0.000574944724

      target function =                  N/A
              le_mean =     -22.670562653684
             les_mean =     514.498153567280
             stat err =       0.000571686744
             autocorr =       1.202133546833
              std dev =       0.737389181188
             le_variance =       0.543742804533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543871058714
                                         uncertainty =       0.031344862912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543871058714
                                         uncertainty =       0.031344862912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521412393
  error estimate for blocks of size 2^( 2) =       0.000538435494
  error estimate for blocks of size 2^( 3) =       0.000554223470
  error estimate for blocks of size 2^( 4) =       0.000565363174
  error estimate for blocks of size 2^( 5) =       0.000571829251
  error estimate for blocks of size 2^( 6) =       0.000574607151
  error estimate for blocks of size 2^( 7) =       0.000574942784

      target function =                  N/A
              le_mean =     -22.670562746650
             les_mean =     514.498156745851
             stat err =       0.000571685590
             autocorr =       1.202130986799
              std dev =       0.737388478294
             le_variance =       0.543741767921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543871591683
                                         uncertainty =       0.031345214079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543871591683
                                         uncertainty =       0.031345214079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521412650
  error estimate for blocks of size 2^( 2) =       0.000538435785
  error estimate for blocks of size 2^( 3) =       0.000554223754
  error estimate for blocks of size 2^( 4) =       0.000565363522
  error estimate for blocks of size 2^( 5) =       0.000571829586
  error estimate for blocks of size 2^( 6) =       0.000574607801
  error estimate for blocks of size 2^( 7) =       0.000574943739

      target function =                  N/A
              le_mean =     -22.670562701838
             les_mean =     514.498155248571
             stat err =       0.000571686162
             autocorr =       1.202132209797
              std dev =       0.737388840762
             le_variance =       0.543742302481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543872029760
                                         uncertainty =       0.031345521622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543872029760
                                         uncertainty =       0.031345521622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521412860
  error estimate for blocks of size 2^( 2) =       0.000538436029
  error estimate for blocks of size 2^( 3) =       0.000554223993
  error estimate for blocks of size 2^( 4) =       0.000565363824
  error estimate for blocks of size 2^( 5) =       0.000571829877
  error estimate for blocks of size 2^( 6) =       0.000574608382
  error estimate for blocks of size 2^( 7) =       0.000574944600

      target function =                  N/A
              le_mean =     -22.670562659733
             les_mean =     514.498153779135
             stat err =       0.000571686671
             autocorr =       1.202133377826
              std dev =       0.737389138875
             le_variance =       0.543742742130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670562653684        initial
     1.5625e+01     1.5625e+02             1.0055e-05       -22.670562746650  <--
     6.2500e+01     6.2500e+02             2.5282e-06       -22.670562701838
     2.5000e+02     2.5000e+03             6.3297e-07       -22.670562659733

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 6.3054e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 3.016520e-01 1 1  ON 0
 uu_1                 1.258311e-01 1 1  ON 1
 uu_2                 1.198359e-02 1 1  ON 2
 uu_3                -5.596454e-02 1 1  ON 3
 uu_4                -9.721544e-02 1 1  ON 4
 uu_5                -1.239818e-01 1 1  ON 5
 uu_6                -1.404006e-01 1 1  ON 6
 uu_7                -1.459889e-01 1 1  ON 7
 uu_8                -1.385561e-01 1 1  ON 8
 uu_9                -1.140597e-01 1 1  ON 9
 ud_0                 4.213345e-01 1 1  ON 10
 ud_1                 1.386784e-01 1 1  ON 11
 ud_2                -8.164890e-03 1 1  ON 12
 ud_3                -8.684801e-02 1 1  ON 13
 ud_4                -1.305723e-01 1 1  ON 14
 ud_5                -1.566720e-01 1 1  ON 15
 ud_6                -1.708455e-01 1 1  ON 16
 ud_7                -1.741383e-01 1 1  ON 17
 ud_8                -1.632875e-01 1 1  ON 18
 ud_9                -1.353696e-01 1 1  ON 19
 eC_0                -5.954018e-01 1 1  ON 20
 eC_1                -4.426340e-01 1 1  ON 21
 eC_2                -1.891451e-01 1 1  ON 22
 eC_3                -3.199788e-02 1 1  ON 23
 eC_4                 5.249173e-02 1 1  ON 24
 eC_5                 1.596472e-01 1 1  ON 25
 eC_6                 2.590537e-01 1 1  ON 26
 eC_7                 3.714779e-01 1 1  ON 27
 eC_8                 3.100886e-01 1 1  ON 28
 eC_9                 9.773673e-02 1 1  ON 29
 eO_0                -1.201526e+00 1 1  ON 30
 eO_1                -8.235472e-01 1 1  ON 31
 eO_2                -3.569670e-01 1 1  ON 32
 eO_3                -1.169840e-02 1 1  ON 33
 eO_4                 2.178963e-01 1 1  ON 34
 eO_5                 3.884565e-01 1 1  ON 35
 eO_6                 4.390696e-01 1 1  ON 36
 eO_7                 4.455425e-01 1 1  ON 37
 eO_8                 4.055908e-01 1 1  ON 38
 eO_9                 3.337891e-01 1 1  ON 39
eH1_0                -2.148989e-01 1 1  ON 40
eH1_1                -1.221686e-01 1 1  ON 41
eH1_2                -8.453225e-02 1 1  ON 42
eH1_3                -6.416528e-02 1 1  ON 43
eH1_4                 7.373522e-03 1 1  ON 44
eH1_5                 5.337870e-02 1 1  ON 45
eH1_6                 9.030903e-02 1 1  ON 46
eH1_7                 6.302557e-02 1 1  ON 47
eH1_8                 2.132647e-02 1 1  ON 48
eH1_9                 5.719828e-02 1 1  ON 49
eH2_0                -2.096004e-01 1 1  ON 50
eH2_1                -1.169551e-01 1 1  ON 51
eH2_2                -7.964564e-02 1 1  ON 52
eH2_3                -5.939477e-02 1 1  ON 53
eH2_4                 1.198539e-02 1 1  ON 54
eH2_5                 5.803014e-02 1 1  ON 55
eH2_6                 9.469606e-02 1 1  ON 56
eH2_7                 6.702771e-02 1 1  ON 57
eH2_8                 2.545855e-02 1 1  ON 58
eH2_9                 5.893561e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2311e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6024
    reference variance = 0.447397
====================================================
  Execution time = 4.4322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5494e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515201731442
                                         uncertainty =       0.004136699163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515201731442
                                         uncertainty =       0.004136699163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507553652
  error estimate for blocks of size 2^( 2) =       0.000524822507
  error estimate for blocks of size 2^( 3) =       0.000540430417
  error estimate for blocks of size 2^( 4) =       0.000551476553
  error estimate for blocks of size 2^( 5) =       0.000559066072
  error estimate for blocks of size 2^( 6) =       0.000563808981
  error estimate for blocks of size 2^( 7) =       0.000564311644

      target function =                  N/A
              le_mean =     -22.669669847884
             les_mean =     514.429152173877
             stat err =       0.000559665813
             autocorr =       1.215888198250
              std dev =       0.717789258379
             le_variance =       0.515221419444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266966984788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669847884       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669669651124       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669669500110       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669669440333       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669669592450       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669669616046       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669669651117       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669669626817       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669669598778       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669669622101       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 4.210784e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669847884       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669669795932       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669669755375       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669669736203       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669669773115       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669669779088       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669669789139       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669669784941       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669669776879       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669669781423       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.089637e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669669847884       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669669834711       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669669824378       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669669819280       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669669828409       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669669829888       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669669832477       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669669831576       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669669829519       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669669830559       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 2.748880e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9829e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 3.016556e-01 1 1  ON 0
 uu_1                 1.258375e-01 1 1  ON 1
 uu_2                 1.197874e-02 1 1  ON 2
 uu_3                -5.596195e-02 1 1  ON 3
 uu_4                -9.721455e-02 1 1  ON 4
 uu_5                -1.239829e-01 1 1  ON 5
 uu_6                -1.403964e-01 1 1  ON 6
 uu_7                -1.459998e-01 1 1  ON 7
 uu_8                -1.385561e-01 1 1  ON 8
 uu_9                -1.140557e-01 1 1  ON 9
 ud_0                 4.213259e-01 1 1  ON 10
 ud_1                 1.386829e-01 1 1  ON 11
 ud_2                -8.162995e-03 1 1  ON 12
 ud_3                -8.685096e-02 1 1  ON 13
 ud_4                -1.305700e-01 1 1  ON 14
 ud_5                -1.566733e-01 1 1  ON 15
 ud_6                -1.708431e-01 1 1  ON 16
 ud_7                -1.741350e-01 1 1  ON 17
 ud_8                -1.632844e-01 1 1  ON 18
 ud_9                -1.353645e-01 1 1  ON 19
 eC_0                -5.954090e-01 1 1  ON 20
 eC_1                -4.426371e-01 1 1  ON 21
 eC_2                -1.891347e-01 1 1  ON 22
 eC_3                -3.199903e-02 1 1  ON 23
 eC_4                 5.248525e-02 1 1  ON 24
 eC_5                 1.596496e-01 1 1  ON 25
 eC_6                 2.590505e-01 1 1  ON 26
 eC_7                 3.714776e-01 1 1  ON 27
 eC_8                 3.100942e-01 1 1  ON 28
 eC_9                 9.773946e-02 1 1  ON 29
 eO_0                -1.201536e+00 1 1  ON 30
 eO_1                -8.235484e-01 1 1  ON 31
 eO_2                -3.569615e-01 1 1  ON 32
 eO_3                -1.170246e-02 1 1  ON 33
 eO_4                 2.178937e-01 1 1  ON 34
 eO_5                 3.884582e-01 1 1  ON 35
 eO_6                 4.390729e-01 1 1  ON 36
 eO_7                 4.455408e-01 1 1  ON 37
 eO_8                 4.055894e-01 1 1  ON 38
 eO_9                 3.337943e-01 1 1  ON 39
eH1_0                -2.148941e-01 1 1  ON 40
eH1_1                -1.221778e-01 1 1  ON 41
eH1_2                -8.453503e-02 1 1  ON 42
eH1_3                -6.415978e-02 1 1  ON 43
eH1_4                 7.366877e-03 1 1  ON 44
eH1_5                 5.338899e-02 1 1  ON 45
eH1_6                 9.030523e-02 1 1  ON 46
eH1_7                 6.302811e-02 1 1  ON 47
eH1_8                 2.132484e-02 1 1  ON 48
eH1_9                 5.719577e-02 1 1  ON 49
eH2_0                -2.096004e-01 1 1  ON 50
eH2_1                -1.169558e-01 1 1  ON 51
eH2_2                -7.963839e-02 1 1  ON 52
eH2_3                -5.940083e-02 1 1  ON 53
eH2_4                 1.198061e-02 1 1  ON 54
eH2_5                 5.803106e-02 1 1  ON 55
eH2_6                 9.469136e-02 1 1  ON 56
eH2_7                 6.703318e-02 1 1  ON 57
eH2_8                 2.545851e-02 1 1  ON 58
eH2_9                 5.893505e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7777
    reference variance = 0.433732
====================================================
  Execution time = 4.4596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1805e-01
  Total weights = 2.0000e+06
  Execution time = 3.6561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518111084412
                                         uncertainty =       0.005045301296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518111084412
                                         uncertainty =       0.005045301296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508946208
  error estimate for blocks of size 2^( 2) =       0.000526896444
  error estimate for blocks of size 2^( 3) =       0.000542292048
  error estimate for blocks of size 2^( 4) =       0.000553152910
  error estimate for blocks of size 2^( 5) =       0.000558795422
  error estimate for blocks of size 2^( 6) =       0.000562122785
  error estimate for blocks of size 2^( 7) =       0.000564902024

      target function =                  N/A
              le_mean =     -22.669543083615
             les_mean =     514.426235845563
             stat err =       0.000559743285
             autocorr =       1.209578390123
              std dev =       0.719758629486
             le_variance =       0.518052484720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518094111589
                                         uncertainty =       0.005045134877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518094111589
                                         uncertainty =       0.005045134877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508937887
  error estimate for blocks of size 2^( 2) =       0.000526888882
  error estimate for blocks of size 2^( 3) =       0.000542284653
  error estimate for blocks of size 2^( 4) =       0.000553145398
  error estimate for blocks of size 2^( 5) =       0.000558787481
  error estimate for blocks of size 2^( 6) =       0.000562115425
  error estimate for blocks of size 2^( 7) =       0.000564894849

      target function =                  N/A
              le_mean =     -22.669543538885
             les_mean =     514.426239548616
             stat err =       0.000559735788
             autocorr =       1.209585537765
              std dev =       0.719746862605
             le_variance =       0.518035546230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518100822664
                                         uncertainty =       0.005045196362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518100822664
                                         uncertainty =       0.005045196362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508941176
  error estimate for blocks of size 2^( 2) =       0.000526891846
  error estimate for blocks of size 2^( 3) =       0.000542287567
  error estimate for blocks of size 2^( 4) =       0.000553148397
  error estimate for blocks of size 2^( 5) =       0.000558790687
  error estimate for blocks of size 2^( 6) =       0.000562118367
  error estimate for blocks of size 2^( 7) =       0.000564897729

      target function =                  N/A
              le_mean =     -22.669543337355
             les_mean =     514.426237106692
             stat err =       0.000559738795
             autocorr =       1.209582900201
              std dev =       0.719751513718
             le_variance =       0.518042241499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518109736613
                                         uncertainty =       0.005045287422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518109736613
                                         uncertainty =       0.005045287422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508945547
  error estimate for blocks of size 2^( 2) =       0.000526895839
  error estimate for blocks of size 2^( 3) =       0.000542291459
  error estimate for blocks of size 2^( 4) =       0.000553152318
  error estimate for blocks of size 2^( 5) =       0.000558794802
  error estimate for blocks of size 2^( 6) =       0.000562122205
  error estimate for blocks of size 2^( 7) =       0.000564901460

      target function =                  N/A
              le_mean =     -22.669543115917
             les_mean =     514.426235964680
             stat err =       0.000559742696
             autocorr =       1.209578986715
              std dev =       0.719757694842
             le_variance =       0.518051139284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669543083615        initial
     3.9062e+00     3.9062e+01             4.2108e-05       -22.669543538885  <--
     1.5625e+01     1.5625e+02             1.0896e-05       -22.669543337355
     6.2500e+01     6.2500e+02             2.7489e-06       -22.669543115917

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 6.2972e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 3.016666e-01 1 1  ON 0
 uu_1                 1.258546e-01 1 1  ON 1
 uu_2                 1.196673e-02 1 1  ON 2
 uu_3                -5.595529e-02 1 1  ON 3
 uu_4                -9.721159e-02 1 1  ON 4
 uu_5                -1.239857e-01 1 1  ON 5
 uu_6                -1.403853e-01 1 1  ON 6
 uu_7                -1.460310e-01 1 1  ON 7
 uu_8                -1.385565e-01 1 1  ON 8
 uu_9                -1.140440e-01 1 1  ON 9
 ud_0                 4.213038e-01 1 1  ON 10
 ud_1                 1.386948e-01 1 1  ON 11
 ud_2                -8.158441e-03 1 1  ON 12
 ud_3                -8.685884e-02 1 1  ON 13
 ud_4                -1.305645e-01 1 1  ON 14
 ud_5                -1.566765e-01 1 1  ON 15
 ud_6                -1.708368e-01 1 1  ON 16
 ud_7                -1.741252e-01 1 1  ON 17
 ud_8                -1.632752e-01 1 1  ON 18
 ud_9                -1.353492e-01 1 1  ON 19
 eC_0                -5.954303e-01 1 1  ON 20
 eC_1                -4.426455e-01 1 1  ON 21
 eC_2                -1.891051e-01 1 1  ON 22
 eC_3                -3.200216e-02 1 1  ON 23
 eC_4                 5.246639e-02 1 1  ON 24
 eC_5                 1.596568e-01 1 1  ON 25
 eC_6                 2.590409e-01 1 1  ON 26
 eC_7                 3.714767e-01 1 1  ON 27
 eC_8                 3.101105e-01 1 1  ON 28
 eC_9                 9.774754e-02 1 1  ON 29
 eO_0                -1.201564e+00 1 1  ON 30
 eO_1                -8.235523e-01 1 1  ON 31
 eO_2                -3.569467e-01 1 1  ON 32
 eO_3                -1.171386e-02 1 1  ON 33
 eO_4                 2.178857e-01 1 1  ON 34
 eO_5                 3.884633e-01 1 1  ON 35
 eO_6                 4.390829e-01 1 1  ON 36
 eO_7                 4.455356e-01 1 1  ON 37
 eO_8                 4.055853e-01 1 1  ON 38
 eO_9                 3.338099e-01 1 1  ON 39
eH1_0                -2.148801e-01 1 1  ON 40
eH1_1                -1.222042e-01 1 1  ON 41
eH1_2                -8.454274e-02 1 1  ON 42
eH1_3                -6.414481e-02 1 1  ON 43
eH1_4                 7.348458e-03 1 1  ON 44
eH1_5                 5.341825e-02 1 1  ON 45
eH1_6                 9.029468e-02 1 1  ON 46
eH1_7                 6.303544e-02 1 1  ON 47
eH1_8                 2.131992e-02 1 1  ON 48
eH1_9                 5.718833e-02 1 1  ON 49
eH2_0                -2.096002e-01 1 1  ON 50
eH2_1                -1.169574e-01 1 1  ON 51
eH2_2                -7.961786e-02 1 1  ON 52
eH2_3                -5.941819e-02 1 1  ON 53
eH2_4                 1.196642e-02 1 1  ON 54
eH2_5                 5.803383e-02 1 1  ON 55
eH2_6                 9.467763e-02 1 1  ON 56
eH2_7                 6.704921e-02 1 1  ON 57
eH2_8                 2.545840e-02 1 1  ON 58
eH2_9                 5.893340e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6686
    reference variance = 0.445976
====================================================
  Execution time = 4.4202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1405e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5471e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513783392602
                                         uncertainty =       0.005128186071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513783392602
                                         uncertainty =       0.005128186071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506977467
  error estimate for blocks of size 2^( 2) =       0.000524280481
  error estimate for blocks of size 2^( 3) =       0.000540453181
  error estimate for blocks of size 2^( 4) =       0.000551527261
  error estimate for blocks of size 2^( 5) =       0.000557873094
  error estimate for blocks of size 2^( 6) =       0.000561302297
  error estimate for blocks of size 2^( 7) =       0.000562364167

      target function =                  N/A
              le_mean =     -22.669619308520
             les_mean =     514.425691639858
             stat err =       0.000558266705
             autocorr =       1.212568103925
              std dev =       0.716974409334
             le_variance =       0.514052303640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266961930852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619308520       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669620072698       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669620878514       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669620945470       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669620362241       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669620229763       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669620525100       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669620747888       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669620795313       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669620730484       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669620764039       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.497698e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619308520       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669619533596       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669619782584       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669619831055       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669619651222       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669619592524       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669619643490       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669619684515       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669619678091       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669619663029       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 4.725064e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669619308520       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669619367412       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669619433679       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669619448727       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669619401628       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669619384945       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669619395162       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669619403837       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669619400141       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.298843e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9687e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 3.016747e-01 1 1  ON 0
 uu_1                 1.258538e-01 1 1  ON 1
 uu_2                 1.195771e-02 1 1  ON 2
 uu_3                -5.594397e-02 1 1  ON 3
 uu_4                -9.723582e-02 1 1  ON 4
 uu_5                -1.239857e-01 1 1  ON 5
 uu_6                -1.404325e-01 1 1  ON 6
 uu_7                -1.460014e-01 1 1  ON 7
 uu_8                -1.385363e-01 1 1  ON 8
 uu_9                -1.140241e-01 1 1  ON 9
 ud_0                 4.213139e-01 1 1  ON 10
 ud_1                 1.386726e-01 1 1  ON 11
 ud_2                -8.158267e-03 1 1  ON 12
 ud_3                -8.685948e-02 1 1  ON 13
 ud_4                -1.305635e-01 1 1  ON 14
 ud_5                -1.566780e-01 1 1  ON 15
 ud_6                -1.708375e-01 1 1  ON 16
 ud_7                -1.740973e-01 1 1  ON 17
 ud_8                -1.632728e-01 1 1  ON 18
 ud_9                -1.353410e-01 1 1  ON 19
 eC_0                -5.954214e-01 1 1  ON 20
 eC_1                -4.426491e-01 1 1  ON 21
 eC_2                -1.891244e-01 1 1  ON 22
 eC_3                -3.200219e-02 1 1  ON 23
 eC_4                 5.245442e-02 1 1  ON 24
 eC_5                 1.596563e-01 1 1  ON 25
 eC_6                 2.590238e-01 1 1  ON 26
 eC_7                 3.714831e-01 1 1  ON 27
 eC_8                 3.101331e-01 1 1  ON 28
 eC_9                 9.776004e-02 1 1  ON 29
 eO_0                -1.201537e+00 1 1  ON 30
 eO_1                -8.235716e-01 1 1  ON 31
 eO_2                -3.569815e-01 1 1  ON 32
 eO_3                -1.173339e-02 1 1  ON 33
 eO_4                 2.179146e-01 1 1  ON 34
 eO_5                 3.884703e-01 1 1  ON 35
 eO_6                 4.390558e-01 1 1  ON 36
 eO_7                 4.455381e-01 1 1  ON 37
 eO_8                 4.055795e-01 1 1  ON 38
 eO_9                 3.338295e-01 1 1  ON 39
eH1_0                -2.148767e-01 1 1  ON 40
eH1_1                -1.222144e-01 1 1  ON 41
eH1_2                -8.453592e-02 1 1  ON 42
eH1_3                -6.414763e-02 1 1  ON 43
eH1_4                 7.343474e-03 1 1  ON 44
eH1_5                 5.341822e-02 1 1  ON 45
eH1_6                 9.027527e-02 1 1  ON 46
eH1_7                 6.304129e-02 1 1  ON 47
eH1_8                 2.132526e-02 1 1  ON 48
eH1_9                 5.718755e-02 1 1  ON 49
eH2_0                -2.096171e-01 1 1  ON 50
eH2_1                -1.169298e-01 1 1  ON 51
eH2_2                -7.964473e-02 1 1  ON 52
eH2_3                -5.941850e-02 1 1  ON 53
eH2_4                 1.197688e-02 1 1  ON 54
eH2_5                 5.800660e-02 1 1  ON 55
eH2_6                 9.468926e-02 1 1  ON 56
eH2_7                 6.704602e-02 1 1  ON 57
eH2_8                 2.547313e-02 1 1  ON 58
eH2_9                 5.893143e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7031
    reference variance = 0.441027
====================================================
  Execution time = 4.3472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1735e-01
  Total weights = 2.0000e+06
  Execution time = 3.6678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517220212937
                                         uncertainty =       0.006101779339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517220212937
                                         uncertainty =       0.006101779339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508594874
  error estimate for blocks of size 2^( 2) =       0.000525504129
  error estimate for blocks of size 2^( 3) =       0.000540919506
  error estimate for blocks of size 2^( 4) =       0.000551595208
  error estimate for blocks of size 2^( 5) =       0.000558479018
  error estimate for blocks of size 2^( 6) =       0.000561494629
  error estimate for blocks of size 2^( 7) =       0.000564101954

      target function =                  N/A
              le_mean =     -22.669035608463
             les_mean =     514.402512651360
             stat err =       0.000558917702
             autocorr =       1.207679716770
              std dev =       0.719261768942
             le_variance =       0.517337492262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517223425250
                                         uncertainty =       0.006102730770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517223425250
                                         uncertainty =       0.006102730770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508596437
  error estimate for blocks of size 2^( 2) =       0.000525506408
  error estimate for blocks of size 2^( 3) =       0.000540924144
  error estimate for blocks of size 2^( 4) =       0.000551602035
  error estimate for blocks of size 2^( 5) =       0.000558487760
  error estimate for blocks of size 2^( 6) =       0.000561505317
  error estimate for blocks of size 2^( 7) =       0.000564107829

      target function =                  N/A
              le_mean =     -22.669036396623
             les_mean =     514.402551564423
             stat err =       0.000558925735
             autocorr =       1.207707007723
              std dev =       0.719263979133
             le_variance =       0.517340671679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517236332530
                                         uncertainty =       0.006102364480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517236332530
                                         uncertainty =       0.006102364480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508602794
  error estimate for blocks of size 2^( 2) =       0.000525512130
  error estimate for blocks of size 2^( 3) =       0.000540928719
  error estimate for blocks of size 2^( 4) =       0.000551605695
  error estimate for blocks of size 2^( 5) =       0.000558490666
  error estimate for blocks of size 2^( 6) =       0.000561507516
  error estimate for blocks of size 2^( 7) =       0.000564111663

      target function =                  N/A
              le_mean =     -22.669036069176
             les_mean =     514.402549650503
             stat err =       0.000558928885
             autocorr =       1.207690431783
              std dev =       0.719272968752
             le_variance =       0.517353603577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517223315983
                                         uncertainty =       0.006101872569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517223315983
                                         uncertainty =       0.006101872569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508596399
  error estimate for blocks of size 2^( 2) =       0.000525505638
  error estimate for blocks of size 2^( 3) =       0.000540921161
  error estimate for blocks of size 2^( 4) =       0.000551597020
  error estimate for blocks of size 2^( 5) =       0.000558480985
  error estimate for blocks of size 2^( 6) =       0.000561496757
  error estimate for blocks of size 2^( 7) =       0.000564103669

      target function =                  N/A
              le_mean =     -22.669035662311
             les_mean =     514.402518195383
             stat err =       0.000558919608
             autocorr =       1.207680708290
              std dev =       0.719263925791
             le_variance =       0.517340594944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669035608463        initial
     9.7656e-01     9.7656e+00             1.4977e-04       -22.669036396623  <--
     3.9062e+00     3.9062e+01             4.7251e-05       -22.669036069176
     1.5625e+01     1.5625e+02             1.2988e-05       -22.669035662311

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 6.1883e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 3.016876e-01 1 1  ON 0
 uu_1                 1.258462e-01 1 1  ON 1
 uu_2                 1.194509e-02 1 1  ON 2
 uu_3                -5.593117e-02 1 1  ON 3
 uu_4                -9.728452e-02 1 1  ON 4
 uu_5                -1.240016e-01 1 1  ON 5
 uu_6                -1.405350e-01 1 1  ON 6
 uu_7                -1.459404e-01 1 1  ON 7
 uu_8                -1.384765e-01 1 1  ON 8
 uu_9                -1.139600e-01 1 1  ON 9
 ud_0                 4.213178e-01 1 1  ON 10
 ud_1                 1.386272e-01 1 1  ON 11
 ud_2                -8.161067e-03 1 1  ON 12
 ud_3                -8.685506e-02 1 1  ON 13
 ud_4                -1.305622e-01 1 1  ON 14
 ud_5                -1.566783e-01 1 1  ON 15
 ud_6                -1.708352e-01 1 1  ON 16
 ud_7                -1.740245e-01 1 1  ON 17
 ud_8                -1.632619e-01 1 1  ON 18
 ud_9                -1.353133e-01 1 1  ON 19
 eC_0                -5.953971e-01 1 1  ON 20
 eC_1                -4.426634e-01 1 1  ON 21
 eC_2                -1.891755e-01 1 1  ON 22
 eC_3                -3.200615e-02 1 1  ON 23
 eC_4                 5.242363e-02 1 1  ON 24
 eC_5                 1.596483e-01 1 1  ON 25
 eC_6                 2.589723e-01 1 1  ON 26
 eC_7                 3.715036e-01 1 1  ON 27
 eC_8                 3.102028e-01 1 1  ON 28
 eC_9                 9.779835e-02 1 1  ON 29
 eO_0                -1.201481e+00 1 1  ON 30
 eO_1                -8.236205e-01 1 1  ON 31
 eO_2                -3.570743e-01 1 1  ON 32
 eO_3                -1.177841e-02 1 1  ON 33
 eO_4                 2.179881e-01 1 1  ON 34
 eO_5                 3.884926e-01 1 1  ON 35
 eO_6                 4.389741e-01 1 1  ON 36
 eO_7                 4.455442e-01 1 1  ON 37
 eO_8                 4.055626e-01 1 1  ON 38
 eO_9                 3.338900e-01 1 1  ON 39
eH1_0                -2.148684e-01 1 1  ON 40
eH1_1                -1.222393e-01 1 1  ON 41
eH1_2                -8.451874e-02 1 1  ON 42
eH1_3                -6.415760e-02 1 1  ON 43
eH1_4                 7.328374e-03 1 1  ON 44
eH1_5                 5.341428e-02 1 1  ON 45
eH1_6                 9.022254e-02 1 1  ON 46
eH1_7                 6.305624e-02 1 1  ON 47
eH1_8                 2.134214e-02 1 1  ON 48
eH1_9                 5.718562e-02 1 1  ON 49
eH2_0                -2.096669e-01 1 1  ON 50
eH2_1                -1.168606e-01 1 1  ON 51
eH2_2                -7.971208e-02 1 1  ON 52
eH2_3                -5.941953e-02 1 1  ON 53
eH2_4                 1.199891e-02 1 1  ON 54
eH2_5                 5.794233e-02 1 1  ON 55
eH2_6                 9.471351e-02 1 1  ON 56
eH2_7                 6.703538e-02 1 1  ON 57
eH2_8                 2.551932e-02 1 1  ON 58
eH2_9                 5.892587e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2158e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6657
    reference variance = 0.265265
====================================================
  Execution time = 4.6482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1015e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5377e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510169111738
                                         uncertainty =       0.003903123424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510169111738
                                         uncertainty =       0.003903123424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505050056
  error estimate for blocks of size 2^( 2) =       0.000522504810
  error estimate for blocks of size 2^( 3) =       0.000538403659
  error estimate for blocks of size 2^( 4) =       0.000549181877
  error estimate for blocks of size 2^( 5) =       0.000556324593
  error estimate for blocks of size 2^( 6) =       0.000561306073
  error estimate for blocks of size 2^( 7) =       0.000565235226

      target function =                  N/A
              le_mean =     -22.669600710806
             les_mean =     514.420947251347
             stat err =       0.000558011942
             autocorr =       1.220725843071
              std dev =       0.714248639520
             le_variance =       0.510151119056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266960071081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669600710806       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669602122772       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669601427136       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669601777380       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669602768189       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669603386727       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669603026284       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669603336769       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669603371830       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669603560436       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669603514696       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669603374317       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669603496215       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 3.813317e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669600710806       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669601185979       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669600685533       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669600704229       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669600944298       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669601216740       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669601155235       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669601217332       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669601199849       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669601189057       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669601208786       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.363024e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669600710806       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669600840852       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669600662714       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669600648404       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669600690091       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669600756452       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669600736875       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669600758331       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669600758094       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669600746024       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 3.889726e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1873e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 3.017124e-01 1 1  ON 0
 uu_1                 1.258370e-01 1 1  ON 1
 uu_2                 1.203135e-02 1 1  ON 2
 uu_3                -5.592138e-02 1 1  ON 3
 uu_4                -9.722032e-02 1 1  ON 4
 uu_5                -1.239987e-01 1 1  ON 5
 uu_6                -1.405103e-01 1 1  ON 6
 uu_7                -1.459069e-01 1 1  ON 7
 uu_8                -1.384998e-01 1 1  ON 8
 uu_9                -1.140294e-01 1 1  ON 9
 ud_0                 4.213289e-01 1 1  ON 10
 ud_1                 1.386841e-01 1 1  ON 11
 ud_2                -8.089581e-03 1 1  ON 12
 ud_3                -8.679447e-02 1 1  ON 13
 ud_4                -1.305205e-01 1 1  ON 14
 ud_5                -1.566927e-01 1 1  ON 15
 ud_6                -1.707733e-01 1 1  ON 16
 ud_7                -1.740010e-01 1 1  ON 17
 ud_8                -1.633294e-01 1 1  ON 18
 ud_9                -1.353813e-01 1 1  ON 19
 eC_0                -5.953316e-01 1 1  ON 20
 eC_1                -4.427870e-01 1 1  ON 21
 eC_2                -1.891285e-01 1 1  ON 22
 eC_3                -3.204926e-02 1 1  ON 23
 eC_4                 5.249374e-02 1 1  ON 24
 eC_5                 1.595859e-01 1 1  ON 25
 eC_6                 2.589185e-01 1 1  ON 26
 eC_7                 3.714861e-01 1 1  ON 27
 eC_8                 3.102719e-01 1 1  ON 28
 eC_9                 9.783987e-02 1 1  ON 29
 eO_0                -1.201555e+00 1 1  ON 30
 eO_1                -8.235669e-01 1 1  ON 31
 eO_2                -3.571718e-01 1 1  ON 32
 eO_3                -1.173782e-02 1 1  ON 33
 eO_4                 2.179229e-01 1 1  ON 34
 eO_5                 3.885350e-01 1 1  ON 35
 eO_6                 4.390438e-01 1 1  ON 36
 eO_7                 4.454801e-01 1 1  ON 37
 eO_8                 4.055332e-01 1 1  ON 38
 eO_9                 3.339475e-01 1 1  ON 39
eH1_0                -2.149216e-01 1 1  ON 40
eH1_1                -1.221975e-01 1 1  ON 41
eH1_2                -8.439459e-02 1 1  ON 42
eH1_3                -6.418539e-02 1 1  ON 43
eH1_4                 7.356467e-03 1 1  ON 44
eH1_5                 5.333303e-02 1 1  ON 45
eH1_6                 9.020418e-02 1 1  ON 46
eH1_7                 6.306845e-02 1 1  ON 47
eH1_8                 2.132351e-02 1 1  ON 48
eH1_9                 5.713501e-02 1 1  ON 49
eH2_0                -2.096517e-01 1 1  ON 50
eH2_1                -1.168523e-01 1 1  ON 51
eH2_2                -7.967347e-02 1 1  ON 52
eH2_3                -5.955584e-02 1 1  ON 53
eH2_4                 1.196278e-02 1 1  ON 54
eH2_5                 5.798041e-02 1 1  ON 55
eH2_6                 9.468895e-02 1 1  ON 56
eH2_7                 6.701472e-02 1 1  ON 57
eH2_8                 2.556838e-02 1 1  ON 58
eH2_9                 5.893134e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5817
    reference variance = 2.54373
====================================================
  Execution time = 4.3814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0927e-01
  Total weights = 2.0000e+06
  Execution time = 3.6685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509281700446
                                         uncertainty =       0.003207948518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509281700446
                                         uncertainty =       0.003207948518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504662304
  error estimate for blocks of size 2^( 2) =       0.000522455673
  error estimate for blocks of size 2^( 3) =       0.000538123032
  error estimate for blocks of size 2^( 4) =       0.000548601676
  error estimate for blocks of size 2^( 5) =       0.000555098096
  error estimate for blocks of size 2^( 6) =       0.000558599455
  error estimate for blocks of size 2^( 7) =       0.000559768338

      target function =                  N/A
              le_mean =     -22.670391687789
             les_mean =     514.456027104259
             stat err =       0.000555516891
             autocorr =       1.211693578432
              std dev =       0.713700274052
             le_variance =       0.509368081182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509114841690
                                         uncertainty =       0.003207706949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509114841690
                                         uncertainty =       0.003207706949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504579711
  error estimate for blocks of size 2^( 2) =       0.000522377029
  error estimate for blocks of size 2^( 3) =       0.000538049056
  error estimate for blocks of size 2^( 4) =       0.000548531500
  error estimate for blocks of size 2^( 5) =       0.000555034760
  error estimate for blocks of size 2^( 6) =       0.000558537319
  error estimate for blocks of size 2^( 7) =       0.000559699180

      target function =                  N/A
              le_mean =     -22.670390731288
             les_mean =     514.455817023784
             stat err =       0.000555450690
             autocorr =       1.211801411075
              std dev =       0.713583470335
             le_variance =       0.509201369135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509095102136
                                         uncertainty =       0.003207203773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509095102136
                                         uncertainty =       0.003207203773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504569937
  error estimate for blocks of size 2^( 2) =       0.000522368203
  error estimate for blocks of size 2^( 3) =       0.000538041136
  error estimate for blocks of size 2^( 4) =       0.000548524869
  error estimate for blocks of size 2^( 5) =       0.000555027500
  error estimate for blocks of size 2^( 6) =       0.000558529058
  error estimate for blocks of size 2^( 7) =       0.000559692153

      target function =                  N/A
              le_mean =     -22.670390439803
             les_mean =     514.455784080491
             stat err =       0.000555443395
             autocorr =       1.211816528269
              std dev =       0.713569647605
             le_variance =       0.509181641984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509247931308
                                         uncertainty =       0.003207792624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509247931308
                                         uncertainty =       0.003207792624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504645588
  error estimate for blocks of size 2^( 2) =       0.000522439878
  error estimate for blocks of size 2^( 3) =       0.000538108218
  error estimate for blocks of size 2^( 4) =       0.000548587745
  error estimate for blocks of size 2^( 5) =       0.000555085153
  error estimate for blocks of size 2^( 6) =       0.000558586538
  error estimate for blocks of size 2^( 7) =       0.000559754562

      target function =                  N/A
              le_mean =     -22.670391400038
             les_mean =     514.455980314313
             stat err =       0.000555503499
             autocorr =       1.211715428321
              std dev =       0.713676634094
             le_variance =       0.509334338051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670391687789        initial  <--
     2.4414e-01     2.4414e+00             3.8133e-04       -22.670390731288
     9.7656e-01     9.7656e+00             1.3630e-04       -22.670390439803
     3.9062e+00     3.9062e+01             3.8897e-05       -22.670391400038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2582
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 3.016876e-01 1 1  ON 0
 uu_1                 1.258462e-01 1 1  ON 1
 uu_2                 1.194509e-02 1 1  ON 2
 uu_3                -5.593117e-02 1 1  ON 3
 uu_4                -9.728452e-02 1 1  ON 4
 uu_5                -1.240016e-01 1 1  ON 5
 uu_6                -1.405350e-01 1 1  ON 6
 uu_7                -1.459404e-01 1 1  ON 7
 uu_8                -1.384765e-01 1 1  ON 8
 uu_9                -1.139600e-01 1 1  ON 9
 ud_0                 4.213178e-01 1 1  ON 10
 ud_1                 1.386272e-01 1 1  ON 11
 ud_2                -8.161067e-03 1 1  ON 12
 ud_3                -8.685506e-02 1 1  ON 13
 ud_4                -1.305622e-01 1 1  ON 14
 ud_5                -1.566783e-01 1 1  ON 15
 ud_6                -1.708352e-01 1 1  ON 16
 ud_7                -1.740245e-01 1 1  ON 17
 ud_8                -1.632619e-01 1 1  ON 18
 ud_9                -1.353133e-01 1 1  ON 19
 eC_0                -5.953971e-01 1 1  ON 20
 eC_1                -4.426634e-01 1 1  ON 21
 eC_2                -1.891755e-01 1 1  ON 22
 eC_3                -3.200615e-02 1 1  ON 23
 eC_4                 5.242363e-02 1 1  ON 24
 eC_5                 1.596483e-01 1 1  ON 25
 eC_6                 2.589723e-01 1 1  ON 26
 eC_7                 3.715036e-01 1 1  ON 27
 eC_8                 3.102028e-01 1 1  ON 28
 eC_9                 9.779835e-02 1 1  ON 29
 eO_0                -1.201481e+00 1 1  ON 30
 eO_1                -8.236205e-01 1 1  ON 31
 eO_2                -3.570743e-01 1 1  ON 32
 eO_3                -1.177841e-02 1 1  ON 33
 eO_4                 2.179881e-01 1 1  ON 34
 eO_5                 3.884926e-01 1 1  ON 35
 eO_6                 4.389741e-01 1 1  ON 36
 eO_7                 4.455442e-01 1 1  ON 37
 eO_8                 4.055626e-01 1 1  ON 38
 eO_9                 3.338900e-01 1 1  ON 39
eH1_0                -2.148684e-01 1 1  ON 40
eH1_1                -1.222393e-01 1 1  ON 41
eH1_2                -8.451874e-02 1 1  ON 42
eH1_3                -6.415760e-02 1 1  ON 43
eH1_4                 7.328374e-03 1 1  ON 44
eH1_5                 5.341428e-02 1 1  ON 45
eH1_6                 9.022254e-02 1 1  ON 46
eH1_7                 6.305624e-02 1 1  ON 47
eH1_8                 2.134214e-02 1 1  ON 48
eH1_9                 5.718562e-02 1 1  ON 49
eH2_0                -2.096669e-01 1 1  ON 50
eH2_1                -1.168606e-01 1 1  ON 51
eH2_2                -7.971208e-02 1 1  ON 52
eH2_3                -5.941953e-02 1 1  ON 53
eH2_4                 1.199891e-02 1 1  ON 54
eH2_5                 5.794233e-02 1 1  ON 55
eH2_6                 9.471351e-02 1 1  ON 56
eH2_7                 6.703538e-02 1 1  ON 57
eH2_8                 2.551932e-02 1 1  ON 58
eH2_9                 5.892587e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2414e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6028
    reference variance = 0.402398
====================================================
  Execution time = 4.4046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1835e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5532e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518452327800
                                         uncertainty =       0.003715214158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518452327800
                                         uncertainty =       0.003715214158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509090126
  error estimate for blocks of size 2^( 2) =       0.000527015978
  error estimate for blocks of size 2^( 3) =       0.000541971583
  error estimate for blocks of size 2^( 4) =       0.000553523245
  error estimate for blocks of size 2^( 5) =       0.000560424033
  error estimate for blocks of size 2^( 6) =       0.000563058550
  error estimate for blocks of size 2^( 7) =       0.000564084620

      target function =                  N/A
              le_mean =     -22.670489905227
             les_mean =     514.469457796030
             stat err =       0.000560272612
             autocorr =       1.211182086660
              std dev =       0.719962160259
             le_variance =       0.518345512204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267048990523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670489905227       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670490182965       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670490122004       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670489960679       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670489986202       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670489952208       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670489663453       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670489576150       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670489619219       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670489655080       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670489650928       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 7.077902e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670489905227       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670489978170       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670489962006       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670489916395       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670489920131       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670489915220       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670489836915       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670489807015       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670489811537       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670489816943       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670489815100       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 1.904975e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670489905227       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670489923696       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670489919596       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670489907816       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670489908541       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670489907545       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670489887649       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670489879556       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670489880194       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670489881233       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 5.043305e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9592e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 3.016809e-01 1 1  ON 0
 uu_1                 1.258468e-01 1 1  ON 1
 uu_2                 1.194545e-02 1 1  ON 2
 uu_3                -5.592655e-02 1 1  ON 3
 uu_4                -9.728140e-02 1 1  ON 4
 uu_5                -1.240025e-01 1 1  ON 5
 uu_6                -1.405294e-01 1 1  ON 6
 uu_7                -1.459294e-01 1 1  ON 7
 uu_8                -1.384762e-01 1 1  ON 8
 uu_9                -1.139663e-01 1 1  ON 9
 ud_0                 4.212988e-01 1 1  ON 10
 ud_1                 1.386371e-01 1 1  ON 11
 ud_2                -8.161460e-03 1 1  ON 12
 ud_3                -8.685432e-02 1 1  ON 13
 ud_4                -1.305513e-01 1 1  ON 14
 ud_5                -1.566822e-01 1 1  ON 15
 ud_6                -1.708276e-01 1 1  ON 16
 ud_7                -1.740090e-01 1 1  ON 17
 ud_8                -1.632632e-01 1 1  ON 18
 ud_9                -1.353146e-01 1 1  ON 19
 eC_0                -5.954117e-01 1 1  ON 20
 eC_1                -4.426540e-01 1 1  ON 21
 eC_2                -1.891627e-01 1 1  ON 22
 eC_3                -3.202043e-02 1 1  ON 23
 eC_4                 5.241593e-02 1 1  ON 24
 eC_5                 1.596531e-01 1 1  ON 25
 eC_6                 2.589661e-01 1 1  ON 26
 eC_7                 3.715041e-01 1 1  ON 27
 eC_8                 3.102126e-01 1 1  ON 28
 eC_9                 9.780309e-02 1 1  ON 29
 eO_0                -1.201494e+00 1 1  ON 30
 eO_1                -8.236092e-01 1 1  ON 31
 eO_2                -3.570795e-01 1 1  ON 32
 eO_3                -1.178206e-02 1 1  ON 33
 eO_4                 2.179698e-01 1 1  ON 34
 eO_5                 3.885005e-01 1 1  ON 35
 eO_6                 4.389810e-01 1 1  ON 36
 eO_7                 4.455456e-01 1 1  ON 37
 eO_8                 4.055617e-01 1 1  ON 38
 eO_9                 3.338959e-01 1 1  ON 39
eH1_0                -2.148520e-01 1 1  ON 40
eH1_1                -1.222266e-01 1 1  ON 41
eH1_2                -8.453098e-02 1 1  ON 42
eH1_3                -6.415985e-02 1 1  ON 43
eH1_4                 7.317829e-03 1 1  ON 44
eH1_5                 5.341182e-02 1 1  ON 45
eH1_6                 9.021407e-02 1 1  ON 46
eH1_7                 6.305282e-02 1 1  ON 47
eH1_8                 2.134509e-02 1 1  ON 48
eH1_9                 5.718665e-02 1 1  ON 49
eH2_0                -2.096756e-01 1 1  ON 50
eH2_1                -1.168657e-01 1 1  ON 51
eH2_2                -7.971049e-02 1 1  ON 52
eH2_3                -5.942327e-02 1 1  ON 53
eH2_4                 1.200598e-02 1 1  ON 54
eH2_5                 5.793905e-02 1 1  ON 55
eH2_6                 9.471644e-02 1 1  ON 56
eH2_7                 6.704128e-02 1 1  ON 57
eH2_8                 2.551774e-02 1 1  ON 58
eH2_9                 5.892470e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6944
    reference variance = 0.282389
====================================================
  Execution time = 4.4018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1856e-01
  Total weights = 2.0000e+06
  Execution time = 3.6602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518516598575
                                         uncertainty =       0.005349913732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518516598575
                                         uncertainty =       0.005349913732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509204999
  error estimate for blocks of size 2^( 2) =       0.000526911951
  error estimate for blocks of size 2^( 3) =       0.000543219064
  error estimate for blocks of size 2^( 4) =       0.000553527180
  error estimate for blocks of size 2^( 5) =       0.000560408465
  error estimate for blocks of size 2^( 6) =       0.000564785175
  error estimate for blocks of size 2^( 7) =       0.000564778591

      target function =                  N/A
              le_mean =     -22.669354863989
             les_mean =     514.418229152117
             stat err =       0.000560874853
             autocorr =       1.213239720099
              std dev =       0.720124615562
             le_variance =       0.518579461939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518449615702
                                         uncertainty =       0.005348831868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518449615702
                                         uncertainty =       0.005348831868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509172076
  error estimate for blocks of size 2^( 2) =       0.000526880469
  error estimate for blocks of size 2^( 3) =       0.000543188408
  error estimate for blocks of size 2^( 4) =       0.000553497161
  error estimate for blocks of size 2^( 5) =       0.000560378434
  error estimate for blocks of size 2^( 6) =       0.000564754342
  error estimate for blocks of size 2^( 7) =       0.000564747203

      target function =                  N/A
              le_mean =     -22.669355303609
             les_mean =     514.418182027614
             stat err =       0.000560844285
             autocorr =       1.213264364945
              std dev =       0.720078055212
             le_variance =       0.518512405599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518476588304
                                         uncertainty =       0.005349273171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518476588304
                                         uncertainty =       0.005349273171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509185336
  error estimate for blocks of size 2^( 2) =       0.000526893138
  error estimate for blocks of size 2^( 3) =       0.000543200748
  error estimate for blocks of size 2^( 4) =       0.000553509244
  error estimate for blocks of size 2^( 5) =       0.000560390587
  error estimate for blocks of size 2^( 6) =       0.000564766847
  error estimate for blocks of size 2^( 7) =       0.000564760027

      target function =                  N/A
              le_mean =     -22.669355072791
             les_mean =     514.418198568878
             stat err =       0.000560856676
             autocorr =       1.213254785716
              std dev =       0.720096807291
             le_variance =       0.518539411871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518511351191
                                         uncertainty =       0.005349829283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518511351191
                                         uncertainty =       0.005349829283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509202420
  error estimate for blocks of size 2^( 2) =       0.000526909482
  error estimate for blocks of size 2^( 3) =       0.000543216659
  error estimate for blocks of size 2^( 4) =       0.000553524825
  error estimate for blocks of size 2^( 5) =       0.000560406119
  error estimate for blocks of size 2^( 6) =       0.000564782770
  error estimate for blocks of size 2^( 7) =       0.000564776157

      target function =                  N/A
              le_mean =     -22.669354888199
             les_mean =     514.418224997219
             stat err =       0.000560872468
             autocorr =       1.213241689926
              std dev =       0.720120968594
             le_variance =       0.518574209409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669354863989        initial
     2.4414e+00     2.4414e+01             7.0779e-05       -22.669355303609  <--
     9.7656e+00     9.7656e+01             1.9050e-05       -22.669355072791
     3.9062e+01     3.9062e+02             5.0433e-06       -22.669354888199

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 6.2399e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 3.016636e-01 1 1  ON 0
 uu_1                 1.258485e-01 1 1  ON 1
 uu_2                 1.194725e-02 1 1  ON 2
 uu_3                -5.591387e-02 1 1  ON 3
 uu_4                -9.727253e-02 1 1  ON 4
 uu_5                -1.240040e-01 1 1  ON 5
 uu_6                -1.405154e-01 1 1  ON 6
 uu_7                -1.458978e-01 1 1  ON 7
 uu_8                -1.384748e-01 1 1  ON 8
 uu_9                -1.139849e-01 1 1  ON 9
 ud_0                 4.212544e-01 1 1  ON 10
 ud_1                 1.386600e-01 1 1  ON 11
 ud_2                -8.162285e-03 1 1  ON 12
 ud_3                -8.685195e-02 1 1  ON 13
 ud_4                -1.305245e-01 1 1  ON 14
 ud_5                -1.566898e-01 1 1  ON 15
 ud_6                -1.708088e-01 1 1  ON 16
 ud_7                -1.739645e-01 1 1  ON 17
 ud_8                -1.632663e-01 1 1  ON 18
 ud_9                -1.353185e-01 1 1  ON 19
 eC_0                -5.954517e-01 1 1  ON 20
 eC_1                -4.426275e-01 1 1  ON 21
 eC_2                -1.891283e-01 1 1  ON 22
 eC_3                -3.205930e-02 1 1  ON 23
 eC_4                 5.239157e-02 1 1  ON 24
 eC_5                 1.596672e-01 1 1  ON 25
 eC_6                 2.589483e-01 1 1  ON 26
 eC_7                 3.715053e-01 1 1  ON 27
 eC_8                 3.102415e-01 1 1  ON 28
 eC_9                 9.781706e-02 1 1  ON 29
 eO_0                -1.201528e+00 1 1  ON 30
 eO_1                -8.235806e-01 1 1  ON 31
 eO_2                -3.570938e-01 1 1  ON 32
 eO_3                -1.179357e-02 1 1  ON 33
 eO_4                 2.179174e-01 1 1  ON 34
 eO_5                 3.885211e-01 1 1  ON 35
 eO_6                 4.390013e-01 1 1  ON 36
 eO_7                 4.455504e-01 1 1  ON 37
 eO_8                 4.055590e-01 1 1  ON 38
 eO_9                 3.339129e-01 1 1  ON 39
eH1_0                -2.148038e-01 1 1  ON 40
eH1_1                -1.221909e-01 1 1  ON 41
eH1_2                -8.456402e-02 1 1  ON 42
eH1_3                -6.416860e-02 1 1  ON 43
eH1_4                 7.288522e-03 1 1  ON 44
eH1_5                 5.340434e-02 1 1  ON 45
eH1_6                 9.018866e-02 1 1  ON 46
eH1_7                 6.304265e-02 1 1  ON 47
eH1_8                 2.135385e-02 1 1  ON 48
eH1_9                 5.718964e-02 1 1  ON 49
eH2_0                -2.097009e-01 1 1  ON 50
eH2_1                -1.168809e-01 1 1  ON 51
eH2_2                -7.970597e-02 1 1  ON 52
eH2_3                -5.943425e-02 1 1  ON 53
eH2_4                 1.202459e-02 1 1  ON 54
eH2_5                 5.793184e-02 1 1  ON 55
eH2_6                 9.472423e-02 1 1  ON 56
eH2_7                 6.705861e-02 1 1  ON 57
eH2_8                 2.551319e-02 1 1  ON 58
eH2_9                 5.892127e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7098
    reference variance = 0.372139
====================================================
  Execution time = 4.4604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2294e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5189e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522944548422
                                         uncertainty =       0.004679961720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522944548422
                                         uncertainty =       0.004679961720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511339882
  error estimate for blocks of size 2^( 2) =       0.000528848018
  error estimate for blocks of size 2^( 3) =       0.000544651140
  error estimate for blocks of size 2^( 4) =       0.000555306804
  error estimate for blocks of size 2^( 5) =       0.000560996348
  error estimate for blocks of size 2^( 6) =       0.000562540133
  error estimate for blocks of size 2^( 7) =       0.000564435246

      target function =                  N/A
              le_mean =     -22.670457346324
             les_mean =     514.472572980857
             stat err =       0.000560819633
             autocorr =       1.202893236275
              std dev =       0.723143796781
             le_variance =       0.522936950822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267045734632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670457346324       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670457740595       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670458039091       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670457496013       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670457528693       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670457084955       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670457188839       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670457124506       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670456985021       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670457042033       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670457136469       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 2.046746e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670457346324       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670457484287       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670457614252       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670457477399       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670457529719       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670457297835       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670457284591       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670457298130       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670457262520       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670457282275       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 8.302313e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670457346324       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670457384644       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670457423379       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670457389725       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670457410843       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670457344774       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670457333808       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670457337464       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670457329229       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670457333340       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.409560e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9807e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 3.016429e-01 1 1  ON 0
 uu_1                 1.258272e-01 1 1  ON 1
 uu_2                 1.196062e-02 1 1  ON 2
 uu_3                -5.591022e-02 1 1  ON 3
 uu_4                -9.726058e-02 1 1  ON 4
 uu_5                -1.240221e-01 1 1  ON 5
 uu_6                -1.405003e-01 1 1  ON 6
 uu_7                -1.458581e-01 1 1  ON 7
 uu_8                -1.384213e-01 1 1  ON 8
 uu_9                -1.140030e-01 1 1  ON 9
 ud_0                 4.211714e-01 1 1  ON 10
 ud_1                 1.386878e-01 1 1  ON 11
 ud_2                -8.111760e-03 1 1  ON 12
 ud_3                -8.687428e-02 1 1  ON 13
 ud_4                -1.304940e-01 1 1  ON 14
 ud_5                -1.566754e-01 1 1  ON 15
 ud_6                -1.708121e-01 1 1  ON 16
 ud_7                -1.739314e-01 1 1  ON 17
 ud_8                -1.632281e-01 1 1  ON 18
 ud_9                -1.353292e-01 1 1  ON 19
 eC_0                -5.954737e-01 1 1  ON 20
 eC_1                -4.425976e-01 1 1  ON 21
 eC_2                -1.891379e-01 1 1  ON 22
 eC_3                -3.210421e-02 1 1  ON 23
 eC_4                 5.239794e-02 1 1  ON 24
 eC_5                 1.596498e-01 1 1  ON 25
 eC_6                 2.589620e-01 1 1  ON 26
 eC_7                 3.715066e-01 1 1  ON 27
 eC_8                 3.102684e-01 1 1  ON 28
 eC_9                 9.783215e-02 1 1  ON 29
 eO_0                -1.201568e+00 1 1  ON 30
 eO_1                -8.235396e-01 1 1  ON 31
 eO_2                -3.571501e-01 1 1  ON 32
 eO_3                -1.179947e-02 1 1  ON 33
 eO_4                 2.179364e-01 1 1  ON 34
 eO_5                 3.885160e-01 1 1  ON 35
 eO_6                 4.389563e-01 1 1  ON 36
 eO_7                 4.455874e-01 1 1  ON 37
 eO_8                 4.055671e-01 1 1  ON 38
 eO_9                 3.339358e-01 1 1  ON 39
eH1_0                -2.147835e-01 1 1  ON 40
eH1_1                -1.221834e-01 1 1  ON 41
eH1_2                -8.460137e-02 1 1  ON 42
eH1_3                -6.420424e-02 1 1  ON 43
eH1_4                 7.328910e-03 1 1  ON 44
eH1_5                 5.339404e-02 1 1  ON 45
eH1_6                 9.019981e-02 1 1  ON 46
eH1_7                 6.304214e-02 1 1  ON 47
eH1_8                 2.135171e-02 1 1  ON 48
eH1_9                 5.718051e-02 1 1  ON 49
eH2_0                -2.096860e-01 1 1  ON 50
eH2_1                -1.169124e-01 1 1  ON 51
eH2_2                -7.968181e-02 1 1  ON 52
eH2_3                -5.946549e-02 1 1  ON 53
eH2_4                 1.199878e-02 1 1  ON 54
eH2_5                 5.797273e-02 1 1  ON 55
eH2_6                 9.470288e-02 1 1  ON 56
eH2_7                 6.705511e-02 1 1  ON 57
eH2_8                 2.553322e-02 1 1  ON 58
eH2_9                 5.891316e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6813
    reference variance = 0.40333
====================================================
  Execution time = 4.5652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0505e-01
  Total weights = 2.0000e+06
  Execution time = 3.6590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505255321149
                                         uncertainty =       0.003491381241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505255321149
                                         uncertainty =       0.003491381241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502585039
  error estimate for blocks of size 2^( 2) =       0.000520376467
  error estimate for blocks of size 2^( 3) =       0.000536159198
  error estimate for blocks of size 2^( 4) =       0.000546980366
  error estimate for blocks of size 2^( 5) =       0.000554195013
  error estimate for blocks of size 2^( 6) =       0.000558238661
  error estimate for blocks of size 2^( 7) =       0.000561094663

      target function =                  N/A
              le_mean =     -22.670483747022
             les_mean =     514.456016514566
             stat err =       0.000555127176
             autocorr =       1.220016947519
              std dev =       0.710762578615
             le_variance =       0.505183443159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504927690583
                                         uncertainty =       0.003488306531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504927690583
                                         uncertainty =       0.003488306531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502422069
  error estimate for blocks of size 2^( 2) =       0.000520222385
  error estimate for blocks of size 2^( 3) =       0.000536010283
  error estimate for blocks of size 2^( 4) =       0.000546831199
  error estimate for blocks of size 2^( 5) =       0.000554038936
  error estimate for blocks of size 2^( 6) =       0.000558082678
  error estimate for blocks of size 2^( 7) =       0.000560933211

      target function =                  N/A
              le_mean =     -22.670486468432
             les_mean =     514.455812333159
             stat err =       0.000554971506
             autocorr =       1.220123962738
              std dev =       0.710532103575
             le_variance =       0.504855870210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504981844051
                                         uncertainty =       0.003488826968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504981844051
                                         uncertainty =       0.003488826968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502448996
  error estimate for blocks of size 2^( 2) =       0.000520248100
  error estimate for blocks of size 2^( 3) =       0.000536035699
  error estimate for blocks of size 2^( 4) =       0.000546857322
  error estimate for blocks of size 2^( 5) =       0.000554067034
  error estimate for blocks of size 2^( 6) =       0.000558111222
  error estimate for blocks of size 2^( 7) =       0.000560962895

      target function =                  N/A
              le_mean =     -22.670485669057
             les_mean =     514.455830205886
             stat err =       0.000554999618
             autocorr =       1.220116788312
              std dev =       0.710570184740
             le_variance =       0.504909987442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505215217526
                                         uncertainty =       0.003491007898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505215217526
                                         uncertainty =       0.003491007898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502565091
  error estimate for blocks of size 2^( 2) =       0.000520357647
  error estimate for blocks of size 2^( 3) =       0.000536141096
  error estimate for blocks of size 2^( 4) =       0.000546962345
  error estimate for blocks of size 2^( 5) =       0.000554176294
  error estimate for blocks of size 2^( 6) =       0.000558220032
  error estimate for blocks of size 2^( 7) =       0.000561075390

      target function =                  N/A
              le_mean =     -22.670483988013
             les_mean =     514.455987339849
             stat err =       0.000555108515
             autocorr =       1.220031773269
              std dev =       0.710734367851
             le_variance =       0.505143341644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670483747022        initial
     6.1035e-01     6.1035e+00             2.0467e-04       -22.670486468432  <--
     2.4414e+00     2.4414e+01             8.3023e-05       -22.670485669057
     9.7656e+00     9.7656e+01             2.4096e-05       -22.670483988013

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 6.4025e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 3.016004e-01 1 1  ON 0
 uu_1                 1.257993e-01 1 1  ON 1
 uu_2                 1.198349e-02 1 1  ON 2
 uu_3                -5.589028e-02 1 1  ON 3
 uu_4                -9.723728e-02 1 1  ON 4
 uu_5                -1.240472e-01 1 1  ON 5
 uu_6                -1.404730e-01 1 1  ON 6
 uu_7                -1.457702e-01 1 1  ON 7
 uu_8                -1.382701e-01 1 1  ON 8
 uu_9                -1.140572e-01 1 1  ON 9
 ud_0                 4.210644e-01 1 1  ON 10
 ud_1                 1.387462e-01 1 1  ON 11
 ud_2                -8.030776e-03 1 1  ON 12
 ud_3                -8.689295e-02 1 1  ON 13
 ud_4                -1.304537e-01 1 1  ON 14
 ud_5                -1.566389e-01 1 1  ON 15
 ud_6                -1.708090e-01 1 1  ON 16
 ud_7                -1.738658e-01 1 1  ON 17
 ud_8                -1.631235e-01 1 1  ON 18
 ud_9                -1.353606e-01 1 1  ON 19
 eC_0                -5.955199e-01 1 1  ON 20
 eC_1                -4.425196e-01 1 1  ON 21
 eC_2                -1.891677e-01 1 1  ON 22
 eC_3                -3.222554e-02 1 1  ON 23
 eC_4                 5.239772e-02 1 1  ON 24
 eC_5                 1.595953e-01 1 1  ON 25
 eC_6                 2.589992e-01 1 1  ON 26
 eC_7                 3.715109e-01 1 1  ON 27
 eC_8                 3.103519e-01 1 1  ON 28
 eC_9                 9.787903e-02 1 1  ON 29
 eO_0                -1.201645e+00 1 1  ON 30
 eO_1                -8.234805e-01 1 1  ON 31
 eO_2                -3.572655e-01 1 1  ON 32
 eO_3                -1.183302e-02 1 1  ON 33
 eO_4                 2.179743e-01 1 1  ON 34
 eO_5                 3.885077e-01 1 1  ON 35
 eO_6                 4.388115e-01 1 1  ON 36
 eO_7                 4.456970e-01 1 1  ON 37
 eO_8                 4.055923e-01 1 1  ON 38
 eO_9                 3.340075e-01 1 1  ON 39
eH1_0                -2.147287e-01 1 1  ON 40
eH1_1                -1.221784e-01 1 1  ON 41
eH1_2                -8.468993e-02 1 1  ON 42
eH1_3                -6.429280e-02 1 1  ON 43
eH1_4                 7.422176e-03 1 1  ON 44
eH1_5                 5.338614e-02 1 1  ON 45
eH1_6                 9.022488e-02 1 1  ON 46
eH1_7                 6.303643e-02 1 1  ON 47
eH1_8                 2.134373e-02 1 1  ON 48
eH1_9                 5.715236e-02 1 1  ON 49
eH2_0                -2.096445e-01 1 1  ON 50
eH2_1                -1.169901e-01 1 1  ON 51
eH2_2                -7.962541e-02 1 1  ON 52
eH2_3                -5.955519e-02 1 1  ON 53
eH2_4                 1.194343e-02 1 1  ON 54
eH2_5                 5.805568e-02 1 1  ON 55
eH2_6                 9.465935e-02 1 1  ON 56
eH2_7                 6.703979e-02 1 1  ON 57
eH2_8                 2.559203e-02 1 1  ON 58
eH2_9                 5.888815e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2384e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8229
    reference variance = 2.34383
====================================================
  Execution time = 4.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1494e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5112e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514913429573
                                         uncertainty =       0.004248381832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514913429573
                                         uncertainty =       0.004248381832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507413282
  error estimate for blocks of size 2^( 2) =       0.000524830128
  error estimate for blocks of size 2^( 3) =       0.000540079522
  error estimate for blocks of size 2^( 4) =       0.000552214714
  error estimate for blocks of size 2^( 5) =       0.000558480006
  error estimate for blocks of size 2^( 6) =       0.000562120531
  error estimate for blocks of size 2^( 7) =       0.000564404200

      target function =                  N/A
              le_mean =     -22.669828336722
             les_mean =     514.436053037117
             stat err =       0.000559304862
             autocorr =       1.214992304386
              std dev =       0.717590745586
             le_variance =       0.514936478151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266982833672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669828336722       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669828452969       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669828103062       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669828230178       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669829328452       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669830700174       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669831225977       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669829820164       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669830146241       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669829921121       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669830383977       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669830484286       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669830719999       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-01 is 8.459008e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669828336722       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669828387548       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669828227968       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669828092733       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669828148551       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669828729529       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669829209407       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669828900772       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669828838861       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669828757725       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669828820862       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 2.336991e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669828336722       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669828352355       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669828302398       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669828223175       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669828181723       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669828281930       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669828456131       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669828430190       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669828399134       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669828399015       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 6.555230e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9466e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 3.015333e-01 1 1  ON 0
 uu_1                 1.258345e-01 1 1  ON 1
 uu_2                 1.200430e-02 1 1  ON 2
 uu_3                -5.581605e-02 1 1  ON 3
 uu_4                -9.714635e-02 1 1  ON 4
 uu_5                -1.239978e-01 1 1  ON 5
 uu_6                -1.403918e-01 1 1  ON 6
 uu_7                -1.458337e-01 1 1  ON 7
 uu_8                -1.384349e-01 1 1  ON 8
 uu_9                -1.139675e-01 1 1  ON 9
 ud_0                 4.212265e-01 1 1  ON 10
 ud_1                 1.387131e-01 1 1  ON 11
 ud_2                -8.070228e-03 1 1  ON 12
 ud_3                -8.687898e-02 1 1  ON 13
 ud_4                -1.304846e-01 1 1  ON 14
 ud_5                -1.565403e-01 1 1  ON 15
 ud_6                -1.707873e-01 1 1  ON 16
 ud_7                -1.738411e-01 1 1  ON 17
 ud_8                -1.630434e-01 1 1  ON 18
 ud_9                -1.353304e-01 1 1  ON 19
 eC_0                -5.954680e-01 1 1  ON 20
 eC_1                -4.425631e-01 1 1  ON 21
 eC_2                -1.890819e-01 1 1  ON 22
 eC_3                -3.225686e-02 1 1  ON 23
 eC_4                 5.226605e-02 1 1  ON 24
 eC_5                 1.595643e-01 1 1  ON 25
 eC_6                 2.588956e-01 1 1  ON 26
 eC_7                 3.715064e-01 1 1  ON 27
 eC_8                 3.104900e-01 1 1  ON 28
 eC_9                 9.794410e-02 1 1  ON 29
 eO_0                -1.201720e+00 1 1  ON 30
 eO_1                -8.234690e-01 1 1  ON 31
 eO_2                -3.573125e-01 1 1  ON 32
 eO_3                -1.196262e-02 1 1  ON 33
 eO_4                 2.178638e-01 1 1  ON 34
 eO_5                 3.884354e-01 1 1  ON 35
 eO_6                 4.389310e-01 1 1  ON 36
 eO_7                 4.458125e-01 1 1  ON 37
 eO_8                 4.055776e-01 1 1  ON 38
 eO_9                 3.341014e-01 1 1  ON 39
eH1_0                -2.147538e-01 1 1  ON 40
eH1_1                -1.221287e-01 1 1  ON 41
eH1_2                -8.469203e-02 1 1  ON 42
eH1_3                -6.416614e-02 1 1  ON 43
eH1_4                 7.464048e-03 1 1  ON 44
eH1_5                 5.338268e-02 1 1  ON 45
eH1_6                 9.011236e-02 1 1  ON 46
eH1_7                 6.280273e-02 1 1  ON 47
eH1_8                 2.137586e-02 1 1  ON 48
eH1_9                 5.720563e-02 1 1  ON 49
eH2_0                -2.096330e-01 1 1  ON 50
eH2_1                -1.171140e-01 1 1  ON 51
eH2_2                -7.954518e-02 1 1  ON 52
eH2_3                -5.946336e-02 1 1  ON 53
eH2_4                 1.203364e-02 1 1  ON 54
eH2_5                 5.798767e-02 1 1  ON 55
eH2_6                 9.462981e-02 1 1  ON 56
eH2_7                 6.698198e-02 1 1  ON 57
eH2_8                 2.554463e-02 1 1  ON 58
eH2_9                 5.883943e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6563
    reference variance = 0.475708
====================================================
  Execution time = 4.3567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0821e-01
  Total weights = 2.0000e+06
  Execution time = 3.6554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508055436554
                                         uncertainty =       0.003612268290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508055436554
                                         uncertainty =       0.003612268290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503996296
  error estimate for blocks of size 2^( 2) =       0.000521928471
  error estimate for blocks of size 2^( 3) =       0.000537443533
  error estimate for blocks of size 2^( 4) =       0.000549219399
  error estimate for blocks of size 2^( 5) =       0.000556785894
  error estimate for blocks of size 2^( 6) =       0.000561027085
  error estimate for blocks of size 2^( 7) =       0.000561120491

      target function =                  N/A
              le_mean =     -22.669677955416
             les_mean =     514.422322880712
             stat err =       0.000557038217
             autocorr =       1.221561384203
              std dev =       0.712758396960
             le_variance =       0.508024532437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508319604453
                                         uncertainty =       0.003615461110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508319604453
                                         uncertainty =       0.003615461110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504127303
  error estimate for blocks of size 2^( 2) =       0.000522053248
  error estimate for blocks of size 2^( 3) =       0.000537563248
  error estimate for blocks of size 2^( 4) =       0.000549339644
  error estimate for blocks of size 2^( 5) =       0.000556901277
  error estimate for blocks of size 2^( 6) =       0.000561137016
  error estimate for blocks of size 2^( 7) =       0.000561222143

      target function =                  N/A
              le_mean =     -22.669680702734
             les_mean =     514.422711584025
             stat err =       0.000557150020
             autocorr =       1.221416728219
              std dev =       0.712943668367
             le_variance =       0.508288674265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508435903332
                                         uncertainty =       0.003616281979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508435903332
                                         uncertainty =       0.003616281979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504184960
  error estimate for blocks of size 2^( 2) =       0.000522107914
  error estimate for blocks of size 2^( 3) =       0.000537614561
  error estimate for blocks of size 2^( 4) =       0.000549388388
  error estimate for blocks of size 2^( 5) =       0.000556949954
  error estimate for blocks of size 2^( 6) =       0.000561184874
  error estimate for blocks of size 2^( 7) =       0.000561268800

      target function =                  N/A
              le_mean =     -22.669680456866
             les_mean =     514.422816709145
             stat err =       0.000557198004
             autocorr =       1.221347736783
              std dev =       0.713025207774
             le_variance =       0.508404946921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508136694585
                                         uncertainty =       0.003613123164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508136694585
                                         uncertainty =       0.003613123164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504036597
  error estimate for blocks of size 2^( 2) =       0.000521966789
  error estimate for blocks of size 2^( 3) =       0.000537479942
  error estimate for blocks of size 2^( 4) =       0.000549255233
  error estimate for blocks of size 2^( 5) =       0.000556820894
  error estimate for blocks of size 2^( 6) =       0.000561060858
  error estimate for blocks of size 2^( 7) =       0.000561152594

      target function =                  N/A
              le_mean =     -22.669678260722
             les_mean =     514.422417972964
             stat err =       0.000557072395
             autocorr =       1.221515926857
              std dev =       0.712815391499
             le_variance =       0.508105782357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669677955416        initial
     1.5259e-01     1.5259e+00             8.4590e-04       -22.669680702734  <--
     6.1035e-01     6.1035e+00             2.3370e-04       -22.669680456866
     2.4414e+00     2.4414e+01             6.5552e-05       -22.669678260722

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 6.1935e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 3.015081e-01 1 1  ON 0
 uu_1                 1.258807e-01 1 1  ON 1
 uu_2                 1.207046e-02 1 1  ON 2
 uu_3                -5.568842e-02 1 1  ON 3
 uu_4                -9.698853e-02 1 1  ON 4
 uu_5                -1.238499e-01 1 1  ON 5
 uu_6                -1.402932e-01 1 1  ON 6
 uu_7                -1.458866e-01 1 1  ON 7
 uu_8                -1.388056e-01 1 1  ON 8
 uu_9                -1.137545e-01 1 1  ON 9
 ud_0                 4.213531e-01 1 1  ON 10
 ud_1                 1.387206e-01 1 1  ON 11
 ud_2                -8.062495e-03 1 1  ON 12
 ud_3                -8.683878e-02 1 1  ON 13
 ud_4                -1.304299e-01 1 1  ON 14
 ud_5                -1.564083e-01 1 1  ON 15
 ud_6                -1.706386e-01 1 1  ON 16
 ud_7                -1.737473e-01 1 1  ON 17
 ud_8                -1.628355e-01 1 1  ON 18
 ud_9                -1.352483e-01 1 1  ON 19
 eC_0                -5.953507e-01 1 1  ON 20
 eC_1                -4.425955e-01 1 1  ON 21
 eC_2                -1.890262e-01 1 1  ON 22
 eC_3                -3.231884e-02 1 1  ON 23
 eC_4                 5.199986e-02 1 1  ON 24
 eC_5                 1.594965e-01 1 1  ON 25
 eC_6                 2.586106e-01 1 1  ON 26
 eC_7                 3.714817e-01 1 1  ON 27
 eC_8                 3.108644e-01 1 1  ON 28
 eC_9                 9.812186e-02 1 1  ON 29
 eO_0                -1.201865e+00 1 1  ON 30
 eO_1                -8.235662e-01 1 1  ON 31
 eO_2                -3.574798e-01 1 1  ON 32
 eO_3                -1.224617e-02 1 1  ON 33
 eO_4                 2.176286e-01 1 1  ON 34
 eO_5                 3.882599e-01 1 1  ON 35
 eO_6                 4.391966e-01 1 1  ON 36
 eO_7                 4.461334e-01 1 1  ON 37
 eO_8                 4.055437e-01 1 1  ON 38
 eO_9                 3.343563e-01 1 1  ON 39
eH1_0                -2.147675e-01 1 1  ON 40
eH1_1                -1.220135e-01 1 1  ON 41
eH1_2                -8.466972e-02 1 1  ON 42
eH1_3                -6.395604e-02 1 1  ON 43
eH1_4                 7.530952e-03 1 1  ON 44
eH1_5                 5.337879e-02 1 1  ON 45
eH1_6                 8.992009e-02 1 1  ON 46
eH1_7                 6.219053e-02 1 1  ON 47
eH1_8                 2.144371e-02 1 1  ON 48
eH1_9                 5.734543e-02 1 1  ON 49
eH2_0                -2.096022e-01 1 1  ON 50
eH2_1                -1.172497e-01 1 1  ON 51
eH2_2                -7.943813e-02 1 1  ON 52
eH2_3                -5.930701e-02 1 1  ON 53
eH2_4                 1.214164e-02 1 1  ON 54
eH2_5                 5.794423e-02 1 1  ON 55
eH2_6                 9.457071e-02 1 1  ON 56
eH2_7                 6.681571e-02 1 1  ON 57
eH2_8                 2.540784e-02 1 1  ON 58
eH2_9                 5.870165e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2141e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6947
    reference variance = 0.308253
====================================================
  Execution time = 4.4983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5082e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511616211435
                                         uncertainty =       0.003573508417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511616211435
                                         uncertainty =       0.003573508417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505707863
  error estimate for blocks of size 2^( 2) =       0.000523127289
  error estimate for blocks of size 2^( 3) =       0.000539743353
  error estimate for blocks of size 2^( 4) =       0.000551272246
  error estimate for blocks of size 2^( 5) =       0.000557005806
  error estimate for blocks of size 2^( 6) =       0.000558919709
  error estimate for blocks of size 2^( 7) =       0.000561472182

      target function =                  N/A
              le_mean =     -22.670422389890
             les_mean =     514.459531965156
             stat err =       0.000557167486
             autocorr =       1.213869829177
              std dev =       0.715178918094
             le_variance =       0.511480884886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267042238989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670422389890       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670422551376       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670425241179       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670427132509       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670428497318       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670428716935       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670429444754       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670429975330       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670430868549       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670431804996       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670432399824       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670431959418       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670432423427       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.670432099579       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.670431829814       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.670432073270       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.670432438894       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.670432679346       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.670432409766       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-02 is 2.268131e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670422389890       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670422490270       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670424273866       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670425299267       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670426556960       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670426702153       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670427144879       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670427518007       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670427857988       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670428030179       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670428163682       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670427795440       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670427984786       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.670427942201       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-01 is 7.864254e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670422389890       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670422429825       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670423241720       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670423544722       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670424319399       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670424368685       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670424461763       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670424727417       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670424781663       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670424772031       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670424781925       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670424687715       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 2.340501e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0083e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 3.016837e-01 1 1  ON 0
 uu_1                 1.260074e-01 1 1  ON 1
 uu_2                 1.209386e-02 1 1  ON 2
 uu_3                -5.582575e-02 1 1  ON 3
 uu_4                -9.684504e-02 1 1  ON 4
 uu_5                -1.236622e-01 1 1  ON 5
 uu_6                -1.402146e-01 1 1  ON 6
 uu_7                -1.464118e-01 1 1  ON 7
 uu_8                -1.386613e-01 1 1  ON 8
 uu_9                -1.136559e-01 1 1  ON 9
 ud_0                 4.212712e-01 1 1  ON 10
 ud_1                 1.389195e-01 1 1  ON 11
 ud_2                -7.963186e-03 1 1  ON 12
 ud_3                -8.654665e-02 1 1  ON 13
 ud_4                -1.302033e-01 1 1  ON 14
 ud_5                -1.563403e-01 1 1  ON 15
 ud_6                -1.706833e-01 1 1  ON 16
 ud_7                -1.736021e-01 1 1  ON 17
 ud_8                -1.631156e-01 1 1  ON 18
 ud_9                -1.349769e-01 1 1  ON 19
 eC_0                -5.958004e-01 1 1  ON 20
 eC_1                -4.424556e-01 1 1  ON 21
 eC_2                -1.893901e-01 1 1  ON 22
 eC_3                -3.240347e-02 1 1  ON 23
 eC_4                 5.202333e-02 1 1  ON 24
 eC_5                 1.595490e-01 1 1  ON 25
 eC_6                 2.584333e-01 1 1  ON 26
 eC_7                 3.714358e-01 1 1  ON 27
 eC_8                 3.114216e-01 1 1  ON 28
 eC_9                 9.845352e-02 1 1  ON 29
 eO_0                -1.202085e+00 1 1  ON 30
 eO_1                -8.237166e-01 1 1  ON 31
 eO_2                -3.572913e-01 1 1  ON 32
 eO_3                -1.217866e-02 1 1  ON 33
 eO_4                 2.173404e-01 1 1  ON 34
 eO_5                 3.879578e-01 1 1  ON 35
 eO_6                 4.387993e-01 1 1  ON 36
 eO_7                 4.461602e-01 1 1  ON 37
 eO_8                 4.056112e-01 1 1  ON 38
 eO_9                 3.348560e-01 1 1  ON 39
eH1_0                -2.155539e-01 1 1  ON 40
eH1_1                -1.224713e-01 1 1  ON 41
eH1_2                -8.456957e-02 1 1  ON 42
eH1_3                -6.409636e-02 1 1  ON 43
eH1_4                 7.597211e-03 1 1  ON 44
eH1_5                 5.296663e-02 1 1  ON 45
eH1_6                 9.001620e-02 1 1  ON 46
eH1_7                 6.294936e-02 1 1  ON 47
eH1_8                 2.191751e-02 1 1  ON 48
eH1_9                 5.729892e-02 1 1  ON 49
eH2_0                -2.097486e-01 1 1  ON 50
eH2_1                -1.172260e-01 1 1  ON 51
eH2_2                -7.911264e-02 1 1  ON 52
eH2_3                -5.930263e-02 1 1  ON 53
eH2_4                 1.235004e-02 1 1  ON 54
eH2_5                 5.777118e-02 1 1  ON 55
eH2_6                 9.440612e-02 1 1  ON 56
eH2_7                 6.674631e-02 1 1  ON 57
eH2_8                 2.541375e-02 1 1  ON 58
eH2_9                 5.843312e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7354
    reference variance = 0.579857
====================================================
  Execution time = 4.3573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1521e-01
  Total weights = 2.0000e+06
  Execution time = 3.6519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515499411307
                                         uncertainty =       0.005673803090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515499411307
                                         uncertainty =       0.005673803090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507641595
  error estimate for blocks of size 2^( 2) =       0.000524913753
  error estimate for blocks of size 2^( 3) =       0.000540950682
  error estimate for blocks of size 2^( 4) =       0.000551889798
  error estimate for blocks of size 2^( 5) =       0.000559109738
  error estimate for blocks of size 2^( 6) =       0.000563268314
  error estimate for blocks of size 2^( 7) =       0.000568111401

      target function =                  N/A
              le_mean =     -22.669717269847
             les_mean =     514.431480815458
             stat err =       0.000560594813
             autocorr =       1.219505461144
              std dev =       0.717913628769
             le_variance =       0.515399978372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515320326191
                                         uncertainty =       0.005667056675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515320326191
                                         uncertainty =       0.005667056675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507553332
  error estimate for blocks of size 2^( 2) =       0.000524822571
  error estimate for blocks of size 2^( 3) =       0.000540863151
  error estimate for blocks of size 2^( 4) =       0.000551811319
  error estimate for blocks of size 2^( 5) =       0.000559035377
  error estimate for blocks of size 2^( 6) =       0.000563193331
  error estimate for blocks of size 2^( 7) =       0.000568021069

      target function =                  N/A
              le_mean =     -22.669717938842
             les_mean =     514.431331938341
             stat err =       0.000560515274
             autocorr =       1.219583492897
              std dev =       0.717788805512
             le_variance =       0.515220769319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515136449148
                                         uncertainty =       0.005659268695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515136449148
                                         uncertainty =       0.005659268695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507462746
  error estimate for blocks of size 2^( 2) =       0.000524733613
  error estimate for blocks of size 2^( 3) =       0.000540777630
  error estimate for blocks of size 2^( 4) =       0.000551729745
  error estimate for blocks of size 2^( 5) =       0.000558956194
  error estimate for blocks of size 2^( 6) =       0.000563118278
  error estimate for blocks of size 2^( 7) =       0.000567940610

      target function =                  N/A
              le_mean =     -22.669719670650
             les_mean =     514.431226566122
             stat err =       0.000560436207
             autocorr =       1.219674765629
              std dev =       0.717660698245
             le_variance =       0.515036877806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515391124089
                                         uncertainty =       0.005669414719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515391124089
                                         uncertainty =       0.005669414719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507588241
  error estimate for blocks of size 2^( 2) =       0.000524859895
  error estimate for blocks of size 2^( 3) =       0.000540898186
  error estimate for blocks of size 2^( 4) =       0.000551840105
  error estimate for blocks of size 2^( 5) =       0.000559061524
  error estimate for blocks of size 2^( 6) =       0.000563221825
  error estimate for blocks of size 2^( 7) =       0.000568059512

      target function =                  N/A
              le_mean =     -22.669716500352
             les_mean =     514.431337593736
             stat err =       0.000560545741
             autocorr =       1.219548313359
              std dev =       0.717838174692
             le_variance =       0.515291645046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669717269847        initial
     3.8147e-02     3.8147e-01             2.2681e-03       -22.669717938842
     1.5259e-01     1.5259e+00             7.8643e-04       -22.669719670650  <--
     6.1035e-01     6.1035e+00             2.3405e-04       -22.669716500352

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 6.1921e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 3.016837e-01 1 1  ON 0
 uu_1                 1.260074e-01 1 1  ON 1
 uu_2                 1.209386e-02 1 1  ON 2
 uu_3                -5.582575e-02 1 1  ON 3
 uu_4                -9.684504e-02 1 1  ON 4
 uu_5                -1.236622e-01 1 1  ON 5
 uu_6                -1.402146e-01 1 1  ON 6
 uu_7                -1.464118e-01 1 1  ON 7
 uu_8                -1.386613e-01 1 1  ON 8
 uu_9                -1.136559e-01 1 1  ON 9
 ud_0                 4.212712e-01 1 1  ON 10
 ud_1                 1.389195e-01 1 1  ON 11
 ud_2                -7.963186e-03 1 1  ON 12
 ud_3                -8.654665e-02 1 1  ON 13
 ud_4                -1.302033e-01 1 1  ON 14
 ud_5                -1.563403e-01 1 1  ON 15
 ud_6                -1.706833e-01 1 1  ON 16
 ud_7                -1.736021e-01 1 1  ON 17
 ud_8                -1.631156e-01 1 1  ON 18
 ud_9                -1.349769e-01 1 1  ON 19
 eC_0                -5.958004e-01 1 1  ON 20
 eC_1                -4.424556e-01 1 1  ON 21
 eC_2                -1.893901e-01 1 1  ON 22
 eC_3                -3.240347e-02 1 1  ON 23
 eC_4                 5.202333e-02 1 1  ON 24
 eC_5                 1.595490e-01 1 1  ON 25
 eC_6                 2.584333e-01 1 1  ON 26
 eC_7                 3.714358e-01 1 1  ON 27
 eC_8                 3.114216e-01 1 1  ON 28
 eC_9                 9.845352e-02 1 1  ON 29
 eO_0                -1.202085e+00 1 1  ON 30
 eO_1                -8.237166e-01 1 1  ON 31
 eO_2                -3.572913e-01 1 1  ON 32
 eO_3                -1.217866e-02 1 1  ON 33
 eO_4                 2.173404e-01 1 1  ON 34
 eO_5                 3.879578e-01 1 1  ON 35
 eO_6                 4.387993e-01 1 1  ON 36
 eO_7                 4.461602e-01 1 1  ON 37
 eO_8                 4.056112e-01 1 1  ON 38
 eO_9                 3.348560e-01 1 1  ON 39
eH1_0                -2.155539e-01 1 1  ON 40
eH1_1                -1.224713e-01 1 1  ON 41
eH1_2                -8.456957e-02 1 1  ON 42
eH1_3                -6.409636e-02 1 1  ON 43
eH1_4                 7.597211e-03 1 1  ON 44
eH1_5                 5.296663e-02 1 1  ON 45
eH1_6                 9.001620e-02 1 1  ON 46
eH1_7                 6.294936e-02 1 1  ON 47
eH1_8                 2.191751e-02 1 1  ON 48
eH1_9                 5.729892e-02 1 1  ON 49
eH2_0                -2.097486e-01 1 1  ON 50
eH2_1                -1.172260e-01 1 1  ON 51
eH2_2                -7.911264e-02 1 1  ON 52
eH2_3                -5.930263e-02 1 1  ON 53
eH2_4                 1.235004e-02 1 1  ON 54
eH2_5                 5.777118e-02 1 1  ON 55
eH2_6                 9.440612e-02 1 1  ON 56
eH2_7                 6.674631e-02 1 1  ON 57
eH2_8                 2.541375e-02 1 1  ON 58
eH2_9                 5.843312e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2201e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6725
    reference variance = 0.539533
====================================================
  Execution time = 4.5948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 6.5743e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5073e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.657790579555
                                         uncertainty =       0.133336795888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.657790579555
                                         uncertainty =       0.133336795888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000573337084
  error estimate for blocks of size 2^( 2) =       0.000589845055
  error estimate for blocks of size 2^( 3) =       0.000603609337
  error estimate for blocks of size 2^( 4) =       0.000613697680
  error estimate for blocks of size 2^( 5) =       0.000617421758
  error estimate for blocks of size 2^( 6) =       0.000619790019
  error estimate for blocks of size 2^( 7) =       0.000624627685

      target function =                  N/A
              le_mean =     -22.670143545008
             les_mean =     514.592838847193
             stat err =       0.000618884285
             autocorr =       1.165195619935
              std dev =       0.810821080522
             le_variance =       0.657430824619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267014354501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143545008       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670146603304       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670145874621       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670146259277       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670144614639       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670146948362       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670146563335       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670146212819       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670147162068       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670146579401       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670146691514       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670148219894       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670148138741       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.670148217461       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.670148368435       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.670148344119       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.670148524470       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.670148121433       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.670148136187       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.670148289032       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-02 is 2.383072e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143545008       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670145712352       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670145545302       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670145863996       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670144053029       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670145182761       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670145221238       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670144975384       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670145024326       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670145256672       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670145955137       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670145562913       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670145758944       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.670145641823       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e-01 is 8.045800e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670143545008       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670144545955       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670144629393       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670144936279       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670143860752       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670143968768       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670144092253       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670143966804       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670144030123       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670144153889       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670144305665       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670144243299       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 2.810054e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1038e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 3.016132e-01 1 1  ON 0
 uu_1                 1.262268e-01 1 1  ON 1
 uu_2                 1.218695e-02 1 1  ON 2
 uu_3                -5.557159e-02 1 1  ON 3
 uu_4                -9.663941e-02 1 1  ON 4
 uu_5                -1.236801e-01 1 1  ON 5
 uu_6                -1.400113e-01 1 1  ON 6
 uu_7                -1.459690e-01 1 1  ON 7
 uu_8                -1.390809e-01 1 1  ON 8
 uu_9                -1.137367e-01 1 1  ON 9
 ud_0                 4.213290e-01 1 1  ON 10
 ud_1                 1.391763e-01 1 1  ON 11
 ud_2                -7.679201e-03 1 1  ON 12
 ud_3                -8.641745e-02 1 1  ON 13
 ud_4                -1.301537e-01 1 1  ON 14
 ud_5                -1.563032e-01 1 1  ON 15
 ud_6                -1.706356e-01 1 1  ON 16
 ud_7                -1.732024e-01 1 1  ON 17
 ud_8                -1.629378e-01 1 1  ON 18
 ud_9                -1.350755e-01 1 1  ON 19
 eC_0                -5.957445e-01 1 1  ON 20
 eC_1                -4.427370e-01 1 1  ON 21
 eC_2                -1.896792e-01 1 1  ON 22
 eC_3                -3.261786e-02 1 1  ON 23
 eC_4                 5.181438e-02 1 1  ON 24
 eC_5                 1.596400e-01 1 1  ON 25
 eC_6                 2.583950e-01 1 1  ON 26
 eC_7                 3.715122e-01 1 1  ON 27
 eC_8                 3.119770e-01 1 1  ON 28
 eC_9                 9.868461e-02 1 1  ON 29
 eO_0                -1.202254e+00 1 1  ON 30
 eO_1                -8.238327e-01 1 1  ON 31
 eO_2                -3.573906e-01 1 1  ON 32
 eO_3                -1.187437e-02 1 1  ON 33
 eO_4                 2.176477e-01 1 1  ON 34
 eO_5                 3.881802e-01 1 1  ON 35
 eO_6                 4.380181e-01 1 1  ON 36
 eO_7                 4.457751e-01 1 1  ON 37
 eO_8                 4.055749e-01 1 1  ON 38
 eO_9                 3.352493e-01 1 1  ON 39
eH1_0                -2.152036e-01 1 1  ON 40
eH1_1                -1.226101e-01 1 1  ON 41
eH1_2                -8.452197e-02 1 1  ON 42
eH1_3                -6.426320e-02 1 1  ON 43
eH1_4                 7.223657e-03 1 1  ON 44
eH1_5                 5.321050e-02 1 1  ON 45
eH1_6                 8.957487e-02 1 1  ON 46
eH1_7                 6.311521e-02 1 1  ON 47
eH1_8                 2.191680e-02 1 1  ON 48
eH1_9                 5.722639e-02 1 1  ON 49
eH2_0                -2.101783e-01 1 1  ON 50
eH2_1                -1.179566e-01 1 1  ON 51
eH2_2                -7.984990e-02 1 1  ON 52
eH2_3                -5.939662e-02 1 1  ON 53
eH2_4                 1.216366e-02 1 1  ON 54
eH2_5                 5.828581e-02 1 1  ON 55
eH2_6                 9.521070e-02 1 1  ON 56
eH2_7                 6.688926e-02 1 1  ON 57
eH2_8                 2.568558e-02 1 1  ON 58
eH2_9                 5.851979e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6321
    reference variance = 0.721088
====================================================
  Execution time = 4.4020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0878e-01
  Total weights = 2.0000e+06
  Execution time = 3.6748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509014257547
                                         uncertainty =       0.003257857527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509014257547
                                         uncertainty =       0.003257857527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504516523
  error estimate for blocks of size 2^( 2) =       0.000522075799
  error estimate for blocks of size 2^( 3) =       0.000537474389
  error estimate for blocks of size 2^( 4) =       0.000548770068
  error estimate for blocks of size 2^( 5) =       0.000555860308
  error estimate for blocks of size 2^( 6) =       0.000559572949
  error estimate for blocks of size 2^( 7) =       0.000564260364

      target function =                  N/A
              le_mean =     -22.670433537115
             les_mean =     514.457630350985
             stat err =       0.000557115922
             autocorr =       1.219383608354
              std dev =       0.713494109828
             le_variance =       0.509073844759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508723564613
                                         uncertainty =       0.003252159378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508723564613
                                         uncertainty =       0.003252159378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504372041
  error estimate for blocks of size 2^( 2) =       0.000521941096
  error estimate for blocks of size 2^( 3) =       0.000537339039
  error estimate for blocks of size 2^( 4) =       0.000548633112
  error estimate for blocks of size 2^( 5) =       0.000555728648
  error estimate for blocks of size 2^( 6) =       0.000559468749
  error estimate for blocks of size 2^( 7) =       0.000564155932

      target function =                  N/A
              le_mean =     -22.670431788952
             les_mean =     514.457259555358
             stat err =       0.000556996610
             autocorr =       1.219559785385
              std dev =       0.713289781366
             le_variance =       0.508782312201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508450833532
                                         uncertainty =       0.003249206114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508450833532
                                         uncertainty =       0.003249206114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504236719
  error estimate for blocks of size 2^( 2) =       0.000521815727
  error estimate for blocks of size 2^( 3) =       0.000537220293
  error estimate for blocks of size 2^( 4) =       0.000548518058
  error estimate for blocks of size 2^( 5) =       0.000555617100
  error estimate for blocks of size 2^( 6) =       0.000559367537
  error estimate for blocks of size 2^( 7) =       0.000564051509

      target function =                  N/A
              le_mean =     -22.670431925395
             les_mean =     514.456992768103
             stat err =       0.000556888551
             autocorr =       1.219741054716
              std dev =       0.713098407241
             le_variance =       0.508509338410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508833449471
                                         uncertainty =       0.003255572911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508833449471
                                         uncertainty =       0.003255572911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504426807
  error estimate for blocks of size 2^( 2) =       0.000521991392
  error estimate for blocks of size 2^( 3) =       0.000537392482
  error estimate for blocks of size 2^( 4) =       0.000548689263
  error estimate for blocks of size 2^( 5) =       0.000555781239
  error estimate for blocks of size 2^( 6) =       0.000559502045
  error estimate for blocks of size 2^( 7) =       0.000564188391

      target function =                  N/A
              le_mean =     -22.670432008890
             les_mean =     514.457380022750
             stat err =       0.000557040235
             autocorr =       1.219485983744
              std dev =       0.713367231850
             le_variance =       0.508892807477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670433537115        initial  <--
     3.8147e-02     3.8147e-01             2.3831e-03       -22.670431788952
     1.5259e-01     1.5259e+00             8.0458e-04       -22.670431925395
     6.1035e-01     6.1035e+00             2.8101e-04       -22.670432008890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4302
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 3.016837e-01 1 1  ON 0
 uu_1                 1.260074e-01 1 1  ON 1
 uu_2                 1.209386e-02 1 1  ON 2
 uu_3                -5.582575e-02 1 1  ON 3
 uu_4                -9.684504e-02 1 1  ON 4
 uu_5                -1.236622e-01 1 1  ON 5
 uu_6                -1.402146e-01 1 1  ON 6
 uu_7                -1.464118e-01 1 1  ON 7
 uu_8                -1.386613e-01 1 1  ON 8
 uu_9                -1.136559e-01 1 1  ON 9
 ud_0                 4.212712e-01 1 1  ON 10
 ud_1                 1.389195e-01 1 1  ON 11
 ud_2                -7.963186e-03 1 1  ON 12
 ud_3                -8.654665e-02 1 1  ON 13
 ud_4                -1.302033e-01 1 1  ON 14
 ud_5                -1.563403e-01 1 1  ON 15
 ud_6                -1.706833e-01 1 1  ON 16
 ud_7                -1.736021e-01 1 1  ON 17
 ud_8                -1.631156e-01 1 1  ON 18
 ud_9                -1.349769e-01 1 1  ON 19
 eC_0                -5.958004e-01 1 1  ON 20
 eC_1                -4.424556e-01 1 1  ON 21
 eC_2                -1.893901e-01 1 1  ON 22
 eC_3                -3.240347e-02 1 1  ON 23
 eC_4                 5.202333e-02 1 1  ON 24
 eC_5                 1.595490e-01 1 1  ON 25
 eC_6                 2.584333e-01 1 1  ON 26
 eC_7                 3.714358e-01 1 1  ON 27
 eC_8                 3.114216e-01 1 1  ON 28
 eC_9                 9.845352e-02 1 1  ON 29
 eO_0                -1.202085e+00 1 1  ON 30
 eO_1                -8.237166e-01 1 1  ON 31
 eO_2                -3.572913e-01 1 1  ON 32
 eO_3                -1.217866e-02 1 1  ON 33
 eO_4                 2.173404e-01 1 1  ON 34
 eO_5                 3.879578e-01 1 1  ON 35
 eO_6                 4.387993e-01 1 1  ON 36
 eO_7                 4.461602e-01 1 1  ON 37
 eO_8                 4.056112e-01 1 1  ON 38
 eO_9                 3.348560e-01 1 1  ON 39
eH1_0                -2.155539e-01 1 1  ON 40
eH1_1                -1.224713e-01 1 1  ON 41
eH1_2                -8.456957e-02 1 1  ON 42
eH1_3                -6.409636e-02 1 1  ON 43
eH1_4                 7.597211e-03 1 1  ON 44
eH1_5                 5.296663e-02 1 1  ON 45
eH1_6                 9.001620e-02 1 1  ON 46
eH1_7                 6.294936e-02 1 1  ON 47
eH1_8                 2.191751e-02 1 1  ON 48
eH1_9                 5.729892e-02 1 1  ON 49
eH2_0                -2.097486e-01 1 1  ON 50
eH2_1                -1.172260e-01 1 1  ON 51
eH2_2                -7.911264e-02 1 1  ON 52
eH2_3                -5.930263e-02 1 1  ON 53
eH2_4                 1.235004e-02 1 1  ON 54
eH2_5                 5.777118e-02 1 1  ON 55
eH2_6                 9.440612e-02 1 1  ON 56
eH2_7                 6.674631e-02 1 1  ON 57
eH2_8                 2.541375e-02 1 1  ON 58
eH2_9                 5.843312e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2348e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6551
    reference variance = 0.464768
====================================================
  Execution time = 4.4163e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5103e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508788505919
                                         uncertainty =       0.003112419270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508788505919
                                         uncertainty =       0.003112419270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504393331
  error estimate for blocks of size 2^( 2) =       0.000521849703
  error estimate for blocks of size 2^( 3) =       0.000537946123
  error estimate for blocks of size 2^( 4) =       0.000549426026
  error estimate for blocks of size 2^( 5) =       0.000557294167
  error estimate for blocks of size 2^( 6) =       0.000562809511
  error estimate for blocks of size 2^( 7) =       0.000561046852

      target function =                  N/A
              le_mean =     -22.669711311909
             les_mean =     514.424635974727
             stat err =       0.000557644139
             autocorr =       1.222293810784
              std dev =       0.713319888854
             le_variance =       0.508825263835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266971131191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711311909       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711747741       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669712331170       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669712137980       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669712600965       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669712500640       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669712807454       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669712765071       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669713011648       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669712899322       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669712943702       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669712833741       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-01 is 3.641684e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711311909       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711480540       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711688514       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669711655615       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669711826768       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669711775253       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669711858353       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669711812397       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669711834933       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669711835162       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 1.042238e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669711311909       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711360755       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711420183       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669711414677       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669711466146       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669711451908       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669711467918       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669711449544       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669711450145       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669711451745       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 2.728610e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9280e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 3.016863e-01 1 1  ON 0
 uu_1                 1.260917e-01 1 1  ON 1
 uu_2                 1.213819e-02 1 1  ON 2
 uu_3                -5.578598e-02 1 1  ON 3
 uu_4                -9.686427e-02 1 1  ON 4
 uu_5                -1.236891e-01 1 1  ON 5
 uu_6                -1.402698e-01 1 1  ON 6
 uu_7                -1.463626e-01 1 1  ON 7
 uu_8                -1.386897e-01 1 1  ON 8
 uu_9                -1.136679e-01 1 1  ON 9
 ud_0                 4.212568e-01 1 1  ON 10
 ud_1                 1.388594e-01 1 1  ON 11
 ud_2                -7.932833e-03 1 1  ON 12
 ud_3                -8.657013e-02 1 1  ON 13
 ud_4                -1.301671e-01 1 1  ON 14
 ud_5                -1.562841e-01 1 1  ON 15
 ud_6                -1.706008e-01 1 1  ON 16
 ud_7                -1.736610e-01 1 1  ON 17
 ud_8                -1.630444e-01 1 1  ON 18
 ud_9                -1.349447e-01 1 1  ON 19
 eC_0                -5.958415e-01 1 1  ON 20
 eC_1                -4.424661e-01 1 1  ON 21
 eC_2                -1.894038e-01 1 1  ON 22
 eC_3                -3.235288e-02 1 1  ON 23
 eC_4                 5.202455e-02 1 1  ON 24
 eC_5                 1.594966e-01 1 1  ON 25
 eC_6                 2.584451e-01 1 1  ON 26
 eC_7                 3.714236e-01 1 1  ON 27
 eC_8                 3.114601e-01 1 1  ON 28
 eC_9                 9.847899e-02 1 1  ON 29
 eO_0                -1.202115e+00 1 1  ON 30
 eO_1                -8.237298e-01 1 1  ON 31
 eO_2                -3.573025e-01 1 1  ON 32
 eO_3                -1.216176e-02 1 1  ON 33
 eO_4                 2.172657e-01 1 1  ON 34
 eO_5                 3.880086e-01 1 1  ON 35
 eO_6                 4.387419e-01 1 1  ON 36
 eO_7                 4.461723e-01 1 1  ON 37
 eO_8                 4.056327e-01 1 1  ON 38
 eO_9                 3.348950e-01 1 1  ON 39
eH1_0                -2.154878e-01 1 1  ON 40
eH1_1                -1.224859e-01 1 1  ON 41
eH1_2                -8.460640e-02 1 1  ON 42
eH1_3                -6.409017e-02 1 1  ON 43
eH1_4                 7.558626e-03 1 1  ON 44
eH1_5                 5.298346e-02 1 1  ON 45
eH1_6                 9.005227e-02 1 1  ON 46
eH1_7                 6.294022e-02 1 1  ON 47
eH1_8                 2.189914e-02 1 1  ON 48
eH1_9                 5.727317e-02 1 1  ON 49
eH2_0                -2.098528e-01 1 1  ON 50
eH2_1                -1.172047e-01 1 1  ON 51
eH2_2                -7.910887e-02 1 1  ON 52
eH2_3                -5.927605e-02 1 1  ON 53
eH2_4                 1.233491e-02 1 1  ON 54
eH2_5                 5.784421e-02 1 1  ON 55
eH2_6                 9.437770e-02 1 1  ON 56
eH2_7                 6.673570e-02 1 1  ON 57
eH2_8                 2.541651e-02 1 1  ON 58
eH2_9                 5.842965e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6575
    reference variance = 0.357833
====================================================
  Execution time = 4.4304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.3417e-01
  Total weights = 2.0000e+06
  Execution time = 3.6700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534176397957
                                         uncertainty =       0.014731005203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534176397957
                                         uncertainty =       0.014731005203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516823180
  error estimate for blocks of size 2^( 2) =       0.000533922987
  error estimate for blocks of size 2^( 3) =       0.000549869601
  error estimate for blocks of size 2^( 4) =       0.000560549791
  error estimate for blocks of size 2^( 5) =       0.000566128850
  error estimate for blocks of size 2^( 6) =       0.000568490815
  error estimate for blocks of size 2^( 7) =       0.000566996558

      target function =                  N/A
              le_mean =     -22.670747116981
             les_mean =     514.496986973474
             stat err =       0.000565541503
             autocorr =       1.197415833324
              std dev =       0.730898350292
             le_variance =       0.534212398459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534075774960
                                         uncertainty =       0.014742227550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534075774960
                                         uncertainty =       0.014742227550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516774389
  error estimate for blocks of size 2^( 2) =       0.000533878701
  error estimate for blocks of size 2^( 3) =       0.000549828326
  error estimate for blocks of size 2^( 4) =       0.000560512964
  error estimate for blocks of size 2^( 5) =       0.000566095744
  error estimate for blocks of size 2^( 6) =       0.000568461815
  error estimate for blocks of size 2^( 7) =       0.000566971122

      target function =                  N/A
              le_mean =     -22.670747090576
             les_mean =     514.496884915241
             stat err =       0.000565510411
             autocorr =       1.197510268187
              std dev =       0.730829349057
             le_variance =       0.534111537443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534092534169
                                         uncertainty =       0.014742193834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534092534169
                                         uncertainty =       0.014742193834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516782492
  error estimate for blocks of size 2^( 2) =       0.000533886488
  error estimate for blocks of size 2^( 3) =       0.000549835547
  error estimate for blocks of size 2^( 4) =       0.000560519028
  error estimate for blocks of size 2^( 5) =       0.000566101436
  error estimate for blocks of size 2^( 6) =       0.000568466458
  error estimate for blocks of size 2^( 7) =       0.000566973247

      target function =                  N/A
              le_mean =     -22.670746698211
             les_mean =     514.496883874502
             stat err =       0.000565515042
             autocorr =       1.197492328372
              std dev =       0.730840808320
             le_variance =       0.534128287106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534165085675
                                         uncertainty =       0.014732883309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.534165085675
                                         uncertainty =       0.014732883309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516817688
  error estimate for blocks of size 2^( 2) =       0.000533918121
  error estimate for blocks of size 2^( 3) =       0.000549865071
  error estimate for blocks of size 2^( 4) =       0.000560545719
  error estimate for blocks of size 2^( 5) =       0.000566125291
  error estimate for blocks of size 2^( 6) =       0.000568487692
  error estimate for blocks of size 2^( 7) =       0.000566993448

      target function =                  N/A
              le_mean =     -22.670746980664
             les_mean =     514.496969439180
             stat err =       0.000565538037
             autocorr =       1.197426604516
              std dev =       0.730890583458
             le_variance =       0.534201044987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670747116981        initial  <--
     3.8147e-01     3.8147e+00             3.6417e-04       -22.670747090576
     1.5259e+00     1.5259e+01             1.0422e-04       -22.670746698211
     6.1035e+00     6.1035e+01             2.7286e-05       -22.670746980664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7172
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 3.016837e-01 1 1  ON 0
 uu_1                 1.260074e-01 1 1  ON 1
 uu_2                 1.209386e-02 1 1  ON 2
 uu_3                -5.582575e-02 1 1  ON 3
 uu_4                -9.684504e-02 1 1  ON 4
 uu_5                -1.236622e-01 1 1  ON 5
 uu_6                -1.402146e-01 1 1  ON 6
 uu_7                -1.464118e-01 1 1  ON 7
 uu_8                -1.386613e-01 1 1  ON 8
 uu_9                -1.136559e-01 1 1  ON 9
 ud_0                 4.212712e-01 1 1  ON 10
 ud_1                 1.389195e-01 1 1  ON 11
 ud_2                -7.963186e-03 1 1  ON 12
 ud_3                -8.654665e-02 1 1  ON 13
 ud_4                -1.302033e-01 1 1  ON 14
 ud_5                -1.563403e-01 1 1  ON 15
 ud_6                -1.706833e-01 1 1  ON 16
 ud_7                -1.736021e-01 1 1  ON 17
 ud_8                -1.631156e-01 1 1  ON 18
 ud_9                -1.349769e-01 1 1  ON 19
 eC_0                -5.958004e-01 1 1  ON 20
 eC_1                -4.424556e-01 1 1  ON 21
 eC_2                -1.893901e-01 1 1  ON 22
 eC_3                -3.240347e-02 1 1  ON 23
 eC_4                 5.202333e-02 1 1  ON 24
 eC_5                 1.595490e-01 1 1  ON 25
 eC_6                 2.584333e-01 1 1  ON 26
 eC_7                 3.714358e-01 1 1  ON 27
 eC_8                 3.114216e-01 1 1  ON 28
 eC_9                 9.845352e-02 1 1  ON 29
 eO_0                -1.202085e+00 1 1  ON 30
 eO_1                -8.237166e-01 1 1  ON 31
 eO_2                -3.572913e-01 1 1  ON 32
 eO_3                -1.217866e-02 1 1  ON 33
 eO_4                 2.173404e-01 1 1  ON 34
 eO_5                 3.879578e-01 1 1  ON 35
 eO_6                 4.387993e-01 1 1  ON 36
 eO_7                 4.461602e-01 1 1  ON 37
 eO_8                 4.056112e-01 1 1  ON 38
 eO_9                 3.348560e-01 1 1  ON 39
eH1_0                -2.155539e-01 1 1  ON 40
eH1_1                -1.224713e-01 1 1  ON 41
eH1_2                -8.456957e-02 1 1  ON 42
eH1_3                -6.409636e-02 1 1  ON 43
eH1_4                 7.597211e-03 1 1  ON 44
eH1_5                 5.296663e-02 1 1  ON 45
eH1_6                 9.001620e-02 1 1  ON 46
eH1_7                 6.294936e-02 1 1  ON 47
eH1_8                 2.191751e-02 1 1  ON 48
eH1_9                 5.729892e-02 1 1  ON 49
eH2_0                -2.097486e-01 1 1  ON 50
eH2_1                -1.172260e-01 1 1  ON 51
eH2_2                -7.911264e-02 1 1  ON 52
eH2_3                -5.930263e-02 1 1  ON 53
eH2_4                 1.235004e-02 1 1  ON 54
eH2_5                 5.777118e-02 1 1  ON 55
eH2_6                 9.440612e-02 1 1  ON 56
eH2_7                 6.674631e-02 1 1  ON 57
eH2_8                 2.541375e-02 1 1  ON 58
eH2_9                 5.843312e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2201e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6155
    reference variance = 0.483539
====================================================
  Execution time = 4.4869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5200e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511519995619
                                         uncertainty =       0.004255799437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511519995619
                                         uncertainty =       0.004255799437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505726919
  error estimate for blocks of size 2^( 2) =       0.000523313779
  error estimate for blocks of size 2^( 3) =       0.000538609366
  error estimate for blocks of size 2^( 4) =       0.000549127268
  error estimate for blocks of size 2^( 5) =       0.000554256415
  error estimate for blocks of size 2^( 6) =       0.000555056891
  error estimate for blocks of size 2^( 7) =       0.000557658506

      target function =                  N/A
              le_mean =     -22.670477841228
             les_mean =     514.462084727481
             stat err =       0.000554024770
             autocorr =       1.200124279864
              std dev =       0.715205867995
             le_variance =       0.511519433614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267047784123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670477841228       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670477817382       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670477864285       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670477917266       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670477913968       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670477958728       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670477976253       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670477976105       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670477941565       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670477925406       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 5.380815e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670477841228       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670477834973       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670477846953       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670477858953       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670477854343       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670477863094       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670477866093       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670477868268       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670477862393       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670477857366       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.371129e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670477841228       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670477839645       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670477842657       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670477845569       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670477844158       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670477846145       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670477846752       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670477847427       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670477846178       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670477844867       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 3.444949e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0082e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 3.016946e-01 1 1  ON 0
 uu_1                 1.260056e-01 1 1  ON 1
 uu_2                 1.209139e-02 1 1  ON 2
 uu_3                -5.582268e-02 1 1  ON 3
 uu_4                -9.684741e-02 1 1  ON 4
 uu_5                -1.236614e-01 1 1  ON 5
 uu_6                -1.402173e-01 1 1  ON 6
 uu_7                -1.464061e-01 1 1  ON 7
 uu_8                -1.386631e-01 1 1  ON 8
 uu_9                -1.136534e-01 1 1  ON 9
 ud_0                 4.212732e-01 1 1  ON 10
 ud_1                 1.389191e-01 1 1  ON 11
 ud_2                -7.960081e-03 1 1  ON 12
 ud_3                -8.654947e-02 1 1  ON 13
 ud_4                -1.301992e-01 1 1  ON 14
 ud_5                -1.563435e-01 1 1  ON 15
 ud_6                -1.706857e-01 1 1  ON 16
 ud_7                -1.736038e-01 1 1  ON 17
 ud_8                -1.631019e-01 1 1  ON 18
 ud_9                -1.349753e-01 1 1  ON 19
 eC_0                -5.958026e-01 1 1  ON 20
 eC_1                -4.424621e-01 1 1  ON 21
 eC_2                -1.893803e-01 1 1  ON 22
 eC_3                -3.240838e-02 1 1  ON 23
 eC_4                 5.201871e-02 1 1  ON 24
 eC_5                 1.595501e-01 1 1  ON 25
 eC_6                 2.584340e-01 1 1  ON 26
 eC_7                 3.714349e-01 1 1  ON 27
 eC_8                 3.114268e-01 1 1  ON 28
 eC_9                 9.845571e-02 1 1  ON 29
 eO_0                -1.202081e+00 1 1  ON 30
 eO_1                -8.237208e-01 1 1  ON 31
 eO_2                -3.572993e-01 1 1  ON 32
 eO_3                -1.217598e-02 1 1  ON 33
 eO_4                 2.173306e-01 1 1  ON 34
 eO_5                 3.879641e-01 1 1  ON 35
 eO_6                 4.388003e-01 1 1  ON 36
 eO_7                 4.461601e-01 1 1  ON 37
 eO_8                 4.056119e-01 1 1  ON 38
 eO_9                 3.348597e-01 1 1  ON 39
eH1_0                -2.155471e-01 1 1  ON 40
eH1_1                -1.224629e-01 1 1  ON 41
eH1_2                -8.457974e-02 1 1  ON 42
eH1_3                -6.409933e-02 1 1  ON 43
eH1_4                 7.587187e-03 1 1  ON 44
eH1_5                 5.297692e-02 1 1  ON 45
eH1_6                 9.000990e-02 1 1  ON 46
eH1_7                 6.294912e-02 1 1  ON 47
eH1_8                 2.191819e-02 1 1  ON 48
eH1_9                 5.729809e-02 1 1  ON 49
eH2_0                -2.097521e-01 1 1  ON 50
eH2_1                -1.172270e-01 1 1  ON 51
eH2_2                -7.911150e-02 1 1  ON 52
eH2_3                -5.930582e-02 1 1  ON 53
eH2_4                 1.234398e-02 1 1  ON 54
eH2_5                 5.778032e-02 1 1  ON 55
eH2_6                 9.440341e-02 1 1  ON 56
eH2_7                 6.675095e-02 1 1  ON 57
eH2_8                 2.541481e-02 1 1  ON 58
eH2_9                 5.843122e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6614
    reference variance = 0.315746
====================================================
  Execution time = 4.5277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.2159e-01
  Total weights = 2.0000e+06
  Execution time = 3.6642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521518893723
                                         uncertainty =       0.005027487706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521518893723
                                         uncertainty =       0.005027487706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510682380
  error estimate for blocks of size 2^( 2) =       0.000528216904
  error estimate for blocks of size 2^( 3) =       0.000543810130
  error estimate for blocks of size 2^( 4) =       0.000554225010
  error estimate for blocks of size 2^( 5) =       0.000560825252
  error estimate for blocks of size 2^( 6) =       0.000563931084
  error estimate for blocks of size 2^( 7) =       0.000565414017

      target function =                  N/A
              le_mean =     -22.670566045435
             les_mean =     514.476157545959
             stat err =       0.000561098841
             autocorr =       1.207193798729
              std dev =       0.722213947762
             le_variance =       0.521592986341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521522443995
                                         uncertainty =       0.005027169877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521522443995
                                         uncertainty =       0.005027169877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510684127
  error estimate for blocks of size 2^( 2) =       0.000528218929
  error estimate for blocks of size 2^( 3) =       0.000543812346
  error estimate for blocks of size 2^( 4) =       0.000554227539
  error estimate for blocks of size 2^( 5) =       0.000560827936
  error estimate for blocks of size 2^( 6) =       0.000563932923
  error estimate for blocks of size 2^( 7) =       0.000565416428

      target function =                  N/A
              le_mean =     -22.670566500347
             les_mean =     514.476181741864
             stat err =       0.000561101207
             autocorr =       1.207195716252
              std dev =       0.722216419086
             le_variance =       0.521596555997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521520968539
                                         uncertainty =       0.005027333416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521520968539
                                         uncertainty =       0.005027333416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510683401
  error estimate for blocks of size 2^( 2) =       0.000528218059
  error estimate for blocks of size 2^( 3) =       0.000543811385
  error estimate for blocks of size 2^( 4) =       0.000554226443
  error estimate for blocks of size 2^( 5) =       0.000560826790
  error estimate for blocks of size 2^( 6) =       0.000563932139
  error estimate for blocks of size 2^( 7) =       0.000565415438

      target function =                  N/A
              le_mean =     -22.670566286418
             les_mean =     514.476170558090
             stat err =       0.000561100202
             autocorr =       1.207194830318
              std dev =       0.722215391697
             le_variance =       0.521595072003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521519161936
                                         uncertainty =       0.005027468646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521519161936
                                         uncertainty =       0.005027468646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510682512
  error estimate for blocks of size 2^( 2) =       0.000528217052
  error estimate for blocks of size 2^( 3) =       0.000543810291
  error estimate for blocks of size 2^( 4) =       0.000554225194
  error estimate for blocks of size 2^( 5) =       0.000560825450
  error estimate for blocks of size 2^( 6) =       0.000563931220
  error estimate for blocks of size 2^( 7) =       0.000565414201

      target function =                  N/A
              le_mean =     -22.670566075702
             les_mean =     514.476159187906
             stat err =       0.000561099016
             autocorr =       1.207193929648
              std dev =       0.722214134419
             le_variance =       0.521593255954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670566045435        initial
     3.8147e+00     3.8147e+01             5.3808e-05       -22.670566500347  <--
     1.5259e+01     1.5259e+02             1.3711e-05       -22.670566286418
     6.1035e+01     6.1035e+02             3.4449e-06       -22.670566075702

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 6.3677e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 3.017247e-01 1 1  ON 0
 uu_1                 1.260002e-01 1 1  ON 1
 uu_2                 1.208564e-02 1 1  ON 2
 uu_3                -5.581491e-02 1 1  ON 3
 uu_4                -9.685303e-02 1 1  ON 4
 uu_5                -1.236597e-01 1 1  ON 5
 uu_6                -1.402243e-01 1 1  ON 6
 uu_7                -1.463899e-01 1 1  ON 7
 uu_8                -1.386681e-01 1 1  ON 8
 uu_9                -1.136459e-01 1 1  ON 9
 ud_0                 4.212783e-01 1 1  ON 10
 ud_1                 1.389187e-01 1 1  ON 11
 ud_2                -7.952212e-03 1 1  ON 12
 ud_3                -8.655632e-02 1 1  ON 13
 ud_4                -1.301887e-01 1 1  ON 14
 ud_5                -1.563520e-01 1 1  ON 15
 ud_6                -1.706928e-01 1 1  ON 16
 ud_7                -1.736088e-01 1 1  ON 17
 ud_8                -1.630618e-01 1 1  ON 18
 ud_9                -1.349702e-01 1 1  ON 19
 eC_0                -5.958090e-01 1 1  ON 20
 eC_1                -4.424807e-01 1 1  ON 21
 eC_2                -1.893521e-01 1 1  ON 22
 eC_3                -3.242263e-02 1 1  ON 23
 eC_4                 5.200505e-02 1 1  ON 24
 eC_5                 1.595534e-01 1 1  ON 25
 eC_6                 2.584362e-01 1 1  ON 26
 eC_7                 3.714323e-01 1 1  ON 27
 eC_8                 3.114420e-01 1 1  ON 28
 eC_9                 9.846214e-02 1 1  ON 29
 eO_0                -1.202068e+00 1 1  ON 30
 eO_1                -8.237328e-01 1 1  ON 31
 eO_2                -3.573216e-01 1 1  ON 32
 eO_3                -1.216888e-02 1 1  ON 33
 eO_4                 2.173027e-01 1 1  ON 34
 eO_5                 3.879823e-01 1 1  ON 35
 eO_6                 4.388032e-01 1 1  ON 36
 eO_7                 4.461600e-01 1 1  ON 37
 eO_8                 4.056140e-01 1 1  ON 38
 eO_9                 3.348707e-01 1 1  ON 39
eH1_0                -2.155269e-01 1 1  ON 40
eH1_1                -1.224387e-01 1 1  ON 41
eH1_2                -8.460893e-02 1 1  ON 42
eH1_3                -6.410834e-02 1 1  ON 43
eH1_4                 7.558336e-03 1 1  ON 44
eH1_5                 5.300583e-02 1 1  ON 45
eH1_6                 8.999198e-02 1 1  ON 46
eH1_7                 6.294829e-02 1 1  ON 47
eH1_8                 2.192022e-02 1 1  ON 48
eH1_9                 5.729566e-02 1 1  ON 49
eH2_0                -2.097623e-01 1 1  ON 50
eH2_1                -1.172301e-01 1 1  ON 51
eH2_2                -7.910833e-02 1 1  ON 52
eH2_3                -5.931502e-02 1 1  ON 53
eH2_4                 1.232634e-02 1 1  ON 54
eH2_5                 5.780646e-02 1 1  ON 55
eH2_6                 9.439589e-02 1 1  ON 56
eH2_7                 6.676446e-02 1 1  ON 57
eH2_8                 2.541799e-02 1 1  ON 58
eH2_9                 5.842567e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2377e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7169
    reference variance = 0.408102
====================================================
  Execution time = 4.5278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1211e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5144e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512143186787
                                         uncertainty =       0.003262079455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512143186787
                                         uncertainty =       0.003262079455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506020543
  error estimate for blocks of size 2^( 2) =       0.000523631065
  error estimate for blocks of size 2^( 3) =       0.000538567762
  error estimate for blocks of size 2^( 4) =       0.000549664150
  error estimate for blocks of size 2^( 5) =       0.000557085778
  error estimate for blocks of size 2^( 6) =       0.000557795699
  error estimate for blocks of size 2^( 7) =       0.000559588798

      target function =                  N/A
              le_mean =     -22.670003337408
             les_mean =     514.441164641420
             stat err =       0.000556033606
             autocorr =       1.207440628747
              std dev =       0.715621114408
             le_variance =       0.512113579386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267000333741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003337408       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003532164       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003029029       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003137812       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003400551       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670003104868       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670003112901       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670003002038       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670002947764       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670003100523       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.669631e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003337408       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003391911       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003235681       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003250911       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003319594       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670003224001       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670003222189       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670003177033       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670003164419       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670003204380       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 4.995946e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670003337408       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670003351453       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670003309790       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670003312400       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670003329173       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670003303032       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670003301964       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670003288965       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670003286157       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670003295571       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.316122e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0435e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 3.017268e-01 1 1  ON 0
 uu_1                 1.259864e-01 1 1  ON 1
 uu_2                 1.210139e-02 1 1  ON 2
 uu_3                -5.580870e-02 1 1  ON 3
 uu_4                -9.684997e-02 1 1  ON 4
 uu_5                -1.236487e-01 1 1  ON 5
 uu_6                -1.402249e-01 1 1  ON 6
 uu_7                -1.463770e-01 1 1  ON 7
 uu_8                -1.386839e-01 1 1  ON 8
 uu_9                -1.136573e-01 1 1  ON 9
 ud_0                 4.212811e-01 1 1  ON 10
 ud_1                 1.389170e-01 1 1  ON 11
 ud_2                -7.930185e-03 1 1  ON 12
 ud_3                -8.657060e-02 1 1  ON 13
 ud_4                -1.301728e-01 1 1  ON 14
 ud_5                -1.563490e-01 1 1  ON 15
 ud_6                -1.706739e-01 1 1  ON 16
 ud_7                -1.736171e-01 1 1  ON 17
 ud_8                -1.630754e-01 1 1  ON 18
 ud_9                -1.349587e-01 1 1  ON 19
 eC_0                -5.958180e-01 1 1  ON 20
 eC_1                -4.424932e-01 1 1  ON 21
 eC_2                -1.893549e-01 1 1  ON 22
 eC_3                -3.242287e-02 1 1  ON 23
 eC_4                 5.199605e-02 1 1  ON 24
 eC_5                 1.595467e-01 1 1  ON 25
 eC_6                 2.584394e-01 1 1  ON 26
 eC_7                 3.714354e-01 1 1  ON 27
 eC_8                 3.114623e-01 1 1  ON 28
 eC_9                 9.847366e-02 1 1  ON 29
 eO_0                -1.202069e+00 1 1  ON 30
 eO_1                -8.237225e-01 1 1  ON 31
 eO_2                -3.573345e-01 1 1  ON 32
 eO_3                -1.217264e-02 1 1  ON 33
 eO_4                 2.172770e-01 1 1  ON 34
 eO_5                 3.879698e-01 1 1  ON 35
 eO_6                 4.388071e-01 1 1  ON 36
 eO_7                 4.461718e-01 1 1  ON 37
 eO_8                 4.056054e-01 1 1  ON 38
 eO_9                 3.348884e-01 1 1  ON 39
eH1_0                -2.155315e-01 1 1  ON 40
eH1_1                -1.224361e-01 1 1  ON 41
eH1_2                -8.462120e-02 1 1  ON 42
eH1_3                -6.409951e-02 1 1  ON 43
eH1_4                 7.545644e-03 1 1  ON 44
eH1_5                 5.300612e-02 1 1  ON 45
eH1_6                 8.999298e-02 1 1  ON 46
eH1_7                 6.293923e-02 1 1  ON 47
eH1_8                 2.192794e-02 1 1  ON 48
eH1_9                 5.729770e-02 1 1  ON 49
eH2_0                -2.097542e-01 1 1  ON 50
eH2_1                -1.172304e-01 1 1  ON 51
eH2_2                -7.914934e-02 1 1  ON 52
eH2_3                -5.932293e-02 1 1  ON 53
eH2_4                 1.228905e-02 1 1  ON 54
eH2_5                 5.785642e-02 1 1  ON 55
eH2_6                 9.441145e-02 1 1  ON 56
eH2_7                 6.676022e-02 1 1  ON 57
eH2_8                 2.542398e-02 1 1  ON 58
eH2_9                 5.842327e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6979
    reference variance = 0.3077
====================================================
  Execution time = 4.4441e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0709e-01
  Total weights = 2.0000e+06
  Execution time = 3.6160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507094990893
                                         uncertainty =       0.002780593801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507094990893
                                         uncertainty =       0.002780593801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503544665
  error estimate for blocks of size 2^( 2) =       0.000521148320
  error estimate for blocks of size 2^( 3) =       0.000536970622
  error estimate for blocks of size 2^( 4) =       0.000547601790
  error estimate for blocks of size 2^( 5) =       0.000552645515
  error estimate for blocks of size 2^( 6) =       0.000557701999
  error estimate for blocks of size 2^( 7) =       0.000559053987

      target function =                  N/A
              le_mean =     -22.671226666115
             les_mean =     514.491632752303
             stat err =       0.000554250823
             autocorr =       1.211537036105
              std dev =       0.712119694649
             le_variance =       0.507114459507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507017438580
                                         uncertainty =       0.002780362028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507017438580
                                         uncertainty =       0.002780362028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503506136
  error estimate for blocks of size 2^( 2) =       0.000521113365
  error estimate for blocks of size 2^( 3) =       0.000536936494
  error estimate for blocks of size 2^( 4) =       0.000547569323
  error estimate for blocks of size 2^( 5) =       0.000552615919
  error estimate for blocks of size 2^( 6) =       0.000557671439
  error estimate for blocks of size 2^( 7) =       0.000559023666

      target function =                  N/A
              le_mean =     -22.671226848232
             les_mean =     514.491563408759
             stat err =       0.000554220086
             autocorr =       1.211588069918
              std dev =       0.712065206495
             le_variance =       0.507036858301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507041628666
                                         uncertainty =       0.002780485252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507041628666
                                         uncertainty =       0.002780485252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503518155
  error estimate for blocks of size 2^( 2) =       0.000521124313
  error estimate for blocks of size 2^( 3) =       0.000536947196
  error estimate for blocks of size 2^( 4) =       0.000547579591
  error estimate for blocks of size 2^( 5) =       0.000552625155
  error estimate for blocks of size 2^( 6) =       0.000557681137
  error estimate for blocks of size 2^( 7) =       0.000559033616

      target function =                  N/A
              le_mean =     -22.671226711952
             les_mean =     514.491581436843
             stat err =       0.000554229874
             autocorr =       1.211573021420
              std dev =       0.712082204277
             le_variance =       0.507061065648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507087575717
                                         uncertainty =       0.002780581345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507087575717
                                         uncertainty =       0.002780581345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503540982
  error estimate for blocks of size 2^( 2) =       0.000521144983
  error estimate for blocks of size 2^( 3) =       0.000536967365
  error estimate for blocks of size 2^( 4) =       0.000547598707
  error estimate for blocks of size 2^( 5) =       0.000552642682
  error estimate for blocks of size 2^( 6) =       0.000557699102
  error estimate for blocks of size 2^( 7) =       0.000559051175

      target function =                  N/A
              le_mean =     -22.671226662421
             les_mean =     514.491625165438
             stat err =       0.000554247916
             autocorr =       1.211542055581
              std dev =       0.712114485250
             le_variance =       0.507107040103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.671226666115        initial
     9.5367e-01     9.5367e+00             1.6696e-04       -22.671226848232  <--
     3.8147e+00     3.8147e+01             4.9959e-05       -22.671226711952
     1.5259e+01     1.5259e+02             1.3161e-05       -22.671226662421

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 6.2623e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 3.017320e-01 1 1  ON 0
 uu_1                 1.259622e-01 1 1  ON 1
 uu_2                 1.213526e-02 1 1  ON 2
 uu_3                -5.579011e-02 1 1  ON 3
 uu_4                -9.683897e-02 1 1  ON 4
 uu_5                -1.236244e-01 1 1  ON 5
 uu_6                -1.402219e-01 1 1  ON 6
 uu_7                -1.463432e-01 1 1  ON 7
 uu_8                -1.387283e-01 1 1  ON 8
 uu_9                -1.136908e-01 1 1  ON 9
 ud_0                 4.212892e-01 1 1  ON 10
 ud_1                 1.389247e-01 1 1  ON 11
 ud_2                -7.889640e-03 1 1  ON 12
 ud_3                -8.659050e-02 1 1  ON 13
 ud_4                -1.301408e-01 1 1  ON 14
 ud_5                -1.563342e-01 1 1  ON 15
 ud_6                -1.706304e-01 1 1  ON 16
 ud_7                -1.736314e-01 1 1  ON 17
 ud_8                -1.631145e-01 1 1  ON 18
 ud_9                -1.349279e-01 1 1  ON 19
 eC_0                -5.958399e-01 1 1  ON 20
 eC_1                -4.425284e-01 1 1  ON 21
 eC_2                -1.893592e-01 1 1  ON 22
 eC_3                -3.242896e-02 1 1  ON 23
 eC_4                 5.196735e-02 1 1  ON 24
 eC_5                 1.595312e-01 1 1  ON 25
 eC_6                 2.584473e-01 1 1  ON 26
 eC_7                 3.714435e-01 1 1  ON 27
 eC_8                 3.115197e-01 1 1  ON 28
 eC_9                 9.850633e-02 1 1  ON 29
 eO_0                -1.202061e+00 1 1  ON 30
 eO_1                -8.237083e-01 1 1  ON 31
 eO_2                -3.573606e-01 1 1  ON 32
 eO_3                -1.219188e-02 1 1  ON 33
 eO_4                 2.172052e-01 1 1  ON 34
 eO_5                 3.879365e-01 1 1  ON 35
 eO_6                 4.388198e-01 1 1  ON 36
 eO_7                 4.462056e-01 1 1  ON 37
 eO_8                 4.055807e-01 1 1  ON 38
 eO_9                 3.349384e-01 1 1  ON 39
eH1_0                -2.155427e-01 1 1  ON 40
eH1_1                -1.224299e-01 1 1  ON 41
eH1_2                -8.464775e-02 1 1  ON 42
eH1_3                -6.407992e-02 1 1  ON 43
eH1_4                 7.514357e-03 1 1  ON 44
eH1_5                 5.300411e-02 1 1  ON 45
eH1_6                 8.999305e-02 1 1  ON 46
eH1_7                 6.291216e-02 1 1  ON 47
eH1_8                 2.194906e-02 1 1  ON 48
eH1_9                 5.730329e-02 1 1  ON 49
eH2_0                -2.097329e-01 1 1  ON 50
eH2_1                -1.172369e-01 1 1  ON 51
eH2_2                -7.925433e-02 1 1  ON 52
eH2_3                -5.935124e-02 1 1  ON 53
eH2_4                 1.220191e-02 1 1  ON 54
eH2_5                 5.797343e-02 1 1  ON 55
eH2_6                 9.446476e-02 1 1  ON 56
eH2_7                 6.674868e-02 1 1  ON 57
eH2_8                 2.543980e-02 1 1  ON 58
eH2_9                 5.841614e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2307e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6813
    reference variance = 0.257151
====================================================
  Execution time = 4.4238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5315e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513982064214
                                         uncertainty =       0.005499114119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513982064214
                                         uncertainty =       0.005499114119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506913707
  error estimate for blocks of size 2^( 2) =       0.000524440011
  error estimate for blocks of size 2^( 3) =       0.000540027686
  error estimate for blocks of size 2^( 4) =       0.000551069501
  error estimate for blocks of size 2^( 5) =       0.000558015084
  error estimate for blocks of size 2^( 6) =       0.000562944741
  error estimate for blocks of size 2^( 7) =       0.000566551146

      target function =                  N/A
              le_mean =     -22.670137847351
             les_mean =     514.449072773805
             stat err =       0.000559645118
             autocorr =       1.218869948815
              std dev =       0.716884239523
             le_variance =       0.513923012877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267013784735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670137847351       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670136324961       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670137408149       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670138337894       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670138786153       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670138615983       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670137972692       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670138173075       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670138149318       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670138074878       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670138031561       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670138064742       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 3.209613e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670137847351       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670137256377       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670137635735       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670138091008       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670138317806       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670138038837       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670137958061       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670137846679       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670137920082       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670137944713       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670137937418       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.133343e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670137847351       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670137675917       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670137781306       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670137932982       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670138006732       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670137904114       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670137898944       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670137864089       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670137873320       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670137884634       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670137882982       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 3.511623e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9567e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 3.018390e-01 1 1  ON 0
 uu_1                 1.260270e-01 1 1  ON 1
 uu_2                 1.211696e-02 1 1  ON 2
 uu_3                -5.573658e-02 1 1  ON 3
 uu_4                -9.688793e-02 1 1  ON 4
 uu_5                -1.237377e-01 1 1  ON 5
 uu_6                -1.401245e-01 1 1  ON 6
 uu_7                -1.463333e-01 1 1  ON 7
 uu_8                -1.387751e-01 1 1  ON 8
 uu_9                -1.136701e-01 1 1  ON 9
 ud_0                 4.213780e-01 1 1  ON 10
 ud_1                 1.389662e-01 1 1  ON 11
 ud_2                -7.901506e-03 1 1  ON 12
 ud_3                -8.658228e-02 1 1  ON 13
 ud_4                -1.301447e-01 1 1  ON 14
 ud_5                -1.562807e-01 1 1  ON 15
 ud_6                -1.705937e-01 1 1  ON 16
 ud_7                -1.736485e-01 1 1  ON 17
 ud_8                -1.631030e-01 1 1  ON 18
 ud_9                -1.349514e-01 1 1  ON 19
 eC_0                -5.957613e-01 1 1  ON 20
 eC_1                -4.425863e-01 1 1  ON 21
 eC_2                -1.894314e-01 1 1  ON 22
 eC_3                -3.244263e-02 1 1  ON 23
 eC_4                 5.196668e-02 1 1  ON 24
 eC_5                 1.594930e-01 1 1  ON 25
 eC_6                 2.584651e-01 1 1  ON 26
 eC_7                 3.714262e-01 1 1  ON 27
 eC_8                 3.115713e-01 1 1  ON 28
 eC_9                 9.855343e-02 1 1  ON 29
 eO_0                -1.202126e+00 1 1  ON 30
 eO_1                -8.237153e-01 1 1  ON 31
 eO_2                -3.573655e-01 1 1  ON 32
 eO_3                -1.218716e-02 1 1  ON 33
 eO_4                 2.172298e-01 1 1  ON 34
 eO_5                 3.878706e-01 1 1  ON 35
 eO_6                 4.387780e-01 1 1  ON 36
 eO_7                 4.462232e-01 1 1  ON 37
 eO_8                 4.055880e-01 1 1  ON 38
 eO_9                 3.350058e-01 1 1  ON 39
eH1_0                -2.155291e-01 1 1  ON 40
eH1_1                -1.223795e-01 1 1  ON 41
eH1_2                -8.474736e-02 1 1  ON 42
eH1_3                -6.409188e-02 1 1  ON 43
eH1_4                 7.411541e-03 1 1  ON 44
eH1_5                 5.309101e-02 1 1  ON 45
eH1_6                 9.003811e-02 1 1  ON 46
eH1_7                 6.286309e-02 1 1  ON 47
eH1_8                 2.196904e-02 1 1  ON 48
eH1_9                 5.729964e-02 1 1  ON 49
eH2_0                -2.096681e-01 1 1  ON 50
eH2_1                -1.172247e-01 1 1  ON 51
eH2_2                -7.936258e-02 1 1  ON 52
eH2_3                -5.933447e-02 1 1  ON 53
eH2_4                 1.228676e-02 1 1  ON 54
eH2_5                 5.789177e-02 1 1  ON 55
eH2_6                 9.444208e-02 1 1  ON 56
eH2_7                 6.676989e-02 1 1  ON 57
eH2_8                 2.544053e-02 1 1  ON 58
eH2_9                 5.838188e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5792
    reference variance = 0.299233
====================================================
  Execution time = 4.3416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1831e-01
  Total weights = 2.0000e+06
  Execution time = 3.6293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518197628627
                                         uncertainty =       0.008956281295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518197628627
                                         uncertainty =       0.008956281295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508973739
  error estimate for blocks of size 2^( 2) =       0.000527033432
  error estimate for blocks of size 2^( 3) =       0.000542473996
  error estimate for blocks of size 2^( 4) =       0.000555012769
  error estimate for blocks of size 2^( 5) =       0.000562278013
  error estimate for blocks of size 2^( 6) =       0.000563597212
  error estimate for blocks of size 2^( 7) =       0.000566520601

      target function =                  N/A
              le_mean =     -22.670183948130
             les_mean =     514.455348516110
             stat err =       0.000561852149
             autocorr =       1.218578027596
              std dev =       0.719797563981
             le_variance =       0.518108533113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518655371500
                                         uncertainty =       0.008964568408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518655371500
                                         uncertainty =       0.008964568408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509198494
  error estimate for blocks of size 2^( 2) =       0.000527248850
  error estimate for blocks of size 2^( 3) =       0.000542675323
  error estimate for blocks of size 2^( 4) =       0.000555198344
  error estimate for blocks of size 2^( 5) =       0.000562445735
  error estimate for blocks of size 2^( 6) =       0.000563765521
  error estimate for blocks of size 2^( 7) =       0.000566675348

      target function =                  N/A
              le_mean =     -22.670186662493
             les_mean =     514.455929265954
             stat err =       0.000562021237
             autocorr =       1.218235447134
              std dev =       0.720115416432
             le_variance =       0.518566212983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518594538603
                                         uncertainty =       0.008962455813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518594538603
                                         uncertainty =       0.008962455813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509168633
  error estimate for blocks of size 2^( 2) =       0.000527219832
  error estimate for blocks of size 2^( 3) =       0.000542648171
  error estimate for blocks of size 2^( 4) =       0.000555172801
  error estimate for blocks of size 2^( 5) =       0.000562422286
  error estimate for blocks of size 2^( 6) =       0.000563741271
  error estimate for blocks of size 2^( 7) =       0.000566651307

      target function =                  N/A
              le_mean =     -22.670186221451
             les_mean =     514.455848449361
             stat err =       0.000561996916
             autocorr =       1.218272896628
              std dev =       0.720073186096
             le_variance =       0.518505393335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518258787288
                                         uncertainty =       0.008957113813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518258787288
                                         uncertainty =       0.008957113813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509003774
  error estimate for blocks of size 2^( 2) =       0.000527062067
  error estimate for blocks of size 2^( 3) =       0.000542500698
  error estimate for blocks of size 2^( 4) =       0.000555037182
  error estimate for blocks of size 2^( 5) =       0.000562299978
  error estimate for blocks of size 2^( 6) =       0.000563619013
  error estimate for blocks of size 2^( 7) =       0.000566540165

      target function =                  N/A
              le_mean =     -22.670184215673
             les_mean =     514.455421797967
             stat err =       0.000561874085
             autocorr =       1.218529359921
              std dev =       0.719840040924
             le_variance =       0.518169684517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670183948130        initial
     2.3842e-01     2.3842e+00             3.2096e-04       -22.670186662493  <--
     9.5367e-01     9.5367e+00             1.1333e-04       -22.670186221451
     3.8147e+00     3.8147e+01             3.5116e-05       -22.670184215673

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 6.1675e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 3.020530e-01 1 1  ON 0
 uu_1                 1.261169e-01 1 1  ON 1
 uu_2                 1.215084e-02 1 1  ON 2
 uu_3                -5.568349e-02 1 1  ON 3
 uu_4                -9.694538e-02 1 1  ON 4
 uu_5                -1.238644e-01 1 1  ON 5
 uu_6                -1.400353e-01 1 1  ON 6
 uu_7                -1.462587e-01 1 1  ON 7
 uu_8                -1.388598e-01 1 1  ON 8
 uu_9                -1.136091e-01 1 1  ON 9
 ud_0                 4.215117e-01 1 1  ON 10
 ud_1                 1.390543e-01 1 1  ON 11
 ud_2                -7.876914e-03 1 1  ON 12
 ud_3                -8.655243e-02 1 1  ON 13
 ud_4                -1.301080e-01 1 1  ON 14
 ud_5                -1.561830e-01 1 1  ON 15
 ud_6                -1.704927e-01 1 1  ON 16
 ud_7                -1.736316e-01 1 1  ON 17
 ud_8                -1.630651e-01 1 1  ON 18
 ud_9                -1.350117e-01 1 1  ON 19
 eC_0                -5.956184e-01 1 1  ON 20
 eC_1                -4.427296e-01 1 1  ON 21
 eC_2                -1.895624e-01 1 1  ON 22
 eC_3                -3.249807e-02 1 1  ON 23
 eC_4                 5.194647e-02 1 1  ON 24
 eC_5                 1.594058e-01 1 1  ON 25
 eC_6                 2.585189e-01 1 1  ON 26
 eC_7                 3.713800e-01 1 1  ON 27
 eC_8                 3.117144e-01 1 1  ON 28
 eC_9                 9.868386e-02 1 1  ON 29
 eO_0                -1.202274e+00 1 1  ON 30
 eO_1                -8.237356e-01 1 1  ON 31
 eO_2                -3.573906e-01 1 1  ON 32
 eO_3                -1.218190e-02 1 1  ON 33
 eO_4                 2.172269e-01 1 1  ON 34
 eO_5                 3.877141e-01 1 1  ON 35
 eO_6                 4.386823e-01 1 1  ON 36
 eO_7                 4.462793e-01 1 1  ON 37
 eO_8                 4.056115e-01 1 1  ON 38
 eO_9                 3.351931e-01 1 1  ON 39
eH1_0                -2.155168e-01 1 1  ON 40
eH1_1                -1.223110e-01 1 1  ON 41
eH1_2                -8.491854e-02 1 1  ON 42
eH1_3                -6.416664e-02 1 1  ON 43
eH1_4                 7.260723e-03 1 1  ON 44
eH1_5                 5.319880e-02 1 1  ON 45
eH1_6                 9.017250e-02 1 1  ON 46
eH1_7                 6.275236e-02 1 1  ON 47
eH1_8                 2.202211e-02 1 1  ON 48
eH1_9                 5.728918e-02 1 1  ON 49
eH2_0                -2.095364e-01 1 1  ON 50
eH2_1                -1.172333e-01 1 1  ON 51
eH2_2                -7.954516e-02 1 1  ON 52
eH2_3                -5.930523e-02 1 1  ON 53
eH2_4                 1.241459e-02 1 1  ON 54
eH2_5                 5.778563e-02 1 1  ON 55
eH2_6                 9.436308e-02 1 1  ON 56
eH2_7                 6.682073e-02 1 1  ON 57
eH2_8                 2.544334e-02 1 1  ON 58
eH2_9                 5.828767e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2125e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7136
    reference variance = 0.25477
====================================================
  Execution time = 4.5128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5386e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528837387296
                                         uncertainty =       0.009204545275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.528837387296
                                         uncertainty =       0.009204545275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514216064
  error estimate for blocks of size 2^( 2) =       0.000531613103
  error estimate for blocks of size 2^( 3) =       0.000547616279
  error estimate for blocks of size 2^( 4) =       0.000558847761
  error estimate for blocks of size 2^( 5) =       0.000566917856
  error estimate for blocks of size 2^( 6) =       0.000569298883
  error estimate for blocks of size 2^( 7) =       0.000572722197

      target function =                  N/A
              le_mean =     -22.669101489233
             les_mean =     514.416998386194
             stat err =       0.000566946674
             autocorr =       1.215606865177
              std dev =       0.727211332068
             le_variance =       0.528836321488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266910148923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669101489233       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669100447530       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669100694306       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669098814391       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669099528098       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669098889366       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669100041755       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669099082986       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669100879159       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669100340636       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669100184534       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669100293446       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669100821375       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669100994754       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.669100753117       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.669100478937       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.669100990283       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.669100920985       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 1.551575e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669101489233       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669100840893       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669101120603       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669099455849       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669099971456       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669099609604       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669100064690       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669099665178       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669100248540       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669100079904       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669100200362       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669100148184       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 5.471942e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669101489233       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669101230977       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669101345946       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669100518620       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669100624418       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669100650376       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669100729143       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669100563269       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669100679918       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669100635228       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.487081e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0530e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 3.020629e-01 1 1  ON 0
 uu_1                 1.259950e-01 1 1  ON 1
 uu_2                 1.222741e-02 1 1  ON 2
 uu_3                -5.566617e-02 1 1  ON 3
 uu_4                -9.679641e-02 1 1  ON 4
 uu_5                -1.235495e-01 1 1  ON 5
 uu_6                -1.400560e-01 1 1  ON 6
 uu_7                -1.459174e-01 1 1  ON 7
 uu_8                -1.389771e-01 1 1  ON 8
 uu_9                -1.138532e-01 1 1  ON 9
 ud_0                 4.216929e-01 1 1  ON 10
 ud_1                 1.391384e-01 1 1  ON 11
 ud_2                -7.640583e-03 1 1  ON 12
 ud_3                -8.646751e-02 1 1  ON 13
 ud_4                -1.301470e-01 1 1  ON 14
 ud_5                -1.561755e-01 1 1  ON 15
 ud_6                -1.705129e-01 1 1  ON 16
 ud_7                -1.735969e-01 1 1  ON 17
 ud_8                -1.628046e-01 1 1  ON 18
 ud_9                -1.350549e-01 1 1  ON 19
 eC_0                -5.957138e-01 1 1  ON 20
 eC_1                -4.428084e-01 1 1  ON 21
 eC_2                -1.898327e-01 1 1  ON 22
 eC_3                -3.278278e-02 1 1  ON 23
 eC_4                 5.185691e-02 1 1  ON 24
 eC_5                 1.595671e-01 1 1  ON 25
 eC_6                 2.587928e-01 1 1  ON 26
 eC_7                 3.713158e-01 1 1  ON 27
 eC_8                 3.119736e-01 1 1  ON 28
 eC_9                 9.885054e-02 1 1  ON 29
 eO_0                -1.201936e+00 1 1  ON 30
 eO_1                -8.238715e-01 1 1  ON 31
 eO_2                -3.574486e-01 1 1  ON 32
 eO_3                -1.221057e-02 1 1  ON 33
 eO_4                 2.171927e-01 1 1  ON 34
 eO_5                 3.875233e-01 1 1  ON 35
 eO_6                 4.385505e-01 1 1  ON 36
 eO_7                 4.461724e-01 1 1  ON 37
 eO_8                 4.055136e-01 1 1  ON 38
 eO_9                 3.353570e-01 1 1  ON 39
eH1_0                -2.160196e-01 1 1  ON 40
eH1_1                -1.222678e-01 1 1  ON 41
eH1_2                -8.490107e-02 1 1  ON 42
eH1_3                -6.434572e-02 1 1  ON 43
eH1_4                 7.321944e-03 1 1  ON 44
eH1_5                 5.320829e-02 1 1  ON 45
eH1_6                 8.997693e-02 1 1  ON 46
eH1_7                 6.305819e-02 1 1  ON 47
eH1_8                 2.222979e-02 1 1  ON 48
eH1_9                 5.729217e-02 1 1  ON 49
eH2_0                -2.098550e-01 1 1  ON 50
eH2_1                -1.175318e-01 1 1  ON 51
eH2_2                -7.963842e-02 1 1  ON 52
eH2_3                -5.946561e-02 1 1  ON 53
eH2_4                 1.228205e-02 1 1  ON 54
eH2_5                 5.790652e-02 1 1  ON 55
eH2_6                 9.452383e-02 1 1  ON 56
eH2_7                 6.736792e-02 1 1  ON 57
eH2_8                 2.561625e-02 1 1  ON 58
eH2_9                 5.813805e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6297
    reference variance = 0.395301
====================================================
  Execution time = 4.4024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1519e-01
  Total weights = 2.0000e+06
  Execution time = 3.6189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515502207738
                                         uncertainty =       0.003601382317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515502207738
                                         uncertainty =       0.003601382317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507640004
  error estimate for blocks of size 2^( 2) =       0.000525357426
  error estimate for blocks of size 2^( 3) =       0.000540950246
  error estimate for blocks of size 2^( 4) =       0.000551486625
  error estimate for blocks of size 2^( 5) =       0.000558561649
  error estimate for blocks of size 2^( 6) =       0.000561419800
  error estimate for blocks of size 2^( 7) =       0.000564819937

      target function =                  N/A
              le_mean =     -22.670007729544
             les_mean =     514.444646947662
             stat err =       0.000559072003
             autocorr =       1.212896688557
              std dev =       0.717911378789
             le_variance =       0.515396747795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515164413176
                                         uncertainty =       0.003600787248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515164413176
                                         uncertainty =       0.003600787248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507473639
  error estimate for blocks of size 2^( 2) =       0.000525200965
  error estimate for blocks of size 2^( 3) =       0.000540808872
  error estimate for blocks of size 2^( 4) =       0.000551350932
  error estimate for blocks of size 2^( 5) =       0.000558439370
  error estimate for blocks of size 2^( 6) =       0.000561293271
  error estimate for blocks of size 2^( 7) =       0.000564704520

      target function =                  N/A
              le_mean =     -22.670006938755
             les_mean =     514.444273334025
             stat err =       0.000558947023
             autocorr =       1.213149490819
              std dev =       0.717676102680
             le_variance =       0.515058988358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515099400159
                                         uncertainty =       0.003600815455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515099400159
                                         uncertainty =       0.003600815455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507441579
  error estimate for blocks of size 2^( 2) =       0.000525172530
  error estimate for blocks of size 2^( 3) =       0.000540785117
  error estimate for blocks of size 2^( 4) =       0.000551327603
  error estimate for blocks of size 2^( 5) =       0.000558417857
  error estimate for blocks of size 2^( 6) =       0.000561270606
  error estimate for blocks of size 2^( 7) =       0.000564681490

      target function =                  N/A
              le_mean =     -22.670007958246
             les_mean =     514.444254482574
             stat err =       0.000558924389
             autocorr =       1.213204522902
              std dev =       0.717630763791
             le_variance =       0.514993913139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515424791585
                                         uncertainty =       0.003601368898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515424791585
                                         uncertainty =       0.003601368898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507601866
  error estimate for blocks of size 2^( 2) =       0.000525322158
  error estimate for blocks of size 2^( 3) =       0.000540919238
  error estimate for blocks of size 2^( 4) =       0.000551456763
  error estimate for blocks of size 2^( 5) =       0.000558534921
  error estimate for blocks of size 2^( 6) =       0.000561391899
  error estimate for blocks of size 2^( 7) =       0.000564794583

      target function =                  N/A
              le_mean =     -22.670007527581
             les_mean =     514.444560352492
             stat err =       0.000559044542
             autocorr =       1.212959784989
              std dev =       0.717857443761
             le_variance =       0.515319309562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670007729544        initial
     5.9605e-02     5.9605e-01             1.5516e-03       -22.670006938755
     2.3842e-01     2.3842e+00             5.4719e-04       -22.670007958246  <--
     9.5367e-01     9.5367e+00             1.4871e-04       -22.670007527581

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 6.2245e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 3.020629e-01 1 1  ON 0
 uu_1                 1.259950e-01 1 1  ON 1
 uu_2                 1.222741e-02 1 1  ON 2
 uu_3                -5.566617e-02 1 1  ON 3
 uu_4                -9.679641e-02 1 1  ON 4
 uu_5                -1.235495e-01 1 1  ON 5
 uu_6                -1.400560e-01 1 1  ON 6
 uu_7                -1.459174e-01 1 1  ON 7
 uu_8                -1.389771e-01 1 1  ON 8
 uu_9                -1.138532e-01 1 1  ON 9
 ud_0                 4.216929e-01 1 1  ON 10
 ud_1                 1.391384e-01 1 1  ON 11
 ud_2                -7.640583e-03 1 1  ON 12
 ud_3                -8.646751e-02 1 1  ON 13
 ud_4                -1.301470e-01 1 1  ON 14
 ud_5                -1.561755e-01 1 1  ON 15
 ud_6                -1.705129e-01 1 1  ON 16
 ud_7                -1.735969e-01 1 1  ON 17
 ud_8                -1.628046e-01 1 1  ON 18
 ud_9                -1.350549e-01 1 1  ON 19
 eC_0                -5.957138e-01 1 1  ON 20
 eC_1                -4.428084e-01 1 1  ON 21
 eC_2                -1.898327e-01 1 1  ON 22
 eC_3                -3.278278e-02 1 1  ON 23
 eC_4                 5.185691e-02 1 1  ON 24
 eC_5                 1.595671e-01 1 1  ON 25
 eC_6                 2.587928e-01 1 1  ON 26
 eC_7                 3.713158e-01 1 1  ON 27
 eC_8                 3.119736e-01 1 1  ON 28
 eC_9                 9.885054e-02 1 1  ON 29
 eO_0                -1.201936e+00 1 1  ON 30
 eO_1                -8.238715e-01 1 1  ON 31
 eO_2                -3.574486e-01 1 1  ON 32
 eO_3                -1.221057e-02 1 1  ON 33
 eO_4                 2.171927e-01 1 1  ON 34
 eO_5                 3.875233e-01 1 1  ON 35
 eO_6                 4.385505e-01 1 1  ON 36
 eO_7                 4.461724e-01 1 1  ON 37
 eO_8                 4.055136e-01 1 1  ON 38
 eO_9                 3.353570e-01 1 1  ON 39
eH1_0                -2.160196e-01 1 1  ON 40
eH1_1                -1.222678e-01 1 1  ON 41
eH1_2                -8.490107e-02 1 1  ON 42
eH1_3                -6.434572e-02 1 1  ON 43
eH1_4                 7.321944e-03 1 1  ON 44
eH1_5                 5.320829e-02 1 1  ON 45
eH1_6                 8.997693e-02 1 1  ON 46
eH1_7                 6.305819e-02 1 1  ON 47
eH1_8                 2.222979e-02 1 1  ON 48
eH1_9                 5.729217e-02 1 1  ON 49
eH2_0                -2.098550e-01 1 1  ON 50
eH2_1                -1.175318e-01 1 1  ON 51
eH2_2                -7.963842e-02 1 1  ON 52
eH2_3                -5.946561e-02 1 1  ON 53
eH2_4                 1.228205e-02 1 1  ON 54
eH2_5                 5.790652e-02 1 1  ON 55
eH2_6                 9.452383e-02 1 1  ON 56
eH2_7                 6.736792e-02 1 1  ON 57
eH2_8                 2.561625e-02 1 1  ON 58
eH2_9                 5.813805e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6404
    reference variance = 0.393927
====================================================
  Execution time = 4.4710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.3730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.537398370394
                                         uncertainty =       0.025198973336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.537398370394
                                         uncertainty =       0.025198973336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000518314676
  error estimate for blocks of size 2^( 2) =       0.000535707233
  error estimate for blocks of size 2^( 3) =       0.000550728090
  error estimate for blocks of size 2^( 4) =       0.000560857755
  error estimate for blocks of size 2^( 5) =       0.000566636543
  error estimate for blocks of size 2^( 6) =       0.000568355891
  error estimate for blocks of size 2^( 7) =       0.000572813589

      target function =                  N/A
              le_mean =     -22.669710543326
             les_mean =     514.453076055263
             stat err =       0.000567165945
             autocorr =       1.197383530757
              std dev =       0.733007643692
             le_variance =       0.537300205711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266971054333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669710543326       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669713050544       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669715169433       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669716607881       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669716173329       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669715215465       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669714910741       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669714570528       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669714862272       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669714888718       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669715002949       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669715309180       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669715462992       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.669715482990       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.669715382786       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.669715727698       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.669715726986       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 1.338188e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669710543326       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669712043320       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669713214672       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669714439200       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669714503092       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669713897996       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669713779481       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669713634377       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669713714216       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669713754727       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669713739790       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.669713766144       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.669713795794       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 3.613408e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669710543326       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669711118715       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669711578217       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669712187613       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669712403938       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669712236290       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669712173442       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669712118806       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669712155020       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669712177559       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669712157575       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.334272e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9835e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 3.020542e-01 1 1  ON 0
 uu_1                 1.263284e-01 1 1  ON 1
 uu_2                 1.231265e-02 1 1  ON 2
 uu_3                -5.545790e-02 1 1  ON 3
 uu_4                -9.673209e-02 1 1  ON 4
 uu_5                -1.235304e-01 1 1  ON 5
 uu_6                -1.401005e-01 1 1  ON 6
 uu_7                -1.458977e-01 1 1  ON 7
 uu_8                -1.390553e-01 1 1  ON 8
 uu_9                -1.140849e-01 1 1  ON 9
 ud_0                 4.216809e-01 1 1  ON 10
 ud_1                 1.392595e-01 1 1  ON 11
 ud_2                -7.676491e-03 1 1  ON 12
 ud_3                -8.653754e-02 1 1  ON 13
 ud_4                -1.300759e-01 1 1  ON 14
 ud_5                -1.562496e-01 1 1  ON 15
 ud_6                -1.702590e-01 1 1  ON 16
 ud_7                -1.735840e-01 1 1  ON 17
 ud_8                -1.625748e-01 1 1  ON 18
 ud_9                -1.349374e-01 1 1  ON 19
 eC_0                -5.956945e-01 1 1  ON 20
 eC_1                -4.431255e-01 1 1  ON 21
 eC_2                -1.898784e-01 1 1  ON 22
 eC_3                -3.267472e-02 1 1  ON 23
 eC_4                 5.206114e-02 1 1  ON 24
 eC_5                 1.593506e-01 1 1  ON 25
 eC_6                 2.584545e-01 1 1  ON 26
 eC_7                 3.713625e-01 1 1  ON 27
 eC_8                 3.123086e-01 1 1  ON 28
 eC_9                 9.903122e-02 1 1  ON 29
 eO_0                -1.202247e+00 1 1  ON 30
 eO_1                -8.239190e-01 1 1  ON 31
 eO_2                -3.575542e-01 1 1  ON 32
 eO_3                -1.242899e-02 1 1  ON 33
 eO_4                 2.171402e-01 1 1  ON 34
 eO_5                 3.878240e-01 1 1  ON 35
 eO_6                 4.386065e-01 1 1  ON 36
 eO_7                 4.459419e-01 1 1  ON 37
 eO_8                 4.055533e-01 1 1  ON 38
 eO_9                 3.355759e-01 1 1  ON 39
eH1_0                -2.157057e-01 1 1  ON 40
eH1_1                -1.223505e-01 1 1  ON 41
eH1_2                -8.470662e-02 1 1  ON 42
eH1_3                -6.444529e-02 1 1  ON 43
eH1_4                 7.254868e-03 1 1  ON 44
eH1_5                 5.312783e-02 1 1  ON 45
eH1_6                 8.977902e-02 1 1  ON 46
eH1_7                 6.289117e-02 1 1  ON 47
eH1_8                 2.227366e-02 1 1  ON 48
eH1_9                 5.725449e-02 1 1  ON 49
eH2_0                -2.102163e-01 1 1  ON 50
eH2_1                -1.173472e-01 1 1  ON 51
eH2_2                -7.979020e-02 1 1  ON 52
eH2_3                -5.948980e-02 1 1  ON 53
eH2_4                 1.229764e-02 1 1  ON 54
eH2_5                 5.795791e-02 1 1  ON 55
eH2_6                 9.453856e-02 1 1  ON 56
eH2_7                 6.734386e-02 1 1  ON 57
eH2_8                 2.567616e-02 1 1  ON 58
eH2_9                 5.815463e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6908
    reference variance = 0.525192
====================================================
  Execution time = 4.3844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2768e-01
  Total weights = 2.0000e+06
  Execution time = 3.6345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527704982581
                                         uncertainty =       0.008395096824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527704982581
                                         uncertainty =       0.008395096824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513591285
  error estimate for blocks of size 2^( 2) =       0.000531149125
  error estimate for blocks of size 2^( 3) =       0.000546508435
  error estimate for blocks of size 2^( 4) =       0.000556938940
  error estimate for blocks of size 2^( 5) =       0.000563162912
  error estimate for blocks of size 2^( 6) =       0.000565955916
  error estimate for blocks of size 2^( 7) =       0.000568488622

      target function =                  N/A
              le_mean =     -22.670386819800
             les_mean =     514.473990311042
             stat err =       0.000563636597
             autocorr =       1.204378732222
              std dev =       0.726327760343
             le_variance =       0.527552015445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527997347032
                                         uncertainty =       0.008393824764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527997347032
                                         uncertainty =       0.008393824764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513733430
  error estimate for blocks of size 2^( 2) =       0.000531283172
  error estimate for blocks of size 2^( 3) =       0.000546632209
  error estimate for blocks of size 2^( 4) =       0.000557051258
  error estimate for blocks of size 2^( 5) =       0.000563270020
  error estimate for blocks of size 2^( 6) =       0.000566052115
  error estimate for blocks of size 2^( 7) =       0.000568588780

      target function =                  N/A
              le_mean =     -22.670385711156
             les_mean =     514.474232102531
             stat err =       0.000563740543
             autocorr =       1.204156363162
              std dev =       0.726528783908
             le_variance =       0.527844073847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527976253006
                                         uncertainty =       0.008393969473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527976253006
                                         uncertainty =       0.008393969473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513723168
  error estimate for blocks of size 2^( 2) =       0.000531271908
  error estimate for blocks of size 2^( 3) =       0.000546620968
  error estimate for blocks of size 2^( 4) =       0.000557039329
  error estimate for blocks of size 2^( 5) =       0.000563256583
  error estimate for blocks of size 2^( 6) =       0.000566034285
  error estimate for blocks of size 2^( 7) =       0.000568565249

      target function =                  N/A
              le_mean =     -22.670386959758
             les_mean =     514.474267627763
             stat err =       0.000563723861
             autocorr =       1.204133203699
              std dev =       0.726514271378
             le_variance =       0.527822986516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527736478666
                                         uncertainty =       0.008394532468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527736478666
                                         uncertainty =       0.008394532468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513606592
  error estimate for blocks of size 2^( 2) =       0.000531162572
  error estimate for blocks of size 2^( 3) =       0.000546520140
  error estimate for blocks of size 2^( 4) =       0.000556948426
  error estimate for blocks of size 2^( 5) =       0.000563171091
  error estimate for blocks of size 2^( 6) =       0.000565960141
  error estimate for blocks of size 2^( 7) =       0.000568491416

      target function =                  N/A
              le_mean =     -22.670386632810
             les_mean =     514.474013279726
             stat err =       0.000563642769
             autocorr =       1.204333316368
              std dev =       0.726349407962
             le_variance =       0.527583462447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670386819800        initial
     5.9605e-02     5.9605e-01             1.3382e-03       -22.670385711156
     2.3842e-01     2.3842e+00             3.6134e-04       -22.670386959758  <--
     9.5367e-01     9.5367e+00             1.3343e-04       -22.670386632810

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 6.2090e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 3.020542e-01 1 1  ON 0
 uu_1                 1.263284e-01 1 1  ON 1
 uu_2                 1.231265e-02 1 1  ON 2
 uu_3                -5.545790e-02 1 1  ON 3
 uu_4                -9.673209e-02 1 1  ON 4
 uu_5                -1.235304e-01 1 1  ON 5
 uu_6                -1.401005e-01 1 1  ON 6
 uu_7                -1.458977e-01 1 1  ON 7
 uu_8                -1.390553e-01 1 1  ON 8
 uu_9                -1.140849e-01 1 1  ON 9
 ud_0                 4.216809e-01 1 1  ON 10
 ud_1                 1.392595e-01 1 1  ON 11
 ud_2                -7.676491e-03 1 1  ON 12
 ud_3                -8.653754e-02 1 1  ON 13
 ud_4                -1.300759e-01 1 1  ON 14
 ud_5                -1.562496e-01 1 1  ON 15
 ud_6                -1.702590e-01 1 1  ON 16
 ud_7                -1.735840e-01 1 1  ON 17
 ud_8                -1.625748e-01 1 1  ON 18
 ud_9                -1.349374e-01 1 1  ON 19
 eC_0                -5.956945e-01 1 1  ON 20
 eC_1                -4.431255e-01 1 1  ON 21
 eC_2                -1.898784e-01 1 1  ON 22
 eC_3                -3.267472e-02 1 1  ON 23
 eC_4                 5.206114e-02 1 1  ON 24
 eC_5                 1.593506e-01 1 1  ON 25
 eC_6                 2.584545e-01 1 1  ON 26
 eC_7                 3.713625e-01 1 1  ON 27
 eC_8                 3.123086e-01 1 1  ON 28
 eC_9                 9.903122e-02 1 1  ON 29
 eO_0                -1.202247e+00 1 1  ON 30
 eO_1                -8.239190e-01 1 1  ON 31
 eO_2                -3.575542e-01 1 1  ON 32
 eO_3                -1.242899e-02 1 1  ON 33
 eO_4                 2.171402e-01 1 1  ON 34
 eO_5                 3.878240e-01 1 1  ON 35
 eO_6                 4.386065e-01 1 1  ON 36
 eO_7                 4.459419e-01 1 1  ON 37
 eO_8                 4.055533e-01 1 1  ON 38
 eO_9                 3.355759e-01 1 1  ON 39
eH1_0                -2.157057e-01 1 1  ON 40
eH1_1                -1.223505e-01 1 1  ON 41
eH1_2                -8.470662e-02 1 1  ON 42
eH1_3                -6.444529e-02 1 1  ON 43
eH1_4                 7.254868e-03 1 1  ON 44
eH1_5                 5.312783e-02 1 1  ON 45
eH1_6                 8.977902e-02 1 1  ON 46
eH1_7                 6.289117e-02 1 1  ON 47
eH1_8                 2.227366e-02 1 1  ON 48
eH1_9                 5.725449e-02 1 1  ON 49
eH2_0                -2.102163e-01 1 1  ON 50
eH2_1                -1.173472e-01 1 1  ON 51
eH2_2                -7.979020e-02 1 1  ON 52
eH2_3                -5.948980e-02 1 1  ON 53
eH2_4                 1.229764e-02 1 1  ON 54
eH2_5                 5.795791e-02 1 1  ON 55
eH2_6                 9.453856e-02 1 1  ON 56
eH2_7                 6.734386e-02 1 1  ON 57
eH2_8                 2.567616e-02 1 1  ON 58
eH2_9                 5.815463e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2193e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.663
    reference variance = 0.286561
====================================================
  Execution time = 4.4329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.1913e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5275e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519035930545
                                         uncertainty =       0.007845333996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519035930545
                                         uncertainty =       0.007845333996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509475450
  error estimate for blocks of size 2^( 2) =       0.000526829421
  error estimate for blocks of size 2^( 3) =       0.000542397217
  error estimate for blocks of size 2^( 4) =       0.000552986478
  error estimate for blocks of size 2^( 5) =       0.000560252627
  error estimate for blocks of size 2^( 6) =       0.000563603713
  error estimate for blocks of size 2^( 7) =       0.000563416751

      target function =                  N/A
              le_mean =     -22.670641069958
             les_mean =     514.477096732173
             stat err =       0.000560064892
             autocorr =       1.208454145397
              std dev =       0.720507091485
             le_variance =       0.519130468881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267064106996e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670641069958       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670642167017       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670643528741       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670643853531       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670644788762       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670644923707       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670645247124       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670644924916       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670645193897       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670645093083       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670645097973       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670645895318       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.670646143355       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.670645952280       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.670645910787       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.670646211141       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 1.737218e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670641069958       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670641703891       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670642612391       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670642821693       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670643387208       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670643398325       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670643357147       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670643256528       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670643392679       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670643435338       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670643359139       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670643575301       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 7.329110e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670641069958       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670641305743       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670641718859       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670641801006       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670642006562       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670642041625       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670641937451       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670641905610       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670641974989       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670642007089       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670641978658       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 2.246664e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9623e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 3.021370e-01 1 1  ON 0
 uu_1                 1.262895e-01 1 1  ON 1
 uu_2                 1.252089e-02 1 1  ON 2
 uu_3                -5.528964e-02 1 1  ON 3
 uu_4                -9.667172e-02 1 1  ON 4
 uu_5                -1.234901e-01 1 1  ON 5
 uu_6                -1.400288e-01 1 1  ON 6
 uu_7                -1.458931e-01 1 1  ON 7
 uu_8                -1.391281e-01 1 1  ON 8
 uu_9                -1.143476e-01 1 1  ON 9
 ud_0                 4.215745e-01 1 1  ON 10
 ud_1                 1.391857e-01 1 1  ON 11
 ud_2                -7.641594e-03 1 1  ON 12
 ud_3                -8.643918e-02 1 1  ON 13
 ud_4                -1.300262e-01 1 1  ON 14
 ud_5                -1.561878e-01 1 1  ON 15
 ud_6                -1.703240e-01 1 1  ON 16
 ud_7                -1.738290e-01 1 1  ON 17
 ud_8                -1.618418e-01 1 1  ON 18
 ud_9                -1.346724e-01 1 1  ON 19
 eC_0                -5.956701e-01 1 1  ON 20
 eC_1                -4.429941e-01 1 1  ON 21
 eC_2                -1.900974e-01 1 1  ON 22
 eC_3                -3.273085e-02 1 1  ON 23
 eC_4                 5.205239e-02 1 1  ON 24
 eC_5                 1.594241e-01 1 1  ON 25
 eC_6                 2.582606e-01 1 1  ON 26
 eC_7                 3.711682e-01 1 1  ON 27
 eC_8                 3.125284e-01 1 1  ON 28
 eC_9                 9.923369e-02 1 1  ON 29
 eO_0                -1.202090e+00 1 1  ON 30
 eO_1                -8.239856e-01 1 1  ON 31
 eO_2                -3.577988e-01 1 1  ON 32
 eO_3                -1.287513e-02 1 1  ON 33
 eO_4                 2.170361e-01 1 1  ON 34
 eO_5                 3.878665e-01 1 1  ON 35
 eO_6                 4.385032e-01 1 1  ON 36
 eO_7                 4.460098e-01 1 1  ON 37
 eO_8                 4.057106e-01 1 1  ON 38
 eO_9                 3.358424e-01 1 1  ON 39
eH1_0                -2.154177e-01 1 1  ON 40
eH1_1                -1.222072e-01 1 1  ON 41
eH1_2                -8.460472e-02 1 1  ON 42
eH1_3                -6.439299e-02 1 1  ON 43
eH1_4                 7.018451e-03 1 1  ON 44
eH1_5                 5.310911e-02 1 1  ON 45
eH1_6                 8.984436e-02 1 1  ON 46
eH1_7                 6.258964e-02 1 1  ON 47
eH1_8                 2.206590e-02 1 1  ON 48
eH1_9                 5.716020e-02 1 1  ON 49
eH2_0                -2.100622e-01 1 1  ON 50
eH2_1                -1.174251e-01 1 1  ON 51
eH2_2                -8.012125e-02 1 1  ON 52
eH2_3                -5.944628e-02 1 1  ON 53
eH2_4                 1.244278e-02 1 1  ON 54
eH2_5                 5.784480e-02 1 1  ON 55
eH2_6                 9.476263e-02 1 1  ON 56
eH2_7                 6.739712e-02 1 1  ON 57
eH2_8                 2.547527e-02 1 1  ON 58
eH2_9                 5.802684e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6849
    reference variance = 0.343311
====================================================
  Execution time = 4.7099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2169e-01
  Total weights = 2.0000e+06
  Execution time = 3.6925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522052667500
                                         uncertainty =       0.006162246520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522052667500
                                         uncertainty =       0.006162246520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510877504
  error estimate for blocks of size 2^( 2) =       0.000528219138
  error estimate for blocks of size 2^( 3) =       0.000543540677
  error estimate for blocks of size 2^( 4) =       0.000554899562
  error estimate for blocks of size 2^( 5) =       0.000562098585
  error estimate for blocks of size 2^( 6) =       0.000567191747
  error estimate for blocks of size 2^( 7) =       0.000567419452

      target function =                  N/A
              le_mean =     -22.669680869894
             les_mean =     514.436422129523
             stat err =       0.000562902336
             autocorr =       1.214038737124
              std dev =       0.722489894529
             le_variance =       0.521991647697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521578148532
                                         uncertainty =       0.006163068430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521578148532
                                         uncertainty =       0.006163068430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510645321
  error estimate for blocks of size 2^( 2) =       0.000528004002
  error estimate for blocks of size 2^( 3) =       0.000543344439
  error estimate for blocks of size 2^( 4) =       0.000554711616
  error estimate for blocks of size 2^( 5) =       0.000561915115
  error estimate for blocks of size 2^( 6) =       0.000567027297
  error estimate for blocks of size 2^( 7) =       0.000567251081

      target function =                  N/A
              le_mean =     -22.669678302458
             les_mean =     514.435831363662
             stat err =       0.000562726277
             autocorr =       1.214382995920
              std dev =       0.722161538352
             le_variance =       0.521517287475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521450025069
                                         uncertainty =       0.006162431900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521450025069
                                         uncertainty =       0.006162431900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510582591
  error estimate for blocks of size 2^( 2) =       0.000527945910
  error estimate for blocks of size 2^( 3) =       0.000543292376
  error estimate for blocks of size 2^( 4) =       0.000554661525
  error estimate for blocks of size 2^( 5) =       0.000561866185
  error estimate for blocks of size 2^( 6) =       0.000566980207
  error estimate for blocks of size 2^( 7) =       0.000567204742

      target function =                  N/A
              le_mean =     -22.669678994630
             les_mean =     514.435734622784
             stat err =       0.000562678165
             autocorr =       1.214473714675
              std dev =       0.722072824535
             le_variance =       0.521389163932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521935590186
                                         uncertainty =       0.006162137943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.521935590186
                                         uncertainty =       0.006162137943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510820214
  error estimate for blocks of size 2^( 2) =       0.000528166164
  error estimate for blocks of size 2^( 3) =       0.000543492647
  error estimate for blocks of size 2^( 4) =       0.000554853267
  error estimate for blocks of size 2^( 5) =       0.000562053168
  error estimate for blocks of size 2^( 6) =       0.000567149918
  error estimate for blocks of size 2^( 7) =       0.000567376923

      target function =                  N/A
              le_mean =     -22.669680046724
             les_mean =     514.436267741001
             stat err =       0.000562858319
             autocorr =       1.214121164790
              std dev =       0.722408873908
             le_variance =       0.521874581101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669680869894        initial  <--
     5.9605e-02     5.9605e-01             1.7372e-03       -22.669678302458
     2.3842e-01     2.3842e+00             7.3291e-04       -22.669678994630
     9.5367e-01     9.5367e+00             2.2467e-04       -22.669680046724

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4125
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 3.020542e-01 1 1  ON 0
 uu_1                 1.263284e-01 1 1  ON 1
 uu_2                 1.231265e-02 1 1  ON 2
 uu_3                -5.545790e-02 1 1  ON 3
 uu_4                -9.673209e-02 1 1  ON 4
 uu_5                -1.235304e-01 1 1  ON 5
 uu_6                -1.401005e-01 1 1  ON 6
 uu_7                -1.458977e-01 1 1  ON 7
 uu_8                -1.390553e-01 1 1  ON 8
 uu_9                -1.140849e-01 1 1  ON 9
 ud_0                 4.216809e-01 1 1  ON 10
 ud_1                 1.392595e-01 1 1  ON 11
 ud_2                -7.676491e-03 1 1  ON 12
 ud_3                -8.653754e-02 1 1  ON 13
 ud_4                -1.300759e-01 1 1  ON 14
 ud_5                -1.562496e-01 1 1  ON 15
 ud_6                -1.702590e-01 1 1  ON 16
 ud_7                -1.735840e-01 1 1  ON 17
 ud_8                -1.625748e-01 1 1  ON 18
 ud_9                -1.349374e-01 1 1  ON 19
 eC_0                -5.956945e-01 1 1  ON 20
 eC_1                -4.431255e-01 1 1  ON 21
 eC_2                -1.898784e-01 1 1  ON 22
 eC_3                -3.267472e-02 1 1  ON 23
 eC_4                 5.206114e-02 1 1  ON 24
 eC_5                 1.593506e-01 1 1  ON 25
 eC_6                 2.584545e-01 1 1  ON 26
 eC_7                 3.713625e-01 1 1  ON 27
 eC_8                 3.123086e-01 1 1  ON 28
 eC_9                 9.903122e-02 1 1  ON 29
 eO_0                -1.202247e+00 1 1  ON 30
 eO_1                -8.239190e-01 1 1  ON 31
 eO_2                -3.575542e-01 1 1  ON 32
 eO_3                -1.242899e-02 1 1  ON 33
 eO_4                 2.171402e-01 1 1  ON 34
 eO_5                 3.878240e-01 1 1  ON 35
 eO_6                 4.386065e-01 1 1  ON 36
 eO_7                 4.459419e-01 1 1  ON 37
 eO_8                 4.055533e-01 1 1  ON 38
 eO_9                 3.355759e-01 1 1  ON 39
eH1_0                -2.157057e-01 1 1  ON 40
eH1_1                -1.223505e-01 1 1  ON 41
eH1_2                -8.470662e-02 1 1  ON 42
eH1_3                -6.444529e-02 1 1  ON 43
eH1_4                 7.254868e-03 1 1  ON 44
eH1_5                 5.312783e-02 1 1  ON 45
eH1_6                 8.977902e-02 1 1  ON 46
eH1_7                 6.289117e-02 1 1  ON 47
eH1_8                 2.227366e-02 1 1  ON 48
eH1_9                 5.725449e-02 1 1  ON 49
eH2_0                -2.102163e-01 1 1  ON 50
eH2_1                -1.173472e-01 1 1  ON 51
eH2_2                -7.979020e-02 1 1  ON 52
eH2_3                -5.948980e-02 1 1  ON 53
eH2_4                 1.229764e-02 1 1  ON 54
eH2_5                 5.795791e-02 1 1  ON 55
eH2_6                 9.453856e-02 1 1  ON 56
eH2_7                 6.734386e-02 1 1  ON 57
eH2_8                 2.567616e-02 1 1  ON 58
eH2_9                 5.815463e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2504e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2672e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7253
    reference variance = 0.289894
====================================================
  Execution time = 4.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5232e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510632264217
                                         uncertainty =       0.004006498235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510632264217
                                         uncertainty =       0.004006498235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505276110
  error estimate for blocks of size 2^( 2) =       0.000522776742
  error estimate for blocks of size 2^( 3) =       0.000538250006
  error estimate for blocks of size 2^( 4) =       0.000549260570
  error estimate for blocks of size 2^( 5) =       0.000556096481
  error estimate for blocks of size 2^( 6) =       0.000560767301
  error estimate for blocks of size 2^( 7) =       0.000563613641

      target function =                  N/A
              le_mean =     -22.669755526229
             les_mean =     514.428423259166
             stat err =       0.000557434498
             autocorr =       1.217110908772
              std dev =       0.714568328081
             le_variance =       0.510607895497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266975552623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669755526229       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669756507269       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669756565920       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669756152502       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669756334594       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669756630020       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669756461064       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669756411393       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669756578645       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669756650259       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.669756614407       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-01 is 2.309160e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669755526229       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669755836322       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669755893752       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669755699275       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669755702901       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669755772694       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669755748291       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669755768361       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669755780849       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669755772970       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+00 is 7.079978e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669755526229       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669755609238       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669755628785       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669755569528       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669755565354       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669755579144       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669755572307       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669755580826       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669755581501       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669755577291       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+00 is 1.931112e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9306e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 3.020848e-01 1 1  ON 0
 uu_1                 1.263263e-01 1 1  ON 1
 uu_2                 1.235296e-02 1 1  ON 2
 uu_3                -5.546211e-02 1 1  ON 3
 uu_4                -9.673904e-02 1 1  ON 4
 uu_5                -1.235572e-01 1 1  ON 5
 uu_6                -1.401315e-01 1 1  ON 6
 uu_7                -1.458398e-01 1 1  ON 7
 uu_8                -1.390511e-01 1 1  ON 8
 uu_9                -1.141168e-01 1 1  ON 9
 ud_0                 4.216649e-01 1 1  ON 10
 ud_1                 1.392451e-01 1 1  ON 11
 ud_2                -7.703785e-03 1 1  ON 12
 ud_3                -8.647315e-02 1 1  ON 13
 ud_4                -1.301108e-01 1 1  ON 14
 ud_5                -1.562439e-01 1 1  ON 15
 ud_6                -1.702577e-01 1 1  ON 16
 ud_7                -1.735580e-01 1 1  ON 17
 ud_8                -1.625316e-01 1 1  ON 18
 ud_9                -1.349364e-01 1 1  ON 19
 eC_0                -5.957032e-01 1 1  ON 20
 eC_1                -4.431279e-01 1 1  ON 21
 eC_2                -1.898778e-01 1 1  ON 22
 eC_3                -3.269002e-02 1 1  ON 23
 eC_4                 5.207991e-02 1 1  ON 24
 eC_5                 1.593140e-01 1 1  ON 25
 eC_6                 2.584344e-01 1 1  ON 26
 eC_7                 3.713677e-01 1 1  ON 27
 eC_8                 3.123459e-01 1 1  ON 28
 eC_9                 9.904963e-02 1 1  ON 29
 eO_0                -1.202232e+00 1 1  ON 30
 eO_1                -8.239447e-01 1 1  ON 31
 eO_2                -3.575771e-01 1 1  ON 32
 eO_3                -1.249979e-02 1 1  ON 33
 eO_4                 2.171598e-01 1 1  ON 34
 eO_5                 3.878725e-01 1 1  ON 35
 eO_6                 4.386025e-01 1 1  ON 36
 eO_7                 4.459359e-01 1 1  ON 37
 eO_8                 4.055409e-01 1 1  ON 38
 eO_9                 3.356005e-01 1 1  ON 39
eH1_0                -2.156693e-01 1 1  ON 40
eH1_1                -1.223024e-01 1 1  ON 41
eH1_2                -8.477670e-02 1 1  ON 42
eH1_3                -6.446096e-02 1 1  ON 43
eH1_4                 7.236869e-03 1 1  ON 44
eH1_5                 5.310444e-02 1 1  ON 45
eH1_6                 8.979840e-02 1 1  ON 46
eH1_7                 6.288843e-02 1 1  ON 47
eH1_8                 2.227809e-02 1 1  ON 48
eH1_9                 5.725299e-02 1 1  ON 49
eH2_0                -2.101906e-01 1 1  ON 50
eH2_1                -1.173516e-01 1 1  ON 51
eH2_2                -7.982731e-02 1 1  ON 52
eH2_3                -5.946787e-02 1 1  ON 53
eH2_4                 1.226894e-02 1 1  ON 54
eH2_5                 5.796574e-02 1 1  ON 55
eH2_6                 9.454384e-02 1 1  ON 56
eH2_7                 6.732679e-02 1 1  ON 57
eH2_8                 2.568000e-02 1 1  ON 58
eH2_9                 5.815350e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.641
    reference variance = 0.462226
====================================================
  Execution time = 4.3760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0839e-01
  Total weights = 2.0000e+06
  Execution time = 3.6741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508381919447
                                         uncertainty =       0.003282979393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508381919447
                                         uncertainty =       0.003282979393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504183825
  error estimate for blocks of size 2^( 2) =       0.000521543493
  error estimate for blocks of size 2^( 3) =       0.000537049774
  error estimate for blocks of size 2^( 4) =       0.000547074182
  error estimate for blocks of size 2^( 5) =       0.000554254650
  error estimate for blocks of size 2^( 6) =       0.000558265863
  error estimate for blocks of size 2^( 7) =       0.000560998247

      target function =                  N/A
              le_mean =     -22.669989830849
             les_mean =     514.436841336278
             stat err =       0.000555148236
             autocorr =       1.212383757689
              std dev =       0.713023603877
             le_variance =       0.508402659686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508314043154
                                         uncertainty =       0.003282681726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508314043154
                                         uncertainty =       0.003282681726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504150160
  error estimate for blocks of size 2^( 2) =       0.000521512515
  error estimate for blocks of size 2^( 3) =       0.000537025922
  error estimate for blocks of size 2^( 4) =       0.000547053820
  error estimate for blocks of size 2^( 5) =       0.000554234892
  error estimate for blocks of size 2^( 6) =       0.000558251101
  error estimate for blocks of size 2^( 7) =       0.000560986909

      target function =                  N/A
              le_mean =     -22.669988476773
             les_mean =     514.436712050328
             stat err =       0.000555131681
             autocorr =       1.212473363731
              std dev =       0.712975993625
             le_variance =       0.508334767486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508351197540
                                         uncertainty =       0.003282725925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508351197540
                                         uncertainty =       0.003282725925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504168585
  error estimate for blocks of size 2^( 2) =       0.000521529020
  error estimate for blocks of size 2^( 3) =       0.000537040027
  error estimate for blocks of size 2^( 4) =       0.000547066204
  error estimate for blocks of size 2^( 5) =       0.000554246545
  error estimate for blocks of size 2^( 6) =       0.000558261441
  error estimate for blocks of size 2^( 7) =       0.000560996995

      target function =                  N/A
              le_mean =     -22.669988550452
             les_mean =     514.436752546924
             stat err =       0.000555142796
             autocorr =       1.212433299852
              std dev =       0.713002050141
             le_variance =       0.508371923506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508378248393
                                         uncertainty =       0.003282939890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508378248393
                                         uncertainty =       0.003282939890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504182004
  error estimate for blocks of size 2^( 2) =       0.000521541714
  error estimate for blocks of size 2^( 3) =       0.000537048643
  error estimate for blocks of size 2^( 4) =       0.000547073264
  error estimate for blocks of size 2^( 5) =       0.000554253677
  error estimate for blocks of size 2^( 6) =       0.000558265429
  error estimate for blocks of size 2^( 7) =       0.000560998288

      target function =                  N/A
              le_mean =     -22.669989602194
             les_mean =     514.436827295194
             stat err =       0.000555147664
             autocorr =       1.212390023996
              std dev =       0.713021027594
             le_variance =       0.508398985791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669989830849        initial  <--
     5.9605e-01     5.9605e+00             2.3092e-04       -22.669988476773
     2.3842e+00     2.3842e+01             7.0800e-05       -22.669988550452
     9.5367e+00     9.5367e+01             1.9311e-05       -22.669989602194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0646
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 3.020542e-01 1 1  ON 0
 uu_1                 1.263284e-01 1 1  ON 1
 uu_2                 1.231265e-02 1 1  ON 2
 uu_3                -5.545790e-02 1 1  ON 3
 uu_4                -9.673209e-02 1 1  ON 4
 uu_5                -1.235304e-01 1 1  ON 5
 uu_6                -1.401005e-01 1 1  ON 6
 uu_7                -1.458977e-01 1 1  ON 7
 uu_8                -1.390553e-01 1 1  ON 8
 uu_9                -1.140849e-01 1 1  ON 9
 ud_0                 4.216809e-01 1 1  ON 10
 ud_1                 1.392595e-01 1 1  ON 11
 ud_2                -7.676491e-03 1 1  ON 12
 ud_3                -8.653754e-02 1 1  ON 13
 ud_4                -1.300759e-01 1 1  ON 14
 ud_5                -1.562496e-01 1 1  ON 15
 ud_6                -1.702590e-01 1 1  ON 16
 ud_7                -1.735840e-01 1 1  ON 17
 ud_8                -1.625748e-01 1 1  ON 18
 ud_9                -1.349374e-01 1 1  ON 19
 eC_0                -5.956945e-01 1 1  ON 20
 eC_1                -4.431255e-01 1 1  ON 21
 eC_2                -1.898784e-01 1 1  ON 22
 eC_3                -3.267472e-02 1 1  ON 23
 eC_4                 5.206114e-02 1 1  ON 24
 eC_5                 1.593506e-01 1 1  ON 25
 eC_6                 2.584545e-01 1 1  ON 26
 eC_7                 3.713625e-01 1 1  ON 27
 eC_8                 3.123086e-01 1 1  ON 28
 eC_9                 9.903122e-02 1 1  ON 29
 eO_0                -1.202247e+00 1 1  ON 30
 eO_1                -8.239190e-01 1 1  ON 31
 eO_2                -3.575542e-01 1 1  ON 32
 eO_3                -1.242899e-02 1 1  ON 33
 eO_4                 2.171402e-01 1 1  ON 34
 eO_5                 3.878240e-01 1 1  ON 35
 eO_6                 4.386065e-01 1 1  ON 36
 eO_7                 4.459419e-01 1 1  ON 37
 eO_8                 4.055533e-01 1 1  ON 38
 eO_9                 3.355759e-01 1 1  ON 39
eH1_0                -2.157057e-01 1 1  ON 40
eH1_1                -1.223505e-01 1 1  ON 41
eH1_2                -8.470662e-02 1 1  ON 42
eH1_3                -6.444529e-02 1 1  ON 43
eH1_4                 7.254868e-03 1 1  ON 44
eH1_5                 5.312783e-02 1 1  ON 45
eH1_6                 8.977902e-02 1 1  ON 46
eH1_7                 6.289117e-02 1 1  ON 47
eH1_8                 2.227366e-02 1 1  ON 48
eH1_9                 5.725449e-02 1 1  ON 49
eH2_0                -2.102163e-01 1 1  ON 50
eH2_1                -1.173472e-01 1 1  ON 51
eH2_2                -7.979020e-02 1 1  ON 52
eH2_3                -5.948980e-02 1 1  ON 53
eH2_4                 1.229764e-02 1 1  ON 54
eH2_5                 5.795791e-02 1 1  ON 55
eH2_6                 9.453856e-02 1 1  ON 56
eH2_7                 6.734386e-02 1 1  ON 57
eH2_8                 2.567616e-02 1 1  ON 58
eH2_9                 5.815463e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2673e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7995
    reference variance = 0.560222
====================================================
  Execution time = 4.4334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2353e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5331e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523569445848
                                         uncertainty =       0.012040490467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523569445848
                                         uncertainty =       0.012040490467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511629303
  error estimate for blocks of size 2^( 2) =       0.000528919462
  error estimate for blocks of size 2^( 3) =       0.000543754967
  error estimate for blocks of size 2^( 4) =       0.000555203778
  error estimate for blocks of size 2^( 5) =       0.000561758838
  error estimate for blocks of size 2^( 6) =       0.000563808680
  error estimate for blocks of size 2^( 7) =       0.000564574779

      target function =                  N/A
              le_mean =     -22.669674084423
             les_mean =     514.437651920490
             stat err =       0.000561336519
             autocorr =       1.203748538752
              std dev =       0.723553099832
             le_variance =       0.523529088276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266967408442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674084423       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674011158       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674035237       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674047185       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669674077228       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669674076140       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669674135702       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669674131907       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669674124395       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669674104718       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+00 is 2.888632e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674084423       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674065558       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674071569       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674074210       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669674081761       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669674080289       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669674094649       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669674094122       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669674092579       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669674087734       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+01 is 7.687645e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669674084423       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669674079671       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669674081173       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669674081809       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669674083699       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669674083248       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669674086793       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669674086686       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669674086321       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669674085121       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+01 is 1.960091e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9679e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 3.020521e-01 1 1  ON 0
 uu_1                 1.263238e-01 1 1  ON 1
 uu_2                 1.232033e-02 1 1  ON 2
 uu_3                -5.545945e-02 1 1  ON 3
 uu_4                -9.673026e-02 1 1  ON 4
 uu_5                -1.235296e-01 1 1  ON 5
 uu_6                -1.401023e-01 1 1  ON 6
 uu_7                -1.459031e-01 1 1  ON 7
 uu_8                -1.390538e-01 1 1  ON 8
 uu_9                -1.140812e-01 1 1  ON 9
 ud_0                 4.216815e-01 1 1  ON 10
 ud_1                 1.392560e-01 1 1  ON 11
 ud_2                -7.676768e-03 1 1  ON 12
 ud_3                -8.653623e-02 1 1  ON 13
 ud_4                -1.300767e-01 1 1  ON 14
 ud_5                -1.562440e-01 1 1  ON 15
 ud_6                -1.702619e-01 1 1  ON 16
 ud_7                -1.735792e-01 1 1  ON 17
 ud_8                -1.625730e-01 1 1  ON 18
 ud_9                -1.349382e-01 1 1  ON 19
 eC_0                -5.956924e-01 1 1  ON 20
 eC_1                -4.431257e-01 1 1  ON 21
 eC_2                -1.898799e-01 1 1  ON 22
 eC_3                -3.268214e-02 1 1  ON 23
 eC_4                 5.206239e-02 1 1  ON 24
 eC_5                 1.593515e-01 1 1  ON 25
 eC_6                 2.584541e-01 1 1  ON 26
 eC_7                 3.713613e-01 1 1  ON 27
 eC_8                 3.123123e-01 1 1  ON 28
 eC_9                 9.903359e-02 1 1  ON 29
 eO_0                -1.202250e+00 1 1  ON 30
 eO_1                -8.239207e-01 1 1  ON 31
 eO_2                -3.575533e-01 1 1  ON 32
 eO_3                -1.242910e-02 1 1  ON 33
 eO_4                 2.171363e-01 1 1  ON 34
 eO_5                 3.878237e-01 1 1  ON 35
 eO_6                 4.386083e-01 1 1  ON 36
 eO_7                 4.459414e-01 1 1  ON 37
 eO_8                 4.055537e-01 1 1  ON 38
 eO_9                 3.355783e-01 1 1  ON 39
eH1_0                -2.156986e-01 1 1  ON 40
eH1_1                -1.223526e-01 1 1  ON 41
eH1_2                -8.470976e-02 1 1  ON 42
eH1_3                -6.444605e-02 1 1  ON 43
eH1_4                 7.256957e-03 1 1  ON 44
eH1_5                 5.312217e-02 1 1  ON 45
eH1_6                 8.977673e-02 1 1  ON 46
eH1_7                 6.289077e-02 1 1  ON 47
eH1_8                 2.227581e-02 1 1  ON 48
eH1_9                 5.725421e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.173506e-01 1 1  ON 51
eH2_2                -7.979005e-02 1 1  ON 52
eH2_3                -5.949023e-02 1 1  ON 53
eH2_4                 1.230030e-02 1 1  ON 54
eH2_5                 5.795676e-02 1 1  ON 55
eH2_6                 9.454029e-02 1 1  ON 56
eH2_7                 6.734443e-02 1 1  ON 57
eH2_8                 2.567650e-02 1 1  ON 58
eH2_9                 5.815429e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6735
    reference variance = 0.349404
====================================================
  Execution time = 4.3632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1825e-01
  Total weights = 2.0000e+06
  Execution time = 3.6815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518340973009
                                         uncertainty =       0.005261038902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518340973009
                                         uncertainty =       0.005261038902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509046576
  error estimate for blocks of size 2^( 2) =       0.000526491734
  error estimate for blocks of size 2^( 3) =       0.000542180592
  error estimate for blocks of size 2^( 4) =       0.000552493320
  error estimate for blocks of size 2^( 5) =       0.000560373051
  error estimate for blocks of size 2^( 6) =       0.000565549690
  error estimate for blocks of size 2^( 7) =       0.000567982364

      target function =                  N/A
              le_mean =     -22.670040684821
             les_mean =     514.449001224796
             stat err =       0.000561599606
             autocorr =       1.217134431770
              std dev =       0.719900571261
             le_variance =       0.518256832501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518322454685
                                         uncertainty =       0.005260614267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518322454685
                                         uncertainty =       0.005260614267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509037479
  error estimate for blocks of size 2^( 2) =       0.000526482878
  error estimate for blocks of size 2^( 3) =       0.000542172603
  error estimate for blocks of size 2^( 4) =       0.000552485275
  error estimate for blocks of size 2^( 5) =       0.000560365426
  error estimate for blocks of size 2^( 6) =       0.000565542344
  error estimate for blocks of size 2^( 7) =       0.000567974912

      target function =                  N/A
              le_mean =     -22.670040959590
             les_mean =     514.448995160851
             stat err =       0.000561591990
             autocorr =       1.217144917063
              std dev =       0.719887706861
             le_variance =       0.518238310490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518331328233
                                         uncertainty =       0.005260815229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518331328233
                                         uncertainty =       0.005260815229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509041838
  error estimate for blocks of size 2^( 2) =       0.000526487122
  error estimate for blocks of size 2^( 3) =       0.000542176439
  error estimate for blocks of size 2^( 4) =       0.000552489127
  error estimate for blocks of size 2^( 5) =       0.000560369081
  error estimate for blocks of size 2^( 6) =       0.000565545857
  error estimate for blocks of size 2^( 7) =       0.000567978457

      target function =                  N/A
              le_mean =     -22.670040832392
             les_mean =     514.448998268807
             stat err =       0.000561595630
             autocorr =       1.217139854363
              std dev =       0.719893871074
             le_variance =       0.518247185611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518339751799
                                         uncertainty =       0.005261010551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518339751799
                                         uncertainty =       0.005261010551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509045976
  error estimate for blocks of size 2^( 2) =       0.000526491150
  error estimate for blocks of size 2^( 3) =       0.000542180067
  error estimate for blocks of size 2^( 4) =       0.000552492789
  error estimate for blocks of size 2^( 5) =       0.000560372548
  error estimate for blocks of size 2^( 6) =       0.000565549204
  error estimate for blocks of size 2^( 7) =       0.000567981868

      target function =                  N/A
              le_mean =     -22.670040703347
             les_mean =     514.449000843286
             stat err =       0.000561599102
             autocorr =       1.217135115825
              std dev =       0.719899722890
             le_variance =       0.518255611017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670040684821        initial
     5.9605e+00     5.9605e+01             2.8886e-05       -22.670040959590  <--
     2.3842e+01     2.3842e+02             7.6876e-06       -22.670040832392
     9.5367e+01     9.5367e+02             1.9601e-06       -22.670040703347

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 6.1929e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 3.020459e-01 1 1  ON 0
 uu_1                 1.263117e-01 1 1  ON 1
 uu_2                 1.234120e-02 1 1  ON 2
 uu_3                -5.546303e-02 1 1  ON 3
 uu_4                -9.672535e-02 1 1  ON 4
 uu_5                -1.235275e-01 1 1  ON 5
 uu_6                -1.401076e-01 1 1  ON 6
 uu_7                -1.459188e-01 1 1  ON 7
 uu_8                -1.390494e-01 1 1  ON 8
 uu_9                -1.140702e-01 1 1  ON 9
 ud_0                 4.216824e-01 1 1  ON 10
 ud_1                 1.392462e-01 1 1  ON 11
 ud_2                -7.677653e-03 1 1  ON 12
 ud_3                -8.653258e-02 1 1  ON 13
 ud_4                -1.300785e-01 1 1  ON 14
 ud_5                -1.562283e-01 1 1  ON 15
 ud_6                -1.702693e-01 1 1  ON 16
 ud_7                -1.735657e-01 1 1  ON 17
 ud_8                -1.625678e-01 1 1  ON 18
 ud_9                -1.349404e-01 1 1  ON 19
 eC_0                -5.956864e-01 1 1  ON 20
 eC_1                -4.431260e-01 1 1  ON 21
 eC_2                -1.898849e-01 1 1  ON 22
 eC_3                -3.270360e-02 1 1  ON 23
 eC_4                 5.206572e-02 1 1  ON 24
 eC_5                 1.593539e-01 1 1  ON 25
 eC_6                 2.584531e-01 1 1  ON 26
 eC_7                 3.713576e-01 1 1  ON 27
 eC_8                 3.123235e-01 1 1  ON 28
 eC_9                 9.904061e-02 1 1  ON 29
 eO_0                -1.202258e+00 1 1  ON 30
 eO_1                -8.239257e-01 1 1  ON 31
 eO_2                -3.575502e-01 1 1  ON 32
 eO_3                -1.242957e-02 1 1  ON 33
 eO_4                 2.171250e-01 1 1  ON 34
 eO_5                 3.878228e-01 1 1  ON 35
 eO_6                 4.386137e-01 1 1  ON 36
 eO_7                 4.459396e-01 1 1  ON 37
 eO_8                 4.055549e-01 1 1  ON 38
 eO_9                 3.355854e-01 1 1  ON 39
eH1_0                -2.156775e-01 1 1  ON 40
eH1_1                -1.223588e-01 1 1  ON 41
eH1_2                -8.471888e-02 1 1  ON 42
eH1_3                -6.444829e-02 1 1  ON 43
eH1_4                 7.262763e-03 1 1  ON 44
eH1_5                 5.310585e-02 1 1  ON 45
eH1_6                 8.976962e-02 1 1  ON 46
eH1_7                 6.288964e-02 1 1  ON 47
eH1_8                 2.228221e-02 1 1  ON 48
eH1_9                 5.725337e-02 1 1  ON 49
eH2_0                -2.102254e-01 1 1  ON 50
eH2_1                -1.173609e-01 1 1  ON 51
eH2_2                -7.978962e-02 1 1  ON 52
eH2_3                -5.949140e-02 1 1  ON 53
eH2_4                 1.230792e-02 1 1  ON 54
eH2_5                 5.795367e-02 1 1  ON 55
eH2_6                 9.454525e-02 1 1  ON 56
eH2_7                 6.734619e-02 1 1  ON 57
eH2_8                 2.567753e-02 1 1  ON 58
eH2_9                 5.815326e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2162e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.751
    reference variance = 0.3366
====================================================
  Execution time = 4.6173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5231e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509545612899
                                         uncertainty =       0.004231287710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509545612899
                                         uncertainty =       0.004231287710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504716087
  error estimate for blocks of size 2^( 2) =       0.000522331636
  error estimate for blocks of size 2^( 3) =       0.000538362521
  error estimate for blocks of size 2^( 4) =       0.000548909205
  error estimate for blocks of size 2^( 5) =       0.000556207689
  error estimate for blocks of size 2^( 6) =       0.000558807148
  error estimate for blocks of size 2^( 7) =       0.000559971612

      target function =                  N/A
              le_mean =     -22.670210232225
             les_mean =     514.447908375918
             stat err =       0.000555973914
             autocorr =       1.213429459684
              std dev =       0.713776335675
             le_variance =       0.509476657369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267021023223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670210232225       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670210477190       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670210824515       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670210749622       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670211149612       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670211067840       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670211152162       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670211211440       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670211258906       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670211265472       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+00 is 1.190053e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670210232225       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670210298151       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670210400123       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670210375381       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670210492230       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670210475753       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670210501726       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670210516343       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670210524930       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670210526333       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+00 is 3.159108e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670210232225       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670210249028       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670210275721       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670210269087       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670210299730       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670210295915       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670210302834       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670210306522       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670210308203       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670210308650       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+01 is 8.019425e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1420e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 3.020551e-01 1 1  ON 0
 uu_1                 1.262984e-01 1 1  ON 1
 uu_2                 1.234715e-02 1 1  ON 2
 uu_3                -5.546824e-02 1 1  ON 3
 uu_4                -9.671469e-02 1 1  ON 4
 uu_5                -1.235149e-01 1 1  ON 5
 uu_6                -1.401059e-01 1 1  ON 6
 uu_7                -1.459010e-01 1 1  ON 7
 uu_8                -1.390401e-01 1 1  ON 8
 uu_9                -1.140890e-01 1 1  ON 9
 ud_0                 4.216868e-01 1 1  ON 10
 ud_1                 1.392645e-01 1 1  ON 11
 ud_2                -7.672605e-03 1 1  ON 12
 ud_3                -8.651469e-02 1 1  ON 13
 ud_4                -1.300875e-01 1 1  ON 14
 ud_5                -1.562105e-01 1 1  ON 15
 ud_6                -1.702833e-01 1 1  ON 16
 ud_7                -1.735662e-01 1 1  ON 17
 ud_8                -1.625629e-01 1 1  ON 18
 ud_9                -1.349462e-01 1 1  ON 19
 eC_0                -5.956800e-01 1 1  ON 20
 eC_1                -4.431272e-01 1 1  ON 21
 eC_2                -1.898791e-01 1 1  ON 22
 eC_3                -3.270650e-02 1 1  ON 23
 eC_4                 5.205932e-02 1 1  ON 24
 eC_5                 1.593455e-01 1 1  ON 25
 eC_6                 2.584515e-01 1 1  ON 26
 eC_7                 3.713518e-01 1 1  ON 27
 eC_8                 3.123309e-01 1 1  ON 28
 eC_9                 9.904601e-02 1 1  ON 29
 eO_0                -1.202265e+00 1 1  ON 30
 eO_1                -8.239274e-01 1 1  ON 31
 eO_2                -3.575397e-01 1 1  ON 32
 eO_3                -1.243356e-02 1 1  ON 33
 eO_4                 2.171135e-01 1 1  ON 34
 eO_5                 3.878097e-01 1 1  ON 35
 eO_6                 4.386141e-01 1 1  ON 36
 eO_7                 4.459540e-01 1 1  ON 37
 eO_8                 4.055534e-01 1 1  ON 38
 eO_9                 3.355902e-01 1 1  ON 39
eH1_0                -2.156735e-01 1 1  ON 40
eH1_1                -1.223750e-01 1 1  ON 41
eH1_2                -8.473700e-02 1 1  ON 42
eH1_3                -6.443139e-02 1 1  ON 43
eH1_4                 7.247009e-03 1 1  ON 44
eH1_5                 5.313443e-02 1 1  ON 45
eH1_6                 8.977968e-02 1 1  ON 46
eH1_7                 6.287902e-02 1 1  ON 47
eH1_8                 2.228039e-02 1 1  ON 48
eH1_9                 5.724783e-02 1 1  ON 49
eH2_0                -2.102244e-01 1 1  ON 50
eH2_1                -1.173308e-01 1 1  ON 51
eH2_2                -7.978409e-02 1 1  ON 52
eH2_3                -5.948455e-02 1 1  ON 53
eH2_4                 1.228835e-02 1 1  ON 54
eH2_5                 5.796395e-02 1 1  ON 55
eH2_6                 9.451366e-02 1 1  ON 56
eH2_7                 6.733922e-02 1 1  ON 57
eH2_8                 2.567974e-02 1 1  ON 58
eH2_9                 5.814883e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.634
    reference variance = 0.473168
====================================================
  Execution time = 4.4008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1024e-01
  Total weights = 2.0000e+06
  Execution time = 3.6735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510322037657
                                         uncertainty =       0.005140797400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510322037657
                                         uncertainty =       0.005140797400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505100242
  error estimate for blocks of size 2^( 2) =       0.000522952060
  error estimate for blocks of size 2^( 3) =       0.000539012308
  error estimate for blocks of size 2^( 4) =       0.000549743752
  error estimate for blocks of size 2^( 5) =       0.000555372556
  error estimate for blocks of size 2^( 6) =       0.000558842185
  error estimate for blocks of size 2^( 7) =       0.000558162905

      target function =                  N/A
              le_mean =     -22.669111049035
             les_mean =     514.398848006887
             stat err =       0.000555530349
             autocorr =       1.209651942339
              std dev =       0.714319612315
             le_variance =       0.510252508538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510303176734
                                         uncertainty =       0.005138849186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510303176734
                                         uncertainty =       0.005138849186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505090931
  error estimate for blocks of size 2^( 2) =       0.000522943311
  error estimate for blocks of size 2^( 3) =       0.000539003353
  error estimate for blocks of size 2^( 4) =       0.000549734267
  error estimate for blocks of size 2^( 5) =       0.000555364618
  error estimate for blocks of size 2^( 6) =       0.000558835937
  error estimate for blocks of size 2^( 7) =       0.000558156202

      target function =                  N/A
              le_mean =     -22.669111503864
             les_mean =     514.398849817071
             stat err =       0.000555522756
             autocorr =       1.209663470668
              std dev =       0.714306445132
             le_variance =       0.510233697557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510307505799
                                         uncertainty =       0.005139603456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510307505799
                                         uncertainty =       0.005139603456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505093065
  error estimate for blocks of size 2^( 2) =       0.000522945238
  error estimate for blocks of size 2^( 3) =       0.000539005391
  error estimate for blocks of size 2^( 4) =       0.000549736491
  error estimate for blocks of size 2^( 5) =       0.000555366283
  error estimate for blocks of size 2^( 6) =       0.000558836938
  error estimate for blocks of size 2^( 7) =       0.000558157333

      target function =                  N/A
              le_mean =     -22.669111361866
             les_mean =     514.398847690276
             stat err =       0.000555524261
             autocorr =       1.209659804598
              std dev =       0.714309462847
             le_variance =       0.510238008712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510319975212
                                         uncertainty =       0.005140639757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510319975212
                                         uncertainty =       0.005140639757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505099223
  error estimate for blocks of size 2^( 2) =       0.000522951088
  error estimate for blocks of size 2^( 3) =       0.000539011323
  error estimate for blocks of size 2^( 4) =       0.000549742720
  error estimate for blocks of size 2^( 5) =       0.000555371656
  error estimate for blocks of size 2^( 6) =       0.000558841421
  error estimate for blocks of size 2^( 7) =       0.000558162095

      target function =                  N/A
              le_mean =     -22.669111089296
             les_mean =     514.398847774138
             stat err =       0.000555529473
             autocorr =       1.209653004890
              std dev =       0.714318171684
             le_variance =       0.510250450398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669111049035        initial
     1.4901e+00     1.4901e+01             1.1901e-04       -22.669111503864  <--
     5.9605e+00     5.9605e+01             3.1591e-05       -22.669111361866
     2.3842e+01     2.3842e+02             8.0194e-06       -22.669111089296

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 6.2255e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235791e-02 1 1  ON 2
 uu_3                -5.547678e-02 1 1  ON 3
 uu_4                -9.668812e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458537e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141427e-01 1 1  ON 9
 ud_0                 4.217082e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652492e-03 1 1  ON 12
 ud_3                -8.647387e-02 1 1  ON 13
 ud_4                -1.301007e-01 1 1  ON 14
 ud_5                -1.561733e-01 1 1  ON 15
 ud_6                -1.703117e-01 1 1  ON 16
 ud_7                -1.735734e-01 1 1  ON 17
 ud_8                -1.625506e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271607e-02 1 1  ON 23
 eC_4                 5.204118e-02 1 1  ON 24
 eC_5                 1.593223e-01 1 1  ON 25
 eC_6                 2.584454e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123520e-01 1 1  ON 28
 eC_9                 9.906144e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239367e-01 1 1  ON 31
 eO_2                -3.575107e-01 1 1  ON 32
 eO_3                -1.244441e-02 1 1  ON 33
 eO_4                 2.170797e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386143e-01 1 1  ON 36
 eO_7                 4.459947e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356040e-01 1 1  ON 39
eH1_0                -2.156640e-01 1 1  ON 40
eH1_1                -1.224211e-01 1 1  ON 41
eH1_2                -8.478336e-02 1 1  ON 42
eH1_3                -6.439064e-02 1 1  ON 43
eH1_4                 7.210801e-03 1 1  ON 44
eH1_5                 5.320840e-02 1 1  ON 45
eH1_6                 8.981209e-02 1 1  ON 46
eH1_7                 6.284861e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723187e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172469e-01 1 1  ON 51
eH2_2                -7.976647e-02 1 1  ON 52
eH2_3                -5.946695e-02 1 1  ON 53
eH2_4                 1.223677e-02 1 1  ON 54
eH2_5                 5.798773e-02 1 1  ON 55
eH2_6                 9.442624e-02 1 1  ON 56
eH2_7                 6.731763e-02 1 1  ON 57
eH2_8                 2.568543e-02 1 1  ON 58
eH2_9                 5.813615e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2368e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6999
    reference variance = 0.885251
====================================================
  Execution time = 4.4374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1370e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5167e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513671514917
                                         uncertainty =       0.003191646443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513671514917
                                         uncertainty =       0.003191646443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506801429
  error estimate for blocks of size 2^( 2) =       0.000524273130
  error estimate for blocks of size 2^( 3) =       0.000539947978
  error estimate for blocks of size 2^( 4) =       0.000550746529
  error estimate for blocks of size 2^( 5) =       0.000556665818
  error estimate for blocks of size 2^( 6) =       0.000559505281
  error estimate for blocks of size 2^( 7) =       0.000562306742

      target function =                  N/A
              le_mean =     -22.670288621079
             les_mean =     514.455681282841
             stat err =       0.000557306092
             autocorr =       1.209238371696
              std dev =       0.716725454178
             le_variance =       0.513695376667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267028862108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670288621079       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670288189101       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670289236710       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670289727795       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670289975863       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670290054332       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670290471143       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670290860578       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670290897777       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670290820415       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.670290805955       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.670290849133       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e-01 is 2.724350e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670288621079       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670288480071       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670288834683       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670289011788       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670289039921       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670289046222       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670289250525       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670289399912       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670289412770       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670289406726       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+00 is 9.156263e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670288621079       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670288582910       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670288680397       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670288731461       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670288732785       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670288727781       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670288790069       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670288831107       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670288839723       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670288841497       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+00 is 2.526342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9554e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 3.021397e-01 1 1  ON 0
 uu_1                 1.262259e-01 1 1  ON 1
 uu_2                 1.242449e-02 1 1  ON 2
 uu_3                -5.548191e-02 1 1  ON 3
 uu_4                -9.668851e-02 1 1  ON 4
 uu_5                -1.234836e-01 1 1  ON 5
 uu_6                -1.400878e-01 1 1  ON 6
 uu_7                -1.458045e-01 1 1  ON 7
 uu_8                -1.390423e-01 1 1  ON 8
 uu_9                -1.141700e-01 1 1  ON 9
 ud_0                 4.217516e-01 1 1  ON 10
 ud_1                 1.393191e-01 1 1  ON 11
 ud_2                -7.636418e-03 1 1  ON 12
 ud_3                -8.647165e-02 1 1  ON 13
 ud_4                -1.301121e-01 1 1  ON 14
 ud_5                -1.561999e-01 1 1  ON 15
 ud_6                -1.702876e-01 1 1  ON 16
 ud_7                -1.735430e-01 1 1  ON 17
 ud_8                -1.625045e-01 1 1  ON 18
 ud_9                -1.349718e-01 1 1  ON 19
 eC_0                -5.957425e-01 1 1  ON 20
 eC_1                -4.431504e-01 1 1  ON 21
 eC_2                -1.898148e-01 1 1  ON 22
 eC_3                -3.267370e-02 1 1  ON 23
 eC_4                 5.203074e-02 1 1  ON 24
 eC_5                 1.593040e-01 1 1  ON 25
 eC_6                 2.583884e-01 1 1  ON 26
 eC_7                 3.713386e-01 1 1  ON 27
 eC_8                 3.124119e-01 1 1  ON 28
 eC_9                 9.909202e-02 1 1  ON 29
 eO_0                -1.202294e+00 1 1  ON 30
 eO_1                -8.239651e-01 1 1  ON 31
 eO_2                -3.575101e-01 1 1  ON 32
 eO_3                -1.248194e-02 1 1  ON 33
 eO_4                 2.171172e-01 1 1  ON 34
 eO_5                 3.877811e-01 1 1  ON 35
 eO_6                 4.385849e-01 1 1  ON 36
 eO_7                 4.459960e-01 1 1  ON 37
 eO_8                 4.055322e-01 1 1  ON 38
 eO_9                 3.356427e-01 1 1  ON 39
eH1_0                -2.156646e-01 1 1  ON 40
eH1_1                -1.223326e-01 1 1  ON 41
eH1_2                -8.487492e-02 1 1  ON 42
eH1_3                -6.439638e-02 1 1  ON 43
eH1_4                 7.200880e-03 1 1  ON 44
eH1_5                 5.320646e-02 1 1  ON 45
eH1_6                 8.979494e-02 1 1  ON 46
eH1_7                 6.281796e-02 1 1  ON 47
eH1_8                 2.230446e-02 1 1  ON 48
eH1_9                 5.723095e-02 1 1  ON 49
eH2_0                -2.102345e-01 1 1  ON 50
eH2_1                -1.172838e-01 1 1  ON 51
eH2_2                -7.981902e-02 1 1  ON 52
eH2_3                -5.944217e-02 1 1  ON 53
eH2_4                 1.225411e-02 1 1  ON 54
eH2_5                 5.799511e-02 1 1  ON 55
eH2_6                 9.445644e-02 1 1  ON 56
eH2_7                 6.730853e-02 1 1  ON 57
eH2_8                 2.568616e-02 1 1  ON 58
eH2_9                 5.812740e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7284
    reference variance = 0.726724
====================================================
  Execution time = 4.4421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1187e-01
  Total weights = 2.0000e+06
  Execution time = 3.6826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511908139828
                                         uncertainty =       0.004363296533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511908139828
                                         uncertainty =       0.004363296533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505891860
  error estimate for blocks of size 2^( 2) =       0.000522981376
  error estimate for blocks of size 2^( 3) =       0.000538184619
  error estimate for blocks of size 2^( 4) =       0.000549155716
  error estimate for blocks of size 2^( 5) =       0.000555728400
  error estimate for blocks of size 2^( 6) =       0.000558926691
  error estimate for blocks of size 2^( 7) =       0.000562070467

      target function =                  N/A
              le_mean =     -22.669501670160
             les_mean =     514.418158865405
             stat err =       0.000556470319
             autocorr =       1.209953349845
              std dev =       0.715439129445
             le_variance =       0.511853147940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511984488218
                                         uncertainty =       0.004363744413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511984488218
                                         uncertainty =       0.004363744413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505929559
  error estimate for blocks of size 2^( 2) =       0.000523020397
  error estimate for blocks of size 2^( 3) =       0.000538221935
  error estimate for blocks of size 2^( 4) =       0.000549190517
  error estimate for blocks of size 2^( 5) =       0.000555759807
  error estimate for blocks of size 2^( 6) =       0.000558953257
  error estimate for blocks of size 2^( 7) =       0.000562094477

      target function =                  N/A
              le_mean =     -22.669501016153
             les_mean =     514.418205503231
             stat err =       0.000556499514
             autocorr =       1.209899984647
              std dev =       0.715492444292
             le_variance =       0.511929437839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511945759755
                                         uncertainty =       0.004363817705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511945759755
                                         uncertainty =       0.004363817705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505910415
  error estimate for blocks of size 2^( 2) =       0.000523001516
  error estimate for blocks of size 2^( 3) =       0.000538204391
  error estimate for blocks of size 2^( 4) =       0.000549174170
  error estimate for blocks of size 2^( 5) =       0.000555743525
  error estimate for blocks of size 2^( 6) =       0.000558938292
  error estimate for blocks of size 2^( 7) =       0.000562078784

      target function =                  N/A
              le_mean =     -22.669500672758
             les_mean =     514.418151192534
             stat err =       0.000556483693
             autocorr =       1.209922753845
              std dev =       0.715465370458
             le_variance =       0.511890696325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511912515012
                                         uncertainty =       0.004363375201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511912515012
                                         uncertainty =       0.004363375201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505894016
  error estimate for blocks of size 2^( 2) =       0.000522983774
  error estimate for blocks of size 2^( 3) =       0.000538187002
  error estimate for blocks of size 2^( 4) =       0.000549157931
  error estimate for blocks of size 2^( 5) =       0.000555730073
  error estimate for blocks of size 2^( 6) =       0.000558927854
  error estimate for blocks of size 2^( 7) =       0.000562071057

      target function =                  N/A
              le_mean =     -22.669501468699
             les_mean =     514.418154094686
             stat err =       0.000556471728
             autocorr =       1.209949166646
              std dev =       0.715442178837
             le_variance =       0.511857511260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669501670160        initial  <--
     3.7253e-01     3.7253e+00             2.7243e-04       -22.669501016153
     1.4901e+00     1.4901e+01             9.1563e-05       -22.669500672758
     5.9605e+00     5.9605e+01             2.5263e-05       -22.669501468699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7330
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235791e-02 1 1  ON 2
 uu_3                -5.547678e-02 1 1  ON 3
 uu_4                -9.668812e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458537e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141427e-01 1 1  ON 9
 ud_0                 4.217082e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652492e-03 1 1  ON 12
 ud_3                -8.647387e-02 1 1  ON 13
 ud_4                -1.301007e-01 1 1  ON 14
 ud_5                -1.561733e-01 1 1  ON 15
 ud_6                -1.703117e-01 1 1  ON 16
 ud_7                -1.735734e-01 1 1  ON 17
 ud_8                -1.625506e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271607e-02 1 1  ON 23
 eC_4                 5.204118e-02 1 1  ON 24
 eC_5                 1.593223e-01 1 1  ON 25
 eC_6                 2.584454e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123520e-01 1 1  ON 28
 eC_9                 9.906144e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239367e-01 1 1  ON 31
 eO_2                -3.575107e-01 1 1  ON 32
 eO_3                -1.244441e-02 1 1  ON 33
 eO_4                 2.170797e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386143e-01 1 1  ON 36
 eO_7                 4.459947e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356040e-01 1 1  ON 39
eH1_0                -2.156640e-01 1 1  ON 40
eH1_1                -1.224211e-01 1 1  ON 41
eH1_2                -8.478336e-02 1 1  ON 42
eH1_3                -6.439064e-02 1 1  ON 43
eH1_4                 7.210801e-03 1 1  ON 44
eH1_5                 5.320840e-02 1 1  ON 45
eH1_6                 8.981209e-02 1 1  ON 46
eH1_7                 6.284861e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723187e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172469e-01 1 1  ON 51
eH2_2                -7.976647e-02 1 1  ON 52
eH2_3                -5.946695e-02 1 1  ON 53
eH2_4                 1.223677e-02 1 1  ON 54
eH2_5                 5.798773e-02 1 1  ON 55
eH2_6                 9.442624e-02 1 1  ON 56
eH2_7                 6.731763e-02 1 1  ON 57
eH2_8                 2.568543e-02 1 1  ON 58
eH2_9                 5.813615e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2230e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6866
    reference variance = 0.480995
====================================================
  Execution time = 4.4379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5010e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522928252351
                                         uncertainty =       0.004430784643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.522928252351
                                         uncertainty =       0.004430784643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511476126
  error estimate for blocks of size 2^( 2) =       0.000528777671
  error estimate for blocks of size 2^( 3) =       0.000544260319
  error estimate for blocks of size 2^( 4) =       0.000556521738
  error estimate for blocks of size 2^( 5) =       0.000561756273
  error estimate for blocks of size 2^( 6) =       0.000563763514
  error estimate for blocks of size 2^( 7) =       0.000566886687

      target function =                  N/A
              le_mean =     -22.670153923495
             les_mean =     514.459094308985
             stat err =       0.000562232053
             autocorr =       1.208315836346
              std dev =       0.723336474709
             le_variance =       0.523215655645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267015392349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670153923495       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670153908002       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670153966478       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670153952301       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670154029129       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670154079694       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670154026111       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670154031850       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670154087666       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670154081300       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+00 is 5.032273e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670153923495       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670153919469       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670153934189       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670153926269       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670153943296       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670153955393       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670153944845       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670153947306       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670153963127       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670153960937       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+01 is 1.297276e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670153923495       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670153922478       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670153926164       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670153923870       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670153927943       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670153930904       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670153928444       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670153929143       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670153933253       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+01 is 3.252785e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9402e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 3.020729e-01 1 1  ON 0
 uu_1                 1.262703e-01 1 1  ON 1
 uu_2                 1.235908e-02 1 1  ON 2
 uu_3                -5.547359e-02 1 1  ON 3
 uu_4                -9.668761e-02 1 1  ON 4
 uu_5                -1.234901e-01 1 1  ON 5
 uu_6                -1.400922e-01 1 1  ON 6
 uu_7                -1.458521e-01 1 1  ON 7
 uu_8                -1.390076e-01 1 1  ON 8
 uu_9                -1.141409e-01 1 1  ON 9
 ud_0                 4.217175e-01 1 1  ON 10
 ud_1                 1.393005e-01 1 1  ON 11
 ud_2                -7.656257e-03 1 1  ON 12
 ud_3                -8.647012e-02 1 1  ON 13
 ud_4                -1.301035e-01 1 1  ON 14
 ud_5                -1.561715e-01 1 1  ON 15
 ud_6                -1.703150e-01 1 1  ON 16
 ud_7                -1.735771e-01 1 1  ON 17
 ud_8                -1.625430e-01 1 1  ON 18
 ud_9                -1.349559e-01 1 1  ON 19
 eC_0                -5.956587e-01 1 1  ON 20
 eC_1                -4.431273e-01 1 1  ON 21
 eC_2                -1.898644e-01 1 1  ON 22
 eC_3                -3.272905e-02 1 1  ON 23
 eC_4                 5.203812e-02 1 1  ON 24
 eC_5                 1.593255e-01 1 1  ON 25
 eC_6                 2.584468e-01 1 1  ON 26
 eC_7                 3.713342e-01 1 1  ON 27
 eC_8                 3.123583e-01 1 1  ON 28
 eC_9                 9.906477e-02 1 1  ON 29
 eO_0                -1.202276e+00 1 1  ON 30
 eO_1                -8.239291e-01 1 1  ON 31
 eO_2                -3.575199e-01 1 1  ON 32
 eO_3                -1.245712e-02 1 1  ON 33
 eO_4                 2.170800e-01 1 1  ON 34
 eO_5                 3.877795e-01 1 1  ON 35
 eO_6                 4.386087e-01 1 1  ON 36
 eO_7                 4.459955e-01 1 1  ON 37
 eO_8                 4.055488e-01 1 1  ON 38
 eO_9                 3.356088e-01 1 1  ON 39
eH1_0                -2.156596e-01 1 1  ON 40
eH1_1                -1.224222e-01 1 1  ON 41
eH1_2                -8.478969e-02 1 1  ON 42
eH1_3                -6.439387e-02 1 1  ON 43
eH1_4                 7.206408e-03 1 1  ON 44
eH1_5                 5.321053e-02 1 1  ON 45
eH1_6                 8.981416e-02 1 1  ON 46
eH1_7                 6.285141e-02 1 1  ON 47
eH1_8                 2.227639e-02 1 1  ON 48
eH1_9                 5.723015e-02 1 1  ON 49
eH2_0                -2.102223e-01 1 1  ON 50
eH2_1                -1.172500e-01 1 1  ON 51
eH2_2                -7.976345e-02 1 1  ON 52
eH2_3                -5.946773e-02 1 1  ON 53
eH2_4                 1.223473e-02 1 1  ON 54
eH2_5                 5.798760e-02 1 1  ON 55
eH2_6                 9.442637e-02 1 1  ON 56
eH2_7                 6.731935e-02 1 1  ON 57
eH2_8                 2.568748e-02 1 1  ON 58
eH2_9                 5.813526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7082
    reference variance = 0.414563
====================================================
  Execution time = 4.6043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1713e-01
  Total weights = 2.0000e+06
  Execution time = 3.6844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517096811244
                                         uncertainty =       0.005905990472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517096811244
                                         uncertainty =       0.005905990472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508486428
  error estimate for blocks of size 2^( 2) =       0.000525876229
  error estimate for blocks of size 2^( 3) =       0.000541183504
  error estimate for blocks of size 2^( 4) =       0.000552077062
  error estimate for blocks of size 2^( 5) =       0.000558854365
  error estimate for blocks of size 2^( 6) =       0.000562405957
  error estimate for blocks of size 2^( 7) =       0.000564132714

      target function =                  N/A
              le_mean =     -22.669975111066
             les_mean =     514.444888172813
             stat err =       0.000559367525
             autocorr =       1.210140417772
              std dev =       0.719108402834
             le_variance =       0.517116895027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517142354785
                                         uncertainty =       0.005907832520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517142354785
                                         uncertainty =       0.005907832520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508508816
  error estimate for blocks of size 2^( 2) =       0.000525897399
  error estimate for blocks of size 2^( 3) =       0.000541204210
  error estimate for blocks of size 2^( 4) =       0.000552097351
  error estimate for blocks of size 2^( 5) =       0.000558874522
  error estimate for blocks of size 2^( 6) =       0.000562423949
  error estimate for blocks of size 2^( 7) =       0.000564150598

      target function =                  N/A
              le_mean =     -22.669975009683
             les_mean =     514.444929112363
             stat err =       0.000559386605
             autocorr =       1.210116415295
              std dev =       0.719140063756
             le_variance =       0.517162431299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517123118759
                                         uncertainty =       0.005907020476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517123118759
                                         uncertainty =       0.005907020476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508499360
  error estimate for blocks of size 2^( 2) =       0.000525888465
  error estimate for blocks of size 2^( 3) =       0.000541195443
  error estimate for blocks of size 2^( 4) =       0.000552088748
  error estimate for blocks of size 2^( 5) =       0.000558865975
  error estimate for blocks of size 2^( 6) =       0.000562416408
  error estimate for blocks of size 2^( 7) =       0.000564143093

      target function =                  N/A
              le_mean =     -22.669975065201
             les_mean =     514.444912396933
             stat err =       0.000559378556
             autocorr =       1.210126594261
              std dev =       0.719126691683
             le_variance =       0.517143198691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517100276282
                                         uncertainty =       0.005906121911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517100276282
                                         uncertainty =       0.005906121911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508488131
  error estimate for blocks of size 2^( 2) =       0.000525877841
  error estimate for blocks of size 2^( 3) =       0.000541185073
  error estimate for blocks of size 2^( 4) =       0.000552078597
  error estimate for blocks of size 2^( 5) =       0.000558855890
  error estimate for blocks of size 2^( 6) =       0.000562407334
  error estimate for blocks of size 2^( 7) =       0.000564134079

      target function =                  N/A
              le_mean =     -22.669975103572
             les_mean =     514.444891297631
             stat err =       0.000559368975
             autocorr =       1.210138585499
              std dev =       0.719110811776
             le_variance =       0.517120359613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669975111066        initial  <--
     3.7253e+00     3.7253e+01             5.0323e-05       -22.669975009683
     1.4901e+01     1.4901e+02             1.2973e-05       -22.669975065201
     5.9605e+01     5.9605e+02             3.2528e-06       -22.669975103572

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2860
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235791e-02 1 1  ON 2
 uu_3                -5.547678e-02 1 1  ON 3
 uu_4                -9.668812e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458537e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141427e-01 1 1  ON 9
 ud_0                 4.217082e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652492e-03 1 1  ON 12
 ud_3                -8.647387e-02 1 1  ON 13
 ud_4                -1.301007e-01 1 1  ON 14
 ud_5                -1.561733e-01 1 1  ON 15
 ud_6                -1.703117e-01 1 1  ON 16
 ud_7                -1.735734e-01 1 1  ON 17
 ud_8                -1.625506e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271607e-02 1 1  ON 23
 eC_4                 5.204118e-02 1 1  ON 24
 eC_5                 1.593223e-01 1 1  ON 25
 eC_6                 2.584454e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123520e-01 1 1  ON 28
 eC_9                 9.906144e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239367e-01 1 1  ON 31
 eO_2                -3.575107e-01 1 1  ON 32
 eO_3                -1.244441e-02 1 1  ON 33
 eO_4                 2.170797e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386143e-01 1 1  ON 36
 eO_7                 4.459947e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356040e-01 1 1  ON 39
eH1_0                -2.156640e-01 1 1  ON 40
eH1_1                -1.224211e-01 1 1  ON 41
eH1_2                -8.478336e-02 1 1  ON 42
eH1_3                -6.439064e-02 1 1  ON 43
eH1_4                 7.210801e-03 1 1  ON 44
eH1_5                 5.320840e-02 1 1  ON 45
eH1_6                 8.981209e-02 1 1  ON 46
eH1_7                 6.284861e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723187e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172469e-01 1 1  ON 51
eH2_2                -7.976647e-02 1 1  ON 52
eH2_3                -5.946695e-02 1 1  ON 53
eH2_4                 1.223677e-02 1 1  ON 54
eH2_5                 5.798773e-02 1 1  ON 55
eH2_6                 9.442624e-02 1 1  ON 56
eH2_7                 6.731763e-02 1 1  ON 57
eH2_8                 2.568543e-02 1 1  ON 58
eH2_9                 5.813615e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2370e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6736
    reference variance = 0.528704
====================================================
  Execution time = 4.4852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.2072e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5202e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520735612293
                                         uncertainty =       0.005787240733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520735612293
                                         uncertainty =       0.005787240733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510252971
  error estimate for blocks of size 2^( 2) =       0.000527520077
  error estimate for blocks of size 2^( 3) =       0.000542473605
  error estimate for blocks of size 2^( 4) =       0.000553559566
  error estimate for blocks of size 2^( 5) =       0.000559435886
  error estimate for blocks of size 2^( 6) =       0.000564544949
  error estimate for blocks of size 2^( 7) =       0.000563547633

      target function =                  N/A
              le_mean =     -22.669993096023
             les_mean =     514.449302903155
             stat err =       0.000560272009
             autocorr =       1.205665312088
              std dev =       0.721606672481
             le_variance =       0.520716189769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266999309602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669993096023       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669993091821       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669993087392       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669993098088       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669993110313       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669993118247       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669993112734       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669993115351       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669993118213       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669993120684       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+01 is 4.058641e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669993096023       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669993094970       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669993093853       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669993096545       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669993099622       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669993101654       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669993100284       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669993100936       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669993101665       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669993102280       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+02 is 1.019573e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669993096023       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669993095760       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669993095480       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669993096154       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669993096925       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669993097435       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669993097092       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669993097256       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669993097442       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669993097596       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+02 is 2.552043e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0067e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 3.020768e-01 1 1  ON 0
 uu_1                 1.262705e-01 1 1  ON 1
 uu_2                 1.235772e-02 1 1  ON 2
 uu_3                -5.547662e-02 1 1  ON 3
 uu_4                -9.668798e-02 1 1  ON 4
 uu_5                -1.234803e-01 1 1  ON 5
 uu_6                -1.400963e-01 1 1  ON 6
 uu_7                -1.458536e-01 1 1  ON 7
 uu_8                -1.390142e-01 1 1  ON 8
 uu_9                -1.141433e-01 1 1  ON 9
 ud_0                 4.217091e-01 1 1  ON 10
 ud_1                 1.393091e-01 1 1  ON 11
 ud_2                -7.652187e-03 1 1  ON 12
 ud_3                -8.647349e-02 1 1  ON 13
 ud_4                -1.301005e-01 1 1  ON 14
 ud_5                -1.561732e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735737e-01 1 1  ON 17
 ud_8                -1.625507e-01 1 1  ON 18
 ud_9                -1.349627e-01 1 1  ON 19
 eC_0                -5.956615e-01 1 1  ON 20
 eC_1                -4.431306e-01 1 1  ON 21
 eC_2                -1.898608e-01 1 1  ON 22
 eC_3                -3.271681e-02 1 1  ON 23
 eC_4                 5.204112e-02 1 1  ON 24
 eC_5                 1.593217e-01 1 1  ON 25
 eC_6                 2.584457e-01 1 1  ON 26
 eC_7                 3.713349e-01 1 1  ON 27
 eC_8                 3.123527e-01 1 1  ON 28
 eC_9                 9.906174e-02 1 1  ON 29
 eO_0                -1.202279e+00 1 1  ON 30
 eO_1                -8.239369e-01 1 1  ON 31
 eO_2                -3.575109e-01 1 1  ON 32
 eO_3                -1.244543e-02 1 1  ON 33
 eO_4                 2.170796e-01 1 1  ON 34
 eO_5                 3.877751e-01 1 1  ON 35
 eO_6                 4.386144e-01 1 1  ON 36
 eO_7                 4.459941e-01 1 1  ON 37
 eO_8                 4.055491e-01 1 1  ON 38
 eO_9                 3.356044e-01 1 1  ON 39
eH1_0                -2.156632e-01 1 1  ON 40
eH1_1                -1.224212e-01 1 1  ON 41
eH1_2                -8.478332e-02 1 1  ON 42
eH1_3                -6.439130e-02 1 1  ON 43
eH1_4                 7.209937e-03 1 1  ON 44
eH1_5                 5.320815e-02 1 1  ON 45
eH1_6                 8.981234e-02 1 1  ON 46
eH1_7                 6.284906e-02 1 1  ON 47
eH1_8                 2.227439e-02 1 1  ON 48
eH1_9                 5.723188e-02 1 1  ON 49
eH2_0                -2.102187e-01 1 1  ON 50
eH2_1                -1.172476e-01 1 1  ON 51
eH2_2                -7.976627e-02 1 1  ON 52
eH2_3                -5.946638e-02 1 1  ON 53
eH2_4                 1.223663e-02 1 1  ON 54
eH2_5                 5.798785e-02 1 1  ON 55
eH2_6                 9.442545e-02 1 1  ON 56
eH2_7                 6.731787e-02 1 1  ON 57
eH2_8                 2.568568e-02 1 1  ON 58
eH2_9                 5.813609e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6313
    reference variance = 0.69961
====================================================
  Execution time = 4.4751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0836e-01
  Total weights = 2.0000e+06
  Execution time = 3.6769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508382266696
                                         uncertainty =       0.003446544666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508382266696
                                         uncertainty =       0.003446544666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504164774
  error estimate for blocks of size 2^( 2) =       0.000521502785
  error estimate for blocks of size 2^( 3) =       0.000537003104
  error estimate for blocks of size 2^( 4) =       0.000548736318
  error estimate for blocks of size 2^( 5) =       0.000555432781
  error estimate for blocks of size 2^( 6) =       0.000558478757
  error estimate for blocks of size 2^( 7) =       0.000559860622

      target function =                  N/A
              le_mean =     -22.669693639935
             les_mean =     514.423373712916
             stat err =       0.000555627119
             autocorr =       1.214568108122
              std dev =       0.712996661005
             le_variance =       0.508364238604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508386265792
                                         uncertainty =       0.003446584793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508386265792
                                         uncertainty =       0.003446584793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504166756
  error estimate for blocks of size 2^( 2) =       0.000521504651
  error estimate for blocks of size 2^( 3) =       0.000537004916
  error estimate for blocks of size 2^( 4) =       0.000548738067
  error estimate for blocks of size 2^( 5) =       0.000555434447
  error estimate for blocks of size 2^( 6) =       0.000558480474
  error estimate for blocks of size 2^( 7) =       0.000559862355

      target function =                  N/A
              le_mean =     -22.669693639806
             les_mean =     514.423377704541
             stat err =       0.000555628836
             autocorr =       1.214566061346
              std dev =       0.712999464297
             le_variance =       0.508368236087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508384294839
                                         uncertainty =       0.003446565050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508384294839
                                         uncertainty =       0.003446565050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504165779
  error estimate for blocks of size 2^( 2) =       0.000521503731
  error estimate for blocks of size 2^( 3) =       0.000537004023
  error estimate for blocks of size 2^( 4) =       0.000548737205
  error estimate for blocks of size 2^( 5) =       0.000555433626
  error estimate for blocks of size 2^( 6) =       0.000558479627
  error estimate for blocks of size 2^( 7) =       0.000559861501

      target function =                  N/A
              le_mean =     -22.669693639845
             les_mean =     514.423375736157
             stat err =       0.000555627990
             autocorr =       1.214567069484
              std dev =       0.712998082698
             le_variance =       0.508366265931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508382521099
                                         uncertainty =       0.003446547225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508382521099
                                         uncertainty =       0.003446547225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504164900
  error estimate for blocks of size 2^( 2) =       0.000521502903
  error estimate for blocks of size 2^( 3) =       0.000537003219
  error estimate for blocks of size 2^( 4) =       0.000548736429
  error estimate for blocks of size 2^( 5) =       0.000555432887
  error estimate for blocks of size 2^( 6) =       0.000558478866
  error estimate for blocks of size 2^( 7) =       0.000559860732

      target function =                  N/A
              le_mean =     -22.669693639920
             les_mean =     514.423373966535
             stat err =       0.000555627229
             autocorr =       1.214567977801
              std dev =       0.712996839336
             le_variance =       0.508364492903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669693639935        initial  <--
     3.7253e+01     3.7253e+02             4.0586e-06       -22.669693639806
     1.4901e+02     1.4901e+03             1.0196e-06       -22.669693639845
     5.9605e+02     5.9605e+03             2.5520e-07       -22.669693639920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1125
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235791e-02 1 1  ON 2
 uu_3                -5.547678e-02 1 1  ON 3
 uu_4                -9.668812e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458537e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141427e-01 1 1  ON 9
 ud_0                 4.217082e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652492e-03 1 1  ON 12
 ud_3                -8.647387e-02 1 1  ON 13
 ud_4                -1.301007e-01 1 1  ON 14
 ud_5                -1.561733e-01 1 1  ON 15
 ud_6                -1.703117e-01 1 1  ON 16
 ud_7                -1.735734e-01 1 1  ON 17
 ud_8                -1.625506e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271607e-02 1 1  ON 23
 eC_4                 5.204118e-02 1 1  ON 24
 eC_5                 1.593223e-01 1 1  ON 25
 eC_6                 2.584454e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123520e-01 1 1  ON 28
 eC_9                 9.906144e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239367e-01 1 1  ON 31
 eO_2                -3.575107e-01 1 1  ON 32
 eO_3                -1.244441e-02 1 1  ON 33
 eO_4                 2.170797e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386143e-01 1 1  ON 36
 eO_7                 4.459947e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356040e-01 1 1  ON 39
eH1_0                -2.156640e-01 1 1  ON 40
eH1_1                -1.224211e-01 1 1  ON 41
eH1_2                -8.478336e-02 1 1  ON 42
eH1_3                -6.439064e-02 1 1  ON 43
eH1_4                 7.210801e-03 1 1  ON 44
eH1_5                 5.320840e-02 1 1  ON 45
eH1_6                 8.981209e-02 1 1  ON 46
eH1_7                 6.284861e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723187e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172469e-01 1 1  ON 51
eH2_2                -7.976647e-02 1 1  ON 52
eH2_3                -5.946695e-02 1 1  ON 53
eH2_4                 1.223677e-02 1 1  ON 54
eH2_5                 5.798773e-02 1 1  ON 55
eH2_6                 9.442624e-02 1 1  ON 56
eH2_7                 6.731763e-02 1 1  ON 57
eH2_8                 2.568543e-02 1 1  ON 58
eH2_9                 5.813615e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2331e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2677e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.669
    reference variance = 0.944333
====================================================
  Execution time = 4.4680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5218e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518899276362
                                         uncertainty =       0.004398005630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518899276362
                                         uncertainty =       0.004398005630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509368123
  error estimate for blocks of size 2^( 2) =       0.000527186952
  error estimate for blocks of size 2^( 3) =       0.000542656277
  error estimate for blocks of size 2^( 4) =       0.000553013240
  error estimate for blocks of size 2^( 5) =       0.000558319355
  error estimate for blocks of size 2^( 6) =       0.000561413822
  error estimate for blocks of size 2^( 7) =       0.000564471389

      target function =                  N/A
              le_mean =     -22.670409918043
             les_mean =     514.466397362771
             stat err =       0.000559304451
             autocorr =       1.205682689987
              std dev =       0.720355308240
             le_variance =       0.518911770109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267040991804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670409918043       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670409919903       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670409921501       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670409923131       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670409924780       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670409924351       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670409923954       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670409923758       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670409924203       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670409924091       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+02 is 4.718655e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670409918043       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670409918508       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670409918908       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670409919316       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670409919729       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670409919621       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670409919520       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670409919475       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670409919587       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670409919555       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.180217e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670409918043       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670409918160       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670409918260       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670409918360       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670409918465       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670409918438       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670409918413       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670409918381       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670409918449       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670409918429       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 2.950890e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9911e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235793e-02 1 1  ON 2
 uu_3                -5.547670e-02 1 1  ON 3
 uu_4                -9.668817e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458537e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141427e-01 1 1  ON 9
 ud_0                 4.217081e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652500e-03 1 1  ON 12
 ud_3                -8.647387e-02 1 1  ON 13
 ud_4                -1.301007e-01 1 1  ON 14
 ud_5                -1.561734e-01 1 1  ON 15
 ud_6                -1.703116e-01 1 1  ON 16
 ud_7                -1.735734e-01 1 1  ON 17
 ud_8                -1.625505e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271614e-02 1 1  ON 23
 eC_4                 5.204121e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584453e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123521e-01 1 1  ON 28
 eC_9                 9.906147e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239367e-01 1 1  ON 31
 eO_2                -3.575108e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170798e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386142e-01 1 1  ON 36
 eO_7                 4.459947e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356040e-01 1 1  ON 39
eH1_0                -2.156639e-01 1 1  ON 40
eH1_1                -1.224210e-01 1 1  ON 41
eH1_2                -8.478343e-02 1 1  ON 42
eH1_3                -6.439070e-02 1 1  ON 43
eH1_4                 7.210863e-03 1 1  ON 44
eH1_5                 5.320842e-02 1 1  ON 45
eH1_6                 8.981199e-02 1 1  ON 46
eH1_7                 6.284860e-02 1 1  ON 47
eH1_8                 2.227433e-02 1 1  ON 48
eH1_9                 5.723185e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172470e-01 1 1  ON 51
eH2_2                -7.976649e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223681e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442624e-02 1 1  ON 56
eH2_7                 6.731768e-02 1 1  ON 57
eH2_8                 2.568547e-02 1 1  ON 58
eH2_9                 5.813615e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6019
    reference variance = 0.42911
====================================================
  Execution time = 4.4280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0239e-01
  Total weights = 2.0000e+06
  Execution time = 3.6999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418633123
                                         uncertainty =       0.003044249497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418633123
                                         uncertainty =       0.003044249497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501192031
  error estimate for blocks of size 2^( 2) =       0.000518875596
  error estimate for blocks of size 2^( 3) =       0.000534763932
  error estimate for blocks of size 2^( 4) =       0.000546208914
  error estimate for blocks of size 2^( 5) =       0.000552854407
  error estimate for blocks of size 2^( 6) =       0.000557269293
  error estimate for blocks of size 2^( 7) =       0.000559048752

      target function =                  N/A
              le_mean =     -22.670336514880
             les_mean =     514.446544350645
             stat err =       0.000553845342
             autocorr =       1.221149118019
              std dev =       0.708792567633
             le_variance =       0.502386903932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418169384
                                         uncertainty =       0.003044247258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418169384
                                         uncertainty =       0.003044247258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501191800
  error estimate for blocks of size 2^( 2) =       0.000518875378
  error estimate for blocks of size 2^( 3) =       0.000534763722
  error estimate for blocks of size 2^( 4) =       0.000546208716
  error estimate for blocks of size 2^( 5) =       0.000552854209
  error estimate for blocks of size 2^( 6) =       0.000557269095
  error estimate for blocks of size 2^( 7) =       0.000559048555

      target function =                  N/A
              le_mean =     -22.670336514899
             les_mean =     514.446543887663
             stat err =       0.000553845144
             autocorr =       1.221149372678
              std dev =       0.708792240442
             le_variance =       0.502386440111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418401055
                                         uncertainty =       0.003044248376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418401055
                                         uncertainty =       0.003044248376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501191915
  error estimate for blocks of size 2^( 2) =       0.000518875487
  error estimate for blocks of size 2^( 3) =       0.000534763827
  error estimate for blocks of size 2^( 4) =       0.000546208815
  error estimate for blocks of size 2^( 5) =       0.000552854308
  error estimate for blocks of size 2^( 6) =       0.000557269194
  error estimate for blocks of size 2^( 7) =       0.000559048653

      target function =                  N/A
              le_mean =     -22.670336514889
             les_mean =     514.446544118941
             stat err =       0.000553845242
             autocorr =       1.221149245433
              std dev =       0.708792403898
             le_variance =       0.502386671823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418604108
                                         uncertainty =       0.003044249357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502418604108
                                         uncertainty =       0.003044249357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501192017
  error estimate for blocks of size 2^( 2) =       0.000518875582
  error estimate for blocks of size 2^( 3) =       0.000534763919
  error estimate for blocks of size 2^( 4) =       0.000546208902
  error estimate for blocks of size 2^( 5) =       0.000552854394
  error estimate for blocks of size 2^( 6) =       0.000557269281
  error estimate for blocks of size 2^( 7) =       0.000559048740

      target function =                  N/A
              le_mean =     -22.670336514881
             les_mean =     514.446544321672
             stat err =       0.000553845329
             autocorr =       1.221149133949
              std dev =       0.708792547161
             le_variance =       0.502386874912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670336514880        initial
     3.7253e+02     3.7253e+03             4.7187e-07       -22.670336514899  <--
     1.4901e+03     1.4901e+04             1.1802e-07       -22.670336514889
     5.9605e+03     5.9605e+04             2.9509e-08       -22.670336514881

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 6.2691e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262697e-01 1 1  ON 1
 uu_2                 1.235799e-02 1 1  ON 2
 uu_3                -5.547646e-02 1 1  ON 3
 uu_4                -9.668832e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217078e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652523e-03 1 1  ON 12
 ud_3                -8.647388e-02 1 1  ON 13
 ud_4                -1.301005e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625503e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431315e-01 1 1  ON 21
 eC_2                -1.898607e-01 1 1  ON 22
 eC_3                -3.271633e-02 1 1  ON 23
 eC_4                 5.204132e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123522e-01 1 1  ON 28
 eC_9                 9.906156e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239366e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170800e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386141e-01 1 1  ON 36
 eO_7                 4.459948e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356041e-01 1 1  ON 39
eH1_0                -2.156637e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478365e-02 1 1  ON 42
eH1_3                -6.439088e-02 1 1  ON 43
eH1_4                 7.211051e-03 1 1  ON 44
eH1_5                 5.320846e-02 1 1  ON 45
eH1_6                 8.981171e-02 1 1  ON 46
eH1_7                 6.284857e-02 1 1  ON 47
eH1_8                 2.227429e-02 1 1  ON 48
eH1_9                 5.723181e-02 1 1  ON 49
eH2_0                -2.102187e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976652e-02 1 1  ON 52
eH2_3                -5.946705e-02 1 1  ON 53
eH2_4                 1.223693e-02 1 1  ON 54
eH2_5                 5.798757e-02 1 1  ON 55
eH2_6                 9.442626e-02 1 1  ON 56
eH2_7                 6.731782e-02 1 1  ON 57
eH2_8                 2.568559e-02 1 1  ON 58
eH2_9                 5.813614e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2262e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2676e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7439
    reference variance = 0.674152
====================================================
  Execution time = 4.5780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.2506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5552e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525104020088
                                         uncertainty =       0.010876760669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525104020088
                                         uncertainty =       0.010876760669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512375482
  error estimate for blocks of size 2^( 2) =       0.000530000935
  error estimate for blocks of size 2^( 3) =       0.000545704575
  error estimate for blocks of size 2^( 4) =       0.000556775122
  error estimate for blocks of size 2^( 5) =       0.000563129543
  error estimate for blocks of size 2^( 6) =       0.000566793748
  error estimate for blocks of size 2^( 7) =       0.000568349693

      target function =                  N/A
              le_mean =     -22.670729358976
             les_mean =     514.487026675269
             stat err =       0.000563762026
             autocorr =       1.210639831841
              std dev =       0.724608356180
             le_variance =       0.525057269846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267072935898e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670729358976       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670729371172       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670729373182       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670729374343       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670729370637       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670729373899       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670729366581       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670729363899       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670729364788       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670729364909       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+01 is 1.969104e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670729358976       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670729362032       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670729362536       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670729362829       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670729361901       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670729362717       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670729360886       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670729360212       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670729360433       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670729360462       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+02 is 4.926582e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670729358976       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670729359741       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670729359867       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670729359941       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670729359708       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670729359913       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670729359453       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670729359283       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670729359342       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670729359345       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.231885e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1348e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 3.020762e-01 1 1  ON 0
 uu_1                 1.262697e-01 1 1  ON 1
 uu_2                 1.235811e-02 1 1  ON 2
 uu_3                -5.547662e-02 1 1  ON 3
 uu_4                -9.668841e-02 1 1  ON 4
 uu_5                -1.234800e-01 1 1  ON 5
 uu_6                -1.400970e-01 1 1  ON 6
 uu_7                -1.458536e-01 1 1  ON 7
 uu_8                -1.390136e-01 1 1  ON 8
 uu_9                -1.141423e-01 1 1  ON 9
 ud_0                 4.217074e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652523e-03 1 1  ON 12
 ud_3                -8.647373e-02 1 1  ON 13
 ud_4                -1.301003e-01 1 1  ON 14
 ud_5                -1.561734e-01 1 1  ON 15
 ud_6                -1.703116e-01 1 1  ON 16
 ud_7                -1.735733e-01 1 1  ON 17
 ud_8                -1.625498e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956613e-01 1 1  ON 20
 eC_1                -4.431314e-01 1 1  ON 21
 eC_2                -1.898608e-01 1 1  ON 22
 eC_3                -3.271663e-02 1 1  ON 23
 eC_4                 5.204125e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584453e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906166e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239364e-01 1 1  ON 31
 eO_2                -3.575111e-01 1 1  ON 32
 eO_3                -1.244460e-02 1 1  ON 33
 eO_4                 2.170797e-01 1 1  ON 34
 eO_5                 3.877752e-01 1 1  ON 35
 eO_6                 4.386139e-01 1 1  ON 36
 eO_7                 4.459948e-01 1 1  ON 37
 eO_8                 4.055493e-01 1 1  ON 38
 eO_9                 3.356043e-01 1 1  ON 39
eH1_0                -2.156637e-01 1 1  ON 40
eH1_1                -1.224207e-01 1 1  ON 41
eH1_2                -8.478374e-02 1 1  ON 42
eH1_3                -6.439082e-02 1 1  ON 43
eH1_4                 7.210992e-03 1 1  ON 44
eH1_5                 5.320823e-02 1 1  ON 45
eH1_6                 8.981177e-02 1 1  ON 46
eH1_7                 6.284865e-02 1 1  ON 47
eH1_8                 2.227437e-02 1 1  ON 48
eH1_9                 5.723177e-02 1 1  ON 49
eH2_0                -2.102187e-01 1 1  ON 50
eH2_1                -1.172474e-01 1 1  ON 51
eH2_2                -7.976654e-02 1 1  ON 52
eH2_3                -5.946705e-02 1 1  ON 53
eH2_4                 1.223666e-02 1 1  ON 54
eH2_5                 5.798754e-02 1 1  ON 55
eH2_6                 9.442625e-02 1 1  ON 56
eH2_7                 6.731808e-02 1 1  ON 57
eH2_8                 2.568579e-02 1 1  ON 58
eH2_9                 5.813616e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7698
    reference variance = 0.357173
====================================================
  Execution time = 4.4752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1115e-01
  Total weights = 2.0000e+06
  Execution time = 3.6936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133953945
                                         uncertainty =       0.004199162860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133953945
                                         uncertainty =       0.004199162860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505543231
  error estimate for blocks of size 2^( 2) =       0.000523074169
  error estimate for blocks of size 2^( 3) =       0.000538813058
  error estimate for blocks of size 2^( 4) =       0.000550042969
  error estimate for blocks of size 2^( 5) =       0.000557281498
  error estimate for blocks of size 2^( 6) =       0.000562238311
  error estimate for blocks of size 2^( 7) =       0.000567634340

      target function =                  N/A
              le_mean =     -22.670009502548
             les_mean =     514.440478507550
             stat err =       0.000559299280
             autocorr =       1.223973231132
              std dev =       0.714946094125
             le_variance =       0.511147917505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511132062438
                                         uncertainty =       0.004199156729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511132062438
                                         uncertainty =       0.004199156729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505542295
  error estimate for blocks of size 2^( 2) =       0.000523073269
  error estimate for blocks of size 2^( 3) =       0.000538812198
  error estimate for blocks of size 2^( 4) =       0.000550042150
  error estimate for blocks of size 2^( 5) =       0.000557280689
  error estimate for blocks of size 2^( 6) =       0.000562237520
  error estimate for blocks of size 2^( 7) =       0.000567633622

      target function =                  N/A
              le_mean =     -22.670009500407
             les_mean =     514.440476517896
             stat err =       0.000559298496
             autocorr =       1.223974331992
              std dev =       0.714944770534
             le_variance =       0.511146024914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133005396
                                         uncertainty =       0.004199159774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133005396
                                         uncertainty =       0.004199159774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505542762
  error estimate for blocks of size 2^( 2) =       0.000523073717
  error estimate for blocks of size 2^( 3) =       0.000538812627
  error estimate for blocks of size 2^( 4) =       0.000550042558
  error estimate for blocks of size 2^( 5) =       0.000557281093
  error estimate for blocks of size 2^( 6) =       0.000562237915
  error estimate for blocks of size 2^( 7) =       0.000567633980

      target function =                  N/A
              le_mean =     -22.670009501465
             les_mean =     514.440477509336
             stat err =       0.000559298886
             autocorr =       1.223973782922
              std dev =       0.714945430374
             le_variance =       0.511146968413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133835285
                                         uncertainty =       0.004199162474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511133835285
                                         uncertainty =       0.004199162474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505543173
  error estimate for blocks of size 2^( 2) =       0.000523074112
  error estimate for blocks of size 2^( 3) =       0.000538813004
  error estimate for blocks of size 2^( 4) =       0.000550042917
  error estimate for blocks of size 2^( 5) =       0.000557281447
  error estimate for blocks of size 2^( 6) =       0.000562238261
  error estimate for blocks of size 2^( 7) =       0.000567634295

      target function =                  N/A
              le_mean =     -22.670009502412
             les_mean =     514.440478382637
             stat err =       0.000559299230
             autocorr =       1.223973300141
              std dev =       0.714946011092
             le_variance =       0.511147798777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670009502548        initial  <--
     9.3132e+01     9.3132e+02             1.9691e-06       -22.670009500407
     3.7253e+02     3.7253e+03             4.9266e-07       -22.670009501465
     1.4901e+03     1.4901e+04             1.2319e-07       -22.670009502412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0762
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 3.020765e-01 1 1  ON 0
 uu_1                 1.262697e-01 1 1  ON 1
 uu_2                 1.235799e-02 1 1  ON 2
 uu_3                -5.547646e-02 1 1  ON 3
 uu_4                -9.668832e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390141e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217078e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652523e-03 1 1  ON 12
 ud_3                -8.647388e-02 1 1  ON 13
 ud_4                -1.301005e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625503e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431315e-01 1 1  ON 21
 eC_2                -1.898607e-01 1 1  ON 22
 eC_3                -3.271633e-02 1 1  ON 23
 eC_4                 5.204132e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123522e-01 1 1  ON 28
 eC_9                 9.906156e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239366e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170800e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386141e-01 1 1  ON 36
 eO_7                 4.459948e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356041e-01 1 1  ON 39
eH1_0                -2.156637e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478365e-02 1 1  ON 42
eH1_3                -6.439088e-02 1 1  ON 43
eH1_4                 7.211051e-03 1 1  ON 44
eH1_5                 5.320846e-02 1 1  ON 45
eH1_6                 8.981171e-02 1 1  ON 46
eH1_7                 6.284857e-02 1 1  ON 47
eH1_8                 2.227429e-02 1 1  ON 48
eH1_9                 5.723181e-02 1 1  ON 49
eH2_0                -2.102187e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976652e-02 1 1  ON 52
eH2_3                -5.946705e-02 1 1  ON 53
eH2_4                 1.223693e-02 1 1  ON 54
eH2_5                 5.798757e-02 1 1  ON 55
eH2_6                 9.442626e-02 1 1  ON 56
eH2_7                 6.731782e-02 1 1  ON 57
eH2_8                 2.568559e-02 1 1  ON 58
eH2_9                 5.813614e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2443e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7307
    reference variance = 0.605873
====================================================
  Execution time = 4.4204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.4149e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5030e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.541545997009
                                         uncertainty =       0.029925829019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.541545997009
                                         uncertainty =       0.029925829019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000520333975
  error estimate for blocks of size 2^( 2) =       0.000537293670
  error estimate for blocks of size 2^( 3) =       0.000552493837
  error estimate for blocks of size 2^( 4) =       0.000563265398
  error estimate for blocks of size 2^( 5) =       0.000568828812
  error estimate for blocks of size 2^( 6) =       0.000571752897
  error estimate for blocks of size 2^( 7) =       0.000575479586

      target function =                  N/A
              le_mean =     -22.670521290015
             les_mean =     514.494030182326
             stat err =       0.000569831673
             autocorr =       1.199302671740
              std dev =       0.735863365072
             le_variance =       0.541494892055


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267052129001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670521290015       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670521290509       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670521290582       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670521291438       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670521291726       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670521291749       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670521291585       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670521291184       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670521291270       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670521291272       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 1.617383e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670521290015       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670521290138       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670521290157       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670521290371       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670521290443       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670521290451       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670521290405       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670521290305       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670521290329       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670521290316       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 4.045286e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670521290015       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670521290046       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670521290050       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670521290104       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670521290124       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670521290128       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670521290123       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670521290096       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670521290145       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670521290150       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 1.011436e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9246e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262697e-01 1 1  ON 1
 uu_2                 1.235800e-02 1 1  ON 2
 uu_3                -5.547643e-02 1 1  ON 3
 uu_4                -9.668831e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390140e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217078e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652527e-03 1 1  ON 12
 ud_3                -8.647388e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625503e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431315e-01 1 1  ON 21
 eC_2                -1.898606e-01 1 1  ON 22
 eC_3                -3.271636e-02 1 1  ON 23
 eC_4                 5.204133e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713351e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906157e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239366e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170800e-01 1 1  ON 34
 eO_5                 3.877747e-01 1 1  ON 35
 eO_6                 4.386141e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478367e-02 1 1  ON 42
eH1_3                -6.439088e-02 1 1  ON 43
eH1_4                 7.211084e-03 1 1  ON 44
eH1_5                 5.320844e-02 1 1  ON 45
eH1_6                 8.981171e-02 1 1  ON 46
eH1_7                 6.284855e-02 1 1  ON 47
eH1_8                 2.227430e-02 1 1  ON 48
eH1_9                 5.723181e-02 1 1  ON 49
eH2_0                -2.102187e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976655e-02 1 1  ON 52
eH2_3                -5.946703e-02 1 1  ON 53
eH2_4                 1.223692e-02 1 1  ON 54
eH2_5                 5.798759e-02 1 1  ON 55
eH2_6                 9.442627e-02 1 1  ON 56
eH2_7                 6.731782e-02 1 1  ON 57
eH2_8                 2.568557e-02 1 1  ON 58
eH2_9                 5.813612e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7439
    reference variance = 0.459327
====================================================
  Execution time = 4.3689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1630e-01
  Total weights = 2.0000e+06
  Execution time = 3.6811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371629702
                                         uncertainty =       0.007236838251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371629702
                                         uncertainty =       0.007236838251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508084536
  error estimate for blocks of size 2^( 2) =       0.000525320526
  error estimate for blocks of size 2^( 3) =       0.000541798053
  error estimate for blocks of size 2^( 4) =       0.000552868960
  error estimate for blocks of size 2^( 5) =       0.000559286333
  error estimate for blocks of size 2^( 6) =       0.000561081036
  error estimate for blocks of size 2^( 7) =       0.000566135940

      target function =                  N/A
              le_mean =     -22.669871897190
             les_mean =     514.439391367375
             stat err =       0.000559843067
             autocorr =       1.214117323647
              std dev =       0.718540041015
             le_variance =       0.516299790542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371803324
                                         uncertainty =       0.007236837760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371803324
                                         uncertainty =       0.007236837760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508084621
  error estimate for blocks of size 2^( 2) =       0.000525320607
  error estimate for blocks of size 2^( 3) =       0.000541798131
  error estimate for blocks of size 2^( 4) =       0.000552869037
  error estimate for blocks of size 2^( 5) =       0.000559286404
  error estimate for blocks of size 2^( 6) =       0.000561081103
  error estimate for blocks of size 2^( 7) =       0.000566136009

      target function =                  N/A
              le_mean =     -22.669871898050
             les_mean =     514.439391580017
             stat err =       0.000559843138
             autocorr =       1.214117223181
              std dev =       0.718540161822
             le_variance =       0.516299964151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371716557
                                         uncertainty =       0.007236838006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371716557
                                         uncertainty =       0.007236838006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508084578
  error estimate for blocks of size 2^( 2) =       0.000525320567
  error estimate for blocks of size 2^( 3) =       0.000541798092
  error estimate for blocks of size 2^( 4) =       0.000552868998
  error estimate for blocks of size 2^( 5) =       0.000559286368
  error estimate for blocks of size 2^( 6) =       0.000561081070
  error estimate for blocks of size 2^( 7) =       0.000566135975

      target function =                  N/A
              le_mean =     -22.669871897620
             les_mean =     514.439391473739
             stat err =       0.000559843103
             autocorr =       1.214117273391
              std dev =       0.718540101449
             le_variance =       0.516299877390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371640560
                                         uncertainty =       0.007236838221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516371640560
                                         uncertainty =       0.007236838221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508084541
  error estimate for blocks of size 2^( 2) =       0.000525320531
  error estimate for blocks of size 2^( 3) =       0.000541798058
  error estimate for blocks of size 2^( 4) =       0.000552868965
  error estimate for blocks of size 2^( 5) =       0.000559286337
  error estimate for blocks of size 2^( 6) =       0.000561081040
  error estimate for blocks of size 2^( 7) =       0.000566135944

      target function =                  N/A
              le_mean =     -22.669871897243
             les_mean =     514.439391380672
             stat err =       0.000559843072
             autocorr =       1.214117317363
              std dev =       0.718540048570
             le_variance =       0.516299801399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669871897190        initial
     9.3132e+02     9.3132e+03             1.6174e-07       -22.669871898050  <--
     3.7253e+03     3.7253e+04             4.0453e-08       -22.669871897620
     1.4901e+04     1.4901e+05             1.0114e-08       -22.669871897243

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 6.1977e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 3.020763e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235805e-02 1 1  ON 2
 uu_3                -5.547636e-02 1 1  ON 3
 uu_4                -9.668831e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390140e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652539e-03 1 1  ON 12
 ud_3                -8.647386e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735732e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898606e-01 1 1  ON 22
 eC_3                -3.271645e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906160e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224209e-01 1 1  ON 41
eH1_2                -8.478374e-02 1 1  ON 42
eH1_3                -6.439090e-02 1 1  ON 43
eH1_4                 7.211184e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981173e-02 1 1  ON 46
eH1_7                 6.284850e-02 1 1  ON 47
eH1_8                 2.227432e-02 1 1  ON 48
eH1_9                 5.723180e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976664e-02 1 1  ON 52
eH2_3                -5.946696e-02 1 1  ON 53
eH2_4                 1.223688e-02 1 1  ON 54
eH2_5                 5.798766e-02 1 1  ON 55
eH2_6                 9.442632e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568552e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2123e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7513
    reference variance = 0.391171
====================================================
  Execution time = 4.4813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5092e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510299865369
                                         uncertainty =       0.003761699558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510299865369
                                         uncertainty =       0.003761699558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505108280
  error estimate for blocks of size 2^( 2) =       0.000522544697
  error estimate for blocks of size 2^( 3) =       0.000538070059
  error estimate for blocks of size 2^( 4) =       0.000549146240
  error estimate for blocks of size 2^( 5) =       0.000556344116
  error estimate for blocks of size 2^( 6) =       0.000559294776
  error estimate for blocks of size 2^( 7) =       0.000557942662

      target function =                  N/A
              le_mean =     -22.669626692433
             les_mean =     514.422242867465
             stat err =       0.000555681948
             autocorr =       1.210273718774
              std dev =       0.714330979534
             le_variance =       0.510268748322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266962669243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626692433       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626691417       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626690491       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626689283       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669626687725       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669626687666       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669626688443       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669626687557       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669626687658       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669626687112       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+02 is 6.580858e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626692433       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626692179       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626691947       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626691645       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669626691255       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669626691240       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669626691434       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669626691213       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669626691238       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669626691104       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 1.646522e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669626692433       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669626692370       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669626692312       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669626692236       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669626692139       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669626692130       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669626692180       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669626692123       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669626692141       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669626692104       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 4.117122e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3372e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262697e-01 1 1  ON 1
 uu_2                 1.235811e-02 1 1  ON 2
 uu_3                -5.547629e-02 1 1  ON 3
 uu_4                -9.668835e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390140e-01 1 1  ON 8
 uu_9                -1.141425e-01 1 1  ON 9
 ud_0                 4.217079e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652552e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898606e-01 1 1  ON 22
 eC_3                -3.271661e-02 1 1  ON 23
 eC_4                 5.204135e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906165e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575111e-01 1 1  ON 32
 eO_3                -1.244459e-02 1 1  ON 33
 eO_4                 2.170800e-01 1 1  ON 34
 eO_5                 3.877749e-01 1 1  ON 35
 eO_6                 4.386139e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055493e-01 1 1  ON 38
 eO_9                 3.356043e-01 1 1  ON 39
eH1_0                -2.156635e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478370e-02 1 1  ON 42
eH1_3                -6.439099e-02 1 1  ON 43
eH1_4                 7.211145e-03 1 1  ON 44
eH1_5                 5.320844e-02 1 1  ON 45
eH1_6                 8.981171e-02 1 1  ON 46
eH1_7                 6.284846e-02 1 1  ON 47
eH1_8                 2.227427e-02 1 1  ON 48
eH1_9                 5.723176e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172473e-01 1 1  ON 51
eH2_2                -7.976678e-02 1 1  ON 52
eH2_3                -5.946695e-02 1 1  ON 53
eH2_4                 1.223690e-02 1 1  ON 54
eH2_5                 5.798762e-02 1 1  ON 55
eH2_6                 9.442640e-02 1 1  ON 56
eH2_7                 6.731780e-02 1 1  ON 57
eH2_8                 2.568558e-02 1 1  ON 58
eH2_9                 5.813609e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7543
    reference variance = 0.296293
====================================================
  Execution time = 4.4456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1520e-01
  Total weights = 2.0000e+06
  Execution time = 3.6786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198414187
                                         uncertainty =       0.004961572968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198414187
                                         uncertainty =       0.004961572968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507544547
  error estimate for blocks of size 2^( 2) =       0.000525701254
  error estimate for blocks of size 2^( 3) =       0.000541369339
  error estimate for blocks of size 2^( 4) =       0.000552432785
  error estimate for blocks of size 2^( 5) =       0.000557317230
  error estimate for blocks of size 2^( 6) =       0.000561216938
  error estimate for blocks of size 2^( 7) =       0.000563043017

      target function =                  N/A
              le_mean =     -22.668892518983
             les_mean =     514.393890714580
             stat err =       0.000558502492
             autocorr =       1.210882209061
              std dev =       0.717776382279
             le_variance =       0.515202934957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198109634
                                         uncertainty =       0.004961567077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198109634
                                         uncertainty =       0.004961567077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507544398
  error estimate for blocks of size 2^( 2) =       0.000525701113
  error estimate for blocks of size 2^( 3) =       0.000541369212
  error estimate for blocks of size 2^( 4) =       0.000552432662
  error estimate for blocks of size 2^( 5) =       0.000557317107
  error estimate for blocks of size 2^( 6) =       0.000561216812
  error estimate for blocks of size 2^( 7) =       0.000563042895

      target function =                  N/A
              le_mean =     -22.668892514497
             les_mean =     514.393890207460
             stat err =       0.000558502369
             autocorr =       1.210882386792
              std dev =       0.717776170717
             le_variance =       0.515202631249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198261781
                                         uncertainty =       0.004961570018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198261781
                                         uncertainty =       0.004961570018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507544472
  error estimate for blocks of size 2^( 2) =       0.000525701183
  error estimate for blocks of size 2^( 3) =       0.000541369275
  error estimate for blocks of size 2^( 4) =       0.000552432724
  error estimate for blocks of size 2^( 5) =       0.000557317168
  error estimate for blocks of size 2^( 6) =       0.000561216875
  error estimate for blocks of size 2^( 7) =       0.000563042956

      target function =                  N/A
              le_mean =     -22.668892516735
             les_mean =     514.393890460651
             stat err =       0.000558502431
             autocorr =       1.210882297999
              std dev =       0.717776276408
             le_variance =       0.515202782974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198395132
                                         uncertainty =       0.004961572599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515198395132
                                         uncertainty =       0.004961572599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507544538
  error estimate for blocks of size 2^( 2) =       0.000525701245
  error estimate for blocks of size 2^( 3) =       0.000541369331
  error estimate for blocks of size 2^( 4) =       0.000552432778
  error estimate for blocks of size 2^( 5) =       0.000557317222
  error estimate for blocks of size 2^( 6) =       0.000561216930
  error estimate for blocks of size 2^( 7) =       0.000563043009

      target function =                  N/A
              le_mean =     -22.668892518702
             les_mean =     514.393890682824
             stat err =       0.000558502485
             autocorr =       1.210882220192
              std dev =       0.717776369042
             le_variance =       0.515202915956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668892518983        initial  <--
     2.3283e+02     2.3283e+03             6.5809e-07       -22.668892514497
     9.3132e+02     9.3132e+03             1.6465e-07       -22.668892516735
     3.7253e+03     3.7253e+04             4.1171e-08       -22.668892518702

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7484
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 3.020763e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235805e-02 1 1  ON 2
 uu_3                -5.547636e-02 1 1  ON 3
 uu_4                -9.668831e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390140e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393094e-01 1 1  ON 11
 ud_2                -7.652539e-03 1 1  ON 12
 ud_3                -8.647386e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735732e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898606e-01 1 1  ON 22
 eC_3                -3.271645e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906160e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244442e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224209e-01 1 1  ON 41
eH1_2                -8.478374e-02 1 1  ON 42
eH1_3                -6.439090e-02 1 1  ON 43
eH1_4                 7.211184e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981173e-02 1 1  ON 46
eH1_7                 6.284850e-02 1 1  ON 47
eH1_8                 2.227432e-02 1 1  ON 48
eH1_9                 5.723180e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976664e-02 1 1  ON 52
eH2_3                -5.946696e-02 1 1  ON 53
eH2_4                 1.223688e-02 1 1  ON 54
eH2_5                 5.798766e-02 1 1  ON 55
eH2_6                 9.442632e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568552e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2614e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2683e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.809
    reference variance = 0.699336
====================================================
  Execution time = 4.3960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5104e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511509358068
                                         uncertainty =       0.003237561435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511509358068
                                         uncertainty =       0.003237561435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505760538
  error estimate for blocks of size 2^( 2) =       0.000523516433
  error estimate for blocks of size 2^( 3) =       0.000539051717
  error estimate for blocks of size 2^( 4) =       0.000550780103
  error estimate for blocks of size 2^( 5) =       0.000557854208
  error estimate for blocks of size 2^( 6) =       0.000562271006
  error estimate for blocks of size 2^( 7) =       0.000563337509

      target function =                  N/A
              le_mean =     -22.669002498405
             les_mean =     514.395261460181
             stat err =       0.000558560706
             autocorr =       1.219693981202
              std dev =       0.715253411936
             le_variance =       0.511587443286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266900249840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669002498405       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669002498059       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669002497365       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669002497164       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669002497018       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669002497080       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669002497033       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669002496946       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669002497025       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669002497110       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 6.201814e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669002498405       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669002498319       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669002498145       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669002498095       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669002498062       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669002498081       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669002498064       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669002498011       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669002498080       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669002498060       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 1.550625e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669002498405       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669002498383       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669002498340       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669002498327       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669002498296       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669002498435       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669002498298       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669002498332       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669002498248       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669002498463       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+04 is 3.876671e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9077e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547635e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390140e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652547e-03 1 1  ON 12
 ud_3                -8.647385e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735732e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898606e-01 1 1  ON 22
 eC_3                -3.271646e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906161e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244444e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478375e-02 1 1  ON 42
eH1_3                -6.439091e-02 1 1  ON 43
eH1_4                 7.211181e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981174e-02 1 1  ON 46
eH1_7                 6.284850e-02 1 1  ON 47
eH1_8                 2.227433e-02 1 1  ON 48
eH1_9                 5.723180e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976665e-02 1 1  ON 52
eH2_3                -5.946697e-02 1 1  ON 53
eH2_4                 1.223687e-02 1 1  ON 54
eH2_5                 5.798767e-02 1 1  ON 55
eH2_6                 9.442632e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568552e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6846
    reference variance = 0.466801
====================================================
  Execution time = 4.4595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0923e-01
  Total weights = 2.0000e+06
  Execution time = 3.6743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125621821
                                         uncertainty =       0.003331807862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125621821
                                         uncertainty =       0.003331807862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504593703
  error estimate for blocks of size 2^( 2) =       0.000522007663
  error estimate for blocks of size 2^( 3) =       0.000538246865
  error estimate for blocks of size 2^( 4) =       0.000549399285
  error estimate for blocks of size 2^( 5) =       0.000558509205
  error estimate for blocks of size 2^( 6) =       0.000562197164
  error estimate for blocks of size 2^( 7) =       0.000567538246

      target function =                  N/A
              le_mean =     -22.670455691695
             les_mean =     514.458790624562
             stat err =       0.000559410975
             autocorr =       1.229074794515
              std dev =       0.713603258185
             le_variance =       0.509229610092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125662754
                                         uncertainty =       0.003331808086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125662754
                                         uncertainty =       0.003331808086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504593723
  error estimate for blocks of size 2^( 2) =       0.000522007682
  error estimate for blocks of size 2^( 3) =       0.000538246883
  error estimate for blocks of size 2^( 4) =       0.000549399304
  error estimate for blocks of size 2^( 5) =       0.000558509225
  error estimate for blocks of size 2^( 6) =       0.000562197182
  error estimate for blocks of size 2^( 7) =       0.000567538263

      target function =                  N/A
              le_mean =     -22.670455692212
             les_mean =     514.458790688974
             stat err =       0.000559410993
             autocorr =       1.229074775897
              std dev =       0.713603286866
             le_variance =       0.509229651026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125642293
                                         uncertainty =       0.003331807974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125642293
                                         uncertainty =       0.003331807974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504593713
  error estimate for blocks of size 2^( 2) =       0.000522007672
  error estimate for blocks of size 2^( 3) =       0.000538246874
  error estimate for blocks of size 2^( 4) =       0.000549399295
  error estimate for blocks of size 2^( 5) =       0.000558509215
  error estimate for blocks of size 2^( 6) =       0.000562197173
  error estimate for blocks of size 2^( 7) =       0.000567538254

      target function =                  N/A
              le_mean =     -22.670455691953
             les_mean =     514.458790656772
             stat err =       0.000559410984
             autocorr =       1.229074785207
              std dev =       0.713603272529
             le_variance =       0.509229630564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125624380
                                         uncertainty =       0.003331807876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509125624380
                                         uncertainty =       0.003331807876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504593704
  error estimate for blocks of size 2^( 2) =       0.000522007664
  error estimate for blocks of size 2^( 3) =       0.000538246866
  error estimate for blocks of size 2^( 4) =       0.000549399286
  error estimate for blocks of size 2^( 5) =       0.000558509206
  error estimate for blocks of size 2^( 6) =       0.000562197165
  error estimate for blocks of size 2^( 7) =       0.000567538247

      target function =                  N/A
              le_mean =     -22.670455691727
             les_mean =     514.458790628588
             stat err =       0.000559410976
             autocorr =       1.229074793350
              std dev =       0.713603259978
             le_variance =       0.509229612652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670455691695        initial
     2.3283e+03     2.3283e+04             6.2018e-08       -22.670455692212  <--
     9.3132e+03     9.3132e+04             1.5506e-08       -22.670455691953
     3.7253e+04     3.7253e+05             3.8767e-09       -22.670455691727

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 6.2891e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244448e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6717
    reference variance = 0.290401
====================================================
  Execution time = 4.4519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.5424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5238e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554405275517
                                         uncertainty =       0.043945186510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.554405275517
                                         uncertainty =       0.043945186510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000526423455
  error estimate for blocks of size 2^( 2) =       0.000542912019
  error estimate for blocks of size 2^( 3) =       0.000558127947
  error estimate for blocks of size 2^( 4) =       0.000568739112
  error estimate for blocks of size 2^( 5) =       0.000574105930
  error estimate for blocks of size 2^( 6) =       0.000577802827
  error estimate for blocks of size 2^( 7) =       0.000581101971

      target function =                  N/A
              le_mean =     -22.667929818170
             les_mean =     514.389285271999
             stat err =       0.000575437460
             autocorr =       1.194884145120
              std dev =       0.744475189406
             le_variance =       0.554243307641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266792981817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667929818170       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667929818407       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667929817441       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667929816754       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667929816483       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667929816483       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667929816497       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667929816439       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667929816329       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667929816365       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+02 is 3.571327e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667929818170       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667929818229       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667929817988       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667929817816       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667929817748       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667929817748       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667929817751       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667929817738       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667929817709       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667929817716       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 8.933658e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.667929818170       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.667929818185       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.667929818124       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.667929818081       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.667929818059       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.667929818064       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.667929818057       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.667929818083       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.667929818030       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.667929818037       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.233748e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9770e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235805e-02 1 1  ON 2
 uu_3                -5.547631e-02 1 1  ON 3
 uu_4                -9.668829e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400968e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652596e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625501e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271652e-02 1 1  ON 23
 eC_4                 5.204139e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906164e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244454e-02 1 1  ON 33
 eO_4                 2.170798e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478377e-02 1 1  ON 42
eH1_3                -6.439096e-02 1 1  ON 43
eH1_4                 7.211183e-03 1 1  ON 44
eH1_5                 5.320830e-02 1 1  ON 45
eH1_6                 8.981178e-02 1 1  ON 46
eH1_7                 6.284851e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723178e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976665e-02 1 1  ON 52
eH2_3                -5.946699e-02 1 1  ON 53
eH2_4                 1.223682e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731779e-02 1 1  ON 57
eH2_8                 2.568551e-02 1 1  ON 58
eH2_9                 5.813607e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6549
    reference variance = 0.288215
====================================================
  Execution time = 4.3292e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1234e-01
  Total weights = 2.0000e+06
  Execution time = 3.6731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356322074
                                         uncertainty =       0.004033337135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356322074
                                         uncertainty =       0.004033337135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506134012
  error estimate for blocks of size 2^( 2) =       0.000523374507
  error estimate for blocks of size 2^( 3) =       0.000538870788
  error estimate for blocks of size 2^( 4) =       0.000549935018
  error estimate for blocks of size 2^( 5) =       0.000555576257
  error estimate for blocks of size 2^( 6) =       0.000558409573
  error estimate for blocks of size 2^( 7) =       0.000560963217

      target function =                  N/A
              le_mean =     -22.669060531678
             les_mean =     514.398648409327
             stat err =       0.000556221016
             autocorr =       1.207713004542
              std dev =       0.715781584426
             le_variance =       0.512343276603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356764238
                                         uncertainty =       0.004033341030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356764238
                                         uncertainty =       0.004033341030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506134230
  error estimate for blocks of size 2^( 2) =       0.000523374713
  error estimate for blocks of size 2^( 3) =       0.000538870982
  error estimate for blocks of size 2^( 4) =       0.000549935205
  error estimate for blocks of size 2^( 5) =       0.000555576439
  error estimate for blocks of size 2^( 6) =       0.000558409754
  error estimate for blocks of size 2^( 7) =       0.000560963403

      target function =                  N/A
              le_mean =     -22.669060529470
             les_mean =     514.398648751135
             stat err =       0.000556221200
             autocorr =       1.207712760799
              std dev =       0.715781893126
             le_variance =       0.512343718527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356543309
                                         uncertainty =       0.004033339084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356543309
                                         uncertainty =       0.004033339084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506134121
  error estimate for blocks of size 2^( 2) =       0.000523374610
  error estimate for blocks of size 2^( 3) =       0.000538870885
  error estimate for blocks of size 2^( 4) =       0.000549935112
  error estimate for blocks of size 2^( 5) =       0.000555576348
  error estimate for blocks of size 2^( 6) =       0.000558409663
  error estimate for blocks of size 2^( 7) =       0.000560963310

      target function =                  N/A
              le_mean =     -22.669060530574
             les_mean =     514.398648580353
             stat err =       0.000556221108
             autocorr =       1.207712882593
              std dev =       0.715781738883
             le_variance =       0.512343497718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356349733
                                         uncertainty =       0.004033337378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512356349733
                                         uncertainty =       0.004033337378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506134026
  error estimate for blocks of size 2^( 2) =       0.000523374520
  error estimate for blocks of size 2^( 3) =       0.000538870800
  error estimate for blocks of size 2^( 4) =       0.000549935029
  error estimate for blocks of size 2^( 5) =       0.000555576269
  error estimate for blocks of size 2^( 6) =       0.000558409584
  error estimate for blocks of size 2^( 7) =       0.000560963229

      target function =                  N/A
              le_mean =     -22.669060531540
             les_mean =     514.398648430708
             stat err =       0.000556221028
             autocorr =       1.207712989291
              std dev =       0.715781603736
             le_variance =       0.512343304247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669060531678        initial  <--
     5.8208e+02     5.8208e+03             3.5713e-07       -22.669060529470
     2.3283e+03     2.3283e+04             8.9337e-08       -22.669060530574
     9.3132e+03     9.3132e+04             2.2337e-08       -22.669060531540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5508
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244448e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2333e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7236
    reference variance = 0.431557
====================================================
  Execution time = 4.4271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.3107e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5308e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531148356196
                                         uncertainty =       0.019938301015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.531148356196
                                         uncertainty =       0.019938301015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515301175
  error estimate for blocks of size 2^( 2) =       0.000532654411
  error estimate for blocks of size 2^( 3) =       0.000548111087
  error estimate for blocks of size 2^( 4) =       0.000559179261
  error estimate for blocks of size 2^( 5) =       0.000565441688
  error estimate for blocks of size 2^( 6) =       0.000567378588
  error estimate for blocks of size 2^( 7) =       0.000567940996

      target function =                  N/A
              le_mean =     -22.669960024989
             les_mean =     514.458157870063
             stat err =       0.000564985133
             autocorr =       1.202130940630
              std dev =       0.728745909765
             le_variance =       0.531070600999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266996002499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669960024989       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669960025095       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669960025208       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669960025111       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669960025031       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669960025041       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669960025151       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669960025158       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669960025174       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669960025171       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+03 is 3.485402e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669960024989       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669960025015       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669960025044       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669960025019       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669960024999       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669960024991       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669960025008       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669960024980       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669960025002       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669960025065       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+04 is 8.713695e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669960024989       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669960024996       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669960025003       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669960025070       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669960024992       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669960024995       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669960024994       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669960025009       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669960024744       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669960024966       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+04 is 2.178435e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9592e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235805e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981175e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976667e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6639
    reference variance = 0.291005
====================================================
  Execution time = 4.3273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1167e-01
  Total weights = 2.0000e+06
  Execution time = 3.7043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558053299
                                         uncertainty =       0.003793267010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558053299
                                         uncertainty =       0.003793267010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505801155
  error estimate for blocks of size 2^( 2) =       0.000523595470
  error estimate for blocks of size 2^( 3) =       0.000539383362
  error estimate for blocks of size 2^( 4) =       0.000551530887
  error estimate for blocks of size 2^( 5) =       0.000558129168
  error estimate for blocks of size 2^( 6) =       0.000560101462
  error estimate for blocks of size 2^( 7) =       0.000563218511

      target function =                  N/A
              le_mean =     -22.669191946735
             les_mean =     514.403932878824
             stat err =       0.000558245007
             autocorr =       1.218119964826
              std dev =       0.715310853233
             le_variance =       0.511669616753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558015943
                                         uncertainty =       0.003793266635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558015943
                                         uncertainty =       0.003793266635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505801136
  error estimate for blocks of size 2^( 2) =       0.000523595453
  error estimate for blocks of size 2^( 3) =       0.000539383346
  error estimate for blocks of size 2^( 4) =       0.000551530871
  error estimate for blocks of size 2^( 5) =       0.000558129153
  error estimate for blocks of size 2^( 6) =       0.000560101446
  error estimate for blocks of size 2^( 7) =       0.000563218497

      target function =                  N/A
              le_mean =     -22.669191946581
             les_mean =     514.403932834476
             stat err =       0.000558244992
             autocorr =       1.218119988040
              std dev =       0.715310827094
             le_variance =       0.511669579358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558034620
                                         uncertainty =       0.003793266822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558034620
                                         uncertainty =       0.003793266822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505801146
  error estimate for blocks of size 2^( 2) =       0.000523595461
  error estimate for blocks of size 2^( 3) =       0.000539383354
  error estimate for blocks of size 2^( 4) =       0.000551530879
  error estimate for blocks of size 2^( 5) =       0.000558129161
  error estimate for blocks of size 2^( 6) =       0.000560101454
  error estimate for blocks of size 2^( 7) =       0.000563218504

      target function =                  N/A
              le_mean =     -22.669191946658
             les_mean =     514.403932856649
             stat err =       0.000558244999
             autocorr =       1.218119976431
              std dev =       0.715310840163
             le_variance =       0.511669598055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558050964
                                         uncertainty =       0.003793266986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511558050964
                                         uncertainty =       0.003793266986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505801154
  error estimate for blocks of size 2^( 2) =       0.000523595469
  error estimate for blocks of size 2^( 3) =       0.000539383361
  error estimate for blocks of size 2^( 4) =       0.000551530886
  error estimate for blocks of size 2^( 5) =       0.000558129167
  error estimate for blocks of size 2^( 6) =       0.000560101461
  error estimate for blocks of size 2^( 7) =       0.000563218510

      target function =                  N/A
              le_mean =     -22.669191946725
             les_mean =     514.403932876051
             stat err =       0.000558245006
             autocorr =       1.218119966275
              std dev =       0.715310851600
             le_variance =       0.511669614416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669191946735        initial  <--
     5.8208e+03     5.8208e+04             3.4854e-08       -22.669191946581
     2.3283e+04     2.3283e+05             8.7137e-09       -22.669191946658
     9.3132e+04     9.3132e+05             2.1784e-09       -22.669191946725

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6065
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244448e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2121e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2685e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4971
    reference variance = 0.492161
====================================================
  Execution time = 4.4263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.2534e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5203e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525074074638
                                         uncertainty =       0.006605695070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525074074638
                                         uncertainty =       0.006605695070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512511473
  error estimate for blocks of size 2^( 2) =       0.000529746506
  error estimate for blocks of size 2^( 3) =       0.000545377047
  error estimate for blocks of size 2^( 4) =       0.000557447583
  error estimate for blocks of size 2^( 5) =       0.000565676763
  error estimate for blocks of size 2^( 6) =       0.000569064183
  error estimate for blocks of size 2^( 7) =       0.000573737275

      target function =                  N/A
              le_mean =     -22.669415056242
             les_mean =     514.427714748775
             stat err =       0.000566481451
             autocorr =       1.221698960499
              std dev =       0.724800675546
             le_variance =       0.525336019272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266941505624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669415056242       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669415056245       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669415056234       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669415056235       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669415056246       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669415056223       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669415056173       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669415056365       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669415056186       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669415056055       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+04 is 3.233160e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669415056242       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669415056243       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669415056240       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669415056175       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669415056234       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669415056207       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669415056293       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669415056034       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669415056040       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669415056847       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+05 is 8.082901e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669415056242       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669415056242       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669415056241       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669415056232       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669415056074       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669415055852       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669415056510       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669415055763       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669415059190       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669415056543       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+05 is 2.020732e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9478e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652573e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211174e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.654
    reference variance = 0.773664
====================================================
  Execution time = 4.3763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0885e-01
  Total weights = 2.0000e+06
  Execution time = 3.6313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780720128
                                         uncertainty =       0.003650844952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780720128
                                         uncertainty =       0.003650844952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504406928
  error estimate for blocks of size 2^( 2) =       0.000522342552
  error estimate for blocks of size 2^( 3) =       0.000537961671
  error estimate for blocks of size 2^( 4) =       0.000549220836
  error estimate for blocks of size 2^( 5) =       0.000553843719
  error estimate for blocks of size 2^( 6) =       0.000556378039
  error estimate for blocks of size 2^( 7) =       0.000554773365

      target function =                  N/A
              le_mean =     -22.670498061548
             les_mean =     514.460334801250
             stat err =       0.000553553990
             autocorr =       1.204364332255
              std dev =       0.713339117842
             le_variance =       0.508852697043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780722189
                                         uncertainty =       0.003650844945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780722189
                                         uncertainty =       0.003650844945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504406929
  error estimate for blocks of size 2^( 2) =       0.000522342553
  error estimate for blocks of size 2^( 3) =       0.000537961672
  error estimate for blocks of size 2^( 4) =       0.000549220837
  error estimate for blocks of size 2^( 5) =       0.000553843720
  error estimate for blocks of size 2^( 6) =       0.000556378039
  error estimate for blocks of size 2^( 7) =       0.000554773365

      target function =                  N/A
              le_mean =     -22.670498061503
             les_mean =     514.460334801306
             stat err =       0.000553553990
             autocorr =       1.204364331156
              std dev =       0.713339119288
             le_variance =       0.508852699106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780721159
                                         uncertainty =       0.003650844948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780721159
                                         uncertainty =       0.003650844948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504406928
  error estimate for blocks of size 2^( 2) =       0.000522342552
  error estimate for blocks of size 2^( 3) =       0.000537961672
  error estimate for blocks of size 2^( 4) =       0.000549220837
  error estimate for blocks of size 2^( 5) =       0.000553843719
  error estimate for blocks of size 2^( 6) =       0.000556378039
  error estimate for blocks of size 2^( 7) =       0.000554773365

      target function =                  N/A
              le_mean =     -22.670498061525
             les_mean =     514.460334801278
             stat err =       0.000553553990
             autocorr =       1.204364331701
              std dev =       0.713339118565
             le_variance =       0.508852698075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780720257
                                         uncertainty =       0.003650844951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508780720257
                                         uncertainty =       0.003650844951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504406928
  error estimate for blocks of size 2^( 2) =       0.000522342552
  error estimate for blocks of size 2^( 3) =       0.000537961671
  error estimate for blocks of size 2^( 4) =       0.000549220836
  error estimate for blocks of size 2^( 5) =       0.000553843719
  error estimate for blocks of size 2^( 6) =       0.000556378039
  error estimate for blocks of size 2^( 7) =       0.000554773365

      target function =                  N/A
              le_mean =     -22.670498061545
             les_mean =     514.460334801254
             stat err =       0.000553553990
             autocorr =       1.204364332176
              std dev =       0.713339117932
             le_variance =       0.508852697172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670498061548        initial  <--
     5.8208e+04     5.8208e+05             3.2332e-09       -22.670498061503
     2.3283e+05     2.3283e+06             8.0829e-10       -22.670498061525
     9.3132e+05     9.3132e+06             2.0207e-10       -22.670498061545

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0500
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244448e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2154e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6776
    reference variance = 0.637748
====================================================
  Execution time = 4.4595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1287e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5703e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512910395309
                                         uncertainty =       0.004675407121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512910395309
                                         uncertainty =       0.004675407121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506395285
  error estimate for blocks of size 2^( 2) =       0.000524355997
  error estimate for blocks of size 2^( 3) =       0.000540384452
  error estimate for blocks of size 2^( 4) =       0.000551804872
  error estimate for blocks of size 2^( 5) =       0.000559639675
  error estimate for blocks of size 2^( 6) =       0.000563467813
  error estimate for blocks of size 2^( 7) =       0.000566931090

      target function =                  N/A
              le_mean =     -22.670027303611
             les_mean =     514.443010060297
             stat err =       0.000560460863
             autocorr =       1.224930009381
              std dev =       0.716151080614
             le_variance =       0.512872370265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267002730361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670027303611       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670027303611       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670027303611       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670027303595       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670027303608       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670027303880       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670027303703       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670027304758       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670027302018       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 3.404568e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670027303611       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670027303611       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670027303611       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670027302908       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670027302544       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670027301455       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670027305292       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670027302795       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670027303276       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 8.511484e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670027303611       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670027303611       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670027303611       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670027303660       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670027307106       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670027303532       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670027295307       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670027301965       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670027299602       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+06 is 2.127927e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0310e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439093e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7163
    reference variance = 0.499548
====================================================
  Execution time = 4.4270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0529e-01
  Total weights = 2.0000e+06
  Execution time = 3.6309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264690
                                         uncertainty =       0.003058188688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264690
                                         uncertainty =       0.003058188688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502637368
  error estimate for blocks of size 2^( 2) =       0.000520366738
  error estimate for blocks of size 2^( 3) =       0.000536425363
  error estimate for blocks of size 2^( 4) =       0.000547874065
  error estimate for blocks of size 2^( 5) =       0.000554736380
  error estimate for blocks of size 2^( 6) =       0.000557829783
  error estimate for blocks of size 2^( 7) =       0.000556829139

      target function =                  N/A
              le_mean =     -22.669778510982
             les_mean =     514.424146131815
             stat err =       0.000554317342
             autocorr =       1.216206685272
              std dev =       0.710836582827
             le_variance =       0.505288647484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264341
                                         uncertainty =       0.003058188685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264341
                                         uncertainty =       0.003058188685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502637368
  error estimate for blocks of size 2^( 2) =       0.000520366738
  error estimate for blocks of size 2^( 3) =       0.000536425363
  error estimate for blocks of size 2^( 4) =       0.000547874065
  error estimate for blocks of size 2^( 5) =       0.000554736380
  error estimate for blocks of size 2^( 6) =       0.000557829783
  error estimate for blocks of size 2^( 7) =       0.000556829139

      target function =                  N/A
              le_mean =     -22.669778510983
             les_mean =     514.424146131506
             stat err =       0.000554317342
             autocorr =       1.216206685465
              std dev =       0.710836582581
             le_variance =       0.505288647136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264515
                                         uncertainty =       0.003058188686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264515
                                         uncertainty =       0.003058188686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502637368
  error estimate for blocks of size 2^( 2) =       0.000520366738
  error estimate for blocks of size 2^( 3) =       0.000536425363
  error estimate for blocks of size 2^( 4) =       0.000547874065
  error estimate for blocks of size 2^( 5) =       0.000554736380
  error estimate for blocks of size 2^( 6) =       0.000557829783
  error estimate for blocks of size 2^( 7) =       0.000556829139

      target function =                  N/A
              le_mean =     -22.669778510982
             les_mean =     514.424146131661
             stat err =       0.000554317342
             autocorr =       1.216206685368
              std dev =       0.710836582704
             le_variance =       0.505288647310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264668
                                         uncertainty =       0.003058188688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505101264668
                                         uncertainty =       0.003058188688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502637368
  error estimate for blocks of size 2^( 2) =       0.000520366738
  error estimate for blocks of size 2^( 3) =       0.000536425363
  error estimate for blocks of size 2^( 4) =       0.000547874065
  error estimate for blocks of size 2^( 5) =       0.000554736380
  error estimate for blocks of size 2^( 6) =       0.000557829783
  error estimate for blocks of size 2^( 7) =       0.000556829139

      target function =                  N/A
              le_mean =     -22.669778510982
             les_mean =     514.424146131796
             stat err =       0.000554317342
             autocorr =       1.216206685294
              std dev =       0.710836582811
             le_variance =       0.505288647463


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669778510982        initial
     5.8208e+05     5.8208e+06             3.4046e-10       -22.669778510983  <--
     2.3283e+06     2.3283e+07             8.5115e-11       -22.669778510982
     9.3132e+06     9.3132e+07             2.1279e-11       -22.669778510982

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 6.2519e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7415
    reference variance = 0.530494
====================================================
  Execution time = 4.4580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1743e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5258e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517175997831
                                         uncertainty =       0.009037748743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517175997831
                                         uncertainty =       0.009037748743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508641764
  error estimate for blocks of size 2^( 2) =       0.000526031619
  error estimate for blocks of size 2^( 3) =       0.000541284318
  error estimate for blocks of size 2^( 4) =       0.000552305409
  error estimate for blocks of size 2^( 5) =       0.000559348866
  error estimate for blocks of size 2^( 6) =       0.000561963513
  error estimate for blocks of size 2^( 7) =       0.000563603142

      target function =                  N/A
              le_mean =     -22.669762577764
             les_mean =     514.435567961385
             stat err =       0.000559305232
             autocorr =       1.209132044670
              std dev =       0.719328080861
             le_variance =       0.517432887915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266976257776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762577764       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762577765       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762577764       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762577768       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669762577768       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669762577824       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669762577742       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669762577720       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669762577638       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669762577218       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.322631e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762577764       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762577764       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762577764       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762577765       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669762577313       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669762577924       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669762577732       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669762577766       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669762578060       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669762578051       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 3.306583e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669762577764       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669762577764       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669762577764       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669762577764       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669762581224       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669762577654       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669762576794       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669762578851       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669762577750       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669762575455       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+06 is 8.266440e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9851e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.604
    reference variance = 0.493232
====================================================
  Execution time = 4.3591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1691e-01
  Total weights = 2.0000e+06
  Execution time = 3.6392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693041
                                         uncertainty =       0.006743687602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693041
                                         uncertainty =       0.006743687602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508386990
  error estimate for blocks of size 2^( 2) =       0.000526095964
  error estimate for blocks of size 2^( 3) =       0.000541764318
  error estimate for blocks of size 2^( 4) =       0.000552696509
  error estimate for blocks of size 2^( 5) =       0.000558872862
  error estimate for blocks of size 2^( 6) =       0.000563273243
  error estimate for blocks of size 2^( 7) =       0.000563869197

      target function =                  N/A
              le_mean =     -22.669331103852
             les_mean =     514.415487100719
             stat err =       0.000559677953
             autocorr =       1.211957923039
              std dev =       0.718967776120
             le_variance =       0.516914663099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693423
                                         uncertainty =       0.006743687626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693423
                                         uncertainty =       0.006743687626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508386990
  error estimate for blocks of size 2^( 2) =       0.000526095964
  error estimate for blocks of size 2^( 3) =       0.000541764318
  error estimate for blocks of size 2^( 4) =       0.000552696509
  error estimate for blocks of size 2^( 5) =       0.000558872862
  error estimate for blocks of size 2^( 6) =       0.000563273243
  error estimate for blocks of size 2^( 7) =       0.000563869198

      target function =                  N/A
              le_mean =     -22.669331103862
             les_mean =     514.415487101535
             stat err =       0.000559677953
             autocorr =       1.211957923153
              std dev =       0.718967776386
             le_variance =       0.516914663481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693232
                                         uncertainty =       0.006743687614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693232
                                         uncertainty =       0.006743687614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508386990
  error estimate for blocks of size 2^( 2) =       0.000526095964
  error estimate for blocks of size 2^( 3) =       0.000541764318
  error estimate for blocks of size 2^( 4) =       0.000552696509
  error estimate for blocks of size 2^( 5) =       0.000558872862
  error estimate for blocks of size 2^( 6) =       0.000563273243
  error estimate for blocks of size 2^( 7) =       0.000563869197

      target function =                  N/A
              le_mean =     -22.669331103857
             les_mean =     514.415487101127
             stat err =       0.000559677953
             autocorr =       1.211957923091
              std dev =       0.718967776253
             le_variance =       0.516914663290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693065
                                         uncertainty =       0.006743687604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516999693065
                                         uncertainty =       0.006743687604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508386990
  error estimate for blocks of size 2^( 2) =       0.000526095964
  error estimate for blocks of size 2^( 3) =       0.000541764318
  error estimate for blocks of size 2^( 4) =       0.000552696509
  error estimate for blocks of size 2^( 5) =       0.000558872862
  error estimate for blocks of size 2^( 6) =       0.000563273243
  error estimate for blocks of size 2^( 7) =       0.000563869197

      target function =                  N/A
              le_mean =     -22.669331103853
             les_mean =     514.415487100770
             stat err =       0.000559677953
             autocorr =       1.211957923043
              std dev =       0.718967776136
             le_variance =       0.516914663123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669331103852        initial
     1.4552e+05     1.4552e+06             1.3226e-09       -22.669331103862  <--
     5.8208e+05     5.8208e+06             3.3066e-10       -22.669331103857
     2.3283e+06     2.3283e+07             8.2664e-11       -22.669331103853

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 6.1912e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2177e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2682e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6411
    reference variance = 0.304793
====================================================
  Execution time = 4.4095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1426e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4964e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514354134291
                                         uncertainty =       0.004130716920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514354134291
                                         uncertainty =       0.004130716920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507081314
  error estimate for blocks of size 2^( 2) =       0.000525056895
  error estimate for blocks of size 2^( 3) =       0.000540708625
  error estimate for blocks of size 2^( 4) =       0.000551524244
  error estimate for blocks of size 2^( 5) =       0.000557830301
  error estimate for blocks of size 2^( 6) =       0.000561176046
  error estimate for blocks of size 2^( 7) =       0.000563748701

      target function =                  N/A
              le_mean =     -22.670155968450
             les_mean =     514.450234294164
             stat err =       0.000558569823
             autocorr =       1.213388081123
              std dev =       0.717121271078
             le_variance =       0.514262917433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267015596845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670155968450       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670155968471       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670155968495       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670155968518       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670155968509       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670155968532       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670155968506       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670155968531       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670155968543       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670155968502       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 6.648220e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670155968450       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670155968455       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670155968461       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670155968467       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670155968477       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670155968515       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670155968547       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670155968380       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670155967984       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670155968444       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.662064e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670155968450       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670155968452       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670155968453       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670155968544       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670155967796       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670155968366       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670155967894       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670155968083       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670155969037       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.670155969090       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+05 is 4.155160e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9072e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652572e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211174e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6567
    reference variance = 0.234313
====================================================
  Execution time = 4.4562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2671e+01
  VMC Evar = 5.0864e-01
  Total weights = 2.0000e+06
  Execution time = 3.9183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654613381
                                         uncertainty =       0.003822880728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654613381
                                         uncertainty =       0.003822880728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504301057
  error estimate for blocks of size 2^( 2) =       0.000521921179
  error estimate for blocks of size 2^( 3) =       0.000537134397
  error estimate for blocks of size 2^( 4) =       0.000548374520
  error estimate for blocks of size 2^( 5) =       0.000557094042
  error estimate for blocks of size 2^( 6) =       0.000562397020
  error estimate for blocks of size 2^( 7) =       0.000564343763

      target function =                  N/A
              le_mean =     -22.670790545384
             les_mean =     514.473382809630
             stat err =       0.000558052336
             autocorr =       1.224531905108
              std dev =       0.713189393679
             le_variance =       0.508639111256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654612396
                                         uncertainty =       0.003822880732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654612396
                                         uncertainty =       0.003822880732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504301056
  error estimate for blocks of size 2^( 2) =       0.000521921178
  error estimate for blocks of size 2^( 3) =       0.000537134397
  error estimate for blocks of size 2^( 4) =       0.000548374520
  error estimate for blocks of size 2^( 5) =       0.000557094041
  error estimate for blocks of size 2^( 6) =       0.000562397019
  error estimate for blocks of size 2^( 7) =       0.000564343763

      target function =                  N/A
              le_mean =     -22.670790545414
             les_mean =     514.473382809975
             stat err =       0.000558052336
             autocorr =       1.224531905198
              std dev =       0.713189392987
             le_variance =       0.508639110269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654612889
                                         uncertainty =       0.003822880730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654612889
                                         uncertainty =       0.003822880730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504301056
  error estimate for blocks of size 2^( 2) =       0.000521921179
  error estimate for blocks of size 2^( 3) =       0.000537134397
  error estimate for blocks of size 2^( 4) =       0.000548374520
  error estimate for blocks of size 2^( 5) =       0.000557094042
  error estimate for blocks of size 2^( 6) =       0.000562397020
  error estimate for blocks of size 2^( 7) =       0.000564343763

      target function =                  N/A
              le_mean =     -22.670790545399
             les_mean =     514.473382809803
             stat err =       0.000558052336
             autocorr =       1.224531905160
              std dev =       0.713189393333
             le_variance =       0.508639110763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654613320
                                         uncertainty =       0.003822880728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508654613320
                                         uncertainty =       0.003822880728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504301057
  error estimate for blocks of size 2^( 2) =       0.000521921179
  error estimate for blocks of size 2^( 3) =       0.000537134397
  error estimate for blocks of size 2^( 4) =       0.000548374520
  error estimate for blocks of size 2^( 5) =       0.000557094042
  error estimate for blocks of size 2^( 6) =       0.000562397020
  error estimate for blocks of size 2^( 7) =       0.000564343763

      target function =                  N/A
              le_mean =     -22.670790545386
             les_mean =     514.473382809652
             stat err =       0.000558052336
             autocorr =       1.224531905114
              std dev =       0.713189393636
             le_variance =       0.508639111194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.670790545384        initial
     3.6380e+04     3.6380e+05             6.6482e-09       -22.670790545414  <--
     1.4552e+05     1.4552e+06             1.6621e-09       -22.670790545399
     5.8208e+05     5.8208e+06             4.1552e-10       -22.670790545386

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 6.3067e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668829e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652571e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244448e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211172e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2215e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6794
    reference variance = 0.367477
====================================================
  Execution time = 4.4523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.1314e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5378e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513198241947
                                         uncertainty =       0.003866424580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513198241947
                                         uncertainty =       0.003866424580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506526030
  error estimate for blocks of size 2^( 2) =       0.000523772671
  error estimate for blocks of size 2^( 3) =       0.000539992295
  error estimate for blocks of size 2^( 4) =       0.000551307839
  error estimate for blocks of size 2^( 5) =       0.000557412316
  error estimate for blocks of size 2^( 6) =       0.000561600776
  error estimate for blocks of size 2^( 7) =       0.000561724410

      target function =                  N/A
              le_mean =     -22.670032756815
             les_mean =     514.443522176210
             stat err =       0.000558011335
             autocorr =       1.213619387208
              std dev =       0.716335981041
             le_variance =       0.513137237734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.267003275681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032756815       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670032756797       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670032756780       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670032756790       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670032756823       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670032756868       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670032756889       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670032756886       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670032756895       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+03 is 1.998395e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032756815       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670032756810       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670032756806       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670032756809       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670032756808       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670032756842       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670032756836       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670032756891       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670032756806       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 4.996129e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.670032756815       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.670032756813       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.670032756812       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.670032756813       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.670032756827       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.670032756720       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.670032756867       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.670032756883       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.670032756854       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+05 is 1.249041e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9914e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652570e-03 1 1  ON 12
 ud_3                -8.647383e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956611e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271648e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593225e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123523e-01 1 1  ON 28
 eC_9                 9.906162e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211173e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227434e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976667e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223684e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.584
    reference variance = 0.325193
====================================================
  Execution time = 4.4017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2670e+01
  VMC Evar = 5.0958e-01
  Total weights = 2.0000e+06
  Execution time = 3.6295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568842352
                                         uncertainty =       0.003637587698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568842352
                                         uncertainty =       0.003637587698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504765218
  error estimate for blocks of size 2^( 2) =       0.000522260969
  error estimate for blocks of size 2^( 3) =       0.000538395252
  error estimate for blocks of size 2^( 4) =       0.000549293370
  error estimate for blocks of size 2^( 5) =       0.000556594566
  error estimate for blocks of size 2^( 6) =       0.000558828066
  error estimate for blocks of size 2^( 7) =       0.000563228309

      target function =                  N/A
              le_mean =     -22.669802167726
             les_mean =     514.429505919529
             stat err =       0.000556986078
             autocorr =       1.217614572776
              std dev =       0.713845817035
             le_variance =       0.509575850499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568837549
                                         uncertainty =       0.003637587609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568837549
                                         uncertainty =       0.003637587609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504765216
  error estimate for blocks of size 2^( 2) =       0.000522260967
  error estimate for blocks of size 2^( 3) =       0.000538395250
  error estimate for blocks of size 2^( 4) =       0.000549293368
  error estimate for blocks of size 2^( 5) =       0.000556594564
  error estimate for blocks of size 2^( 6) =       0.000558828064
  error estimate for blocks of size 2^( 7) =       0.000563228307

      target function =                  N/A
              le_mean =     -22.669802167754
             les_mean =     514.429505916016
             stat err =       0.000556986076
             autocorr =       1.217614576152
              std dev =       0.713845813675
             le_variance =       0.509575845702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568839950
                                         uncertainty =       0.003637587654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568839950
                                         uncertainty =       0.003637587654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504765217
  error estimate for blocks of size 2^( 2) =       0.000522260968
  error estimate for blocks of size 2^( 3) =       0.000538395251
  error estimate for blocks of size 2^( 4) =       0.000549293369
  error estimate for blocks of size 2^( 5) =       0.000556594565
  error estimate for blocks of size 2^( 6) =       0.000558828065
  error estimate for blocks of size 2^( 7) =       0.000563228308

      target function =                  N/A
              le_mean =     -22.669802167740
             les_mean =     514.429505917772
             stat err =       0.000556986077
             autocorr =       1.217614574465
              std dev =       0.713845815355
             le_variance =       0.509575848100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568842052
                                         uncertainty =       0.003637587692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509568842052
                                         uncertainty =       0.003637587692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504765218
  error estimate for blocks of size 2^( 2) =       0.000522260969
  error estimate for blocks of size 2^( 3) =       0.000538395252
  error estimate for blocks of size 2^( 4) =       0.000549293370
  error estimate for blocks of size 2^( 5) =       0.000556594566
  error estimate for blocks of size 2^( 6) =       0.000558828066
  error estimate for blocks of size 2^( 7) =       0.000563228309

      target function =                  N/A
              le_mean =     -22.669802167727
             les_mean =     514.429505919309
             stat err =       0.000556986078
             autocorr =       1.217614572989
              std dev =       0.713845816826
             le_variance =       0.509575850199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.669802167726        initial
     9.0949e+03     9.0949e+04             1.9984e-08       -22.669802167754  <--
     3.6380e+04     3.6380e+05             4.9961e-09       -22.669802167740
     1.4552e+05     1.4552e+06             1.2490e-09       -22.669802167727

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 6.2272e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652566e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271649e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906163e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227435e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976667e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223683e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2680e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.5139
    reference variance = 0.539698
====================================================
  Execution time = 4.4167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2669e+01
  VMC Evar = 5.1116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5309e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511226904899
                                         uncertainty =       0.005457711353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511226904899
                                         uncertainty =       0.005457711353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505549541
  error estimate for blocks of size 2^( 2) =       0.000522726364
  error estimate for blocks of size 2^( 3) =       0.000538575374
  error estimate for blocks of size 2^( 4) =       0.000548638245
  error estimate for blocks of size 2^( 5) =       0.000554023971
  error estimate for blocks of size 2^( 6) =       0.000558104550
  error estimate for blocks of size 2^( 7) =       0.000558750262

      target function =                  N/A
              le_mean =     -22.669108129271
             les_mean =     514.399623797894
             stat err =       0.000554879257
             autocorr =       1.204674004794
              std dev =       0.714955017385
             le_variance =       0.511160676883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266910812927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669108129271       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669108129623       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669108130105       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669108130242       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669108130308       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669108130242       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669108130183       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669108130269       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669108130226       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669108130241       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+03 is 6.936075e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669108129271       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669108129359       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669108129480       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669108129521       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669108129526       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669108129521       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669108129496       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669108129526       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669108129509       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669108129504       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+03 is 1.734068e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.669108129271       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.669108129293       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.669108129323       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.669108129332       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.669108129364       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.669108129326       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.669108129328       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.669108129305       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.669108129300       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.669108129288       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+04 is 4.335199e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.430836 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9489e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668831e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652563e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349624e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271649e-02 1 1  ON 23
 eC_4                 5.204137e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906163e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478380e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211172e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981175e-02 1 1  ON 46
eH1_7                 6.284853e-02 1 1  ON 47
eH1_8                 2.227435e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976666e-02 1 1  ON 52
eH2_3                -5.946697e-02 1 1  ON 53
eH2_4                 1.223682e-02 1 1  ON 54
eH2_5                 5.798768e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568554e-02 1 1  ON 58
eH2_9                 5.813607e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6099
    reference variance = 0.450186
====================================================
  Execution time = 4.3806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2668e+01
  VMC Evar = 5.0891e-01
  Total weights = 2.0000e+06
  Execution time = 3.6345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973668094
                                         uncertainty =       0.002813486569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973668094
                                         uncertainty =       0.002813486569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504433224
  error estimate for blocks of size 2^( 2) =       0.000522362892
  error estimate for blocks of size 2^( 3) =       0.000537862224
  error estimate for blocks of size 2^( 4) =       0.000548447688
  error estimate for blocks of size 2^( 5) =       0.000554766157
  error estimate for blocks of size 2^( 6) =       0.000556485698
  error estimate for blocks of size 2^( 7) =       0.000560413917

      target function =                  N/A
              le_mean =     -22.668355707526
             les_mean =     514.363255983671
             stat err =       0.000555028365
             autocorr =       1.210662220931
              std dev =       0.713376306873
             le_variance =       0.508905755208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973649327
                                         uncertainty =       0.002813486664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973649327
                                         uncertainty =       0.002813486664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504433215
  error estimate for blocks of size 2^( 2) =       0.000522362883
  error estimate for blocks of size 2^( 3) =       0.000537862216
  error estimate for blocks of size 2^( 4) =       0.000548447682
  error estimate for blocks of size 2^( 5) =       0.000554766152
  error estimate for blocks of size 2^( 6) =       0.000556485693
  error estimate for blocks of size 2^( 7) =       0.000560413910

      target function =                  N/A
              le_mean =     -22.668355707110
             les_mean =     514.363255946035
             stat err =       0.000555028359
             autocorr =       1.210662240698
              std dev =       0.713376293696
             le_variance =       0.508905736408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973658711
                                         uncertainty =       0.002813486617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973658711
                                         uncertainty =       0.002813486617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504433219
  error estimate for blocks of size 2^( 2) =       0.000522362888
  error estimate for blocks of size 2^( 3) =       0.000537862220
  error estimate for blocks of size 2^( 4) =       0.000548447685
  error estimate for blocks of size 2^( 5) =       0.000554766154
  error estimate for blocks of size 2^( 6) =       0.000556485695
  error estimate for blocks of size 2^( 7) =       0.000560413914

      target function =                  N/A
              le_mean =     -22.668355707318
             les_mean =     514.363255964851
             stat err =       0.000555028362
             autocorr =       1.210662230814
              std dev =       0.713376300285
             le_variance =       0.508905745808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973666921
                                         uncertainty =       0.002813486575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508973666921
                                         uncertainty =       0.002813486575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504433224
  error estimate for blocks of size 2^( 2) =       0.000522362891
  error estimate for blocks of size 2^( 3) =       0.000537862224
  error estimate for blocks of size 2^( 4) =       0.000548447688
  error estimate for blocks of size 2^( 5) =       0.000554766157
  error estimate for blocks of size 2^( 6) =       0.000556485697
  error estimate for blocks of size 2^( 7) =       0.000560413917

      target function =                  N/A
              le_mean =     -22.668355707500
             les_mean =     514.363255981318
             stat err =       0.000555028365
             autocorr =       1.210662222168
              std dev =       0.713376306050
             le_variance =       0.508905754033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.668355707526        initial  <--
     2.2737e+03     2.2737e+04             6.9361e-08       -22.668355707110
     9.0949e+03     9.0949e+04             1.7341e-08       -22.668355707318
     3.6380e+04     3.6380e+05             4.3352e-09       -22.668355707500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0934
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 3.020764e-01 1 1  ON 0
 uu_1                 1.262698e-01 1 1  ON 1
 uu_2                 1.235804e-02 1 1  ON 2
 uu_3                -5.547633e-02 1 1  ON 3
 uu_4                -9.668830e-02 1 1  ON 4
 uu_5                -1.234799e-01 1 1  ON 5
 uu_6                -1.400967e-01 1 1  ON 6
 uu_7                -1.458539e-01 1 1  ON 7
 uu_8                -1.390139e-01 1 1  ON 8
 uu_9                -1.141426e-01 1 1  ON 9
 ud_0                 4.217080e-01 1 1  ON 10
 ud_1                 1.393093e-01 1 1  ON 11
 ud_2                -7.652566e-03 1 1  ON 12
 ud_3                -8.647382e-02 1 1  ON 13
 ud_4                -1.301004e-01 1 1  ON 14
 ud_5                -1.561736e-01 1 1  ON 15
 ud_6                -1.703115e-01 1 1  ON 16
 ud_7                -1.735731e-01 1 1  ON 17
 ud_8                -1.625502e-01 1 1  ON 18
 ud_9                -1.349625e-01 1 1  ON 19
 eC_0                -5.956612e-01 1 1  ON 20
 eC_1                -4.431316e-01 1 1  ON 21
 eC_2                -1.898605e-01 1 1  ON 22
 eC_3                -3.271649e-02 1 1  ON 23
 eC_4                 5.204138e-02 1 1  ON 24
 eC_5                 1.593224e-01 1 1  ON 25
 eC_6                 2.584452e-01 1 1  ON 26
 eC_7                 3.713350e-01 1 1  ON 27
 eC_8                 3.123524e-01 1 1  ON 28
 eC_9                 9.906163e-02 1 1  ON 29
 eO_0                -1.202280e+00 1 1  ON 30
 eO_1                -8.239365e-01 1 1  ON 31
 eO_2                -3.575110e-01 1 1  ON 32
 eO_3                -1.244449e-02 1 1  ON 33
 eO_4                 2.170799e-01 1 1  ON 34
 eO_5                 3.877748e-01 1 1  ON 35
 eO_6                 4.386140e-01 1 1  ON 36
 eO_7                 4.459949e-01 1 1  ON 37
 eO_8                 4.055492e-01 1 1  ON 38
 eO_9                 3.356042e-01 1 1  ON 39
eH1_0                -2.156636e-01 1 1  ON 40
eH1_1                -1.224208e-01 1 1  ON 41
eH1_2                -8.478378e-02 1 1  ON 42
eH1_3                -6.439094e-02 1 1  ON 43
eH1_4                 7.211175e-03 1 1  ON 44
eH1_5                 5.320836e-02 1 1  ON 45
eH1_6                 8.981176e-02 1 1  ON 46
eH1_7                 6.284852e-02 1 1  ON 47
eH1_8                 2.227435e-02 1 1  ON 48
eH1_9                 5.723179e-02 1 1  ON 49
eH2_0                -2.102186e-01 1 1  ON 50
eH2_1                -1.172472e-01 1 1  ON 51
eH2_2                -7.976667e-02 1 1  ON 52
eH2_3                -5.946698e-02 1 1  ON 53
eH2_4                 1.223683e-02 1 1  ON 54
eH2_5                 5.798769e-02 1 1  ON 55
eH2_6                 9.442631e-02 1 1  ON 56
eH2_7                 6.731781e-02 1 1  ON 57
eH2_8                 2.568553e-02 1 1  ON 58
eH2_9                 5.813608e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2159e+02 secs
  Total Execution time = 4.9072e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
