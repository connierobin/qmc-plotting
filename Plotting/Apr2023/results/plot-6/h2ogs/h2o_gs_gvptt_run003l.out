Rank =    0  Free Memory = 73998 MB
Rank =    1  Free Memory = 73998 MB
Rank =    2  Free Memory = 73998 MB
Rank =    3  Free Memory = 73998 MB
Rank =    4  Free Memory = 73998 MB
Rank =    5  Free Memory = 73998 MB
Rank =    6  Free Memory = 73997 MB
Rank =    7  Free Memory = 73997 MB
Rank =    8  Free Memory = 73997 MB
Rank =    9  Free Memory = 73997 MB
Rank =   10  Free Memory = 73996 MB
Rank =   11  Free Memory = 73996 MB
Rank =   12  Free Memory = 73996 MB
Rank =   13  Free Memory = 73996 MB
Rank =   14  Free Memory = 73996 MB
Rank =   15  Free Memory = 73982 MB
Rank =   16  Free Memory = 73982 MB
Rank =   17  Free Memory = 73982 MB
Rank =   18  Free Memory = 73982 MB
Rank =   19  Free Memory = 73982 MB
Rank =   20  Free Memory = 73982 MB
Rank =   21  Free Memory = 73982 MB
Rank =   22  Free Memory = 73982 MB
Rank =   23  Free Memory = 73982 MB
Rank =   24  Free Memory = 73982 MB
Rank =   25  Free Memory = 73982 MB
Rank =   26  Free Memory = 73982 MB
Rank =   27  Free Memory = 73982 MB
Rank =   28  Free Memory = 73982 MB
Rank =   29  Free Memory = 73982 MB
Rank =   30  Free Memory = 73982 MB
Rank =   31  Free Memory = 73982 MB
Rank =   32  Free Memory = 83163 MB
Rank =   33  Free Memory = 83163 MB
Rank =   34  Free Memory = 83163 MB
Rank =   35  Free Memory = 83163 MB
Rank =   36  Free Memory = 83163 MB
Rank =   37  Free Memory = 83163 MB
Rank =   38  Free Memory = 83163 MB
Rank =   39  Free Memory = 83163 MB
Rank =   40  Free Memory = 83163 MB
Rank =   41  Free Memory = 83163 MB
Rank =   42  Free Memory = 83163 MB
Rank =   43  Free Memory = 83163 MB
Rank =   44  Free Memory = 83163 MB
Rank =   45  Free Memory = 83163 MB
Rank =   46  Free Memory = 83163 MB
Rank =   47  Free Memory = 83163 MB
Rank =   48  Free Memory = 83162 MB
Rank =   49  Free Memory = 83162 MB
Rank =   50  Free Memory = 83162 MB
Rank =   51  Free Memory = 83162 MB
Rank =   52  Free Memory = 83162 MB
Rank =   53  Free Memory = 83162 MB
Rank =   54  Free Memory = 83162 MB
Rank =   55  Free Memory = 83162 MB
Rank =   56  Free Memory = 83162 MB
Rank =   57  Free Memory = 83162 MB
Rank =   58  Free Memory = 83162 MB
Rank =   59  Free Memory = 83162 MB
Rank =   60  Free Memory = 83162 MB
Rank =   61  Free Memory = 83162 MB
Rank =   62  Free Memory = 83162 MB
Rank =   63  Free Memory = 83162 MB
Rank =   64  Free Memory = 82902 MB
Rank =   65  Free Memory = 82902 MB
Rank =   66  Free Memory = 82902 MB
Rank =   67  Free Memory = 82902 MB
Rank =   68  Free Memory = 82902 MB
Rank =   69  Free Memory = 82902 MB
Rank =   70  Free Memory = 82902 MB
Rank =   71  Free Memory = 82902 MB
Rank =   72  Free Memory = 82902 MB
Rank =   73  Free Memory = 82902 MB
Rank =   74  Free Memory = 82902 MB
Rank =   75  Free Memory = 82902 MB
Rank =   76  Free Memory = 82902 MB
Rank =   77  Free Memory = 82902 MB
Rank =   78  Free Memory = 82902 MB
Rank =   79  Free Memory = 82902 MB
Rank =   80  Free Memory = 82902 MB
Rank =   81  Free Memory = 82902 MB
Rank =   82  Free Memory = 82902 MB
Rank =   83  Free Memory = 82902 MB
Rank =   84  Free Memory = 82902 MB
Rank =   85  Free Memory = 82902 MB
Rank =   86  Free Memory = 82902 MB
Rank =   87  Free Memory = 82902 MB
Rank =   88  Free Memory = 82902 MB
Rank =   89  Free Memory = 82902 MB
Rank =   90  Free Memory = 82902 MB
Rank =   91  Free Memory = 82902 MB
Rank =   92  Free Memory = 82902 MB
Rank =   93  Free Memory = 82902 MB
Rank =   94  Free Memory = 82902 MB
Rank =   95  Free Memory = 82902 MB
Rank =   96  Free Memory = 83182 MB
Rank =   97  Free Memory = 83182 MB
Rank =   98  Free Memory = 83182 MB
Rank =   99  Free Memory = 83182 MB
Rank =  100  Free Memory = 83182 MB
Rank =  101  Free Memory = 83182 MB
Rank =  102  Free Memory = 83182 MB
Rank =  103  Free Memory = 83182 MB
Rank =  104  Free Memory = 83182 MB
Rank =  105  Free Memory = 83182 MB
Rank =  106  Free Memory = 83182 MB
Rank =  107  Free Memory = 83182 MB
Rank =  108  Free Memory = 83182 MB
Rank =  109  Free Memory = 83182 MB
Rank =  110  Free Memory = 83182 MB
Rank =  111  Free Memory = 83182 MB
Rank =  112  Free Memory = 83182 MB
Rank =  113  Free Memory = 83182 MB
Rank =  114  Free Memory = 83182 MB
Rank =  115  Free Memory = 83182 MB
Rank =  116  Free Memory = 83182 MB
Rank =  117  Free Memory = 83182 MB
Rank =  118  Free Memory = 83182 MB
Rank =  119  Free Memory = 83182 MB
Rank =  120  Free Memory = 83182 MB
Rank =  121  Free Memory = 83182 MB
Rank =  122  Free Memory = 83182 MB
Rank =  123  Free Memory = 83182 MB
Rank =  124  Free Memory = 83182 MB
Rank =  125  Free Memory = 83182 MB
Rank =  126  Free Memory = 83182 MB
Rank =  127  Free Memory = 83182 MB
  Input file(s): opt_h2o_gs_gvptt_run003l.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003l.xml

  Project = H2O
  date    = 2023-04-11 12:39:37 PDT
  host    = n0104.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 889

  Range of prime numbers to use as seeds over processors and threads = 6947-8101


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.073377e-01    1         1  ON     0
     uu_1                 4.380292e-02    1         1  ON     1
     uu_2                -5.300653e-02    1         1  ON     2
     uu_3                -1.106238e-01    1         1  ON     3
     uu_4                -1.474595e-01    1         1  ON     4
     uu_5                -1.595053e-01    1         1  ON     5
     uu_6                -1.461198e-01    1         1  ON     6
     uu_7                -9.606744e-02    1         1  ON     7
     uu_8                -1.476720e-03    1         1  ON     8
     uu_9                 2.066373e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.604248e-01    1         1  ON     0
     ud_1                 1.008170e-01    1         1  ON     1
     ud_2                -1.076269e-02    1         1  ON     2
     ud_3                -7.377313e-02    1         1  ON     3
     ud_4                -1.238808e-01    1         1  ON     4
     ud_5                -1.594010e-01    1         1  ON     5
     ud_6                -1.699357e-01    1         1  ON     6
     ud_7                -1.426043e-01    1         1  ON     7
     ud_8                -7.199485e-02    1         1  ON     8
     ud_9                 7.862970e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.963363e-01    1         1  ON     0
     eO_1                -5.701840e-01    1         1  ON     1
     eO_2                -1.499777e-01    1         1  ON     2
     eO_3                 1.246353e-01    1         1  ON     3
     eO_4                 2.499893e-01    1         1  ON     4
     eO_5                 3.252738e-01    1         1  ON     5
     eO_6                 3.531460e-01    1         1  ON     6
     eO_7                 4.011431e-01    1         1  ON     7
     eO_8                 1.014307e-01    1         1  ON     8
     eO_9                 3.821724e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.030663e-01    1         1  ON     0
     eH1_1                -1.239564e-01    1         1  ON     1
     eH1_2                -8.192127e-02    1         1  ON     2
     eH1_3                -4.454251e-02    1         1  ON     3
     eH1_4                 9.820410e-04    1         1  ON     4
     eH1_5                 1.146849e-02    1         1  ON     5
     eH1_6                 4.996182e-02    1         1  ON     6
     eH1_7                 4.766345e-02    1         1  ON     7
     eH1_8                 2.187687e-01    1         1  ON     8
     eH1_9                 8.402650e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.032865e-01    1         1  ON     0
     eH2_1                -1.237419e-01    1         1  ON     1
     eH2_2                -8.183911e-02    1         1  ON     2
     eH2_3                -4.443143e-02    1         1  ON     3
     eH2_4                 1.065973e-03    1         1  ON     4
     eH2_5                 1.158726e-02    1         1  ON     5
     eH2_6                 5.358717e-02    1         1  ON     6
     eH2_7                 6.391487e-02    1         1  ON     7
     eH2_8                 2.111449e-01    1         1  ON     8
     eH2_9                 8.150728e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.696802e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 7.9062e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1665
    reference variance = 0.365298
====================================================
  Execution time = 3.4288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327374005911
                                         uncertainty =       0.005042523660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327374005911
                                         uncertainty =       0.005042523660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404538636
  error estimate for blocks of size 2^( 2) =       0.000413523008
  error estimate for blocks of size 2^( 3) =       0.000422147888
  error estimate for blocks of size 2^( 4) =       0.000427980291
  error estimate for blocks of size 2^( 5) =       0.000432032137
  error estimate for blocks of size 2^( 6) =       0.000434577254
  error estimate for blocks of size 2^( 7) =       0.000435353953

      target function =                  N/A
              le_mean =     -17.216570381789
             les_mean =     296.737598564227
             stat err =       0.000432485909
             autocorr =       1.142941261386
              std dev =       0.572104026196
             le_variance =       0.327303016790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721657038179e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216570381789       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216569968960       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216570279815       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216570613386       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216570725920       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216571034095       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216570849484       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216571027667       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216571022269       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.605370e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216570381789       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216570230214       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216570309829       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216570411347       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216570391352       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216570515235       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216570500552       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.643547e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216570381789       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216570338866       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216570356259       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216570383275       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216570363900       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216570397168       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216570402353       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.735179e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3972e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.072971e-01                 1 1 ON  0
uu_1  4.380793e-02                 1 1 ON  1
uu_2  -5.293506e-02                1 1 ON  2
uu_3  -1.105617e-01                1 1 ON  3
uu_4  -1.474998e-01                1 1 ON  4
uu_5  -1.595648e-01                1 1 ON  5
uu_6  -1.461519e-01                1 1 ON  6
uu_7  -9.606746e-02                1 1 ON  7
uu_8  -1.464993e-03                1 1 ON  8
uu_9  2.066304e-01                 1 1 ON  9
ud_0  3.604045e-01                 1 1 ON  10
ud_1  1.007976e-01                 1 1 ON  11
ud_2  -1.072627e-02                1 1 ON  12
ud_3  -7.383723e-02                1 1 ON  13
ud_4  -1.238526e-01                1 1 ON  14
ud_5  -1.592939e-01                1 1 ON  15
ud_6  -1.699235e-01                1 1 ON  16
ud_7  -1.426386e-01                1 1 ON  17
ud_8  -7.203004e-02                1 1 ON  18
ud_9  7.860344e-02                 1 1 ON  19
eO_0  -8.963283e-01                1 1 ON  20
eO_1  -5.702127e-01                1 1 ON  21
eO_2  -1.500717e-01                1 1 ON  22
eO_3  1.247049e-01                 1 1 ON  23
eO_4  2.499916e-01                 1 1 ON  24
eO_5  3.252789e-01                 1 1 ON  25
eO_6  3.531275e-01                 1 1 ON  26
eO_7  4.011737e-01                 1 1 ON  27
eO_8  1.014539e-01                 1 1 ON  28
eO_9  3.821799e-02                 1 1 ON  29
eH1_0 -2.030556e-01                1 1 ON  30
eH1_1 -1.240545e-01                1 1 ON  31
eH1_2 -8.202244e-02                1 1 ON  32
eH1_3 -4.454500e-02                1 1 ON  33
eH1_4 1.026792e-03                 1 1 ON  34
eH1_5 1.153649e-02                 1 1 ON  35
eH1_6 5.001036e-02                 1 1 ON  36
eH1_7 4.768387e-02                 1 1 ON  37
eH1_8 2.187658e-01                 1 1 ON  38
eH1_9 8.403558e-02                 1 1 ON  39
eH2_0 -2.032688e-01                1 1 ON  40
eH2_1 -1.239063e-01                1 1 ON  41
eH2_2 -8.186480e-02                1 1 ON  42
eH2_3 -4.436871e-02                1 1 ON  43
eH2_4 1.157358e-03                 1 1 ON  44
eH2_5 1.163477e-02                 1 1 ON  45
eH2_6 5.355008e-02                 1 1 ON  46
eH2_7 6.390221e-02                 1 1 ON  47
eH2_8 2.111482e-01                 1 1 ON  48
eH2_9 8.152038e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.206839
====================================================
  Execution time = 3.3762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1786e-01
  Total weights = 2.0000e+06
  Execution time = 3.1230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317986355193
                                         uncertainty =       0.003134488852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317986355193
                                         uncertainty =       0.003134488852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398704295
  error estimate for blocks of size 2^( 2) =       0.000408487351
  error estimate for blocks of size 2^( 3) =       0.000416760531
  error estimate for blocks of size 2^( 4) =       0.000423223979
  error estimate for blocks of size 2^( 5) =       0.000426712577
  error estimate for blocks of size 2^( 6) =       0.000428759897
  error estimate for blocks of size 2^( 7) =       0.000429770779

      target function =                  N/A
              le_mean =     -17.217635671499
             les_mean =     296.764908187448
             stat err =       0.000427116808
             autocorr =       1.147602527350
              std dev =       0.563853021564
             le_variance =       0.317930229927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317840159612
                                         uncertainty =       0.003131000744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317840159612
                                         uncertainty =       0.003131000744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398612723
  error estimate for blocks of size 2^( 2) =       0.000408397230
  error estimate for blocks of size 2^( 3) =       0.000416671845
  error estimate for blocks of size 2^( 4) =       0.000423137145
  error estimate for blocks of size 2^( 5) =       0.000426627112
  error estimate for blocks of size 2^( 6) =       0.000428677188
  error estimate for blocks of size 2^( 7) =       0.000429688513

      target function =                  N/A
              le_mean =     -17.217635120447
             les_mean =     296.764743187698
             stat err =       0.000427032490
             autocorr =       1.147676593257
              std dev =       0.563723518895
             le_variance =       0.317784205755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317847482702
                                         uncertainty =       0.003131533066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317847482702
                                         uncertainty =       0.003131533066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398617287
  error estimate for blocks of size 2^( 2) =       0.000408402287
  error estimate for blocks of size 2^( 3) =       0.000416677458
  error estimate for blocks of size 2^( 4) =       0.000423143445
  error estimate for blocks of size 2^( 5) =       0.000426633091
  error estimate for blocks of size 2^( 6) =       0.000428684035
  error estimate for blocks of size 2^( 7) =       0.000429695131

      target function =                  N/A
              le_mean =     -17.217635165413
             les_mean =     296.764752012865
             stat err =       0.000427038925
             autocorr =       1.147684905949
              std dev =       0.563729973020
             le_variance =       0.317791482481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317964420877
                                         uncertainty =       0.003134046204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317964420877
                                         uncertainty =       0.003134046204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398690553
  error estimate for blocks of size 2^( 2) =       0.000408473923
  error estimate for blocks of size 2^( 3) =       0.000416747426
  error estimate for blocks of size 2^( 4) =       0.000423211285
  error estimate for blocks of size 2^( 5) =       0.000426699995
  error estimate for blocks of size 2^( 6) =       0.000428747956
  error estimate for blocks of size 2^( 7) =       0.000429758787

      target function =                  N/A
              le_mean =     -17.217635557476
             les_mean =     296.764882344535
             stat err =       0.000427104506
             autocorr =       1.147615529653
              std dev =       0.563833586652
             le_variance =       0.317908313437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217635671499        initial  <--
     2.5000e-01     2.5000e+00             4.6054e-04       -17.217635120447
     1.0000e+00     1.0000e+01             1.6435e-04       -17.217635165413
     4.0000e+00     4.0000e+01             4.7352e-05       -17.217635557476

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4977
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.073377e-01 1 1  ON 0
 uu_1                 4.380292e-02 1 1  ON 1
 uu_2                -5.300653e-02 1 1  ON 2
 uu_3                -1.106238e-01 1 1  ON 3
 uu_4                -1.474595e-01 1 1  ON 4
 uu_5                -1.595053e-01 1 1  ON 5
 uu_6                -1.461198e-01 1 1  ON 6
 uu_7                -9.606744e-02 1 1  ON 7
 uu_8                -1.476720e-03 1 1  ON 8
 uu_9                 2.066373e-01 1 1  ON 9
 ud_0                 3.604248e-01 1 1  ON 10
 ud_1                 1.008170e-01 1 1  ON 11
 ud_2                -1.076269e-02 1 1  ON 12
 ud_3                -7.377313e-02 1 1  ON 13
 ud_4                -1.238808e-01 1 1  ON 14
 ud_5                -1.594010e-01 1 1  ON 15
 ud_6                -1.699357e-01 1 1  ON 16
 ud_7                -1.426043e-01 1 1  ON 17
 ud_8                -7.199485e-02 1 1  ON 18
 ud_9                 7.862970e-02 1 1  ON 19
 eO_0                -8.963363e-01 1 1  ON 20
 eO_1                -5.701840e-01 1 1  ON 21
 eO_2                -1.499777e-01 1 1  ON 22
 eO_3                 1.246353e-01 1 1  ON 23
 eO_4                 2.499893e-01 1 1  ON 24
 eO_5                 3.252738e-01 1 1  ON 25
 eO_6                 3.531460e-01 1 1  ON 26
 eO_7                 4.011431e-01 1 1  ON 27
 eO_8                 1.014307e-01 1 1  ON 28
 eO_9                 3.821724e-02 1 1  ON 29
eH1_0                -2.030663e-01 1 1  ON 30
eH1_1                -1.239564e-01 1 1  ON 31
eH1_2                -8.192127e-02 1 1  ON 32
eH1_3                -4.454251e-02 1 1  ON 33
eH1_4                 9.820410e-04 1 1  ON 34
eH1_5                 1.146849e-02 1 1  ON 35
eH1_6                 4.996182e-02 1 1  ON 36
eH1_7                 4.766345e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402650e-02 1 1  ON 39
eH2_0                -2.032865e-01 1 1  ON 40
eH2_1                -1.237419e-01 1 1  ON 41
eH2_2                -8.183911e-02 1 1  ON 42
eH2_3                -4.443143e-02 1 1  ON 43
eH2_4                 1.065973e-03 1 1  ON 44
eH2_5                 1.158726e-02 1 1  ON 45
eH2_6                 5.358717e-02 1 1  ON 46
eH2_7                 6.391487e-02 1 1  ON 47
eH2_8                 2.111449e-01 1 1  ON 48
eH2_9                 8.150728e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.3311
    reference variance = 0.442986
====================================================
  Execution time = 3.6959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315907252574
                                         uncertainty =       0.003434794815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315907252574
                                         uncertainty =       0.003434794815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397404780
  error estimate for blocks of size 2^( 2) =       0.000406942596
  error estimate for blocks of size 2^( 3) =       0.000415293105
  error estimate for blocks of size 2^( 4) =       0.000421091918
  error estimate for blocks of size 2^( 5) =       0.000426565991
  error estimate for blocks of size 2^( 6) =       0.000429138655
  error estimate for blocks of size 2^( 7) =       0.000429561110

      target function =                  N/A
              le_mean =     -17.216800775244
             les_mean =     296.734089894440
             stat err =       0.000426589419
             autocorr =       1.152269284485
              std dev =       0.562015229264
             le_variance =       0.315861117924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680077524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800775244       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800802443       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800889973       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216800877105       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216800875153       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216800882853       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216800893909       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 4.918748e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800775244       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800782620       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800805349       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216800801842       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216800800801       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216800802969       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216800805803       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.340249e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800775244       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800777128       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800782867       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216800781969       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216800781666       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216800782226       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216800782938       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 3.430107e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6242e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.073294e-01 1 1  ON 0
 uu_1                 4.379263e-02 1 1  ON 1
 uu_2                -5.301076e-02 1 1  ON 2
 uu_3                -1.106217e-01 1 1  ON 3
 uu_4                -1.474521e-01 1 1  ON 4
 uu_5                -1.594949e-01 1 1  ON 5
 uu_6                -1.461167e-01 1 1  ON 6
 uu_7                -9.606888e-02 1 1  ON 7
 uu_8                -1.478759e-03 1 1  ON 8
 uu_9                 2.066358e-01 1 1  ON 9
 ud_0                 3.604319e-01 1 1  ON 10
 ud_1                 1.008304e-01 1 1  ON 11
 ud_2                -1.075753e-02 1 1  ON 12
 ud_3                -7.378016e-02 1 1  ON 13
 ud_4                -1.238852e-01 1 1  ON 14
 ud_5                -1.594101e-01 1 1  ON 15
 ud_6                -1.699383e-01 1 1  ON 16
 ud_7                -1.426036e-01 1 1  ON 17
 ud_8                -7.199812e-02 1 1  ON 18
 ud_9                 7.862704e-02 1 1  ON 19
 eO_0                -8.963407e-01 1 1  ON 20
 eO_1                -5.701840e-01 1 1  ON 21
 eO_2                -1.499856e-01 1 1  ON 22
 eO_3                 1.246401e-01 1 1  ON 23
 eO_4                 2.499917e-01 1 1  ON 24
 eO_5                 3.252741e-01 1 1  ON 25
 eO_6                 3.531448e-01 1 1  ON 26
 eO_7                 4.011464e-01 1 1  ON 27
 eO_8                 1.014328e-01 1 1  ON 28
 eO_9                 3.821753e-02 1 1  ON 29
eH1_0                -2.030644e-01 1 1  ON 30
eH1_1                -1.239572e-01 1 1  ON 31
eH1_2                -8.192920e-02 1 1  ON 32
eH1_3                -4.454268e-02 1 1  ON 33
eH1_4                 9.761090e-04 1 1  ON 34
eH1_5                 1.147432e-02 1 1  ON 35
eH1_6                 4.996290e-02 1 1  ON 36
eH1_7                 4.766810e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402728e-02 1 1  ON 39
eH2_0                -2.032829e-01 1 1  ON 40
eH2_1                -1.237508e-01 1 1  ON 41
eH2_2                -8.184542e-02 1 1  ON 42
eH2_3                -4.442397e-02 1 1  ON 43
eH2_4                 1.075347e-03 1 1  ON 44
eH2_5                 1.159204e-02 1 1  ON 45
eH2_6                 5.357891e-02 1 1  ON 46
eH2_7                 6.391112e-02 1 1  ON 47
eH2_8                 2.111442e-01 1 1  ON 48
eH2_9                 8.150921e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.290405
====================================================
  Execution time = 3.3656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.0000e+06
  Execution time = 3.1117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315821943696
                                         uncertainty =       0.002647810077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315821943696
                                         uncertainty =       0.002647810077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397367195
  error estimate for blocks of size 2^( 2) =       0.000406946932
  error estimate for blocks of size 2^( 3) =       0.000415408528
  error estimate for blocks of size 2^( 4) =       0.000421463619
  error estimate for blocks of size 2^( 5) =       0.000424872713
  error estimate for blocks of size 2^( 6) =       0.000426735361
  error estimate for blocks of size 2^( 7) =       0.000427285051

      target function =                  N/A
              le_mean =     -17.216833820405
             les_mean =     296.735168017100
             stat err =       0.000425089186
             autocorr =       1.144395371195
              std dev =       0.561962076619
             le_variance =       0.315801375558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315818366504
                                         uncertainty =       0.002647708996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315818366504
                                         uncertainty =       0.002647708996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397364938
  error estimate for blocks of size 2^( 2) =       0.000406944875
  error estimate for blocks of size 2^( 3) =       0.000415406153
  error estimate for blocks of size 2^( 4) =       0.000421460443
  error estimate for blocks of size 2^( 5) =       0.000424869793
  error estimate for blocks of size 2^( 6) =       0.000426733010
  error estimate for blocks of size 2^( 7) =       0.000427283458

      target function =                  N/A
              le_mean =     -17.216833976216
             les_mean =     296.735169794997
             stat err =       0.000425086676
             autocorr =       1.144394855164
              std dev =       0.561958884901
             le_variance =       0.315797788319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315818574844
                                         uncertainty =       0.002647743377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315818574844
                                         uncertainty =       0.002647743377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397365072
  error estimate for blocks of size 2^( 2) =       0.000406944957
  error estimate for blocks of size 2^( 3) =       0.000415406426
  error estimate for blocks of size 2^( 4) =       0.000421461096
  error estimate for blocks of size 2^( 5) =       0.000424870340
  error estimate for blocks of size 2^( 6) =       0.000426733319
  error estimate for blocks of size 2^( 7) =       0.000427283419

      target function =                  N/A
              le_mean =     -17.216833900000
             les_mean =     296.735167383846
             stat err =       0.000425087044
             autocorr =       1.144396062247
              std dev =       0.561959074628
             le_variance =       0.315798001557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315821458326
                                         uncertainty =       0.002647801105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315821458326
                                         uncertainty =       0.002647801105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397366889
  error estimate for blocks of size 2^( 2) =       0.000406946647
  error estimate for blocks of size 2^( 3) =       0.000415408228
  error estimate for blocks of size 2^( 4) =       0.000421463266
  error estimate for blocks of size 2^( 5) =       0.000424872379
  error estimate for blocks of size 2^( 6) =       0.000426735070
  error estimate for blocks of size 2^( 7) =       0.000427284812

      target function =                  N/A
              le_mean =     -17.216833830083
             les_mean =     296.735167864341
             stat err =       0.000425088882
             autocorr =       1.144395493680
              std dev =       0.561961644190
             le_variance =       0.315800889541


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216833820405        initial
     2.5000e+00     2.5000e+01             4.9187e-05       -17.216833976216  <--
     1.0000e+01     1.0000e+02             1.3402e-05       -17.216833900000
     4.0000e+01     4.0000e+02             3.4301e-06       -17.216833830083

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.9320e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.073055e-01 1 1  ON 0
 uu_1                 4.376423e-02 1 1  ON 1
 uu_2                -5.302273e-02 1 1  ON 2
 uu_3                -1.106160e-01 1 1  ON 3
 uu_4                -1.474312e-01 1 1  ON 4
 uu_5                -1.594646e-01 1 1  ON 5
 uu_6                -1.461076e-01 1 1  ON 6
 uu_7                -9.607318e-02 1 1  ON 7
 uu_8                -1.484637e-03 1 1  ON 8
 uu_9                 2.066315e-01 1 1  ON 9
 ud_0                 3.604552e-01 1 1  ON 10
 ud_1                 1.008662e-01 1 1  ON 11
 ud_2                -1.074292e-02 1 1  ON 12
 ud_3                -7.379868e-02 1 1  ON 13
 ud_4                -1.238997e-01 1 1  ON 14
 ud_5                -1.594361e-01 1 1  ON 15
 ud_6                -1.699457e-01 1 1  ON 16
 ud_7                -1.426014e-01 1 1  ON 17
 ud_8                -7.200742e-02 1 1  ON 18
 ud_9                 7.861943e-02 1 1  ON 19
 eO_0                -8.963518e-01 1 1  ON 20
 eO_1                -5.701849e-01 1 1  ON 21
 eO_2                -1.500081e-01 1 1  ON 22
 eO_3                 1.246531e-01 1 1  ON 23
 eO_4                 2.499986e-01 1 1  ON 24
 eO_5                 3.252751e-01 1 1  ON 25
 eO_6                 3.531413e-01 1 1  ON 26
 eO_7                 4.011560e-01 1 1  ON 27
 eO_8                 1.014391e-01 1 1  ON 28
 eO_9                 3.821836e-02 1 1  ON 29
eH1_0                -2.030586e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.195127e-02 1 1  ON 32
eH1_3                -4.454353e-02 1 1  ON 33
eH1_4                 9.595781e-04 1 1  ON 34
eH1_5                 1.149083e-02 1 1  ON 35
eH1_6                 4.996611e-02 1 1  ON 36
eH1_7                 4.768138e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402953e-02 1 1  ON 39
eH2_0                -2.032735e-01 1 1  ON 40
eH2_1                -1.237761e-01 1 1  ON 41
eH2_2                -8.186244e-02 1 1  ON 42
eH2_3                -4.440435e-02 1 1  ON 43
eH2_4                 1.103328e-03 1 1  ON 44
eH2_5                 1.160595e-02 1 1  ON 45
eH2_6                 5.355525e-02 1 1  ON 46
eH2_7                 6.390036e-02 1 1  ON 47
eH2_8                 2.111421e-01 1 1  ON 48
eH2_9                 8.151471e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.21355
====================================================
  Execution time = 3.4279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325161522265
                                         uncertainty =       0.004150138107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325161522265
                                         uncertainty =       0.004150138107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403176177
  error estimate for blocks of size 2^( 2) =       0.000413042141
  error estimate for blocks of size 2^( 3) =       0.000421608549
  error estimate for blocks of size 2^( 4) =       0.000428081271
  error estimate for blocks of size 2^( 5) =       0.000431735784
  error estimate for blocks of size 2^( 6) =       0.000435334311
  error estimate for blocks of size 2^( 7) =       0.000438400850

      target function =                  N/A
              le_mean =     -17.216689340864
             les_mean =     296.739493756068
             stat err =       0.000433388054
             autocorr =       1.155484564366
              std dev =       0.570177217017
             le_variance =       0.325102058805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668934086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216689340864       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216689746093       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216689197929       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216689340705       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216689151419       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216689819263       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216689703793       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216689949896       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.133329e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216689340864       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216689463847       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216689299814       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216689325907       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216689278685       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216689459401       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216689446257       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.186701e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216689340864       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216689373347       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216689330223       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216689335318       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216689323093       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216689368329       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216689368410       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.630462e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3643e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.072451e-01 1 1  ON 0
 uu_1                 4.376482e-02 1 1  ON 1
 uu_2                -5.299944e-02 1 1  ON 2
 uu_3                -1.105830e-01 1 1  ON 3
 uu_4                -1.474460e-01 1 1  ON 4
 uu_5                -1.594256e-01 1 1  ON 5
 uu_6                -1.461208e-01 1 1  ON 6
 uu_7                -9.607444e-02 1 1  ON 7
 uu_8                -1.490423e-03 1 1  ON 8
 uu_9                 2.066228e-01 1 1  ON 9
 ud_0                 3.604726e-01 1 1  ON 10
 ud_1                 1.008768e-01 1 1  ON 11
 ud_2                -1.072841e-02 1 1  ON 12
 ud_3                -7.381375e-02 1 1  ON 13
 ud_4                -1.239130e-01 1 1  ON 14
 ud_5                -1.594338e-01 1 1  ON 15
 ud_6                -1.699397e-01 1 1  ON 16
 ud_7                -1.425904e-01 1 1  ON 17
 ud_8                -7.202386e-02 1 1  ON 18
 ud_9                 7.860099e-02 1 1  ON 19
 eO_0                -8.963693e-01 1 1  ON 20
 eO_1                -5.702040e-01 1 1  ON 21
 eO_2                -1.500413e-01 1 1  ON 22
 eO_3                 1.247091e-01 1 1  ON 23
 eO_4                 2.500022e-01 1 1  ON 24
 eO_5                 3.252750e-01 1 1  ON 25
 eO_6                 3.531390e-01 1 1  ON 26
 eO_7                 4.011618e-01 1 1  ON 27
 eO_8                 1.014451e-01 1 1  ON 28
 eO_9                 3.821903e-02 1 1  ON 29
eH1_0                -2.030368e-01 1 1  ON 30
eH1_1                -1.239638e-01 1 1  ON 31
eH1_2                -8.200049e-02 1 1  ON 32
eH1_3                -4.455071e-02 1 1  ON 33
eH1_4                 9.699412e-04 1 1  ON 34
eH1_5                 1.150114e-02 1 1  ON 35
eH1_6                 4.996931e-02 1 1  ON 36
eH1_7                 4.769372e-02 1 1  ON 37
eH1_8                 2.187681e-01 1 1  ON 38
eH1_9                 8.403077e-02 1 1  ON 39
eH2_0                -2.033025e-01 1 1  ON 40
eH2_1                -1.238283e-01 1 1  ON 41
eH2_2                -8.186635e-02 1 1  ON 42
eH2_3                -4.438865e-02 1 1  ON 43
eH2_4                 1.165195e-03 1 1  ON 44
eH2_5                 1.164029e-02 1 1  ON 45
eH2_6                 5.353933e-02 1 1  ON 46
eH2_7                 6.389156e-02 1 1  ON 47
eH2_8                 2.111367e-01 1 1  ON 48
eH2_9                 8.151611e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.3112
    reference variance = 0.262313
====================================================
  Execution time = 3.3509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2173e-01
  Total weights = 2.0000e+06
  Execution time = 3.0988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321727576671
                                         uncertainty =       0.004481901752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321727576671
                                         uncertainty =       0.004481901752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401090998
  error estimate for blocks of size 2^( 2) =       0.000410791543
  error estimate for blocks of size 2^( 3) =       0.000419213356
  error estimate for blocks of size 2^( 4) =       0.000425989298
  error estimate for blocks of size 2^( 5) =       0.000429179978
  error estimate for blocks of size 2^( 6) =       0.000429976642
  error estimate for blocks of size 2^( 7) =       0.000431514860

      target function =                  N/A
              le_mean =     -17.216879022962
             les_mean =     296.742671107026
             stat err =       0.000429165195
             autocorr =       1.144888407271
              std dev =       0.567228328447
             le_variance =       0.321747976593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321684771463
                                         uncertainty =       0.004482254058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321684771463
                                         uncertainty =       0.004482254058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401064258
  error estimate for blocks of size 2^( 2) =       0.000410765433
  error estimate for blocks of size 2^( 3) =       0.000419186485
  error estimate for blocks of size 2^( 4) =       0.000425961893
  error estimate for blocks of size 2^( 5) =       0.000429146446
  error estimate for blocks of size 2^( 6) =       0.000429940310
  error estimate for blocks of size 2^( 7) =       0.000431484342

      target function =                  N/A
              le_mean =     -17.216878638437
             les_mean =     296.742614967699
             stat err =       0.000429133248
             autocorr =       1.144870610162
              std dev =       0.567190512879
             le_variance =       0.321705077900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321694964973
                                         uncertainty =       0.004481902386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321694964973
                                         uncertainty =       0.004481902386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401070631
  error estimate for blocks of size 2^( 2) =       0.000410771936
  error estimate for blocks of size 2^( 3) =       0.000419193420
  error estimate for blocks of size 2^( 4) =       0.000425969089
  error estimate for blocks of size 2^( 5) =       0.000429155969
  error estimate for blocks of size 2^( 6) =       0.000429951180
  error estimate for blocks of size 2^( 7) =       0.000431492872

      target function =                  N/A
              le_mean =     -17.216878662345
             les_mean =     296.742626015304
             stat err =       0.000429142277
             autocorr =       1.144882403062
              std dev =       0.567199525955
             le_variance =       0.321715302243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321723055115
                                         uncertainty =       0.004481899004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321723055115
                                         uncertainty =       0.004481899004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401088174
  error estimate for blocks of size 2^( 2) =       0.000410788823
  error estimate for blocks of size 2^( 3) =       0.000419210592
  error estimate for blocks of size 2^( 4) =       0.000425986496
  error estimate for blocks of size 2^( 5) =       0.000429176662
  error estimate for blocks of size 2^( 6) =       0.000429973141
  error estimate for blocks of size 2^( 7) =       0.000431511834

      target function =                  N/A
              le_mean =     -17.216878963655
             les_mean =     296.742664534779
             stat err =       0.000429162033
             autocorr =       1.144887660297
              std dev =       0.567224335268
             le_variance =       0.321743446521


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216879022962        initial  <--
     6.2500e-01     6.2500e+00             2.1333e-04       -17.216878638437
     2.5000e+00     2.5000e+01             6.1867e-05       -17.216878662345
     1.0000e+01     1.0000e+02             1.6305e-05       -17.216878963655

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2199
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.073055e-01 1 1  ON 0
 uu_1                 4.376423e-02 1 1  ON 1
 uu_2                -5.302273e-02 1 1  ON 2
 uu_3                -1.106160e-01 1 1  ON 3
 uu_4                -1.474312e-01 1 1  ON 4
 uu_5                -1.594646e-01 1 1  ON 5
 uu_6                -1.461076e-01 1 1  ON 6
 uu_7                -9.607318e-02 1 1  ON 7
 uu_8                -1.484637e-03 1 1  ON 8
 uu_9                 2.066315e-01 1 1  ON 9
 ud_0                 3.604552e-01 1 1  ON 10
 ud_1                 1.008662e-01 1 1  ON 11
 ud_2                -1.074292e-02 1 1  ON 12
 ud_3                -7.379868e-02 1 1  ON 13
 ud_4                -1.238997e-01 1 1  ON 14
 ud_5                -1.594361e-01 1 1  ON 15
 ud_6                -1.699457e-01 1 1  ON 16
 ud_7                -1.426014e-01 1 1  ON 17
 ud_8                -7.200742e-02 1 1  ON 18
 ud_9                 7.861943e-02 1 1  ON 19
 eO_0                -8.963518e-01 1 1  ON 20
 eO_1                -5.701849e-01 1 1  ON 21
 eO_2                -1.500081e-01 1 1  ON 22
 eO_3                 1.246531e-01 1 1  ON 23
 eO_4                 2.499986e-01 1 1  ON 24
 eO_5                 3.252751e-01 1 1  ON 25
 eO_6                 3.531413e-01 1 1  ON 26
 eO_7                 4.011560e-01 1 1  ON 27
 eO_8                 1.014391e-01 1 1  ON 28
 eO_9                 3.821836e-02 1 1  ON 29
eH1_0                -2.030586e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.195127e-02 1 1  ON 32
eH1_3                -4.454353e-02 1 1  ON 33
eH1_4                 9.595781e-04 1 1  ON 34
eH1_5                 1.149083e-02 1 1  ON 35
eH1_6                 4.996611e-02 1 1  ON 36
eH1_7                 4.768138e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402953e-02 1 1  ON 39
eH2_0                -2.032735e-01 1 1  ON 40
eH2_1                -1.237761e-01 1 1  ON 41
eH2_2                -8.186244e-02 1 1  ON 42
eH2_3                -4.440435e-02 1 1  ON 43
eH2_4                 1.103328e-03 1 1  ON 44
eH2_5                 1.160595e-02 1 1  ON 45
eH2_6                 5.355525e-02 1 1  ON 46
eH2_7                 6.390036e-02 1 1  ON 47
eH2_8                 2.111421e-01 1 1  ON 48
eH2_9                 8.151471e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7237e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.188
    reference variance = 0.181064
====================================================
  Execution time = 3.3787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2389e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323795823848
                                         uncertainty =       0.004443506917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323795823848
                                         uncertainty =       0.004443506917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402421431
  error estimate for blocks of size 2^( 2) =       0.000412469017
  error estimate for blocks of size 2^( 3) =       0.000420987619
  error estimate for blocks of size 2^( 4) =       0.000427650637
  error estimate for blocks of size 2^( 5) =       0.000431564731
  error estimate for blocks of size 2^( 6) =       0.000433686276
  error estimate for blocks of size 2^( 7) =       0.000435236563

      target function =                  N/A
              le_mean =     -17.217909060907
             les_mean =     296.780278283882
             stat err =       0.000432034552
             autocorr =       1.152589765351
              std dev =       0.569109845437
             le_variance =       0.323886016174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721790906091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217909060907       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217909106163       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217909234280       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217909251475       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217909271070       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217909277753       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217909278555       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.099983e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217909060907       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217909072513       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217909105541       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217909110338       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217909115803       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217909117959       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217909118348       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.516574e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217909060907       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217909063827       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217909072149       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217909073382       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217909074788       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217909075360       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217909075471       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.397197e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3285e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.073007e-01 1 1  ON 0
 uu_1                 4.375937e-02 1 1  ON 1
 uu_2                -5.302044e-02 1 1  ON 2
 uu_3                -1.106128e-01 1 1  ON 3
 uu_4                -1.474263e-01 1 1  ON 4
 uu_5                -1.594616e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607455e-02 1 1  ON 7
 uu_8                -1.486124e-03 1 1  ON 8
 uu_9                 2.066308e-01 1 1  ON 9
 ud_0                 3.604549e-01 1 1  ON 10
 ud_1                 1.008717e-01 1 1  ON 11
 ud_2                -1.074267e-02 1 1  ON 12
 ud_3                -7.379694e-02 1 1  ON 13
 ud_4                -1.239020e-01 1 1  ON 14
 ud_5                -1.594371e-01 1 1  ON 15
 ud_6                -1.699461e-01 1 1  ON 16
 ud_7                -1.426016e-01 1 1  ON 17
 ud_8                -7.200958e-02 1 1  ON 18
 ud_9                 7.861749e-02 1 1  ON 19
 eO_0                -8.963516e-01 1 1  ON 20
 eO_1                -5.701847e-01 1 1  ON 21
 eO_2                -1.500105e-01 1 1  ON 22
 eO_3                 1.246542e-01 1 1  ON 23
 eO_4                 2.499995e-01 1 1  ON 24
 eO_5                 3.252752e-01 1 1  ON 25
 eO_6                 3.531403e-01 1 1  ON 26
 eO_7                 4.011561e-01 1 1  ON 27
 eO_8                 1.014396e-01 1 1  ON 28
 eO_9                 3.821855e-02 1 1  ON 29
eH1_0                -2.030606e-01 1 1  ON 30
eH1_1                -1.239609e-01 1 1  ON 31
eH1_2                -8.195368e-02 1 1  ON 32
eH1_3                -4.454009e-02 1 1  ON 33
eH1_4                 9.586106e-04 1 1  ON 34
eH1_5                 1.149069e-02 1 1  ON 35
eH1_6                 4.996673e-02 1 1  ON 36
eH1_7                 4.768293e-02 1 1  ON 37
eH1_8                 2.187686e-01 1 1  ON 38
eH1_9                 8.402973e-02 1 1  ON 39
eH2_0                -2.032751e-01 1 1  ON 40
eH2_1                -1.237785e-01 1 1  ON 41
eH2_2                -8.186017e-02 1 1  ON 42
eH2_3                -4.440426e-02 1 1  ON 43
eH2_4                 1.108012e-03 1 1  ON 44
eH2_5                 1.160519e-02 1 1  ON 45
eH2_6                 5.355415e-02 1 1  ON 46
eH2_7                 6.389964e-02 1 1  ON 47
eH2_8                 2.111415e-01 1 1  ON 48
eH2_9                 8.151480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2349
    reference variance = 0.55782
====================================================
  Execution time = 3.3037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1238e-01
  Total weights = 2.0000e+06
  Execution time = 3.1235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312459382604
                                         uncertainty =       0.002347456536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312459382604
                                         uncertainty =       0.002347456536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395211161
  error estimate for blocks of size 2^( 2) =       0.000405105499
  error estimate for blocks of size 2^( 3) =       0.000413637644
  error estimate for blocks of size 2^( 4) =       0.000419856086
  error estimate for blocks of size 2^( 5) =       0.000424684596
  error estimate for blocks of size 2^( 6) =       0.000427374814
  error estimate for blocks of size 2^( 7) =       0.000426441175

      target function =                  N/A
              le_mean =     -17.217682443943
             les_mean =     296.760972307868
             stat err =       0.000424589168
             autocorr =       1.154195610581
              std dev =       0.558912983914
             le_variance =       0.312383723587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312439592711
                                         uncertainty =       0.002347285271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312439592711
                                         uncertainty =       0.002347285271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395198644
  error estimate for blocks of size 2^( 2) =       0.000405093294
  error estimate for blocks of size 2^( 3) =       0.000413625707
  error estimate for blocks of size 2^( 4) =       0.000419844207
  error estimate for blocks of size 2^( 5) =       0.000424672973
  error estimate for blocks of size 2^( 6) =       0.000427362859
  error estimate for blocks of size 2^( 7) =       0.000426429442

      target function =                  N/A
              le_mean =     -17.217682429617
             les_mean =     296.760952027702
             stat err =       0.000424577370
             autocorr =       1.154204581281
              std dev =       0.558895282433
             le_variance =       0.312363936726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312448955722
                                         uncertainty =       0.002347366429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312448955722
                                         uncertainty =       0.002347366429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395204566
  error estimate for blocks of size 2^( 2) =       0.000405099069
  error estimate for blocks of size 2^( 3) =       0.000413631358
  error estimate for blocks of size 2^( 4) =       0.000419849830
  error estimate for blocks of size 2^( 5) =       0.000424678475
  error estimate for blocks of size 2^( 6) =       0.000427368516
  error estimate for blocks of size 2^( 7) =       0.000426435003

      target function =                  N/A
              le_mean =     -17.217682435374
             les_mean =     296.760961587602
             stat err =       0.000424582956
             autocorr =       1.154200358527
              std dev =       0.558903657539
             le_variance =       0.312373298410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312458060872
                                         uncertainty =       0.002347445121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312458060872
                                         uncertainty =       0.002347445121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395210325
  error estimate for blocks of size 2^( 2) =       0.000405104684
  error estimate for blocks of size 2^( 3) =       0.000413636847
  error estimate for blocks of size 2^( 4) =       0.000419855293
  error estimate for blocks of size 2^( 5) =       0.000424683820
  error estimate for blocks of size 2^( 6) =       0.000427374015
  error estimate for blocks of size 2^( 7) =       0.000426440393

      target function =                  N/A
              le_mean =     -17.217682442752
             les_mean =     296.760970945320
             stat err =       0.000424588380
             autocorr =       1.154196212568
              std dev =       0.558911801696
             le_variance =       0.312382402075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217682443943        initial  <--
     6.2500e+00     6.2500e+01             2.1000e-05       -17.217682429617
     2.5000e+01     2.5000e+02             5.5166e-06       -17.217682435374
     1.0000e+02     1.0000e+03             1.3972e-06       -17.217682442752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.7649
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.073055e-01 1 1  ON 0
 uu_1                 4.376423e-02 1 1  ON 1
 uu_2                -5.302273e-02 1 1  ON 2
 uu_3                -1.106160e-01 1 1  ON 3
 uu_4                -1.474312e-01 1 1  ON 4
 uu_5                -1.594646e-01 1 1  ON 5
 uu_6                -1.461076e-01 1 1  ON 6
 uu_7                -9.607318e-02 1 1  ON 7
 uu_8                -1.484637e-03 1 1  ON 8
 uu_9                 2.066315e-01 1 1  ON 9
 ud_0                 3.604552e-01 1 1  ON 10
 ud_1                 1.008662e-01 1 1  ON 11
 ud_2                -1.074292e-02 1 1  ON 12
 ud_3                -7.379868e-02 1 1  ON 13
 ud_4                -1.238997e-01 1 1  ON 14
 ud_5                -1.594361e-01 1 1  ON 15
 ud_6                -1.699457e-01 1 1  ON 16
 ud_7                -1.426014e-01 1 1  ON 17
 ud_8                -7.200742e-02 1 1  ON 18
 ud_9                 7.861943e-02 1 1  ON 19
 eO_0                -8.963518e-01 1 1  ON 20
 eO_1                -5.701849e-01 1 1  ON 21
 eO_2                -1.500081e-01 1 1  ON 22
 eO_3                 1.246531e-01 1 1  ON 23
 eO_4                 2.499986e-01 1 1  ON 24
 eO_5                 3.252751e-01 1 1  ON 25
 eO_6                 3.531413e-01 1 1  ON 26
 eO_7                 4.011560e-01 1 1  ON 27
 eO_8                 1.014391e-01 1 1  ON 28
 eO_9                 3.821836e-02 1 1  ON 29
eH1_0                -2.030586e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.195127e-02 1 1  ON 32
eH1_3                -4.454353e-02 1 1  ON 33
eH1_4                 9.595781e-04 1 1  ON 34
eH1_5                 1.149083e-02 1 1  ON 35
eH1_6                 4.996611e-02 1 1  ON 36
eH1_7                 4.768138e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402953e-02 1 1  ON 39
eH2_0                -2.032735e-01 1 1  ON 40
eH2_1                -1.237761e-01 1 1  ON 41
eH2_2                -8.186244e-02 1 1  ON 42
eH2_3                -4.440435e-02 1 1  ON 43
eH2_4                 1.103328e-03 1 1  ON 44
eH2_5                 1.160595e-02 1 1  ON 45
eH2_6                 5.355525e-02 1 1  ON 46
eH2_7                 6.390036e-02 1 1  ON 47
eH2_8                 2.111421e-01 1 1  ON 48
eH2_9                 8.151471e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2835
    reference variance = 0.325187
====================================================
  Execution time = 3.6839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321545389005
                                         uncertainty =       0.003984999786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321545389005
                                         uncertainty =       0.003984999786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400899983
  error estimate for blocks of size 2^( 2) =       0.000410284719
  error estimate for blocks of size 2^( 3) =       0.000418502908
  error estimate for blocks of size 2^( 4) =       0.000424396350
  error estimate for blocks of size 2^( 5) =       0.000428090645
  error estimate for blocks of size 2^( 6) =       0.000430725907
  error estimate for blocks of size 2^( 7) =       0.000430451823

      target function =                  N/A
              le_mean =     -17.217089398397
             les_mean =     296.749608784980
             stat err =       0.000428416181
             autocorr =       1.141983043321
              std dev =       0.566958193613
             le_variance =       0.321441593305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708939840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089398397       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089398004       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089402597       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089403795       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089408159       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089409774       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.552104e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089398397       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089398299       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089399449       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089399751       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089400846       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089401252       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 3.890502e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089398397       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089398372       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089398660       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089398736       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089399010       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089399112       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 9.732689e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6281e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.073054e-01 1 1  ON 0
 uu_1                 4.376433e-02 1 1  ON 1
 uu_2                -5.302263e-02 1 1  ON 2
 uu_3                -1.106160e-01 1 1  ON 3
 uu_4                -1.474312e-01 1 1  ON 4
 uu_5                -1.594646e-01 1 1  ON 5
 uu_6                -1.461079e-01 1 1  ON 6
 uu_7                -9.607310e-02 1 1  ON 7
 uu_8                -1.484639e-03 1 1  ON 8
 uu_9                 2.066315e-01 1 1  ON 9
 ud_0                 3.604556e-01 1 1  ON 10
 ud_1                 1.008663e-01 1 1  ON 11
 ud_2                -1.074280e-02 1 1  ON 12
 ud_3                -7.379881e-02 1 1  ON 13
 ud_4                -1.238995e-01 1 1  ON 14
 ud_5                -1.594364e-01 1 1  ON 15
 ud_6                -1.699456e-01 1 1  ON 16
 ud_7                -1.426015e-01 1 1  ON 17
 ud_8                -7.200762e-02 1 1  ON 18
 ud_9                 7.861928e-02 1 1  ON 19
 eO_0                -8.963520e-01 1 1  ON 20
 eO_1                -5.701853e-01 1 1  ON 21
 eO_2                -1.500080e-01 1 1  ON 22
 eO_3                 1.246535e-01 1 1  ON 23
 eO_4                 2.499986e-01 1 1  ON 24
 eO_5                 3.252752e-01 1 1  ON 25
 eO_6                 3.531411e-01 1 1  ON 26
 eO_7                 4.011561e-01 1 1  ON 27
 eO_8                 1.014391e-01 1 1  ON 28
 eO_9                 3.821838e-02 1 1  ON 29
eH1_0                -2.030585e-01 1 1  ON 30
eH1_1                -1.239607e-01 1 1  ON 31
eH1_2                -8.195123e-02 1 1  ON 32
eH1_3                -4.454332e-02 1 1  ON 33
eH1_4                 9.595145e-04 1 1  ON 34
eH1_5                 1.149080e-02 1 1  ON 35
eH1_6                 4.996601e-02 1 1  ON 36
eH1_7                 4.768140e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.402955e-02 1 1  ON 39
eH2_0                -2.032735e-01 1 1  ON 40
eH2_1                -1.237761e-01 1 1  ON 41
eH2_2                -8.186249e-02 1 1  ON 42
eH2_3                -4.440469e-02 1 1  ON 43
eH2_4                 1.103484e-03 1 1  ON 44
eH2_5                 1.160628e-02 1 1  ON 45
eH2_6                 5.355511e-02 1 1  ON 46
eH2_7                 6.390039e-02 1 1  ON 47
eH2_8                 2.111421e-01 1 1  ON 48
eH2_9                 8.151475e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.250116
====================================================
  Execution time = 3.3333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4678e-01
  Total weights = 2.0000e+06
  Execution time = 3.1094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859386372
                                         uncertainty =       0.018188429629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859386372
                                         uncertainty =       0.018188429629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416400201
  error estimate for blocks of size 2^( 2) =       0.000425750256
  error estimate for blocks of size 2^( 3) =       0.000433748154
  error estimate for blocks of size 2^( 4) =       0.000438817493
  error estimate for blocks of size 2^( 5) =       0.000443138638
  error estimate for blocks of size 2^( 6) =       0.000444796651
  error estimate for blocks of size 2^( 7) =       0.000448557716

      target function =                  N/A
              le_mean =     -17.217381049042
             les_mean =     296.784988270083
             stat err =       0.000443827625
             autocorr =       1.136074463365
              std dev =       0.588878812294
             le_variance =       0.346778255569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859982101
                                         uncertainty =       0.018188426020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859982101
                                         uncertainty =       0.018188426020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416400559
  error estimate for blocks of size 2^( 2) =       0.000425750602
  error estimate for blocks of size 2^( 3) =       0.000433748484
  error estimate for blocks of size 2^( 4) =       0.000438817813
  error estimate for blocks of size 2^( 5) =       0.000443138969
  error estimate for blocks of size 2^( 6) =       0.000444796953
  error estimate for blocks of size 2^( 7) =       0.000448558042

      target function =                  N/A
              le_mean =     -17.217381050744
             les_mean =     296.784988924141
             stat err =       0.000443827944
             autocorr =       1.136074148478
              std dev =       0.588879317863
             le_variance =       0.346778851007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859684883
                                         uncertainty =       0.018188427807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859684883
                                         uncertainty =       0.018188427807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416400381
  error estimate for blocks of size 2^( 2) =       0.000425750429
  error estimate for blocks of size 2^( 3) =       0.000433748319
  error estimate for blocks of size 2^( 4) =       0.000438817653
  error estimate for blocks of size 2^( 5) =       0.000443138804
  error estimate for blocks of size 2^( 6) =       0.000444796802
  error estimate for blocks of size 2^( 7) =       0.000448557880

      target function =                  N/A
              le_mean =     -17.217381049895
             les_mean =     296.784988597834
             stat err =       0.000443827785
             autocorr =       1.136074305877
              std dev =       0.588879065627
             le_variance =       0.346778553933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859423705
                                         uncertainty =       0.018188429401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346859423705
                                         uncertainty =       0.018188429401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416400224
  error estimate for blocks of size 2^( 2) =       0.000425750277
  error estimate for blocks of size 2^( 3) =       0.000433748174
  error estimate for blocks of size 2^( 4) =       0.000438817513
  error estimate for blocks of size 2^( 5) =       0.000443138659
  error estimate for blocks of size 2^( 6) =       0.000444796670
  error estimate for blocks of size 2^( 7) =       0.000448557737

      target function =                  N/A
              le_mean =     -17.217381049148
             les_mean =     296.784988311067
             stat err =       0.000443827645
             autocorr =       1.136074443672
              std dev =       0.588878843976
             le_variance =       0.346778292883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217381049042        initial
     6.2500e+01     6.2500e+02             1.5521e-06       -17.217381050744  <--
     2.5000e+02     2.5000e+03             3.8905e-07       -17.217381049895
     1.0000e+03     1.0000e+04             9.7327e-08       -17.217381049148

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.8977e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.073051e-01 1 1  ON 0
 uu_1                 4.376462e-02 1 1  ON 1
 uu_2                -5.302235e-02 1 1  ON 2
 uu_3                -1.106160e-01 1 1  ON 3
 uu_4                -1.474312e-01 1 1  ON 4
 uu_5                -1.594644e-01 1 1  ON 5
 uu_6                -1.461088e-01 1 1  ON 6
 uu_7                -9.607289e-02 1 1  ON 7
 uu_8                -1.484644e-03 1 1  ON 8
 uu_9                 2.066313e-01 1 1  ON 9
 ud_0                 3.604566e-01 1 1  ON 10
 ud_1                 1.008665e-01 1 1  ON 11
 ud_2                -1.074244e-02 1 1  ON 12
 ud_3                -7.379921e-02 1 1  ON 13
 ud_4                -1.238989e-01 1 1  ON 14
 ud_5                -1.594370e-01 1 1  ON 15
 ud_6                -1.699455e-01 1 1  ON 16
 ud_7                -1.426019e-01 1 1  ON 17
 ud_8                -7.200822e-02 1 1  ON 18
 ud_9                 7.861881e-02 1 1  ON 19
 eO_0                -8.963527e-01 1 1  ON 20
 eO_1                -5.701865e-01 1 1  ON 21
 eO_2                -1.500076e-01 1 1  ON 22
 eO_3                 1.246546e-01 1 1  ON 23
 eO_4                 2.499987e-01 1 1  ON 24
 eO_5                 3.252754e-01 1 1  ON 25
 eO_6                 3.531406e-01 1 1  ON 26
 eO_7                 4.011563e-01 1 1  ON 27
 eO_8                 1.014394e-01 1 1  ON 28
 eO_9                 3.821843e-02 1 1  ON 29
eH1_0                -2.030583e-01 1 1  ON 30
eH1_1                -1.239612e-01 1 1  ON 31
eH1_2                -8.195109e-02 1 1  ON 32
eH1_3                -4.454268e-02 1 1  ON 33
eH1_4                 9.593243e-04 1 1  ON 34
eH1_5                 1.149070e-02 1 1  ON 35
eH1_6                 4.996568e-02 1 1  ON 36
eH1_7                 4.768148e-02 1 1  ON 37
eH1_8                 2.187686e-01 1 1  ON 38
eH1_9                 8.402964e-02 1 1  ON 39
eH2_0                -2.032735e-01 1 1  ON 40
eH2_1                -1.237763e-01 1 1  ON 41
eH2_2                -8.186265e-02 1 1  ON 42
eH2_3                -4.440569e-02 1 1  ON 43
eH2_4                 1.103952e-03 1 1  ON 44
eH2_5                 1.160729e-02 1 1  ON 45
eH2_6                 5.355471e-02 1 1  ON 46
eH2_7                 6.390049e-02 1 1  ON 47
eH2_8                 2.111421e-01 1 1  ON 48
eH2_9                 8.151486e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5278e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.198764
====================================================
  Execution time = 3.3778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.7503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316484460686
                                         uncertainty =       0.002440686266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316484460686
                                         uncertainty =       0.002440686266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397732868
  error estimate for blocks of size 2^( 2) =       0.000407491166
  error estimate for blocks of size 2^( 3) =       0.000416110579
  error estimate for blocks of size 2^( 4) =       0.000422010201
  error estimate for blocks of size 2^( 5) =       0.000425881308
  error estimate for blocks of size 2^( 6) =       0.000428130373
  error estimate for blocks of size 2^( 7) =       0.000428654723

      target function =                  N/A
              le_mean =     -17.216413048787
             les_mean =     296.721260976412
             stat err =       0.000426169151
             autocorr =       1.148103538897
              std dev =       0.562479215771
             le_variance =       0.316382868174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641304879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413048787       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413051268       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413045581       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413025033       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216413036286       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216413027585       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216413038757       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 9.313542e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413048787       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413049415       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413048000       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413042803       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216413045579       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216413043273       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216413046028       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.378748e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413048787       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413048944       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413048591       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413047288       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216413047979       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216413047394       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216413048081       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 5.979408e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3536e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.073041e-01 1 1  ON 0
 uu_1                 4.376400e-02 1 1  ON 1
 uu_2                -5.302166e-02 1 1  ON 2
 uu_3                -1.106158e-01 1 1  ON 3
 uu_4                -1.474308e-01 1 1  ON 4
 uu_5                -1.594647e-01 1 1  ON 5
 uu_6                -1.461084e-01 1 1  ON 6
 uu_7                -9.607290e-02 1 1  ON 7
 uu_8                -1.484667e-03 1 1  ON 8
 uu_9                 2.066311e-01 1 1  ON 9
 ud_0                 3.604563e-01 1 1  ON 10
 ud_1                 1.008689e-01 1 1  ON 11
 ud_2                -1.074271e-02 1 1  ON 12
 ud_3                -7.379959e-02 1 1  ON 13
 ud_4                -1.238994e-01 1 1  ON 14
 ud_5                -1.594364e-01 1 1  ON 15
 ud_6                -1.699464e-01 1 1  ON 16
 ud_7                -1.426022e-01 1 1  ON 17
 ud_8                -7.200874e-02 1 1  ON 18
 ud_9                 7.861854e-02 1 1  ON 19
 eO_0                -8.963538e-01 1 1  ON 20
 eO_1                -5.701886e-01 1 1  ON 21
 eO_2                -1.500066e-01 1 1  ON 22
 eO_3                 1.246535e-01 1 1  ON 23
 eO_4                 2.500007e-01 1 1  ON 24
 eO_5                 3.252765e-01 1 1  ON 25
 eO_6                 3.531399e-01 1 1  ON 26
 eO_7                 4.011565e-01 1 1  ON 27
 eO_8                 1.014398e-01 1 1  ON 28
 eO_9                 3.821854e-02 1 1  ON 29
eH1_0                -2.030577e-01 1 1  ON 30
eH1_1                -1.239621e-01 1 1  ON 31
eH1_2                -8.195268e-02 1 1  ON 32
eH1_3                -4.454365e-02 1 1  ON 33
eH1_4                 9.613030e-04 1 1  ON 34
eH1_5                 1.149078e-02 1 1  ON 35
eH1_6                 4.996561e-02 1 1  ON 36
eH1_7                 4.768199e-02 1 1  ON 37
eH1_8                 2.187686e-01 1 1  ON 38
eH1_9                 8.402986e-02 1 1  ON 39
eH2_0                -2.032736e-01 1 1  ON 40
eH2_1                -1.237773e-01 1 1  ON 41
eH2_2                -8.186408e-02 1 1  ON 42
eH2_3                -4.440426e-02 1 1  ON 43
eH2_4                 1.103451e-03 1 1  ON 44
eH2_5                 1.160816e-02 1 1  ON 45
eH2_6                 5.355515e-02 1 1  ON 46
eH2_7                 6.390060e-02 1 1  ON 47
eH2_8                 2.111419e-01 1 1  ON 48
eH2_9                 8.151499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.1562
====================================================
  Execution time = 3.4143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1508e-01
  Total weights = 2.0000e+06
  Execution time = 3.0786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315179056347
                                         uncertainty =       0.003246547359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315179056347
                                         uncertainty =       0.003246547359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396916886
  error estimate for blocks of size 2^( 2) =       0.000406629546
  error estimate for blocks of size 2^( 3) =       0.000415271600
  error estimate for blocks of size 2^( 4) =       0.000420948745
  error estimate for blocks of size 2^( 5) =       0.000425248953
  error estimate for blocks of size 2^( 6) =       0.000426465102
  error estimate for blocks of size 2^( 7) =       0.000426190096

      target function =                  N/A
              le_mean =     -17.217342447327
             les_mean =     296.751966819136
             stat err =       0.000424713224
             autocorr =       1.144965542228
              std dev =       0.561325242758
             le_variance =       0.315086028158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315175126493
                                         uncertainty =       0.003246452979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315175126493
                                         uncertainty =       0.003246452979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396914411
  error estimate for blocks of size 2^( 2) =       0.000406627132
  error estimate for blocks of size 2^( 3) =       0.000415269045
  error estimate for blocks of size 2^( 4) =       0.000420946194
  error estimate for blocks of size 2^( 5) =       0.000425246340
  error estimate for blocks of size 2^( 6) =       0.000426462627
  error estimate for blocks of size 2^( 7) =       0.000426187578

      target function =                  N/A
              le_mean =     -17.217342501200
             les_mean =     296.751964745257
             stat err =       0.000424710685
             autocorr =       1.144966130817
              std dev =       0.561321743010
             le_variance =       0.315082099176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315177009927
                                         uncertainty =       0.003246498653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315177009927
                                         uncertainty =       0.003246498653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396915597
  error estimate for blocks of size 2^( 2) =       0.000406628289
  error estimate for blocks of size 2^( 3) =       0.000415270272
  error estimate for blocks of size 2^( 4) =       0.000420947420
  error estimate for blocks of size 2^( 5) =       0.000425247596
  error estimate for blocks of size 2^( 6) =       0.000426463816
  error estimate for blocks of size 2^( 7) =       0.000426188787

      target function =                  N/A
              le_mean =     -17.217342474783
             les_mean =     296.751965718627
             stat err =       0.000424711905
             autocorr =       1.144965863210
              std dev =       0.561323420318
             le_variance =       0.315083982197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315178797823
                                         uncertainty =       0.003246541221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315178797823
                                         uncertainty =       0.003246541221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396916723
  error estimate for blocks of size 2^( 2) =       0.000406629387
  error estimate for blocks of size 2^( 3) =       0.000415271432
  error estimate for blocks of size 2^( 4) =       0.000420948577
  error estimate for blocks of size 2^( 5) =       0.000425248782
  error estimate for blocks of size 2^( 6) =       0.000426464939
  error estimate for blocks of size 2^( 7) =       0.000426189931

      target function =                  N/A
              le_mean =     -17.217342450765
             les_mean =     296.751966679051
             stat err =       0.000424713057
             autocorr =       1.144965583171
              std dev =       0.561325012529
             le_variance =       0.315085769691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217342447327        initial
     1.5625e+01     1.5625e+02             9.3135e-06       -17.217342501200  <--
     6.2500e+01     6.2500e+02             2.3787e-06       -17.217342474783
     2.5000e+02     2.5000e+03             5.9794e-07       -17.217342450765

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.9664e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.073009e-01 1 1  ON 0
 uu_1                 4.376226e-02 1 1  ON 1
 uu_2                -5.301967e-02 1 1  ON 2
 uu_3                -1.106154e-01 1 1  ON 3
 uu_4                -1.474296e-01 1 1  ON 4
 uu_5                -1.594658e-01 1 1  ON 5
 uu_6                -1.461074e-01 1 1  ON 6
 uu_7                -9.607294e-02 1 1  ON 7
 uu_8                -1.484737e-03 1 1  ON 8
 uu_9                 2.066307e-01 1 1  ON 9
 ud_0                 3.604556e-01 1 1  ON 10
 ud_1                 1.008758e-01 1 1  ON 11
 ud_2                -1.074344e-02 1 1  ON 12
 ud_3                -7.380077e-02 1 1  ON 13
 ud_4                -1.239011e-01 1 1  ON 14
 ud_5                -1.594346e-01 1 1  ON 15
 ud_6                -1.699492e-01 1 1  ON 16
 ud_7                -1.426030e-01 1 1  ON 17
 ud_8                -7.201029e-02 1 1  ON 18
 ud_9                 7.861775e-02 1 1  ON 19
 eO_0                -8.963571e-01 1 1  ON 20
 eO_1                -5.701949e-01 1 1  ON 21
 eO_2                -1.500034e-01 1 1  ON 22
 eO_3                 1.246504e-01 1 1  ON 23
 eO_4                 2.500066e-01 1 1  ON 24
 eO_5                 3.252798e-01 1 1  ON 25
 eO_6                 3.531377e-01 1 1  ON 26
 eO_7                 4.011573e-01 1 1  ON 27
 eO_8                 1.014410e-01 1 1  ON 28
 eO_9                 3.821887e-02 1 1  ON 29
eH1_0                -2.030560e-01 1 1  ON 30
eH1_1                -1.239647e-01 1 1  ON 31
eH1_2                -8.195738e-02 1 1  ON 32
eH1_3                -4.454653e-02 1 1  ON 33
eH1_4                 9.671966e-04 1 1  ON 34
eH1_5                 1.149104e-02 1 1  ON 35
eH1_6                 4.996541e-02 1 1  ON 36
eH1_7                 4.768351e-02 1 1  ON 37
eH1_8                 2.187687e-01 1 1  ON 38
eH1_9                 8.403049e-02 1 1  ON 39
eH2_0                -2.032739e-01 1 1  ON 40
eH2_1                -1.237801e-01 1 1  ON 41
eH2_2                -8.186831e-02 1 1  ON 42
eH2_3                -4.440006e-02 1 1  ON 43
eH2_4                 1.101990e-03 1 1  ON 44
eH2_5                 1.161073e-02 1 1  ON 45
eH2_6                 5.355647e-02 1 1  ON 46
eH2_7                 6.390090e-02 1 1  ON 47
eH2_8                 2.111414e-01 1 1  ON 48
eH2_9                 8.151537e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1722
    reference variance = 0.484923
====================================================
  Execution time = 3.3752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315114564249
                                         uncertainty =       0.002615752418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315114564249
                                         uncertainty =       0.002615752418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397067859
  error estimate for blocks of size 2^( 2) =       0.000406200482
  error estimate for blocks of size 2^( 3) =       0.000415043909
  error estimate for blocks of size 2^( 4) =       0.000420958742
  error estimate for blocks of size 2^( 5) =       0.000424401070
  error estimate for blocks of size 2^( 6) =       0.000425851616
  error estimate for blocks of size 2^( 7) =       0.000427896324

      target function =                  N/A
              le_mean =     -17.216787244890
             les_mean =     296.733088647585
             stat err =       0.000424776938
             autocorr =       1.144438320782
              std dev =       0.561538751512
             le_variance =       0.315325769450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678724489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787244890       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787256137       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787218252       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787256197       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787287938       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787324508       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216787300529       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 2.595379e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787244890       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787247799       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787237572       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787247073       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787255424       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787265139       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 6.290756e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216787244890       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787245623       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787243016       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787245391       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216787247501       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787249968       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.592350e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3269e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.072980e-01 1 1  ON 0
 uu_1                 4.375892e-02 1 1  ON 1
 uu_2                -5.302070e-02 1 1  ON 2
 uu_3                -1.106139e-01 1 1  ON 3
 uu_4                -1.474287e-01 1 1  ON 4
 uu_5                -1.594648e-01 1 1  ON 5
 uu_6                -1.461044e-01 1 1  ON 6
 uu_7                -9.607315e-02 1 1  ON 7
 uu_8                -1.485285e-03 1 1  ON 8
 uu_9                 2.066302e-01 1 1  ON 9
 ud_0                 3.604603e-01 1 1  ON 10
 ud_1                 1.008756e-01 1 1  ON 11
 ud_2                -1.074391e-02 1 1  ON 12
 ud_3                -7.380365e-02 1 1  ON 13
 ud_4                -1.239052e-01 1 1  ON 14
 ud_5                -1.594370e-01 1 1  ON 15
 ud_6                -1.699464e-01 1 1  ON 16
 ud_7                -1.426000e-01 1 1  ON 17
 ud_8                -7.201143e-02 1 1  ON 18
 ud_9                 7.861651e-02 1 1  ON 19
 eO_0                -8.963591e-01 1 1  ON 20
 eO_1                -5.701979e-01 1 1  ON 21
 eO_2                -1.500037e-01 1 1  ON 22
 eO_3                 1.246495e-01 1 1  ON 23
 eO_4                 2.500064e-01 1 1  ON 24
 eO_5                 3.252832e-01 1 1  ON 25
 eO_6                 3.531379e-01 1 1  ON 26
 eO_7                 4.011586e-01 1 1  ON 27
 eO_8                 1.014422e-01 1 1  ON 28
 eO_9                 3.821911e-02 1 1  ON 29
eH1_0                -2.030562e-01 1 1  ON 30
eH1_1                -1.239684e-01 1 1  ON 31
eH1_2                -8.195766e-02 1 1  ON 32
eH1_3                -4.454838e-02 1 1  ON 33
eH1_4                 9.703759e-04 1 1  ON 34
eH1_5                 1.149104e-02 1 1  ON 35
eH1_6                 4.996727e-02 1 1  ON 36
eH1_7                 4.768427e-02 1 1  ON 37
eH1_8                 2.187681e-01 1 1  ON 38
eH1_9                 8.403092e-02 1 1  ON 39
eH2_0                -2.032677e-01 1 1  ON 40
eH2_1                -1.237827e-01 1 1  ON 41
eH2_2                -8.187460e-02 1 1  ON 42
eH2_3                -4.439826e-02 1 1  ON 43
eH2_4                 1.102471e-03 1 1  ON 44
eH2_5                 1.160912e-02 1 1  ON 45
eH2_6                 5.355540e-02 1 1  ON 46
eH2_7                 6.390267e-02 1 1  ON 47
eH2_8                 2.111419e-01 1 1  ON 48
eH2_9                 8.151589e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.275177
====================================================
  Execution time = 3.3511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1464e-01
  Total weights = 2.0000e+06
  Execution time = 3.0963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314598471508
                                         uncertainty =       0.002770630124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314598471508
                                         uncertainty =       0.002770630124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396633548
  error estimate for blocks of size 2^( 2) =       0.000406412571
  error estimate for blocks of size 2^( 3) =       0.000414783268
  error estimate for blocks of size 2^( 4) =       0.000420879264
  error estimate for blocks of size 2^( 5) =       0.000423985288
  error estimate for blocks of size 2^( 6) =       0.000426949231
  error estimate for blocks of size 2^( 7) =       0.000430071339

      target function =                  N/A
              le_mean =     -17.216992331130
             les_mean =     296.739461114914
             stat err =       0.000425471280
             autocorr =       1.150698672005
              std dev =       0.560924542204
             le_variance =       0.314636342046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314610732464
                                         uncertainty =       0.002770735533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314610732464
                                         uncertainty =       0.002770735533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396641278
  error estimate for blocks of size 2^( 2) =       0.000406419985
  error estimate for blocks of size 2^( 3) =       0.000414790170
  error estimate for blocks of size 2^( 4) =       0.000420885726
  error estimate for blocks of size 2^( 5) =       0.000423991683
  error estimate for blocks of size 2^( 6) =       0.000426956160
  error estimate for blocks of size 2^( 7) =       0.000430077834

      target function =                  N/A
              le_mean =     -17.216992462919
             les_mean =     296.739477918316
             stat err =       0.000425477851
             autocorr =       1.150689355226
              std dev =       0.560935475282
             le_variance =       0.314648607429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314605847018
                                         uncertainty =       0.002770690120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314605847018
                                         uncertainty =       0.002770690120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396638198
  error estimate for blocks of size 2^( 2) =       0.000406417016
  error estimate for blocks of size 2^( 3) =       0.000414787402
  error estimate for blocks of size 2^( 4) =       0.000420883146
  error estimate for blocks of size 2^( 5) =       0.000423989112
  error estimate for blocks of size 2^( 6) =       0.000426953314
  error estimate for blocks of size 2^( 7) =       0.000430075178

      target function =                  N/A
              le_mean =     -17.216992385254
             les_mean =     296.739470356853
             stat err =       0.000425475188
             autocorr =       1.150692822868
              std dev =       0.560931119030
             le_variance =       0.314643720296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314599405798
                                         uncertainty =       0.002770637733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314599405798
                                         uncertainty =       0.002770637733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396634137
  error estimate for blocks of size 2^( 2) =       0.000406413134
  error estimate for blocks of size 2^( 3) =       0.000414783792
  error estimate for blocks of size 2^( 4) =       0.000420879756
  error estimate for blocks of size 2^( 5) =       0.000423985773
  error estimate for blocks of size 2^( 6) =       0.000426949748
  error estimate for blocks of size 2^( 7) =       0.000430071826

      target function =                  N/A
              le_mean =     -17.216992337935
             les_mean =     296.739462283878
             stat err =       0.000425471776
             autocorr =       1.150697932685
              std dev =       0.560925375321
             le_variance =       0.314637276679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216992331130        initial
     3.9062e+00     3.9062e+01             2.5954e-05       -17.216992462919  <--
     1.5625e+01     1.5625e+02             6.2908e-06       -17.216992385254
     6.2500e+01     6.2500e+02             1.5923e-06       -17.216992337935

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.9072e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.072881e-01 1 1  ON 0
 uu_1                 4.375013e-02 1 1  ON 1
 uu_2                -5.302408e-02 1 1  ON 2
 uu_3                -1.106102e-01 1 1  ON 3
 uu_4                -1.474248e-01 1 1  ON 4
 uu_5                -1.594622e-01 1 1  ON 5
 uu_6                -1.460948e-01 1 1  ON 6
 uu_7                -9.607442e-02 1 1  ON 7
 uu_8                -1.487388e-03 1 1  ON 8
 uu_9                 2.066285e-01 1 1  ON 9
 ud_0                 3.604731e-01 1 1  ON 10
 ud_1                 1.008739e-01 1 1  ON 11
 ud_2                -1.074240e-02 1 1  ON 12
 ud_3                -7.381368e-02 1 1  ON 13
 ud_4                -1.239153e-01 1 1  ON 14
 ud_5                -1.594452e-01 1 1  ON 15
 ud_6                -1.699383e-01 1 1  ON 16
 ud_7                -1.425901e-01 1 1  ON 17
 ud_8                -7.201581e-02 1 1  ON 18
 ud_9                 7.861195e-02 1 1  ON 19
 eO_0                -8.963667e-01 1 1  ON 20
 eO_1                -5.702078e-01 1 1  ON 21
 eO_2                -1.500060e-01 1 1  ON 22
 eO_3                 1.246473e-01 1 1  ON 23
 eO_4                 2.500063e-01 1 1  ON 24
 eO_5                 3.252948e-01 1 1  ON 25
 eO_6                 3.531381e-01 1 1  ON 26
 eO_7                 4.011629e-01 1 1  ON 27
 eO_8                 1.014465e-01 1 1  ON 28
 eO_9                 3.822001e-02 1 1  ON 29
eH1_0                -2.030569e-01 1 1  ON 30
eH1_1                -1.239792e-01 1 1  ON 31
eH1_2                -8.195830e-02 1 1  ON 32
eH1_3                -4.455489e-02 1 1  ON 33
eH1_4                 9.797791e-04 1 1  ON 34
eH1_5                 1.149053e-02 1 1  ON 35
eH1_6                 4.997366e-02 1 1  ON 36
eH1_7                 4.768682e-02 1 1  ON 37
eH1_8                 2.187662e-01 1 1  ON 38
eH1_9                 8.403248e-02 1 1  ON 39
eH2_0                -2.032480e-01 1 1  ON 40
eH2_1                -1.237924e-01 1 1  ON 41
eH2_2                -8.189095e-02 1 1  ON 42
eH2_3                -4.439478e-02 1 1  ON 43
eH2_4                 1.103696e-03 1 1  ON 44
eH2_5                 1.160379e-02 1 1  ON 45
eH2_6                 5.355123e-02 1 1  ON 46
eH2_7                 6.390893e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.151779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2548e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.3413
    reference variance = 0.534365
====================================================
  Execution time = 3.4147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1934e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317121224508
                                         uncertainty =       0.004365981007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317121224508
                                         uncertainty =       0.004365981007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399587240
  error estimate for blocks of size 2^( 2) =       0.000409002280
  error estimate for blocks of size 2^( 3) =       0.000417347196
  error estimate for blocks of size 2^( 4) =       0.000424463375
  error estimate for blocks of size 2^( 5) =       0.000428600327
  error estimate for blocks of size 2^( 6) =       0.000429785364
  error estimate for blocks of size 2^( 7) =       0.000432289435

      target function =                  N/A
              le_mean =     -17.216283634660
             les_mean =     296.719761954306
             stat err =       0.000428784625
             autocorr =       1.151476782780
              std dev =       0.565101694313
             le_variance =       0.319339924916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628363466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216283634660       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283861917       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216283527404       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216283776350       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216283924423       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216284042269       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216284053068       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 9.027583e-05

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216283634660       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283698343       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216283598573       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216283670965       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216283710637       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216283739290       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 2.557675e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216283634660       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216283651077       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216283624862       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216283643714       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216283653801       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216283660721       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 6.554043e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7281e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.072703e-01 1 1  ON 0
 uu_1                 4.375699e-02 1 1  ON 1
 uu_2                -5.301937e-02 1 1  ON 2
 uu_3                -1.106091e-01 1 1  ON 3
 uu_4                -1.474318e-01 1 1  ON 4
 uu_5                -1.594858e-01 1 1  ON 5
 uu_6                -1.460924e-01 1 1  ON 6
 uu_7                -9.605190e-02 1 1  ON 7
 uu_8                -1.482907e-03 1 1  ON 8
 uu_9                 2.066253e-01 1 1  ON 9
 ud_0                 3.604718e-01 1 1  ON 10
 ud_1                 1.008868e-01 1 1  ON 11
 ud_2                -1.074812e-02 1 1  ON 12
 ud_3                -7.383448e-02 1 1  ON 13
 ud_4                -1.239088e-01 1 1  ON 14
 ud_5                -1.594582e-01 1 1  ON 15
 ud_6                -1.699185e-01 1 1  ON 16
 ud_7                -1.425807e-01 1 1  ON 17
 ud_8                -7.202254e-02 1 1  ON 18
 ud_9                 7.860508e-02 1 1  ON 19
 eO_0                -8.963724e-01 1 1  ON 20
 eO_1                -5.702266e-01 1 1  ON 21
 eO_2                -1.499917e-01 1 1  ON 22
 eO_3                 1.246499e-01 1 1  ON 23
 eO_4                 2.499987e-01 1 1  ON 24
 eO_5                 3.252955e-01 1 1  ON 25
 eO_6                 3.531366e-01 1 1  ON 26
 eO_7                 4.011724e-01 1 1  ON 27
 eO_8                 1.014512e-01 1 1  ON 28
 eO_9                 3.822105e-02 1 1  ON 29
eH1_0                -2.030578e-01 1 1  ON 30
eH1_1                -1.239889e-01 1 1  ON 31
eH1_2                -8.197027e-02 1 1  ON 32
eH1_3                -4.456283e-02 1 1  ON 33
eH1_4                 1.005356e-03 1 1  ON 34
eH1_5                 1.147767e-02 1 1  ON 35
eH1_6                 4.997721e-02 1 1  ON 36
eH1_7                 4.769836e-02 1 1  ON 37
eH1_8                 2.187651e-01 1 1  ON 38
eH1_9                 8.403444e-02 1 1  ON 39
eH2_0                -2.032428e-01 1 1  ON 40
eH2_1                -1.238075e-01 1 1  ON 41
eH2_2                -8.189566e-02 1 1  ON 42
eH2_3                -4.438728e-02 1 1  ON 43
eH2_4                 1.098544e-03 1 1  ON 44
eH2_5                 1.160164e-02 1 1  ON 45
eH2_6                 5.355178e-02 1 1  ON 46
eH2_7                 6.391484e-02 1 1  ON 47
eH2_8                 2.111464e-01 1 1  ON 48
eH2_9                 8.152134e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2093
    reference variance = 0.170329
====================================================
  Execution time = 3.4326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2925e-01
  Total weights = 2.0000e+06
  Execution time = 3.0895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329283244816
                                         uncertainty =       0.008174762227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329283244816
                                         uncertainty =       0.008174762227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405742805
  error estimate for blocks of size 2^( 2) =       0.000415547312
  error estimate for blocks of size 2^( 3) =       0.000424130518
  error estimate for blocks of size 2^( 4) =       0.000430867469
  error estimate for blocks of size 2^( 5) =       0.000434677303
  error estimate for blocks of size 2^( 6) =       0.000434857965
  error estimate for blocks of size 2^( 7) =       0.000436055789

      target function =                  N/A
              le_mean =     -17.216415463324
             les_mean =     296.734215688108
             stat err =       0.000434114631
             autocorr =       1.144740882977
              std dev =       0.573806977074
             le_variance =       0.329254446939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329278976365
                                         uncertainty =       0.008176372126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329278976365
                                         uncertainty =       0.008176372126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405740160
  error estimate for blocks of size 2^( 2) =       0.000415544640
  error estimate for blocks of size 2^( 3) =       0.000424126278
  error estimate for blocks of size 2^( 4) =       0.000430862497
  error estimate for blocks of size 2^( 5) =       0.000434671642
  error estimate for blocks of size 2^( 6) =       0.000434852099
  error estimate for blocks of size 2^( 7) =       0.000436050343

      target function =                  N/A
              le_mean =     -17.216414841561
             les_mean =     296.734189987585
             stat err =       0.000434109145
             autocorr =       1.144726869874
              std dev =       0.573803237599
             le_variance =       0.329250155479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329278036203
                                         uncertainty =       0.008175498474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329278036203
                                         uncertainty =       0.008175498474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405739585
  error estimate for blocks of size 2^( 2) =       0.000415544098
  error estimate for blocks of size 2^( 3) =       0.000424126366
  error estimate for blocks of size 2^( 4) =       0.000430862905
  error estimate for blocks of size 2^( 5) =       0.000434672337
  error estimate for blocks of size 2^( 6) =       0.000434853100
  error estimate for blocks of size 2^( 7) =       0.000436051135

      target function =                  N/A
              le_mean =     -17.216415011192
             les_mean =     296.734194894861
             stat err =       0.000434109869
             autocorr =       1.144733934751
              std dev =       0.573802424097
             le_variance =       0.329249221900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329282240356
                                         uncertainty =       0.008174847207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329282240356
                                         uncertainty =       0.008174847207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405742184
  error estimate for blocks of size 2^( 2) =       0.000415546701
  error estimate for blocks of size 2^( 3) =       0.000424129789
  error estimate for blocks of size 2^( 4) =       0.000430866689
  error estimate for blocks of size 2^( 5) =       0.000434676474
  error estimate for blocks of size 2^( 6) =       0.000434857149
  error estimate for blocks of size 2^( 7) =       0.000436054997

      target function =                  N/A
              le_mean =     -17.216415400649
             les_mean =     296.734212523345
             stat err =       0.000434113827
             autocorr =       1.144740142944
              std dev =       0.573806099884
             le_variance =       0.329253440265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216415463324        initial  <--
     9.7656e-01     9.7656e+00             9.0276e-05       -17.216414841561
     3.9062e+00     3.9062e+01             2.5577e-05       -17.216415011192
     1.5625e+01     1.5625e+02             6.5540e-06       -17.216415400649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9122
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.072881e-01 1 1  ON 0
 uu_1                 4.375013e-02 1 1  ON 1
 uu_2                -5.302408e-02 1 1  ON 2
 uu_3                -1.106102e-01 1 1  ON 3
 uu_4                -1.474248e-01 1 1  ON 4
 uu_5                -1.594622e-01 1 1  ON 5
 uu_6                -1.460948e-01 1 1  ON 6
 uu_7                -9.607442e-02 1 1  ON 7
 uu_8                -1.487388e-03 1 1  ON 8
 uu_9                 2.066285e-01 1 1  ON 9
 ud_0                 3.604731e-01 1 1  ON 10
 ud_1                 1.008739e-01 1 1  ON 11
 ud_2                -1.074240e-02 1 1  ON 12
 ud_3                -7.381368e-02 1 1  ON 13
 ud_4                -1.239153e-01 1 1  ON 14
 ud_5                -1.594452e-01 1 1  ON 15
 ud_6                -1.699383e-01 1 1  ON 16
 ud_7                -1.425901e-01 1 1  ON 17
 ud_8                -7.201581e-02 1 1  ON 18
 ud_9                 7.861195e-02 1 1  ON 19
 eO_0                -8.963667e-01 1 1  ON 20
 eO_1                -5.702078e-01 1 1  ON 21
 eO_2                -1.500060e-01 1 1  ON 22
 eO_3                 1.246473e-01 1 1  ON 23
 eO_4                 2.500063e-01 1 1  ON 24
 eO_5                 3.252948e-01 1 1  ON 25
 eO_6                 3.531381e-01 1 1  ON 26
 eO_7                 4.011629e-01 1 1  ON 27
 eO_8                 1.014465e-01 1 1  ON 28
 eO_9                 3.822001e-02 1 1  ON 29
eH1_0                -2.030569e-01 1 1  ON 30
eH1_1                -1.239792e-01 1 1  ON 31
eH1_2                -8.195830e-02 1 1  ON 32
eH1_3                -4.455489e-02 1 1  ON 33
eH1_4                 9.797791e-04 1 1  ON 34
eH1_5                 1.149053e-02 1 1  ON 35
eH1_6                 4.997366e-02 1 1  ON 36
eH1_7                 4.768682e-02 1 1  ON 37
eH1_8                 2.187662e-01 1 1  ON 38
eH1_9                 8.403248e-02 1 1  ON 39
eH2_0                -2.032480e-01 1 1  ON 40
eH2_1                -1.237924e-01 1 1  ON 41
eH2_2                -8.189095e-02 1 1  ON 42
eH2_3                -4.439478e-02 1 1  ON 43
eH2_4                 1.103696e-03 1 1  ON 44
eH2_5                 1.160379e-02 1 1  ON 45
eH2_6                 5.355123e-02 1 1  ON 46
eH2_7                 6.390893e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.151779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7223e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.21893
====================================================
  Execution time = 3.4728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315480308244
                                         uncertainty =       0.002693387588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315480308244
                                         uncertainty =       0.002693387588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397213293
  error estimate for blocks of size 2^( 2) =       0.000406727323
  error estimate for blocks of size 2^( 3) =       0.000415392871
  error estimate for blocks of size 2^( 4) =       0.000422277515
  error estimate for blocks of size 2^( 5) =       0.000425733675
  error estimate for blocks of size 2^( 6) =       0.000427324017
  error estimate for blocks of size 2^( 7) =       0.000428480791

      target function =                  N/A
              le_mean =     -17.216060314420
             les_mean =     296.708289391679
             stat err =       0.000425954000
             autocorr =       1.149947077363
              std dev =       0.561744425613
             le_variance =       0.315556799708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721606031442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060314420       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060318083       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216060298622       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060267535       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060276447       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216060291052       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.511539e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060314420       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060315351       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216060310344       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060302205       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060304227       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216060308284       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.848223e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060314420       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060314654       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216060313393       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060311334       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060311825       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216060312866       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 9.665108e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4143e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.072890e-01 1 1  ON 0
 uu_1                 4.374918e-02 1 1  ON 1
 uu_2                -5.302630e-02 1 1  ON 2
 uu_3                -1.106112e-01 1 1  ON 3
 uu_4                -1.474267e-01 1 1  ON 4
 uu_5                -1.594598e-01 1 1  ON 5
 uu_6                -1.460938e-01 1 1  ON 6
 uu_7                -9.607437e-02 1 1  ON 7
 uu_8                -1.487203e-03 1 1  ON 8
 uu_9                 2.066286e-01 1 1  ON 9
 ud_0                 3.604738e-01 1 1  ON 10
 ud_1                 1.008767e-01 1 1  ON 11
 ud_2                -1.074393e-02 1 1  ON 12
 ud_3                -7.381251e-02 1 1  ON 13
 ud_4                -1.239160e-01 1 1  ON 14
 ud_5                -1.594457e-01 1 1  ON 15
 ud_6                -1.699408e-01 1 1  ON 16
 ud_7                -1.425907e-01 1 1  ON 17
 ud_8                -7.201618e-02 1 1  ON 18
 ud_9                 7.861194e-02 1 1  ON 19
 eO_0                -8.963638e-01 1 1  ON 20
 eO_1                -5.702115e-01 1 1  ON 21
 eO_2                -1.500051e-01 1 1  ON 22
 eO_3                 1.246448e-01 1 1  ON 23
 eO_4                 2.500077e-01 1 1  ON 24
 eO_5                 3.252949e-01 1 1  ON 25
 eO_6                 3.531372e-01 1 1  ON 26
 eO_7                 4.011635e-01 1 1  ON 27
 eO_8                 1.014472e-01 1 1  ON 28
 eO_9                 3.822032e-02 1 1  ON 29
eH1_0                -2.030562e-01 1 1  ON 30
eH1_1                -1.239797e-01 1 1  ON 31
eH1_2                -8.195953e-02 1 1  ON 32
eH1_3                -4.455623e-02 1 1  ON 33
eH1_4                 9.807189e-04 1 1  ON 34
eH1_5                 1.149040e-02 1 1  ON 35
eH1_6                 4.997398e-02 1 1  ON 36
eH1_7                 4.768738e-02 1 1  ON 37
eH1_8                 2.187663e-01 1 1  ON 38
eH1_9                 8.403291e-02 1 1  ON 39
eH2_0                -2.032468e-01 1 1  ON 40
eH2_1                -1.237962e-01 1 1  ON 41
eH2_2                -8.189154e-02 1 1  ON 42
eH2_3                -4.439391e-02 1 1  ON 43
eH2_4                 1.104614e-03 1 1  ON 44
eH2_5                 1.160565e-02 1 1  ON 45
eH2_6                 5.355078e-02 1 1  ON 46
eH2_7                 6.390830e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.151809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.307496
====================================================
  Execution time = 3.3476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1809e-01
  Total weights = 2.0000e+06
  Execution time = 3.0854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318040578670
                                         uncertainty =       0.005019035813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318040578670
                                         uncertainty =       0.005019035813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398803223
  error estimate for blocks of size 2^( 2) =       0.000408651237
  error estimate for blocks of size 2^( 3) =       0.000417179310
  error estimate for blocks of size 2^( 4) =       0.000423126227
  error estimate for blocks of size 2^( 5) =       0.000426496214
  error estimate for blocks of size 2^( 6) =       0.000429295905
  error estimate for blocks of size 2^( 7) =       0.000430246178

      target function =                  N/A
              le_mean =     -17.216898231889
             les_mean =     296.739672588806
             stat err =       0.000427291131
             autocorr =       1.147969737367
              std dev =       0.563992926046
             le_variance =       0.318088020630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044873469
                                         uncertainty =       0.005019052747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044873469
                                         uncertainty =       0.005019052747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398805918
  error estimate for blocks of size 2^( 2) =       0.000408653798
  error estimate for blocks of size 2^( 3) =       0.000417181656
  error estimate for blocks of size 2^( 4) =       0.000423128219
  error estimate for blocks of size 2^( 5) =       0.000426498044
  error estimate for blocks of size 2^( 6) =       0.000429297968
  error estimate for blocks of size 2^( 7) =       0.000430248560

      target function =                  N/A
              le_mean =     -17.216898325255
             les_mean =     296.739680103786
             stat err =       0.000427293198
             autocorr =       1.147965322895
              std dev =       0.563996738175
             le_variance =       0.318092320672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318042764985
                                         uncertainty =       0.005019043646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318042764985
                                         uncertainty =       0.005019043646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398804595
  error estimate for blocks of size 2^( 2) =       0.000408652540
  error estimate for blocks of size 2^( 3) =       0.000417180504
  error estimate for blocks of size 2^( 4) =       0.000423127238
  error estimate for blocks of size 2^( 5) =       0.000426497140
  error estimate for blocks of size 2^( 6) =       0.000429296951
  error estimate for blocks of size 2^( 7) =       0.000430247389

      target function =                  N/A
              le_mean =     -17.216898280083
             les_mean =     296.739676437334
             stat err =       0.000427292179
             autocorr =       1.147967469768
              std dev =       0.563994866694
             le_variance =       0.318090209657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318040852931
                                         uncertainty =       0.005019036770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318040852931
                                         uncertainty =       0.005019036770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398803395
  error estimate for blocks of size 2^( 2) =       0.000408651400
  error estimate for blocks of size 2^( 3) =       0.000417179460
  error estimate for blocks of size 2^( 4) =       0.000423126354
  error estimate for blocks of size 2^( 5) =       0.000426496330
  error estimate for blocks of size 2^( 6) =       0.000429296036
  error estimate for blocks of size 2^( 7) =       0.000430246330

      target function =                  N/A
              le_mean =     -17.216898237932
             les_mean =     296.739673071487
             stat err =       0.000427291262
             autocorr =       1.147969451913
              std dev =       0.563993169491
             le_variance =       0.318088295233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216898231889        initial
     9.7656e+00     9.7656e+01             1.5115e-05       -17.216898325255  <--
     3.9062e+01     3.9062e+02             3.8482e-06       -17.216898280083
     1.5625e+02     1.5625e+03             9.6651e-07       -17.216898237932

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.9023e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.072914e-01 1 1  ON 0
 uu_1                 4.374627e-02 1 1  ON 1
 uu_2                -5.303266e-02 1 1  ON 2
 uu_3                -1.106143e-01 1 1  ON 3
 uu_4                -1.474322e-01 1 1  ON 4
 uu_5                -1.594525e-01 1 1  ON 5
 uu_6                -1.460906e-01 1 1  ON 6
 uu_7                -9.607421e-02 1 1  ON 7
 uu_8                -1.486656e-03 1 1  ON 8
 uu_9                 2.066288e-01 1 1  ON 9
 ud_0                 3.604759e-01 1 1  ON 10
 ud_1                 1.008846e-01 1 1  ON 11
 ud_2                -1.074818e-02 1 1  ON 12
 ud_3                -7.380925e-02 1 1  ON 13
 ud_4                -1.239183e-01 1 1  ON 14
 ud_5                -1.594471e-01 1 1  ON 15
 ud_6                -1.699481e-01 1 1  ON 16
 ud_7                -1.425922e-01 1 1  ON 17
 ud_8                -7.201727e-02 1 1  ON 18
 ud_9                 7.861191e-02 1 1  ON 19
 eO_0                -8.963553e-01 1 1  ON 20
 eO_1                -5.702222e-01 1 1  ON 21
 eO_2                -1.500027e-01 1 1  ON 22
 eO_3                 1.246377e-01 1 1  ON 23
 eO_4                 2.500117e-01 1 1  ON 24
 eO_5                 3.252952e-01 1 1  ON 25
 eO_6                 3.531346e-01 1 1  ON 26
 eO_7                 4.011652e-01 1 1  ON 27
 eO_8                 1.014492e-01 1 1  ON 28
 eO_9                 3.822123e-02 1 1  ON 29
eH1_0                -2.030541e-01 1 1  ON 30
eH1_1                -1.239812e-01 1 1  ON 31
eH1_2                -8.196323e-02 1 1  ON 32
eH1_3                -4.456010e-02 1 1  ON 33
eH1_4                 9.834982e-04 1 1  ON 34
eH1_5                 1.149003e-02 1 1  ON 35
eH1_6                 4.997493e-02 1 1  ON 36
eH1_7                 4.768903e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403416e-02 1 1  ON 39
eH2_0                -2.032432e-01 1 1  ON 40
eH2_1                -1.238075e-01 1 1  ON 41
eH2_2                -8.189333e-02 1 1  ON 42
eH2_3                -4.439135e-02 1 1  ON 43
eH2_4                 1.107383e-03 1 1  ON 44
eH2_5                 1.161112e-02 1 1  ON 45
eH2_6                 5.354947e-02 1 1  ON 46
eH2_7                 6.390644e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.151896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.201738
====================================================
  Execution time = 3.4400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1241e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312432636824
                                         uncertainty =       0.002611663934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312432636824
                                         uncertainty =       0.002611663934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395227308
  error estimate for blocks of size 2^( 2) =       0.000404758108
  error estimate for blocks of size 2^( 3) =       0.000413671022
  error estimate for blocks of size 2^( 4) =       0.000420411089
  error estimate for blocks of size 2^( 5) =       0.000425267487
  error estimate for blocks of size 2^( 6) =       0.000426952900
  error estimate for blocks of size 2^( 7) =       0.000427956136

      target function =                  N/A
              le_mean =     -17.216503023813
             les_mean =     296.720385462757
             stat err =       0.000425146903
             autocorr =       1.157135321455
              std dev =       0.558935819214
             le_variance =       0.312409250000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650302381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503023813       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502960311       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502995178       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503055295       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502983319       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502943402       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502972798       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.226931e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503023813       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503006881       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503016097       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503032287       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216503011803       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216503000339       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216503007962       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.388018e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503023813       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503019508       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503021846       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503025973       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216503020672       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216503017690       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216503019615       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.546393e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3746e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.072854e-01 1 1  ON 0
 uu_1                 4.374956e-02 1 1  ON 1
 uu_2                -5.303348e-02 1 1  ON 2
 uu_3                -1.106139e-01 1 1  ON 3
 uu_4                -1.474331e-01 1 1  ON 4
 uu_5                -1.594494e-01 1 1  ON 5
 uu_6                -1.460940e-01 1 1  ON 6
 uu_7                -9.607392e-02 1 1  ON 7
 uu_8                -1.489494e-03 1 1  ON 8
 uu_9                 2.066264e-01 1 1  ON 9
 ud_0                 3.604898e-01 1 1  ON 10
 ud_1                 1.008863e-01 1 1  ON 11
 ud_2                -1.074953e-02 1 1  ON 12
 ud_3                -7.381865e-02 1 1  ON 13
 ud_4                -1.239289e-01 1 1  ON 14
 ud_5                -1.594481e-01 1 1  ON 15
 ud_6                -1.699465e-01 1 1  ON 16
 ud_7                -1.425874e-01 1 1  ON 17
 ud_8                -7.202118e-02 1 1  ON 18
 ud_9                 7.860915e-02 1 1  ON 19
 eO_0                -8.963601e-01 1 1  ON 20
 eO_1                -5.702350e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246512e-01 1 1  ON 23
 eO_4                 2.500039e-01 1 1  ON 24
 eO_5                 3.252950e-01 1 1  ON 25
 eO_6                 3.531357e-01 1 1  ON 26
 eO_7                 4.011658e-01 1 1  ON 27
 eO_8                 1.014513e-01 1 1  ON 28
 eO_9                 3.822250e-02 1 1  ON 29
eH1_0                -2.030513e-01 1 1  ON 30
eH1_1                -1.239750e-01 1 1  ON 31
eH1_2                -8.197634e-02 1 1  ON 32
eH1_3                -4.456286e-02 1 1  ON 33
eH1_4                 9.885904e-04 1 1  ON 34
eH1_5                 1.148847e-02 1 1  ON 35
eH1_6                 4.997169e-02 1 1  ON 36
eH1_7                 4.769276e-02 1 1  ON 37
eH1_8                 2.187662e-01 1 1  ON 38
eH1_9                 8.403527e-02 1 1  ON 39
eH2_0                -2.032378e-01 1 1  ON 40
eH2_1                -1.238155e-01 1 1  ON 41
eH2_2                -8.189566e-02 1 1  ON 42
eH2_3                -4.439618e-02 1 1  ON 43
eH2_4                 1.113751e-03 1 1  ON 44
eH2_5                 1.161574e-02 1 1  ON 45
eH2_6                 5.354591e-02 1 1  ON 46
eH2_7                 6.390605e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.439575
====================================================
  Execution time = 3.3616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2229e-01
  Total weights = 2.0000e+06
  Execution time = 3.0796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322208568581
                                         uncertainty =       0.004025522404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322208568581
                                         uncertainty =       0.004025522404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401418626
  error estimate for blocks of size 2^( 2) =       0.000411119608
  error estimate for blocks of size 2^( 3) =       0.000419829756
  error estimate for blocks of size 2^( 4) =       0.000426573745
  error estimate for blocks of size 2^( 5) =       0.000430420597
  error estimate for blocks of size 2^( 6) =       0.000432974049
  error estimate for blocks of size 2^( 7) =       0.000433636860

      target function =                  N/A
              le_mean =     -17.216871390512
             les_mean =     296.742934142146
             stat err =       0.000430901313
             autocorr =       1.152286822654
              std dev =       0.567691664420
             le_variance =       0.322273825852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322257359476
                                         uncertainty =       0.004026469904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322257359476
                                         uncertainty =       0.004026469904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401448996
  error estimate for blocks of size 2^( 2) =       0.000411149036
  error estimate for blocks of size 2^( 3) =       0.000419857642
  error estimate for blocks of size 2^( 4) =       0.000426600358
  error estimate for blocks of size 2^( 5) =       0.000430446129
  error estimate for blocks of size 2^( 6) =       0.000432998989
  error estimate for blocks of size 2^( 7) =       0.000433661156

      target function =                  N/A
              le_mean =     -17.216871588389
             les_mean =     296.742989723050
             stat err =       0.000430926658
             autocorr =       1.152248017213
              std dev =       0.567734615056
             le_variance =       0.322322593133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322235119323
                                         uncertainty =       0.004026040594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322235119323
                                         uncertainty =       0.004026040594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401435153
  error estimate for blocks of size 2^( 2) =       0.000411135619
  error estimate for blocks of size 2^( 3) =       0.000419844936
  error estimate for blocks of size 2^( 4) =       0.000426588252
  error estimate for blocks of size 2^( 5) =       0.000430434524
  error estimate for blocks of size 2^( 6) =       0.000432987679
  error estimate for blocks of size 2^( 7) =       0.000433650165

      target function =                  N/A
              le_mean =     -17.216871492072
             les_mean =     296.742964177250
             stat err =       0.000430915155
             autocorr =       1.152265970126
              std dev =       0.567715037561
             le_variance =       0.322300363873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322211962736
                                         uncertainty =       0.004025588773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322211962736
                                         uncertainty =       0.004025588773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401420738
  error estimate for blocks of size 2^( 2) =       0.000411121654
  error estimate for blocks of size 2^( 3) =       0.000419831697
  error estimate for blocks of size 2^( 4) =       0.000426575600
  error estimate for blocks of size 2^( 5) =       0.000430422378
  error estimate for blocks of size 2^( 6) =       0.000432975793
  error estimate for blocks of size 2^( 7) =       0.000433638563

      target function =                  N/A
              le_mean =     -17.216871403048
             les_mean =     296.742937966337
             stat err =       0.000430903084
             autocorr =       1.152284164234
              std dev =       0.567694652419
             le_variance =       0.322277218385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216871390512        initial
     2.4414e+00     2.4414e+01             5.2269e-05       -17.216871588389  <--
     9.7656e+00     9.7656e+01             1.3880e-05       -17.216871492072
     3.9062e+01     3.9062e+02             3.5464e-06       -17.216871403048

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 4.9121e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375806e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497592e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201206e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002751e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131746e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.231422
====================================================
  Execution time = 3.3882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317551288311
                                         uncertainty =       0.003656237038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317551288311
                                         uncertainty =       0.003656237038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398447706
  error estimate for blocks of size 2^( 2) =       0.000408105048
  error estimate for blocks of size 2^( 3) =       0.000416499749
  error estimate for blocks of size 2^( 4) =       0.000422448330
  error estimate for blocks of size 2^( 5) =       0.000426799543
  error estimate for blocks of size 2^( 6) =       0.000428312291
  error estimate for blocks of size 2^( 7) =       0.000429667515

      target function =                  N/A
              le_mean =     -17.216060451011
             les_mean =     296.710258442740
             stat err =       0.000426806920
             autocorr =       1.147414258912
              std dev =       0.563490149556
             le_variance =       0.317521148647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721606045101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060451011       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060205751       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216059524627       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216059357708       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216059413622       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216058994968       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216058970313       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216059109389       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.761453e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060451011       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060377518       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216060130232       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060107908       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060159574       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216060030554       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216060019818       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.467273e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216060451011       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060431678       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216060362398       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216060359448       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060376879       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216060345205       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216060341315       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.421727e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3301e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.072692e-01 1 1  ON 0
 uu_1                 4.376100e-02 1 1  ON 1
 uu_2                -5.302591e-02 1 1  ON 2
 uu_3                -1.105969e-01 1 1  ON 3
 uu_4                -1.474364e-01 1 1  ON 4
 uu_5                -1.594727e-01 1 1  ON 5
 uu_6                -1.461278e-01 1 1  ON 6
 uu_7                -9.607191e-02 1 1  ON 7
 uu_8                -1.493570e-03 1 1  ON 8
 uu_9                 2.066208e-01 1 1  ON 9
 ud_0                 3.605818e-01 1 1  ON 10
 ud_1                 1.009250e-01 1 1  ON 11
 ud_2                -1.077465e-02 1 1  ON 12
 ud_3                -7.387988e-02 1 1  ON 13
 ud_4                -1.239950e-01 1 1  ON 14
 ud_5                -1.594488e-01 1 1  ON 15
 ud_6                -1.699300e-01 1 1  ON 16
 ud_7                -1.425837e-01 1 1  ON 17
 ud_8                -7.204395e-02 1 1  ON 18
 ud_9                 7.859359e-02 1 1  ON 19
 eO_0                -8.964004e-01 1 1  ON 20
 eO_1                -5.703040e-01 1 1  ON 21
 eO_2                -1.499760e-01 1 1  ON 22
 eO_3                 1.247197e-01 1 1  ON 23
 eO_4                 2.499854e-01 1 1  ON 24
 eO_5                 3.253069e-01 1 1  ON 25
 eO_6                 3.531196e-01 1 1  ON 26
 eO_7                 4.011748e-01 1 1  ON 27
 eO_8                 1.014694e-01 1 1  ON 28
 eO_9                 3.822918e-02 1 1  ON 29
eH1_0                -2.030195e-01 1 1  ON 30
eH1_1                -1.239649e-01 1 1  ON 31
eH1_2                -8.204548e-02 1 1  ON 32
eH1_3                -4.456426e-02 1 1  ON 33
eH1_4                 1.004058e-03 1 1  ON 34
eH1_5                 1.146738e-02 1 1  ON 35
eH1_6                 4.997101e-02 1 1  ON 36
eH1_7                 4.771171e-02 1 1  ON 37
eH1_8                 2.187626e-01 1 1  ON 38
eH1_9                 8.404374e-02 1 1  ON 39
eH2_0                -2.032262e-01 1 1  ON 40
eH2_1                -1.238690e-01 1 1  ON 41
eH2_2                -8.194373e-02 1 1  ON 42
eH2_3                -4.440078e-02 1 1  ON 43
eH2_4                 1.176766e-03 1 1  ON 44
eH2_5                 1.166320e-02 1 1  ON 45
eH2_6                 5.352101e-02 1 1  ON 46
eH2_7                 6.389970e-02 1 1  ON 47
eH2_8                 2.111433e-01 1 1  ON 48
eH2_9                 8.152908e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.227871
====================================================
  Execution time = 3.5380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1654e-01
  Total weights = 2.0000e+06
  Execution time = 3.0760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316458970571
                                         uncertainty =       0.002944495301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316458970571
                                         uncertainty =       0.002944495301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397800615
  error estimate for blocks of size 2^( 2) =       0.000407154260
  error estimate for blocks of size 2^( 3) =       0.000415778571
  error estimate for blocks of size 2^( 4) =       0.000421951401
  error estimate for blocks of size 2^( 5) =       0.000426204000
  error estimate for blocks of size 2^( 6) =       0.000428109256
  error estimate for blocks of size 2^( 7) =       0.000429304919

      target function =                  N/A
              le_mean =     -17.216931130427
             les_mean =     296.739208050016
             stat err =       0.000426392394
             autocorr =       1.148915260471
              std dev =       0.562575024694
             le_variance =       0.316490658410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316628056787
                                         uncertainty =       0.002946160058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316628056787
                                         uncertainty =       0.002946160058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397906851
  error estimate for blocks of size 2^( 2) =       0.000407254962
  error estimate for blocks of size 2^( 3) =       0.000415871173
  error estimate for blocks of size 2^( 4) =       0.000422037469
  error estimate for blocks of size 2^( 5) =       0.000426286871
  error estimate for blocks of size 2^( 6) =       0.000428187819
  error estimate for blocks of size 2^( 7) =       0.000429382901

      target function =                  N/A
              le_mean =     -17.216929310140
             les_mean =     296.739314435958
             stat err =       0.000426473765
             autocorr =       1.148740168967
              std dev =       0.562725265065
             le_variance =       0.316659723942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316565068837
                                         uncertainty =       0.002945532894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316565068837
                                         uncertainty =       0.002945532894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397867281
  error estimate for blocks of size 2^( 2) =       0.000407217365
  error estimate for blocks of size 2^( 3) =       0.000415836398
  error estimate for blocks of size 2^( 4) =       0.000422005091
  error estimate for blocks of size 2^( 5) =       0.000426255735
  error estimate for blocks of size 2^( 6) =       0.000428158090
  error estimate for blocks of size 2^( 7) =       0.000429353356

      target function =                  N/A
              le_mean =     -17.216929934210
             les_mean =     296.739272948311
             stat err =       0.000426443068
             autocorr =       1.148803276721
              std dev =       0.562669305301
             le_variance =       0.316596747128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316473043661
                                         uncertainty =       0.002944629886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316473043661
                                         uncertainty =       0.002944629886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397809458
  error estimate for blocks of size 2^( 2) =       0.000407162614
  error estimate for blocks of size 2^( 3) =       0.000415786195
  error estimate for blocks of size 2^( 4) =       0.000421958469
  error estimate for blocks of size 2^( 5) =       0.000426210789
  error estimate for blocks of size 2^( 6) =       0.000428115641
  error estimate for blocks of size 2^( 7) =       0.000429311229

      target function =                  N/A
              le_mean =     -17.216930964391
             les_mean =     296.739216404833
             stat err =       0.000426399032
             autocorr =       1.148899949710
              std dev =       0.562587531381
             le_variance =       0.316504730466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216931130427        initial  <--
     6.1035e-01     6.1035e+00             1.7615e-04       -17.216929310140
     2.4414e+00     2.4414e+01             5.4673e-05       -17.216929934210
     9.7656e+00     9.7656e+01             1.4217e-05       -17.216930964391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.8665
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375806e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497592e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201206e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002751e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131746e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1379
    reference variance = 0.250658
====================================================
  Execution time = 3.4718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2356e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596873599
                                         uncertainty =       0.006255119019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596873599
                                         uncertainty =       0.006255119019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402217327
  error estimate for blocks of size 2^( 2) =       0.000411397476
  error estimate for blocks of size 2^( 3) =       0.000419833743
  error estimate for blocks of size 2^( 4) =       0.000425909706
  error estimate for blocks of size 2^( 5) =       0.000429224157
  error estimate for blocks of size 2^( 6) =       0.000431450200
  error estimate for blocks of size 2^( 7) =       0.000432724573

      target function =                  N/A
              le_mean =     -17.216700008574
             les_mean =     296.738316580021
             stat err =       0.000429827159
             autocorr =       1.142000134788
              std dev =       0.568821199121
             le_variance =       0.323557556569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670000857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700008574       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700002256       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216699993978       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216699976751       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700008154       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216699992907       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216699987537       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.862968e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700008574       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700006954       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700004871       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700000713       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700008869       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700005333       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700003759       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.437142e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700008574       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700008166       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700007645       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700006615       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700008676       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700007810       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700007404       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.877705e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4074e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.072677e-01 1 1  ON 0
 uu_1                 4.375546e-02 1 1  ON 1
 uu_2                -5.303291e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474363e-01 1 1  ON 4
 uu_5                -1.594402e-01 1 1  ON 5
 uu_6                -1.461043e-01 1 1  ON 6
 uu_7                -9.607192e-02 1 1  ON 7
 uu_8                -1.498048e-03 1 1  ON 8
 uu_9                 2.066188e-01 1 1  ON 9
 ud_0                 3.605255e-01 1 1  ON 10
 ud_1                 1.008951e-01 1 1  ON 11
 ud_2                -1.074774e-02 1 1  ON 12
 ud_3                -7.384682e-02 1 1  ON 13
 ud_4                -1.239595e-01 1 1  ON 14
 ud_5                -1.594528e-01 1 1  ON 15
 ud_6                -1.699424e-01 1 1  ON 16
 ud_7                -1.425737e-01 1 1  ON 17
 ud_8                -7.203432e-02 1 1  ON 18
 ud_9                 7.859989e-02 1 1  ON 19
 eO_0                -8.963700e-01 1 1  ON 20
 eO_1                -5.702769e-01 1 1  ON 21
 eO_2                -1.499842e-01 1 1  ON 22
 eO_3                 1.246926e-01 1 1  ON 23
 eO_4                 2.499818e-01 1 1  ON 24
 eO_5                 3.252943e-01 1 1  ON 25
 eO_6                 3.531383e-01 1 1  ON 26
 eO_7                 4.011681e-01 1 1  ON 27
 eO_8                 1.014580e-01 1 1  ON 28
 eO_9                 3.822630e-02 1 1  ON 29
eH1_0                -2.030434e-01 1 1  ON 30
eH1_1                -1.239615e-01 1 1  ON 31
eH1_2                -8.201506e-02 1 1  ON 32
eH1_3                -4.457143e-02 1 1  ON 33
eH1_4                 1.005905e-03 1 1  ON 34
eH1_5                 1.148670e-02 1 1  ON 35
eH1_6                 4.996148e-02 1 1  ON 36
eH1_7                 4.770408e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403896e-02 1 1  ON 39
eH2_0                -2.032179e-01 1 1  ON 40
eH2_1                -1.238406e-01 1 1  ON 41
eH2_2                -8.190765e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.133566e-03 1 1  ON 44
eH2_5                 1.163255e-02 1 1  ON 45
eH2_6                 5.353583e-02 1 1  ON 46
eH2_7                 6.390419e-02 1 1  ON 47
eH2_8                 2.111431e-01 1 1  ON 48
eH2_9                 8.152473e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1356
    reference variance = 0.384692
====================================================
  Execution time = 3.3330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2542e-01
  Total weights = 2.0000e+06
  Execution time = 3.0906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325526814964
                                         uncertainty =       0.005181007919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325526814964
                                         uncertainty =       0.005181007919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403379592
  error estimate for blocks of size 2^( 2) =       0.000413379783
  error estimate for blocks of size 2^( 3) =       0.000421414001
  error estimate for blocks of size 2^( 4) =       0.000427800004
  error estimate for blocks of size 2^( 5) =       0.000431868398
  error estimate for blocks of size 2^( 6) =       0.000433774391
  error estimate for blocks of size 2^( 7) =       0.000437042352

      target function =                  N/A
              le_mean =     -17.216455666618
             les_mean =     296.731775748011
             stat err =       0.000432621286
             autocorr =       1.150238564012
              std dev =       0.570464889455
             le_variance =       0.325430190101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325503092067
                                         uncertainty =       0.005180748426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325503092067
                                         uncertainty =       0.005180748426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403364888
  error estimate for blocks of size 2^( 2) =       0.000413365898
  error estimate for blocks of size 2^( 3) =       0.000421400498
  error estimate for blocks of size 2^( 4) =       0.000427786253
  error estimate for blocks of size 2^( 5) =       0.000431854566
  error estimate for blocks of size 2^( 6) =       0.000433760553
  error estimate for blocks of size 2^( 7) =       0.000437027765

      target function =                  N/A
              le_mean =     -17.216455439713
             les_mean =     296.731744211179
             stat err =       0.000432607284
             autocorr =       1.150247962318
              std dev =       0.570444095650
             le_variance =       0.325406466262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325514168276
                                         uncertainty =       0.005180868870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325514168276
                                         uncertainty =       0.005180868870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403371753
  error estimate for blocks of size 2^( 2) =       0.000413372381
  error estimate for blocks of size 2^( 3) =       0.000421406808
  error estimate for blocks of size 2^( 4) =       0.000427792691
  error estimate for blocks of size 2^( 5) =       0.000431861046
  error estimate for blocks of size 2^( 6) =       0.000433767030
  error estimate for blocks of size 2^( 7) =       0.000437034599

      target function =                  N/A
              le_mean =     -17.216455546448
             les_mean =     296.731758962985
             stat err =       0.000432613842
             autocorr =       1.150243679283
              std dev =       0.570453804336
             le_variance =       0.325417542882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325525207031
                                         uncertainty =       0.005180990219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325525207031
                                         uncertainty =       0.005180990219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403378595
  error estimate for blocks of size 2^( 2) =       0.000413378842
  error estimate for blocks of size 2^( 3) =       0.000421413086
  error estimate for blocks of size 2^( 4) =       0.000427799075
  error estimate for blocks of size 2^( 5) =       0.000431867464
  error estimate for blocks of size 2^( 6) =       0.000433773455
  error estimate for blocks of size 2^( 7) =       0.000437041367

      target function =                  N/A
              le_mean =     -17.216455651289
             les_mean =     296.731773612197
             stat err =       0.000432620340
             autocorr =       1.150239217443
              std dev =       0.570463480075
             le_variance =       0.325428582099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216455666618        initial  <--
     6.1035e+00     6.1035e+01             2.8630e-05       -17.216455439713
     2.4414e+01     2.4414e+02             7.4371e-06       -17.216455546448
     9.7656e+01     9.7656e+02             1.8777e-06       -17.216455651289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.8996
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375806e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497592e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201206e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002751e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131746e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2865
    reference variance = 0.311196
====================================================
  Execution time = 3.4441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315585536897
                                         uncertainty =       0.002862422444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315585536897
                                         uncertainty =       0.002862422444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397330248
  error estimate for blocks of size 2^( 2) =       0.000406908415
  error estimate for blocks of size 2^( 3) =       0.000414969232
  error estimate for blocks of size 2^( 4) =       0.000420658990
  error estimate for blocks of size 2^( 5) =       0.000424633105
  error estimate for blocks of size 2^( 6) =       0.000426888159
  error estimate for blocks of size 2^( 7) =       0.000425901376

      target function =                  N/A
              le_mean =     -17.216783368276
             les_mean =     296.733372043599
             stat err =       0.000424520408
             autocorr =       1.141547242878
              std dev =       0.561909824909
             le_variance =       0.315742651329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678336828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783368276       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783368360       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216783371067       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216783368967       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216783367481       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216783367047       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216783364729       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.436914e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783368276       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783368297       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216783368975       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216783368449       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216783368072       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216783367960       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216783367385       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.624956e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783368276       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783368281       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216783368451       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216783368319       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216783368224       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216783368196       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216783368053       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.158293e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3762e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.072678e-01 1 1  ON 0
 uu_1                 4.375854e-02 1 1  ON 1
 uu_2                -5.303536e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474352e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461035e-01 1 1  ON 6
 uu_7                -9.607302e-02 1 1  ON 7
 uu_8                -1.497780e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605272e-01 1 1  ON 10
 ud_1                 1.008919e-01 1 1  ON 11
 ud_2                -1.075278e-02 1 1  ON 12
 ud_3                -7.384502e-02 1 1  ON 13
 ud_4                -1.239581e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699417e-01 1 1  ON 16
 ud_7                -1.425734e-01 1 1  ON 17
 ud_8                -7.203251e-02 1 1  ON 18
 ud_9                 7.860112e-02 1 1  ON 19
 eO_0                -8.963750e-01 1 1  ON 20
 eO_1                -5.702703e-01 1 1  ON 21
 eO_2                -1.499821e-01 1 1  ON 22
 eO_3                 1.246902e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252946e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011676e-01 1 1  ON 27
 eO_8                 1.014574e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030433e-01 1 1  ON 30
eH1_1                -1.239598e-01 1 1  ON 31
eH1_2                -8.201213e-02 1 1  ON 32
eH1_3                -4.457063e-02 1 1  ON 33
eH1_4                 1.002935e-03 1 1  ON 34
eH1_5                 1.148446e-02 1 1  ON 35
eH1_6                 4.996260e-02 1 1  ON 36
eH1_7                 4.770357e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403845e-02 1 1  ON 39
eH2_0                -2.032227e-01 1 1  ON 40
eH2_1                -1.238379e-01 1 1  ON 41
eH2_2                -8.190270e-02 1 1  ON 42
eH2_3                -4.440979e-02 1 1  ON 43
eH2_4                 1.131763e-03 1 1  ON 44
eH2_5                 1.162946e-02 1 1  ON 45
eH2_6                 5.353567e-02 1 1  ON 46
eH2_7                 6.390487e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.317203
====================================================
  Execution time = 3.4127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1783e-01
  Total weights = 2.0000e+06
  Execution time = 3.0970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705701071
                                         uncertainty =       0.003103278198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705701071
                                         uncertainty =       0.003103278198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398643392
  error estimate for blocks of size 2^( 2) =       0.000408772309
  error estimate for blocks of size 2^( 3) =       0.000417009949
  error estimate for blocks of size 2^( 4) =       0.000422760932
  error estimate for blocks of size 2^( 5) =       0.000425157846
  error estimate for blocks of size 2^( 6) =       0.000427053304
  error estimate for blocks of size 2^( 7) =       0.000428184012

      target function =                  N/A
              le_mean =     -17.216763283949
             les_mean =     296.734770925213
             stat err =       0.000425789023
             autocorr =       1.140826977941
              std dev =       0.563766892069
             le_variance =       0.317833108593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317704765374
                                         uncertainty =       0.003103286456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317704765374
                                         uncertainty =       0.003103286456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398642805
  error estimate for blocks of size 2^( 2) =       0.000408771721
  error estimate for blocks of size 2^( 3) =       0.000417009355
  error estimate for blocks of size 2^( 4) =       0.000422760349
  error estimate for blocks of size 2^( 5) =       0.000425157280
  error estimate for blocks of size 2^( 6) =       0.000427052747
  error estimate for blocks of size 2^( 7) =       0.000428183468

      target function =                  N/A
              le_mean =     -17.216763276429
             les_mean =     296.734769729597
             stat err =       0.000425788461
             autocorr =       1.140827326905
              std dev =       0.563766061348
             le_variance =       0.317832171927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705229389
                                         uncertainty =       0.003103282321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705229389
                                         uncertainty =       0.003103282321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398643096
  error estimate for blocks of size 2^( 2) =       0.000408772013
  error estimate for blocks of size 2^( 3) =       0.000417009650
  error estimate for blocks of size 2^( 4) =       0.000422760638
  error estimate for blocks of size 2^( 5) =       0.000425157561
  error estimate for blocks of size 2^( 6) =       0.000427053023
  error estimate for blocks of size 2^( 7) =       0.000428183738

      target function =                  N/A
              le_mean =     -17.216763280169
             les_mean =     296.734770322883
             stat err =       0.000425788740
             autocorr =       1.140827154773
              std dev =       0.563766473307
             le_variance =       0.317832636426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705641983
                                         uncertainty =       0.003103278714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317705641983
                                         uncertainty =       0.003103278714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398643355
  error estimate for blocks of size 2^( 2) =       0.000408772272
  error estimate for blocks of size 2^( 3) =       0.000417009912
  error estimate for blocks of size 2^( 4) =       0.000422760895
  error estimate for blocks of size 2^( 5) =       0.000425157811
  error estimate for blocks of size 2^( 6) =       0.000427053268
  error estimate for blocks of size 2^( 7) =       0.000428183978

      target function =                  N/A
              le_mean =     -17.216763283475
             les_mean =     296.734770849750
             stat err =       0.000425788988
             autocorr =       1.140827000115
              std dev =       0.563766839611
             le_variance =       0.317833049445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216763283949        initial  <--
     6.1035e+01     6.1035e+02             3.4369e-06       -17.216763276429
     2.4414e+02     2.4414e+03             8.6250e-07       -17.216763280169
     9.7656e+02     9.7656e+03             2.1583e-07       -17.216763283475

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.7801
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375806e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497592e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201206e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002751e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131746e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3829e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.151055
====================================================
  Execution time = 3.4538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324697689261
                                         uncertainty =       0.003933759503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324697689261
                                         uncertainty =       0.003933759503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402854358
  error estimate for blocks of size 2^( 2) =       0.000412305376
  error estimate for blocks of size 2^( 3) =       0.000421059440
  error estimate for blocks of size 2^( 4) =       0.000427394894
  error estimate for blocks of size 2^( 5) =       0.000431851291
  error estimate for blocks of size 2^( 6) =       0.000432952013
  error estimate for blocks of size 2^( 7) =       0.000433365515

      target function =                  N/A
              le_mean =     -17.217253279280
             les_mean =     296.758393588890
             stat err =       0.000431390928
             autocorr =       1.146689624735
              std dev =       0.569722097439
             le_variance =       0.324583268311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721725327928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217253279280       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217253278812       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217253278442       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217253277405       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217253277373       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217253277258       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.616687e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217253279280       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217253279163       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217253279070       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217253278811       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217253278803       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217253278774       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 4.042825e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217253279280       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217253279251       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217253279227       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217253279163       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217253279160       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217253279156       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.010776e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4054e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375803e-02 1 1  ON 1
 uu_2                -5.303549e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497600e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075280e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203231e-02 1 1  ON 18
 ud_9                 7.860126e-02 1 1  ON 19
 eO_0                -8.963747e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246900e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239598e-01 1 1  ON 31
eH1_2                -8.201208e-02 1 1  ON 32
eH1_3                -4.457108e-02 1 1  ON 33
eH1_4                 1.002774e-03 1 1  ON 34
eH1_5                 1.148468e-02 1 1  ON 35
eH1_6                 4.996252e-02 1 1  ON 36
eH1_7                 4.770351e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403844e-02 1 1  ON 39
eH2_0                -2.032227e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190316e-02 1 1  ON 42
eH2_3                -4.440967e-02 1 1  ON 43
eH2_4                 1.131757e-03 1 1  ON 44
eH2_5                 1.162938e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390496e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.3152
    reference variance = 0.62682
====================================================
  Execution time = 3.3898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2163e-01
  Total weights = 2.0000e+06
  Execution time = 3.3389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433508059
                                         uncertainty =       0.003791206336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433508059
                                         uncertainty =       0.003791206336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401017528
  error estimate for blocks of size 2^( 2) =       0.000410355131
  error estimate for blocks of size 2^( 3) =       0.000418720347
  error estimate for blocks of size 2^( 4) =       0.000425513475
  error estimate for blocks of size 2^( 5) =       0.000429828105
  error estimate for blocks of size 2^( 6) =       0.000431670998
  error estimate for blocks of size 2^( 7) =       0.000432603740

      target function =                  N/A
              le_mean =     -17.217214662328
             les_mean =     296.754110682919
             stat err =       0.000429904080
             autocorr =       1.149255054141
              std dev =       0.567124426426
             le_variance =       0.321630115049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433460956
                                         uncertainty =       0.003791205973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433460956
                                         uncertainty =       0.003791205973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401017498
  error estimate for blocks of size 2^( 2) =       0.000410355104
  error estimate for blocks of size 2^( 3) =       0.000418720321
  error estimate for blocks of size 2^( 4) =       0.000425513446
  error estimate for blocks of size 2^( 5) =       0.000429828074
  error estimate for blocks of size 2^( 6) =       0.000431670963
  error estimate for blocks of size 2^( 7) =       0.000432603710

      target function =                  N/A
              le_mean =     -17.217214661120
             les_mean =     296.754110594136
             stat err =       0.000429904048
             autocorr =       1.149255055072
              std dev =       0.567124384835
             le_variance =       0.321630067874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433484482
                                         uncertainty =       0.003791206154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433484482
                                         uncertainty =       0.003791206154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401017513
  error estimate for blocks of size 2^( 2) =       0.000410355117
  error estimate for blocks of size 2^( 3) =       0.000418720334
  error estimate for blocks of size 2^( 4) =       0.000425513460
  error estimate for blocks of size 2^( 5) =       0.000429828090
  error estimate for blocks of size 2^( 6) =       0.000431670980
  error estimate for blocks of size 2^( 7) =       0.000432603725

      target function =                  N/A
              le_mean =     -17.217214661724
             les_mean =     296.754110638488
             stat err =       0.000429904064
             autocorr =       1.149255054618
              std dev =       0.567124405607
             le_variance =       0.321630091435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433505111
                                         uncertainty =       0.003791206313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321433505111
                                         uncertainty =       0.003791206313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401017526
  error estimate for blocks of size 2^( 2) =       0.000410355129
  error estimate for blocks of size 2^( 3) =       0.000418720346
  error estimate for blocks of size 2^( 4) =       0.000425513473
  error estimate for blocks of size 2^( 5) =       0.000429828103
  error estimate for blocks of size 2^( 6) =       0.000431670996
  error estimate for blocks of size 2^( 7) =       0.000432603739

      target function =                  N/A
              le_mean =     -17.217214662253
             les_mean =     296.754110677364
             stat err =       0.000429904078
             autocorr =       1.149255054192
              std dev =       0.567124423823
             le_variance =       0.321630112096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217214662328        initial  <--
     6.1035e+02     6.1035e+03             1.6167e-07       -17.217214661120
     2.4414e+03     2.4414e+04             4.0428e-08       -17.217214661724
     9.7656e+03     9.7656e+04             1.0108e-08       -17.217214662253

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9933
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375806e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497592e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201206e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002751e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131746e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1109
    reference variance = 0.338947
====================================================
  Execution time = 3.4636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.6563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329099932281
                                         uncertainty =       0.008834408928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329099932281
                                         uncertainty =       0.008834408928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405595431
  error estimate for blocks of size 2^( 2) =       0.000415041802
  error estimate for blocks of size 2^( 3) =       0.000423388611
  error estimate for blocks of size 2^( 4) =       0.000429866322
  error estimate for blocks of size 2^( 5) =       0.000433521544
  error estimate for blocks of size 2^( 6) =       0.000433624662
  error estimate for blocks of size 2^( 7) =       0.000434162512

      target function =                  N/A
              le_mean =     -17.217102904594
             les_mean =     296.757647569381
             stat err =       0.000432793760
             autocorr =       1.138612308161
              std dev =       0.573598558673
             le_variance =       0.329015306511


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710290459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217102904594       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217102904536       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217102904485       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217102904490       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217102904452       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217102904446       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.080340e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217102904594       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217102904579       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217102904567       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217102904559       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217102904573       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217102904548       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 5.200902e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217102904594       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217102904590       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217102904587       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217102904562       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217102904585       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217102904604       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 1.300229e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4299e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375807e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497593e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075284e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201207e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002755e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440969e-02 1 1  ON 43
eH2_4                 1.131751e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.293838
====================================================
  Execution time = 3.3322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2046e-01
  Total weights = 2.0000e+06
  Execution time = 3.0884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506444739
                                         uncertainty =       0.004123912145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506444739
                                         uncertainty =       0.004123912145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400289861
  error estimate for blocks of size 2^( 2) =       0.000409603968
  error estimate for blocks of size 2^( 3) =       0.000418104391
  error estimate for blocks of size 2^( 4) =       0.000424444240
  error estimate for blocks of size 2^( 5) =       0.000428525322
  error estimate for blocks of size 2^( 6) =       0.000429780096
  error estimate for blocks of size 2^( 7) =       0.000432155120

      target function =                  N/A
              le_mean =     -17.216382660466
             les_mean =     296.724295696286
             stat err =       0.000428726195
             autocorr =       1.147125302333
              std dev =       0.566095349682
             le_variance =       0.320463944932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506437513
                                         uncertainty =       0.004123912069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506437513
                                         uncertainty =       0.004123912069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400289856
  error estimate for blocks of size 2^( 2) =       0.000409603963
  error estimate for blocks of size 2^( 3) =       0.000418104386
  error estimate for blocks of size 2^( 4) =       0.000424444236
  error estimate for blocks of size 2^( 5) =       0.000428525318
  error estimate for blocks of size 2^( 6) =       0.000429780092
  error estimate for blocks of size 2^( 7) =       0.000432155116

      target function =                  N/A
              le_mean =     -17.216382660645
             les_mean =     296.724295695211
             stat err =       0.000428726191
             autocorr =       1.147125306953
              std dev =       0.566095343290
             le_variance =       0.320463937695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506441126
                                         uncertainty =       0.004123912107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506441126
                                         uncertainty =       0.004123912107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400289858
  error estimate for blocks of size 2^( 2) =       0.000409603966
  error estimate for blocks of size 2^( 3) =       0.000418104389
  error estimate for blocks of size 2^( 4) =       0.000424444238
  error estimate for blocks of size 2^( 5) =       0.000428525320
  error estimate for blocks of size 2^( 6) =       0.000429780094
  error estimate for blocks of size 2^( 7) =       0.000432155118

      target function =                  N/A
              le_mean =     -17.216382660555
             les_mean =     296.724295695748
             stat err =       0.000428726193
             autocorr =       1.147125304644
              std dev =       0.566095346486
             le_variance =       0.320463941313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506444287
                                         uncertainty =       0.004123912140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320506444287
                                         uncertainty =       0.004123912140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400289860
  error estimate for blocks of size 2^( 2) =       0.000409603968
  error estimate for blocks of size 2^( 3) =       0.000418104391
  error estimate for blocks of size 2^( 4) =       0.000424444240
  error estimate for blocks of size 2^( 5) =       0.000428525322
  error estimate for blocks of size 2^( 6) =       0.000429780095
  error estimate for blocks of size 2^( 7) =       0.000432155119

      target function =                  N/A
              le_mean =     -17.216382660477
             les_mean =     296.724295696219
             stat err =       0.000428726194
             autocorr =       1.147125302623
              std dev =       0.566095349282
             le_variance =       0.320463944479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216382660466        initial
     6.1035e+03     6.1035e+04             2.0803e-08       -17.216382660645  <--
     2.4414e+04     2.4414e+05             5.2009e-09       -17.216382660555
     9.7656e+04     9.7656e+05             1.3002e-09       -17.216382660477

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 4.8900e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375807e-02 1 1  ON 1
 uu_2                -5.303552e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607298e-02 1 1  ON 7
 uu_8                -1.497596e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075283e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203229e-02 1 1  ON 18
 ud_9                 7.860127e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201207e-02 1 1  ON 32
eH1_3                -4.457105e-02 1 1  ON 33
eH1_4                 1.002766e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996249e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403843e-02 1 1  ON 39
eH2_0                -2.032228e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190313e-02 1 1  ON 42
eH2_3                -4.440968e-02 1 1  ON 43
eH2_4                 1.131766e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353574e-02 1 1  ON 46
eH2_7                 6.390497e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2779
    reference variance = 0.152716
====================================================
  Execution time = 3.3895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2329e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323323398313
                                         uncertainty =       0.004639584226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323323398313
                                         uncertainty =       0.004639584226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402048606
  error estimate for blocks of size 2^( 2) =       0.000411543825
  error estimate for blocks of size 2^( 3) =       0.000419761942
  error estimate for blocks of size 2^( 4) =       0.000425093290
  error estimate for blocks of size 2^( 5) =       0.000427613829
  error estimate for blocks of size 2^( 6) =       0.000430185239
  error estimate for blocks of size 2^( 7) =       0.000428629653

      target function =                  N/A
              le_mean =     -17.216886929315
             les_mean =     296.744481538807
             stat err =       0.000427880503
             autocorr =       1.132629510441
              std dev =       0.568582591755
             le_variance =       0.323286163647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688692931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886929315       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886929780       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886929787       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886930184       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886930053       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886930011       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886930068       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 8.120287e-08

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886929315       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886929431       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886929433       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886929532       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886929492       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886929489       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886929503       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.030203e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886929315       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886929344       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886929344       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886929369       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886929354       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886929367       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886929365       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 5.075589e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3326e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.072686e-01 1 1  ON 0
 uu_1                 4.375807e-02 1 1  ON 1
 uu_2                -5.303551e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474354e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607300e-02 1 1  ON 7
 uu_8                -1.497604e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075283e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203231e-02 1 1  ON 18
 ud_9                 7.860126e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702694e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239597e-01 1 1  ON 31
eH1_2                -8.201207e-02 1 1  ON 32
eH1_3                -4.457104e-02 1 1  ON 33
eH1_4                 1.002762e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996249e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403844e-02 1 1  ON 39
eH2_0                -2.032227e-01 1 1  ON 40
eH2_1                -1.238376e-01 1 1  ON 41
eH2_2                -8.190313e-02 1 1  ON 42
eH2_3                -4.440967e-02 1 1  ON 43
eH2_4                 1.131755e-03 1 1  ON 44
eH2_5                 1.162937e-02 1 1  ON 45
eH2_6                 5.353574e-02 1 1  ON 46
eH2_7                 6.390496e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.204993
====================================================
  Execution time = 3.4144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1442e-01
  Total weights = 2.0000e+06
  Execution time = 3.1348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422445516
                                         uncertainty =       0.002668285191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422445516
                                         uncertainty =       0.002668285191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396494920
  error estimate for blocks of size 2^( 2) =       0.000406185540
  error estimate for blocks of size 2^( 3) =       0.000414969155
  error estimate for blocks of size 2^( 4) =       0.000420987955
  error estimate for blocks of size 2^( 5) =       0.000423940938
  error estimate for blocks of size 2^( 6) =       0.000425430407
  error estimate for blocks of size 2^( 7) =       0.000425930490

      target function =                  N/A
              le_mean =     -17.217066184687
             les_mean =     296.741784294192
             stat err =       0.000424072448
             autocorr =       1.143944247252
              std dev =       0.560728493582
             le_variance =       0.314416443515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422392863
                                         uncertainty =       0.002668284554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422392863
                                         uncertainty =       0.002668284554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396494887
  error estimate for blocks of size 2^( 2) =       0.000406185507
  error estimate for blocks of size 2^( 3) =       0.000414969123
  error estimate for blocks of size 2^( 4) =       0.000420987923
  error estimate for blocks of size 2^( 5) =       0.000423940906
  error estimate for blocks of size 2^( 6) =       0.000425430374
  error estimate for blocks of size 2^( 7) =       0.000425930459

      target function =                  N/A
              le_mean =     -17.217066184876
             les_mean =     296.741784248040
             stat err =       0.000424072415
             autocorr =       1.143944264906
              std dev =       0.560728446616
             le_variance =       0.314416390844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422419183
                                         uncertainty =       0.002668284872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422419183
                                         uncertainty =       0.002668284872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396494904
  error estimate for blocks of size 2^( 2) =       0.000406185523
  error estimate for blocks of size 2^( 3) =       0.000414969139
  error estimate for blocks of size 2^( 4) =       0.000420987939
  error estimate for blocks of size 2^( 5) =       0.000423940922
  error estimate for blocks of size 2^( 6) =       0.000425430391
  error estimate for blocks of size 2^( 7) =       0.000425930475

      target function =                  N/A
              le_mean =     -17.217066184781
             les_mean =     296.741784271110
             stat err =       0.000424072432
             autocorr =       1.143944256073
              std dev =       0.560728470093
             le_variance =       0.314416417173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422442224
                                         uncertainty =       0.002668285151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314422442224
                                         uncertainty =       0.002668285151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396494918
  error estimate for blocks of size 2^( 2) =       0.000406185538
  error estimate for blocks of size 2^( 3) =       0.000414969153
  error estimate for blocks of size 2^( 4) =       0.000420987953
  error estimate for blocks of size 2^( 5) =       0.000423940936
  error estimate for blocks of size 2^( 6) =       0.000425430405
  error estimate for blocks of size 2^( 7) =       0.000425930488

      target function =                  N/A
              le_mean =     -17.217066184699
             les_mean =     296.741784291307
             stat err =       0.000424072446
             autocorr =       1.143944248353
              std dev =       0.560728490646
             le_variance =       0.314416440222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217066184687        initial
     1.5259e+03     1.5259e+04             8.1203e-08       -17.217066184876  <--
     6.1035e+03     6.1035e+04             2.0302e-08       -17.217066184781
     2.4414e+04     2.4414e+05             5.0756e-09       -17.217066184699

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 4.9880e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.072685e-01 1 1  ON 0
 uu_1                 4.375808e-02 1 1  ON 1
 uu_2                -5.303548e-02 1 1  ON 2
 uu_3                -1.106132e-01 1 1  ON 3
 uu_4                -1.474353e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607303e-02 1 1  ON 7
 uu_8                -1.497626e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008916e-01 1 1  ON 11
 ud_2                -1.075281e-02 1 1  ON 12
 ud_3                -7.384467e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203235e-02 1 1  ON 18
 ud_9                 7.860124e-02 1 1  ON 19
 eO_0                -8.963748e-01 1 1  ON 20
 eO_1                -5.702695e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246900e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531389e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239598e-01 1 1  ON 31
eH1_2                -8.201207e-02 1 1  ON 32
eH1_3                -4.457101e-02 1 1  ON 33
eH1_4                 1.002749e-03 1 1  ON 34
eH1_5                 1.148467e-02 1 1  ON 35
eH1_6                 4.996249e-02 1 1  ON 36
eH1_7                 4.770348e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403844e-02 1 1  ON 39
eH2_0                -2.032227e-01 1 1  ON 40
eH2_1                -1.238377e-01 1 1  ON 41
eH2_2                -8.190312e-02 1 1  ON 42
eH2_3                -4.440964e-02 1 1  ON 43
eH2_4                 1.131720e-03 1 1  ON 44
eH2_5                 1.162938e-02 1 1  ON 45
eH2_6                 5.353574e-02 1 1  ON 46
eH2_7                 6.390495e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3369e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2356
    reference variance = 0.30418
====================================================
  Execution time = 3.4371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1944e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319538192383
                                         uncertainty =       0.003038399030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319538192383
                                         uncertainty =       0.003038399030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399650274
  error estimate for blocks of size 2^( 2) =       0.000409350350
  error estimate for blocks of size 2^( 3) =       0.000417644803
  error estimate for blocks of size 2^( 4) =       0.000423904579
  error estimate for blocks of size 2^( 5) =       0.000429040935
  error estimate for blocks of size 2^( 6) =       0.000430915983
  error estimate for blocks of size 2^( 7) =       0.000432113834

      target function =                  N/A
              le_mean =     -17.217033589579
             les_mean =     296.745686147406
             stat err =       0.000428993833
             autocorr =       1.152237136660
              std dev =       0.565190837195
             le_variance =       0.319440682449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703358958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033589579       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033589207       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033589259       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217033589585       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217033589190       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033589051       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217033588752       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.141491e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033589579       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033589486       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033589499       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217033589580       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217033589482       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033589446       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217033589372       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.035776e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033589579       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033589555       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033589559       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217033589579       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217033589550       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033589548       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217033589528       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.589694e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3715e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.072685e-01 1 1  ON 0
 uu_1                 4.375810e-02 1 1  ON 1
 uu_2                -5.303548e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474353e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607307e-02 1 1  ON 7
 uu_8                -1.497656e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605272e-01 1 1  ON 10
 ud_1                 1.008917e-01 1 1  ON 11
 ud_2                -1.075278e-02 1 1  ON 12
 ud_3                -7.384469e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699417e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203240e-02 1 1  ON 18
 ud_9                 7.860121e-02 1 1  ON 19
 eO_0                -8.963747e-01 1 1  ON 20
 eO_1                -5.702695e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246900e-01 1 1  ON 23
 eO_4                 2.499815e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822615e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239599e-01 1 1  ON 31
eH1_2                -8.201211e-02 1 1  ON 32
eH1_3                -4.457095e-02 1 1  ON 33
eH1_4                 1.002772e-03 1 1  ON 34
eH1_5                 1.148472e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770349e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403844e-02 1 1  ON 39
eH2_0                -2.032226e-01 1 1  ON 40
eH2_1                -1.238377e-01 1 1  ON 41
eH2_2                -8.190319e-02 1 1  ON 42
eH2_3                -4.440963e-02 1 1  ON 43
eH2_4                 1.131739e-03 1 1  ON 44
eH2_5                 1.162939e-02 1 1  ON 45
eH2_6                 5.353575e-02 1 1  ON 46
eH2_7                 6.390496e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1281
    reference variance = 1.9752
====================================================
  Execution time = 3.3591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1803e-01
  Total weights = 2.0000e+06
  Execution time = 3.1252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975345536
                                         uncertainty =       0.004860015260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975345536
                                         uncertainty =       0.004860015260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398766000
  error estimate for blocks of size 2^( 2) =       0.000408371218
  error estimate for blocks of size 2^( 3) =       0.000417149519
  error estimate for blocks of size 2^( 4) =       0.000422936557
  error estimate for blocks of size 2^( 5) =       0.000427325008
  error estimate for blocks of size 2^( 6) =       0.000429471061
  error estimate for blocks of size 2^( 7) =       0.000428128917

      target function =                  N/A
              le_mean =     -17.217229196961
             les_mean =     296.751009707460
             stat err =       0.000426965386
             autocorr =       1.146434089782
              std dev =       0.563940285657
             le_variance =       0.318028645787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975421370
                                         uncertainty =       0.004860013657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975421370
                                         uncertainty =       0.004860013657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398766048
  error estimate for blocks of size 2^( 2) =       0.000408371261
  error estimate for blocks of size 2^( 3) =       0.000417149555
  error estimate for blocks of size 2^( 4) =       0.000422936586
  error estimate for blocks of size 2^( 5) =       0.000427325041
  error estimate for blocks of size 2^( 6) =       0.000429471094
  error estimate for blocks of size 2^( 7) =       0.000428128951

      target function =                  N/A
              le_mean =     -17.217229198054
             les_mean =     296.751009821285
             stat err =       0.000426965418
             autocorr =       1.146433990452
              std dev =       0.563940353219
             le_variance =       0.318028721989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975383447
                                         uncertainty =       0.004860014458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975383447
                                         uncertainty =       0.004860014458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398766024
  error estimate for blocks of size 2^( 2) =       0.000408371240
  error estimate for blocks of size 2^( 3) =       0.000417149537
  error estimate for blocks of size 2^( 4) =       0.000422936572
  error estimate for blocks of size 2^( 5) =       0.000427325025
  error estimate for blocks of size 2^( 6) =       0.000429471077
  error estimate for blocks of size 2^( 7) =       0.000428128934

      target function =                  N/A
              le_mean =     -17.217229197508
             les_mean =     296.751009764381
             stat err =       0.000426965402
             autocorr =       1.146434040112
              std dev =       0.563940319433
             le_variance =       0.318028683882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975350274
                                         uncertainty =       0.004860015160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317975350274
                                         uncertainty =       0.004860015160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398766003
  error estimate for blocks of size 2^( 2) =       0.000408371221
  error estimate for blocks of size 2^( 3) =       0.000417149521
  error estimate for blocks of size 2^( 4) =       0.000422936559
  error estimate for blocks of size 2^( 5) =       0.000427325010
  error estimate for blocks of size 2^( 6) =       0.000429471063
  error estimate for blocks of size 2^( 7) =       0.000428128919

      target function =                  N/A
              le_mean =     -17.217229197029
             les_mean =     296.751009714575
             stat err =       0.000426965388
             autocorr =       1.146434083580
              std dev =       0.563940289879
             le_variance =       0.318028650548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217229196961        initial
     3.8147e+02     3.8147e+03             4.1415e-07       -17.217229198054  <--
     1.5259e+03     1.5259e+04             1.0358e-07       -17.217229197508
     6.1035e+03     6.1035e+04             2.5897e-08       -17.217229197029

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.9337e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.072685e-01 1 1  ON 0
 uu_1                 4.375816e-02 1 1  ON 1
 uu_2                -5.303546e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474352e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461037e-01 1 1  ON 6
 uu_7                -9.607319e-02 1 1  ON 7
 uu_8                -1.497748e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605274e-01 1 1  ON 10
 ud_1                 1.008919e-01 1 1  ON 11
 ud_2                -1.075269e-02 1 1  ON 12
 ud_3                -7.384475e-02 1 1  ON 13
 ud_4                -1.239583e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425736e-01 1 1  ON 17
 ud_8                -7.203256e-02 1 1  ON 18
 ud_9                 7.860113e-02 1 1  ON 19
 eO_0                -8.963746e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246900e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822616e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239602e-01 1 1  ON 31
eH1_2                -8.201223e-02 1 1  ON 32
eH1_3                -4.457078e-02 1 1  ON 33
eH1_4                 1.002838e-03 1 1  ON 34
eH1_5                 1.148487e-02 1 1  ON 35
eH1_6                 4.996252e-02 1 1  ON 36
eH1_7                 4.770350e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403845e-02 1 1  ON 39
eH2_0                -2.032225e-01 1 1  ON 40
eH2_1                -1.238379e-01 1 1  ON 41
eH2_2                -8.190341e-02 1 1  ON 42
eH2_3                -4.440957e-02 1 1  ON 43
eH2_4                 1.131795e-03 1 1  ON 44
eH2_5                 1.162944e-02 1 1  ON 45
eH2_6                 5.353580e-02 1 1  ON 46
eH2_7                 6.390499e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.181277
====================================================
  Execution time = 3.6735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2265e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797149600
                                         uncertainty =       0.004223583781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322797149600
                                         uncertainty =       0.004223583781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401654246
  error estimate for blocks of size 2^( 2) =       0.000411340500
  error estimate for blocks of size 2^( 3) =       0.000419606834
  error estimate for blocks of size 2^( 4) =       0.000426550835
  error estimate for blocks of size 2^( 5) =       0.000430774716
  error estimate for blocks of size 2^( 6) =       0.000431443315
  error estimate for blocks of size 2^( 7) =       0.000433666371

      target function =                  N/A
              le_mean =     -17.216703172375
             les_mean =     296.737520231647
             stat err =       0.000430608809
             autocorr =       1.149373276029
              std dev =       0.568024882648
             le_variance =       0.322652267308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670317237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703172375       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703174678       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703172638       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703164334       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703168010       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703168364       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703168714       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.590772e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703172375       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703172952       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703172442       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703170357       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703171274       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703171363       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703171450       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 3.980459e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703172375       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703172519       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703172392       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703171870       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703172099       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703172122       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703172143       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 9.953351e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6105e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.072684e-01 1 1  ON 0
 uu_1                 4.375792e-02 1 1  ON 1
 uu_2                -5.303543e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474350e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607315e-02 1 1  ON 7
 uu_8                -1.497735e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605275e-01 1 1  ON 10
 ud_1                 1.008921e-01 1 1  ON 11
 ud_2                -1.075272e-02 1 1  ON 12
 ud_3                -7.384470e-02 1 1  ON 13
 ud_4                -1.239584e-01 1 1  ON 14
 ud_5                -1.594521e-01 1 1  ON 15
 ud_6                -1.699418e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203256e-02 1 1  ON 18
 ud_9                 7.860108e-02 1 1  ON 19
 eO_0                -8.963747e-01 1 1  ON 20
 eO_1                -5.702699e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246902e-01 1 1  ON 23
 eO_4                 2.499814e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011676e-01 1 1  ON 27
 eO_8                 1.014574e-01 1 1  ON 28
 eO_9                 3.822617e-02 1 1  ON 29
eH1_0                -2.030426e-01 1 1  ON 30
eH1_1                -1.239604e-01 1 1  ON 31
eH1_2                -8.201220e-02 1 1  ON 32
eH1_3                -4.457073e-02 1 1  ON 33
eH1_4                 1.002789e-03 1 1  ON 34
eH1_5                 1.148468e-02 1 1  ON 35
eH1_6                 4.996264e-02 1 1  ON 36
eH1_7                 4.770358e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403849e-02 1 1  ON 39
eH2_0                -2.032223e-01 1 1  ON 40
eH2_1                -1.238383e-01 1 1  ON 41
eH2_2                -8.190335e-02 1 1  ON 42
eH2_3                -4.440963e-02 1 1  ON 43
eH2_4                 1.131969e-03 1 1  ON 44
eH2_5                 1.162973e-02 1 1  ON 45
eH2_6                 5.353555e-02 1 1  ON 46
eH2_7                 6.390498e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152438e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.342319
====================================================
  Execution time = 3.3429e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1567e-01
  Total weights = 2.0000e+06
  Execution time = 3.1323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764844603
                                         uncertainty =       0.003175879582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764844603
                                         uncertainty =       0.003175879582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397286933
  error estimate for blocks of size 2^( 2) =       0.000406538183
  error estimate for blocks of size 2^( 3) =       0.000415154399
  error estimate for blocks of size 2^( 4) =       0.000421364405
  error estimate for blocks of size 2^( 5) =       0.000425844752
  error estimate for blocks of size 2^( 6) =       0.000428897855
  error estimate for blocks of size 2^( 7) =       0.000431310516

      target function =                  N/A
              le_mean =     -17.217781664498
             les_mean =     296.767679102612
             stat err =       0.000426854382
             autocorr =       1.154385667679
              std dev =       0.561848568667
             le_variance =       0.315673814114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764826246
                                         uncertainty =       0.003175881733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764826246
                                         uncertainty =       0.003175881733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397286921
  error estimate for blocks of size 2^( 2) =       0.000406538161
  error estimate for blocks of size 2^( 3) =       0.000415154360
  error estimate for blocks of size 2^( 4) =       0.000421364363
  error estimate for blocks of size 2^( 5) =       0.000425844716
  error estimate for blocks of size 2^( 6) =       0.000428897811
  error estimate for blocks of size 2^( 7) =       0.000431310481

      target function =                  N/A
              le_mean =     -17.217781662112
             les_mean =     296.767679001938
             stat err =       0.000426854342
             autocorr =       1.154385522218
              std dev =       0.561848552214
             le_variance =       0.315673795625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764834860
                                         uncertainty =       0.003175880633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764834860
                                         uncertainty =       0.003175880633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397286927
  error estimate for blocks of size 2^( 2) =       0.000406538172
  error estimate for blocks of size 2^( 3) =       0.000415154379
  error estimate for blocks of size 2^( 4) =       0.000421364384
  error estimate for blocks of size 2^( 5) =       0.000425844733
  error estimate for blocks of size 2^( 6) =       0.000428897832
  error estimate for blocks of size 2^( 7) =       0.000431310498

      target function =                  N/A
              le_mean =     -17.217781663311
             les_mean =     296.767679051914
             stat err =       0.000426854362
             autocorr =       1.154385595081
              std dev =       0.561848559938
             le_variance =       0.315673804304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764843366
                                         uncertainty =       0.003175879713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315764843366
                                         uncertainty =       0.003175879713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397286932
  error estimate for blocks of size 2^( 2) =       0.000406538182
  error estimate for blocks of size 2^( 3) =       0.000415154397
  error estimate for blocks of size 2^( 4) =       0.000421364402
  error estimate for blocks of size 2^( 5) =       0.000425844749
  error estimate for blocks of size 2^( 6) =       0.000428897852
  error estimate for blocks of size 2^( 7) =       0.000431310514

      target function =                  N/A
              le_mean =     -17.217781664350
             les_mean =     296.767679096257
             stat err =       0.000426854379
             autocorr =       1.154385658597
              std dev =       0.561848567559
             le_variance =       0.315673812869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217781664498        initial  <--
     9.5367e+01     9.5367e+02             1.5908e-06       -17.217781662112
     3.8147e+02     3.8147e+03             3.9805e-07       -17.217781663311
     1.5259e+03     1.5259e+04             9.9534e-08       -17.217781664350

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1471
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.072685e-01 1 1  ON 0
 uu_1                 4.375816e-02 1 1  ON 1
 uu_2                -5.303546e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474352e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461037e-01 1 1  ON 6
 uu_7                -9.607319e-02 1 1  ON 7
 uu_8                -1.497748e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605274e-01 1 1  ON 10
 ud_1                 1.008919e-01 1 1  ON 11
 ud_2                -1.075269e-02 1 1  ON 12
 ud_3                -7.384475e-02 1 1  ON 13
 ud_4                -1.239583e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425736e-01 1 1  ON 17
 ud_8                -7.203256e-02 1 1  ON 18
 ud_9                 7.860113e-02 1 1  ON 19
 eO_0                -8.963746e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.499827e-01 1 1  ON 22
 eO_3                 1.246900e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014573e-01 1 1  ON 28
 eO_9                 3.822616e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239602e-01 1 1  ON 31
eH1_2                -8.201223e-02 1 1  ON 32
eH1_3                -4.457078e-02 1 1  ON 33
eH1_4                 1.002838e-03 1 1  ON 34
eH1_5                 1.148487e-02 1 1  ON 35
eH1_6                 4.996252e-02 1 1  ON 36
eH1_7                 4.770350e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403845e-02 1 1  ON 39
eH2_0                -2.032225e-01 1 1  ON 40
eH2_1                -1.238379e-01 1 1  ON 41
eH2_2                -8.190341e-02 1 1  ON 42
eH2_3                -4.440957e-02 1 1  ON 43
eH2_4                 1.131795e-03 1 1  ON 44
eH2_5                 1.162944e-02 1 1  ON 45
eH2_6                 5.353580e-02 1 1  ON 46
eH2_7                 6.390499e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2909
    reference variance = 0.284927
====================================================
  Execution time = 8.2256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597861948
                                         uncertainty =       0.004729835609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322597861948
                                         uncertainty =       0.004729835609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605544
  error estimate for blocks of size 2^( 2) =       0.000411059300
  error estimate for blocks of size 2^( 3) =       0.000419692713
  error estimate for blocks of size 2^( 4) =       0.000426269138
  error estimate for blocks of size 2^( 5) =       0.000429482273
  error estimate for blocks of size 2^( 6) =       0.000432490864
  error estimate for blocks of size 2^( 7) =       0.000431394994

      target function =                  N/A
              le_mean =     -17.217261765469
             les_mean =     296.756676565631
             stat err =       0.000429909317
             autocorr =       1.145920042031
              std dev =       0.567956007307
             le_variance =       0.322574026237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726176547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261765469       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261766438       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261766888       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261766700       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261766830       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261766731       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261766816       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.621901e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261765469       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261765711       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261765824       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261765778       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261765808       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261765786       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261765805       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.055686e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261765469       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261765530       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261765558       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261765546       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261765550       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261765548       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261765554       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.013980e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 9.1596e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.072685e-01 1 1  ON 0
 uu_1                 4.375814e-02 1 1  ON 1
 uu_2                -5.303546e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474351e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461037e-01 1 1  ON 6
 uu_7                -9.607319e-02 1 1  ON 7
 uu_8                -1.497747e-03 1 1  ON 8
 uu_9                 2.066197e-01 1 1  ON 9
 ud_0                 3.605273e-01 1 1  ON 10
 ud_1                 1.008920e-01 1 1  ON 11
 ud_2                -1.075268e-02 1 1  ON 12
 ud_3                -7.384474e-02 1 1  ON 13
 ud_4                -1.239583e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425736e-01 1 1  ON 17
 ud_8                -7.203257e-02 1 1  ON 18
 ud_9                 7.860112e-02 1 1  ON 19
 eO_0                -8.963746e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011675e-01 1 1  ON 27
 eO_8                 1.014574e-01 1 1  ON 28
 eO_9                 3.822616e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239602e-01 1 1  ON 31
eH1_2                -8.201224e-02 1 1  ON 32
eH1_3                -4.457076e-02 1 1  ON 33
eH1_4                 1.002852e-03 1 1  ON 34
eH1_5                 1.148486e-02 1 1  ON 35
eH1_6                 4.996252e-02 1 1  ON 36
eH1_7                 4.770350e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403846e-02 1 1  ON 39
eH2_0                -2.032225e-01 1 1  ON 40
eH2_1                -1.238379e-01 1 1  ON 41
eH2_2                -8.190341e-02 1 1  ON 42
eH2_3                -4.440954e-02 1 1  ON 43
eH2_4                 1.131762e-03 1 1  ON 44
eH2_5                 1.162945e-02 1 1  ON 45
eH2_6                 5.353579e-02 1 1  ON 46
eH2_7                 6.390500e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1369
    reference variance = 0.262461
====================================================
  Execution time = 3.3910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1545e-01
  Total weights = 2.0000e+06
  Execution time = 3.1210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470495056
                                         uncertainty =       0.002522933855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470495056
                                         uncertainty =       0.002522933855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397147679
  error estimate for blocks of size 2^( 2) =       0.000407098621
  error estimate for blocks of size 2^( 3) =       0.000415751191
  error estimate for blocks of size 2^( 4) =       0.000422097933
  error estimate for blocks of size 2^( 5) =       0.000427066690
  error estimate for blocks of size 2^( 6) =       0.000430463842
  error estimate for blocks of size 2^( 7) =       0.000431126363

      target function =                  N/A
              le_mean =     -17.217705776950
             les_mean =     296.764844620983
             stat err =       0.000427688707
             autocorr =       1.159715626648
              std dev =       0.561651633210
             le_variance =       0.315452557087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470281087
                                         uncertainty =       0.002522931600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470281087
                                         uncertainty =       0.002522931600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397147544
  error estimate for blocks of size 2^( 2) =       0.000407098492
  error estimate for blocks of size 2^( 3) =       0.000415751063
  error estimate for blocks of size 2^( 4) =       0.000422097806
  error estimate for blocks of size 2^( 5) =       0.000427066566
  error estimate for blocks of size 2^( 6) =       0.000430463712
  error estimate for blocks of size 2^( 7) =       0.000431126239

      target function =                  N/A
              le_mean =     -17.217705777630
             les_mean =     296.764844430476
             stat err =       0.000427688581
             autocorr =       1.159715728433
              std dev =       0.561651442761
             le_variance =       0.315452343155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470388032
                                         uncertainty =       0.002522932727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470388032
                                         uncertainty =       0.002522932727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397147611
  error estimate for blocks of size 2^( 2) =       0.000407098557
  error estimate for blocks of size 2^( 3) =       0.000415751127
  error estimate for blocks of size 2^( 4) =       0.000422097869
  error estimate for blocks of size 2^( 5) =       0.000427066628
  error estimate for blocks of size 2^( 6) =       0.000430463777
  error estimate for blocks of size 2^( 7) =       0.000431126301

      target function =                  N/A
              le_mean =     -17.217705777290
             les_mean =     296.764844525697
             stat err =       0.000427688644
             autocorr =       1.159715677554
              std dev =       0.561651537950
             le_variance =       0.315452450082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470481676
                                         uncertainty =       0.002522933714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470481676
                                         uncertainty =       0.002522933714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397147670
  error estimate for blocks of size 2^( 2) =       0.000407098613
  error estimate for blocks of size 2^( 3) =       0.000415751183
  error estimate for blocks of size 2^( 4) =       0.000422097925
  error estimate for blocks of size 2^( 5) =       0.000427066683
  error estimate for blocks of size 2^( 6) =       0.000430463833
  error estimate for blocks of size 2^( 7) =       0.000431126355

      target function =                  N/A
              le_mean =     -17.217705776993
             les_mean =     296.764844609071
             stat err =       0.000427688699
             autocorr =       1.159715633006
              std dev =       0.561651621301
             le_variance =       0.315452543710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217705776950        initial
     9.5367e+02     9.5367e+03             1.6219e-07       -17.217705777630  <--
     3.8147e+03     3.8147e+04             4.0557e-08       -17.217705777290
     1.5259e+04     1.5259e+05             1.0140e-08       -17.217705776993

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 4.9606e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.072684e-01 1 1  ON 0
 uu_1                 4.375809e-02 1 1  ON 1
 uu_2                -5.303546e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474350e-01 1 1  ON 4
 uu_5                -1.594407e-01 1 1  ON 5
 uu_6                -1.461037e-01 1 1  ON 6
 uu_7                -9.607319e-02 1 1  ON 7
 uu_8                -1.497743e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605272e-01 1 1  ON 10
 ud_1                 1.008920e-01 1 1  ON 11
 ud_2                -1.075262e-02 1 1  ON 12
 ud_3                -7.384472e-02 1 1  ON 13
 ud_4                -1.239583e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425736e-01 1 1  ON 17
 ud_8                -7.203259e-02 1 1  ON 18
 ud_9                 7.860110e-02 1 1  ON 19
 eO_0                -8.963747e-01 1 1  ON 20
 eO_1                -5.702696e-01 1 1  ON 21
 eO_2                -1.499828e-01 1 1  ON 22
 eO_3                 1.246899e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252944e-01 1 1  ON 25
 eO_6                 3.531388e-01 1 1  ON 26
 eO_7                 4.011676e-01 1 1  ON 27
 eO_8                 1.014574e-01 1 1  ON 28
 eO_9                 3.822616e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239602e-01 1 1  ON 31
eH1_2                -8.201226e-02 1 1  ON 32
eH1_3                -4.457070e-02 1 1  ON 33
eH1_4                 1.002892e-03 1 1  ON 34
eH1_5                 1.148482e-02 1 1  ON 35
eH1_6                 4.996250e-02 1 1  ON 36
eH1_7                 4.770351e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403847e-02 1 1  ON 39
eH2_0                -2.032225e-01 1 1  ON 40
eH2_1                -1.238379e-01 1 1  ON 41
eH2_2                -8.190343e-02 1 1  ON 42
eH2_3                -4.440947e-02 1 1  ON 43
eH2_4                 1.131664e-03 1 1  ON 44
eH2_5                 1.162951e-02 1 1  ON 45
eH2_6                 5.353577e-02 1 1  ON 46
eH2_7                 6.390501e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152437e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.4158e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2138
    reference variance = 0.229329
====================================================
  Execution time = 3.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2153e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321640398960
                                         uncertainty =       0.003901959600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321640398960
                                         uncertainty =       0.003901959600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400952562
  error estimate for blocks of size 2^( 2) =       0.000410985354
  error estimate for blocks of size 2^( 3) =       0.000419588580
  error estimate for blocks of size 2^( 4) =       0.000425812160
  error estimate for blocks of size 2^( 5) =       0.000430144496
  error estimate for blocks of size 2^( 6) =       0.000432650843
  error estimate for blocks of size 2^( 7) =       0.000432938563

      target function =                  N/A
              le_mean =     -17.216553669298
             les_mean =     296.731246000214
             stat err =       0.000430386515
             autocorr =       1.152209168678
              std dev =       0.567032550353
             le_variance =       0.321525913160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655366930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553669298       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553668691       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553672392       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553674933       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553675154       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553674337       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 6.801520e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553669298       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553669146       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553670072       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553670708       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553670763       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553670560       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.701616e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553669298       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553669260       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553669491       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553669651       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553669664       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553669620       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.254813e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3594e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.072682e-01 1 1  ON 0
 uu_1                 4.375797e-02 1 1  ON 1
 uu_2                -5.303541e-02 1 1  ON 2
 uu_3                -1.106129e-01 1 1  ON 3
 uu_4                -1.474350e-01 1 1  ON 4
 uu_5                -1.594406e-01 1 1  ON 5
 uu_6                -1.461037e-01 1 1  ON 6
 uu_7                -9.607314e-02 1 1  ON 7
 uu_8                -1.497743e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605272e-01 1 1  ON 10
 ud_1                 1.008922e-01 1 1  ON 11
 ud_2                -1.075266e-02 1 1  ON 12
 ud_3                -7.384466e-02 1 1  ON 13
 ud_4                -1.239585e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425736e-01 1 1  ON 17
 ud_8                -7.203259e-02 1 1  ON 18
 ud_9                 7.860108e-02 1 1  ON 19
 eO_0                -8.963747e-01 1 1  ON 20
 eO_1                -5.702696e-01 1 1  ON 21
 eO_2                -1.499830e-01 1 1  ON 22
 eO_3                 1.246901e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252945e-01 1 1  ON 25
 eO_6                 3.531387e-01 1 1  ON 26
 eO_7                 4.011676e-01 1 1  ON 27
 eO_8                 1.014574e-01 1 1  ON 28
 eO_9                 3.822616e-02 1 1  ON 29
eH1_0                -2.030429e-01 1 1  ON 30
eH1_1                -1.239603e-01 1 1  ON 31
eH1_2                -8.201227e-02 1 1  ON 32
eH1_3                -4.457062e-02 1 1  ON 33
eH1_4                 1.002904e-03 1 1  ON 34
eH1_5                 1.148487e-02 1 1  ON 35
eH1_6                 4.996246e-02 1 1  ON 36
eH1_7                 4.770353e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.403848e-02 1 1  ON 39
eH2_0                -2.032224e-01 1 1  ON 40
eH2_1                -1.238380e-01 1 1  ON 41
eH2_2                -8.190354e-02 1 1  ON 42
eH2_3                -4.440943e-02 1 1  ON 43
eH2_4                 1.131707e-03 1 1  ON 44
eH2_5                 1.162952e-02 1 1  ON 45
eH2_6                 5.353577e-02 1 1  ON 46
eH2_7                 6.390502e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152437e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1972
    reference variance = 0.283683
====================================================
  Execution time = 3.6198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1220e-01
  Total weights = 2.0000e+06
  Execution time = 3.1191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254300516
                                         uncertainty =       0.002173998786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254300516
                                         uncertainty =       0.002173998786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395092639
  error estimate for blocks of size 2^( 2) =       0.000404899069
  error estimate for blocks of size 2^( 3) =       0.000413299952
  error estimate for blocks of size 2^( 4) =       0.000419255085
  error estimate for blocks of size 2^( 5) =       0.000422632668
  error estimate for blocks of size 2^( 6) =       0.000425880589
  error estimate for blocks of size 2^( 7) =       0.000428313983

      target function =                  N/A
              le_mean =     -17.216672725188
             les_mean =     296.726015957205
             stat err =       0.000424020581
             autocorr =       1.151797143396
              std dev =       0.558745368722
             le_variance =       0.312196387069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312253826667
                                         uncertainty =       0.002173994733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312253826667
                                         uncertainty =       0.002173994733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395092340
  error estimate for blocks of size 2^( 2) =       0.000404898768
  error estimate for blocks of size 2^( 3) =       0.000413299658
  error estimate for blocks of size 2^( 4) =       0.000419254790
  error estimate for blocks of size 2^( 5) =       0.000422632391
  error estimate for blocks of size 2^( 6) =       0.000425880331
  error estimate for blocks of size 2^( 7) =       0.000428313723

      target function =                  N/A
              le_mean =     -17.216672729700
             les_mean =     296.726015639027
             stat err =       0.000424020309
             autocorr =       1.151797409387
              std dev =       0.558744944972
             le_variance =       0.312195913532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254063247
                                         uncertainty =       0.002173996757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254063247
                                         uncertainty =       0.002173996757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395092489
  error estimate for blocks of size 2^( 2) =       0.000404898918
  error estimate for blocks of size 2^( 3) =       0.000413299805
  error estimate for blocks of size 2^( 4) =       0.000419254937
  error estimate for blocks of size 2^( 5) =       0.000422632529
  error estimate for blocks of size 2^( 6) =       0.000425880460
  error estimate for blocks of size 2^( 7) =       0.000428313853

      target function =                  N/A
              le_mean =     -17.216672727448
             les_mean =     296.726015797902
             stat err =       0.000424020445
             autocorr =       1.151797276551
              std dev =       0.558745156539
             le_variance =       0.312196149956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254270846
                                         uncertainty =       0.002173998533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312254270846
                                         uncertainty =       0.002173998533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395092620
  error estimate for blocks of size 2^( 2) =       0.000404899050
  error estimate for blocks of size 2^( 3) =       0.000413299933
  error estimate for blocks of size 2^( 4) =       0.000419255067
  error estimate for blocks of size 2^( 5) =       0.000422632651
  error estimate for blocks of size 2^( 6) =       0.000425880573
  error estimate for blocks of size 2^( 7) =       0.000428313967

      target function =                  N/A
              le_mean =     -17.216672725471
             les_mean =     296.726015937283
             stat err =       0.000424020564
             autocorr =       1.151797160047
              std dev =       0.558745342189
             le_variance =       0.312196357418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216672725188        initial
     2.3842e+02     2.3842e+03             6.8015e-07       -17.216672729700  <--
     9.5367e+02     9.5367e+03             1.7016e-07       -17.216672727448
     3.8147e+03     3.8147e+04             4.2548e-08       -17.216672725471

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 5.1873e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.072679e-01 1 1  ON 0
 uu_1                 4.375759e-02 1 1  ON 1
 uu_2                -5.303523e-02 1 1  ON 2
 uu_3                -1.106128e-01 1 1  ON 3
 uu_4                -1.474349e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461035e-01 1 1  ON 6
 uu_7                -9.607299e-02 1 1  ON 7
 uu_8                -1.497744e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605270e-01 1 1  ON 10
 ud_1                 1.008926e-01 1 1  ON 11
 ud_2                -1.075277e-02 1 1  ON 12
 ud_3                -7.384450e-02 1 1  ON 13
 ud_4                -1.239588e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203260e-02 1 1  ON 18
 ud_9                 7.860103e-02 1 1  ON 19
 eO_0                -8.963749e-01 1 1  ON 20
 eO_1                -5.702696e-01 1 1  ON 21
 eO_2                -1.499835e-01 1 1  ON 22
 eO_3                 1.246906e-01 1 1  ON 23
 eO_4                 2.499817e-01 1 1  ON 24
 eO_5                 3.252945e-01 1 1  ON 25
 eO_6                 3.531387e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822617e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.201231e-02 1 1  ON 32
eH1_3                -4.457039e-02 1 1  ON 33
eH1_4                 1.002939e-03 1 1  ON 34
eH1_5                 1.148502e-02 1 1  ON 35
eH1_6                 4.996237e-02 1 1  ON 36
eH1_7                 4.770361e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403852e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238383e-01 1 1  ON 41
eH2_2                -8.190385e-02 1 1  ON 42
eH2_3                -4.440932e-02 1 1  ON 43
eH2_4                 1.131835e-03 1 1  ON 44
eH2_5                 1.162954e-02 1 1  ON 45
eH2_6                 5.353579e-02 1 1  ON 46
eH2_7                 6.390506e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2243
    reference variance = 0.326019
====================================================
  Execution time = 3.3973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2250e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322488223853
                                         uncertainty =       0.004360653853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322488223853
                                         uncertainty =       0.004360653853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401558341
  error estimate for blocks of size 2^( 2) =       0.000411307390
  error estimate for blocks of size 2^( 3) =       0.000419584801
  error estimate for blocks of size 2^( 4) =       0.000426023279
  error estimate for blocks of size 2^( 5) =       0.000429905133
  error estimate for blocks of size 2^( 6) =       0.000432839165
  error estimate for blocks of size 2^( 7) =       0.000434404958

      target function =                  N/A
              le_mean =     -17.216443483157
             les_mean =     296.728424250587
             stat err =       0.000430793134
             autocorr =       1.150907027895
              std dev =       0.567889252493
             le_variance =       0.322498203097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644348316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216443483157       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216443482729       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216443485838       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216443489181       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216443495612       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216443494518       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216443494305       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.481567e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216443483157       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216443483050       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216443483828       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216443484664       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216443486278       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216443486004       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216443485949       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 6.227989e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216443483157       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216443483130       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216443483325       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216443483534       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216443483937       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216443483869       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216443483855       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.558511e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3430e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.072673e-01 1 1  ON 0
 uu_1                 4.375726e-02 1 1  ON 1
 uu_2                -5.303512e-02 1 1  ON 2
 uu_3                -1.106127e-01 1 1  ON 3
 uu_4                -1.474345e-01 1 1  ON 4
 uu_5                -1.594400e-01 1 1  ON 5
 uu_6                -1.461038e-01 1 1  ON 6
 uu_7                -9.607318e-02 1 1  ON 7
 uu_8                -1.497773e-03 1 1  ON 8
 uu_9                 2.066195e-01 1 1  ON 9
 ud_0                 3.605273e-01 1 1  ON 10
 ud_1                 1.008930e-01 1 1  ON 11
 ud_2                -1.075253e-02 1 1  ON 12
 ud_3                -7.384497e-02 1 1  ON 13
 ud_4                -1.239590e-01 1 1  ON 14
 ud_5                -1.594521e-01 1 1  ON 15
 ud_6                -1.699417e-01 1 1  ON 16
 ud_7                -1.425734e-01 1 1  ON 17
 ud_8                -7.203288e-02 1 1  ON 18
 ud_9                 7.860090e-02 1 1  ON 19
 eO_0                -8.963749e-01 1 1  ON 20
 eO_1                -5.702703e-01 1 1  ON 21
 eO_2                -1.499833e-01 1 1  ON 22
 eO_3                 1.246909e-01 1 1  ON 23
 eO_4                 2.499816e-01 1 1  ON 24
 eO_5                 3.252946e-01 1 1  ON 25
 eO_6                 3.531386e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822620e-02 1 1  ON 29
eH1_0                -2.030437e-01 1 1  ON 30
eH1_1                -1.239609e-01 1 1  ON 31
eH1_2                -8.201238e-02 1 1  ON 32
eH1_3                -4.457039e-02 1 1  ON 33
eH1_4                 1.003213e-03 1 1  ON 34
eH1_5                 1.148544e-02 1 1  ON 35
eH1_6                 4.996253e-02 1 1  ON 36
eH1_7                 4.770373e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403856e-02 1 1  ON 39
eH2_0                -2.032222e-01 1 1  ON 40
eH2_1                -1.238386e-01 1 1  ON 41
eH2_2                -8.190405e-02 1 1  ON 42
eH2_3                -4.440951e-02 1 1  ON 43
eH2_4                 1.132148e-03 1 1  ON 44
eH2_5                 1.162965e-02 1 1  ON 45
eH2_6                 5.353596e-02 1 1  ON 46
eH2_7                 6.390516e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.247853
====================================================
  Execution time = 3.3381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1000e-01
  Total weights = 2.0000e+06
  Execution time = 3.1119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052879002
                                         uncertainty =       0.002390882209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052879002
                                         uncertainty =       0.002390882209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393698946
  error estimate for blocks of size 2^( 2) =       0.000403553168
  error estimate for blocks of size 2^( 3) =       0.000412322417
  error estimate for blocks of size 2^( 4) =       0.000418905488
  error estimate for blocks of size 2^( 5) =       0.000422674620
  error estimate for blocks of size 2^( 6) =       0.000424537416
  error estimate for blocks of size 2^( 7) =       0.000429496896

      target function =                  N/A
              le_mean =     -17.217125168331
             les_mean =     296.739396627032
             stat err =       0.000423903605
             autocorr =       1.159326374197
              std dev =       0.556774388841
             le_variance =       0.309997720069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310051531930
                                         uncertainty =       0.002390871889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310051531930
                                         uncertainty =       0.002390871889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393698090
  error estimate for blocks of size 2^( 2) =       0.000403552361
  error estimate for blocks of size 2^( 3) =       0.000412321629
  error estimate for blocks of size 2^( 4) =       0.000418904703
  error estimate for blocks of size 2^( 5) =       0.000422673783
  error estimate for blocks of size 2^( 6) =       0.000424536564
  error estimate for blocks of size 2^( 7) =       0.000429496022

      target function =                  N/A
              le_mean =     -17.217125156128
             les_mean =     296.739394859174
             stat err =       0.000423902768
             autocorr =       1.159326835444
              std dev =       0.556773178578
             le_variance =       0.309996372384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052199931
                                         uncertainty =       0.002390877001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052199931
                                         uncertainty =       0.002390877001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393698515
  error estimate for blocks of size 2^( 2) =       0.000403552761
  error estimate for blocks of size 2^( 3) =       0.000412322020
  error estimate for blocks of size 2^( 4) =       0.000418905093
  error estimate for blocks of size 2^( 5) =       0.000422674198
  error estimate for blocks of size 2^( 6) =       0.000424536987
  error estimate for blocks of size 2^( 7) =       0.000429496456

      target function =                  N/A
              le_mean =     -17.217125162218
             les_mean =     296.739395737167
             stat err =       0.000423903183
             autocorr =       1.159326608034
              std dev =       0.556773778740
             le_variance =       0.309997040692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052793939
                                         uncertainty =       0.002390881556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310052793939
                                         uncertainty =       0.002390881556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393698892
  error estimate for blocks of size 2^( 2) =       0.000403553117
  error estimate for blocks of size 2^( 3) =       0.000412322368
  error estimate for blocks of size 2^( 4) =       0.000418905439
  error estimate for blocks of size 2^( 5) =       0.000422674567
  error estimate for blocks of size 2^( 6) =       0.000424537362
  error estimate for blocks of size 2^( 7) =       0.000429496841

      target function =                  N/A
              le_mean =     -17.217125167565
             les_mean =     296.739396515584
             stat err =       0.000423903552
             autocorr =       1.159326403521
              std dev =       0.556774312418
             le_variance =       0.309997634968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217125168331        initial  <--
     5.9605e+01     5.9605e+02             2.4816e-06       -17.217125156128
     2.3842e+02     2.3842e+03             6.2280e-07       -17.217125162218
     9.5367e+02     9.5367e+03             1.5585e-07       -17.217125167565

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0166
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.072679e-01 1 1  ON 0
 uu_1                 4.375759e-02 1 1  ON 1
 uu_2                -5.303523e-02 1 1  ON 2
 uu_3                -1.106128e-01 1 1  ON 3
 uu_4                -1.474349e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461035e-01 1 1  ON 6
 uu_7                -9.607299e-02 1 1  ON 7
 uu_8                -1.497744e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605270e-01 1 1  ON 10
 ud_1                 1.008926e-01 1 1  ON 11
 ud_2                -1.075277e-02 1 1  ON 12
 ud_3                -7.384450e-02 1 1  ON 13
 ud_4                -1.239588e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203260e-02 1 1  ON 18
 ud_9                 7.860103e-02 1 1  ON 19
 eO_0                -8.963749e-01 1 1  ON 20
 eO_1                -5.702696e-01 1 1  ON 21
 eO_2                -1.499835e-01 1 1  ON 22
 eO_3                 1.246906e-01 1 1  ON 23
 eO_4                 2.499817e-01 1 1  ON 24
 eO_5                 3.252945e-01 1 1  ON 25
 eO_6                 3.531387e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822617e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.201231e-02 1 1  ON 32
eH1_3                -4.457039e-02 1 1  ON 33
eH1_4                 1.002939e-03 1 1  ON 34
eH1_5                 1.148502e-02 1 1  ON 35
eH1_6                 4.996237e-02 1 1  ON 36
eH1_7                 4.770361e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403852e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238383e-01 1 1  ON 41
eH2_2                -8.190385e-02 1 1  ON 42
eH2_3                -4.440932e-02 1 1  ON 43
eH2_4                 1.131835e-03 1 1  ON 44
eH2_5                 1.162954e-02 1 1  ON 45
eH2_6                 5.353579e-02 1 1  ON 46
eH2_7                 6.390506e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.291
    reference variance = 0.280734
====================================================
  Execution time = 3.3954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1960e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319454197069
                                         uncertainty =       0.003422854840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319454197069
                                         uncertainty =       0.003422854840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399749205
  error estimate for blocks of size 2^( 2) =       0.000409466347
  error estimate for blocks of size 2^( 3) =       0.000418125925
  error estimate for blocks of size 2^( 4) =       0.000424226659
  error estimate for blocks of size 2^( 5) =       0.000427752368
  error estimate for blocks of size 2^( 6) =       0.000429469879
  error estimate for blocks of size 2^( 7) =       0.000431582627

      target function =                  N/A
              le_mean =     -17.215956701297
             les_mean =     296.708763835158
             stat err =       0.000428257883
             autocorr =       1.147718849328
              std dev =       0.565330747455
             le_variance =       0.319598854018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595670130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215956701297       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215956701847       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215956701456       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215956702577       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215956702512       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215956702462       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215956702308       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.345852e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215956701297       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215956701435       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215956701337       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215956701616       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215956701601       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215956701590       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215956701550       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 5.865848e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215956701297       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215956701332       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215956701307       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215956701377       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215956701370       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215956701382       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215956701354       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.466538e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.419543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3251e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.072679e-01 1 1  ON 0
 uu_1                 4.375757e-02 1 1  ON 1
 uu_2                -5.303523e-02 1 1  ON 2
 uu_3                -1.106128e-01 1 1  ON 3
 uu_4                -1.474349e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607300e-02 1 1  ON 7
 uu_8                -1.497752e-03 1 1  ON 8
 uu_9                 2.066196e-01 1 1  ON 9
 ud_0                 3.605271e-01 1 1  ON 10
 ud_1                 1.008926e-01 1 1  ON 11
 ud_2                -1.075277e-02 1 1  ON 12
 ud_3                -7.384453e-02 1 1  ON 13
 ud_4                -1.239589e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699419e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203262e-02 1 1  ON 18
 ud_9                 7.860102e-02 1 1  ON 19
 eO_0                -8.963750e-01 1 1  ON 20
 eO_1                -5.702696e-01 1 1  ON 21
 eO_2                -1.499835e-01 1 1  ON 22
 eO_3                 1.246906e-01 1 1  ON 23
 eO_4                 2.499817e-01 1 1  ON 24
 eO_5                 3.252945e-01 1 1  ON 25
 eO_6                 3.531387e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822617e-02 1 1  ON 29
eH1_0                -2.030432e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.201233e-02 1 1  ON 32
eH1_3                -4.457041e-02 1 1  ON 33
eH1_4                 1.002932e-03 1 1  ON 34
eH1_5                 1.148505e-02 1 1  ON 35
eH1_6                 4.996239e-02 1 1  ON 36
eH1_7                 4.770363e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403853e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238384e-01 1 1  ON 41
eH2_2                -8.190387e-02 1 1  ON 42
eH2_3                -4.440932e-02 1 1  ON 43
eH2_4                 1.131871e-03 1 1  ON 44
eH2_5                 1.162959e-02 1 1  ON 45
eH2_6                 5.353578e-02 1 1  ON 46
eH2_7                 6.390505e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.135144
====================================================
  Execution time = 3.3612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1590e-01
  Total weights = 2.0000e+06
  Execution time = 3.0870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986213933
                                         uncertainty =       0.003143061275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986213933
                                         uncertainty =       0.003143061275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397430695
  error estimate for blocks of size 2^( 2) =       0.000407195376
  error estimate for blocks of size 2^( 3) =       0.000415720311
  error estimate for blocks of size 2^( 4) =       0.000421710271
  error estimate for blocks of size 2^( 5) =       0.000425553626
  error estimate for blocks of size 2^( 6) =       0.000426658059
  error estimate for blocks of size 2^( 7) =       0.000427331785

      target function =                  N/A
              le_mean =     -17.217615835551
             les_mean =     296.762197217419
             stat err =       0.000425313435
             autocorr =       1.145237055532
              std dev =       0.562051879067
             le_variance =       0.315902314763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986359824
                                         uncertainty =       0.003143061761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986359824
                                         uncertainty =       0.003143061761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397430787
  error estimate for blocks of size 2^( 2) =       0.000407195463
  error estimate for blocks of size 2^( 3) =       0.000415720394
  error estimate for blocks of size 2^( 4) =       0.000421710350
  error estimate for blocks of size 2^( 5) =       0.000425553702
  error estimate for blocks of size 2^( 6) =       0.000426658133
  error estimate for blocks of size 2^( 7) =       0.000427331853

      target function =                  N/A
              le_mean =     -17.217615836038
             les_mean =     296.762197380050
             stat err =       0.000425313509
             autocorr =       1.145236925185
              std dev =       0.562052008828
             le_variance =       0.315902460628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986286906
                                         uncertainty =       0.003143061518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986286906
                                         uncertainty =       0.003143061518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397430741
  error estimate for blocks of size 2^( 2) =       0.000407195420
  error estimate for blocks of size 2^( 3) =       0.000415720353
  error estimate for blocks of size 2^( 4) =       0.000421710311
  error estimate for blocks of size 2^( 5) =       0.000425553664
  error estimate for blocks of size 2^( 6) =       0.000426658096
  error estimate for blocks of size 2^( 7) =       0.000427331819

      target function =                  N/A
              le_mean =     -17.217615835794
             les_mean =     296.762197298762
             stat err =       0.000425313472
             autocorr =       1.145236990332
              std dev =       0.562051943972
             le_variance =       0.315902387723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986223055
                                         uncertainty =       0.003143061306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315986223055
                                         uncertainty =       0.003143061306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397430701
  error estimate for blocks of size 2^( 2) =       0.000407195381
  error estimate for blocks of size 2^( 3) =       0.000415720316
  error estimate for blocks of size 2^( 4) =       0.000421710276
  error estimate for blocks of size 2^( 5) =       0.000425553630
  error estimate for blocks of size 2^( 6) =       0.000426658064
  error estimate for blocks of size 2^( 7) =       0.000427331790

      target function =                  N/A
              le_mean =     -17.217615835581
             les_mean =     296.762197227587
             stat err =       0.000425313440
             autocorr =       1.145237047383
              std dev =       0.562051887181
             le_variance =       0.315902323883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217615835551        initial
     5.9605e+02     5.9605e+03             2.3459e-07       -17.217615836038  <--
     2.3842e+03     2.3842e+04             5.8658e-08       -17.217615835794
     9.5367e+03     9.5367e+04             1.4665e-08       -17.217615835581

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.9136e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.072679e-01 1 1  ON 0
 uu_1                 4.375748e-02 1 1  ON 1
 uu_2                -5.303523e-02 1 1  ON 2
 uu_3                -1.106127e-01 1 1  ON 3
 uu_4                -1.474349e-01 1 1  ON 4
 uu_5                -1.594405e-01 1 1  ON 5
 uu_6                -1.461036e-01 1 1  ON 6
 uu_7                -9.607302e-02 1 1  ON 7
 uu_8                -1.497777e-03 1 1  ON 8
 uu_9                 2.066195e-01 1 1  ON 9
 ud_0                 3.605272e-01 1 1  ON 10
 ud_1                 1.008927e-01 1 1  ON 11
 ud_2                -1.075278e-02 1 1  ON 12
 ud_3                -7.384462e-02 1 1  ON 13
 ud_4                -1.239590e-01 1 1  ON 14
 ud_5                -1.594517e-01 1 1  ON 15
 ud_6                -1.699418e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203267e-02 1 1  ON 18
 ud_9                 7.860098e-02 1 1  ON 19
 eO_0                -8.963750e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.499835e-01 1 1  ON 22
 eO_3                 1.246906e-01 1 1  ON 23
 eO_4                 2.499818e-01 1 1  ON 24
 eO_5                 3.252945e-01 1 1  ON 25
 eO_6                 3.531386e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822618e-02 1 1  ON 29
eH1_0                -2.030433e-01 1 1  ON 30
eH1_1                -1.239605e-01 1 1  ON 31
eH1_2                -8.201240e-02 1 1  ON 32
eH1_3                -4.457048e-02 1 1  ON 33
eH1_4                 1.002911e-03 1 1  ON 34
eH1_5                 1.148515e-02 1 1  ON 35
eH1_6                 4.996246e-02 1 1  ON 36
eH1_7                 4.770371e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403855e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238385e-01 1 1  ON 41
eH2_2                -8.190392e-02 1 1  ON 42
eH2_3                -4.440934e-02 1 1  ON 43
eH2_4                 1.131980e-03 1 1  ON 44
eH2_5                 1.162972e-02 1 1  ON 45
eH2_6                 5.353572e-02 1 1  ON 46
eH2_7                 6.390503e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2347
    reference variance = 0.324828
====================================================
  Execution time = 3.4085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3512e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335004530859
                                         uncertainty =       0.015093055941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335004530859
                                         uncertainty =       0.015093055941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409343337
  error estimate for blocks of size 2^( 2) =       0.000418398315
  error estimate for blocks of size 2^( 3) =       0.000427030465
  error estimate for blocks of size 2^( 4) =       0.000432636056
  error estimate for blocks of size 2^( 5) =       0.000436756630
  error estimate for blocks of size 2^( 6) =       0.000440494574
  error estimate for blocks of size 2^( 7) =       0.000441382890

      target function =                  N/A
              le_mean =     -17.216237363593
             les_mean =     296.733952726987
             stat err =       0.000437817538
             autocorr =       1.143960047381
              std dev =       0.578898898750
             le_variance =       0.335123934974


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623736359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216237363593       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216237362990       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216237359972       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216237364773       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216237361660       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216237361323       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216237361697       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 8.366402e-07

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216237363593       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216237363442       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216237362687       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216237363888       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216237363108       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216237363023       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216237363117       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.095075e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216237363593       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216237363555       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216237363366       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216237363668       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216237363472       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216237363451       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216237363472       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 5.239865e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.421781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3459e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.072680e-01 1 1  ON 0
 uu_1                 4.375745e-02 1 1  ON 1
 uu_2                -5.303523e-02 1 1  ON 2
 uu_3                -1.106128e-01 1 1  ON 3
 uu_4                -1.474349e-01 1 1  ON 4
 uu_5                -1.594407e-01 1 1  ON 5
 uu_6                -1.461035e-01 1 1  ON 6
 uu_7                -9.607289e-02 1 1  ON 7
 uu_8                -1.497733e-03 1 1  ON 8
 uu_9                 2.066195e-01 1 1  ON 9
 ud_0                 3.605274e-01 1 1  ON 10
 ud_1                 1.008927e-01 1 1  ON 11
 ud_2                -1.075281e-02 1 1  ON 12
 ud_3                -7.384482e-02 1 1  ON 13
 ud_4                -1.239590e-01 1 1  ON 14
 ud_5                -1.594516e-01 1 1  ON 15
 ud_6                -1.699418e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203270e-02 1 1  ON 18
 ud_9                 7.860095e-02 1 1  ON 19
 eO_0                -8.963751e-01 1 1  ON 20
 eO_1                -5.702698e-01 1 1  ON 21
 eO_2                -1.499834e-01 1 1  ON 22
 eO_3                 1.246906e-01 1 1  ON 23
 eO_4                 2.499817e-01 1 1  ON 24
 eO_5                 3.252946e-01 1 1  ON 25
 eO_6                 3.531386e-01 1 1  ON 26
 eO_7                 4.011677e-01 1 1  ON 27
 eO_8                 1.014575e-01 1 1  ON 28
 eO_9                 3.822619e-02 1 1  ON 29
eH1_0                -2.030434e-01 1 1  ON 30
eH1_1                -1.239606e-01 1 1  ON 31
eH1_2                -8.201246e-02 1 1  ON 32
eH1_3                -4.457058e-02 1 1  ON 33
eH1_4                 1.003015e-03 1 1  ON 34
eH1_5                 1.148520e-02 1 1  ON 35
eH1_6                 4.996253e-02 1 1  ON 36
eH1_7                 4.770381e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403857e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238385e-01 1 1  ON 41
eH2_2                -8.190402e-02 1 1  ON 42
eH2_3                -4.440941e-02 1 1  ON 43
eH2_4                 1.131992e-03 1 1  ON 44
eH2_5                 1.162989e-02 1 1  ON 45
eH2_6                 5.353562e-02 1 1  ON 46
eH2_7                 6.390504e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2367
    reference variance = 0.521162
====================================================
  Execution time = 3.3868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2629e-01
  Total weights = 2.0000e+06
  Execution time = 3.0803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146419534
                                         uncertainty =       0.006987706529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146419534
                                         uncertainty =       0.006987706529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403909425
  error estimate for blocks of size 2^( 2) =       0.000413189641
  error estimate for blocks of size 2^( 3) =       0.000421768053
  error estimate for blocks of size 2^( 4) =       0.000427532237
  error estimate for blocks of size 2^( 5) =       0.000430143871
  error estimate for blocks of size 2^( 6) =       0.000430035617
  error estimate for blocks of size 2^( 7) =       0.000432226474

      target function =                  N/A
              le_mean =     -17.216971931535
             les_mean =     296.750407974603
             stat err =       0.000429984550
             autocorr =       1.133281313216
              std dev =       0.571214186185
             le_variance =       0.326285646499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326147161403
                                         uncertainty =       0.006987723828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326147161403
                                         uncertainty =       0.006987723828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403909884
  error estimate for blocks of size 2^( 2) =       0.000413190082
  error estimate for blocks of size 2^( 3) =       0.000421768470
  error estimate for blocks of size 2^( 4) =       0.000427532640
  error estimate for blocks of size 2^( 5) =       0.000430144251
  error estimate for blocks of size 2^( 6) =       0.000430035982
  error estimate for blocks of size 2^( 7) =       0.000432226822

      target function =                  N/A
              le_mean =     -17.216971935029
             les_mean =     296.750408837092
             stat err =       0.000429984924
             autocorr =       1.133280707410
              std dev =       0.571214835825
             le_variance =       0.326286388667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146790833
                                         uncertainty =       0.006987715187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146790833
                                         uncertainty =       0.006987715187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403909654
  error estimate for blocks of size 2^( 2) =       0.000413189862
  error estimate for blocks of size 2^( 3) =       0.000421768262
  error estimate for blocks of size 2^( 4) =       0.000427532439
  error estimate for blocks of size 2^( 5) =       0.000430144061
  error estimate for blocks of size 2^( 6) =       0.000430035800
  error estimate for blocks of size 2^( 7) =       0.000432226648

      target function =                  N/A
              le_mean =     -17.216971933284
             les_mean =     296.750408406288
             stat err =       0.000429984737
             autocorr =       1.133281009956
              std dev =       0.571214511325
             le_variance =       0.326286017948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146465957
                                         uncertainty =       0.006987707612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326146465957
                                         uncertainty =       0.006987707612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403909453
  error estimate for blocks of size 2^( 2) =       0.000413189669
  error estimate for blocks of size 2^( 3) =       0.000421768079
  error estimate for blocks of size 2^( 4) =       0.000427532262
  error estimate for blocks of size 2^( 5) =       0.000430143895
  error estimate for blocks of size 2^( 6) =       0.000430035640
  error estimate for blocks of size 2^( 7) =       0.000432226496

      target function =                  N/A
              le_mean =     -17.216971931753
             les_mean =     296.750408028575
             stat err =       0.000429984573
             autocorr =       1.133281275290
              std dev =       0.571214226837
             le_variance =       0.326285692941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216971931535        initial
     1.4901e+02     1.4901e+03             8.3664e-07       -17.216971935029  <--
     5.9605e+02     5.9605e+03             2.0951e-07       -17.216971933284
     2.3842e+03     2.3842e+04             5.2399e-08       -17.216971931753

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 5.2756e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.072682e-01 1 1  ON 0
 uu_1                 4.375735e-02 1 1  ON 1
 uu_2                -5.303524e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474350e-01 1 1  ON 4
 uu_5                -1.594411e-01 1 1  ON 5
 uu_6                -1.461034e-01 1 1  ON 6
 uu_7                -9.607252e-02 1 1  ON 7
 uu_8                -1.497600e-03 1 1  ON 8
 uu_9                 2.066195e-01 1 1  ON 9
 ud_0                 3.605279e-01 1 1  ON 10
 ud_1                 1.008927e-01 1 1  ON 11
 ud_2                -1.075290e-02 1 1  ON 12
 ud_3                -7.384545e-02 1 1  ON 13
 ud_4                -1.239591e-01 1 1  ON 14
 ud_5                -1.594513e-01 1 1  ON 15
 ud_6                -1.699418e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203278e-02 1 1  ON 18
 ud_9                 7.860084e-02 1 1  ON 19
 eO_0                -8.963753e-01 1 1  ON 20
 eO_1                -5.702702e-01 1 1  ON 21
 eO_2                -1.499830e-01 1 1  ON 22
 eO_3                 1.246908e-01 1 1  ON 23
 eO_4                 2.499815e-01 1 1  ON 24
 eO_5                 3.252946e-01 1 1  ON 25
 eO_6                 3.531386e-01 1 1  ON 26
 eO_7                 4.011679e-01 1 1  ON 27
 eO_8                 1.014576e-01 1 1  ON 28
 eO_9                 3.822621e-02 1 1  ON 29
eH1_0                -2.030437e-01 1 1  ON 30
eH1_1                -1.239610e-01 1 1  ON 31
eH1_2                -8.201264e-02 1 1  ON 32
eH1_3                -4.457088e-02 1 1  ON 33
eH1_4                 1.003324e-03 1 1  ON 34
eH1_5                 1.148537e-02 1 1  ON 35
eH1_6                 4.996273e-02 1 1  ON 36
eH1_7                 4.770414e-02 1 1  ON 37
eH1_8                 2.187657e-01 1 1  ON 38
eH1_9                 8.403862e-02 1 1  ON 39
eH2_0                -2.032221e-01 1 1  ON 40
eH2_1                -1.238384e-01 1 1  ON 41
eH2_2                -8.190434e-02 1 1  ON 42
eH2_3                -4.440962e-02 1 1  ON 43
eH2_4                 1.132029e-03 1 1  ON 44
eH2_5                 1.163038e-02 1 1  ON 45
eH2_6                 5.353531e-02 1 1  ON 46
eH2_7                 6.390509e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152446e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.472008
====================================================
  Execution time = 3.4142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2006e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319945602351
                                         uncertainty =       0.003782645727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319945602351
                                         uncertainty =       0.003782645727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400035041
  error estimate for blocks of size 2^( 2) =       0.000409907529
  error estimate for blocks of size 2^( 3) =       0.000418210362
  error estimate for blocks of size 2^( 4) =       0.000424754355
  error estimate for blocks of size 2^( 5) =       0.000428061286
  error estimate for blocks of size 2^( 6) =       0.000430993321
  error estimate for blocks of size 2^( 7) =       0.000432379281

      target function =                  N/A
              le_mean =     -17.217473778788
             les_mean =     296.761459230682
             stat err =       0.000429047061
             autocorr =       1.150307080501
              std dev =       0.565734979883
             le_variance =       0.320056067464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721747377879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473778788       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473779446       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217473779398       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217473789243       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217473797551       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217473800577       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.238325e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473778788       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473778953       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217473778938       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217473781414       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217473783499       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217473784267       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 8.137636e-07

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217473778788       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217473778829       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217473778825       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217473779445       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217473779967       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217473780160       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.037044e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3483e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.072678e-01 1 1  ON 0
 uu_1                 4.375663e-02 1 1  ON 1
 uu_2                -5.303448e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474346e-01 1 1  ON 4
 uu_5                -1.594413e-01 1 1  ON 5
 uu_6                -1.461032e-01 1 1  ON 6
 uu_7                -9.607235e-02 1 1  ON 7
 uu_8                -1.497692e-03 1 1  ON 8
 uu_9                 2.066193e-01 1 1  ON 9
 ud_0                 3.605278e-01 1 1  ON 10
 ud_1                 1.008928e-01 1 1  ON 11
 ud_2                -1.075273e-02 1 1  ON 12
 ud_3                -7.384540e-02 1 1  ON 13
 ud_4                -1.239593e-01 1 1  ON 14
 ud_5                -1.594513e-01 1 1  ON 15
 ud_6                -1.699416e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203292e-02 1 1  ON 18
 ud_9                 7.860069e-02 1 1  ON 19
 eO_0                -8.963754e-01 1 1  ON 20
 eO_1                -5.702705e-01 1 1  ON 21
 eO_2                -1.499833e-01 1 1  ON 22
 eO_3                 1.246911e-01 1 1  ON 23
 eO_4                 2.499817e-01 1 1  ON 24
 eO_5                 3.252946e-01 1 1  ON 25
 eO_6                 3.531385e-01 1 1  ON 26
 eO_7                 4.011680e-01 1 1  ON 27
 eO_8                 1.014577e-01 1 1  ON 28
 eO_9                 3.822622e-02 1 1  ON 29
eH1_0                -2.030435e-01 1 1  ON 30
eH1_1                -1.239618e-01 1 1  ON 31
eH1_2                -8.201243e-02 1 1  ON 32
eH1_3                -4.457059e-02 1 1  ON 33
eH1_4                 1.003170e-03 1 1  ON 34
eH1_5                 1.148593e-02 1 1  ON 35
eH1_6                 4.996240e-02 1 1  ON 36
eH1_7                 4.770412e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403865e-02 1 1  ON 39
eH2_0                -2.032220e-01 1 1  ON 40
eH2_1                -1.238384e-01 1 1  ON 41
eH2_2                -8.190479e-02 1 1  ON 42
eH2_3                -4.440926e-02 1 1  ON 43
eH2_4                 1.132064e-03 1 1  ON 44
eH2_5                 1.163035e-02 1 1  ON 45
eH2_6                 5.353534e-02 1 1  ON 46
eH2_7                 6.390514e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2526
    reference variance = 0.231211
====================================================
  Execution time = 3.3608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1386e-01
  Total weights = 2.0000e+06
  Execution time = 3.0815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313853537024
                                         uncertainty =       0.002550357171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313853537024
                                         uncertainty =       0.002550357171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396146913
  error estimate for blocks of size 2^( 2) =       0.000405718093
  error estimate for blocks of size 2^( 3) =       0.000413596231
  error estimate for blocks of size 2^( 4) =       0.000419459831
  error estimate for blocks of size 2^( 5) =       0.000422864854
  error estimate for blocks of size 2^( 6) =       0.000423639645
  error estimate for blocks of size 2^( 7) =       0.000425388783

      target function =                  N/A
              le_mean =     -17.217141877928
             les_mean =     296.743839041796
             stat err =       0.000422838278
             autocorr =       1.139294599273
              std dev =       0.560236337666
             le_variance =       0.313864754041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313851042063
                                         uncertainty =       0.002550336203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313851042063
                                         uncertainty =       0.002550336203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396145339
  error estimate for blocks of size 2^( 2) =       0.000405716571
  error estimate for blocks of size 2^( 3) =       0.000413594743
  error estimate for blocks of size 2^( 4) =       0.000419458397
  error estimate for blocks of size 2^( 5) =       0.000422863395
  error estimate for blocks of size 2^( 6) =       0.000423638232
  error estimate for blocks of size 2^( 7) =       0.000425387362

      target function =                  N/A
              le_mean =     -17.217141879000
             les_mean =     296.743836583424
             stat err =       0.000422836846
             autocorr =       1.139295940420
              std dev =       0.560234110660
             le_variance =       0.313862258747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313852278575
                                         uncertainty =       0.002550346633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313852278575
                                         uncertainty =       0.002550346633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396146119
  error estimate for blocks of size 2^( 2) =       0.000405717325
  error estimate for blocks of size 2^( 3) =       0.000413595480
  error estimate for blocks of size 2^( 4) =       0.000419459107
  error estimate for blocks of size 2^( 5) =       0.000422864118
  error estimate for blocks of size 2^( 6) =       0.000423638933
  error estimate for blocks of size 2^( 7) =       0.000425388067

      target function =                  N/A
              le_mean =     -17.217141878466
             les_mean =     296.743837801709
             stat err =       0.000422837556
             autocorr =       1.139295276700
              std dev =       0.560235214374
             le_variance =       0.313863495425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313853379356
                                         uncertainty =       0.002550355852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313853379356
                                         uncertainty =       0.002550355852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396146814
  error estimate for blocks of size 2^( 2) =       0.000405717997
  error estimate for blocks of size 2^( 3) =       0.000413596137
  error estimate for blocks of size 2^( 4) =       0.000419459740
  error estimate for blocks of size 2^( 5) =       0.000422864761
  error estimate for blocks of size 2^( 6) =       0.000423639556
  error estimate for blocks of size 2^( 7) =       0.000425388694

      target function =                  N/A
              le_mean =     -17.217141877993
             les_mean =     296.743838886358
             stat err =       0.000422838188
             autocorr =       1.139294684171
              std dev =       0.560236196931
             le_variance =       0.313864596352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217141877928        initial
     3.7253e+01     3.7253e+02             3.2383e-06       -17.217141879000  <--
     1.4901e+02     1.4901e+03             8.1376e-07       -17.217141878466
     5.9605e+02     5.9605e+03             2.0370e-07       -17.217141877993

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 4.9139e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.375452e-02 1 1  ON 1
 uu_2                -5.303223e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474334e-01 1 1  ON 4
 uu_5                -1.594421e-01 1 1  ON 5
 uu_6                -1.461026e-01 1 1  ON 6
 uu_7                -9.607185e-02 1 1  ON 7
 uu_8                -1.497965e-03 1 1  ON 8
 uu_9                 2.066188e-01 1 1  ON 9
 ud_0                 3.605275e-01 1 1  ON 10
 ud_1                 1.008931e-01 1 1  ON 11
 ud_2                -1.075221e-02 1 1  ON 12
 ud_3                -7.384526e-02 1 1  ON 13
 ud_4                -1.239600e-01 1 1  ON 14
 ud_5                -1.594514e-01 1 1  ON 15
 ud_6                -1.699408e-01 1 1  ON 16
 ud_7                -1.425735e-01 1 1  ON 17
 ud_8                -7.203334e-02 1 1  ON 18
 ud_9                 7.860022e-02 1 1  ON 19
 eO_0                -8.963756e-01 1 1  ON 20
 eO_1                -5.702714e-01 1 1  ON 21
 eO_2                -1.499844e-01 1 1  ON 22
 eO_3                 1.246920e-01 1 1  ON 23
 eO_4                 2.499823e-01 1 1  ON 24
 eO_5                 3.252947e-01 1 1  ON 25
 eO_6                 3.531383e-01 1 1  ON 26
 eO_7                 4.011684e-01 1 1  ON 27
 eO_8                 1.014581e-01 1 1  ON 28
 eO_9                 3.822625e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239642e-01 1 1  ON 31
eH1_2                -8.201183e-02 1 1  ON 32
eH1_3                -4.456972e-02 1 1  ON 33
eH1_4                 1.002713e-03 1 1  ON 34
eH1_5                 1.148762e-02 1 1  ON 35
eH1_6                 4.996144e-02 1 1  ON 36
eH1_7                 4.770408e-02 1 1  ON 37
eH1_8                 2.187656e-01 1 1  ON 38
eH1_9                 8.403876e-02 1 1  ON 39
eH2_0                -2.032217e-01 1 1  ON 40
eH2_1                -1.238386e-01 1 1  ON 41
eH2_2                -8.190612e-02 1 1  ON 42
eH2_3                -4.440820e-02 1 1  ON 43
eH2_4                 1.132172e-03 1 1  ON 44
eH2_5                 1.163026e-02 1 1  ON 45
eH2_6                 5.353541e-02 1 1  ON 46
eH2_7                 6.390529e-02 1 1  ON 47
eH2_8                 2.111434e-01 1 1  ON 48
eH2_9                 8.152455e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1833
    reference variance = 1.00663
====================================================
  Execution time = 4.1032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1750e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317433908415
                                         uncertainty =       0.003114972441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317433908415
                                         uncertainty =       0.003114972441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398435968
  error estimate for blocks of size 2^( 2) =       0.000408121324
  error estimate for blocks of size 2^( 3) =       0.000416424714
  error estimate for blocks of size 2^( 4) =       0.000422262004
  error estimate for blocks of size 2^( 5) =       0.000426531995
  error estimate for blocks of size 2^( 6) =       0.000428718678
  error estimate for blocks of size 2^( 7) =       0.000431173941

      target function =                  N/A
              le_mean =     -17.217245591441
             les_mean =     296.751048038320
             stat err =       0.000427171655
             autocorr =       1.149443903373
              std dev =       0.563473549581
             le_variance =       0.317502441077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724559144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217245591441       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217245615257       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217245708504       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217245721316       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217245706376       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217245706751       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.139484e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217245591441       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217245597485       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217245621259       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217245624702       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217245620822       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217245620870       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.446605e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217245591441       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217245592958       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217245598931       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217245599808       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217245598828       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217245598837       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.367969e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0358e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.375143e-02 1 1  ON 1
 uu_2                -5.303058e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474307e-01 1 1  ON 4
 uu_5                -1.594425e-01 1 1  ON 5
 uu_6                -1.461042e-01 1 1  ON 6
 uu_7                -9.607161e-02 1 1  ON 7
 uu_8                -1.497927e-03 1 1  ON 8
 uu_9                 2.066185e-01 1 1  ON 9
 ud_0                 3.605266e-01 1 1  ON 10
 ud_1                 1.008955e-01 1 1  ON 11
 ud_2                -1.075272e-02 1 1  ON 12
 ud_3                -7.384449e-02 1 1  ON 13
 ud_4                -1.239619e-01 1 1  ON 14
 ud_5                -1.594536e-01 1 1  ON 15
 ud_6                -1.699395e-01 1 1  ON 16
 ud_7                -1.425718e-01 1 1  ON 17
 ud_8                -7.203385e-02 1 1  ON 18
 ud_9                 7.859959e-02 1 1  ON 19
 eO_0                -8.963764e-01 1 1  ON 20
 eO_1                -5.702697e-01 1 1  ON 21
 eO_2                -1.499876e-01 1 1  ON 22
 eO_3                 1.246930e-01 1 1  ON 23
 eO_4                 2.499825e-01 1 1  ON 24
 eO_5                 3.252950e-01 1 1  ON 25
 eO_6                 3.531381e-01 1 1  ON 26
 eO_7                 4.011691e-01 1 1  ON 27
 eO_8                 1.014585e-01 1 1  ON 28
 eO_9                 3.822631e-02 1 1  ON 29
eH1_0                -2.030428e-01 1 1  ON 30
eH1_1                -1.239667e-01 1 1  ON 31
eH1_2                -8.201189e-02 1 1  ON 32
eH1_3                -4.457052e-02 1 1  ON 33
eH1_4                 1.005707e-03 1 1  ON 34
eH1_5                 1.148619e-02 1 1  ON 35
eH1_6                 4.996154e-02 1 1  ON 36
eH1_7                 4.770528e-02 1 1  ON 37
eH1_8                 2.187658e-01 1 1  ON 38
eH1_9                 8.403898e-02 1 1  ON 39
eH2_0                -2.032196e-01 1 1  ON 40
eH2_1                -1.238402e-01 1 1  ON 41
eH2_2                -8.191156e-02 1 1  ON 42
eH2_3                -4.440910e-02 1 1  ON 43
eH2_4                 1.135130e-03 1 1  ON 44
eH2_5                 1.163301e-02 1 1  ON 45
eH2_6                 5.353501e-02 1 1  ON 46
eH2_7                 6.390546e-02 1 1  ON 47
eH2_8                 2.111435e-01 1 1  ON 48
eH2_9                 8.152465e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1962
    reference variance = 0.197495
====================================================
  Execution time = 3.3356e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4363e-01
  Total weights = 2.0000e+06
  Execution time = 3.0813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710471450
                                         uncertainty =       0.025749826266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710471450
                                         uncertainty =       0.025749826266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414504608
  error estimate for blocks of size 2^( 2) =       0.000423270073
  error estimate for blocks of size 2^( 3) =       0.000431141279
  error estimate for blocks of size 2^( 4) =       0.000436831565
  error estimate for blocks of size 2^( 5) =       0.000440478992
  error estimate for blocks of size 2^( 6) =       0.000442325671
  error estimate for blocks of size 2^( 7) =       0.000444006622

      target function =                  N/A
              le_mean =     -17.216830534425
             les_mean =     296.762881618639
             stat err =       0.000440910712
             autocorr =       1.131468782756
              std dev =       0.586198037658
             le_variance =       0.343628139355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343705952563
                                         uncertainty =       0.025750764519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343705952563
                                         uncertainty =       0.025750764519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414501886
  error estimate for blocks of size 2^( 2) =       0.000423267370
  error estimate for blocks of size 2^( 3) =       0.000431138627
  error estimate for blocks of size 2^( 4) =       0.000436828874
  error estimate for blocks of size 2^( 5) =       0.000440476133
  error estimate for blocks of size 2^( 6) =       0.000442322782
  error estimate for blocks of size 2^( 7) =       0.000444003367

      target function =                  N/A
              le_mean =     -17.216830563301
             les_mean =     296.762878099855
             stat err =       0.000440907789
             autocorr =       1.131468640036
              std dev =       0.586194188173
             le_variance =       0.343623626247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343708083832
                                         uncertainty =       0.025750307456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343708083832
                                         uncertainty =       0.025750307456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414503169
  error estimate for blocks of size 2^( 2) =       0.000423268644
  error estimate for blocks of size 2^( 3) =       0.000431139877
  error estimate for blocks of size 2^( 4) =       0.000436830143
  error estimate for blocks of size 2^( 5) =       0.000440477483
  error estimate for blocks of size 2^( 6) =       0.000442324150
  error estimate for blocks of size 2^( 7) =       0.000444004912

      target function =                  N/A
              le_mean =     -17.216830549193
             les_mean =     296.762879742521
             stat err =       0.000440909172
             autocorr =       1.131468728749
              std dev =       0.586196003656
             le_variance =       0.343625754703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710168555
                                         uncertainty =       0.025749886820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343710168555
                                         uncertainty =       0.025749886820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414504425
  error estimate for blocks of size 2^( 2) =       0.000423269892
  error estimate for blocks of size 2^( 3) =       0.000431141101
  error estimate for blocks of size 2^( 4) =       0.000436831384
  error estimate for blocks of size 2^( 5) =       0.000440478800
  error estimate for blocks of size 2^( 6) =       0.000442325478
  error estimate for blocks of size 2^( 7) =       0.000444006405

      target function =                  N/A
              le_mean =     -17.216830536250
             les_mean =     296.762881378971
             stat err =       0.000440910517
             autocorr =       1.131468776438
              std dev =       0.586197779621
             le_variance =       0.343627836833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216830534425        initial
     9.3132e+00     9.3132e+01             2.1395e-05       -17.216830563301  <--
     3.7253e+01     3.7253e+02             5.4466e-06       -17.216830549193
     1.4901e+02     1.4901e+03             1.3680e-06       -17.216830536250

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.8878e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.072669e-01 1 1  ON 0
 uu_1                 4.374255e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497817e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203535e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201214e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014570e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996184e-02 1 1  ON 36
eH1_7                 4.770883e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192751e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.143929e-03 1 1  ON 44
eH2_5                 1.164120e-02 1 1  ON 45
eH2_6                 5.353382e-02 1 1  ON 46
eH2_7                 6.390598e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.9254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.224816
====================================================
  Execution time = 3.4222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321422351549
                                         uncertainty =       0.003631505816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321422351549
                                         uncertainty =       0.003631505816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400882166
  error estimate for blocks of size 2^( 2) =       0.000410217297
  error estimate for blocks of size 2^( 3) =       0.000418455426
  error estimate for blocks of size 2^( 4) =       0.000424161116
  error estimate for blocks of size 2^( 5) =       0.000427714229
  error estimate for blocks of size 2^( 6) =       0.000429481486
  error estimate for blocks of size 2^( 7) =       0.000432120326

      target function =                  N/A
              le_mean =     -17.216690191540
             les_mean =     296.735834012914
             stat err =       0.000428369289
             autocorr =       1.141834556701
              std dev =       0.566932996185
             le_variance =       0.321413022163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669019154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690191540       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690309724       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690224465       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690513481       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690539023       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690546341       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216690550170       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 5.369094e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690191540       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690222464       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690198684       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690275587       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690292238       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690295127       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.314213e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690191540       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690199362       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690193243       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690212780       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690217729       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690218548       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.374789e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3631e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.072631e-01 1 1  ON 0
 uu_1                 4.374211e-02 1 1  ON 1
 uu_2                -5.301923e-02 1 1  ON 2
 uu_3                -1.106140e-01 1 1  ON 3
 uu_4                -1.474099e-01 1 1  ON 4
 uu_5                -1.594464e-01 1 1  ON 5
 uu_6                -1.461220e-01 1 1  ON 6
 uu_7                -9.607144e-02 1 1  ON 7
 uu_8                -1.498900e-03 1 1  ON 8
 uu_9                 2.066170e-01 1 1  ON 9
 ud_0                 3.605354e-01 1 1  ON 10
 ud_1                 1.008983e-01 1 1  ON 11
 ud_2                -1.075931e-02 1 1  ON 12
 ud_3                -7.384661e-02 1 1  ON 13
 ud_4                -1.239766e-01 1 1  ON 14
 ud_5                -1.594546e-01 1 1  ON 15
 ud_6                -1.699269e-01 1 1  ON 16
 ud_7                -1.425641e-01 1 1  ON 17
 ud_8                -7.204159e-02 1 1  ON 18
 ud_9                 7.859551e-02 1 1  ON 19
 eO_0                -8.963765e-01 1 1  ON 20
 eO_1                -5.702738e-01 1 1  ON 21
 eO_2                -1.500021e-01 1 1  ON 22
 eO_3                 1.246982e-01 1 1  ON 23
 eO_4                 2.499881e-01 1 1  ON 24
 eO_5                 3.252992e-01 1 1  ON 25
 eO_6                 3.531341e-01 1 1  ON 26
 eO_7                 4.011727e-01 1 1  ON 27
 eO_8                 1.014610e-01 1 1  ON 28
 eO_9                 3.822706e-02 1 1  ON 29
eH1_0                -2.030467e-01 1 1  ON 30
eH1_1                -1.239730e-01 1 1  ON 31
eH1_2                -8.201781e-02 1 1  ON 32
eH1_3                -4.456681e-02 1 1  ON 33
eH1_4                 1.025831e-03 1 1  ON 34
eH1_5                 1.147488e-02 1 1  ON 35
eH1_6                 4.995863e-02 1 1  ON 36
eH1_7                 4.770944e-02 1 1  ON 37
eH1_8                 2.187655e-01 1 1  ON 38
eH1_9                 8.404052e-02 1 1  ON 39
eH2_0                -2.032110e-01 1 1  ON 40
eH2_1                -1.238514e-01 1 1  ON 41
eH2_2                -8.192060e-02 1 1  ON 42
eH2_3                -4.440690e-02 1 1  ON 43
eH2_4                 1.143666e-03 1 1  ON 44
eH2_5                 1.164241e-02 1 1  ON 45
eH2_6                 5.352487e-02 1 1  ON 46
eH2_7                 6.390546e-02 1 1  ON 47
eH2_8                 2.111441e-01 1 1  ON 48
eH2_9                 8.152516e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.220947
====================================================
  Execution time = 3.3795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1588e-01
  Total weights = 2.0000e+06
  Execution time = 3.1062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315855380846
                                         uncertainty =       0.003370607981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315855380846
                                         uncertainty =       0.003370607981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397410785
  error estimate for blocks of size 2^( 2) =       0.000407065609
  error estimate for blocks of size 2^( 3) =       0.000415393307
  error estimate for blocks of size 2^( 4) =       0.000421172380
  error estimate for blocks of size 2^( 5) =       0.000425095538
  error estimate for blocks of size 2^( 6) =       0.000428114883
  error estimate for blocks of size 2^( 7) =       0.000428104517

      target function =                  N/A
              le_mean =     -17.217302177793
             les_mean =     296.751364787993
             stat err =       0.000425621830
             autocorr =       1.147013396512
              std dev =       0.562023722365
             le_variance =       0.315870664501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315883848500
                                         uncertainty =       0.003370948924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315883848500
                                         uncertainty =       0.003370948924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397428695
  error estimate for blocks of size 2^( 2) =       0.000407082568
  error estimate for blocks of size 2^( 3) =       0.000415409831
  error estimate for blocks of size 2^( 4) =       0.000421188884
  error estimate for blocks of size 2^( 5) =       0.000425111927
  error estimate for blocks of size 2^( 6) =       0.000428130381
  error estimate for blocks of size 2^( 7) =       0.000428119838

      target function =                  N/A
              le_mean =     -17.217302081903
             les_mean =     296.751389957557
             stat err =       0.000425637758
             autocorr =       1.146995860763
              std dev =       0.562049051246
             le_variance =       0.315899136006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315872534160
                                         uncertainty =       0.003370801065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315872534160
                                         uncertainty =       0.003370801065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397421575
  error estimate for blocks of size 2^( 2) =       0.000407075803
  error estimate for blocks of size 2^( 3) =       0.000415403230
  error estimate for blocks of size 2^( 4) =       0.000421182232
  error estimate for blocks of size 2^( 5) =       0.000425105320
  error estimate for blocks of size 2^( 6) =       0.000428124164
  error estimate for blocks of size 2^( 7) =       0.000428113714

      target function =                  N/A
              le_mean =     -17.217302098161
             les_mean =     296.751379198324
             stat err =       0.000425631357
             autocorr =       1.147002464632
              std dev =       0.562038981694
             le_variance =       0.315887816943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315857593970
                                         uncertainty =       0.003370632906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315857593970
                                         uncertainty =       0.003370632906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397412177
  error estimate for blocks of size 2^( 2) =       0.000407066924
  error estimate for blocks of size 2^( 3) =       0.000415394587
  error estimate for blocks of size 2^( 4) =       0.000421173651
  error estimate for blocks of size 2^( 5) =       0.000425096799
  error estimate for blocks of size 2^( 6) =       0.000428116079
  error estimate for blocks of size 2^( 7) =       0.000428105703

      target function =                  N/A
              le_mean =     -17.217302166859
             les_mean =     296.751366624480
             stat err =       0.000425623058
             autocorr =       1.147011981921
              std dev =       0.562025691134
             le_variance =       0.315872877494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217302177793        initial  <--
     2.3283e+00     2.3283e+01             5.3691e-05       -17.217302081903
     9.3132e+00     9.3132e+01             1.3142e-05       -17.217302098161
     3.7253e+01     3.7253e+02             3.3748e-06       -17.217302166859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4317
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.072669e-01 1 1  ON 0
 uu_1                 4.374255e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497817e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203535e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201214e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014570e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996184e-02 1 1  ON 36
eH1_7                 4.770883e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192751e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.143929e-03 1 1  ON 44
eH2_5                 1.164120e-02 1 1  ON 45
eH2_6                 5.353382e-02 1 1  ON 46
eH2_7                 6.390598e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.196402
====================================================
  Execution time = 3.6727e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1543e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315485858787
                                         uncertainty =       0.002435858660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315485858787
                                         uncertainty =       0.002435858660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397135647
  error estimate for blocks of size 2^( 2) =       0.000406944585
  error estimate for blocks of size 2^( 3) =       0.000416067202
  error estimate for blocks of size 2^( 4) =       0.000421667065
  error estimate for blocks of size 2^( 5) =       0.000426447817
  error estimate for blocks of size 2^( 6) =       0.000427903091
  error estimate for blocks of size 2^( 7) =       0.000430128023

      target function =                  N/A
              le_mean =     -17.216592245064
             les_mean =     296.726481819406
             stat err =       0.000426536499
             autocorr =       1.153545308047
              std dev =       0.561634618177
             le_variance =       0.315433444335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659224506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592245064       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592235451       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216592238406       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592229076       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592241305       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216592243323       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216592245480       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.127552e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592245064       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592242638       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216592243385       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592241028       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592244158       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216592244654       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.220042e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216592245064       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216592244456       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216592244643       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216592244052       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216592244841       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216592244964       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 3.056114e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.429585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6245e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.072667e-01 1 1  ON 0
 uu_1                 4.374255e-02 1 1  ON 1
 uu_2                -5.302546e-02 1 1  ON 2
 uu_3                -1.106138e-01 1 1  ON 3
 uu_4                -1.474225e-01 1 1  ON 4
 uu_5                -1.594436e-01 1 1  ON 5
 uu_6                -1.461095e-01 1 1  ON 6
 uu_7                -9.607093e-02 1 1  ON 7
 uu_8                -1.498041e-03 1 1  ON 8
 uu_9                 2.066175e-01 1 1  ON 9
 ud_0                 3.605243e-01 1 1  ON 10
 ud_1                 1.009027e-01 1 1  ON 11
 ud_2                -1.075319e-02 1 1  ON 12
 ud_3                -7.384275e-02 1 1  ON 13
 ud_4                -1.239672e-01 1 1  ON 14
 ud_5                -1.594607e-01 1 1  ON 15
 ud_6                -1.699357e-01 1 1  ON 16
 ud_7                -1.425672e-01 1 1  ON 17
 ud_8                -7.203585e-02 1 1  ON 18
 ud_9                 7.859743e-02 1 1  ON 19
 eO_0                -8.963801e-01 1 1  ON 20
 eO_1                -5.702648e-01 1 1  ON 21
 eO_2                -1.499964e-01 1 1  ON 22
 eO_3                 1.246963e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531371e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014599e-01 1 1  ON 28
 eO_9                 3.822651e-02 1 1  ON 29
eH1_0                -2.030422e-01 1 1  ON 30
eH1_1                -1.239746e-01 1 1  ON 31
eH1_2                -8.201239e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014942e-03 1 1  ON 34
eH1_5                 1.148221e-02 1 1  ON 35
eH1_6                 4.996132e-02 1 1  ON 36
eH1_7                 4.770868e-02 1 1  ON 37
eH1_8                 2.187663e-01 1 1  ON 38
eH1_9                 8.403976e-02 1 1  ON 39
eH2_0                -2.032128e-01 1 1  ON 40
eH2_1                -1.238452e-01 1 1  ON 41
eH2_2                -8.192822e-02 1 1  ON 42
eH2_3                -4.441276e-02 1 1  ON 43
eH2_4                 1.144477e-03 1 1  ON 44
eH2_5                 1.164190e-02 1 1  ON 45
eH2_6                 5.353375e-02 1 1  ON 46
eH2_7                 6.390608e-02 1 1  ON 47
eH2_8                 2.111437e-01 1 1  ON 48
eH2_9                 8.152493e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2793
    reference variance = 0.268837
====================================================
  Execution time = 3.3196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2702e-01
  Total weights = 2.0000e+06
  Execution time = 3.0677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103650001
                                         uncertainty =       0.006907177130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103650001
                                         uncertainty =       0.006907177130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404363557
  error estimate for blocks of size 2^( 2) =       0.000413503785
  error estimate for blocks of size 2^( 3) =       0.000421489690
  error estimate for blocks of size 2^( 4) =       0.000427329274
  error estimate for blocks of size 2^( 5) =       0.000431097568
  error estimate for blocks of size 2^( 6) =       0.000433283939
  error estimate for blocks of size 2^( 7) =       0.000434050343

      target function =                  N/A
              le_mean =     -17.215754227850
             les_mean =     296.709213243131
             stat err =       0.000431440281
             autocorr =       1.138406491368
              std dev =       0.571856426830
             le_variance =       0.327019772906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103174860
                                         uncertainty =       0.006907290779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103174860
                                         uncertainty =       0.006907290779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404363264
  error estimate for blocks of size 2^( 2) =       0.000413503549
  error estimate for blocks of size 2^( 3) =       0.000421489460
  error estimate for blocks of size 2^( 4) =       0.000427329004
  error estimate for blocks of size 2^( 5) =       0.000431097239
  error estimate for blocks of size 2^( 6) =       0.000433283591
  error estimate for blocks of size 2^( 7) =       0.000434049873

      target function =                  N/A
              le_mean =     -17.215754198241
             les_mean =     296.709211749783
             stat err =       0.000431439927
             autocorr =       1.138406270707
              std dev =       0.571856012513
             le_variance =       0.327019299048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103284629
                                         uncertainty =       0.006907231202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103284629
                                         uncertainty =       0.006907231202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404363332
  error estimate for blocks of size 2^( 2) =       0.000413503594
  error estimate for blocks of size 2^( 3) =       0.000421489507
  error estimate for blocks of size 2^( 4) =       0.000427329073
  error estimate for blocks of size 2^( 5) =       0.000431097335
  error estimate for blocks of size 2^( 6) =       0.000433283697
  error estimate for blocks of size 2^( 7) =       0.000434050043

      target function =                  N/A
              le_mean =     -17.215754212337
             les_mean =     296.709212344347
             stat err =       0.000431440037
             autocorr =       1.138406473896
              std dev =       0.571856107990
             le_variance =       0.327019408246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103603567
                                         uncertainty =       0.006907183890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327103603567
                                         uncertainty =       0.006907183890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404363529
  error estimate for blocks of size 2^( 2) =       0.000413503761
  error estimate for blocks of size 2^( 3) =       0.000421489667
  error estimate for blocks of size 2^( 4) =       0.000427329249
  error estimate for blocks of size 2^( 5) =       0.000431097538
  error estimate for blocks of size 2^( 6) =       0.000433283908
  error estimate for blocks of size 2^( 7) =       0.000434050305

      target function =                  N/A
              le_mean =     -17.215754225896
             les_mean =     296.709213129504
             stat err =       0.000431440250
             autocorr =       1.138406489619
              std dev =       0.571856386308
             le_variance =       0.327019726562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215754227850        initial  <--
     2.3283e+01     2.3283e+02             5.1276e-06       -17.215754198241
     9.3132e+01     9.3132e+02             1.2200e-06       -17.215754212337
     3.7253e+02     3.7253e+03             3.0561e-07       -17.215754225896

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.6806
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.072669e-01 1 1  ON 0
 uu_1                 4.374255e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497817e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203535e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201214e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014570e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996184e-02 1 1  ON 36
eH1_7                 4.770883e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192751e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.143929e-03 1 1  ON 44
eH2_5                 1.164120e-02 1 1  ON 45
eH2_6                 5.353382e-02 1 1  ON 46
eH2_7                 6.390598e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1595
    reference variance = 0.261597
====================================================
  Execution time = 3.3748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2402e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324059344775
                                         uncertainty =       0.005110273197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324059344775
                                         uncertainty =       0.005110273197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402507818
  error estimate for blocks of size 2^( 2) =       0.000412152830
  error estimate for blocks of size 2^( 3) =       0.000420783897
  error estimate for blocks of size 2^( 4) =       0.000426604593
  error estimate for blocks of size 2^( 5) =       0.000432200067
  error estimate for blocks of size 2^( 6) =       0.000434079512
  error estimate for blocks of size 2^( 7) =       0.000435630735

      target function =                  N/A
              le_mean =     -17.217546084116
             les_mean =     296.767918083524
             stat err =       0.000432128727
             autocorr =       1.152597400459
              std dev =       0.569232014982
             le_variance =       0.324025086881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721754608412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217546084116       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217546087410       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217546088596       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217546089274       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217546089621       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217546089050       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.415480e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217546084116       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217546084940       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217546085237       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217546085406       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217546085493       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217546085351       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.855701e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217546084116       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217546084322       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217546084396       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217546084437       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217546084460       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217546084430       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 4.640398e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3144e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.072667e-01 1 1  ON 0
 uu_1                 4.374261e-02 1 1  ON 1
 uu_2                -5.302582e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594438e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497854e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605240e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075395e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594602e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203544e-02 1 1  ON 18
 ud_9                 7.859767e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201221e-02 1 1  ON 32
eH1_3                -4.457284e-02 1 1  ON 33
eH1_4                 1.014628e-03 1 1  ON 34
eH1_5                 1.148191e-02 1 1  ON 35
eH1_6                 4.996183e-02 1 1  ON 36
eH1_7                 4.770886e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403965e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238449e-01 1 1  ON 41
eH2_2                -8.192760e-02 1 1  ON 42
eH2_3                -4.441190e-02 1 1  ON 43
eH2_4                 1.143959e-03 1 1  ON 44
eH2_5                 1.164125e-02 1 1  ON 45
eH2_6                 5.353377e-02 1 1  ON 46
eH2_7                 6.390596e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.451189
====================================================
  Execution time = 3.3606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.0000e+06
  Execution time = 3.0584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236941990
                                         uncertainty =       0.020880202481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236941990
                                         uncertainty =       0.020880202481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916984
  error estimate for blocks of size 2^( 2) =       0.000421396129
  error estimate for blocks of size 2^( 3) =       0.000429802270
  error estimate for blocks of size 2^( 4) =       0.000435818148
  error estimate for blocks of size 2^( 5) =       0.000440629045
  error estimate for blocks of size 2^( 6) =       0.000443410447
  error estimate for blocks of size 2^( 7) =       0.000444496009

      target function =                  N/A
              le_mean =     -17.216529488677
             les_mean =     296.748238667959
             stat err =       0.000441088412
             autocorr =       1.146652705665
              std dev =       0.582538585111
             le_variance =       0.339351203144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236175585
                                         uncertainty =       0.020880130635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236175585
                                         uncertainty =       0.020880130635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916519
  error estimate for blocks of size 2^( 2) =       0.000421395684
  error estimate for blocks of size 2^( 3) =       0.000429801835
  error estimate for blocks of size 2^( 4) =       0.000435817722
  error estimate for blocks of size 2^( 5) =       0.000440628628
  error estimate for blocks of size 2^( 6) =       0.000443410040
  error estimate for blocks of size 2^( 7) =       0.000444495587

      target function =                  N/A
              le_mean =     -17.216529477776
             les_mean =     296.748237526196
             stat err =       0.000441087994
             autocorr =       1.146653120489
              std dev =       0.582537927303
             le_variance =       0.339350436746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236558186
                                         uncertainty =       0.020880166450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236558186
                                         uncertainty =       0.020880166450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916751
  error estimate for blocks of size 2^( 2) =       0.000421395906
  error estimate for blocks of size 2^( 3) =       0.000429802052
  error estimate for blocks of size 2^( 4) =       0.000435817935
  error estimate for blocks of size 2^( 5) =       0.000440628836
  error estimate for blocks of size 2^( 6) =       0.000443410243
  error estimate for blocks of size 2^( 7) =       0.000444495798

      target function =                  N/A
              le_mean =     -17.216529483214
             les_mean =     296.748238096040
             stat err =       0.000441088203
             autocorr =       1.146652913445
              std dev =       0.582538255691
             le_variance =       0.339350819344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236893995
                                         uncertainty =       0.020880197973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236893995
                                         uncertainty =       0.020880197973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916955
  error estimate for blocks of size 2^( 2) =       0.000421396101
  error estimate for blocks of size 2^( 3) =       0.000429802243
  error estimate for blocks of size 2^( 4) =       0.000435818121
  error estimate for blocks of size 2^( 5) =       0.000440629019
  error estimate for blocks of size 2^( 6) =       0.000443410422
  error estimate for blocks of size 2^( 7) =       0.000444495983

      target function =                  N/A
              le_mean =     -17.216529487994
             les_mean =     296.748238596434
             stat err =       0.000441088386
             autocorr =       1.146652731649
              std dev =       0.582538543917
             le_variance =       0.339351155149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216529488677        initial  <--
     2.3283e+02     2.3283e+03             7.4155e-07       -17.216529477776
     9.3132e+02     9.3132e+03             1.8557e-07       -17.216529483214
     3.7253e+03     3.7253e+04             4.6404e-08       -17.216529487994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0595
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.072669e-01 1 1  ON 0
 uu_1                 4.374255e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497817e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203535e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201214e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014570e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996184e-02 1 1  ON 36
eH1_7                 4.770883e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192751e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.143929e-03 1 1  ON 44
eH2_5                 1.164120e-02 1 1  ON 45
eH2_6                 5.353382e-02 1 1  ON 46
eH2_7                 6.390598e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.296838
====================================================
  Execution time = 3.3893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.8670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386896070865
                                         uncertainty =       0.059535561209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386896070865
                                         uncertainty =       0.059535561209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439716448
  error estimate for blocks of size 2^( 2) =       0.000448683051
  error estimate for blocks of size 2^( 3) =       0.000456584833
  error estimate for blocks of size 2^( 4) =       0.000462195585
  error estimate for blocks of size 2^( 5) =       0.000466013910
  error estimate for blocks of size 2^( 6) =       0.000468945065
  error estimate for blocks of size 2^( 7) =       0.000469695453

      target function =                  N/A
              le_mean =     -17.217218918702
             les_mean =     296.819328210707
             stat err =       0.000466712503
             autocorr =       1.126557723151
              std dev =       0.621852964587
             le_variance =       0.386701109565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721891870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218918702       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218918651       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218918658       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218918627       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218918591       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218918630       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 6.393155e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218918702       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218918689       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218918691       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218918683       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218918674       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218918681       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.598355e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218918702       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218918698       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218918699       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218918697       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218918718       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218918800       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 3.995928e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3192e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.072669e-01 1 1  ON 0
 uu_1                 4.374254e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594438e-01 1 1  ON 5
 uu_6                -1.461092e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497816e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384239e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203536e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201214e-02 1 1  ON 32
eH1_3                -4.457288e-02 1 1  ON 33
eH1_4                 1.014569e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996184e-02 1 1  ON 36
eH1_7                 4.770884e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192751e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.143945e-03 1 1  ON 44
eH2_5                 1.164120e-02 1 1  ON 45
eH2_6                 5.353381e-02 1 1  ON 46
eH2_7                 6.390598e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.336243
====================================================
  Execution time = 3.3192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2210e-01
  Total weights = 2.0000e+06
  Execution time = 3.0599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997354568
                                         uncertainty =       0.004591439359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997354568
                                         uncertainty =       0.004591439359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401308741
  error estimate for blocks of size 2^( 2) =       0.000410517016
  error estimate for blocks of size 2^( 3) =       0.000418828156
  error estimate for blocks of size 2^( 4) =       0.000424856158
  error estimate for blocks of size 2^( 5) =       0.000428907196
  error estimate for blocks of size 2^( 6) =       0.000429226682
  error estimate for blocks of size 2^( 7) =       0.000430717215

      target function =                  N/A
              le_mean =     -17.216531372823
             les_mean =     296.731049761949
             stat err =       0.000428426813
             autocorr =       1.139714430482
              std dev =       0.567536264562
             le_variance =       0.322097411592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997335632
                                         uncertainty =       0.004591439281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997335632
                                         uncertainty =       0.004591439281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401308729
  error estimate for blocks of size 2^( 2) =       0.000410517004
  error estimate for blocks of size 2^( 3) =       0.000418828144
  error estimate for blocks of size 2^( 4) =       0.000424856147
  error estimate for blocks of size 2^( 5) =       0.000428907185
  error estimate for blocks of size 2^( 6) =       0.000429226671
  error estimate for blocks of size 2^( 7) =       0.000430717205

      target function =                  N/A
              le_mean =     -17.216531373004
             les_mean =     296.731049749219
             stat err =       0.000428426802
             autocorr =       1.139714438712
              std dev =       0.567536247875
             le_variance =       0.322097392652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997345098
                                         uncertainty =       0.004591439320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997345098
                                         uncertainty =       0.004591439320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401308735
  error estimate for blocks of size 2^( 2) =       0.000410517010
  error estimate for blocks of size 2^( 3) =       0.000418828150
  error estimate for blocks of size 2^( 4) =       0.000424856152
  error estimate for blocks of size 2^( 5) =       0.000428907191
  error estimate for blocks of size 2^( 6) =       0.000429226676
  error estimate for blocks of size 2^( 7) =       0.000430717210

      target function =                  N/A
              le_mean =     -17.216531372913
             les_mean =     296.731049755582
             stat err =       0.000428426807
             autocorr =       1.139714434598
              std dev =       0.567536256216
             le_variance =       0.322097402120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997353384
                                         uncertainty =       0.004591439354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321997353384
                                         uncertainty =       0.004591439354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401308741
  error estimate for blocks of size 2^( 2) =       0.000410517015
  error estimate for blocks of size 2^( 3) =       0.000418828155
  error estimate for blocks of size 2^( 4) =       0.000424856158
  error estimate for blocks of size 2^( 5) =       0.000428907196
  error estimate for blocks of size 2^( 6) =       0.000429226681
  error estimate for blocks of size 2^( 7) =       0.000430717215

      target function =                  N/A
              le_mean =     -17.216531372834
             les_mean =     296.731049761153
             stat err =       0.000428426812
             autocorr =       1.139714430997
              std dev =       0.567536263518
             le_variance =       0.322097410408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216531372823        initial
     2.3283e+03     2.3283e+04             6.3932e-08       -17.216531373004  <--
     9.3132e+03     9.3132e+04             1.5984e-08       -17.216531372913
     3.7253e+04     3.7253e+05             3.9959e-09       -17.216531372834

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 4.8607e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.072668e-01 1 1  ON 0
 uu_1                 4.374251e-02 1 1  ON 1
 uu_2                -5.302587e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594438e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607091e-02 1 1  ON 7
 uu_8                -1.497815e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605241e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384242e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425666e-01 1 1  ON 17
 ud_8                -7.203537e-02 1 1  ON 18
 ud_9                 7.859770e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702650e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531375e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822648e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201213e-02 1 1  ON 32
eH1_3                -4.457288e-02 1 1  ON 33
eH1_4                 1.014566e-03 1 1  ON 34
eH1_5                 1.148193e-02 1 1  ON 35
eH1_6                 4.996185e-02 1 1  ON 36
eH1_7                 4.770885e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403964e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238450e-01 1 1  ON 41
eH2_2                -8.192750e-02 1 1  ON 42
eH2_3                -4.441191e-02 1 1  ON 43
eH2_4                 1.143993e-03 1 1  ON 44
eH2_5                 1.164121e-02 1 1  ON 45
eH2_6                 5.353379e-02 1 1  ON 46
eH2_7                 6.390597e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2899
    reference variance = 0.329293
====================================================
  Execution time = 3.7048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4697e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347059284641
                                         uncertainty =       0.019152477484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347059284641
                                         uncertainty =       0.019152477484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416515015
  error estimate for blocks of size 2^( 2) =       0.000425624233
  error estimate for blocks of size 2^( 3) =       0.000433818644
  error estimate for blocks of size 2^( 4) =       0.000439537317
  error estimate for blocks of size 2^( 5) =       0.000442989880
  error estimate for blocks of size 2^( 6) =       0.000443555110
  error estimate for blocks of size 2^( 7) =       0.000443708618

      target function =                  N/A
              le_mean =     -17.216290190839
             les_mean =     296.747617276835
             stat err =       0.000442447731
             autocorr =       1.128398815505
              std dev =       0.589041182901
             le_variance =       0.346969515153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629019084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216290190839       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216290191129       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216290191446       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216290190940       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216290190457       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216290190201       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216290190069       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 4.150288e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216290190839       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216290190911       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216290190990       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216290190864       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216290190744       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216290190679       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216290190648       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.037724e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216290190839       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216290190857       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216290190877       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216290190845       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216290190814       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216290190799       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216290190789       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.594404e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6520e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.072668e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302584e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607092e-02 1 1  ON 7
 uu_8                -1.497826e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605242e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384244e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594603e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425666e-01 1 1  ON 17
 ud_8                -7.203538e-02 1 1  ON 18
 ud_9                 7.859769e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702651e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201216e-02 1 1  ON 32
eH1_3                -4.457287e-02 1 1  ON 33
eH1_4                 1.014620e-03 1 1  ON 34
eH1_5                 1.148191e-02 1 1  ON 35
eH1_6                 4.996183e-02 1 1  ON 36
eH1_7                 4.770885e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403965e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238451e-01 1 1  ON 41
eH2_2                -8.192756e-02 1 1  ON 42
eH2_3                -4.441189e-02 1 1  ON 43
eH2_4                 1.144097e-03 1 1  ON 44
eH2_5                 1.164122e-02 1 1  ON 45
eH2_6                 5.353377e-02 1 1  ON 46
eH2_7                 6.390597e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2877
    reference variance = 0.215426
====================================================
  Execution time = 3.3155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2960e-01
  Total weights = 2.0000e+06
  Execution time = 3.0918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329679950701
                                         uncertainty =       0.011064451365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329679950701
                                         uncertainty =       0.011064451365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405956261
  error estimate for blocks of size 2^( 2) =       0.000415445045
  error estimate for blocks of size 2^( 3) =       0.000423025022
  error estimate for blocks of size 2^( 4) =       0.000429333948
  error estimate for blocks of size 2^( 5) =       0.000433129174
  error estimate for blocks of size 2^( 6) =       0.000435189853
  error estimate for blocks of size 2^( 7) =       0.000436740453

      target function =                  N/A
              le_mean =     -17.217315292904
             les_mean =     296.765546702942
             stat err =       0.000433598357
             autocorr =       1.140819055606
              std dev =       0.574108850730
             le_variance =       0.329600972487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680178520
                                         uncertainty =       0.011064459287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680178520
                                         uncertainty =       0.011064459287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405956402
  error estimate for blocks of size 2^( 2) =       0.000415445177
  error estimate for blocks of size 2^( 3) =       0.000423025147
  error estimate for blocks of size 2^( 4) =       0.000429334065
  error estimate for blocks of size 2^( 5) =       0.000433129291
  error estimate for blocks of size 2^( 6) =       0.000435189965
  error estimate for blocks of size 2^( 7) =       0.000436740557

      target function =                  N/A
              le_mean =     -17.217315296216
             les_mean =     296.765547044680
             stat err =       0.000433598469
             autocorr =       1.140818860165
              std dev =       0.574109049034
             le_variance =       0.329601200183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680064673
                                         uncertainty =       0.011064455329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329680064673
                                         uncertainty =       0.011064455329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405956332
  error estimate for blocks of size 2^( 2) =       0.000415445111
  error estimate for blocks of size 2^( 3) =       0.000423025085
  error estimate for blocks of size 2^( 4) =       0.000429334007
  error estimate for blocks of size 2^( 5) =       0.000433129232
  error estimate for blocks of size 2^( 6) =       0.000435189909
  error estimate for blocks of size 2^( 7) =       0.000436740505

      target function =                  N/A
              le_mean =     -17.217315294560
             les_mean =     296.765546873893
             stat err =       0.000433598413
             autocorr =       1.140818957841
              std dev =       0.574108949937
             le_variance =       0.329601086398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329679964949
                                         uncertainty =       0.011064451861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329679964949
                                         uncertainty =       0.011064451861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405956270
  error estimate for blocks of size 2^( 2) =       0.000415445053
  error estimate for blocks of size 2^( 3) =       0.000423025030
  error estimate for blocks of size 2^( 4) =       0.000429333955
  error estimate for blocks of size 2^( 5) =       0.000433129181
  error estimate for blocks of size 2^( 6) =       0.000435189860
  error estimate for blocks of size 2^( 7) =       0.000436740459

      target function =                  N/A
              le_mean =     -17.217315293111
             les_mean =     296.765546724313
             stat err =       0.000433598364
             autocorr =       1.140819043381
              std dev =       0.574108863133
             le_variance =       0.329600986728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217315292904        initial
     5.8208e+02     5.8208e+03             4.1503e-07       -17.217315296216  <--
     2.3283e+03     2.3283e+04             1.0377e-07       -17.217315294560
     9.3132e+03     9.3132e+04             2.5944e-08       -17.217315293111

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 4.8725e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.072667e-01 1 1  ON 0
 uu_1                 4.374262e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497860e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605244e-01 1 1  ON 10
 ud_1                 1.009023e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384250e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203541e-02 1 1  ON 18
 ud_9                 7.859765e-02 1 1  ON 19
 eO_0                -8.963788e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201225e-02 1 1  ON 32
eH1_3                -4.457284e-02 1 1  ON 33
eH1_4                 1.014782e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996177e-02 1 1  ON 36
eH1_7                 4.770885e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403966e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238453e-01 1 1  ON 41
eH2_2                -8.192772e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144408e-03 1 1  ON 44
eH2_5                 1.164125e-02 1 1  ON 45
eH2_6                 5.353370e-02 1 1  ON 46
eH2_7                 6.390596e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5321e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.263943
====================================================
  Execution time = 3.3895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1501e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315017394263
                                         uncertainty =       0.003005694379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315017394263
                                         uncertainty =       0.003005694379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396869135
  error estimate for blocks of size 2^( 2) =       0.000406532195
  error estimate for blocks of size 2^( 3) =       0.000415306876
  error estimate for blocks of size 2^( 4) =       0.000421616414
  error estimate for blocks of size 2^( 5) =       0.000424769098
  error estimate for blocks of size 2^( 6) =       0.000426987475
  error estimate for blocks of size 2^( 7) =       0.000429107904

      target function =                  N/A
              le_mean =     -17.216603110816
             les_mean =     296.726432738669
             stat err =       0.000425620223
             autocorr =       1.150137754934
              std dev =       0.561257713369
             le_variance =       0.315010220816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660311082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603110816       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603111300       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603113909       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603115296       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603111806       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603112222       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603112205       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 8.994331e-07

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603110816       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603110937       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603111590       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603111938       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603111065       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603111170       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603111166       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 2.251122e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603110816       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603110846       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603111010       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603111096       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603110879       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603110903       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603110901       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 5.629395e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.437843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3257e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374267e-02 1 1  ON 1
 uu_2                -5.302572e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594440e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607105e-02 1 1  ON 7
 uu_8                -1.497887e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605243e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075403e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203549e-02 1 1  ON 18
 ud_9                 7.859759e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246960e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252959e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030432e-01 1 1  ON 30
eH1_1                -1.239739e-01 1 1  ON 31
eH1_2                -8.201238e-02 1 1  ON 32
eH1_3                -4.457276e-02 1 1  ON 33
eH1_4                 1.014822e-03 1 1  ON 34
eH1_5                 1.148193e-02 1 1  ON 35
eH1_6                 4.996174e-02 1 1  ON 36
eH1_7                 4.770883e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032131e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192795e-02 1 1  ON 42
eH2_3                -4.441180e-02 1 1  ON 43
eH2_4                 1.144364e-03 1 1  ON 44
eH2_5                 1.164140e-02 1 1  ON 45
eH2_6                 5.353369e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1803
    reference variance = 0.267747
====================================================
  Execution time = 3.3198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2176e-01
  Total weights = 2.0000e+06
  Execution time = 3.1143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748745918
                                         uncertainty =       0.003502123525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748745918
                                         uncertainty =       0.003502123525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401099091
  error estimate for blocks of size 2^( 2) =       0.000410152489
  error estimate for blocks of size 2^( 3) =       0.000418577168
  error estimate for blocks of size 2^( 4) =       0.000424510655
  error estimate for blocks of size 2^( 5) =       0.000428131358
  error estimate for blocks of size 2^( 6) =       0.000431672408
  error estimate for blocks of size 2^( 7) =       0.000431673732

      target function =                  N/A
              le_mean =     -17.217925676380
             les_mean =     296.778725397682
             stat err =       0.000428997038
             autocorr =       1.143945233740
              std dev =       0.567239773995
             le_variance =       0.321760961202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748384190
                                         uncertainty =       0.003502117135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748384190
                                         uncertainty =       0.003502117135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401098865
  error estimate for blocks of size 2^( 2) =       0.000410152271
  error estimate for blocks of size 2^( 3) =       0.000418576953
  error estimate for blocks of size 2^( 4) =       0.000424510430
  error estimate for blocks of size 2^( 5) =       0.000428131125
  error estimate for blocks of size 2^( 6) =       0.000431672175
  error estimate for blocks of size 2^( 7) =       0.000431673463

      target function =                  N/A
              le_mean =     -17.217925674637
             les_mean =     296.778724975902
             stat err =       0.000428996798
             autocorr =       1.143945238736
              std dev =       0.567239455130
             le_variance =       0.321760599457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748564286
                                         uncertainty =       0.003502120318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748564286
                                         uncertainty =       0.003502120318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401098978
  error estimate for blocks of size 2^( 2) =       0.000410152379
  error estimate for blocks of size 2^( 3) =       0.000418577060
  error estimate for blocks of size 2^( 4) =       0.000424510542
  error estimate for blocks of size 2^( 5) =       0.000428131241
  error estimate for blocks of size 2^( 6) =       0.000431672291
  error estimate for blocks of size 2^( 7) =       0.000431673597

      target function =                  N/A
              le_mean =     -17.217925675507
             les_mean =     296.778725185961
             stat err =       0.000428996918
             autocorr =       1.143945236542
              std dev =       0.567239613885
             le_variance =       0.321760779561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748723189
                                         uncertainty =       0.003502123124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321748723189
                                         uncertainty =       0.003502123124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401099077
  error estimate for blocks of size 2^( 2) =       0.000410152475
  error estimate for blocks of size 2^( 3) =       0.000418577154
  error estimate for blocks of size 2^( 4) =       0.000424510641
  error estimate for blocks of size 2^( 5) =       0.000428131344
  error estimate for blocks of size 2^( 6) =       0.000431672394
  error estimate for blocks of size 2^( 7) =       0.000431673715

      target function =                  N/A
              le_mean =     -17.217925676271
             les_mean =     296.778725371187
             stat err =       0.000428997023
             autocorr =       1.143945234113
              std dev =       0.567239753959
             le_variance =       0.321760938472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217925676380        initial  <--
     1.4552e+02     1.4552e+03             8.9943e-07       -17.217925674637
     5.8208e+02     5.8208e+03             2.2511e-07       -17.217925675507
     2.3283e+03     2.3283e+04             5.6294e-08       -17.217925676271

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.8257
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.072667e-01 1 1  ON 0
 uu_1                 4.374262e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497860e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605244e-01 1 1  ON 10
 ud_1                 1.009023e-01 1 1  ON 11
 ud_2                -1.075407e-02 1 1  ON 12
 ud_3                -7.384250e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203541e-02 1 1  ON 18
 ud_9                 7.859765e-02 1 1  ON 19
 eO_0                -8.963788e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499828e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201225e-02 1 1  ON 32
eH1_3                -4.457284e-02 1 1  ON 33
eH1_4                 1.014782e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996177e-02 1 1  ON 36
eH1_7                 4.770885e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403966e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238453e-01 1 1  ON 41
eH2_2                -8.192772e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144408e-03 1 1  ON 44
eH2_5                 1.164125e-02 1 1  ON 45
eH2_6                 5.353370e-02 1 1  ON 46
eH2_7                 6.390596e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2693
    reference variance = 0.189626
====================================================
  Execution time = 3.3430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.6377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363899287234
                                         uncertainty =       0.028894899203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363899287234
                                         uncertainty =       0.028894899203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426477654
  error estimate for blocks of size 2^( 2) =       0.000434834811
  error estimate for blocks of size 2^( 3) =       0.000443086006
  error estimate for blocks of size 2^( 4) =       0.000449258882
  error estimate for blocks of size 2^( 5) =       0.000452942670
  error estimate for blocks of size 2^( 6) =       0.000453129695
  error estimate for blocks of size 2^( 7) =       0.000454134444

      target function =                  N/A
              le_mean =     -17.216836657098
             les_mean =     296.783230673493
             stat err =       0.000452366423
             autocorr =       1.125092327397
              std dev =       0.603130481876
             le_variance =       0.363766378167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683665710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836657098       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836657130       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216836657383       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216836657713       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216836657756       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216836657793       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216836657738       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.103719e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836657098       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836657106       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216836657170       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216836657252       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216836657263       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216836657273       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216836657258       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.759685e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836657098       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836657100       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216836657116       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216836657139       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216836657139       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216836657128       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216836657118       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 6.899456e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2592e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.072667e-01 1 1  ON 0
 uu_1                 4.374262e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497861e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605244e-01 1 1  ON 10
 ud_1                 1.009023e-01 1 1  ON 11
 ud_2                -1.075406e-02 1 1  ON 12
 ud_3                -7.384252e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203541e-02 1 1  ON 18
 ud_9                 7.859765e-02 1 1  ON 19
 eO_0                -8.963788e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030430e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201226e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014777e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996177e-02 1 1  ON 36
eH1_7                 4.770886e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403966e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238453e-01 1 1  ON 41
eH2_2                -8.192771e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144421e-03 1 1  ON 44
eH2_5                 1.164125e-02 1 1  ON 45
eH2_6                 5.353369e-02 1 1  ON 46
eH2_7                 6.390596e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2746
    reference variance = 0.206555
====================================================
  Execution time = 3.2904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2475e-01
  Total weights = 2.0000e+06
  Execution time = 3.1196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822943629
                                         uncertainty =       0.006207331179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822943629
                                         uncertainty =       0.006207331179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402960687
  error estimate for blocks of size 2^( 2) =       0.000412284649
  error estimate for blocks of size 2^( 3) =       0.000420584359
  error estimate for blocks of size 2^( 4) =       0.000426366997
  error estimate for blocks of size 2^( 5) =       0.000430219154
  error estimate for blocks of size 2^( 6) =       0.000432317987
  error estimate for blocks of size 2^( 7) =       0.000435256506

      target function =                  N/A
              le_mean =     -17.217099195816
             les_mean =     296.753259187458
             stat err =       0.000431040161
             autocorr =       1.144221530311
              std dev =       0.569872469293
             le_variance =       0.324754631258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822965384
                                         uncertainty =       0.006207331871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822965384
                                         uncertainty =       0.006207331871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402960701
  error estimate for blocks of size 2^( 2) =       0.000412284661
  error estimate for blocks of size 2^( 3) =       0.000420584369
  error estimate for blocks of size 2^( 4) =       0.000426367008
  error estimate for blocks of size 2^( 5) =       0.000430219164
  error estimate for blocks of size 2^( 6) =       0.000432317997
  error estimate for blocks of size 2^( 7) =       0.000435256515

      target function =                  N/A
              le_mean =     -17.217099196551
             les_mean =     296.753259234555
             stat err =       0.000431040171
             autocorr =       1.144221505498
              std dev =       0.569872488415
             le_variance =       0.324754653053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822954507
                                         uncertainty =       0.006207331525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822954507
                                         uncertainty =       0.006207331525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402960694
  error estimate for blocks of size 2^( 2) =       0.000412284655
  error estimate for blocks of size 2^( 3) =       0.000420584364
  error estimate for blocks of size 2^( 4) =       0.000426367002
  error estimate for blocks of size 2^( 5) =       0.000430219159
  error estimate for blocks of size 2^( 6) =       0.000432317992
  error estimate for blocks of size 2^( 7) =       0.000435256511

      target function =                  N/A
              le_mean =     -17.217099196184
             les_mean =     296.753259211009
             stat err =       0.000431040166
             autocorr =       1.144221517903
              std dev =       0.569872478854
             le_variance =       0.324754642155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822944989
                                         uncertainty =       0.006207331222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324822944989
                                         uncertainty =       0.006207331222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402960688
  error estimate for blocks of size 2^( 2) =       0.000412284650
  error estimate for blocks of size 2^( 3) =       0.000420584360
  error estimate for blocks of size 2^( 4) =       0.000426366998
  error estimate for blocks of size 2^( 5) =       0.000430219155
  error estimate for blocks of size 2^( 6) =       0.000432317988
  error estimate for blocks of size 2^( 7) =       0.000435256507

      target function =                  N/A
              le_mean =     -17.217099195862
             les_mean =     296.753259190402
             stat err =       0.000431040162
             autocorr =       1.144221528760
              std dev =       0.569872470488
             le_variance =       0.324754632620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217099195816        initial
     1.4552e+03     1.4552e+04             1.1037e-07       -17.217099196551  <--
     5.8208e+03     5.8208e+04             2.7597e-08       -17.217099196184
     2.3283e+04     2.3283e+05             6.8995e-09       -17.217099195862

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 4.8577e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374261e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607095e-02 1 1  ON 7
 uu_8                -1.497864e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075405e-02 1 1  ON 12
 ud_3                -7.384255e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203543e-02 1 1  ON 18
 ud_9                 7.859763e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239739e-01 1 1  ON 31
eH1_2                -8.201229e-02 1 1  ON 32
eH1_3                -4.457278e-02 1 1  ON 33
eH1_4                 1.014761e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996178e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192768e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144461e-03 1 1  ON 44
eH2_5                 1.164126e-02 1 1  ON 45
eH2_6                 5.353364e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2138
    reference variance = 0.48085
====================================================
  Execution time = 3.3412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1784e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317921315409
                                         uncertainty =       0.003096237373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317921315409
                                         uncertainty =       0.003096237373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398649932
  error estimate for blocks of size 2^( 2) =       0.000407506263
  error estimate for blocks of size 2^( 3) =       0.000415323584
  error estimate for blocks of size 2^( 4) =       0.000422132352
  error estimate for blocks of size 2^( 5) =       0.000425662549
  error estimate for blocks of size 2^( 6) =       0.000427841022
  error estimate for blocks of size 2^( 7) =       0.000428939610

      target function =                  N/A
              le_mean =     -17.216508015065
             les_mean =     296.725991609916
             stat err =       0.000426143883
             autocorr =       1.142691849965
              std dev =       0.563776139992
             le_variance =       0.317843536024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650801507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508015065       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508017524       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508018398       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508019545       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508019197       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508018873       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508019002       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.505708e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508015065       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508015680       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508015899       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508016186       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508016100       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508016019       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508016051       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.377502e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508015065       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508015219       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216508015274       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216508015345       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216508015324       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508015294       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216508015312       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.444428e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2701e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374259e-02 1 1  ON 1
 uu_2                -5.302573e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594438e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497856e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605246e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075402e-02 1 1  ON 12
 ud_3                -7.384261e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699360e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203545e-02 1 1  ON 18
 ud_9                 7.859762e-02 1 1  ON 19
 eO_0                -8.963788e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201227e-02 1 1  ON 32
eH1_3                -4.457279e-02 1 1  ON 33
eH1_4                 1.014795e-03 1 1  ON 34
eH1_5                 1.148184e-02 1 1  ON 35
eH1_6                 4.996177e-02 1 1  ON 36
eH1_7                 4.770890e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441181e-02 1 1  ON 43
eH2_4                 1.144557e-03 1 1  ON 44
eH2_5                 1.164128e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390592e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1644
    reference variance = 0.358423
====================================================
  Execution time = 3.5040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1507e-01
  Total weights = 2.0000e+06
  Execution time = 3.1001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146785708
                                         uncertainty =       0.003317954143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146785708
                                         uncertainty =       0.003317954143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907721
  error estimate for blocks of size 2^( 2) =       0.000406187342
  error estimate for blocks of size 2^( 3) =       0.000414584825
  error estimate for blocks of size 2^( 4) =       0.000420720905
  error estimate for blocks of size 2^( 5) =       0.000424905509
  error estimate for blocks of size 2^( 6) =       0.000427060081
  error estimate for blocks of size 2^( 7) =       0.000431379100

      target function =                  N/A
              le_mean =     -17.216766838456
             les_mean =     296.732131690869
             stat err =       0.000426016399
             autocorr =       1.152055861180
              std dev =       0.561312282649
             le_variance =       0.315071478653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146705933
                                         uncertainty =       0.003317951209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146705933
                                         uncertainty =       0.003317951209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907671
  error estimate for blocks of size 2^( 2) =       0.000406187292
  error estimate for blocks of size 2^( 3) =       0.000414584776
  error estimate for blocks of size 2^( 4) =       0.000420720853
  error estimate for blocks of size 2^( 5) =       0.000424905452
  error estimate for blocks of size 2^( 6) =       0.000427060030
  error estimate for blocks of size 2^( 7) =       0.000431379040

      target function =                  N/A
              le_mean =     -17.216766837203
             les_mean =     296.732131568120
             stat err =       0.000426016343
             autocorr =       1.152055854387
              std dev =       0.561312211738
             le_variance =       0.315071399046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146745771
                                         uncertainty =       0.003317952675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146745771
                                         uncertainty =       0.003317952675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907696
  error estimate for blocks of size 2^( 2) =       0.000406187317
  error estimate for blocks of size 2^( 3) =       0.000414584800
  error estimate for blocks of size 2^( 4) =       0.000420720879
  error estimate for blocks of size 2^( 5) =       0.000424905480
  error estimate for blocks of size 2^( 6) =       0.000427060055
  error estimate for blocks of size 2^( 7) =       0.000431379070

      target function =                  N/A
              le_mean =     -17.216766837829
             les_mean =     296.732131629423
             stat err =       0.000426016371
             autocorr =       1.152055857805
              std dev =       0.561312247149
             le_variance =       0.315071438800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146780714
                                         uncertainty =       0.003317953960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315146780714
                                         uncertainty =       0.003317953960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396907718
  error estimate for blocks of size 2^( 2) =       0.000406187339
  error estimate for blocks of size 2^( 3) =       0.000414584822
  error estimate for blocks of size 2^( 4) =       0.000420720902
  error estimate for blocks of size 2^( 5) =       0.000424905505
  error estimate for blocks of size 2^( 6) =       0.000427060078
  error estimate for blocks of size 2^( 7) =       0.000431379096

      target function =                  N/A
              le_mean =     -17.216766838377
             les_mean =     296.732131683185
             stat err =       0.000426016395
             autocorr =       1.152055860758
              std dev =       0.561312278210
             le_variance =       0.315071473670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216766838456        initial  <--
     3.6380e+02     3.6380e+03             5.5057e-07       -17.216766837203
     1.4552e+03     1.4552e+04             1.3775e-07       -17.216766837829
     5.8208e+03     5.8208e+04             3.4444e-08       -17.216766838377

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.6504
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374261e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607095e-02 1 1  ON 7
 uu_8                -1.497864e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075405e-02 1 1  ON 12
 ud_3                -7.384255e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203543e-02 1 1  ON 18
 ud_9                 7.859763e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239739e-01 1 1  ON 31
eH1_2                -8.201229e-02 1 1  ON 32
eH1_3                -4.457278e-02 1 1  ON 33
eH1_4                 1.014761e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996178e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192768e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144461e-03 1 1  ON 44
eH2_5                 1.164126e-02 1 1  ON 45
eH2_6                 5.353364e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.281688
====================================================
  Execution time = 3.3537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1813e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318058177103
                                         uncertainty =       0.005104203461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318058177103
                                         uncertainty =       0.005104203461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398827503
  error estimate for blocks of size 2^( 2) =       0.000408254801
  error estimate for blocks of size 2^( 3) =       0.000417237420
  error estimate for blocks of size 2^( 4) =       0.000424071361
  error estimate for blocks of size 2^( 5) =       0.000427786605
  error estimate for blocks of size 2^( 6) =       0.000429967600
  error estimate for blocks of size 2^( 7) =       0.000430798671

      target function =                  N/A
              le_mean =     -17.216960703087
             les_mean =     296.741862447623
             stat err =       0.000428156059
             autocorr =       1.152481569734
              std dev =       0.564027264459
             le_variance =       0.318126755054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696070309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216960703087       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216960703083       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216960703208       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216960703256       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216960703267       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216960703239       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 2.848617e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216960703087       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216960703086       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216960703117       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216960703128       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216960703130       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216960703136       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 7.121778e-09

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216960703087       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216960703087       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216960703094       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216960703105       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216960703098       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216960703116       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.780459e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2997e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374261e-02 1 1  ON 1
 uu_2                -5.302575e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607095e-02 1 1  ON 7
 uu_8                -1.497864e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075405e-02 1 1  ON 12
 ud_3                -7.384255e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594604e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203543e-02 1 1  ON 18
 ud_9                 7.859763e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239739e-01 1 1  ON 31
eH1_2                -8.201230e-02 1 1  ON 32
eH1_3                -4.457278e-02 1 1  ON 33
eH1_4                 1.014765e-03 1 1  ON 34
eH1_5                 1.148186e-02 1 1  ON 35
eH1_6                 4.996178e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192768e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144464e-03 1 1  ON 44
eH2_5                 1.164126e-02 1 1  ON 45
eH2_6                 5.353364e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152496e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.221705
====================================================
  Execution time = 3.4069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3017e-01
  Total weights = 2.0000e+06
  Execution time = 3.1015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141084435
                                         uncertainty =       0.006166054255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141084435
                                         uncertainty =       0.006166054255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406304830
  error estimate for blocks of size 2^( 2) =       0.000415680456
  error estimate for blocks of size 2^( 3) =       0.000423758269
  error estimate for blocks of size 2^( 4) =       0.000429892050
  error estimate for blocks of size 2^( 5) =       0.000433524858
  error estimate for blocks of size 2^( 6) =       0.000436458155
  error estimate for blocks of size 2^( 7) =       0.000436934663

      target function =                  N/A
              le_mean =     -17.217189878270
             les_mean =     296.761794368482
             stat err =       0.000434202431
             autocorr =       1.142037942082
              std dev =       0.574601800533
             le_variance =       0.330167229175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141067887
                                         uncertainty =       0.006166054031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141067887
                                         uncertainty =       0.006166054031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406304819
  error estimate for blocks of size 2^( 2) =       0.000415680446
  error estimate for blocks of size 2^( 3) =       0.000423758260
  error estimate for blocks of size 2^( 4) =       0.000429892041
  error estimate for blocks of size 2^( 5) =       0.000433524849
  error estimate for blocks of size 2^( 6) =       0.000436458146
  error estimate for blocks of size 2^( 7) =       0.000436934654

      target function =                  N/A
              le_mean =     -17.217189878308
             les_mean =     296.761794353266
             stat err =       0.000434202422
             autocorr =       1.142037951779
              std dev =       0.574601786137
             le_variance =       0.330167212632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141076161
                                         uncertainty =       0.006166054143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141076161
                                         uncertainty =       0.006166054143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406304825
  error estimate for blocks of size 2^( 2) =       0.000415680451
  error estimate for blocks of size 2^( 3) =       0.000423758265
  error estimate for blocks of size 2^( 4) =       0.000429892046
  error estimate for blocks of size 2^( 5) =       0.000433524853
  error estimate for blocks of size 2^( 6) =       0.000436458151
  error estimate for blocks of size 2^( 7) =       0.000436934658

      target function =                  N/A
              le_mean =     -17.217189878289
             les_mean =     296.761794360874
             stat err =       0.000434202427
             autocorr =       1.142037946934
              std dev =       0.574601793334
             le_variance =       0.330167220903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141083401
                                         uncertainty =       0.006166054241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330141083401
                                         uncertainty =       0.006166054241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406304829
  error estimate for blocks of size 2^( 2) =       0.000415680455
  error estimate for blocks of size 2^( 3) =       0.000423758269
  error estimate for blocks of size 2^( 4) =       0.000429892050
  error estimate for blocks of size 2^( 5) =       0.000433524857
  error estimate for blocks of size 2^( 6) =       0.000436458155
  error estimate for blocks of size 2^( 7) =       0.000436934662

      target function =                  N/A
              le_mean =     -17.217189878272
             les_mean =     296.761794367531
             stat err =       0.000434202431
             autocorr =       1.142037942685
              std dev =       0.574601799633
             le_variance =       0.330167228141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217189878270        initial
     3.6380e+03     3.6380e+04             2.8486e-08       -17.217189878308  <--
     1.4552e+04     1.4552e+05             7.1218e-09       -17.217189878289
     5.8208e+04     5.8208e+05             1.7805e-09       -17.217189878272

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 4.9648e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374260e-02 1 1  ON 1
 uu_2                -5.302574e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594439e-01 1 1  ON 5
 uu_6                -1.461090e-01 1 1  ON 6
 uu_7                -9.607095e-02 1 1  ON 7
 uu_8                -1.497864e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075404e-02 1 1  ON 12
 ud_3                -7.384254e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203544e-02 1 1  ON 18
 ud_9                 7.859763e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822649e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239739e-01 1 1  ON 31
eH1_2                -8.201231e-02 1 1  ON 32
eH1_3                -4.457280e-02 1 1  ON 33
eH1_4                 1.014776e-03 1 1  ON 34
eH1_5                 1.148187e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192768e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144474e-03 1 1  ON 44
eH2_5                 1.164125e-02 1 1  ON 45
eH2_6                 5.353363e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1275
    reference variance = 0.249416
====================================================
  Execution time = 3.3585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2705e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327137184334
                                         uncertainty =       0.005020832643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327137184334
                                         uncertainty =       0.005020832643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404384912
  error estimate for blocks of size 2^( 2) =       0.000413906692
  error estimate for blocks of size 2^( 3) =       0.000421736838
  error estimate for blocks of size 2^( 4) =       0.000428127140
  error estimate for blocks of size 2^( 5) =       0.000432955179
  error estimate for blocks of size 2^( 6) =       0.000434459852
  error estimate for blocks of size 2^( 7) =       0.000433886725

      target function =                  N/A
              le_mean =     -17.216908816251
             les_mean =     296.749003337215
             stat err =       0.000432357224
             autocorr =       1.143129819799
              std dev =       0.571886626560
             le_variance =       0.327054313638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690881625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908816251       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908816569       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908816393       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908816286       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216908816154       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908816259       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.141656e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908816251       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908816331       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908816287       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908816260       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216908816228       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908816253       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 5.354644e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216908816251       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216908816271       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216908816260       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216908816251       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216908816244       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216908816248       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 1.338692e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2908e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374259e-02 1 1  ON 1
 uu_2                -5.302573e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594438e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607096e-02 1 1  ON 7
 uu_8                -1.497865e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009024e-01 1 1  ON 11
 ud_2                -1.075403e-02 1 1  ON 12
 ud_3                -7.384255e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203545e-02 1 1  ON 18
 ud_9                 7.859762e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011712e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201231e-02 1 1  ON 32
eH1_3                -4.457281e-02 1 1  ON 33
eH1_4                 1.014786e-03 1 1  ON 34
eH1_5                 1.148188e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403967e-02 1 1  ON 39
eH2_0                -2.032132e-01 1 1  ON 40
eH2_1                -1.238454e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144528e-03 1 1  ON 44
eH2_5                 1.164127e-02 1 1  ON 45
eH2_6                 5.353363e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.230257
====================================================
  Execution time = 3.3046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2781e-01
  Total weights = 2.0000e+06
  Execution time = 3.1129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951824429
                                         uncertainty =       0.007249818822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951824429
                                         uncertainty =       0.007249818822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404850092
  error estimate for blocks of size 2^( 2) =       0.000414389600
  error estimate for blocks of size 2^( 3) =       0.000423122396
  error estimate for blocks of size 2^( 4) =       0.000429908125
  error estimate for blocks of size 2^( 5) =       0.000433961964
  error estimate for blocks of size 2^( 6) =       0.000437199412
  error estimate for blocks of size 2^( 7) =       0.000437999302

      target function =                  N/A
              le_mean =     -17.216602475539
             les_mean =     296.739207830369
             stat err =       0.000434767201
             autocorr =       1.153254246691
              std dev =       0.572544490456
             le_variance =       0.327807193551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951783977
                                         uncertainty =       0.007249814161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951783977
                                         uncertainty =       0.007249814161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404850067
  error estimate for blocks of size 2^( 2) =       0.000414389575
  error estimate for blocks of size 2^( 3) =       0.000423122370
  error estimate for blocks of size 2^( 4) =       0.000429908098
  error estimate for blocks of size 2^( 5) =       0.000433961935
  error estimate for blocks of size 2^( 6) =       0.000437199384
  error estimate for blocks of size 2^( 7) =       0.000437999276

      target function =                  N/A
              le_mean =     -17.216602476458
             les_mean =     296.739207821622
             stat err =       0.000434767173
             autocorr =       1.153254240174
              std dev =       0.572544455169
             le_variance =       0.327807153145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951804190
                                         uncertainty =       0.007249816491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951804190
                                         uncertainty =       0.007249816491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404850079
  error estimate for blocks of size 2^( 2) =       0.000414389588
  error estimate for blocks of size 2^( 3) =       0.000423122383
  error estimate for blocks of size 2^( 4) =       0.000429908111
  error estimate for blocks of size 2^( 5) =       0.000433961950
  error estimate for blocks of size 2^( 6) =       0.000437199398
  error estimate for blocks of size 2^( 7) =       0.000437999289

      target function =                  N/A
              le_mean =     -17.216602475998
             les_mean =     296.739207825985
             stat err =       0.000434767187
             autocorr =       1.153254243435
              std dev =       0.572544472801
             le_variance =       0.327807173335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951821899
                                         uncertainty =       0.007249818530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327951821899
                                         uncertainty =       0.007249818530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404850090
  error estimate for blocks of size 2^( 2) =       0.000414389599
  error estimate for blocks of size 2^( 3) =       0.000423122394
  error estimate for blocks of size 2^( 4) =       0.000429908123
  error estimate for blocks of size 2^( 5) =       0.000433961963
  error estimate for blocks of size 2^( 6) =       0.000437199410
  error estimate for blocks of size 2^( 7) =       0.000437999301

      target function =                  N/A
              le_mean =     -17.216602475596
             les_mean =     296.739207829820
             stat err =       0.000434767199
             autocorr =       1.153254246293
              std dev =       0.572544488249
             le_variance =       0.327807191024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216602475539        initial
     9.0949e+02     9.0949e+03             2.1417e-07       -17.216602476458  <--
     3.6380e+03     3.6380e+04             5.3546e-08       -17.216602475998
     1.4552e+04     1.4552e+05             1.3387e-08       -17.216602475596

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 4.8736e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374254e-02 1 1  ON 1
 uu_2                -5.302571e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607098e-02 1 1  ON 7
 uu_8                -1.497866e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075403e-02 1 1  ON 12
 ud_3                -7.384258e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203546e-02 1 1  ON 18
 ud_9                 7.859761e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201233e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014818e-03 1 1  ON 34
eH1_5                 1.148191e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238455e-01 1 1  ON 41
eH2_2                -8.192772e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144688e-03 1 1  ON 44
eH2_5                 1.164132e-02 1 1  ON 45
eH2_6                 5.353361e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.218214
====================================================
  Execution time = 3.3387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1805e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318153576889
                                         uncertainty =       0.002913613166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318153576889
                                         uncertainty =       0.002913613166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398782066
  error estimate for blocks of size 2^( 2) =       0.000408159375
  error estimate for blocks of size 2^( 3) =       0.000416315743
  error estimate for blocks of size 2^( 4) =       0.000422603951
  error estimate for blocks of size 2^( 5) =       0.000425746580
  error estimate for blocks of size 2^( 6) =       0.000426974588
  error estimate for blocks of size 2^( 7) =       0.000428702171

      target function =                  N/A
              le_mean =     -17.216966131248
             les_mean =     296.741976877825
             stat err =       0.000426006823
             autocorr =       1.141200283653
              std dev =       0.563963006166
             le_variance =       0.318054272323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696613125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966131248       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966130243       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966129184       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966129545       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966129492       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966129198       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 5.660645e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966131248       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966130996       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966130731       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966130821       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966130807       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966130734       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.416481e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216966131248       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966131185       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966131118       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216966131141       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216966131138       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216966131119       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 3.542029e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.447934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2665e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.072666e-01 1 1  ON 0
 uu_1                 4.374250e-02 1 1  ON 1
 uu_2                -5.302573e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607099e-02 1 1  ON 7
 uu_8                -1.497889e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605246e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075411e-02 1 1  ON 12
 ud_3                -7.384262e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203546e-02 1 1  ON 18
 ud_9                 7.859759e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014599e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239741e-01 1 1  ON 31
eH1_2                -8.201236e-02 1 1  ON 32
eH1_3                -4.457281e-02 1 1  ON 33
eH1_4                 1.014863e-03 1 1  ON 34
eH1_5                 1.148194e-02 1 1  ON 35
eH1_6                 4.996181e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403969e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238455e-01 1 1  ON 41
eH2_2                -8.192779e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144732e-03 1 1  ON 44
eH2_5                 1.164134e-02 1 1  ON 45
eH2_6                 5.353356e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.346106
====================================================
  Execution time = 3.5201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2772e-01
  Total weights = 2.0000e+06
  Execution time = 3.1154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772510266
                                         uncertainty =       0.005011269996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772510266
                                         uncertainty =       0.005011269996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404794949
  error estimate for blocks of size 2^( 2) =       0.000414344986
  error estimate for blocks of size 2^( 3) =       0.000422759433
  error estimate for blocks of size 2^( 4) =       0.000428796325
  error estimate for blocks of size 2^( 5) =       0.000431973533
  error estimate for blocks of size 2^( 6) =       0.000436540374
  error estimate for blocks of size 2^( 7) =       0.000435830007

      target function =                  N/A
              le_mean =     -17.216938952689
             les_mean =     296.750704637796
             stat err =       0.000433285060
             autocorr =       1.145716742500
              std dev =       0.572466506468
             le_variance =       0.327717901028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326773203883
                                         uncertainty =       0.005011287684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326773203883
                                         uncertainty =       0.005011287684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404795377
  error estimate for blocks of size 2^( 2) =       0.000414345393
  error estimate for blocks of size 2^( 3) =       0.000422759818
  error estimate for blocks of size 2^( 4) =       0.000428796696
  error estimate for blocks of size 2^( 5) =       0.000431973901
  error estimate for blocks of size 2^( 6) =       0.000436540746
  error estimate for blocks of size 2^( 7) =       0.000435830355

      target function =                  N/A
              le_mean =     -17.216938949241
             les_mean =     296.750705212400
             stat err =       0.000433285424
             autocorr =       1.145716247372
              std dev =       0.572467112043
             le_variance =       0.327718594371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772857496
                                         uncertainty =       0.005011278857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772857496
                                         uncertainty =       0.005011278857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404795163
  error estimate for blocks of size 2^( 2) =       0.000414345190
  error estimate for blocks of size 2^( 3) =       0.000422759626
  error estimate for blocks of size 2^( 4) =       0.000428796511
  error estimate for blocks of size 2^( 5) =       0.000431973717
  error estimate for blocks of size 2^( 6) =       0.000436540560
  error estimate for blocks of size 2^( 7) =       0.000435830182

      target function =                  N/A
              le_mean =     -17.216938950963
             les_mean =     296.750704925457
             stat err =       0.000433285242
             autocorr =       1.145716494612
              std dev =       0.572466809623
             le_variance =       0.327718248120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772553683
                                         uncertainty =       0.005011271104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326772553683
                                         uncertainty =       0.005011271104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404794976
  error estimate for blocks of size 2^( 2) =       0.000414345012
  error estimate for blocks of size 2^( 3) =       0.000422759457
  error estimate for blocks of size 2^( 4) =       0.000428796348
  error estimate for blocks of size 2^( 5) =       0.000431973556
  error estimate for blocks of size 2^( 6) =       0.000436540397
  error estimate for blocks of size 2^( 7) =       0.000435830029

      target function =                  N/A
              le_mean =     -17.216938952473
             les_mean =     296.750704673764
             stat err =       0.000433285083
             autocorr =       1.145716711501
              std dev =       0.572466544373
             le_variance =       0.327717944427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938952689        initial  <--
     2.2737e+02     2.2737e+03             5.6606e-07       -17.216938949241
     9.0949e+02     9.0949e+03             1.4165e-07       -17.216938950963
     3.6380e+03     3.6380e+04             3.5420e-08       -17.216938952473

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.8552
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374254e-02 1 1  ON 1
 uu_2                -5.302571e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474231e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607098e-02 1 1  ON 7
 uu_8                -1.497866e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075403e-02 1 1  ON 12
 ud_3                -7.384258e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699358e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203546e-02 1 1  ON 18
 ud_9                 7.859761e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531374e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201233e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014818e-03 1 1  ON 34
eH1_5                 1.148191e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238455e-01 1 1  ON 41
eH2_2                -8.192772e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144688e-03 1 1  ON 44
eH2_5                 1.164132e-02 1 1  ON 45
eH2_6                 5.353361e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.294476
====================================================
  Execution time = 3.3539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1546e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315443963266
                                         uncertainty =       0.003353574506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315443963266
                                         uncertainty =       0.003353574506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397151987
  error estimate for blocks of size 2^( 2) =       0.000407336028
  error estimate for blocks of size 2^( 3) =       0.000416087540
  error estimate for blocks of size 2^( 4) =       0.000423134198
  error estimate for blocks of size 2^( 5) =       0.000427143449
  error estimate for blocks of size 2^( 6) =       0.000428113810
  error estimate for blocks of size 2^( 7) =       0.000429959000

      target function =                  N/A
              le_mean =     -17.216711819378
             les_mean =     296.730625115760
             stat err =       0.000427087614
             autocorr =       1.156432992979
              std dev =       0.561657726709
             le_variance =       0.315459401972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671181938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711819378       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711819697       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711819902       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711819804       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711819748       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216711819749       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216711819767       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 5.375491e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711819378       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711819458       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711819509       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711819485       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711819470       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216711819467       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216711819479       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.343910e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711819378       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711819398       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711819411       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711819405       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711819411       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216711819406       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216711819389       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 3.359799e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.450279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2895e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302571e-02 1 1  ON 2
 uu_3                -1.106131e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607099e-02 1 1  ON 7
 uu_8                -1.497867e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075402e-02 1 1  ON 12
 ud_3                -7.384258e-02 1 1  ON 13
 ud_4                -1.239677e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203546e-02 1 1  ON 18
 ud_9                 7.859760e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499829e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201234e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014823e-03 1 1  ON 34
eH1_5                 1.148191e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770888e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238455e-01 1 1  ON 41
eH2_2                -8.192772e-02 1 1  ON 42
eH2_3                -4.441183e-02 1 1  ON 43
eH2_4                 1.144697e-03 1 1  ON 44
eH2_5                 1.164133e-02 1 1  ON 45
eH2_6                 5.353360e-02 1 1  ON 46
eH2_7                 6.390595e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1626
    reference variance = 0.331448
====================================================
  Execution time = 3.2981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1748e-01
  Total weights = 2.0000e+06
  Execution time = 3.1169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317593009686
                                         uncertainty =       0.003245491913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317593009686
                                         uncertainty =       0.003245491913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422181
  error estimate for blocks of size 2^( 2) =       0.000408134128
  error estimate for blocks of size 2^( 3) =       0.000416897293
  error estimate for blocks of size 2^( 4) =       0.000422754124
  error estimate for blocks of size 2^( 5) =       0.000427055455
  error estimate for blocks of size 2^( 6) =       0.000429161178
  error estimate for blocks of size 2^( 7) =       0.000431425956

      target function =                  N/A
              le_mean =     -17.216367312035
             les_mean =     296.720783732533
             stat err =       0.000427599178
             autocorr =       1.151825549033
              std dev =       0.563454051687
             le_variance =       0.317480468363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317592954107
                                         uncertainty =       0.003245491233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317592954107
                                         uncertainty =       0.003245491233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422146
  error estimate for blocks of size 2^( 2) =       0.000408134094
  error estimate for blocks of size 2^( 3) =       0.000416897260
  error estimate for blocks of size 2^( 4) =       0.000422754092
  error estimate for blocks of size 2^( 5) =       0.000427055423
  error estimate for blocks of size 2^( 6) =       0.000429161146
  error estimate for blocks of size 2^( 7) =       0.000431425925

      target function =                  N/A
              le_mean =     -17.216367312156
             les_mean =     296.720783681114
             stat err =       0.000427599147
             autocorr =       1.151825579478
              std dev =       0.563454002365
             le_variance =       0.317480412781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317592981892
                                         uncertainty =       0.003245491573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317592981892
                                         uncertainty =       0.003245491573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422163
  error estimate for blocks of size 2^( 2) =       0.000408134111
  error estimate for blocks of size 2^( 3) =       0.000416897277
  error estimate for blocks of size 2^( 4) =       0.000422754108
  error estimate for blocks of size 2^( 5) =       0.000427055439
  error estimate for blocks of size 2^( 6) =       0.000429161162
  error estimate for blocks of size 2^( 7) =       0.000431425941

      target function =                  N/A
              le_mean =     -17.216367312096
             les_mean =     296.720783706819
             stat err =       0.000427599163
             autocorr =       1.151825564257
              std dev =       0.563454027022
             le_variance =       0.317480440567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317593006212
                                         uncertainty =       0.003245491871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317593006212
                                         uncertainty =       0.003245491871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422179
  error estimate for blocks of size 2^( 2) =       0.000408134125
  error estimate for blocks of size 2^( 3) =       0.000416897291
  error estimate for blocks of size 2^( 4) =       0.000422754122
  error estimate for blocks of size 2^( 5) =       0.000427055453
  error estimate for blocks of size 2^( 6) =       0.000429161176
  error estimate for blocks of size 2^( 7) =       0.000431425954

      target function =                  N/A
              le_mean =     -17.216367312043
             les_mean =     296.720783729318
             stat err =       0.000427599176
             autocorr =       1.151825550938
              std dev =       0.563454048604
             le_variance =       0.317480464888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216367312035        initial
     2.2737e+03     2.2737e+04             5.3755e-08       -17.216367312156  <--
     9.0949e+03     9.0949e+04             1.3439e-08       -17.216367312096
     3.6380e+04     3.6380e+05             3.3598e-09       -17.216367312043

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 4.8648e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497872e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859760e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201236e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014836e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144725e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1761e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2955
    reference variance = 0.168298
====================================================
  Execution time = 3.3816e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317502028629
                                         uncertainty =       0.003251587474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317502028629
                                         uncertainty =       0.003251587474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398424972
  error estimate for blocks of size 2^( 2) =       0.000407768963
  error estimate for blocks of size 2^( 3) =       0.000416093711
  error estimate for blocks of size 2^( 4) =       0.000422276411
  error estimate for blocks of size 2^( 5) =       0.000426320093
  error estimate for blocks of size 2^( 6) =       0.000427654489
  error estimate for blocks of size 2^( 7) =       0.000429530125

      target function =                  N/A
              le_mean =     -17.216887548317
             les_mean =     296.738701608895
             stat err =       0.000426445279
             autocorr =       1.145601362417
              std dev =       0.563457998661
             le_variance =       0.317484916255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688754832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887548317       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887548688       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887547573       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887547629       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887547399       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887547323       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887547294       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 2.215574e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887548317       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887548409       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887548131       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887548145       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887548087       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887548068       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887548061       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 5.539733e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887548317       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887548340       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887548270       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887548274       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887548254       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887548256       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887548251       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.384983e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3122e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374248e-02 1 1  ON 1
 uu_2                -5.302566e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607102e-02 1 1  ON 7
 uu_8                -1.497881e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075399e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203550e-02 1 1  ON 18
 ud_9                 7.859758e-02 1 1  ON 19
 eO_0                -8.963789e-01 1 1  ON 20
 eO_1                -5.702652e-01 1 1  ON 21
 eO_2                -1.499973e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014599e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239741e-01 1 1  ON 31
eH1_2                -8.201241e-02 1 1  ON 32
eH1_3                -4.457281e-02 1 1  ON 33
eH1_4                 1.014823e-03 1 1  ON 34
eH1_5                 1.148197e-02 1 1  ON 35
eH1_6                 4.996181e-02 1 1  ON 36
eH1_7                 4.770890e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403969e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192764e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144739e-03 1 1  ON 44
eH2_5                 1.164135e-02 1 1  ON 45
eH2_6                 5.353357e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.252486
====================================================
  Execution time = 3.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2165e-01
  Total weights = 2.0000e+06
  Execution time = 3.1078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495626300
                                         uncertainty =       0.002955124018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495626300
                                         uncertainty =       0.002955124018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401030302
  error estimate for blocks of size 2^( 2) =       0.000410442498
  error estimate for blocks of size 2^( 3) =       0.000419198569
  error estimate for blocks of size 2^( 4) =       0.000424510834
  error estimate for blocks of size 2^( 5) =       0.000428177026
  error estimate for blocks of size 2^( 6) =       0.000431281489
  error estimate for blocks of size 2^( 7) =       0.000432140041

      target function =                  N/A
              le_mean =     -17.216560084207
             les_mean =     296.731591578344
             stat err =       0.000429027348
             autocorr =       1.144499413039
              std dev =       0.567142491856
             le_variance =       0.321650606069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495434968
                                         uncertainty =       0.002955123169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495434968
                                         uncertainty =       0.002955123169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401030183
  error estimate for blocks of size 2^( 2) =       0.000410442382
  error estimate for blocks of size 2^( 3) =       0.000419198457
  error estimate for blocks of size 2^( 4) =       0.000424510725
  error estimate for blocks of size 2^( 5) =       0.000428176914
  error estimate for blocks of size 2^( 6) =       0.000431281374
  error estimate for blocks of size 2^( 7) =       0.000432139913

      target function =                  N/A
              le_mean =     -17.216560083392
             les_mean =     296.731591358762
             stat err =       0.000429027231
             autocorr =       1.144499474392
              std dev =       0.567142323016
             le_variance =       0.321650414556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495530584
                                         uncertainty =       0.002955123593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495530584
                                         uncertainty =       0.002955123593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401030242
  error estimate for blocks of size 2^( 2) =       0.000410442440
  error estimate for blocks of size 2^( 3) =       0.000419198513
  error estimate for blocks of size 2^( 4) =       0.000424510779
  error estimate for blocks of size 2^( 5) =       0.000428176970
  error estimate for blocks of size 2^( 6) =       0.000431281432
  error estimate for blocks of size 2^( 7) =       0.000432139977

      target function =                  N/A
              le_mean =     -17.216560083799
             les_mean =     296.731591468484
             stat err =       0.000429027289
             autocorr =       1.144499443728
              std dev =       0.567142407392
             le_variance =       0.321650510262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495614334
                                         uncertainty =       0.002955123965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321495614334
                                         uncertainty =       0.002955123965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401030294
  error estimate for blocks of size 2^( 2) =       0.000410442490
  error estimate for blocks of size 2^( 3) =       0.000419198562
  error estimate for blocks of size 2^( 4) =       0.000424510827
  error estimate for blocks of size 2^( 5) =       0.000428177019
  error estimate for blocks of size 2^( 6) =       0.000431281482
  error estimate for blocks of size 2^( 7) =       0.000432140033

      target function =                  N/A
              le_mean =     -17.216560084156
             les_mean =     296.731591564609
             stat err =       0.000429027340
             autocorr =       1.144499416882
              std dev =       0.567142481297
             le_variance =       0.321650594092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216560084207        initial  <--
     5.6843e+02     5.6843e+03             2.2156e-07       -17.216560083392
     2.2737e+03     2.2737e+04             5.5397e-08       -17.216560083799
     9.0949e+03     9.0949e+04             1.3850e-08       -17.216560084156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.6999
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497872e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859760e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201236e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014836e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144725e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2481
    reference variance = 0.375391
====================================================
  Execution time = 3.3720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319224078453
                                         uncertainty =       0.003466028513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319224078453
                                         uncertainty =       0.003466028513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399556980
  error estimate for blocks of size 2^( 2) =       0.000409524495
  error estimate for blocks of size 2^( 3) =       0.000418270143
  error estimate for blocks of size 2^( 4) =       0.000425061006
  error estimate for blocks of size 2^( 5) =       0.000428768984
  error estimate for blocks of size 2^( 6) =       0.000429827689
  error estimate for blocks of size 2^( 7) =       0.000429825558

      target function =                  N/A
              le_mean =     -17.217024426329
             les_mean =     296.745221498388
             stat err =       0.000428370809
             autocorr =       1.149429377359
              std dev =       0.565058900661
             le_variance =       0.319291561216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702442633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217024426329       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217024426316       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217024426230       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217024426131       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217024426100       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217024426085       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217024426062       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 2.749515e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217024426329       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217024426326       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217024426304       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217024426280       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217024426277       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217024426267       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217024426266       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 6.873878e-09

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217024426329       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217024426328       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217024426323       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217024426317       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217024426315       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217024426357       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217024426311       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 1.718475e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.454749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3140e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497871e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859759e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201237e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014838e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192770e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144726e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152499e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2383
    reference variance = 0.210194
====================================================
  Execution time = 3.3065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1966e-01
  Total weights = 2.0000e+06
  Execution time = 3.1112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749733224
                                         uncertainty =       0.003608450568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749733224
                                         uncertainty =       0.003608450568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399786103
  error estimate for blocks of size 2^( 2) =       0.000409100434
  error estimate for blocks of size 2^( 3) =       0.000417965596
  error estimate for blocks of size 2^( 4) =       0.000424780381
  error estimate for blocks of size 2^( 5) =       0.000429045368
  error estimate for blocks of size 2^( 6) =       0.000430725518
  error estimate for blocks of size 2^( 7) =       0.000432195762

      target function =                  N/A
              le_mean =     -17.216695537558
             les_mean =     296.734262930144
             stat err =       0.000429186757
             autocorr =       1.152490193414
              std dev =       0.565382929517
             le_variance =       0.319657856990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749702416
                                         uncertainty =       0.003608450265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749702416
                                         uncertainty =       0.003608450265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399786084
  error estimate for blocks of size 2^( 2) =       0.000409100416
  error estimate for blocks of size 2^( 3) =       0.000417965578
  error estimate for blocks of size 2^( 4) =       0.000424780363
  error estimate for blocks of size 2^( 5) =       0.000429045351
  error estimate for blocks of size 2^( 6) =       0.000430725501
  error estimate for blocks of size 2^( 7) =       0.000432195745

      target function =                  N/A
              le_mean =     -17.216695537323
             les_mean =     296.734262891254
             stat err =       0.000429186740
             autocorr =       1.152490211193
              std dev =       0.565382902293
             le_variance =       0.319657826205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749717819
                                         uncertainty =       0.003608450417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749717819
                                         uncertainty =       0.003608450417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399786094
  error estimate for blocks of size 2^( 2) =       0.000409100425
  error estimate for blocks of size 2^( 3) =       0.000417965587
  error estimate for blocks of size 2^( 4) =       0.000424780372
  error estimate for blocks of size 2^( 5) =       0.000429045359
  error estimate for blocks of size 2^( 6) =       0.000430725510
  error estimate for blocks of size 2^( 7) =       0.000432195754

      target function =                  N/A
              le_mean =     -17.216695537441
             les_mean =     296.734262910698
             stat err =       0.000429186749
             autocorr =       1.152490202309
              std dev =       0.565382915904
             le_variance =       0.319657841596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749731298
                                         uncertainty =       0.003608450549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319749731298
                                         uncertainty =       0.003608450549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399786102
  error estimate for blocks of size 2^( 2) =       0.000409100433
  error estimate for blocks of size 2^( 3) =       0.000417965595
  error estimate for blocks of size 2^( 4) =       0.000424780380
  error estimate for blocks of size 2^( 5) =       0.000429045367
  error estimate for blocks of size 2^( 6) =       0.000430725517
  error estimate for blocks of size 2^( 7) =       0.000432195761

      target function =                  N/A
              le_mean =     -17.216695537544
             les_mean =     296.734262927713
             stat err =       0.000429186756
             autocorr =       1.152490194537
              std dev =       0.565382927816
             le_variance =       0.319657855066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216695537558        initial  <--
     5.6843e+03     5.6843e+04             2.7495e-08       -17.216695537323
     2.2737e+04     2.2737e+05             6.8739e-09       -17.216695537441
     9.0949e+04     9.0949e+05             1.7185e-09       -17.216695537544

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 52.4122
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497872e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859760e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201236e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014836e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144725e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2505
    reference variance = 0.173476
====================================================
  Execution time = 3.3773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1955e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319366750214
                                         uncertainty =       0.003286971791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319366750214
                                         uncertainty =       0.003286971791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399721344
  error estimate for blocks of size 2^( 2) =       0.000409306236
  error estimate for blocks of size 2^( 3) =       0.000417881577
  error estimate for blocks of size 2^( 4) =       0.000423849197
  error estimate for blocks of size 2^( 5) =       0.000428531064
  error estimate for blocks of size 2^( 6) =       0.000430744212
  error estimate for blocks of size 2^( 7) =       0.000430743811

      target function =                  N/A
              le_mean =     -17.216210960438
             les_mean =     296.717473980315
             stat err =       0.000428467071
             autocorr =       1.149000515999
              std dev =       0.565291345938
             le_variance =       0.319554305793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621096044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210960438       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210960441       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216210960445       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216210960446       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216210960439       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216210960496       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+04 is 2.091122e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210960438       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210960439       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216210960440       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216210960345       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216210960422       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216210960601       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 5.227831e-10

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210960438       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210960438       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216210960438       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216210959831       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216210960725       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216210960108       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 1.306958e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.456625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3181e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497872e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859760e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201236e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014836e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144725e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.366719
====================================================
  Execution time = 3.2943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2390e-01
  Total weights = 2.0000e+06
  Execution time = 3.1215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911297
                                         uncertainty =       0.003303625658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911297
                                         uncertainty =       0.003303625658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433312
  error estimate for blocks of size 2^( 2) =       0.000411576632
  error estimate for blocks of size 2^( 3) =       0.000420058042
  error estimate for blocks of size 2^( 4) =       0.000426028571
  error estimate for blocks of size 2^( 5) =       0.000431252675
  error estimate for blocks of size 2^( 6) =       0.000434241583
  error estimate for blocks of size 2^( 7) =       0.000436087382

      target function =                  N/A
              le_mean =     -17.216536098129
             les_mean =     296.733020197359
             stat err =       0.000431902553
             autocorr =       1.151817562403
              std dev =       0.569126647714
             le_variance =       0.323905141138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911329
                                         uncertainty =       0.003303625655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911329
                                         uncertainty =       0.003303625655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433312
  error estimate for blocks of size 2^( 2) =       0.000411576632
  error estimate for blocks of size 2^( 3) =       0.000420058042
  error estimate for blocks of size 2^( 4) =       0.000426028571
  error estimate for blocks of size 2^( 5) =       0.000431252675
  error estimate for blocks of size 2^( 6) =       0.000434241583
  error estimate for blocks of size 2^( 7) =       0.000436087382

      target function =                  N/A
              le_mean =     -17.216536098134
             les_mean =     296.733020197578
             stat err =       0.000431902553
             autocorr =       1.151817562026
              std dev =       0.569126647742
             le_variance =       0.323905141170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911313
                                         uncertainty =       0.003303625656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911313
                                         uncertainty =       0.003303625656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433312
  error estimate for blocks of size 2^( 2) =       0.000411576632
  error estimate for blocks of size 2^( 3) =       0.000420058042
  error estimate for blocks of size 2^( 4) =       0.000426028571
  error estimate for blocks of size 2^( 5) =       0.000431252675
  error estimate for blocks of size 2^( 6) =       0.000434241583
  error estimate for blocks of size 2^( 7) =       0.000436087382

      target function =                  N/A
              le_mean =     -17.216536098132
             les_mean =     296.733020197468
             stat err =       0.000431902553
             autocorr =       1.151817562218
              std dev =       0.569126647728
             le_variance =       0.323905141154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911299
                                         uncertainty =       0.003303625658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324026911299
                                         uncertainty =       0.003303625658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433312
  error estimate for blocks of size 2^( 2) =       0.000411576632
  error estimate for blocks of size 2^( 3) =       0.000420058042
  error estimate for blocks of size 2^( 4) =       0.000426028571
  error estimate for blocks of size 2^( 5) =       0.000431252675
  error estimate for blocks of size 2^( 6) =       0.000434241583
  error estimate for blocks of size 2^( 7) =       0.000436087382

      target function =                  N/A
              le_mean =     -17.216536098129
             les_mean =     296.733020197372
             stat err =       0.000431902553
             autocorr =       1.151817562379
              std dev =       0.569126647716
             le_variance =       0.323905141140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216536098129        initial
     5.6843e+04     5.6843e+05             2.0911e-09       -17.216536098134  <--
     2.2737e+05     2.2737e+06             5.2278e-10       -17.216536098132
     9.0949e+05     9.0949e+06             1.3070e-10       -17.216536098129

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 4.8643e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.072665e-01 1 1  ON 0
 uu_1                 4.374253e-02 1 1  ON 1
 uu_2                -5.302570e-02 1 1  ON 2
 uu_3                -1.106130e-01 1 1  ON 3
 uu_4                -1.474230e-01 1 1  ON 4
 uu_5                -1.594437e-01 1 1  ON 5
 uu_6                -1.461091e-01 1 1  ON 6
 uu_7                -9.607100e-02 1 1  ON 7
 uu_8                -1.497872e-03 1 1  ON 8
 uu_9                 2.066177e-01 1 1  ON 9
 ud_0                 3.605245e-01 1 1  ON 10
 ud_1                 1.009025e-01 1 1  ON 11
 ud_2                -1.075401e-02 1 1  ON 12
 ud_3                -7.384259e-02 1 1  ON 13
 ud_4                -1.239676e-01 1 1  ON 14
 ud_5                -1.594605e-01 1 1  ON 15
 ud_6                -1.699359e-01 1 1  ON 16
 ud_7                -1.425667e-01 1 1  ON 17
 ud_8                -7.203547e-02 1 1  ON 18
 ud_9                 7.859759e-02 1 1  ON 19
 eO_0                -8.963790e-01 1 1  ON 20
 eO_1                -5.702653e-01 1 1  ON 21
 eO_2                -1.499972e-01 1 1  ON 22
 eO_3                 1.246959e-01 1 1  ON 23
 eO_4                 2.499830e-01 1 1  ON 24
 eO_5                 3.252958e-01 1 1  ON 25
 eO_6                 3.531373e-01 1 1  ON 26
 eO_7                 4.011713e-01 1 1  ON 27
 eO_8                 1.014598e-01 1 1  ON 28
 eO_9                 3.822650e-02 1 1  ON 29
eH1_0                -2.030431e-01 1 1  ON 30
eH1_1                -1.239740e-01 1 1  ON 31
eH1_2                -8.201237e-02 1 1  ON 32
eH1_3                -4.457282e-02 1 1  ON 33
eH1_4                 1.014835e-03 1 1  ON 34
eH1_5                 1.148192e-02 1 1  ON 35
eH1_6                 4.996179e-02 1 1  ON 36
eH1_7                 4.770889e-02 1 1  ON 37
eH1_8                 2.187664e-01 1 1  ON 38
eH1_9                 8.403968e-02 1 1  ON 39
eH2_0                -2.032133e-01 1 1  ON 40
eH2_1                -1.238456e-01 1 1  ON 41
eH2_2                -8.192769e-02 1 1  ON 42
eH2_3                -4.441185e-02 1 1  ON 43
eH2_4                 1.144726e-03 1 1  ON 44
eH2_5                 1.164136e-02 1 1  ON 45
eH2_6                 5.353359e-02 1 1  ON 46
eH2_7                 6.390594e-02 1 1  ON 47
eH2_8                 2.111438e-01 1 1  ON 48
eH2_9                 8.152498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1923e+01 secs
  Total Execution time = 3.7973e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
